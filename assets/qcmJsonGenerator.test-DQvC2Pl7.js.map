{"version":3,"file":"qcmJsonGenerator.test-DQvC2Pl7.js","sources":["../../src/exercices/beta/qcmJsonGenerator.test.ts"],"sourcesContent":["import { describe, it, expect, beforeEach } from 'vitest'\nimport QcmJsonGenerator, { type QcmJsonData } from './QcmJsonGenerator'\n\nconst sampleQcmData: QcmJsonData = {\n  titre: 'Test QCM',\n  consigne: 'Sélectionnez la bonne réponse.',\n  options: {\n    vertical: true,\n    ordered: true,\n    lastChoice: 3,\n  },\n  questions: [\n    {\n      enonce: 'Quelle couleur est le ciel ?',\n      reponses: ['Bleu', 'Vert', 'Rouge'],\n      corrections: ['Correct', 'Faux', 'Faux'],\n      bonnesReponses: [true, false, false],\n    },\n    {\n      enonce: 'Combien font 1+1 ?',\n      reponses: ['2', '3'],\n      corrections: ['Correct', 'Faux'],\n      bonnesReponses: [true, false],\n    },\n  ],\n}\n\ndescribe('QcmJsonGenerator', () => {\n  let generator: QcmJsonGenerator\n\n  beforeEach(() => {\n    generator = new QcmJsonGenerator(sampleQcmData)\n  })\n\n  it('should initialize with provided JSON data', () => {\n    expect(generator['jsonData']).toEqual(sampleQcmData)\n    expect(generator['questionsDisponibles'].length).toBe(2)\n    expect(generator.titre).toBe('Test QCM')\n    expect(generator.consigne).toBe('Sélectionnez la bonne réponse.')\n    expect(generator.options.vertical).toBe(true)\n    expect(generator.options.ordered).toBe(true)\n    expect(generator.options.lastChoice).toBe(3)\n    expect(generator.nbQuestions).toBe(2)\n    expect(generator.nbQuestionsModifiable).toBe(true)\n  })\n\n  it('should use default data if no data is provided', () => {\n    // @ts-expect-error\n    const gen = new QcmJsonGenerator(undefined)\n    expect(gen['jsonData']).toBeDefined()\n    expect(gen['questionsDisponibles'].length).toBeGreaterThan(0)\n  })\n\n  it('should set enonce, reponses, corrections and bonnesReponses in versionOriginale', () => {\n    generator.versionOriginale()\n    expect(generator.enonce).toBe('Quelle couleur est le ciel ?')\n    expect(generator.reponses).toEqual(['Bleu', 'Vert', 'Rouge'])\n    expect(generator.corrections).toEqual(['Correct', 'Faux', 'Faux'])\n    expect(generator.bonnesReponses).toEqual([true, false, false])\n  })\n\n  it('should set correction to default if no corrections are provided', () => {\n    const data: QcmJsonData = {\n      titre: 'Sans correction',\n      questions: [\n        {\n          enonce: 'Test',\n          reponses: ['A', 'B'],\n        },\n      ],\n    }\n    const gen = new QcmJsonGenerator(data)\n    gen.versionOriginale()\n    expect(gen.correction).toBe('La bonne réponse est la première de la liste.')\n  })\n\n  it('should pick a random question in versionAleatoire', () => {\n    generator.versionAleatoire()\n    expect(generator.enonce).toMatch(\n      /(Quelle couleur est le ciel|Combien font 1\\+1)/,\n    )\n    expect(generator.reponses.length).toBeGreaterThan(1)\n  })\n\n  it('should validate correct QcmJsonData', () => {\n    expect(QcmJsonGenerator.validateJsonData(sampleQcmData)).toBe(true)\n  })\n\n  it('should invalidate QcmJsonData with missing titre', () => {\n    const data = { ...sampleQcmData, titre: undefined }\n    expect(QcmJsonGenerator.validateJsonData(data)).toBe(false)\n  })\n\n  it('should invalidate QcmJsonData with invalid questions', () => {\n    const data = { ...sampleQcmData, questions: [] }\n    expect(QcmJsonGenerator.validateJsonData(data)).toBe(false)\n  })\n\n  it('should invalidate QcmJsonData with invalid reponses', () => {\n    const data = {\n      ...sampleQcmData,\n      questions: [{ enonce: 'Q', reponses: ['A'] }],\n    }\n    expect(QcmJsonGenerator.validateJsonData(data)).toBe(false)\n  })\n\n  it('should invalidate QcmJsonData with non-string reponse', () => {\n    const data = {\n      ...sampleQcmData,\n      questions: [{ enonce: 'Q', reponses: ['A', 2] }],\n    }\n    expect(QcmJsonGenerator.validateJsonData(data)).toBe(false)\n  })\n\n  it('should invalidate QcmJsonData with invalid corrections', () => {\n    const data = {\n      ...sampleQcmData,\n      questions: [\n        {\n          enonce: 'Q',\n          reponses: ['A', 'B'],\n          corrections: [1, 2],\n        },\n      ],\n    }\n    expect(QcmJsonGenerator.validateJsonData(data)).toBe(false)\n  })\n\n  it('should invalidate QcmJsonData with invalid bonnesReponses', () => {\n    const data = {\n      ...sampleQcmData,\n      questions: [\n        {\n          enonce: 'Q',\n          reponses: ['A', 'B'],\n          bonnesReponses: [true],\n        },\n      ],\n    }\n    expect(QcmJsonGenerator.validateJsonData(data)).toBe(false)\n  })\n\n  it('should create instance from static fromJson', () => {\n    const gen = QcmJsonGenerator.fromJson(sampleQcmData)\n    expect(gen).toBeInstanceOf(QcmJsonGenerator)\n    expect(gen['jsonData']).toEqual(sampleQcmData)\n  })\n\n  it('should get a random question not in questionsDejaUtilisees', () => {\n    const q1 = sampleQcmData.questions[0]\n    const q2 = sampleQcmData.questions[1]\n    // @ts-ignore\n    const result = generator['getQuestionAleatoire']([q1])\n    expect([q2, null]).toContain(result)\n  })\n\n  it('nouvelleVersion should call versionOriginale and super.nouvelleVersion', () => {\n    const spy = vi.spyOn(generator, 'versionOriginale')\n    generator.nouvelleVersion()\n    expect(spy).toHaveBeenCalled()\n  })\n})\n"],"names":["sampleQcmData","describe","generator","beforeEach","QcmJsonGenerator","it","expect","gen","data","q1","q2","result","spy"],"mappings":"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"}