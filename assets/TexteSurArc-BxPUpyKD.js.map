{"version":3,"file":"TexteSurArc-BxPUpyKD.js","sources":["../../src/lib/2d/TexteSurArc.ts"],"sourcesContent":["import { context } from '../../modules/context'\nimport { radToDeg } from '../mathFonctions/radToDeg'\nimport { colorToLatexOrHTML } from './colorToLatexOrHtml'\nimport { droite } from './droites'\nimport { ObjetMathalea2D } from './ObjetMathalea2D'\nimport { pointAbstrait, PointAbstrait } from './PointAbstrait'\nimport { segment } from './segmentsVecteurs'\nimport { texteParPoint } from './textes'\nimport { rotation } from './transformations'\nimport { longueur } from './utilitairesGeometriques'\nimport { milieu, pointSurSegment } from './utilitairesPoint'\n\n/**\n * texteSurArc(texte, A, B, angle) // Écrit un texte au milieu de l'arc AB, au dessus si A est le point le plus à gauche sinon au dessous\n *\n * @author Rémi Angot et Frédéric Piou\n */\n\nexport class TexteSurArc extends ObjetMathalea2D {\n  extremite1: PointAbstrait\n  extremite2: PointAbstrait\n  distance: number\n  texte: string\n  angle: number\n  centre: PointAbstrait\n  milieu: PointAbstrait\n  normale: number\n  stringColor: string\n  horizontalite: number\n  constructor(\n    texte: string,\n    A: PointAbstrait,\n    B: PointAbstrait,\n    angle: number,\n    color = 'black',\n    d = 0.5,\n    horizontalite = false,\n  ) {\n    if (angle === undefined) angle = NaN\n    super()\n    this.color = colorToLatexOrHTML(color)\n    this.horizontalite =\n      (horizontalite ?? A.x < B.x)\n        ? radToDeg(Math.atan2(B.y - A.y, B.x - A.x))\n        : radToDeg(Math.atan2(A.y - B.y, A.x - B.x))\n    this.horizontalite =\n      this.horizontalite > 90\n        ? this.horizontalite - 180\n        : this.horizontalite < -90\n          ? this.horizontalite + 180\n          : this.horizontalite\n    this.stringColor = color\n    this.extremite1 = A\n    this.extremite2 = B\n    this.distance = texte[0] === '$' ? -3 * d : -d\n    this.texte = texte\n    angle = isNaN(angle)\n      ? radToDeg(Math.asin((2 * this.distance) / longueur(A, B))) * 2\n      : angle\n    this.angle = angle\n    let anglerot\n    if (angle < 0) anglerot = (angle + 180) / 2\n    else anglerot = (angle - 180) / 2\n    // Médiatrice via droite(I, J), avec I milieu de [AB] et J sur la perpendiculaire en I\n    const I = milieu(A, B)\n    const vx = B.x - A.x\n    const vy = B.y - A.y\n    const J = pointAbstrait(I.x - vy, I.y + vx)\n    const d1 = droite(I, J)\n    const e = droite(A, B)\n    const f = rotation(e, B, anglerot)\n    const determinant = d1.a * f.b - f.a * d1.b\n    const Omegax = (d1.b * f.c - f.b * d1.c) / determinant\n    const Omegay = (f.a * d1.c - d1.a * f.c) / determinant\n    this.centre = pointAbstrait(Omegax, Omegay)\n    const s = segment(this.extremite1, this.extremite2)\n    this.normale = -s.angleAvecHorizontale\n    this.milieu = rotation(A, this.centre, angle / 2)\n    const pos = pointSurSegment(this.milieu, this.centre, this.distance)\n    const space = 0.2 * texte.length\n    this.bordures = [pos.x - space, pos.y - space, pos.x + space, pos.y + space]\n  }\n\n  svg(coeff: number) {\n    const N = pointSurSegment(\n      this.milieu,\n      this.centre,\n      (this.distance * 20) / coeff,\n    )\n    return texteParPoint(\n      this.texte,\n      N,\n      this.horizontalite,\n      this.stringColor,\n    ).svg(coeff)\n  }\n\n  tikz() {\n    const N = pointSurSegment(\n      this.milieu,\n      this.centre,\n      this.distance / context.scale,\n    )\n\n    return texteParPoint(\n      this.texte,\n      N,\n      this.horizontalite,\n      this.stringColor,\n    ).tikz()\n  }\n}\n/**\n * Écrit un texte au \"milieu\" de l'arc AB au dessus si A est le point le plus à gauche sinon en dessous\n * @param {string} texte Texte à afficher (éviter les $$ pour les affichages diaporama)\n * @param {Point} A Extrémité de l'arc\n * @param {Point} B Extrémité de l'arc\n * @param {number} angle Angle au centre\n * @param {string} [color='black'] Code couleur HTML accepté\n * @param {number} [d=0.5] Distance à la droite.\n * @param {number} [horizontalite = 0]\n * @return {object} LatexParCoordonnees si le premier caractère est '$', TexteParPoint sinon\n * @author Rémi Angot et Frédéric Piou\n */\n\nexport function texteSurArc(\n  texte: string,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  angle: number,\n  color = 'black',\n  d = 0.5,\n  horizontalite = false,\n) {\n  return new TexteSurArc(texte, A, B, angle, color, d, horizontalite)\n}\n"],"names":["TexteSurArc","ObjetMathalea2D","texte","A","B","angle","color","d","horizontalite","__publicField","colorToLatexOrHTML","radToDeg","longueur","anglerot","I","milieu","vx","vy","J","pointAbstrait","d1","droite","e","f","rotation","determinant","Omegax","Omegay","s","segment","pos","pointSurSegment","space","coeff","N","texteParPoint","context","texteSurArc"],"mappings":"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"}