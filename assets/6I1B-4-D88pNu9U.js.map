{"version":3,"file":"6I1B-4-D88pNu9U.js","sources":["../../src/exercices/6e/6I1B-4.ts"],"sourcesContent":["import { colorToLatexOrHTML } from '../../lib/2d/colorToLatexOrHtml'\nimport { point } from '../../lib/2d/PointAbstrait'\nimport { polygone } from '../../lib/2d/polygones'\nimport { segment } from '../../lib/2d/segmentsVecteurs'\nimport { latex2d } from '../../lib/2d/textes'\nimport { choice, shuffle } from '../../lib/outils/arrayOutils'\nimport { range1 } from '../../lib/outils/nombres'\nimport { listeDesDiviseurs } from '../../lib/outils/primalite'\nimport { texNombre } from '../../lib/outils/texNombre'\nimport { MySpreadsheetElement } from '../../lib/tableur/MySpreadSheet'\nimport { addSheet } from '../../lib/tableur/outilsTableur'\nimport { context } from '../../modules/context'\nimport { mathalea2d } from '../../modules/mathalea2d'\n\nimport {\n  gestionnaireFormulaireTexte,\n  listeQuestionsToContenu,\n  randint,\n} from '../../modules/outils'\nimport Exercice from '../Exercice'\n\nexport const titre = 'Programmer des calculs sur tableur'\nexport const dateDePublication = '12/08/2025'\n\nexport const interactifReady = true\nexport const interactifType = 'custom'\n\n/*\n * Programmer des calculs sur tableur : New programme de 6eme 2025\n * @author Mickael Guironnet\n * revisit√© par Jean-Claude Lhote (intoduction du custom √©l√©ment sheet-element) et modification de la librairie utilis√©e.\n */\n\nexport const uuid = 'ae07c'\n\nexport const refs = {\n  'fr-fr': ['6I1B-4'],\n  'fr-ch': [],\n}\nconst alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n\nexport default class ExerciceTableur extends Exercice {\n  destroyers: (() => void)[] = []\n  listeSteps: Steps[] = []\n\n  constructor() {\n    super()\n    this.nbQuestions = 2\n    this.besoinFormulaireNumerique = [\n      \"Nombre d'op√©rations (entre 2 et 5 ou bien 1 si vous laissez le hasard d√©cider)\",\n      5,\n    ]\n    this.besoinFormulaire2Texte = [\n      \"Type d'op√©rations\",\n      [\n        'Nombres s√©par√©s par des tirets  :',\n        '1 : Addition',\n        '2 : Soustraction',\n        '3 : Multiplication',\n        '4 : Division',\n        '5 : M√©lange',\n      ].join('\\n'),\n    ]\n    this.sup = 3\n    this.sup2 = 5\n    this.listeSteps = []\n  }\n\n  destroy() {\n    // MGu quan l'exercice est supprim√© par svelte : bouton supprim√©\n    this.destroyers.forEach((destroy) => destroy())\n    this.destroyers.length = 0\n  }\n\n  static readonly colors = {\n    orange: '#e6b457',\n    vert: '#7adb7a',\n    jaune: '#e6e66a',\n    bleu: '#8181e6',\n    violet: '#f8a3f8',\n    rouge: '#eca2a2',\n  }\n\n  static readonly styles = {\n    style_id_rouge: {\n      fs: 12,\n      bg: ExerciceTableur.colors.rouge,\n    },\n    style_id_bleu: {\n      fs: 12,\n      bg: ExerciceTableur.colors.bleu,\n    },\n    style_id_orange: {\n      fs: 12,\n      bg: ExerciceTableur.colors.orange,\n    },\n    style_id_violet: {\n      fs: 12,\n      bg: ExerciceTableur.colors.violet,\n    },\n    style_id_vert: {\n      fs: 12,\n      bg: ExerciceTableur.colors.vert,\n    },\n    style_id_jaune: {\n      fs: 12,\n      bg: ExerciceTableur.colors.jaune,\n    },\n  }\n\n  validateFormulas(\n    q: number,\n    userSheet: MySpreadsheetElement,\n  ): { isOk: boolean; messages: string } {\n    // 1. R√©cup√®re les donn√©es de l'utilisateur\n    const userData = userSheet.getData()\n    const nbSteps = this.listeSteps[q].length\n    const testSheet = MySpreadsheetElement.create({\n      data: userData,\n      minDimensions: userSheet.getMinDimensions(),\n      style: userSheet.getStyle(),\n      columns: userSheet.getColumns(),\n      interactif: false,\n      id: 'testSheet',\n    })\n    testSheet.style.position = 'absolute'\n    testSheet.style.left = '-9999px'\n    document.body.appendChild(testSheet)\n\n    const messages: string[][] = []\n    for (let n = 0; n < nbSteps; n++) {\n      messages[n] = []\n      const a1 = randint(1, 10)\n      testSheet.setCellValue(0, 0, a1) // A1\n      const resultats = range1(nbSteps).map((i) =>\n        parseFloat(testSheet.getCellValue(i, 0)),\n      )\n\n      // compare les r√©sultats\n      for (let i = 1; i < nbSteps + 1; i++) {\n        if (typeof resultats[i - 1] !== 'number' || isNaN(resultats[i - 1])) {\n          messages[n].push(\n            `La cellule ${String.fromCharCode(65 + i)}1 ne contient pas un nombre valide.<br>`,\n          )\n        }\n      }\n      for (let i = 1; i < nbSteps + 1; i++) {\n        if (\n          typeof testSheet.getCellFormula(i, 0) !== 'string' ||\n          !testSheet.getCellFormula(i, 0).startsWith('=')\n        ) {\n          messages[n].push(\n            `La cellule ${String.fromCharCode(65 + i)}1 ne contient pas une formule valide.<br>`,\n          )\n        }\n      }\n      let result = a1\n      for (let i = 1; i < nbSteps + 1; i++) {\n        const steps = this.listeSteps[q]\n        result = evaluate(result, steps[i - 1].op, steps[i - 1].val)\n        const computed = parseFloat(testSheet.getCellValue(i, 0))\n        if (Math.abs(computed - result) > 1e-9) {\n          messages[n].push(\n            `Pour un nombre de d√©part √©gal √† ${a1}, la cellule ${String.fromCharCode(65 + i)}1 devrait contenir $${texNombre(result, 2)}$ mais elle contient $${texNombre(computed, 2)}$.<br>`,\n          )\n        }\n      }\n    }\n    const maxMessages = messages.reduce(\n      (max, arr) => (arr.length > max.length ? arr : max),\n      [],\n    )\n\n    document.body.removeChild(testSheet)\n    const feedback =\n      maxMessages.length === 0\n        ? '‚úÖ Toutes les formules sont correctes !'\n        : '‚ùå Des erreurs ont √©t√© d√©t√©ct√©es.'\n    return {\n      isOk: maxMessages.length === 0,\n      messages: maxMessages.join('') + feedback,\n    }\n  }\n\n  checkSolution(event?: CustomEvent) {\n    // R√©cup√®re le nom de l‚Äôevent\n    const eventName = event?.type\n    const q = eventName?.match(/Q(\\d+)/)?.[1]\n    if (!q) {\n      console.error('Question number not found in event name:', eventName)\n      return\n    }\n    const id = eventName?.replace('check', 'sheet-') || ''\n    const sheetElt = document.getElementById(id) as MySpreadsheetElement\n    // Tu peux aussi r√©cup√©rer le bouton via event.target ou event.detail\n    // Exemple :\n    // const bouton = event?.detail?.sheet?.querySelector('#runCode')\n\n    if (sheetElt && sheetElt.isMounted()) {\n      const { messages } = this.validateFormulas(Number(q), sheetElt)\n      const messagesDiv = sheetElt.querySelector(\n        '#message-faux',\n      ) as HTMLDivElement\n      if (messages && messagesDiv) {\n        messagesDiv.style.color = 'green'\n        messagesDiv.innerHTML = messages\n      }\n    }\n  }\n\n  nouvelleVersion(): void {\n    // MGu quand l'exercice est modifi√©, on d√©truit les anciens listeners\n    this.destroyers.forEach((destroy) => destroy())\n    this.destroyers.length = 0\n\n    const nbOperations =\n      this.sup === 1 ? randint(2, 5) : Math.min(Math.max(2, this.sup), 5)\n\n    const typesDeOperations = gestionnaireFormulaireTexte({\n      saisie: this.sup2,\n      min: 1,\n      max: 4,\n      melange: 5,\n      defaut: 5,\n      nbQuestions: nbOperations,\n    })\n    this.listeSteps = []\n    const colorsArr = Object.entries(ExerciceTableur.colors)\n    for (\n      let q = 0, cpt = 0, texte, texteCorr: string;\n      q < this.nbQuestions && cpt < 50;\n      cpt++\n    ) {\n      const { steps } = programmeCalcul(typesDeOperations as number[])\n      this.listeSteps[q] = steps\n      const operStr = transformationsOper(steps)\n      const cellDatas: any = {\n        0: {\n          0: { v: steps[0].oldn, s: 'style_id_orange', t: 2 },\n        },\n      }\n      for (let i = 0; i < steps.length; i++) {\n        cellDatas[0][i + 1] = {\n          v: '',\n          s: `style_id_${colorsArr[(i + 1) % colorsArr.length][0]}`,\n        }\n      }\n\n      const data: (number | string)[][] = [[]]\n      data[0][0] = cellDatas[0][0].v\n      for (let i = 0; i < steps.length; i++) {\n        data[0][i + 1] = cellDatas[0][i + 1].v\n      }\n\n      const rect: Record<string, { bg?: string; v?: string }> = {\n        0: { v: steps[0].oldn.toString(), bg: colorsArr[0][1] },\n      }\n      for (let i = 0, k = 1; i < steps.length; i++, k += 2) {\n        rect[`${k}`] = { v: operStr[i] }\n        rect[`${k + 1}`] = { bg: colorsArr[(i + 1) % colorsArr.length][1] }\n      }\n\n      texte = 'On a cr√©√© le programme de calculs suivant :<br>'\n      texte += createDigramm(Object.keys(rect).length, rect) + '<br>'\n\n      texte += `On choisit un nombre dans la premi√®re case, ici ${steps[0].oldn} et on obtient un nombre √† la fin de la cha√Æne.<br><br>      \n      On veut programmer cette suite de calculs dans un tableur. <br>\n      Par exemple, la cellule B1 doit contenir la formule du premier calcul.<br>\n      Faire de m√™me pour les autres cellules. <br>\n      Attention, les formules doivent fonctionner m√™me si le nombre de d√©part change (Cellule A1).<br>\n      `\n      const style = buildStyleFromColos(\n        Object.values(ExerciceTableur.colors),\n        steps.length,\n      )\n\n      if (context.isHtml) {\n        texte += addSheet({\n          numeroExercice: this.numeroExercice ?? 0,\n          question: q,\n          data,\n          minDimensions: [4, 4],\n          style,\n          columns: [{ width: 90 }, { width: 90 }, { width: 90 }, { width: 90 }],\n          interactif: this.interactif,\n          showVerifyButton: true,\n        })\n      } else {\n        const options: {\n          formule?: boolean\n          formuleTexte?: string\n          formuleCellule?: string\n          firstColHeaderWidth?: string\n        } = {}\n        options.formule = true\n        options.formuleTexte = '=?'\n        options.formuleCellule = 'B1'\n\n        texte += createTableurLatex(\n          2,\n          steps.length + 1,\n          cellDatas,\n          ExerciceTableur.styles,\n          options,\n        )\n      }\n\n      texteCorr = 'Voici les formules √† saisir dans le tableur :<br>'\n      for (let i = 0; i < steps.length; i++) {\n        const step = steps[i]\n        texteCorr += `$${step.oldn} ${operStr[i]} = ${step.result}$ devient en cellule ${alphabet[i + 1]}1 la formule suivante : \"=${alphabet[i]}1${operStr[i].replace('\\\\times', '*').replace('\\\\div', '/')}\"<br>`\n      }\n\n      const listener = () => {\n        const sheets = Array.from(\n          document.querySelectorAll('my-spreadsheet'),\n        ) as MySpreadsheetElement[]\n        for (const sheet of sheets) {\n          const q = sheet.id.match(/Q(\\d+)$/)?.[1]\n\n          const eventName =\n            q !== undefined && this.numeroExercice !== undefined\n              ? `checkEx${this.numeroExercice}Q${q}`\n              : undefined\n          if (sheet && eventName) {\n            const listener = (event: Event) => {\n              this.checkSolution(event as CustomEvent)\n            }\n            sheet.addListener(eventName, listener)\n          } else {\n            console.error(\n              `SheetElement not found or eventName invalid for question ${q} in exercice ${this.numeroExercice}`,\n            )\n          }\n        }\n        document.removeEventListener('exercicesAffiches', listener)\n      }\n      document.addEventListener('exercicesAffiches', listener, { once: true })\n\n      /****************************************************/\n      if (this.questionJamaisPosee(q, texte)) {\n        this.listeQuestions[q] = texte\n        this.listeCorrections[q] = texteCorr\n        q++\n      }\n      listeQuestionsToContenu(this)\n    }\n  }\n\n  correctionInteractive = (i: number) => {\n    if (i === undefined) return ''\n    if (this.answers === undefined) this.answers = {}\n    let result = 'KO'\n    const sheetElement = document.getElementById(\n      `sheet-Ex${this.numeroExercice}Q${i}`,\n    ) as MySpreadsheetElement\n    if (!sheetElement) {\n      console.error(`sheet-Ex${this.numeroExercice}Q${i} not found`)\n      return result\n    }\n    if (sheetElement && sheetElement.isMounted()) {\n      this.answers[`sheet-Ex${this.numeroExercice}Q${i}`] = JSON.stringify(\n        sheetElement.getData(),\n      )\n      const spanResultat = document.querySelector(\n        `#resultatCheckEx${this.numeroExercice}Q${i}`,\n      )\n      const divFeedback = document.querySelector<HTMLElement>(\n        `#feedbackEx${this.numeroExercice}Q${i}`,\n      )\n\n      const { isOk, messages } = this.validateFormulas(i, sheetElement)\n      if (messages.length > 0 && spanResultat && divFeedback) {\n        divFeedback.innerHTML = messages\n        if (!isOk) {\n          if (spanResultat) spanResultat.innerHTML = '‚òπÔ∏è'\n        } else {\n          if (spanResultat) spanResultat.innerHTML = 'üòé'\n          result = 'OK'\n        }\n      }\n    }\n    return result\n  }\n}\n\nconst LETTERS = ['A', 'B', 'C', 'D', 'E', 'F'] // A1..F1 max\n\n/**\n * Construit l'objet `style` de type { 'A1': '#color', ... } √† partir de `colos`\n * Nombre de cellules = listeSteps + 1, born√© √† A1..F1.\n *\n * R√®gles:\n * - Si colos est plus court que le nombre de cellules, on r√©p√®te la derni√®re couleur.\n * - Si listeSteps + 1 > 6, on tronque √† F1.\n */\nexport function buildStyleFromColos(\n  colos: string[],\n  listeSteps: number,\n): Record<string, string> {\n  const nbCells = Math.max(1, Math.min(listeSteps + 1, LETTERS.length))\n  const style: Record<string, string> = {}\n  for (let i = 0; i < nbCells; i++) {\n    const key = `${LETTERS[i]}1`\n    const color = colos[i] ? `background: ${colos[i]}` : 'background:  #ffffff'\n    style[key] = color\n  }\n  return style\n}\n\nfunction transformationsOper(\n  steps: {\n    oldn: number\n    op: number\n    val: number\n    result: number\n  }[],\n) {\n  function stepsToSymbols(\n    steps: {\n      oldn: number\n      op: number\n      val: number\n      result: number\n    }[],\n  ) {\n    const mapOps: Record<number, string> = {\n      1: '+',\n      2: '‚àí', // tiret long pour la soustraction\n      3: '\\\\times',\n      4: '\\\\div',\n    }\n    return steps.map((step) => (mapOps[step.op] || '?') + step.val)\n  }\n  return stepsToSymbols(steps)\n}\n\nfunction evaluate(a: number, op: number, b: number) {\n  if (op === 1) return a + b\n  if (op === 2) return a - b\n  if (op === 3) return a * b\n  if (op === 4) return a / b\n  return NaN\n}\n\n/**\n * G√©n√®re une suite d'op√©rations arithm√©tiques (+, ‚àí, √ó, √∑) appliqu√©es √† un nombre de d√©part,\n * en s‚Äôassurant que chaque op√©ration est valide et que le r√©sultat reste dans des limites acceptables.\n *\n * La fonction m√©lange al√©atoirement l‚Äôordre des op√©rations et choisit les op√©randes de fa√ßon √† ce que\n * chaque √©tape soit faisable (par exemple : pas de r√©sultats n√©gatifs, division donnant un entier, etc.).\n * Elle essaie jusqu‚Äô√† 20 fois de trouver une suite valide.\n *\n * @param operations - Un tableau de nombres repr√©sentant les op√©rations √† effectuer :\n *   1 pour addition (+), 2 pour soustraction (‚àí), 3 pour multiplication (√ó), 4 pour division (√∑).\n *   Par d√©faut : [1, 2, 3, 4].\n *\n * @returns Un objet contenant :\n *   - `ops` : L‚Äôordre final des op√©rations utilis√©es.\n *   - `steps` : Un tableau d‚Äôobjets repr√©sentant chaque √©tape, avec :\n *       - `oldn` : Le nombre avant l‚Äôop√©ration.\n *       - `op` : L‚Äôop√©ration effectu√©e.\n *       - `val` : L‚Äôop√©rande utilis√©e.\n *       - `result` : Le r√©sultat apr√®s l‚Äôop√©ration.\n *   - `final` : Le r√©sultat final apr√®s toutes les op√©rations, ou `null` si √©chec.\n * @example\n *\n * const resultat = programmeCalcul([1, 2, 3, 4]);\n *\n *\n * {\n *   ops: [3, 1, 4, 2], // ordre : √ó puis + puis √∑ puis ‚àí\n *   steps: [\n *     { oldn: 5, op: 3, val: 4, result: 20 }, // 5 √ó 4 = 20\n *     { oldn: 20, op: 1, val: 3, result: 23 }, // 20 + 3 = 23\n *     { oldn: 23, op: 4, val: 1, result: 23 }, // 23 √∑ 1 = 23\n *     { oldn: 23, op: 2, val: 5, result: 18 }  // 23 ‚àí 5 = 18\n *   ],\n *   final: 18\n * }\n */\n\ntype Step = {\n  oldn: number\n  op: number\n  val: number\n  result: number\n}\ntype Steps = Step[]\ntype ProgrammeCalculResult = {\n  ops: number[]\n  steps: Steps\n  final: number | null\n}\nfunction programmeCalcul(\n  operations: number[] = [1, 2, 3, 4],\n): ProgrammeCalculResult {\n  let steps: {\n    oldn: number\n    op: number\n    val: number\n    result: number\n  }[] = []\n  let final = null\n  let ops: number[] = operations\n\n  let k = 0\n  let success = false\n  while (!success && k < 20) {\n    ops = shuffle(ops) // ordre al√©atoire des op√©rations\n    let n = randint(5, 20) // nombre de d√©part\n    steps = [] // les √©tapes de calcul\n    success = true\n    for (let ind = 0, tt = 0; ind < ops.length && tt < 4; ) {\n      if (tt > 0) {\n        // tt : le nombre de tentatives\n        // on change l'ordre des op√©rations si √ßa bloque\n        const firstPart = ops.slice(0, ind)\n        const shuffledPart = shuffle(ops.slice(ind))\n        ops = [...firstPart, ...shuffledPart]\n      }\n      const op = ops[ind]\n      const oldn = n\n      let val: number = 1\n      const oldval: number = ind > 0 ? steps[ind - 1].val : 1\n      if (op === 1) {\n        // +\n        if (50 - n < 2 || (50 - n === 2 && oldval === 2)) {\n          tt++\n          continue\n        } else {\n          val = randint(2, 50 - n, [oldval])\n          n += val\n          ind++\n          tt = 0\n        }\n      } else if (op === 2) {\n        // -\n        if (n < 2 || (n === 2 && oldval === 2)) {\n          tt++\n          continue\n        } else {\n          val = randint(2, n, [oldval])\n          n -= val\n          ind++\n          tt = 0\n        }\n      } else if (op === 3) {\n        // √ó\n        const maxMult = n < 1 ? 5 : Math.floor(50 / n)\n        if (maxMult < 2 || (maxMult === 2 && oldval === 2)) {\n          tt++\n          continue\n        } else {\n          val = randint(2, maxMult, [oldval])\n          n *= val\n          ind++\n          tt = 0\n        }\n      } else if (op === 4) {\n        // √∑\n        const divs = listeDesDiviseurs(n).filter((d) => d > 1 && d < n)\n        if (divs.length === 0 || (divs.length === 1 && divs[0] === oldval)) {\n          tt++\n          continue\n        } else {\n          val = choice<number>(divs, [oldval])\n          n /= val\n          ind++\n          tt = 0\n        }\n      }\n\n      // s√©curit√© bornes\n      if (n < 0 || n > 50 || !Number.isInteger(n)) {\n        tt += 10 // on devrait jamais √™tre ici! donc on sort\n        continue\n      }\n      steps.push({ oldn, op, val, result: n })\n    }\n    if (steps.length !== ops.length) {\n      success = false\n    }\n    if (success) final = n\n    k++\n  }\n\n  return { ops, steps, final }\n}\n\nfunction createDigramm(\n  nbre: number,\n  rects: Record<string, { bg?: string; v?: string }>,\n) {\n  const longueur = 1.8\n  const largeur = 1.5\n  const gap = 0.8\n  const objets = []\n  for (let i = 0; i < nbre; i++) {\n    const A = point(i * longueur + i * gap, 0)\n    const B = point(A.x + longueur, 0)\n    const C = point(B.x, largeur)\n    const D = point(A.x, largeur)\n    const rect = rects[i]\n    const rectangle = polygone(A, B, C, D)\n    if (rect && rect.bg) {\n      rectangle.couleurDeRemplissage = colorToLatexOrHTML(rect.bg)\n      rectangle.opaciteDeRemplissage = 1\n    }\n    objets.push(rectangle)\n    if (rect && rect.v) {\n      const tex = latex2d(`${rect.v}`, (A.x + B.x) / 2, (A.y + D.y) / 2, {\n        color: 'red',\n        backgroundColor: 'none',\n        letterSize: context.isHtml ? 'small' : 'normalsize',\n        orientation: 0,\n        opacity: 1,\n      })\n      objets.push(tex)\n    }\n    if (i > 0) {\n      const seg = segment(A.x - gap, largeur / 2, A.x, largeur / 2, '#f15929')\n      seg.styleExtremites = '->'\n      objets.push(seg)\n    }\n  }\n  const xmin = -0.5\n  const ymin = -0.5\n  const xmax = +longueur * nbre + gap * (nbre - 1) + 0.5\n  const ymax = largeur + 0.5\n\n  return mathalea2d(\n    {\n      xmin,\n      ymin,\n      xmax,\n      ymax,\n      mainlevee: false,\n      scale: context.isHtml ? 1 : 0.5,\n      style: 'margin: auto',\n      optionsTikz: ['baseline=(current bounding box.north)'],\n    },\n    objets,\n  )\n}\n\nfunction createTableurLatex(\n  rowNbr: number,\n  colNbr: number,\n  data: any,\n  styles: any,\n  options: {\n    formule?: boolean\n    formuleTexte?: string\n    formuleCellule?: string\n    firstColHeaderWidth?: string\n  } = {},\n) {\n  let output = `\\\\begin{tabularx}{0.9\\\\linewidth}\n  {|>{\\\\cellcolor{lightgray}}c|\n  ${options.firstColHeaderWidth ? `>{\\\\centering \\\\arraybackslash}p{${options.firstColHeaderWidth}}|` : '>{\\\\centering \\\\arraybackslash}X|'}\n  *{${colNbr - 1}}{>{\\\\centering \\\\arraybackslash}X|}}\\\\hline\\n`\n\n  if (options.formule) {\n    output += `\\\\multicolumn{1}{|l}{${options.formuleCellule}}&\\\\multicolumn{1}{r|}{‚ñº}&\\\\multicolumn{${colNbr - 1}}{l|}{${options.formuleTexte}}\\\\\\\\ \\\\hline\\n`\n  }\n  // en-t√™te\n  output += '\\\\rowcolor{lightgray} &'\n  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n  for (let colIndex = 0; colIndex < colNbr - 1; colIndex++) {\n    output += `\\\\textbf{\\\\sffamily ${alphabet[colIndex]}}  & `\n  }\n  output += `\\\\textbf{\\\\sffamily ${alphabet[colNbr - 1]}} \\\\\\\\ \\\\hline\\n`\n\n  for (let rowIndex = 0; rowIndex < rowNbr; rowIndex++) {\n    const rowData = data[rowIndex] || {}\n    output += `\\\\textbf{\\\\sffamily ${rowIndex + 1}} &`\n    for (let colIndex = 0; colIndex < colNbr; colIndex++) {\n      const cell = rowData[colIndex] || {}\n      const styleCell = styles[cell.s ?? ''] || {}\n      let color = ''\n      if (styleCell.bg?.startsWith('#')) {\n        color = `\\\\cellcolor[HTML]{${styleCell.bg.replace('#', '')}}`\n      } else if (styleCell.bg) {\n        color = `\\\\cellcolor{${styleCell.bg}}`\n      }\n      if (cell?.t === 1) {\n        // texte\n        output += `\\\\raggedright ${color} ${cell.v || ''}  &`\n      } else if (cell?.t === 2) {\n        // number\n        output += `\\\\raggedleft ${color} ${cell.v || ''}  &`\n      } else if (cell?.t === 3) {\n        // boolean\n        output += `\\\\centering ${color} ${cell.v ? 'VRAI' : 'FAUX'}  &`\n      } else {\n        output += `${color} ${cell.v || ''}  &`\n      }\n    }\n    output = output.slice(0, -1) // enlever le dernier &\n    output += '\\\\\\\\ \\\\hline\\n'\n  }\n  output += '\\\\end{tabularx}\\n'\n  return output\n}\n"],"names":["titre","dateDePublication","interactifReady","interactifType","uuid","refs","alphabet","_ExerciceTableur","Exercice","__publicField","i","result","sheetElement","spanResultat","divFeedback","isOk","messages","destroy","q","userSheet","userData","nbSteps","testSheet","MySpreadsheetElement","n","a1","randint","resultats","range1","steps","evaluate","computed","texNombre","maxMessages","max","arr","feedback","event","eventName","_a","id","sheetElt","messagesDiv","nbOperations","typesDeOperations","gestionnaireFormulaireTexte","colorsArr","cpt","texte","texteCorr","programmeCalcul","operStr","transformationsOper","cellDatas","data","rect","k","createDigramm","style","buildStyleFromColos","context","addSheet","options","createTableurLatex","step","listener","sheets","sheet","listeQuestionsToContenu","ExerciceTableur","LETTERS","colos","listeSteps","nbCells","key","color","stepsToSymbols","mapOps","a","op","b","operations","final","ops","success","shuffle","ind","tt","firstPart","shuffledPart","oldn","val","oldval","maxMult","divs","listeDesDiviseurs","d","choice","nbre","rects","objets","A","point","B","C","D","rectangle","polygone","colorToLatexOrHTML","tex","latex2d","seg","segment","xmin","ymin","xmax","ymax","mathalea2d","rowNbr","colNbr","styles","output","colIndex","rowIndex","rowData","cell","styleCell"],"mappings":"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"}