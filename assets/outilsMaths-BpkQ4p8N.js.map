{"version":3,"file":"outilsMaths-BpkQ4p8N.js","sources":["../../src/lib/mathFonctions/outilsMaths.ts"],"sourcesContent":["import type { BoxedExpression } from '@cortex-js/compute-engine'\nimport { randint } from '../../modules/outils'\nimport engine, { generateCleaner } from '../interactif/comparisonFunctions'\nimport { ecritureAlgebrique } from '../outils/ecritures'\nimport { miseEnEvidence } from '../outils/embellissements'\nimport { Matrice, matrice } from './Matrice'\nimport { Polynome } from './Polynome'\n\n/**\n * delta(true) retourne dans un tableau des valeurs de a, b, c telles que b*b-4*a*c >0\n * delta(false) retourne dans un tableau des valeurs de a, b, c telles que b*b-4*a*c <0\n * @author Jean-Claude Lhote\n */\nexport function choisiDelta(positif: boolean) {\n  let d, a, b, c\n  do {\n    a = randint(-5, 5, 0)\n    b = randint(-5, 5, 0)\n    c = randint(-5, 5, 0)\n    d = b * b - 4 * a * c\n  } while (positif ? d <= 0 : d >= 0)\n  return [a, b, c]\n}\n\n/**\n * fonction qui retourne un polynome du second degré correctement écrit.\n * @author Jean-Claude Lhote\n * @param {number} a\n * @param {number} b\n * @param {number} c\n * @returns {string}\n */\nexport function expTrinome(a: number, b: number, c: number): string {\n  let expr = ''\n  if (typeof a === 'number') {\n    switch (a) {\n      case 0:\n        break\n      case -1:\n        expr += '-x^2'\n        break\n      case 1:\n        expr += 'x^2'\n        break\n      default:\n        expr += `${a}x^2`\n        break\n    }\n  } else {\n    expr += `${a}x^2`\n  }\n  if (typeof b === 'number') {\n    switch (b) {\n      case 0:\n        break\n      case -1:\n        expr += '-x'\n        break\n      case 1:\n        expr += '+x'\n        break\n      default:\n        if (a === 0) {\n          expr += `${b}`\n        } else expr += `${ecritureAlgebrique(b)}x`\n        break\n    }\n  } else {\n    if (a === 0) {\n      expr += `${b}x`\n    } else {\n      expr += `+${b}x`\n    }\n  }\n  if (typeof c === 'number') {\n    if (a === 0 && b === 0) {\n      expr += `${c}`\n    } else {\n      if (c !== 0) {\n        expr += `${ecritureAlgebrique(c)}`\n      }\n    }\n  } else {\n    expr += `+${c}`\n  }\n  return expr\n}\n\n/**\n * Une fonction qui retourrne le polynome de Lagrange passant par une liste de points\n * @author Jean-Claude Lhote\n * @param {{x:number,y:number}[]} listePoints\n * @return {Polynome}\n */\nexport function interpolationDeLagrange(\n  listePoints: { x: number; y: number }[],\n): Polynome {\n  // tout d'abord vérifier qu'il n'y a pas de doublons en x !\n  const listeOrdonnee = listePoints.sort((el1, el2) => el1.x - el2.x)\n  const setPoints = []\n  for (let i = 1; i < listeOrdonnee.length; i++) {\n    // si deux points qui se suivent dans la liste ordonnée ont des abscisses différentes, alors on peut stocker le plus petit\n    if (listeOrdonnee[i - 1].x !== listeOrdonnee[i].x)\n      setPoints.push(listeOrdonnee[i - 1])\n  }\n  // comme on n'a pas stocké le dernier, on le fait\n  setPoints.push(listeOrdonnee[listeOrdonnee.length - 1])\n  if (setPoints.length < 2)\n    throw Error(\n      \"Pour une interpolation de Lagrange, il faut au moins deux points d'abscisses différentes\",\n    )\n  const n = setPoints.length - 1\n  // On initialise à zéro\n  let result: Polynome = new Polynome({ coeffs: [0] })\n  for (let j = 0; j <= n; j++) {\n    // pour un produit on initialise à 1\n    let prod: number | Polynome = new Polynome({ coeffs: [1] })\n    for (let i = 0; i <= n; i++) {\n      if (j !== i) {\n        const den = setPoints[j].x - setPoints[i].x\n        prod = new Polynome({\n          coeffs: [-setPoints[i].x / den, 1 / den],\n        }).multiply(prod)\n      }\n    }\n    prod = (prod as Polynome).multiply(setPoints[j].y)\n    result = prod.add(result)\n  }\n  return result\n}\n\n/**\n * Fonction qui retourne les coefficients a et b de f(x)=ax²+bx+c à partir des données de x1,x2,f(x1),f(x2) et c.\n *@param {number} x1\n *@param {number} x2\n * @param {number} y1\n * @param {number} y1\n * @param {number} c\n * @return {[[number,number],[number,number]]}\n * @author Jean-Claude Lhote\n */\nexport function resolutionSystemeLineaire2x2(\n  x1: number,\n  x2: number,\n  fx1: number,\n  fx2: number,\n  c: number,\n): [number, number] {\n  const maMatrice = matrice([\n    [x1 ** 2, x1],\n    [x2 ** 2, x2],\n  ])\n  if (maMatrice.determinant() === 0) return [0, 0]\n  const resultat = maMatrice.inverse().multiply([fx1 - c, fx2 - c])\n  let arr: number[]\n  if (resultat instanceof Matrice) {\n    arr = resultat.toArray() as number[]\n  } else if (Array.isArray(resultat)) {\n    arr = resultat as number[]\n  } else {\n    return [0, 0]\n  }\n  const [a, b] = arr\n  return [a, b]\n}\n\n/**\n * Fonction qui retourne les coefficients a, b et c de f(x)=ax^3 + bx² + cx + d à partir des données de x1,x2,x3,f(x1),f(x2),f(x3) et d (entiers !)\n * sous forme de fraction irréductible. Si pas de solution (déterminant nul) alors retourne [[0,0],[0,0],[0,0]]\n * @author Jean-Claude Lhote\n */\nexport function resolutionSystemeLineaire3x3(\n  x1: number,\n  x2: number,\n  x3: number,\n  fx1: number,\n  fx2: number,\n  fx3: number,\n  d: number,\n): [Number, Number, number] {\n  const maMatrice = matrice([\n    [x1 ** 3, x1 ** 2, x1],\n    [x2 ** 3, x2 ** 2, x2],\n    [x3 ** 3, x3 ** 2, x3],\n  ])\n  const y1 = fx1 - d\n  const y2 = fx2 - d\n  const y3 = fx3 - d\n  if (maMatrice && maMatrice.determinant() === 0) {\n    return [0, 0, 0]\n  }\n  const resultat = maMatrice.inverse().multiply([y1, y2, y3])\n  let arr: number[]\n  if (resultat instanceof Matrice) {\n    arr = resultat.toArray() as number[]\n  } else if (Array.isArray(resultat)) {\n    arr = resultat as number[]\n  } else {\n    return [0, 0, 0]\n  }\n  const [a, b, c] = arr\n  return [a, b, c]\n}\n\n/**\n * Une fonction utilisée dans les 3 fonctions qui suivent (suppressionParentheses, regroupeTermesMemeDegre et developpe afin de colorier ou pas les termes\n * @author Jean-Claude Lhote\n * @param str\n * @param color\n * @param isColored\n * @return {string|*}\n */\nconst miseEnForme = (str: string, color: string, isColored: boolean) =>\n  isColored ? miseEnEvidence(str, color) : str\nfunction neg(expr: BoxedExpression): BoxedExpression {\n  if (expr.operator !== 'Add')\n    return engine.function('Multiply', [expr, engine.parse('-1')])\n  const ops = expr.ops ?? []\n  if (ops.length === 0)\n    return engine.function('Multiply', [expr, engine.parse('-1')])\n  else\n    return engine.function('Add', ops.map(neg), {\n      canonical: false,\n      structural: false,\n    })\n}\n\n/**\n * Une fonction pour supprimer les parenthèses et aplatir l'expression (un Add avec une série de termes)\n * @author Jean-Claude Lhote\n * @param expr\n * @return {*|BoxedExpression}\n */\nfunction flattenAdd(expr: BoxedExpression): BoxedExpression {\n  if (expr.operator === 'Negate') {\n    const oppose = neg(expr.op1)\n    const newExpr = engine.function('Add', [oppose], {\n      canonical: false,\n      structural: false,\n    })\n    return newExpr\n  }\n  if (expr.operator === 'Subtract') {\n    const oppose = neg(expr.op2)\n    const newExpr = engine.function('Add', [expr.op1, oppose], {\n      canonical: false,\n      structural: false,\n    })\n    return flattenAdd(newExpr)\n  }\n\n  if (expr.operator !== 'Add') return expr\n\n  const ops = []\n  for (let op of expr.ops ?? []) {\n    op = flattenAdd(op)\n    if (op.operator === 'Add' || op.operator === 'Delimiter')\n      ops.push(...(op.ops ?? []).map(flattenAdd))\n    else ops.push(op)\n  }\n  return engine.function('Add', ops, { canonical: false, structural: false })\n}\n\n/**\n * Supprime les parenthèses dans une somme du type (5x+3)-(2x^2-3x+4)+(4x+7-3x^3)\n * @author Jean-Claude Lhote\n * @param {string} exp\n * @param {{color: boolean}} options\n */\nexport function suppressionParentheses(\n  exp: string,\n  options: { couleurs?: string[]; isColored?: boolean },\n) {\n  const couleurs = options.couleurs ?? [\n    'red',\n    'blue',\n    'green',\n    'black',\n    'red',\n    'blue',\n    'green',\n    'black',\n  ]\n  const isColored = options?.isColored\n  const clean = generateCleaner([\n    'parentheses',\n    'espaces',\n    'virgules',\n    'fractions',\n  ])\n  exp = clean(exp)\n  const arbre = engine.parse(exp, { canonical: false })\n  const sp = flattenAdd(flattenAdd(arbre))\n  const parts = sp.ops ?? []\n  let expressionFinale = ''\n  for (let index = 0; index < parts.length; index++) {\n    const latex = parts[index].latex.startsWith('-')\n      ? parts[index].latex\n      : index === 0\n        ? parts[index].latex\n        : `+${parts[index].latex}`\n    const hereIsPower = parts[index].getSubexpressions('Power')[0]\n    let deg = 0\n    if (hereIsPower != null) {\n      deg = Number(hereIsPower.op2.value)\n    } else {\n      if (parts[index].operator === 'Square') {\n        deg = 2\n      } else if (parts[index].operator === 'Negate') {\n        if (parts[index].op1.isConstant) {\n          deg = 0\n        } else {\n          deg = 1\n        }\n      } else if (parts[index].isConstant) {\n        deg = 0\n      } else {\n        deg = 1\n      }\n    }\n\n    expressionFinale += miseEnForme(\n      latex,\n      couleurs[Math.max(0, 2 - deg)],\n      isColored ?? false,\n    )\n  }\n  return expressionFinale\n}\n\n/**\n * une fonction pour trier les termes d'une somme algébrique selon l'exposant de la puissance\n * @author Jean-Claude Lhote\n * @param {string} exp\n */\nexport function regroupeTermesMemeDegre(\n  exp: string,\n  options: { couleurs?: string[]; isColored?: boolean },\n) {\n  const couleurs = options.couleurs ?? [\n    'red',\n    'blue',\n    'green',\n    'black',\n    'red',\n    'blue',\n    'green',\n    'black',\n  ]\n  const isColored = options?.isColored\n  const clean = generateCleaner([\n    'parentheses',\n    'espaces',\n    'virgules',\n    'fractions',\n  ])\n  exp = clean(exp)\n  if (exp.length === 0) return ''\n  const arbre = engine.parse(exp, { canonical: false })\n  const parts = flattenAdd(arbre).ops ?? []\n  const allTheTerms: string[][] = []\n  for (let index = 0; index < parts.length; index++) {\n    let deg = 0\n    const terme = parts[index]\n    if (terme.getSubexpressions('Power')[0] != null) {\n      deg = Number(terme.getSubexpressions('Power')[0].op2.numericValue)\n    } else if (terme.operator === 'Square') {\n      deg = 2\n    } else if (terme.operator === 'Negate') {\n      if (terme.op1.isConstant) {\n        deg = 0\n      } else {\n        deg = 1\n      }\n    } else if (terme.isConstant) {\n      deg = 0\n    } else {\n      deg = 1\n    }\n\n    const latex = parts[index].latex.startsWith('-')\n      ? parts[index].latex\n      : index === 0\n        ? parts[index].latex\n        : `+${parts[index].latex}`\n    if (allTheTerms[deg] == null) allTheTerms[deg] = []\n    allTheTerms[deg].push(latex)\n  }\n  const expressionFinale = []\n  for (let i = allTheTerms.length; i > 0; i--) {\n    const listOfTerm = allTheTerms[i - 1]\n    if (listOfTerm != null && listOfTerm.length > 0) {\n      let parcel = ''\n      for (let term of listOfTerm) {\n        if (term.startsWith('+') && parcel === '') term = term.substring(1)\n        parcel += term\n      }\n      expressionFinale.push(\n        `(${miseEnForme(parcel, couleurs[Math.max(0, 2 - (i - 1))], isColored ?? false)})`,\n      )\n    }\n  }\n  return expressionFinale.join('+')\n}\n\nconst isNumeric = (node: BoxedExpression) => node.isNumberLiteral\nconst isSingleSymbol = (node: BoxedExpression) =>\n  node.symbol && node.symbol.length === 1 && node.latex.length === 1\n\n/**\n * @author Jean-Claude Lhote\n * @param expr\n * @param {{isColored: boolean, colorOffset: number, level: 0|1}} options\n * @return {string}\n */\nexport function developpe(\n  expr: string,\n  options: {\n    couleurs?: string[]\n    isColored: boolean\n    colorOffset?: number\n    level?: 0 | 1 | 2\n  },\n): string {\n  const isColored = options?.isColored\n  const colorOffset = options.colorOffset ?? 0\n  const level = options?.level ?? 0\n  const clean = generateCleaner(['parentheses', 'fractions'])\n  const couleurs = options.couleurs ?? [\n    'red',\n    'blue',\n    'green',\n    'black',\n    'red',\n    'blue',\n    'green',\n    'black',\n  ]\n  expr = clean(expr)\n  const arbre = engine.parse(expr)\n  if (!['Square', 'Multiply', 'Power'].includes(arbre.operator)) {\n    // On ne développe que les produits où les carrés ici\n    return expr.replaceAll('\\\\frac', '\\\\dfrac')\n  }\n  if (arbre.operator === 'Square' || arbre.operator === 'Power') {\n    // on est sans doute en présence d'une égalité remarquable ?\n    if (arbre.op2.numericValue !== 2)\n      return expr.replaceAll('\\\\frac', '\\\\dfrac')\n    const interior = arbre.op1\n    const somme = interior.operator === 'Add'\n    const terme1 = interior.op1\n    const terme2 = interior.op2\n    const carre1 = isNumeric(terme1)\n      ? terme1.latex.startsWith('-')\n        ? `\\\\left( ${terme1.latex}\\\\right) ^2`\n        : `${terme1.latex}^2`\n      : isSingleSymbol(terme1)\n        ? `${terme1.latex}^2`\n        : `\\\\left( ${terme1.latex}\\\\right) ^2`\n    const carre2 = isNumeric(terme2)\n      ? terme2.latex.startsWith('-')\n        ? `\\\\left( ${terme2.latex}\\\\right) ^2`\n        : `${terme2.latex}^2`\n      : isSingleSymbol(terme2)\n        ? `${terme2.latex}^2`\n        : `\\\\left( ${terme2.latex}\\\\right) ^2`\n    const dbleProd = `2\\\\times ${\n      isNumeric(terme1)\n        ? terme1.latex.startsWith('-')\n          ? `\\\\left( ${terme1.latex}\\\\right) `\n          : `${terme1.latex}`\n        : isSingleSymbol(terme1)\n          ? `${terme1.latex}`\n          : `\\\\left( ${terme1.latex}\\\\right) `\n    }\\\\times ${\n      isNumeric(terme2)\n        ? terme2.latex.startsWith('-')\n          ? `\\\\left( ${terme2.latex}\\\\right) `\n          : `${terme2.latex}`\n        : isSingleSymbol(terme2)\n          ? `${terme2.latex}`\n          : `\\\\left( ${terme2.latex}\\\\right) `\n    }`\n    if (level === 2) {\n      return `${miseEnForme(carre1, couleurs[colorOffset], isColored)}${somme ? '+' : '-'}${miseEnForme(dbleProd, couleurs[colorOffset + 1], isColored)}+${miseEnForme(carre2, couleurs[colorOffset + 2], isColored)}`.replaceAll(\n        '\\\\frac',\n        '\\\\dfrac',\n      )\n    } else {\n      const dp = engine.parse(dbleProd).simplify().latex\n      const c1 = engine.box(['Multiply', terme1, terme1]).evaluate().latex\n      const c2 = engine.box(['Multiply', terme2, terme2]).evaluate().latex\n      return `${miseEnForme(c1, couleurs[colorOffset], isColored)}${somme ? '+' : '-'}${miseEnForme(dp, couleurs[colorOffset + 1], isColored)}+${miseEnForme(c2, couleurs[colorOffset + 2], isColored)}`.replaceAll(\n        '\\\\frac',\n        '\\\\dfrac',\n      )\n    }\n  } else {\n    // Ici c'est un produit classique.\n    const facteur1 = arbre.op1\n    const facteur2 = arbre.op2\n    const terme1 = facteur1.op1\n    const terme2 = facteur1.op2\n    const somme1 = facteur1.operator === 'Add'\n    const terme3 = facteur2.op1\n    const terme4 = facteur2.op2\n    const somme2 = facteur2.operator === 'Add'\n    const t1 = terme1.latex.startsWith('-')\n      ? `\\\\left( ${terme1.latex}\\\\right) `\n      : terme1.latex\n    const t2 = terme2.latex.startsWith('-')\n      ? `\\\\left( ${terme2.latex}\\\\right) `\n      : terme2.latex\n\n    const t3 = terme3.latex.startsWith('-')\n      ? `\\\\left( ${terme3.latex}\\\\right) `\n      : terme3.latex\n    const t4 = terme4.latex.startsWith('-')\n      ? `\\\\left( ${terme4.latex}\\\\right) `\n      : terme4.latex\n    if (level === 2) {\n      return `${miseEnForme(t1, couleurs[colorOffset], isColored)}\\\\times ${miseEnForme(t3, couleurs[colorOffset], isColored)}\n    ${somme2 ? '+' : '-'}${miseEnForme(t1, couleurs[colorOffset + 1], isColored)}\\\\times ${miseEnForme(t4, couleurs[colorOffset + 1], isColored)}\n    ${somme1 ? '+' : '-'}${miseEnForme(t2, couleurs[colorOffset + 1], isColored)}\\\\times ${miseEnForme(t3, couleurs[colorOffset + 1], isColored)}\n    ${somme1 === somme2 ? '+' : '-'}${miseEnForme(t2, couleurs[colorOffset + 2], isColored)}\\\\times ${miseEnForme(t4, couleurs[colorOffset + 2], isColored)}`.replaceAll(\n        '\\\\frac',\n        '\\\\dfrac',\n      )\n    } else {\n      const prod1 = engine\n        .box(['Multiply', terme1, terme3])\n        .evaluate()\n        .simplify().latex\n      const prod2 = engine\n        .box(['Multiply', terme1, terme4])\n        .evaluate()\n        .simplify().latex\n      const prod3 = engine\n        .box(['Multiply', terme2, terme3])\n        .evaluate()\n        .simplify().latex\n      const prod4 = engine\n        .box(['Multiply', terme2, terme4])\n        .evaluate()\n        .simplify().latex\n      if (level === 1) {\n        const p2 = prod2.startsWith('-') ? `\\\\left( ${prod2}\\\\right)` : prod2\n        const p3 = prod3.startsWith('-') ? `\\\\left( ${prod3}\\\\right)` : prod3\n        const p4 = prod4.startsWith('-') ? `\\\\left( ${prod4}\\\\right)` : prod4\n        return `${miseEnForme(prod1, couleurs[colorOffset], isColored)}\n        ${somme2 ? '+' : '-'}${miseEnForme(p2, couleurs[colorOffset + 1], isColored)}\n        ${somme1 ? '+' : '-'}${miseEnForme(p3, couleurs[colorOffset + 1], isColored)}\n        ${somme1 === somme2 ? '+' : '-'}${miseEnForme(p4, couleurs[colorOffset + 1], isColored)}`.replaceAll(\n          '\\\\frac',\n          '\\\\dfrac',\n        )\n      } else {\n        const p2 = prod2.startsWith('-')\n          ? somme2\n            ? prod2\n            : `+${prod2.substring(1)}`\n          : somme2\n            ? `+${prod2}`\n            : `-${prod2}`\n        const p3 = prod3.startsWith('-')\n          ? somme1\n            ? prod3\n            : `+${prod3.substring(1)}`\n          : somme1\n            ? `+${prod3}`\n            : `-${prod3}`\n        const p4 = prod4.startsWith('-')\n          ? somme1 === somme2\n            ? prod4\n            : `+${prod4.substring(1)}`\n          : somme1 === somme2\n            ? `+${prod4}`\n            : `-${prod4}`\n\n        return `${miseEnForme(prod1, couleurs[colorOffset], isColored)}\n        ${miseEnForme(p2, couleurs[colorOffset + 1], isColored)}\n        ${miseEnForme(p3, couleurs[colorOffset + 2], isColored)}\n        ${miseEnForme(p4, couleurs[colorOffset + 3], isColored)}`.replaceAll(\n          '\\\\frac',\n          '\\\\dfrac',\n        )\n      }\n    }\n  }\n}\n"],"names":["choisiDelta","positif","d","a","b","c","randint","interpolationDeLagrange","listePoints","listeOrdonnee","el1","el2","setPoints","i","n","result","Polynome","j","prod","den","resolutionSystemeLineaire2x2","x1","x2","fx1","fx2","maMatrice","matrice","resultat","arr","Matrice","resolutionSystemeLineaire3x3","x3","fx3","y1","y2","y3","miseEnForme","str","color","isColored","miseEnEvidence","neg","expr","engine","ops","flattenAdd","oppose","newExpr","op","suppressionParentheses","exp","options","couleurs","generateCleaner","arbre","parts","expressionFinale","index","latex","hereIsPower","deg","regroupeTermesMemeDegre","allTheTerms","terme","listOfTerm","parcel","term","isNumeric","node","isSingleSymbol","developpe","colorOffset","level","clean","interior","somme","terme1","terme2","carre1","carre2","dbleProd","dp","c1","c2","facteur1","facteur2","somme1","terme3","terme4","somme2","t1","t2","t3","t4","prod1","prod2","prod3","prod4","p2","p3","p4"],"mappings":"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"}