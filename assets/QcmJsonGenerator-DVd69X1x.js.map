{"version":3,"file":"QcmJsonGenerator-DVd69X1x.js","sources":["../../src/exercices/beta/QcmJsonGenerator.ts"],"sourcesContent":["import { choice } from '../../lib/outils/arrayOutils'\nimport ExerciceQcm from '../ExerciceQcm'\n\n// Type pour définir la structure d'une question QCM dans le JSON\nexport interface QuestionQcm {\n  enonce: string\n  reponses: string[]\n  corrections?: string[]\n  bonnesReponses?: boolean[]\n}\n\n// Type pour la structure complète du JSON\nexport interface QcmJsonData {\n  titre: string\n  consigne?: string\n  questions: QuestionQcm[]\n  options?: {\n    vertical?: boolean\n    ordered?: boolean\n    lastChoice?: number\n  }\n}\nconst qcmData: QcmJsonData = {\n  titre: 'QCM Mathématiques - Exemple',\n  consigne: 'Choisissez la bonne réponse.',\n  options: {\n    vertical: false,\n    ordered: false,\n    lastChoice: 8,\n  },\n  questions: [\n    {\n      enonce: 'Combien font $2 + 2$ ?',\n      reponses: [\n        '$4$', // Bonne réponse (toujours en premier)\n        '$3$',\n        '$5$',\n        '$22$',\n      ],\n      corrections: [\n        'Correct ! $2 + 2 = 4$',\n        'Erreur : vérifiez votre calcul',\n        'Erreur : $2 + 2 \\\\neq 5$',\n        \"Erreur : ce n'est pas une concaténation\",\n      ],\n    },\n    {\n      enonce: 'Quelle est la racine carrée de $16$ ?',\n      reponses: [\n        '$4$', // Bonne réponse\n        '$8$',\n        '$2$',\n        '$6$',\n      ],\n      corrections: [\n        'Correct ! $\\\\sqrt{16} = 4$ car $4^2 = 16$',\n        'Erreur : $8^2 = 64$',\n        'Erreur : $2^2 = 4$',\n        'Erreur : $6^2 = 36$',\n      ],\n    },\n    {\n      enonce: 'Quelle est la valeur de $\\\\pi$ (approximation) ?',\n      reponses: [\n        '$3,14$', // Bonne réponse\n        '$3,41$',\n        '$2,71$',\n        '$1,41$',\n      ],\n      corrections: [\n        'Correct ! $\\\\pi \\\\approx 3,14159...$',\n        'Erreur : vous avez inversé les chiffres',\n        \"Erreur : c'est l'approximation de $e$\",\n        \"Erreur : c'est l'approximation de $\\\\sqrt{2}$\",\n      ],\n    },\n  ],\n}\nexport const titre = \"Générateur d'exercices QCM à partir de JSON\"\nexport const dateDePublication = '3/7/2025'\nexport const refs = {\n  'fr-fr': [],\n  'fr-ch': ['NR'],\n}\nexport const uuid = 'QcmGen'\n/**\n * Générateur d'exercices QCM basé sur des données JSON\n * Cette classe permet de créer des exercices QCM à partir d'un fichier JSON\n * contenant une liste de questions avec leurs réponses et corrections\n */\nexport default class QcmJsonGenerator extends ExerciceQcm {\n  private jsonData: QcmJsonData\n  private questionsDisponibles: QuestionQcm[]\n\n  constructor(jsonData: QcmJsonData) {\n    super()\n    this.jsonData = jsonData ?? qcmData // Utiliser les données par défaut si aucune donnée n'est fournie\n    this.questionsDisponibles = [...this.jsonData.questions]\n\n    // Configuration des options si fournies dans le JSON\n    if (this.jsonData.options) {\n      this.options = { ...this.options, ...this.jsonData.options }\n    }\n\n    // Permettre plusieurs questions si le JSON en contient plusieurs\n    this.nbQuestions = Math.min(this.jsonData.questions.length, 10) // Limiter à 10 questions max\n    this.nbQuestionsModifiable = this.jsonData.questions.length > 1\n\n    // Titre de l'exercice\n    if (this.jsonData.titre) {\n      this.titre = this.jsonData.titre\n    }\n\n    // Consigne personnalisée si fournie\n    if (this.jsonData.consigne) {\n      this.consigne = this.jsonData.consigne\n    }\n  }\n\n  /**\n   * Version originale qui prend la première question du JSON\n   */\n  versionOriginale = () => {\n    if (this.questionsDisponibles.length === 0) {\n      throw new Error('Aucune question disponible dans les données JSON')\n    }\n\n    const question = this.questionsDisponibles[0]\n    this.enonce = question.enonce\n    this.reponses = [...question.reponses]\n\n    // Gérer les corrections si présentes\n    if (question.corrections) {\n      this.corrections = [...question.corrections]\n    }\n\n    // Gérer les bonnes réponses si présentes (pour QCM à réponses multiples)\n    if (question.bonnesReponses) {\n      this.bonnesReponses = [...question.bonnesReponses]\n    }\n\n    // Correction par défaut si pas de corrections spécifiques\n    if (!this.corrections || this.corrections.length === 0) {\n      this.correction = 'La bonne réponse est la première de la liste.'\n    }\n  }\n\n  /**\n   * Version aléatoire qui choisit une question au hasard\n   */\n  versionAleatoire = () => {\n    if (this.questionsDisponibles.length === 0) {\n      throw new Error('Aucune question disponible dans les données JSON')\n    }\n\n    const question = choice(this.questionsDisponibles)\n    this.enonce = question.enonce\n    this.reponses = [...question.reponses]\n\n    // Gérer les corrections si présentes\n    if (question.corrections) {\n      this.corrections = [...question.corrections]\n    }\n\n    // Gérer les bonnes réponses si présentes (pour QCM à réponses multiples)\n    if (question.bonnesReponses) {\n      this.bonnesReponses = [...question.bonnesReponses]\n    }\n\n    // Correction par défaut si pas de corrections spécifiques\n    if (!this.corrections || this.corrections.length === 0) {\n      this.correction = 'La bonne réponse est la première de la liste.'\n    }\n  }\n\n  /**\n   * Méthode pour charger des données JSON depuis un objet\n   * @param jsonData - Les données JSON à charger\n   */\n  static fromJson(jsonData: QcmJsonData): QcmJsonGenerator {\n    return new QcmJsonGenerator(jsonData)\n  }\n\n  /**\n   * Méthode pour valider la structure des données JSON\n   * @param data - Les données à valider\n   * @returns true si les données sont valides\n   */\n  static validateJsonData(data: any): data is QcmJsonData {\n    if (!data || typeof data !== 'object') return false\n    if (!data.titre || typeof data.titre !== 'string') return false\n    if (!Array.isArray(data.questions) || data.questions.length === 0)\n      return false\n\n    // Vérifier chaque question\n    for (const question of data.questions) {\n      if (!question.enonce || typeof question.enonce !== 'string') return false\n      if (!Array.isArray(question.reponses) || question.reponses.length < 2)\n        return false\n\n      // Vérifier que toutes les réponses sont des strings\n      for (const reponse of question.reponses) {\n        if (typeof reponse !== 'string') return false\n      }\n\n      // Vérifier les corrections si présentes\n      if (question.corrections) {\n        if (!Array.isArray(question.corrections)) return false\n        for (const correction of question.corrections) {\n          if (typeof correction !== 'string') return false\n        }\n      }\n\n      // Vérifier les bonnes réponses si présentes\n      if (question.bonnesReponses) {\n        if (!Array.isArray(question.bonnesReponses)) return false\n        if (question.bonnesReponses.length !== question.reponses.length)\n          return false\n        for (const statut of question.bonnesReponses) {\n          if (typeof statut !== 'boolean') return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  /**\n   * Méthode pour obtenir une question aléatoire différente des précédentes\n   * @param questionsDejaUtilisees - Liste des questions déjà utilisées\n   * @returns Une nouvelle question ou null si toutes ont été utilisées\n   */\n  private getQuestionAleatoire(\n    questionsDejaUtilisees: QuestionQcm[],\n  ): QuestionQcm | null {\n    const questionsRestantes = this.questionsDisponibles.filter(\n      (q) => !questionsDejaUtilisees.includes(q),\n    )\n\n    if (questionsRestantes.length === 0) {\n      return null\n    }\n\n    return choice(questionsRestantes)\n  }\n\n  /**\n   * Redéfinition pour gérer les questions multiples de façon aléatoire\n   */\n  nouvelleVersion() {\n    // Utiliser la version originale par défaut\n    this.versionOriginale()\n    super.nouvelleVersion()\n  }\n}\n"],"names":["qcmData","titre","dateDePublication","refs","uuid","QcmJsonGenerator","ExerciceQcm","jsonData","__publicField","question","choice","data","reponse","correction","statut","questionsDejaUtilisees","questionsRestantes","q"],"mappings":"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"}