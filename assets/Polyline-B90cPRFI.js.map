{"version":3,"file":"Polyline-B90cPRFI.js","sources":["../../src/lib/2d/Polyline.ts"],"sourcesContent":["import { arrondi } from '../outils/nombres'\nimport { colorToLatexOrHTML } from './colorToLatexOrHtml'\nimport type { IPoint3d } from './Interfaces'\nimport { ObjetMathalea2D } from './ObjetMathalea2D'\nimport { PointAbstrait } from './PointAbstrait'\nimport { segment } from './segmentsVecteurs'\n\n/**\n * polyline(A,B,C,D,E) //Trace la ligne brisée ABCDE\n *\n * @author Rémi Angot\n */\n\nexport class Polyline extends ObjetMathalea2D {\n  listePoints: PointAbstrait[]\n  listePoints3d: IPoint3d[]\n  nom: string\n  stringColor: string\n  // Surcharges pour faciliter l'inférence de types\n  constructor(...points: PointAbstrait[])\n  constructor(...points: [...PointAbstrait[], string])\n  constructor(...points: IPoint3d[])\n  constructor(...points: [...IPoint3d[], string])\n  constructor(points: PointAbstrait[], color?: string)\n  constructor(points: IPoint3d[], color?: string)\n  constructor(...args: any[]) {\n    super()\n    this.epaisseur = 1\n    this.pointilles = 0\n    this.opacite = 1\n\n    // Normalisation des arguments\n    let pts: any[] = []\n    let colorArg: string | undefined\n\n    if (\n      (args.length === 1 && Array.isArray(args[0])) ||\n      (args.length === 2 && Array.isArray(args[0]))\n    ) {\n      // new Polyline([A, B, C]) ou new Polyline([A, B, C], 'red')\n      pts = args[0]\n      if (typeof args[1] === 'string') colorArg = args[1]\n    } else {\n      // new Polyline(A, B, C) ou new Polyline(A, B, C, 'red')\n      if (typeof args[args.length - 1] === 'string') {\n        colorArg = args.pop()\n      }\n      pts = args\n    }\n\n    // Séparation des points 2D et 3D\n    this.listePoints = (pts as any[]).filter(\n      (el) => el instanceof PointAbstrait,\n    )\n    this.listePoints3d = (pts as any[]).filter(\n      (el) => el && typeof el === 'object' && 'c2d' in el,\n    ) as IPoint3d[]\n\n    // Couleur\n    this.stringColor = colorArg ?? 'black'\n    this.color = colorToLatexOrHTML(this.stringColor)\n\n    let xmin = 1000\n    let xmax = -1000\n    let ymin = 1000\n    let ymax = -1000\n    for (const unPoint of this.listePoints) {\n      if (unPoint.typeObjet !== 'point')\n        window.notify('Polyline : argument invalide', { points: pts })\n      xmin = Math.min(xmin, unPoint.x)\n      xmax = Math.max(xmax, unPoint.x)\n      ymin = Math.min(ymin, unPoint.y)\n      ymax = Math.max(ymax, unPoint.y)\n    }\n    this.bordures = [xmin, ymin, xmax, ymax]\n    this.nom = ''\n    if (this.listePoints.length < 15) {\n      // Ne nomme pas les lignes brisées trop grandes (pratique pour les courbes de fonction)\n      for (const point of this.listePoints) {\n        this.nom += point.nom\n      }\n      for (const point of this.listePoints3d) {\n        this.nom += point.label\n      }\n    }\n  }\n\n  svg(coeff: number) {\n    if (this.epaisseur !== 1) {\n      this.style += ` stroke-width=\"${this.epaisseur}\" `\n    }\n    switch (this.pointilles) {\n      case 1:\n        this.style += ' stroke-dasharray=\"6 10\" '\n        break\n      case 2:\n        this.style += ' stroke-dasharray=\"6 3\" '\n        break\n      case 3:\n        this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n        break\n      case 4:\n        this.style += ' stroke-dasharray=\"1 2\" '\n        break\n      case 5:\n        this.style += ' stroke-dasharray=\"5 5\" '\n        break\n    }\n\n    if (this.opacite !== 1) {\n      this.style += ` stroke-opacity=\"${this.opacite}\" `\n    }\n    let binomeXY = ''\n    for (const point of this.listePoints) {\n      const X = point.xSVG(coeff)\n      const Y = point.ySVG(coeff)\n      binomeXY += `${X},${Y} `\n    }\n    for (const point of this.listePoints3d) {\n      const X = point.c2d.x * coeff\n      const Y = -point.c2d.y * coeff\n      binomeXY += `${X},${Y} `\n    }\n    return `<polyline points=\"${binomeXY}\" fill=\"none\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" />`\n  }\n\n  tikz() {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    let binomeXY = ''\n    for (const point of this.listePoints) {\n      binomeXY += `(${arrondi(point.x)},${arrondi(point.y)})--`\n    }\n    binomeXY = binomeXY.substr(0, binomeXY.length - 2)\n    return `\\\\draw${optionsDraw} ${binomeXY};`\n  }\n\n  svgml(coeff: number, amp: number) {\n    let code = ''\n    let s\n    for (let k = 1; k < this.listePoints.length; k++) {\n      s = segment(\n        this.listePoints[k - 1],\n        this.listePoints[k],\n        this.stringColor,\n      )\n      s.epaisseur = this.epaisseur\n      s.opacite = this.opacite\n      code += s.svgml(coeff, amp)\n    }\n    return code\n  }\n\n  tikzml(amp: number) {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    tableauOptions.push(\n      `decorate,decoration={random steps , segment length=3pt, amplitude = ${amp}pt}`,\n    )\n\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    let binomeXY = ''\n    for (const point of this.listePoints) {\n      binomeXY += `(${arrondi(point.x)},${arrondi(point.y)})--`\n    }\n    binomeXY = binomeXY.substr(0, binomeXY.length - 2)\n    return `\\\\draw${optionsDraw} ${binomeXY};`\n  }\n}\n// Surcharges de la fabrique pour refléter celles du constructeur\n\nexport function polyline(...points: PointAbstrait[]): Polyline\nexport function polyline(...points: [...PointAbstrait[], string]): Polyline\nexport function polyline(...points: IPoint3d[]): Polyline\nexport function polyline(...points: [...IPoint3d[], string]): Polyline\nexport function polyline(points: PointAbstrait[], color?: string): Polyline\nexport function polyline(points: IPoint3d[], color?: string): Polyline\nexport function polyline(...args: any[]): Polyline {\n  return new Polyline(...(args as any))\n}\n"],"names":["Polyline","ObjetMathalea2D","args","__publicField","pts","colorArg","el","PointAbstrait","colorToLatexOrHTML","xmin","xmax","ymin","ymax","unPoint","point","coeff","binomeXY","X","Y","tableauOptions","optionsDraw","arrondi","amp","code","s","k","segment","polyline"],"mappings":"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"}