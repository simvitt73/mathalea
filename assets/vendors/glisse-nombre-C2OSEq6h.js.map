{"version":3,"file":"glisse-nombre-C2OSEq6h.js","sources":["../../../node_modules/.pnpm/glisse-nombre@git+https+++forge.apps.education.fr+coopmaths+apps+glisse-nombre.git+f4f8_19d4b1f6f89d31467cd5ee252cecb611/node_modules/glisse-nombre/src/lib/env.ts","../../../node_modules/.pnpm/glisse-nombre@git+https+++forge.apps.education.fr+coopmaths+apps+glisse-nombre.git+f4f8_19d4b1f6f89d31467cd5ee252cecb611/node_modules/glisse-nombre/src/lib/overlay-position.ts","../../../node_modules/.pnpm/glisse-nombre@git+https+++forge.apps.education.fr+coopmaths+apps+glisse-nombre.git+f4f8_19d4b1f6f89d31467cd5ee252cecb611/node_modules/glisse-nombre/src/lib/handleDrag.ts","../../../node_modules/.pnpm/glisse-nombre@git+https+++forge.apps.education.fr+coopmaths+apps+glisse-nombre.git+f4f8_19d4b1f6f89d31467cd5ee252cecb611/node_modules/glisse-nombre/src/lib/handleKeys.ts","../../../node_modules/.pnpm/glisse-nombre@git+https+++forge.apps.education.fr+coopmaths+apps+glisse-nombre.git+f4f8_19d4b1f6f89d31467cd5ee252cecb611/node_modules/glisse-nombre/src/lib/overlay-animation.ts","../../../node_modules/.pnpm/glisse-nombre@git+https+++forge.apps.education.fr+coopmaths+apps+glisse-nombre.git+f4f8_19d4b1f6f89d31467cd5ee252cecb611/node_modules/glisse-nombre/src/lib/GlisseNombreElement.ts"],"sourcesContent":["export const env = {\n  UNITS_WIDTH: {\n    sm: '2em',\n    md: '5em',\n    lg: '6em',\n  },\n  UNITS_HEIGHT: {\n    sm: '2em',\n    md: '2em',\n    lg: '2em',\n  },\n  UNITS_TEXT_SIZE: {\n    sm: '1em',\n    md: '0.875em',\n    lg: '1em',\n  },\n  PERIODS: {\n    // Keep in sync with UNITS down here\n    sm: ['MILLE', 'MILLE', 'MILLE', 'UNITÉS', 'UNITÉS', 'UNITÉS', '', '', ''],\n    md: ['MILLE', 'MILLE', 'MILLE', 'UNITÉS', 'UNITÉS', 'UNITÉS', '', '', ''],\n    lg: ['MILLE', 'MILLE', 'MILLE', 'UNITÉS', 'UNITÉS', 'UNITÉS', '', '', ''],\n  },\n  UNITS: {\n    // Keep in sync with UNIT_DIGIT_INDEX down here\n    sm: ['C', 'D', 'U', 'C', 'D', 'U', 'd', 'c', 'm'],\n    md: ['Centaines', 'Dizaines', 'Unités', 'Centaines', 'Dizaines', 'Unités', 'Dixièmes', 'Centièmes', 'Millièmes'],\n    lg: ['Centaines', 'Dizaines', 'Unités', 'Centaines', 'Dizaines', 'Unités', 'Dixièmes', 'Centièmes', 'Millièmes'],\n  },\n  UNIT_DIGIT_INDEX: 5,\n  HIGHLIGHTCOLOR: {\n    primary: 'bg-coopmaths-struct',\n    secondary: 'bg-coopmaths-struct-light',\n  },\n} as const\n","import { env } from './env'\nimport type GlisseNombreElement from './GlisseNombreElement'\n\nexport function getPositionRatio(glisseNombreElement: GlisseNombreElement) {\n  const { table, overlay } = glisseNombreElement\n  const lastRow = table.rows[table.rows.length - 1]\n  if (!lastRow) return 0\n  const currentLeft = parseFloat(overlay.style.left)\n  const safariOffset = getSafariOffset(glisseNombreElement)\n  const relativeLeft = currentLeft - lastRow.offsetLeft + safariOffset\n  return relativeLeft / lastRow.offsetWidth\n}\n\nexport function getXFromPositionRatio(glisseNombreElement: GlisseNombreElement, ratio: number) {\n  const table = glisseNombreElement.table\n  const lastRow = table.rows[table.rows.length - 1]\n  if (!lastRow) return 0\n  const safariOffset = getSafariOffset(glisseNombreElement)\n  return ratio * lastRow.offsetWidth + lastRow.offsetLeft + safariOffset\n}\n\ntype UpdateOverlayPositionParams = {\n  newLeft?: number\n  moveOverlayOriginRank?: boolean\n}\n\nexport function updateOverlayPosition(glisseNombreElement: GlisseNombreElement, params: UpdateOverlayPositionParams = {}) {\n  const { table, overlay, initialPower } = glisseNombreElement\n  const lastRow = table.rows[table.rows.length - 1]\n  if (!lastRow) return 0\n  const columnsCount = lastRow.cells.length\n  const lastRowCell = lastRow.cells[0]\n  const columnWidth = parseFloat(window.getComputedStyle(lastRowCell).width)\n  const borderWidth = parseFloat(window.getComputedStyle(lastRowCell).borderWidth)\n  const safariOffset = getSafariOffset(glisseNombreElement)\n\n  overlay.style.top = `${lastRow.offsetTop - safariOffset - borderWidth / 4}px`\n  overlay.style.width = `${overlay.children.length * columnWidth}px`\n  overlay.style.height = `${lastRow.offsetHeight + borderWidth / 2}px`\n  if (params.newLeft == null || Number.isNaN(params.newLeft)) {\n    params.newLeft = lastRow.offsetLeft - (columnsCount - env.UNIT_DIGIT_INDEX + initialPower - 1) * columnWidth\n  }\n  const minLeft = lastRow.offsetLeft - (columnsCount - 1) * columnWidth\n  const maxLeft = lastRow.offsetLeft\n  const constrainedLeft = Math.max(minLeft, Math.min(params.newLeft, maxLeft)) - safariOffset\n  overlay.style.left = `${constrainedLeft}px`\n\n  const columnIndex = Math.round((constrainedLeft - minLeft) / columnWidth)\n  glisseNombreElement.pow = env.UNIT_DIGIT_INDEX - initialPower - columnIndex\n  glisseNombreElement.handleCalculus({ moveOverlayOriginRank: !!params.moveOverlayOriginRank })\n  glisseNombreElement.handleZerosOfOverlay()\n  glisseNombreElement.handleCommas()\n  glisseNombreElement.lastPositionRatio = getPositionRatio(glisseNombreElement)\n}\n\nexport function getSafariOffset(glisseNombreElement: GlisseNombreElement) {\n  const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent)\n  if (!isSafari) return 0\n  const table = glisseNombreElement.table\n  const lastRowCell = table.rows[table.rows.length - 1].cells[0]\n  const borderWidth = parseFloat(window.getComputedStyle(lastRowCell).borderWidth)\n  return borderWidth / 2\n}\n","import { env } from './env'\nimport type GlisseNombreElement from './GlisseNombreElement'\nimport { getPositionRatio, updateOverlayPosition } from './overlay-position'\n\nexport default function handleDrag(glisseNombreElement: GlisseNombreElement): () => void {\n  let isDragging = false\n  let initialX: number\n  let overlayInitialLeft: number\n  const { overlay, table } = glisseNombreElement\n  const lastRow = table.rows[table.rows.length - 1]\n\n  const onDragStart = (e: MouseEvent | TouchEvent) => {\n    if (glisseNombreElement.animation !== 0) return\n    e.preventDefault()\n\n    isDragging = true\n    // Cursor changes to grabbing\n    lastRow.classList.remove('cursor-grab')\n    overlay.classList.remove('cursor-grab')\n    document.body.classList.add('cursor-grabbing')\n\n    initialX = 'touches' in e ? e.touches[0].clientX : e.clientX\n    overlayInitialLeft = parseFloat(window.getComputedStyle(overlay).left) || 0\n\n    document.addEventListener('mousemove', onDragMove)\n    document.addEventListener('mouseup', onDragEnd)\n    document.addEventListener('touchmove', onDragMove)\n    document.addEventListener('touchend', onDragEnd)\n  }\n\n  const onDragMove = (e: MouseEvent | TouchEvent) => {\n    if (!isDragging) return\n    const currentX = 'touches' in e ? e.touches[0].clientX : e.clientX\n    const deltaX = currentX - initialX\n    const newLeft = overlayInitialLeft + deltaX\n    updateOverlayPosition(glisseNombreElement, { newLeft })\n  }\n\n  const onDragEnd = () => {\n    if (!isDragging) return\n    isDragging = false\n    lastRow.classList.add('cursor-grab')\n    overlay.classList.add('cursor-grab')\n    document.body.classList.remove('cursor-grabbing')\n\n    // setTimeout(() => {\n    //   glisseNombreElement.hideNonSignificantDigitsInOverlay()\n    // }, 1000)\n\n    // Clean up move and end listeners immediately\n    document.removeEventListener('mousemove', onDragMove)\n    document.removeEventListener('mouseup', onDragEnd)\n    document.removeEventListener('touchmove', onDragMove)\n    document.removeEventListener('touchend', onDragEnd)\n\n    // --- Logique d'aimantation (Snap) ---\n    // Calcule la position en tant que ratio de la largeur de la ligne\n    const positionRatio = getPositionRatio(glisseNombreElement)\n    const snappedRatio = Math.round(positionRatio * env.UNITS.lg.length) / env.UNITS.lg.length\n    const targetLeft = snappedRatio * lastRow.offsetWidth + lastRow.offsetLeft\n    overlay.style.transition = 'left 0.2s ease-out'\n    updateOverlayPosition(glisseNombreElement, {\n      newLeft: targetLeft,\n      moveOverlayOriginRank: true,\n    })\n    // Supprime la transition une fois l'animation terminée pour que le prochain\n    // glissement soit réactif.\n    overlay.addEventListener(\n      'transitionend',\n      () => {\n        overlay.style.transition = ''\n      },\n      { once: true },\n    )\n  }\n\n  // Début du script\n  lastRow.classList.add('cursor-grab')\n  if (glisseNombreElement.animation !== 0) {\n    overlay.classList.remove('cursor-grab')\n    lastRow.classList.remove('cursor-grab')\n  }\n\n  // Permet de démarrer le glissement depuis l'overlay lui-même,\n  // utile lorsqu'il est déplacé en dehors des limites de la dernière ligne.\n  overlay.addEventListener('mousedown', onDragStart)\n  overlay.addEventListener('touchstart', onDragStart, { passive: false })\n\n  updateOverlayPosition(glisseNombreElement, { moveOverlayOriginRank: true })\n  // Fin du script\n\n  // Retourne une fonction de nettoyage pour supprimer les écouteurs d'événements et éviter les fuites de mémoire.\n  return () => {\n    document.body.classList.remove('cursor-grabbing')\n    lastRow.classList.remove('cursor-grab')\n    document.removeEventListener('mousemove', onDragMove)\n    document.removeEventListener('mouseup', onDragEnd)\n    document.removeEventListener('touchmove', onDragMove)\n    document.removeEventListener('touchend', onDragEnd)\n    lastRow.removeEventListener('mousedown', onDragStart)\n    lastRow.removeEventListener('touchstart', onDragStart)\n    overlay.removeEventListener('mousedown', onDragStart)\n    overlay.removeEventListener('touchstart', onDragStart)\n  }\n}\n","import { env } from './env'\n\nexport default function handleKeys(table: HTMLTableElement, setDigits: (digits: number[]) => void) {\n  if (!table) {\n    throw new Error('Table element not found')\n  }\n  const editableRow = table.rows[2]\n  if (!editableRow) {\n    throw new Error('Editable row not found')\n  }\n  for (const cell of editableRow.cells) {\n    cell.contentEditable = 'true'\n    cell.classList.add('text-center', 'text-coopmaths', 'font-bold')\n    cell.setAttribute('inputmode', 'numeric')\n    // Select the first character if it exists and is not blank\n    cell.addEventListener('focus', () => {\n      const selection = window.getSelection()\n      if (selection) {\n        selection.removeAllRanges()\n        const range = document.createRange()\n        if (\n          cell.firstChild &&\n          cell.firstChild.nodeType === Node.TEXT_NODE &&\n          /\\S/.test(cell.firstChild.textContent?.charAt(0) || '')\n        ) {\n          range.setStart(cell.firstChild, 0)\n          range.setEnd(cell.firstChild, 1)\n          selection.addRange(range)\n        }\n      }\n    })\n    // Handle keydown events for navigation and input\n    cell.addEventListener('keydown', (event) => {\n      event.preventDefault()\n      const nextCell = cell.nextElementSibling\n      if (event.key === 'ArrowLeft' || (event.key === 'Tab' && event.shiftKey)) {\n        const previousCell = cell.previousElementSibling\n        if (previousCell instanceof HTMLTableCellElement) {\n          previousCell.focus()\n        }\n      } else if (event.key === 'Enter' || event.key === 'ArrowRight' || event.key === 'Tab') {\n        if (nextCell instanceof HTMLTableCellElement) {\n          nextCell.focus()\n        }\n      } else if (event.key === 'Backspace' || event.key === 'Delete') {\n        // Trouve le premier nœud de texte et efface son contenu\n        // pour ne pas supprimer le <span> de la virgule.\n        const textNode = Array.from(cell.childNodes).find((node) => node.nodeType === Node.TEXT_NODE)\n        if (textNode) {\n          // Remplacer par un espace insécable pour éviter que la ligne\n          // du tableau ne s'affaisse sur certains navigateurs comme Firefox\n          // lorsqu'elle est vide.\n          textNode.nodeValue = '\\u00A0'\n        }\n        setDigits(getDigitsOfTable(table))\n      } else if (/^[0-9]$/.test(event.key)) {\n        // Trouve le premier nœud de texte et met à jour sa valeur.\n        // S'il n'existe pas, en crée un.\n        const textNode = Array.from(cell.childNodes).find((node) => node.nodeType === Node.TEXT_NODE)\n        if (textNode) {\n          textNode.nodeValue = event.key\n        } else {\n          // Insère le chiffre au début pour qu'il apparaisse avant la virgule\n          cell.insertBefore(document.createTextNode(event.key), cell.firstChild)\n        }\n        if (nextCell instanceof HTMLTableCellElement) {\n          nextCell.focus()\n        }\n        setDigits(getDigitsOfTable(table))\n      }\n    })\n  }\n}\n\nfunction getDigitsOfTable(table: HTMLTableElement): number[] {\n  const editableRow = table.rows[2]\n  if (!editableRow) {\n    throw new Error('Editable row not found')\n  }\n  const digits: number[] = new Array(env.UNITS.lg.length)\n  for (let i = 0; i < editableRow.cells.length; i++) {\n    const digit = editableRow.cells[i].textContent?.trim().replace(',', '')\n    if (digit !== '') digits[i] = Number(digit)\n  }\n  return digits\n}\n","import { env } from './env'\nimport type GlisseNombreElement from './GlisseNombreElement'\nimport { updateOverlayPosition } from './overlay-position'\nexport const GO_STEP = 1\nexport const GO_BACK_STEP = 5\nexport const RESTART_STEP = 7\n\nconst ANIMATION_STEP_DURATION = 1000 // milliseconds\n\nexport function animate(glisseNombreElement: GlisseNombreElement) {\n  if (glisseNombreElement.animation === 0) return\n\n  const initialLeft = getInitialLeft(glisseNombreElement)\n  const targetLeft = getTargetLeft(glisseNombreElement)\n  setTimeout(() => {\n    const { animationState } = glisseNombreElement\n    if (animationState === 'pause') {\n      // On se positionne à l'étape suivante pour reprendre immédiatement après la pause\n      if (glisseNombreElement.animationStep > GO_BACK_STEP || glisseNombreElement.animationStep <= GO_STEP) {\n        glisseNombreElement.animationStep = GO_STEP\n      } else {\n        glisseNombreElement.animationStep = GO_BACK_STEP\n      }\n    } else if (animationState === 'play') {\n      if (glisseNombreElement.animationStep === GO_STEP) {\n        animateOverlayPosition(glisseNombreElement, initialLeft, targetLeft, 3 * ANIMATION_STEP_DURATION)\n        glisseNombreElement.animationStep += 1\n      } else if (glisseNombreElement.animationStep === GO_BACK_STEP) {\n        animateOverlayPosition(glisseNombreElement, targetLeft, initialLeft, ANIMATION_STEP_DURATION / 2)\n        glisseNombreElement.animationStep += 1\n      } else if (glisseNombreElement.animationStep >= RESTART_STEP) {\n        glisseNombreElement.animationStep = GO_STEP\n      } else {\n        glisseNombreElement.animationStep += 1\n      }\n    }\n    animate(glisseNombreElement)\n  }, ANIMATION_STEP_DURATION)\n}\n\nexport function goAnimation(glisseNombreElement: GlisseNombreElement) {\n  updateOverlayPosition(glisseNombreElement, { newLeft: getTargetLeft(glisseNombreElement), moveOverlayOriginRank: true })\n  glisseNombreElement.animationStep = GO_BACK_STEP\n}\n\nexport function goBackAnimation(glisseNombreElement: GlisseNombreElement) {\n  updateOverlayPosition(glisseNombreElement, { newLeft: getInitialLeft(glisseNombreElement), moveOverlayOriginRank: true })\n  glisseNombreElement.animationStep = GO_STEP\n}\n\nfunction getInitialLeft(glisseNombreElement: GlisseNombreElement) {\n  const { table, initialPower } = glisseNombreElement\n  const lastRow = table.rows[table.rows.length - 1]\n  if (!lastRow) return 0\n  const columnsCount = lastRow.cells.length\n  return lastRow.offsetLeft - (columnsCount - env.UNIT_DIGIT_INDEX + initialPower - 1) * getColumnWidth(glisseNombreElement)\n}\n\nfunction getTargetLeft(glisseNombreElement: GlisseNombreElement) {\n  const columnWidth = getColumnWidth(glisseNombreElement)\n  const initialLeft = getInitialLeft(glisseNombreElement)\n  return initialLeft - glisseNombreElement.animation * columnWidth\n}\n\nfunction getColumnWidth(glisseNombreElement: GlisseNombreElement) {\n  const { table } = glisseNombreElement\n  const lastRow = table.rows[table.rows.length - 1]\n  if (!lastRow) return 0\n  const lastRowCell = lastRow.cells[0]\n  return parseFloat(window.getComputedStyle(lastRowCell).width)\n}\n\nfunction animateOverlayPosition(\n  glisseNombreElement: GlisseNombreElement,\n  initialLeft: number,\n  targetLeft: number,\n  duration: number,\n) {\n  // tweened\n  const startTime = performance.now()\n  const easing = (t: number) => -(Math.cos(Math.PI * t) - 1) / 2\n  const animateOverlay = (currentTime: number) => {\n    if (glisseNombreElement.animationState === 'stop') return\n    const elapsedTime = currentTime - startTime\n    const progress = Math.min(elapsedTime / duration, 1)\n    const easedProgress = easing(progress)\n    const newLeft = initialLeft + (targetLeft - initialLeft) * easedProgress\n    if (elapsedTime < duration) {\n      updateOverlayPosition(glisseNombreElement, { newLeft })\n      requestAnimationFrame(animateOverlay)\n    } else {\n      updateOverlayPosition(glisseNombreElement, { newLeft, moveOverlayOriginRank: true })\n    }\n  }\n  requestAnimationFrame(animateOverlay)\n}\n","import { env } from './env'\nimport handleDrag from './handleDrag'\nimport handleKeys from './handleKeys'\nimport { animate, goAnimation, goBackAnimation } from './overlay-animation'\nimport { getPositionRatio, getSafariOffset, getXFromPositionRatio, updateOverlayPosition } from './overlay-position'\n\ntype Size = 'sm' | 'md' | 'lg'\ntype BuildAnimationButtonsParams = {\n  hoverText: string\n  innerSvg: string\n  clickHandler: () => void\n}\n\nexport default class GlisseNombreElement extends HTMLElement {\n  animateTimeoutId: number | undefined\n  animation = 0\n  animationState: 'play' | 'pause' | 'stop' = 'play'\n  animationStep = 1\n  container: HTMLDivElement = document.createElement('div')\n  divCalculus = document.createElement('div')\n  editableRowDigits: number[] = []\n  hasToHandleZeros = true\n  hasToRemoveLeftZeros = false\n  hasToShowComma1 = true\n  hasToShowComma2 = true\n  initialPower: number = 0\n  lastPositionRatio = 0\n  number = 0\n  overlay: HTMLDivElement = document.createElement('div')\n  overlayDigitSpans: HTMLSpanElement[] = []\n  pow: number = 0\n  table: HTMLTableElement = document.createElement('table')\n  private _comma1IsVisible = true\n  private _comma2IsVisible = true\n  private _isCalculusVisible = false\n  private _currentSize: Size = 'sm'\n  private _resizeObserver: ResizeObserver | undefined\n\n  /**\n   * Liste les attributs qui seront observés pour les changements\n   */\n  static get observedAttributes() {\n    return [\n      'add-zeros',\n      'remove-left-zeros',\n      'number',\n      'show-comma1',\n      'show-comma2',\n      'initial-power',\n      'animation',\n      'show-calculus',\n      'orientation',\n    ]\n  }\n\n  /**\n   * Constructeur de l'élément GlisseNombre.\n   */\n  connectedCallback() {\n    this.container = document.createElement('div')\n    this.container.classList.add('relative', 'overflow-hidden', 'w-fit', 'flex', 'flex-col', 'items-center', 'justify-center')\n\n    this.table = this._buildTable()\n    this.container.appendChild(this.table)\n\n    this.overlay = this._buildOverlay()\n    this.table.appendChild(this.overlay)\n\n    this.divCalculus = this._buildDivCalculus()\n    this.appendChild(this.divCalculus)\n\n    if (this.animation !== 0) {\n      const animationControlButtons = this._buildAnimationControlButtons()\n      this.container.appendChild(animationControlButtons)\n    }\n\n    this.appendChild(this.container)\n\n    this._setInitialNumber()\n\n    handleKeys(this.table, this._setDigits.bind(this))\n    handleDrag(this)\n\n    this._startResizeObservation()\n\n    this._startAnimation()\n\n    return () => {\n      this._stopResizeObservation\n      this._stopAnimation()\n    }\n  }\n\n  /**\n   * Gestion des changements d'attributs.\n   */\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (oldValue === newValue) {\n      return\n    }\n    if (name === 'add-zeros') {\n      this.hasToHandleZeros = newValue === 'true'\n      this._writeDigits()\n    }\n    if (name === 'remove-left-zeros') {\n      this.hasToRemoveLeftZeros = newValue === 'true'\n      this._writeDigits()\n    }\n    if (name === 'show-comma1') {\n      this.hasToShowComma1 = newValue === 'true'\n      this.handleCommas()\n    }\n    if (name === 'show-comma2') {\n      this.hasToShowComma2 = newValue === 'true'\n      this.handleCommas()\n    }\n    if (name === 'initial-power') {\n      this.initialPower = parseInt(newValue)\n    }\n    if (name === 'animation') {\n      this.animation = parseInt(newValue)\n    }\n    if (name === 'show-calculus') {\n      this.isCalculusVisible = newValue === 'true'\n    }\n  }\n\n  handleCalculus({ moveOverlayOriginRank = false } = {}) {\n    if (this.pow < 0) {\n      const divisor = 10 ** -this.pow\n      this.divCalculus.innerHTML = `<span class=\"font-semibold\">÷</span> ${divisor.toLocaleString('fr-FR')}`\n    } else if (this.pow > 0) {\n      const multiplier = 10 ** this.pow\n      this.divCalculus.innerHTML = `<span style=\"font-size: 0.875em\">✕</span> ${multiplier.toLocaleString('fr-FR')}`\n    } else {\n      this.divCalculus.innerHTML = ''\n    }\n    this._clearHighlights()\n    this._highlightTableOriginRank()\n    this._highlightTableMovingRank()\n    if (moveOverlayOriginRank) this._highlightOverlayOriginRank()\n    this._moveDivCalculus()\n  }\n\n  private _clearHighlights() {\n    for (const cell of this.table.rows[0].cells) {\n      // Periods row\n      cell.classList.remove('text-coopmaths-struct')\n    }\n    for (const cell of this.table.rows[1].cells) {\n      // Units row\n      cell.classList.remove(env.HIGHLIGHTCOLOR.primary, 'text-white')\n    }\n    for (const span of this.overlayDigitSpans) {\n      // Overlay\n      span.classList.remove(env.HIGHLIGHTCOLOR.secondary)\n    }\n  }\n\n  private _highlightTableOriginRank() {\n    const originCell = this.table.rows[1].cells[env.UNIT_DIGIT_INDEX - this.initialPower]\n    if (originCell == null) {\n      return\n    }\n    originCell.classList.add('text-white', env.HIGHLIGHTCOLOR.secondary)\n  }\n\n  private _highlightTableMovingRank() {\n    const movingCell = this._getMovingCell()\n    if (!movingCell) return\n    movingCell.classList.remove(env.HIGHLIGHTCOLOR.secondary)\n    movingCell.classList.add('text-white', env.HIGHLIGHTCOLOR.primary)\n\n    const periodCell = this._getPeriodCellFromUnitCell(movingCell)\n    periodCell.classList.add('text-coopmaths-struct')\n  }\n\n  private _highlightOverlayOriginRank() {\n    const originSpan = this.overlayDigitSpans[this.overlayUnitDigitIndex - this.initialPower + this.pow]\n    if (!originSpan) return\n    if (!originSpan.classList.contains(env.HIGHLIGHTCOLOR.primary)) {\n      originSpan.classList.add(env.HIGHLIGHTCOLOR.secondary)\n    }\n  }\n\n  private _moveDivCalculus() {\n    const movingCell = this._getMovingCell()\n    if (!movingCell) return\n    const cellCenter = movingCell.offsetLeft + movingCell.offsetWidth / 2\n    this.divCalculus.style.left = `${this.offsetLeft + this.table.offsetLeft + cellCenter}px`\n    this.divCalculus.style.top = `${this.offsetTop}px`\n    this.divCalculus.style.transform = 'translateX(-50%) translateY(25%)'\n    this.divCalculus.style.width = 'auto'\n  }\n\n  private _getMovingCell(): HTMLTableCellElement | undefined {\n    return this.table.rows[1].cells[env.UNIT_DIGIT_INDEX - this.pow - this.initialPower]\n  }\n\n  handleZerosOfOverlay() {\n    this._handleZeros(\n      this.overlayDigitSpans,\n      this.overlayUnitDigitIndex + this.pow,\n      this.overlayFirstSignificantDigitIndex,\n      this.overlayLastSignificantDigitIndex,\n    )\n  }\n\n  handleCommas() {\n    this.comma1IsVisible = this.hasToShowComma1\n    this.comma2IsVisible = this.hasToShowComma2\n  }\n\n  /**\n   * On fait en sorte de laisser 1 case déborder de chaque côté\n   */\n  setContainerWidth() {\n    const columnWidth = this.table.rows[this.table.rows.length - 1].cells[0].offsetWidth\n    this.container.style.width = `${this.table.offsetWidth + 2 * columnWidth - 2}px`\n  }\n\n  private _startResizeObservation() {\n    window.addEventListener('resize', this._onResize) // Pour les redimensionnements de la fenêtre\n    this._resizeObserver = new ResizeObserver(() => {\n      this._onResize()\n    })\n    this._resizeObserver.observe(this.table) // Pour les changements de taille du tableau, par exemple lorsqu'on utilise le zoom de mathaléa\n  }\n\n  private _stopResizeObservation() {\n    window.removeEventListener('resize', this._onResize)\n    this._resizeObserver?.disconnect()\n  }\n\n  private _startAnimation() {\n    if (this.animateTimeoutId === undefined) {\n      this.animateTimeoutId = window.setTimeout(() => {\n        this.animationState = 'play'\n        animate(this)\n      }, 0)\n    }\n  }\n\n  private _stopAnimation() {\n    if (this.animateTimeoutId !== undefined) {\n      clearTimeout(this.animateTimeoutId)\n      this.animationState = 'stop'\n      this.animateTimeoutId = undefined\n    }\n  }\n\n  private _getPeriodCellFromUnitCell(unitCell: HTMLTableCellElement): HTMLTableCellElement {\n    const periodRow = this.table.querySelector('#periods-row')\n    if (!(periodRow instanceof HTMLTableRowElement)) {\n      throw new Error('Period row not found')\n    }\n    let periodCell: HTMLTableCellElement = periodRow.cells[0]\n    for (const cell of periodRow.cells) {\n      if (unitCell.offsetLeft >= cell.offsetLeft) {\n        periodCell = cell\n      }\n    }\n    return periodCell\n  }\n\n  private _onResize = () => {\n    this._updateSizes()\n    this.handleCalculus()\n  }\n\n  private _handleZerosOfEditableRow() {\n    if (!this.table.rows[2]) {\n      return\n    }\n    this._handleZeros(\n      Array.from(this.table.rows[2].cells),\n      env.UNIT_DIGIT_INDEX,\n      this.editableRowFirstSignificantDigitIndex,\n      this.editableRowLastSignificantDigitIndex,\n    )\n  }\n\n  private _handleZeros(\n    spans: HTMLSpanElement[],\n    unitDigitIndex: number,\n    firstSignificantDigitIndex: number,\n    lastSignificantDigitIndex: number,\n  ) {\n    if (!this.hasToHandleZeros) {\n      this._removeLeftZeros(spans, unitDigitIndex, firstSignificantDigitIndex, lastSignificantDigitIndex)\n      return\n    }\n\n    for (let i = 0; i < spans.length; i++) {\n      const span = spans[i]\n      const isSignificantDigit = i >= firstSignificantDigitIndex && i <= lastSignificantDigitIndex\n      const isZeroAfterComma = i >= unitDigitIndex && i < firstSignificantDigitIndex\n      const isZeroBeforeComma = i <= unitDigitIndex && i > lastSignificantDigitIndex\n      if (isSignificantDigit) {\n        if (this._isEmptyCommaSpan(span)) {\n          span.textContent = '0'\n          const isEditableRowDigitIndex = i === unitDigitIndex && i === env.UNIT_DIGIT_INDEX\n          if (isEditableRowDigitIndex) {\n            span.innerHTML += this._buildCommaSpan('red-500').outerHTML // on remet la virgule\n          }\n        }\n      } else if (isZeroBeforeComma || isZeroAfterComma) {\n        span.textContent = '0'\n      } else {\n        span.textContent = ''\n      }\n    }\n    this._removeLeftZeros(spans, unitDigitIndex, firstSignificantDigitIndex, lastSignificantDigitIndex)\n  }\n\n  private _removeLeftZeros(\n    spans: HTMLSpanElement[],\n    _unitDigitIndex: number,\n    _firstSignificantDigitIndex: number,\n    lastSignificantDigitIndex: number,\n  ) {\n    if (!this.hasToRemoveLeftZeros) return\n    for (let i = 0; i < lastSignificantDigitIndex; i++) {\n      const span = spans[i]\n      if (span == null) {\n        continue\n      }\n      if (span.textContent === '0,' || span.textContent === '0') {\n        span.textContent = ''\n      } else if (!this._isEmptyCommaSpan(span)) {\n        break\n      }\n    }\n  }\n\n  private _isEmptyCommaSpan(cell: HTMLSpanElement): boolean {\n    return cell.textContent === '' || cell.textContent === '\\u00A0' || cell.textContent === ',' || cell.textContent === '\\u00A0,'\n  }\n\n  private _updateSizes() {\n    const size = this._getSize()\n    if (this._currentSize !== size) {\n      this._currentSize = size\n      this._setHeaders(size)\n      this._setTableSizes(size)\n    }\n    this.setContainerWidth()\n\n    const newLeft = getXFromPositionRatio(this, this.lastPositionRatio) - getSafariOffset(this)\n    updateOverlayPosition(this, { newLeft, moveOverlayOriginRank: true })\n    this.lastPositionRatio = getPositionRatio(this)\n  }\n\n  private _getSize(): Size {\n    if (window.innerWidth > 1024) {\n      return 'lg'\n    }\n    if (window.innerWidth > 768) {\n      return 'md'\n    }\n    return 'sm'\n  }\n\n  private _setHeaders(size: Size) {\n    this._setHeadersWidths(size)\n    this._setPeriodsHeaders(size)\n    this._setUnitsHeaders(size)\n  }\n\n  private _setHeadersWidths(size: Size) {\n    this.table.querySelectorAll('#units-row th div').forEach((div) => {\n      if (!(div instanceof HTMLDivElement)) return\n      switch (size) {\n        case 'lg':\n          div.style.width = env.UNITS_WIDTH.lg\n          break\n        case 'md':\n          div.style.width = env.UNITS_WIDTH.md\n          break\n        default:\n          div.style.width = env.UNITS_WIDTH.sm\n          break\n      }\n    })\n  }\n\n  private _setTableSizes(size: Size) {\n    this.table.querySelectorAll('th div, tr td').forEach((div) => {\n      if (!(div instanceof HTMLDivElement || div instanceof HTMLTableCellElement)) return\n      switch (size) {\n        case 'lg':\n          div.style.lineHeight = env.UNITS_HEIGHT.lg\n          div.style.fontSize = env.UNITS_TEXT_SIZE.lg\n          break\n        case 'md':\n          div.style.lineHeight = env.UNITS_HEIGHT.md\n          div.style.fontSize = env.UNITS_TEXT_SIZE.md\n          break\n        default:\n          div.style.lineHeight = env.UNITS_HEIGHT.sm\n          div.style.fontSize = env.UNITS_TEXT_SIZE.sm\n          break\n      }\n    })\n  }\n\n  private _setPeriodsHeaders(size: Size) {\n    let uniquePeriods: string[] = Array.from(new Set(env.PERIODS.sm))\n    if (size === 'lg') {\n      uniquePeriods = Array.from(new Set(env.PERIODS.lg))\n    } else if (size === 'md') {\n      uniquePeriods = Array.from(new Set(env.PERIODS.md))\n    }\n\n    const periodsDivs = this.table.querySelectorAll('#periods-row th div')\n    periodsDivs.forEach((div, index) => {\n      div.innerHTML = uniquePeriods[index]\n    })\n  }\n\n  private _setUnitsHeaders(size: Size) {\n    const unitsSpans = this.table.querySelectorAll('th div span')\n    unitsSpans.forEach((span, index) => {\n      if (size === 'lg') {\n        span.innerHTML = env.UNITS.lg[index]\n      } else if (size === 'md') {\n        span.innerHTML = env.UNITS.md[index]\n      } else {\n        span.innerHTML = env.UNITS.sm[index]\n      }\n    })\n  }\n\n  private _buildTable() {\n    const table = document.createElement('table')\n    table.classList.add('relative', 'm-auto', 'border-collapse')\n    table.style.marginTop = '2.25em'\n    table.style.marginBottom = '1.25em'\n\n    const thead = this._buildThead()\n    table.appendChild(thead)\n\n    const tbody = this._buildTbody()\n    table.appendChild(tbody)\n\n    table.querySelectorAll('td, th').forEach((cell) => {\n      if (!(cell instanceof HTMLTableCellElement)) return\n      cell.classList.add('border-coopmaths-struct')\n      cell.style.borderWidth = '0.15em'\n    })\n\n    return table\n  }\n\n  private _buildThead() {\n    const thead = document.createElement('thead')\n\n    const periodsRow = document.createElement('tr')\n    periodsRow.id = 'periods-row'\n    let currentTh: HTMLTableCellElement = document.createElement('th')\n    for (let i = 0; i < env.PERIODS.sm.length; i++) {\n      const label = env.PERIODS.sm[i]\n      if (label === env.PERIODS.sm[i - 1]) {\n        // Si le label est le même que le précédent, on fusionne les cellules\n        currentTh.colSpan += 1\n        continue\n      }\n      currentTh = document.createElement('th')\n      currentTh.colSpan = 1\n      currentTh.classList.add('relative', 'h-8')\n      const div = document.createElement('div')\n      div.classList.add('flex', 'justify-center', 'whitespace-nowrap', 'font-semibold')\n      div.style.paddingTop = '0.5em'\n      div.style.paddingBottom = '0.5em'\n      div.innerHTML = label\n      currentTh.appendChild(div)\n      periodsRow.appendChild(currentTh)\n    }\n    thead.appendChild(periodsRow)\n\n    const unitsRow = document.createElement('tr')\n    unitsRow.id = 'units-row'\n    env.UNITS.sm.forEach((label) => {\n      const th = document.createElement('th')\n      th.classList.add('relative')\n      const div = document.createElement('div')\n      div.classList.add('flex', 'justify-center', 'items-center')\n      div.style.paddingTop = '0.5em'\n      div.style.paddingBottom = '0.5em'\n      div.style.width = env.UNITS_WIDTH.sm\n      const span = document.createElement('span')\n      span.classList.add('whitespace-nowrap', 'font-semibold')\n      span.innerHTML = label\n      div.appendChild(span)\n      th.appendChild(div)\n      unitsRow.appendChild(th)\n    })\n    thead.appendChild(unitsRow)\n    return thead\n  }\n\n  private _buildTbody() {\n    const tbody = document.createElement('tbody')\n\n    const editableRow = document.createElement('tr')\n    for (let i = 0; i < env.UNITS.sm.length; i++) {\n      const td = document.createElement('td')\n      if (i === env.UNIT_DIGIT_INDEX) td.classList.add('relative')\n      td.innerHTML = '&nbsp;'\n      td.style.paddingTop = '0.25em'\n      td.style.paddingBottom = '0.25em'\n      editableRow.appendChild(td)\n    }\n    tbody.appendChild(editableRow)\n\n    const behindOverlayRow = document.createElement('tr')\n    for (let i = 0; i < env.UNITS.sm.length; i++) {\n      const td = document.createElement('td')\n      if (i === env.UNIT_DIGIT_INDEX) {\n        td.id = 'overlay-comma-td'\n        td.classList.add('relative')\n        td.innerHTML = this._buildCommaSpan('white').outerHTML\n      } else {\n        td.innerHTML = '&nbsp;'\n      }\n      td.style.paddingTop = '0.25em'\n      td.style.paddingBottom = '0.25em'\n      behindOverlayRow.appendChild(td)\n    }\n    tbody.appendChild(behindOverlayRow)\n    return tbody\n  }\n\n  private _buildOverlayDigitSpans(): HTMLSpanElement[] {\n    const overlayDigitSpans = []\n    for (let i = 0; i < this.overlayColumnCount; i++) {\n      const overlayDigitSpan = document.createElement('span')\n      overlayDigitSpan.classList.add(\n        'font-semibold',\n        'text-white',\n        'flex',\n        'items-center',\n        'justify-center',\n        'w-full',\n        'h-full',\n        'border-coopmaths-struct',\n      )\n      overlayDigitSpan.style.borderWidth = '0.075em'\n      overlayDigitSpan.innerHTML = '&nbsp;'\n      overlayDigitSpans.push(overlayDigitSpan)\n    }\n    const movingSpan = overlayDigitSpans[this.overlayUnitDigitIndex - this.initialPower]\n    movingSpan.classList.add(env.HIGHLIGHTCOLOR.primary)\n\n    return overlayDigitSpans\n  }\n\n  private _buildOverlay(): HTMLDivElement {\n    const overlay = document.createElement('div')\n    overlay.classList.add(\n      'bg-coopmaths-lightest',\n      'grid',\n      'cursor-grab',\n      'items-center',\n      'justify-items-center',\n      'overflow-hidden',\n      'absolute',\n      'pointer-events-auto',\n      'border-collapse',\n    )\n    overlay.style.gridTemplateColumns = `repeat(${this.overlayColumnCount}, minmax(0, 1fr))`\n\n    this.overlayDigitSpans = this._buildOverlayDigitSpans()\n    this.overlayDigitSpans.forEach((digitSpan) => {\n      overlay.appendChild(digitSpan)\n    })\n    return overlay\n  }\n\n  private _buildDivCalculus() {\n    const divCalculus = document.createElement('div')\n    divCalculus.classList.add(\n      'absolute',\n      'font-semibold',\n      'text-coopmaths-struct',\n      'text-center',\n      'whitespace-nowrap',\n      'overflow-visible',\n    )\n    return divCalculus\n  }\n\n  private _buildAnimationControlButtons() {\n    const divButtons = document.createElement('div')\n    divButtons.classList.add('flex', 'justify-center', 'items-center', 'gap-2')\n\n    const playPauseButton = this._buildPlayPauseButton()\n    const previousButton = this._buildPreviousButton(playPauseButton)\n    const nextButton = this._buildNextButton(playPauseButton)\n\n    divButtons.appendChild(previousButton)\n    divButtons.appendChild(playPauseButton)\n    divButtons.appendChild(nextButton)\n\n    return divButtons\n  }\n\n  private _buildPreviousButton(playPauseButton: HTMLButtonElement): HTMLButtonElement {\n    return this._buildButton({\n      hoverText: 'Retourner au début de l’animation',\n      innerSvg: `\n        <polygon points=\"16,4 6,10 16,16\" /> <!-- Reversed play arrow -->\n        <rect x=\"3\" y=\"4\" width=\"2\" height=\"12\" /> <!-- Pause line on the left -->`,\n      clickHandler: () => {\n        this.animationState = 'stop'\n        playPauseButton.title = \"Relancer l'animation\"\n        playPauseButton.innerHTML = this._loopIcon\n        goBackAnimation(this)\n      },\n    })\n  }\n\n  private _buildNextButton(playPauseButton: HTMLButtonElement): HTMLButtonElement {\n    return this._buildButton({\n      hoverText: 'Aller à la fin de l’animation',\n      innerSvg: `\n        <polygon points=\"4,4 14,10 4,16\" /> <!-- Play arrow -->\n        <rect x=\"15\" y=\"4\" width=\"2\" height=\"12\" /> <!-- Pause line -->`,\n      clickHandler: () => {\n        this.animationState = 'stop'\n        playPauseButton.title = \"Relancer l'animation\"\n        playPauseButton.innerHTML = this._loopIcon\n        goAnimation(this)\n      },\n    })\n  }\n\n  private _loopIcon = this._buildIcon(`\n    <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path\n        stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n        d=\"M6.67 15H5.83C4.45 15 3.33 13.88 3.33 12.5V7.5C3.33 6.12 4.45 5 5.83 5H14.17C15.55 5 16.67 6.12 16.67 7.5V12.5C16.67 13.88 15.55 15 14.17 15H10M10 15L12.5 12.5M10 15L12.5 17.5\"\n      />\n    </svg>`)\n  private _pauseIcon = this._buildIcon(`\n    <rect x=\"6\" y=\"4\" width=\"2.5\" height=\"12\"/>\n    <rect x=\"11.5\" y=\"4\" width=\"2.5\" height=\"12\"/>`)\n\n  private _buildPlayPauseButton(): HTMLButtonElement {\n    const playPauseButton = this._buildButton({\n      hoverText: \"Arrêter l'animation\",\n      innerSvg: this._pauseIcon,\n      clickHandler: () => {\n        this.animationState = this.animationState === 'play' ? 'pause' : 'play'\n        playPauseButton.title = this.animationState === 'play' ? \"Arrêter l'animation\" : \"Relancer l'animation\"\n        playPauseButton.innerHTML = this.animationState === 'play' ? this._pauseIcon : this._loopIcon\n      },\n    })\n    playPauseButton.innerHTML = this._pauseIcon // Sans cette ligne, l'affichage initial ne supporte pas le zoom de mathaléa\n    return playPauseButton\n  }\n\n  private _buildButton(params: BuildAnimationButtonsParams): HTMLButtonElement {\n    const button = document.createElement('button')\n    button.classList.add(\n      'flex',\n      'items-center',\n      'justify-center',\n      'cursor-pointer',\n      'border',\n      'rounded',\n      'text-coopmaths-action',\n      'hover:text-white',\n      'active:text-white',\n      'bg-white',\n      'hover:bg-coopmaths-action-light',\n      'active:bg-coopmaths-action',\n      'border-coopmaths-action',\n      'hover:border-coopmaths-action-light',\n      'active:border-coopmaths-action',\n    )\n    button.innerHTML = this._buildIcon(params.innerSvg)\n    button.title = params.hoverText\n    button.addEventListener('click', params.clickHandler)\n    return button\n  }\n\n  private _buildIcon(innerSvg: string) {\n    return `\n      <svg xmlns=\"http://www.w3.org/2000/svg\"\n        class=\"inline\"\n        height=\"1.25em\"\n        width=\"1.25em\"\n        viewBox=\"0 0 20 20\"\n        fill=\"currentColor\"\n      >\n        ${innerSvg}\n      </svg>`\n  }\n\n  private _setInitialNumber() {\n    const initialNumberString = this.getAttribute('number')?.replace(',', '.').replace('{', '').replace('}', '')\n    const afterComma = initialNumberString?.split('.')[1]\n    if (afterComma != null && afterComma.length > 3) {\n      console.error('Le glisse-nombre ne gère que 3 chiffres après la virgule')\n    }\n    const initialNumber = parseFloat(initialNumberString || '0')\n    this._setDigits(this._getDigitsFromNumber(initialNumber))\n  }\n\n  private _buildCommaSpan(color: string): HTMLSpanElement {\n    const span = document.createElement('span')\n    span.classList.add('absolute', 'right-0', 'bottom-0', 'font-semibold', `text-${color}`, 'z-10')\n    span.style.fontSize = '2.25em'\n    span.textContent = ','\n    return span\n  }\n\n  private _setDigits(digits: number[]) {\n    this.setAttribute('number', this._getNumberFromDigits(digits).toString())\n    this._setEditableRowDigits(digits)\n    this._writeDigits()\n  }\n\n  private _writeDigits() {\n    this._writeDigitsInEditableRow()\n    this._writeDigitsInOverlay()\n    this._handleZerosOfEditableRow()\n    this.handleZerosOfOverlay()\n    this.handleCommas()\n  }\n\n  private _setEditableRowDigits(digits: number[]) {\n    this.editableRowDigits = digits\n  }\n\n  private _getDigitsFromNumber(number: number): number[] {\n    const unitPow = env.UNITS.sm.length - env.UNIT_DIGIT_INDEX - 1\n    const scaledNumber = Math.round(number * 10 ** unitPow)\n    const digits: number[] = []\n    for (let i = 0; i < env.UNITS.sm.length; i++) {\n      digits.push(Math.floor(scaledNumber / 10 ** (env.UNITS.sm.length - 1 - i)) % 10)\n    }\n    return digits\n  }\n\n  private _getNumberFromDigits(digits: number[]): number {\n    let number = 0\n    for (let i = 0; i < digits.length; i++) {\n      const digit = digits[i]\n      number += digit * 10 ** (env.UNIT_DIGIT_INDEX - i)\n    }\n    return number\n  }\n\n  private _writeDigitsInEditableRow() {\n    let firstNonZeroIndex = this.editableRowDigits.findIndex((digit) => digit !== 0)\n    if (firstNonZeroIndex > env.UNIT_DIGIT_INDEX) {\n      firstNonZeroIndex = env.UNIT_DIGIT_INDEX\n    }\n    let lastNonZeroIndex = this.editableRowDigits.length - 1\n    for (let i = this.editableRowDigits.length - 1; i >= firstNonZeroIndex; i--) {\n      if (this.editableRowDigits[i] === 0) {\n        lastNonZeroIndex--\n      } else {\n        break\n      }\n    }\n    for (let i = firstNonZeroIndex; i <= lastNonZeroIndex; i++) {\n      const cell = this.table?.rows[2]?.cells[i]\n      if (cell == null || this.editableRowDigits[i] == null) {\n        continue\n      }\n      cell.textContent = this.editableRowDigits[i].toString()\n      if (i === env.UNIT_DIGIT_INDEX) {\n        cell.innerHTML += this._buildCommaSpan('red-500').outerHTML\n      }\n    }\n  }\n\n  /**\n   * Écrit les chiffres calculés dans les spans de l'overlay.\n   */\n  private _writeDigitsInOverlay(): void {\n    for (let i = 0; i < this.overlayDigitSpans.length; i++) {\n      const span = this.overlayDigitSpans[i]\n      if (span == null) {\n        continue\n      }\n      if (i < this.overlayFirstSignificantDigitIndex || i > this.overlayLastSignificantDigitIndex) {\n        span.textContent = '\\u00A0'\n      } else {\n        span.textContent = this.overlayDigits[i]?.toString() ?? ''\n      }\n    }\n  }\n\n  private get comma1IsVisible(): boolean {\n    return this._comma1IsVisible\n  }\n\n  private set comma1IsVisible(value: boolean) {\n    this._comma1IsVisible = value\n    const cell = this.table?.rows[2]?.cells[env.UNIT_DIGIT_INDEX]\n    if (cell == null) {\n      return\n    }\n    const span = cell.querySelector('span')\n    if (span == null) {\n      return\n    }\n    if (value && this.editableRowLastSignificantDigitIndex > env.UNIT_DIGIT_INDEX) {\n      span.classList.remove('hidden')\n    } else {\n      span.classList.add('hidden')\n    }\n  }\n\n  private get comma2IsVisible(): boolean {\n    return this._comma2IsVisible\n  }\n\n  private set comma2IsVisible(value: boolean) {\n    this._comma2IsVisible = value\n    const cell = this.table?.rows[3]?.cells[env.UNIT_DIGIT_INDEX]\n    if (cell == null) {\n      return\n    }\n    const span = cell.querySelector('span')\n    if (span == null) {\n      return\n    }\n    const overlayUnitDigitIndex = this.overlayUnitDigitIndex + this.pow\n    const overlayUnitDigitSpan = this.overlayDigitSpans[overlayUnitDigitIndex]\n    if (\n      value &&\n      this.overlayLastSignificantDigitIndex > overlayUnitDigitIndex &&\n      (overlayUnitDigitSpan.innerHTML !== '' ||\n        !this.hasToRemoveLeftZeros ||\n        overlayUnitDigitIndex > this.overlayFirstSignificantDigitIndex)\n    ) {\n      span.classList.remove('hidden')\n    } else {\n      span.classList.add('hidden')\n    }\n  }\n\n  private get overlayDigits(): number[] {\n    return [...new Array(this.overlayLeftExtraCount).fill(0), ...this.editableRowDigits]\n  }\n\n  private get editableRowFirstSignificantDigitIndex(): number {\n    // Trouve le premier chiffre saisi par l'utilisateur ou le chiffre des unités\n    for (let i = 0; i < env.UNIT_DIGIT_INDEX; i++) {\n      if (this.table.rows[2] && parseInt(this.table.rows[2].cells[i].textContent ?? '') > 0) {\n        return i\n      }\n    }\n    return env.UNIT_DIGIT_INDEX\n  }\n\n  private get editableRowLastSignificantDigitIndex(): number {\n    for (let i = this.editableRowDigits.length - 1; i > env.UNIT_DIGIT_INDEX; i--) {\n      if (this.editableRowDigits[i] > 0) {\n        return i\n      }\n    }\n    return env.UNIT_DIGIT_INDEX // Retourne l'index de l'unité si aucun chiffre significatif n'est trouvé.\n  }\n\n  private get isCalculusVisible(): boolean {\n    return this._isCalculusVisible\n  }\n\n  private set isCalculusVisible(value: boolean) {\n    this._isCalculusVisible = value\n    if (value) {\n      this.divCalculus.classList.remove('hidden')\n    } else {\n      this.divCalculus.classList.add('hidden')\n    }\n  }\n\n  private get overlayFirstSignificantDigitIndex(): number {\n    return this.editableRowFirstSignificantDigitIndex + env.UNITS.sm.length - env.UNIT_DIGIT_INDEX - 1 + this.initialPower\n  }\n\n  private get overlayLastSignificantDigitIndex(): number {\n    return this.editableRowLastSignificantDigitIndex + env.UNITS.sm.length - env.UNIT_DIGIT_INDEX - 1 + this.initialPower\n  }\n\n  private get overlayLeftExtraCount(): number {\n    return env.UNITS.sm.length - (env.UNIT_DIGIT_INDEX - this.initialPower + 1)\n  }\n  private get overlayRightExtraCount(): number {\n    return env.UNIT_DIGIT_INDEX - this.initialPower\n  }\n\n  private get overlayColumnCount(): number {\n    return this.overlayLeftExtraCount + env.UNITS.sm.length + this.overlayRightExtraCount\n  }\n  private get overlayUnitDigitIndex(): number {\n    return this.overlayLeftExtraCount + env.UNIT_DIGIT_INDEX\n  }\n}\n"],"names":["env","getPositionRatio","glisseNombreElement","table","overlay","lastRow","currentLeft","safariOffset","getSafariOffset","getXFromPositionRatio","ratio","updateOverlayPosition","params","initialPower","columnsCount","lastRowCell","columnWidth","borderWidth","minLeft","maxLeft","constrainedLeft","columnIndex","handleDrag","isDragging","initialX","overlayInitialLeft","onDragStart","e","onDragMove","onDragEnd","deltaX","newLeft","positionRatio","targetLeft","handleKeys","setDigits","editableRow","cell","_a","selection","range","event","nextCell","previousCell","textNode","node","getDigitsOfTable","digits","i","digit","GO_STEP","GO_BACK_STEP","RESTART_STEP","ANIMATION_STEP_DURATION","animate","initialLeft","getInitialLeft","getTargetLeft","animationState","animateOverlayPosition","goAnimation","goBackAnimation","getColumnWidth","duration","startTime","easing","t","animateOverlay","currentTime","elapsedTime","progress","easedProgress","GlisseNombreElement","animationControlButtons","name","oldValue","newValue","moveOverlayOriginRank","divisor","multiplier","span","originCell","movingCell","originSpan","cellCenter","unitCell","periodRow","periodCell","spans","unitDigitIndex","firstSignificantDigitIndex","lastSignificantDigitIndex","isSignificantDigit","isZeroAfterComma","isZeroBeforeComma","_unitDigitIndex","_firstSignificantDigitIndex","size","div","uniquePeriods","index","thead","tbody","periodsRow","currentTh","label","unitsRow","th","td","behindOverlayRow","overlayDigitSpans","overlayDigitSpan","digitSpan","divCalculus","divButtons","playPauseButton","previousButton","nextButton","button","innerSvg","initialNumberString","afterComma","initialNumber","color","number","unitPow","scaledNumber","_b","firstNonZeroIndex","lastNonZeroIndex","value","overlayUnitDigitIndex","overlayUnitDigitSpan"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}