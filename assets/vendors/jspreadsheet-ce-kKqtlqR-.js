import{g as getDefaultExportFromCjs}from"./seedrandom-Cz-2rAdY.js";import{c as commonjsRequire}from"./crypto-js-DElKCTCw.js";import{r as requireJsuites}from"./jsuites-D-TmSgJs.js";import{r as requireDist$1}from"./jspreadsheet_formula-CXu1m5Ak.js";var dist$1={exports:{}},dist=dist$1.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(module,exports$1){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();if(!formula&&typeof commonjsRequire=="function")var formula=requireDist$1();(function(e,n){module.exports=n()})(dist,(function(){var jspreadsheet;return(function(){var __webpack_modules__={94:function(e,n,t){t.d(n,{My:function(){return h},Th:function(){return c},iY:function(){return u}});var s=t(911),o=t(805),r=t(530),a=t(497),l=t(829);const c=function(C,d){const b=this;for(let m=0;m<b.headers.length;m++)b.headers[m].classList.remove("arrow-up"),b.headers[m].classList.remove("arrow-down");d?b.headers[C].classList.add("arrow-up"):b.headers[C].classList.add("arrow-down")},u=function(C){const d=this;let b=[];for(let m=0;m<C.length;m++)b[m]=d.options.data[C[m]];d.options.data=b,b=[];for(let m=0;m<C.length;m++){b[m]=d.records[C[m]];for(let j=0;j<b[m].length;j++)b[m][j].y=m}d.records=b,b=[];for(let m=0;m<C.length;m++)b[m]=d.rows[C[m]],b[m].y=m;if(d.rows=b,r.o8.call(d),d.results&&d.results.length)d.searchInput.value?d.search(d.searchInput.value):l.F8.call(d);else if(d.results=null,d.pageNumber=0,d.options.pagination>0)d.page(0);else if(d.options.lazyLoading==1)a.wu.call(d,0);else for(let m=0;m<d.rows.length;m++)d.tbody.appendChild(d.rows[m].element)},h=function(C,d){const b=this;if(C>=0){if(b.options.mergeCells&&Object.keys(b.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;b.destroyMerge()}d=d==null?b.headers[C].classList.contains("arrow-down")?1:0:d?1:0;let m=[];if(b.options.columns&&b.options.columns[C]&&(b.options.columns[C].type=="number"||b.options.columns[C].type=="numeric"||b.options.columns[C].type=="percentage"||b.options.columns[C].type=="autonumber"||b.options.columns[C].type=="color"))for(let f=0;f<b.options.data.length;f++)m[f]=[f,Number(b.options.data[f][C])];else if(b.options.columns&&b.options.columns[C]&&(b.options.columns[C].type=="calendar"||b.options.columns[C].type=="checkbox"||b.options.columns[C].type=="radio"))for(let f=0;f<b.options.data.length;f++)m[f]=[f,b.options.data[f][C]];else for(let f=0;f<b.options.data.length;f++)m[f]=[f,b.records[f][C].element.textContent.toLowerCase()];typeof b.parent.config.sorting!="function"&&(b.parent.config.sorting=function(f){return function(p,g){const w=p[1],B=g[1];return f?w===""&&B!==""?1:w!==""&&B===""||w>B?-1:w<B?1:0:w===""&&B!==""?1:w!==""&&B===""?-1:w>B?1:w<B?-1:0}}),m=m.sort(b.parent.config.sorting(d));const j=[];for(let f=0;f<m.length;f++)j[f]=m[f][0];return s.Dh.call(b,{action:"orderBy",rows:j,column:C,order:d}),c.call(b,C,d),u.call(b,j),o.A.call(b,"onsort",b,C,d,j.map(f=>f)),!0}}},160:function(e,n,t){t.d(n,{e:function(){return o}});var s=t(530);const o=function(r){const a=this;if(r&&(a.options.footers=r),a.options.footers){a.tfoot||(a.tfoot=document.createElement("tfoot"),a.table.appendChild(a.tfoot));for(let l=0;l<a.options.footers.length;l++){let c;if(a.tfoot.children[l])c=a.tfoot.children[l];else{c=document.createElement("tr");const u=document.createElement("td");c.appendChild(u),a.tfoot.appendChild(c)}for(let u=0;u<a.headers.length;u++){let h;if(a.options.footers[l][u]||(a.options.footers[l][u]=""),a.tfoot.children[l].children[u+1])h=a.tfoot.children[l].children[u+1];else{h=document.createElement("td"),c.appendChild(h);const C=a.options.columns[u].align||a.options.defaultColAlign||"center";h.style.textAlign=C}h.textContent=s.$x.call(a,+a.records.length+u,l,a.options.footers[l][u]),h.style.display=a.cols[u].colElement.style.display}}}}},167:function(e,n,t){t.d(n,{$f:function(){return c},IV:function(){return a},MY:function(){return l},ho:function(){return r}});var s=t(805),o=t(657);const r=function(u){const h=this;return h.options.search!=1&&h.options.filters!=1||!h.results||(u=h.results.indexOf(u)),Math.ceil((parseInt(u)+1)/parseInt(h.options.pagination))-1},a=function(){const u=this;if(u.pagination.children[0].innerHTML="",u.pagination.children[1].innerHTML="",u.options.pagination){let h;if(h=u.options.search!=1&&u.options.filters!=1||!u.results?u.rows.length:u.results.length,h){const C=Math.ceil(h/u.options.pagination);let d,b;if(u.pageNumber<6?(d=1,b=C<10?C:10):C-u.pageNumber<5?(d=C-9,b=C,d<1&&(d=1)):(d=u.pageNumber-4,b=u.pageNumber+5),d>1){const j=document.createElement("div");j.className="jss_page",j.innerHTML="<",j.title=1,u.pagination.children[1].appendChild(j)}for(let j=d;j<=b;j++){const f=document.createElement("div");f.className="jss_page",f.innerHTML=j,u.pagination.children[1].appendChild(f),u.pageNumber==j-1&&f.classList.add("jss_page_selected")}if(b<C){const j=document.createElement("div");j.className="jss_page",j.innerHTML=">",j.title=C,u.pagination.children[1].appendChild(j)}const m=function(j){const f=Array.prototype.slice.call(arguments,1);return j.replace(/{(\d+)}/g,function(p,g){return f[g]!==void 0?f[g]:p})};u.pagination.children[0].innerHTML=m(jSuites.translate("Showing page {0} of {1} entries"),u.pageNumber+1,C)}else u.pagination.children[0].innerHTML=jSuites.translate("No records found")}},l=function(u){const h=this,C=h.pageNumber;let d;d=h.options.search!=1&&h.options.filters!=1||!h.results?h.rows:h.results;const b=parseInt(h.options.pagination);u!=null&&u!=-1||(u=Math.ceil(d.length/b)-1),h.pageNumber=u;let m=u*b,j=u*b+b;for(j>d.length&&(j=d.length),m<0&&(m=0);h.tbody.firstChild;)h.tbody.removeChild(h.tbody.firstChild);for(let f=m;f<j;f++)h.options.search!=1&&h.options.filters!=1||!h.results?h.tbody.appendChild(h.rows[f].element):h.tbody.appendChild(h.rows[d[f]].element);h.options.pagination>0&&a.call(h),o.Aq.call(h),s.A.call(h,"onchangepage",h,u,C,h.options.pagination)},c=function(){const u=this;let h;return h=u.options.search!=1&&u.options.filters!=1||!u.results?u.rows.length:u.results.length,Math.ceil(h/u.options.pagination)}},296:function(e,n,t){t.d(n,{w:function(){return s}});const s=function(){const o=this;let r=0;if(o.options.freezeColumns>0)for(let a=0;a<o.options.freezeColumns;a++){let l;l=o.options.columns&&o.options.columns[a]&&o.options.columns[a].width!==void 0?parseInt(o.options.columns[a].width):o.options.defaultColWidth!==void 0?parseInt(o.options.defaultColWidth):100,r+=l}return r}},344:function(e){e.exports=JSON.parse('{"fr_FR":{"SOMME":"SUM","MOYENNE":"AVERAGE","MIN":"MIN","MAX":"MAX","SI":"IF","ET":"AND","OU":"OR","NON":"NOT","NB":"COUNT","NBVAL":"COUNTA","PRODUIT":"PRODUCT","ARRONDI":"ROUND","ARRONDI.INF":"ROUNDDOWN","ARRONDI.SUP":"ROUNDUP","SOMME.SI":"SUMIF","SOMME.SI.ENS":"SUMIFS","MOYENNE.SI":"AVERAGEIF","MOYENNE.SI.ENS":"AVERAGEIFS","NB.SI":"COUNTIF","NB.SI.ENS":"COUNTIFS","CONCATENER":"CONCATENATE","CONCAT":"CONCAT","TEXTE":"TEXT","GAUCHE":"LEFT","DROITE":"RIGHT","STXT":"MID","CHERCHE":"SEARCH","TROUVE":"FIND","SUBSTITUE":"SUBSTITUTE","REMPLACER":"REPLACE","MAJUSCULE":"UPPER","MINUSCULE":"LOWER","NOMPROPRE":"PROPER","AUJOURDHUI":"TODAY","MAINTENANT":"NOW","DATE":"DATE","ANNEE":"YEAR","MOIS":"MONTH","JOUR":"DAY","HEURE":"HOUR","MINUTE":"MINUTE","SECONDE":"SECOND","ABS":"ABS","MOD":"MOD","PUISSANCE":"POWER","RANG":"RANK","ALEA":"RAND","ALEA.ENTRE.BORNES":"RANDBETWEEN","SIERREUR":"IFERROR","ESTERREUR":"ISERROR","ESTNUM":"ISNUMBER","ESTTEXTE":"ISTEXT","ESTVIDE":"ISBLANK","NB.JOURS.OUVRES":"NETWORKDAYS","NB.JOURS.OUVRES.INTL":"NETWORKDAYS.INTL","JOURSEM":"WEEKDAY","NB.JOURS":"DAYS","NB.JOURS360":"DAYS360"},"es_ES":{"SUMA":"SUM","PROMEDIO":"AVERAGE","MIN":"MIN","MAX":"MAX","SI":"IF","Y":"AND","O":"OR","NO":"NOT","CONTAR":"COUNT","CONTARA":"COUNTA","PRODUCTO":"PRODUCT","REDONDEAR":"ROUND","REDONDEAR.MENOS":"ROUNDDOWN","REDONDEAR.MAS":"ROUNDUP","SUMAR.SI":"SUMIF","SUMAR.SI.CONJUNTO":"SUMIFS","PROMEDIO.SI":"AVERAGEIF","PROMEDIO.SI.CONJUNTO":"AVERAGEIFS","CONTAR.SI":"COUNTIF","CONTAR.SI.CONJUNTO":"COUNTIFS","CONCATENAR":"CONCATENATE","CONCAT":"CONCAT","TEXTO":"TEXT","IZQUIERDA":"LEFT","DERECHA":"RIGHT","EXTRAE":"MID","HALLAR":"SEARCH","ENCONTRAR":"FIND","SUSTITUIR":"SUBSTITUTE","REEMPLAZAR":"REPLACE","MAYUSC":"UPPER","MINUSC":"LOWER","NOMPROPIO":"PROPER","HOY":"TODAY","AHORA":"NOW","FECHA":"DATE","AÃ‘O":"YEAR","MES":"MONTH","DIA":"DAY","HORA":"HOUR","MINUTO":"MINUTE","SEGUNDO":"SECOND","ABS":"ABS","RESIDUO":"MOD","POTENCIA":"POWER","JERARQUIA":"RANK","ALEATORIO":"RAND","ALEATORIO.ENTRE":"RANDBETWEEN","SI.ERROR":"IFERROR","ESERROR":"ISERROR","ESNUMERO":"ISNUMBER","ESTEXTO":"ISTEXT","ESBLANCO":"ISBLANK","DIAS.LAB":"NETWORKDAYS","DIAS.LAB.INTL":"NETWORKDAYS.INTL","DIASEM":"WEEKDAY","DIAS":"DAYS","DIAS360":"DAYS360"}}')},392:function(e,n,t){t.d(n,{Ar:function(){return C},ll:function(){return h},nK:function(){return u}});var s=t(978),o=t(530);const r=function(d,b){b.options.editable!=0?d.classList.remove("jtoolbar-disabled"):d.classList.add("jtoolbar-disabled")},a=function(){const d=[],b=this,m=function(){return o.eN.call(b)};d.push({content:"undo",onclick:function(){m().undo()}}),d.push({content:"redo",onclick:function(){m().redo()}}),d.push({content:"save",onclick:function(){const f=m();f&&f.download()}}),d.push({type:"divisor"}),d.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(f){return'<span style="font-family:'+f+'">'+f+"</span>"},onchange:function(f,p,g,w,B){const v=m();let R=v.getSelected(!0);if(R){let k=B?w:"";v.setStyle(Object.fromEntries(R.map(function(I){return[I,"font-family: "+k]})))}},updateState:function(f,p,g){r(g,m())}}),d.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(f){return'<span style="font-size:'+f+'">'+f+"</span>"},onchange:function(f,p,g,w){const B=m();let v=B.getSelected(!0);v&&B.setStyle(Object.fromEntries(v.map(function(R){return[R,"font-size: "+w]})))},updateState:function(f,p,g){r(g,m())}}),d.push({type:"select",options:["left","center","right","justify"],render:function(f){return'<i class="material-icons">format_align_'+f+"</i>"},onchange:function(f,p,g,w){const B=m();let v=B.getSelected(!0);v&&B.setStyle(Object.fromEntries(v.map(function(R){return[R,"text-align: "+w]})))},updateState:function(f,p,g){r(g,m())}}),d.push({content:"format_bold",onclick:function(){const f=m();let p=f.getSelected(!0);p&&f.setStyle(Object.fromEntries(p.map(function(g){return[g,"font-weight:bold"]})))},updateState:function(f,p,g){r(g,m())}}),d.push({type:"color",content:"format_color_text",k:"color",updateState:function(f,p,g){r(g,m())}}),d.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(f,p,g,w){r(g,m())}});let j=["top","middle","bottom"];return d.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(f){return'<i class="material-icons">'+f+"</i>"},value:1,onchange:function(f,p,g,w,B){const v=m();let R=v.getSelected(!0);R&&v.setStyle(Object.fromEntries(R.map(function(k){return[k,"vertical-align: "+j[B]]})))},updateState:function(f,p,g){r(g,m())}}),d.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const f=m();if(f.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const p=[Math.min(f.selectedCell[0],f.selectedCell[2]),Math.min(f.selectedCell[1],f.selectedCell[3]),Math.max(f.selectedCell[0],f.selectedCell[2]),Math.max(f.selectedCell[1],f.selectedCell[3])];let g=(0,s.getCellNameFromCoords)(p[0],p[1]);if(f.records[p[1]][p[0]].element.getAttribute("data-merged"))f.removeMerge(g);else{let w=p[2]-p[0]+1,B=p[3]-p[1]+1;w===1&&B===1||f.setMerge(g,w,B)}}},updateState:function(f,p,g){r(g,m())}}),d.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(f){return'<i class="material-icons">'+f+"</i>"},right:!0,onchange:function(f,p,g,w){const B=m();if(B.selectedCell){const v=[Math.min(B.selectedCell[0],B.selectedCell[2]),Math.min(B.selectedCell[1],B.selectedCell[3]),Math.max(B.selectedCell[0],B.selectedCell[2]),Math.max(B.selectedCell[1],B.selectedCell[3])];let R=w;if(v){let k=p.thickness||1,I=p.color||"black";const E=p.style||"solid";E==="double"&&(k+=2);let N={},T=v[0],M=v[1],_=v[2],A=v[3];const S=function(O,H,L){let U=["","","",""];U[0]=(R==="border_top"||R==="border_outer")&&L===M||(R==="border_inner"||R==="border_horizontal")&&L>M||R==="border_all"?"border-top: "+k+"px "+E+" "+I:"border-top: ",U[1]=R!=="border_all"&&R!=="border_right"&&R!=="border_outer"||H!==_?"border-right: ":"border-right: "+k+"px "+E+" "+I,U[2]=R!=="border_all"&&R!=="border_bottom"&&R!=="border_outer"||L!==A?"border-bottom: ":"border-bottom: "+k+"px "+E+" "+I,U[3]=(R==="border_left"||R==="border_outer")&&H===T||(R==="border_inner"||R==="border_vertical")&&H>T||R==="border_all"?"border-left: "+k+"px "+E+" "+I:"border-left: ",N[O]=U.join(";")};for(let O=v[1];O<=v[3];O++)for(let H=v[0];H<=v[2];H++)S((0,s.getCellNameFromCoords)(H,O),H,O),B.records[O][H].element.getAttribute("data-merged")&&S((0,s.getCellNameFromCoords)(v[0],v[1]),H,O);Object.keys(N)&&B.setStyle(N)}}},onload:function(f,p){let g=document.createElement("div"),w=document.createElement("div");g.appendChild(w);let B=jSuites.color(w,{closeOnChange:!1,onchange:function(k,I){k.parentNode.children[1].style.color=I,p.color=I}}),v=document.createElement("i");v.classList.add("material-icons"),v.innerHTML="color_lens",v.onclick=function(){B.open()},g.appendChild(v),f.children[1].appendChild(g),w=document.createElement("div"),jSuites.picker(w,{type:"select",data:[1,2,3,4,5],render:function(k){return'<div style="height: '+k+'px; width: 30px; background-color: black;"></div>'},onchange:function(k,I,E,N){p.thickness=N},width:"50px"}),f.children[1].appendChild(w);const R=document.createElement("div");jSuites.picker(R,{type:"select",data:["solid","dotted","dashed","double"],render:function(k){return k==="double"?'<div style="width: 30px; border-top: 3px '+k+' black;"></div>':'<div style="width: 30px; border-top: 2px '+k+' black;"></div>'},onchange:function(k,I,E,N){p.style=N},width:"50px"}),f.children[1].appendChild(R),w=document.createElement("div"),w.style.flex="1",f.children[1].appendChild(w)},updateState:function(f,p,g){r(g,m())}}),d.push({type:"divisor"}),d.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(f,p,g){g.children[0].textContent==="fullscreen"?(b.fullscreen(!0),g.children[0].textContent="fullscreen_exit"):(b.fullscreen(!1),g.children[0].textContent="fullscreen")},updateState:function(f,p,g,w){w.parent.config.fullscreen===!0?g.children[0].textContent="fullscreen_exit":g.children[0].textContent="fullscreen"}}),d},l=function(d){const b=this,m=d.items;for(let j=0;j<m.length;j++)m[j].tooltip&&(m[j].title=m[j].tooltip,delete m[j].tooltip),m[j].type=="select"?m[j].options?(m[j].data=m[j].options,delete m[j].options):(m[j].data=m[j].v,delete m[j].v,m[j].k&&!m[j].onchange&&(m[j].onchange=function(f,p,g){const w=o.eN.call(b),B=w.getSelected(!0);w.setStyle(Object.fromEntries(B.map(function(v){return[v,m[j].k+": "+g]})))})):m[j].type=="color"&&(m[j].type="i",m[j].onclick=function(f,p,g){g.color||(jSuites.color(g,{onchange:function(w,B){const v=o.eN.call(b),R=v.getSelected(!0);v.setStyle(Object.fromEntries(R.map(function(k){return[k,m[j].k+": "+B]})))},onopen:function(w){w.color.select("")}}),g.color.open())})},c=function(d){const b=this,m=document.createElement("div");return m.classList.add("jss_toolbar"),l.call(b,d),typeof b.plugins=="object"&&Object.entries(b.plugins).forEach(function([,j]){if(typeof j.toolbar=="function"){const f=j.toolbar(d);f&&(d=f)}}),jSuites.toolbar(m,d),m},u=function(d){d.parent.toolbar&&d.parent.toolbar.toolbar.update(d)},h=function(){const d=this;if(d.config.toolbar&&!d.toolbar){let b;Array.isArray(d.config.toolbar)?b={items:d.config.toolbar}:typeof d.config.toolbar=="object"?b=d.config.toolbar:(b={items:a.call(d)},typeof d.config.toolbar=="function"&&(b=d.config.toolbar(b))),d.toolbar=d.element.insertBefore(c.call(d,b),d.element.children[1])}},C=function(){const d=this;d.toolbar&&(d.toolbar.parentNode.removeChild(d.toolbar),delete d.toolbar)}},497:function(e,n,t){t.d(n,{AG:function(){return o},G_:function(){return r},p6:function(){return a},wu:function(){return s}});const s=function(l){const c=this;let u;u=c.options.search!=1&&c.options.filters!=1||!c.results?c.rows:c.results;const h=100;l!=null&&l!=-1||(l=Math.ceil(u.length/h)-1);let C=l*h,d=l*h+h;d>u.length&&(d=u.length),C=d-100,C<0&&(C=0);for(let b=C;b<d;b++)c.options.search!=1&&c.options.filters!=1||!c.results?c.tbody.appendChild(c.rows[b].element):c.tbody.appendChild(c.rows[u[b]].element),c.tbody.children.length>h&&c.tbody.removeChild(c.tbody.firstChild)},o=function(){const l=this;if(l.selectedCell){const c=parseInt(l.tbody.firstChild.getAttribute("data-y"))/100,u=parseInt(l.selectedCell[3]/100),h=parseInt(l.rows.length/100);if(c!=u&&u<=h&&!Array.prototype.indexOf.call(l.tbody.children,l.rows[l.selectedCell[3]].element))return l.loadPage(u),!0}return!1},r=function(){const l=this;let c;c=l.options.search!=1&&l.options.filters!=1||!l.results?l.rows:l.results;let u=0;if(c.length>100){let h=parseInt(l.tbody.firstChild.getAttribute("data-y"));if(l.options.search!=1&&l.options.filters!=1||!l.results||(h=c.indexOf(h)),h>0)for(let C=0;C<30;C++)h-=1,h>-1&&(l.options.search!=1&&l.options.filters!=1||!l.results?l.tbody.insertBefore(l.rows[h].element,l.tbody.firstChild):l.tbody.insertBefore(l.rows[c[h]].element,l.tbody.firstChild),l.tbody.children.length>100&&(l.tbody.removeChild(l.tbody.lastChild),u=1))}return u},a=function(){const l=this;let c;c=l.options.search!=1&&l.options.filters!=1||!l.results?l.rows:l.results;let u=0;if(c.length>100){let h=parseInt(l.tbody.lastChild.getAttribute("data-y"));if(l.options.search!=1&&l.options.filters!=1||!l.results||(h=c.indexOf(h)),h<l.rows.length-1)for(let C=0;C<=30;C++)h<c.length&&(l.options.search!=1&&l.options.filters!=1||!l.results?l.tbody.appendChild(l.rows[h].element):l.tbody.appendChild(l.rows[c[h]].element),l.tbody.children.length>100&&(l.tbody.removeChild(l.tbody.firstChild),u=1)),h+=1}return u}},530:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$O:function(){return getWorksheetActive},$x:function(){return parseValue},C6:function(){return showIndex},Em:function(){return executeFormula},P9:function(){return createCell},Rs:function(){return updateScroll},TI:function(){return hideIndex},Xr:function(){return getCellFromCoords},Y5:function(){return fullscreen},am:function(){return updateTable},dw:function(){return isFormula},eN:function(){return getWorksheetInstance},hG:function(){return updateResult},ju:function(){return createNestedHeader},k9:function(){return updateCell},o8:function(){return updateTableReferences},p9:function(){return getLabel},rS:function(){return getMask},tT:function(){return getCell},xF:function(){return updateFormulaChain},yB:function(){return updateFormula}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(805),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(657),_helpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(978),_meta_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(654),_freeze_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(296),_pagination_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(167),_footer_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(160),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(689),_formulasTranslater_json__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(344);const locale=(navigator.language||navigator.userLanguage).replace("-","_")||"en_US",updateTable=function(){const e=this;if(e.options.minSpareRows>0){let n=0;for(let t=e.rows.length-1;t>=0;t--){let s=!1;for(let o=0;o<e.headers.length;o++)e.options.data[t][o]&&(s=!0);if(s)break;n++}e.options.minSpareRows-n>0&&e.insertRow(e.options.minSpareRows-n)}if(e.options.minSpareCols>0){let n=0;for(let t=e.headers.length-1;t>=0;t--){let s=!1;for(let o=0;o<e.rows.length;o++)e.options.data[o][t]&&(s=!0);if(s)break;n++}e.options.minSpareCols-n>0&&e.insertColumn(e.options.minSpareCols-n)}e.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_6__.e.call(e),e.options.columns.length<e.options.minDimensions[0]&&(e.options.minDimensions[0]=e.options.columns.length),setTimeout(function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(e)},0)},parseNumber=function(e,n){const t=n&&this.options.columns[n].decimal?this.options.columns[n].decimal:".";let s=""+e;return s=s.split(t),s[0]=s[0].match(/[+-]?[0-9]/g),s[0]&&(s[0]=s[0].join("")),s[1]&&(s[1]=s[1].match(/[0-9]*/g).join("")),s[0]&&Number.isInteger(Number(s[0]))?s[1]?+(s[0]+"."+s[1]):+(s[0]+".00"):null};function translateFormula(e){e=e.toUpperCase();const n=_formulasTranslater_json__WEBPACK_IMPORTED_MODULE_8__[locale]||{};for(const t in n)e=e.replaceAll(t,n[t]);return e}const executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[];expression=translateFormula(expression);const execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(e){for(let n=0;n<e.length;n++){const t=[],s=e[n].split(":"),o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(s[0],!0),r=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(s[1],!0);let a,l,c,u;o[0]<=r[0]?(a=o[0],l=r[0]):(a=r[0],l=o[0]),o[1]<=r[1]?(c=o[1],u=r[1]):(c=r[1],u=o[1]);for(let h=c;h<=u;h++)for(let C=a;C<=l;C++)t.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([C,h]));expression=expression.replace(e[n],t.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+):([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens){for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const e=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(tokens[i],1);let n;if(n=obj.options.data[e[1]]!==void 0&&obj.options.data[e[1]][e[0]]!==void 0?obj.options.data[e[1]][e[0]]:"",(""+n).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?n=formulaResults[tokens[i]]:(n=execute(n,e[0],e[1]),formulaResults[tokens[i]]=n)),(""+n).trim()=="")formulaExpressions[tokens[i]]=null;else if(n==Number(n)&&obj.parent.config.autoCasting!=0)formulaExpressions[tokens[i]]=Number(n);else{const t=parseNumber.call(obj,n,e[0]);obj.parent.config.autoCasting!=0&&t?formulaExpressions[tokens[i]]=t:formulaExpressions[tokens[i]]='"'+n+'"'}}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(obj,"onbeforeformula",obj,expression,x,y);if(ret===!1)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),typeof res=="function"&&(res="#ERROR")}catch(e){res="#ERROR",obj.parent.config.debugFormulas===!0&&console.log(expression.substr(1),formulaExpressions,e)}return res}};return execute(translateFormula(expression),x,y)},parseValue=function(e,n,t,s){const o=this;(""+t).substr(0,1)=="="&&o.parent.config.parseFormulas!=0&&(t=executeFormula.call(o,t,e,n));const r=o.options.columns&&o.options.columns[e];if(r&&!isFormula(t)){let a=null;if(a=getMask(r)){t&&t==Number(t)&&(t=Number(t));let l=jSuites.mask.render(t,a,!0);if(s&&a.mask){const c=a.mask.split(";");c[1]&&(c[1].match(new RegExp("\\[Red\\]","gi"))&&(t<0?s.classList.add("red"):s.classList.remove("red")),c[1].match(new RegExp("\\(","gi"))&&t<0&&(l="("+l+")"))}l&&(t=l)}}return t},getDropDownValue=function(e,n){const t=this,s=[];if(t.options.columns&&t.options.columns[e]&&t.options.columns[e].source){const o=[],r=t.options.columns[e].source;for(let l=0;l<r.length;l++)typeof r[l]=="object"?o[r[l].id]=r[l].name:o[r[l]]=r[l];const a=Array.isArray(n)?n:(""+n).split(";");for(let l=0;l<a.length;l++)typeof a[l]=="object"?s.push(o[a[l].id]):o[a[l]]&&s.push(o[a[l]])}else console.error("Invalid column");return s.length>0?s.join("; "):""},validDate=function(e){return(e=""+e).substr(4,1)=="-"&&e.substr(7,1)=="-"||(e=e.split("-"))[0].length==4&&e[0]==Number(e[0])&&e[1].length==2&&e[1]==Number(e[1])},stripScript=function(e){const n=new Option;n.innerHTML=e;let t=null;for(e=n.getElementsByTagName("script");t=e[0];)t.parentNode.removeChild(t);return n.innerHTML},createCell=function(e,n,t){const s=this;let o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",n),s.headers[e].style.display==="none"&&(o.style.display="none"),(""+t).substr(0,1)=="="&&s.options.secureFormulas==1){const a=secureFormula(t);a!=t&&(t=a)}if(s.options.columns&&s.options.columns[e]&&typeof s.options.columns[e].type=="object")s.parent.config.parseHTML===!0?o.innerHTML=t:o.textContent=t,typeof s.options.columns[e].type.createCell=="function"&&s.options.columns[e].type.createCell(o,t,parseInt(e),parseInt(n),s,s.options.columns[e]);else if(s.options.columns&&s.options.columns[e]&&s.options.columns[e].type=="hidden")o.style.display="none",o.textContent=t;else if(s.options.columns&&s.options.columns[e]&&(s.options.columns[e].type=="checkbox"||s.options.columns[e].type=="radio")){const a=document.createElement("input");a.type=s.options.columns[e].type,a.name="c"+e,a.checked=t==1||t==1||t=="true",a.onclick=function(){s.setValue(o,this.checked)},s.options.columns[e].readOnly!=1&&s.options.editable!=0||a.setAttribute("disabled","disabled"),o.appendChild(a),s.options.data[n][e]=a.checked}else if(s.options.columns&&s.options.columns[e]&&s.options.columns[e].type=="calendar"){let a=null;if(!validDate(t)){const l=jSuites.calendar.extractDateFromString(t,s.options.columns[e].options&&s.options.columns[e].options.format||"YYYY-MM-DD");l&&(a=l)}o.textContent=jSuites.calendar.getDateString(a||t,s.options.columns[e].options&&s.options.columns[e].options.format)}else if(s.options.columns&&s.options.columns[e]&&s.options.columns[e].type=="dropdown")o.classList.add("jss_dropdown"),o.textContent=getDropDownValue.call(s,e,t);else if(s.options.columns&&s.options.columns[e]&&s.options.columns[e].type=="color")if(s.options.columns[e].render=="square"){const a=document.createElement("div");a.className="color",a.style.backgroundColor=t,o.appendChild(a)}else o.style.color=t,o.textContent=t;else if(s.options.columns&&s.options.columns[e]&&s.options.columns[e].type=="image"){if(t&&t.substr(0,10)=="data:image"){const a=document.createElement("img");a.src=t,o.appendChild(a)}}else s.options.columns&&s.options.columns[e]&&s.options.columns[e].type=="html"||s.parent.config.parseHTML===!0?o.innerHTML=stripScript(parseValue.call(this,e,n,t,o)):o.textContent=parseValue.call(this,e,n,t,o);s.options.columns&&s.options.columns[e]&&s.options.columns[e].readOnly==1&&(o.className="readonly");const r=s.options.columns&&s.options.columns[e]&&s.options.columns[e].align||s.options.defaultColAlign||"center";return o.style.textAlign=r,s.options.columns&&s.options.columns[e]&&s.options.columns[e].wordWrap==0||!(s.options.wordWrap==1||s.options.columns&&s.options.columns[e]&&s.options.columns[e].wordWrap==1||o.innerHTML.length>200)||(o.style.whiteSpace="pre-wrap"),e>0&&this.options.textOverflow==1&&(t||o.innerHTML?s.records[n][e-1].element.style.overflow="hidden":e==s.options.columns.length-1&&(o.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(s,"oncreatecell",s,o,e,n,t),o},updateCell=function(e,n,t,s){const o=this;let r;if(o.records[n][e].element.classList.contains("readonly")!=1||s){if((""+t).substr(0,1)=="="&&o.options.secureFormulas==1){const c=secureFormula(t);c!=t&&(t=c)}const a=_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(o,"onbeforechange",o,o.records[n][e].element,e,n,t);if(a!=null&&(t=a),o.options.columns&&o.options.columns[e]&&typeof o.options.columns[e].type=="object"&&typeof o.options.columns[e].type.updateCell=="function"){const c=o.options.columns[e].type.updateCell(o.records[n][e].element,t,parseInt(e),parseInt(n),o,o.options.columns[e]);c!==void 0&&(t=c)}r={x:e,y:n,col:e,row:n,value:t,oldValue:o.options.data[n][e]};let l=o.options.columns&&o.options.columns[e]&&typeof o.options.columns[e].type=="object"?o.options.columns[e].type:null;if(l)o.options.data[n][e]=t,typeof l.setValue=="function"&&l.setValue(o.records[n][e].element,t);else if(o.options.columns&&o.options.columns[e]&&(o.options.columns[e].type=="checkbox"||o.options.columns[e].type=="radio")){if(o.options.columns[e].type=="radio")for(let c=0;c<o.options.data.length;c++)o.options.data[c][e]=!1;o.records[n][e].element.children[0].checked=t==1||t==1||t=="true"||t=="TRUE",o.options.data[n][e]=o.records[n][e].element.children[0].checked}else if(o.options.columns&&o.options.columns[e]&&o.options.columns[e].type=="dropdown")o.options.data[n][e]=t,o.records[n][e].element.textContent=getDropDownValue.call(o,e,t);else if(o.options.columns&&o.options.columns[e]&&o.options.columns[e].type=="calendar"){let c=null;if(!validDate(t)){const u=jSuites.calendar.extractDateFromString(t,o.options.columns[e].options&&o.options.columns[e].options.format||"YYYY-MM-DD");u&&(c=u)}o.options.data[n][e]=t,o.records[n][e].element.textContent=jSuites.calendar.getDateString(c||t,o.options.columns[e].options&&o.options.columns[e].options.format)}else if(o.options.columns&&o.options.columns[e]&&o.options.columns[e].type=="color")if(o.options.data[n][e]=t,o.options.columns[e].render=="square"){const c=document.createElement("div");c.className="color",c.style.backgroundColor=t,o.records[n][e].element.textContent="",o.records[n][e].element.appendChild(c)}else o.records[n][e].element.style.color=t,o.records[n][e].element.textContent=t;else if(o.options.columns&&o.options.columns[e]&&o.options.columns[e].type=="image"){if(t=""+t,o.options.data[n][e]=t,o.records[n][e].element.innerHTML="",t&&t.substr(0,10)=="data:image"){const c=document.createElement("img");c.src=t,o.records[n][e].element.appendChild(c)}}else o.options.data[n][e]=t,o.options.columns&&o.options.columns[e]&&o.options.columns[e].type=="html"?o.records[n][e].element.innerHTML=stripScript(parseValue.call(o,e,n,t)):o.parent.config.parseHTML===!0?o.records[n][e].element.innerHTML=stripScript(parseValue.call(o,e,n,t,o.records[n][e].element)):o.records[n][e].element.textContent=parseValue.call(o,e,n,t,o.records[n][e].element),o.options.columns&&o.options.columns[e]&&o.options.columns[e].wordWrap==0||!(o.options.wordWrap==1||o.options.columns&&o.options.columns[e]&&o.options.columns[e].wordWrap==1||o.records[n][e].element.innerHTML.length>200)?o.records[n][e].element.style.whiteSpace="":o.records[n][e].element.style.whiteSpace="pre-wrap";e>0&&(o.records[n][e-1].element.style.overflow=t?"hidden":""),o.options.columns&&o.options.columns[e]&&typeof o.options.columns[e].render=="function"&&o.options.columns[e].render(o.records[n]&&o.records[n][e]?o.records[n][e].element:null,t,parseInt(e),parseInt(n),o,o.options.columns[e]),_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(o,"onchange",o,o.records[n]&&o.records[n][e]?o.records[n][e].element:null,e,n,t,r.oldValue)}else r={x:e,y:n,col:e,row:n};return r},isFormula=function(e){const n=(""+e)[0];return n=="="||n=="#"},getMask=function(e){if(e.format||e.mask||e.locale){const n={};return e.mask?n.mask=e.mask:e.format?n.mask=e.format:(n.locale=e.locale,n.options=e.options),e.decimal&&(n.options||(n.options={}),n.options={decimal:e.decimal}),n}return null},secureFormula=function(e){let n="",t=0;for(let s=0;s<e.length;s++)e[s]=='"'&&(t=t==0?1:0),n+=t==1?e[s]:e[s].toUpperCase();return n};let chainLoopProtection=[];const updateFormulaChain=function(e,n,t){const s=this,o=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([e,n]);if(s.formula[o]&&s.formula[o].length>0)if(chainLoopProtection[o])s.records[n][e].element.innerHTML="#ERROR",s.formula[o]="";else{chainLoopProtection[o]=!0;for(let r=0;r<s.formula[o].length;r++){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(s.formula[o][r],!0),l=""+s.options.data[a[1]][a[0]];l.substr(0,1)=="="?t.push(updateCell.call(s,a[0],a[1],l,!0)):Object.keys(s.formula)[r]=null,updateFormulaChain.call(s,a[0],a[1],t)}}chainLoopProtection=[]},updateFormula=function(e,n){const t=/[A-Z]/,s=/[0-9]/;let o="",r=null,a=null,l="";for(let c=0;c<e.length;c++)t.exec(e[c])?(r=1,a=0,l+=e[c]):s.exec(e[c])?(a=r?1:0,l+=e[c]):(r&&a&&(l=n[l]?n[l]:l),o+=l,o+=e[c],r=0,a=0,l="");return l&&(r&&a&&(l=n[l]?n[l]:l),o+=l),o},updateFormulas=function(e){const n=this;for(let o=0;o<n.options.data.length;o++)for(let r=0;r<n.options.data[0].length;r++){const a=""+n.options.data[o][r];if(a.substr(0,1)=="="){const l=updateFormula(a,e);l!=a&&(n.options.data[o][r]=l)}}const t=[],s=Object.keys(n.formula);for(let o=0;o<s.length;o++){let r=s[o];const a=n.formula[r];e[r]&&(r=e[r]),t[r]=[];for(let l=0;l<a.length;l++){let c=a[l];e[c]&&(c=e[c]),t[r].push(c)}}n.formula=t},updateTableReferences=function(){const e=this;if(e.skipUpdateTableReferences)return;for(let r=0;r<e.headers.length;r++)e.headers[r].getAttribute("data-x")!=r&&(e.headers[r].setAttribute("data-x",r),e.headers[r].getAttribute("title")||(e.headers[r].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_2__.getColumnName)(r)));for(let r=0;r<e.rows.length;r++)e.rows[r]&&e.rows[r].element.getAttribute("data-y")!=r&&(e.rows[r].element.setAttribute("data-y",r),e.rows[r].element.children[0].setAttribute("data-y",r),e.rows[r].element.children[0].innerHTML=r+1);const n=[],t=[],s=function(r,a,l,c){if(r!=l&&e.records[c][l].element.setAttribute("data-x",l),a!=c&&e.records[c][l].element.setAttribute("data-y",c),r!=l||a!=c){const u=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([r,a]),h=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([l,c]);n[u]=h}};for(let r=0;r<e.records.length;r++)for(let a=0;a<e.records[0].length;a++)if(e.records[r][a]){const l=e.records[r][a].element.getAttribute("data-x"),c=e.records[r][a].element.getAttribute("data-y");if(e.records[r][a].element.getAttribute("data-merged")){const u=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([l,c]),h=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.t3)([a,r]);if(t[u]==null)if(u==h)t[u]=!1;else{const C=parseInt(a-l),d=parseInt(r-c);t[u]=[h,C,d]}}else s(l,c,a,r)}const o=Object.keys(t);if(o.length){for(let r=0;r<o.length;r++)if(t[o[r]]){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(o[r],!0);let l=a[0],c=a[1];s(l,c,l+t[o[r]][1],c+t[o[r]][2]);const u=o[r],h=t[o[r]][0];for(let C=0;C<e.options.mergeCells[u][2].length;C++)l=parseInt(e.options.mergeCells[u][2][C].getAttribute("data-x")),c=parseInt(e.options.mergeCells[u][2][C].getAttribute("data-y")),e.options.mergeCells[u][2][C].setAttribute("data-x",l+t[o[r]][1]),e.options.mergeCells[u][2][C].setAttribute("data-y",c+t[o[r]][2]);e.options.mergeCells[h]=e.options.mergeCells[u],delete e.options.mergeCells[u]}}updateFormulas.call(e,n),_meta_js__WEBPACK_IMPORTED_MODULE_3__.hs.call(e,n),_selection_js__WEBPACK_IMPORTED_MODULE_1__.G9.call(e),updateTable.call(e)},updateScroll=function(e){const n=this,t=n.content.getBoundingClientRect(),s=t.left,o=t.top,r=t.width,a=t.height,l=n.records[n.selectedCell[3]][n.selectedCell[2]].element.getBoundingClientRect(),c=l.left,u=l.top,h=l.width,C=l.height;let d,b;e==0||e==1?(d=c-s+n.content.scrollLeft,b=u-o+n.content.scrollTop-2):(d=c-s+n.content.scrollLeft+h,b=u-o+n.content.scrollTop+C),b>n.content.scrollTop+30&&b<n.content.scrollTop+a||(b<n.content.scrollTop+30?n.content.scrollTop=b-C:n.content.scrollTop=b-(a-2));const m=_freeze_js__WEBPACK_IMPORTED_MODULE_4__.w.call(n);d>n.content.scrollLeft+m&&d<n.content.scrollLeft+r||(d<n.content.scrollLeft+30?(n.content.scrollLeft=d,n.content.scrollLeft<50&&(n.content.scrollLeft=0)):d<n.content.scrollLeft+m?n.content.scrollLeft=d-m-1:n.content.scrollLeft=d-(r-20))},updateResult=function(){const e=this;let n=0,t=0;for(n=e.options.lazyLoading==1?100:e.options.pagination>0?e.options.pagination:e.results?e.results.length:e.rows.length;e.tbody.firstChild;)e.tbody.removeChild(e.tbody.firstChild);for(let s=0;s<e.rows.length;s++)!e.results||e.results.indexOf(s)>-1?(t<n&&(e.tbody.appendChild(e.rows[s].element),t++),e.rows[s].element.style.display=""):e.rows[s].element.style.display="none";return e.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_5__.IV.call(e),_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(e),_dispatch_js__WEBPACK_IMPORTED_MODULE_0__.A.call(e,"onupdateresult",e,e.results),n},getCell=function(e,n){if(typeof e=="string"){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(e,!0);e=t[0],n=t[1]}return this.records[n][e].element},getCellFromCoords=function(e,n){return this.records[n][e].element},getLabel=function(e,n){if(typeof e=="string"){const t=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_7__.vu)(e,!0);e=t[0],n=t[1]}return this.records[n][e].element.innerHTML},fullscreen=function(e){const n=this;e==null&&(e=!n.config.fullscreen),n.config.fullscreen!=e&&(n.config.fullscreen=e,e==1?n.element.classList.add("fullscreen"):n.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(e){const n=this,t=document.createElement("tr");t.classList.add("jss_nested");const s=document.createElement("td");s.classList.add("jss_selectall"),t.appendChild(s),e.element=t;let o=0;for(let r=0;r<e.length;r++){e[r].colspan||(e[r].colspan=1),e[r].title||(e[r].title=""),e[r].id||(e[r].id="");let a=e[r].colspan;const l=[];for(let u=0;u<a;u++)n.options.columns[o]&&n.options.columns[o].type=="hidden"&&a++,l.push(o),o++;const c=document.createElement("td");c.setAttribute("data-column",l.join(",")),c.setAttribute("colspan",e[r].colspan),c.setAttribute("align",e[r].align||"center"),c.setAttribute("id",e[r].id),c.textContent=e[r].title,t.appendChild(c)}return t},getWorksheetActive=function(){const e=this.parent?this.parent:this;return e.element.tabs?e.element.tabs.getActive():0},getWorksheetInstance=function(e){const n=e!==void 0?e:getWorksheetActive.call(this);return this.worksheets[n]}},654:function(e,n,t){t.d(n,{IQ:function(){return o},hs:function(){return r},iZ:function(){return a}});var s=t(805);const o=function(l,c){const u=this;return l?c?u.options.meta&&u.options.meta[l]&&u.options.meta[l][c]?u.options.meta[l][c]:null:u.options.meta&&u.options.meta[l]?u.options.meta[l]:null:u.options.meta},r=function(l){const c=this;if(c.options.meta){const u={},h=Object.keys(c.options.meta);for(let C=0;C<h.length;C++)l[h[C]]?u[l[h[C]]]=c.options.meta[h[C]]:u[h[C]]=c.options.meta[h[C]];c.options.meta=u}},a=function(l,c,u){const h=this;if(h.options.meta||(h.options.meta={}),c&&u)h.options.meta[l]||(h.options.meta[l]={}),h.options.meta[l][c]=u,s.A.call(h,"onchangemeta",h,{[l]:{[c]:u}});else{const C=Object.keys(l);for(let d=0;d<C.length;d++){h.options.meta[C[d]]||(h.options.meta[C[d]]={});const b=Object.keys(l[C[d]]);for(let m=0;m<b.length;m++)h.options.meta[C[d]][b[m]]=l[C[d]][b[m]]}s.A.call(h,"onchangemeta",h,l)}}},657:function(e,n,t){t.d(n,{AH:function(){return m},Aq:function(){return h},G9:function(){return f},Jg:function(){return j},Lo:function(){return I},R5:function(){return R},Ub:function(){return k},at:function(){return v},c6:function(){return d},eO:function(){return N},ef:function(){return E},gE:function(){return C},gG:function(){return p},kA:function(){return b},kF:function(){return w},kV:function(){return M},sp:function(){return T},tW:function(){return B}});var s=t(805),o=t(296),r=t(978),a=t(911),l=t(530),c=t(689),u=t(392);const h=function(){const _=this;if(_.highlighted&&_.highlighted.length){const A=_.highlighted[_.highlighted.length-1].element,S=A.getAttribute("data-x"),O=_.content.getBoundingClientRect(),H=O.left,L=O.top,U=A.getBoundingClientRect(),q=U.left,W=U.top,F=U.width,z=U.height,Y=q-H+_.content.scrollLeft+F-4,$=W-L+_.content.scrollTop+z-4;if(_.corner.style.top=$+"px",_.corner.style.left=Y+"px",_.options.freezeColumns){const G=o.w.call(_);S>_.options.freezeColumns-1&&q-H+F<G?_.corner.style.display="none":_.options.selectionCopy!=0&&(_.corner.style.display="")}else _.options.selectionCopy!=0&&(_.corner.style.display="")}else _.corner.style.top="-2000px",_.corner.style.left="-2000px";(0,u.nK)(_)},C=function(_){const A=this;let S;if(A.highlighted&&A.highlighted.length){S=1;for(let O=0;O<A.highlighted.length;O++){A.highlighted[O].element.classList.remove("highlight"),A.highlighted[O].element.classList.remove("highlight-left"),A.highlighted[O].element.classList.remove("highlight-right"),A.highlighted[O].element.classList.remove("highlight-top"),A.highlighted[O].element.classList.remove("highlight-bottom"),A.highlighted[O].element.classList.remove("highlight-selected");const H=parseInt(A.highlighted[O].element.getAttribute("data-x")),L=parseInt(A.highlighted[O].element.getAttribute("data-y"));let U,q;if(A.highlighted[O].element.getAttribute("data-merged")){const W=parseInt(A.highlighted[O].element.getAttribute("colspan")),F=parseInt(A.highlighted[O].element.getAttribute("rowspan"));U=W>0?H+(W-1):H,q=F>0?L+(F-1):L}else U=H,q=L;for(let W=H;W<=U;W++)A.headers[W]&&A.headers[W].classList.remove("selected");for(let W=L;W<=q;W++)A.rows[W]&&A.rows[W].element.classList.remove("selected")}}else S=0;return A.highlighted=[],A.selectedCell=null,A.corner.style.top="-2000px",A.corner.style.left="-2000px",_==1&&S==1&&s.A.call(A,"onblur",A),S},d=function(_,A,S){const O=_.getAttribute("data-x"),H=_.getAttribute("data-y");let L,U;A?(L=A.getAttribute("data-x"),U=A.getAttribute("data-y")):(L=O,U=H),m.call(this,O,H,L,U,S)},b=function(){const _=document.querySelectorAll(".jss_worksheet .copying");for(let A=0;A<_.length;A++)_[A].classList.remove("copying"),_[A].classList.remove("copying-left"),_[A].classList.remove("copying-right"),_[A].classList.remove("copying-top"),_[A].classList.remove("copying-bottom")},m=function(_,A,S,O,H){const L=this;if(A==null){if(A=0,O=L.rows.length-1,_==null)return}else _==null&&(_=0,S=L.options.data[0].length-1);S==null&&(S=_),O==null&&(O=A),_>=L.headers.length&&(_=L.headers.length-1),A>=L.rows.length&&(A=L.rows.length-1),S>=L.headers.length&&(S=L.headers.length-1),O>=L.rows.length&&(O=L.rows.length-1);let U,q,W,F,z=null,Y=null,$=null,G=null;parseInt(_)<parseInt(S)?(U=parseInt(_),q=parseInt(S)):(U=parseInt(S),q=parseInt(_)),parseInt(A)<parseInt(O)?(W=parseInt(A),F=parseInt(O)):(W=parseInt(O),F=parseInt(A));for(let D=U;D<=q;D++)for(let P=W;P<=F;P++)if(L.records[P][D]&&L.records[P][D].element.getAttribute("data-merged")){const V=parseInt(L.records[P][D].element.getAttribute("data-x")),K=parseInt(L.records[P][D].element.getAttribute("data-y")),J=parseInt(L.records[P][D].element.getAttribute("colspan")),Z=parseInt(L.records[P][D].element.getAttribute("rowspan"));J>1&&(V<U&&(U=V),V+J>q&&(q=V+J-1)),Z&&(K<W&&(W=K),K+Z>F&&(F=K+Z-1))}for(let D=W;D<=F;D++)L.rows[D].element.style.display!="none"&&($==null&&($=D),G=D);for(let D=U;D<=q;D++)for(let P=W;P<=F;P++)L.options.columns&&L.options.columns[D]&&L.options.columns[D].type=="hidden"||(z==null&&(z=D),Y=D);if(z||(z=0),Y||(Y=0),s.A.call(L,"onbeforeselection",L,z,$,Y,G,H)===!1)return!1;const X=L.resetSelection();L.selectedCell=[_,A,S,O],L.records[A][_]&&L.records[A][_].element.classList.add("highlight-selected");for(let D=U;D<=q;D++)for(let P=W;P<=F;P++)L.rows[P].element.style.display!="none"&&L.records[P][D].element.style.display!="none"&&(L.records[P][D].element.classList.add("highlight"),L.highlighted.push(L.records[P][D]));for(let D=z;D<=Y;D++)L.options.columns&&L.options.columns[D]&&L.options.columns[D].type=="hidden"||!L.cols[D].colElement.style||L.cols[D].colElement.style.display=="none"||(L.records[$]&&L.records[$][D]&&L.records[$][D].element.classList.add("highlight-top"),L.records[G]&&L.records[G][D]&&L.records[G][D].element.classList.add("highlight-bottom"),L.headers[D].classList.add("selected"));for(let D=$;D<=G;D++)L.rows[D]&&L.rows[D].element.style.display!="none"&&(L.records[D][z].element.classList.add("highlight-left"),L.records[D][Y].element.classList.add("highlight-right"),L.rows[D].element.classList.add("selected"));L.selectedContainer=[z,$,Y,G],X==0&&(s.A.call(L,"onfocus",L),b()),s.A.call(L,"onselection",L,z,$,Y,G,H),h.call(L)},j=function(_){const A=this;if(!A.selectedCell)return[];const S=[];for(let O=Math.min(A.selectedCell[0],A.selectedCell[2]);O<=Math.max(A.selectedCell[0],A.selectedCell[2]);O++)_&&A.headers[O].style.display=="none"||S.push(O);return S},f=function(){const _=this;_.selectedCell&&_.updateSelectionFromCoords(_.selectedCell[0],_.selectedCell[1],_.selectedCell[2],_.selectedCell[3])},p=function(){const _=this;for(let A=0;A<_.selection.length;A++)_.selection[A].classList.remove("selection"),_.selection[A].classList.remove("selection-left"),_.selection[A].classList.remove("selection-right"),_.selection[A].classList.remove("selection-top"),_.selection[A].classList.remove("selection-bottom");_.selection=[]},g=function(_){return(_=""+_).length==1&&(_="0"+_),_},w=function(_,A){const S=this,O=S.getData(!0,!1),H=S.selectedContainer,L=parseInt(_.getAttribute("data-x")),U=parseInt(_.getAttribute("data-y")),q=parseInt(A.getAttribute("data-x")),W=parseInt(A.getAttribute("data-y")),F=[];let z,Y,$=!1;H[0]==L?(z=U<H[1]?U-H[1]:1,Y=0):(Y=L<H[0]?L-H[0]:1,z=0);let G=0,X=0;for(let P=U;P<=W;P++)if(!S.rows[P]||S.rows[P].element.style.display!="none"){O[X]==null&&(X=0),G=0,H[0]!=L&&(Y=L<H[0]?L-H[0]:1);for(let V=L;V<=q;V++){if(S.records[P][V]&&!S.records[P][V].element.classList.contains("readonly")&&S.records[P][V].element.style.display!="none"&&$==0){if(!S.selection.length&&S.options.data[P][V]!=""){$=!0;continue}(O[X]==null||O[X][G]==null)&&(G=0);let K=O[X][G];if(K&&!O[1]&&S.parent.config.autoIncrement!=0)if(!S.options.columns||!S.options.columns[V]||S.options.columns[V].type&&S.options.columns[V].type!="text"&&S.options.columns[V].type!="number"){if(S.options.columns&&S.options.columns[V]&&S.options.columns[V].type=="calendar"){const J=new Date(K);J.setDate(J.getDate()+z),K=J.getFullYear()+"-"+g(parseInt(J.getMonth()+1))+"-"+g(J.getDate())+" 00:00:00"}}else if((""+K).substr(0,1)=="="){const J=K.match(/([A-Z]+[0-9]+)/g);if(J){const Z=[];for(let ee=0;ee<J.length;ee++){const Q=(0,c.vu)(J[ee],1);Q[0]+=Y,Q[1]+=z,Q[1]<0&&(Q[1]=0);const te=(0,c.t3)([Q[0],Q[1]]);te!=J[ee]&&(Z[J[ee]]=te)}Z&&(K=(0,l.yB)(K,Z))}}else K==Number(K)&&(K=Number(K)+z);F.push(l.k9.call(S,V,P,K)),l.xF.call(S,V,P,F)}G++,H[0]!=L&&Y++}X++,z++}a.Dh.call(S,{action:"setValue",records:F,selection:S.selectedCell}),l.am.call(S);const D=F.map(function(P){return{x:P.x,y:P.y,value:P.value,oldValue:P.oldValue}});s.A.call(S,"onafterchanges",S,D)},B=function(_){let A,S,O=0;if(!_||_.length===0)return O;for(A=0;A<_.length;A++)S=_.charCodeAt(A),O=(O<<5)-O+S,O|=0;return O},v=function(_,A,S){const O=this;if(_==1){if(O.selectedCell&&(A>=O.selectedCell[1]&&A<=O.selectedCell[3]||S>=O.selectedCell[1]&&S<=O.selectedCell[3]))return void O.resetSelection()}else if(O.selectedCell&&(A>=O.selectedCell[0]&&A<=O.selectedCell[2]||S>=O.selectedCell[0]&&S<=O.selectedCell[2]))return void O.resetSelection()},R=function(_){const A=this;if(!A.selectedCell)return[];const S=[];for(let O=Math.min(A.selectedCell[1],A.selectedCell[3]);O<=Math.max(A.selectedCell[1],A.selectedCell[3]);O++)_&&A.rows[O].element.style.display=="none"||S.push(O);return S},k=function(){const _=this;_.selectedCell||(_.selectedCell=[]),_.selectedCell[0]=0,_.selectedCell[1]=0,_.selectedCell[2]=_.headers.length-1,_.selectedCell[3]=_.records.length-1,_.updateSelectionFromCoords(_.selectedCell[0],_.selectedCell[1],_.selectedCell[2],_.selectedCell[3])},I=function(){const _=this;return _.selectedCell?[Math.min(_.selectedCell[0],_.selectedCell[2]),Math.min(_.selectedCell[1],_.selectedCell[3]),Math.max(_.selectedCell[0],_.selectedCell[2]),Math.max(_.selectedCell[1],_.selectedCell[3])]:null},E=function(_){const A=this,S=I.call(A);if(!S)return[];const O=[];for(let H=S[1];H<=S[3];H++)for(let L=S[0];L<=S[2];L++)_?O.push((0,r.getCellNameFromCoords)(L,H)):O.push(A.records[H][L]);return O},N=function(){const _=this,A=I.call(_);if(!A)return"";const S=(0,r.getCellNameFromCoords)(A[0],A[1]),O=(0,r.getCellNameFromCoords)(A[2],A[3]);return S===O?_.options.worksheetName+"!"+S:_.options.worksheetName+"!"+S+":"+O},T=function(_,A){const S=I.call(this);return _>=S[0]&&_<=S[2]&&A>=S[1]&&A<=S[3]},M=function(){const _=I.call(this);return _?[_]:[]}},689:function(e,n,t){t.d(n,{Hh:function(){return o},t3:function(){return a},vu:function(){return r}});var s=t(978);const o=function(l,c,u){if(c<=l.length)return l.slice(0,c).concat(u).concat(l.slice(c));const h=l.slice(0,l.length);for(;c>h.length;)h.push(void 0);return h.concat(u)},r=function(l,c){const u=/^[a-zA-Z]+/.exec(l);if(u){let h=0;for(let d=0;d<u[0].length;d++)h+=parseInt(u[0].charCodeAt(d)-64)*Math.pow(26,u[0].length-1-d);h--,h<0&&(h=0);let C=parseInt(/[0-9]+$/.exec(l));C>0&&C--,l=c==1?[h,C]:h+"-"+C}return l},a=function(l){return Array.isArray(l)||(l=l.split("-")),(0,s.getColumnName)(parseInt(l[0]))+(parseInt(l[1])+1)}},805:function(e,n){const t=function(r){const a=this,l=[];for(let c=0;c<r.length;c++){const u=r[c].x,h=r[c].y,C=a.options.columns[u].name?a.options.columns[u].name:u;l[h]||(l[h]={row:h,data:{}}),l[h].data[C]=r[c].value}return l.filter(function(c){return c!=null})},s=function(r,a){const l=this,c=o.call(l.parent,"onbeforesave",l.parent,l,a);if(c)a=c;else if(c===!1)return!1;jSuites.ajax({url:r,method:"POST",dataType:"json",data:{data:JSON.stringify(a)},success:function(u){o.call(l,"onsave",l.parent,l,a)}})},o=function(r){const a=this;let l=null,c=a.parent?a.parent:a;if(!c.ignoreEvents&&(typeof c.config.onevent=="function"&&(l=c.config.onevent.apply(this,arguments)),typeof c.config[r]=="function"&&(l=c.config[r].apply(this,Array.prototype.slice.call(arguments,1))),typeof c.plugins=="object")){const u=Object.keys(c.plugins);for(let h=0;h<u.length;h++){const C=u[h],d=c.plugins[C];typeof d.onevent=="function"&&(l=d.onevent.apply(this,arguments))}}if(r=="onafterchanges"){const u=arguments;if(typeof c.plugins=="object"&&Object.entries(c.plugins).forEach(function([,h]){typeof h.persistence=="function"&&h.persistence(a,"setValue",{data:u[2]})}),a.options.persistence){const h=a.options.persistence==1?a.options.url:a.options.persistence,C=t.call(a,arguments[2]);s.call(a,h,C)}}return l};n.A=o},829:function(e,n,t){t.d(n,{F8:function(){return a},N$:function(){return r},dr:function(){return l}});var s=t(530),o=t(657);const r=function(c){const u=this;if(u.options.filters){c=parseInt(c),u.resetSelection();let h=[];if(u.options.columns[c].type=="checkbox")h.push({id:"true",name:"True"}),h.push({id:"false",name:"False"});else{const b=[];let m=!1;for(let f=0;f<u.options.data.length;f++){const p=u.options.data[f][c],g=u.records[f][c].element.innerHTML;p&&g?b[p]=g:m=!0}const j=Object.keys(b);h=[];for(let f=0;f<j.length;f++)h.push({id:j[f],name:b[j[f]]});m&&h.push({value:"",id:"",name:"(Blanks)"})}const C=document.createElement("div");u.filter.children[c+1].innerHTML="",u.filter.children[c+1].appendChild(C),u.filter.children[c+1].style.paddingLeft="0px",u.filter.children[c+1].style.paddingRight="0px",u.filter.children[c+1].style.overflow="initial";const d={data:h,multiple:!0,autocomplete:!0,opened:!0,value:u.filters[c]!==void 0?u.filters[c]:null,width:"100%",position:u.options.tableOverflow==1||u.parent.config.fullscreen==1,onclose:function(b){l.call(u),u.filters[c]=b.dropdown.getValue(!0),u.filter.children[c+1].innerHTML=b.dropdown.getText(),u.filter.children[c+1].style.paddingLeft="",u.filter.children[c+1].style.paddingRight="",u.filter.children[c+1].style.overflow="",a.call(u,c),o.G9.call(u)}};jSuites.dropdown(C,d)}else console.log("Jspreadsheet: filters not enabled.")},a=function(c){const u=this;if(!c)for(let d=0;d<u.filter.children.length;d++)u.filters[d]&&(c=d);const h=function(d,b,m){for(let j=0;j<d.length;j++){const f=""+u.options.data[m][b],p=""+u.records[m][b].element.innerHTML;if(d[j]==f||d[j]==p)return!0}return!1},C=u.filters[c];u.results=[];for(let d=0;d<u.options.data.length;d++)h(C,c,d)&&u.results.push(d);u.results.length||(u.results=null),s.hG.call(u)},l=function(){const c=this;if(c.options.filters)for(let u=0;u<c.filter.children.length;u++)c.filter.children[u].innerHTML="&nbsp;",c.filters[u]=null;c.results=null,s.hG.call(c)}},910:function(e,n,t){t.d(n,{D0:function(){return u},FU:function(){return C},Lt:function(){return c},VP:function(){return b},Zp:function(){return d},fd:function(){return h}});var s=t(689),o=t(530),r=t(911),a=t(805),l=t(657);const c=function(m,j){const f=this,p=[];if(f.options.mergeCells){const g=Object.keys(f.options.mergeCells);for(let w=0;w<g.length;w++){const B=(0,s.vu)(g[w],!0),v=f.options.mergeCells[g[w]][0],R=B[0],k=B[0]+(v>1?v-1:0);j==null?R<=m&&k>=m&&p.push(g[w]):j?R<m&&k>=m&&p.push(g[w]):R<=m&&k>m&&p.push(g[w])}}return p},u=function(m,j){const f=this,p=[];if(f.options.mergeCells){const g=Object.keys(f.options.mergeCells);for(let w=0;w<g.length;w++){const B=(0,s.vu)(g[w],!0),v=f.options.mergeCells[g[w]][1],R=B[1],k=B[1]+(v>1?v-1:0);j==null?R<=m&&k>=m&&p.push(g[w]):j?R<m&&k>=m&&p.push(g[w]):R<=m&&k>m&&p.push(g[w])}}return p},h=function(m){const j=this;let f={};if(m)f=j.options.mergeCells&&j.options.mergeCells[m]?[j.options.mergeCells[m][0],j.options.mergeCells[m][1]]:null;else if(j.options.mergeCells){j.options.mergeCells;const p=Object.keys(j.options.mergeCells);for(let g=0;g<p.length;g++)f[p[g]]=[j.options.mergeCells[p[g]][0],j.options.mergeCells[p[g]][1]]}return f},C=function(m,j,f,p){const g=this;let w=!1;if(m){if(typeof m!="string")return null}else{if(!g.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const v=parseInt(g.highlighted[0].getAttribute("data-x")),R=parseInt(g.highlighted[0].getAttribute("data-y")),k=parseInt(g.highlighted[g.highlighted.length-1].getAttribute("data-x")),I=parseInt(g.highlighted[g.highlighted.length-1].getAttribute("data-y"));m=(0,s.t3)([v,R]),j=k-v+1,f=I-R+1}}const B=(0,s.vu)(m,!0);if(g.options.mergeCells&&g.options.mergeCells[m])g.records[B[1]][B[0]].element.getAttribute("data-merged")&&(w="Cell already merged");else if((!j||j<2)&&(!f||f<2))w="Invalid merged properties";else for(let v=B[1];v<B[1]+f;v++)for(let R=B[0];R<B[0]+j;R++)(0,s.t3)([R,v]),g.records[v][R].element.getAttribute("data-merged")&&(w="There is a conflict with another merged cell");if(w)alert(jSuites.translate(w));else{j>1?g.records[B[1]][B[0]].element.setAttribute("colspan",j):j=1,f>1?g.records[B[1]][B[0]].element.setAttribute("rowspan",f):f=1,g.options.mergeCells||(g.options.mergeCells={}),g.options.mergeCells[m]=[j,f,[]],g.records[B[1]][B[0]].element.setAttribute("data-merged","true"),g.records[B[1]][B[0]].element.style.overflow="hidden";const v=[];for(let R=B[1];R<B[1]+f;R++)for(let k=B[0];k<B[0]+j;k++)B[0]==k&&B[1]==R||(v.push(g.options.data[R][k]),o.k9.call(g,k,R,"",!0),g.options.mergeCells[m][2].push(g.records[R][k].element),g.records[R][k].element.style.display="none",g.records[R][k].element=g.records[B[1]][B[0]].element);l.c6.call(g,g.records[B[1]][B[0]].element),p||(r.Dh.call(g,{action:"setMerge",column:m,colspan:j,rowspan:f,data:v}),a.A.call(g,"onmerge",g,{[m]:[j,f]}))}},d=function(m,j,f){const p=this;if(p.options.mergeCells&&p.options.mergeCells[m]){const g={[m]:p.options.mergeCells[m]},w=(0,s.vu)(m,!0);p.records[w[1]][w[0]].element.removeAttribute("colspan"),p.records[w[1]][w[0]].element.removeAttribute("rowspan"),p.records[w[1]][w[0]].element.removeAttribute("data-merged");const B=p.options.mergeCells[m];let v,R,k=0;for(v=0;v<B[1];v++)for(R=0;R<B[0];R++)(v>0||R>0)&&(p.records[w[1]+v][w[0]+R].element=B[2][k],p.records[w[1]+v][w[0]+R].element.style.display="",j&&j[k]&&o.k9.call(p,w[0]+R,w[1]+v,j[k]),k++);l.c6.call(p,p.records[w[1]][w[0]].element,p.records[w[1]+v-1][w[0]+R-1].element),f||delete p.options.mergeCells[m],a.A.call(p,"onunmerge",p,m,g)}},b=function(m){const j=this;if(j.options.mergeCells){j.options.mergeCells;const f=Object.keys(j.options.mergeCells);for(let p=0;p<f.length;p++)d.call(j,f[p],null,m)}}},911:function(e,n,t){t.d(n,{Dh:function(){return u},ZS:function(){return b},tN:function(){return d}});var s=t(805),o=t(689),r=t(530),a=t(910),l=t(94),c=t(657);const u=function(m){const j=this;if(j.ignoreHistory!=1){const f=++j.historyIndex;j.history=j.history=j.history.slice(0,f+1),j.history[f]=m}},h=function(m,j){const f=this,p=j.insertBefore?+j.rowNumber:j.rowNumber+1;if(f.options.search==1&&f.results&&f.results.length!=f.rows.length&&f.resetSearch(),m==1){const g=j.numOfRows;for(let w=p;w<g+p;w++)f.rows[w].element.parentNode.removeChild(f.rows[w].element);f.records.splice(p,g),f.options.data.splice(p,g),f.rows.splice(p,g),c.at.call(f,1,p,g+p-1)}else{const g=j.rowRecords.map(v=>[...v]);f.records=(0,o.Hh)(f.records,p,g);const w=j.rowData.map(v=>[...v]);f.options.data=(0,o.Hh)(f.options.data,p,w),f.rows=(0,o.Hh)(f.rows,p,j.rowNode);let B=0;for(let v=p;v<j.numOfRows+p;v++)f.tbody.insertBefore(j.rowNode[B].element,f.tbody.children[v]),B++}for(let g=p;g<f.rows.length;g++)f.rows[g].y=g;for(let g=p;g<f.records.length;g++)for(let w=0;w<f.records[g].length;w++)f.records[g][w].y=g;f.options.pagination>0&&f.page(f.pageNumber),r.o8.call(f)},C=function(m,j){const f=this,p=j.insertBefore?j.columnNumber:j.columnNumber+1;if(m==1){const g=j.numOfColumns;f.options.columns.splice(p,g);for(let w=p;w<g+p;w++)f.headers[w].parentNode.removeChild(f.headers[w]),f.cols[w].colElement.parentNode.removeChild(f.cols[w].colElement);f.headers.splice(p,g),f.cols.splice(p,g);for(let w=0;w<j.data.length;w++){for(let B=p;B<g+p;B++)f.records[w][B].element.parentNode.removeChild(f.records[w][B].element);f.records[w].splice(p,g),f.options.data[w].splice(p,g)}if(f.options.footers)for(let w=0;w<f.options.footers.length;w++)f.options.footers[w].splice(p,g)}else{f.options.columns=(0,o.Hh)(f.options.columns,p,j.columns),f.headers=(0,o.Hh)(f.headers,p,j.headers),f.cols=(0,o.Hh)(f.cols,p,j.cols);let g=0;for(let w=p;w<j.numOfColumns+p;w++)f.headerContainer.insertBefore(j.headers[g],f.headerContainer.children[w+1]),f.colgroupContainer.insertBefore(j.cols[g].colElement,f.colgroupContainer.children[w+1]),g++;for(let w=0;w<j.data.length;w++){f.options.data[w]=(0,o.Hh)(f.options.data[w],p,j.data[w]),f.records[w]=(0,o.Hh)(f.records[w],p,j.records[w]);let B=0;for(let v=p;v<j.numOfColumns+p;v++)f.rows[w].element.insertBefore(j.records[w][B].element,f.rows[w].element.children[v+1]),B++}if(f.options.footers)for(let w=0;w<f.options.footers.length;w++)f.options.footers[w]=(0,o.Hh)(f.options.footers[w],p,j.footers[w])}for(let g=p;g<f.cols.length;g++)f.cols[g].x=g;for(let g=0;g<f.records.length;g++)for(let w=p;w<f.records[g].length;w++)f.records[g][w].x=w;if(f.options.nestedHeaders&&f.options.nestedHeaders.length>0&&f.options.nestedHeaders[0]&&f.options.nestedHeaders[0][0])for(let g=0;g<f.options.nestedHeaders.length;g++){let w;w=m==1?parseInt(f.options.nestedHeaders[g][f.options.nestedHeaders[g].length-1].colspan)-j.numOfColumns:parseInt(f.options.nestedHeaders[g][f.options.nestedHeaders[g].length-1].colspan)+j.numOfColumns,f.options.nestedHeaders[g][f.options.nestedHeaders[g].length-1].colspan=w,f.thead.children[g].children[f.thead.children[g].children.length-1].setAttribute("colspan",w)}r.o8.call(f)},d=function(){const m=this,j=!!m.parent.ignoreEvents,f=!!m.ignoreHistory;m.parent.ignoreEvents=!0,m.ignoreHistory=!0;const p=[];let g;if(m.historyIndex>=0){if(g=m.history[m.historyIndex--],g.action=="insertRow")h.call(m,1,g);else if(g.action=="deleteRow")h.call(m,0,g);else if(g.action=="insertColumn")C.call(m,1,g);else if(g.action=="deleteColumn")C.call(m,0,g);else if(g.action=="moveRow")m.moveRow(g.newValue,g.oldValue);else if(g.action=="moveColumn")m.moveColumn(g.newValue,g.oldValue);else if(g.action=="setMerge")m.removeMerge(g.column,g.data);else if(g.action=="setStyle")m.setStyle(g.oldValue,null,null,1);else if(g.action=="setWidth")m.setWidth(g.column,g.oldValue);else if(g.action=="setHeight")m.setHeight(g.row,g.oldValue);else if(g.action=="setHeader")m.setHeader(g.column,g.oldValue);else if(g.action=="setComments")m.setComments(g.oldValue);else if(g.action=="orderBy"){let w=[];for(let B=0;B<g.rows.length;B++)w[g.rows[B]]=B;l.Th.call(m,g.column,g.order?0:1),l.iY.call(m,w)}else if(g.action=="setValue"){for(let w=0;w<g.records.length;w++)p.push({x:g.records[w].x,y:g.records[w].y,value:g.records[w].oldValue}),g.oldStyle&&m.resetStyle(g.oldStyle);m.setValue(p),g.selection&&m.updateSelectionFromCoords(g.selection[0],g.selection[1],g.selection[2],g.selection[3])}}m.parent.ignoreEvents=j,m.ignoreHistory=f,s.A.call(m,"onundo",m,g)},b=function(){const m=this,j=!!m.parent.ignoreEvents,f=!!m.ignoreHistory;let p;if(m.parent.ignoreEvents=!0,m.ignoreHistory=!0,m.historyIndex<m.history.length-1){if(p=m.history[++m.historyIndex],p.action=="insertRow")h.call(m,0,p);else if(p.action=="deleteRow")h.call(m,1,p);else if(p.action=="insertColumn")C.call(m,0,p);else if(p.action=="deleteColumn")C.call(m,1,p);else if(p.action=="moveRow")m.moveRow(p.oldValue,p.newValue);else if(p.action=="moveColumn")m.moveColumn(p.oldValue,p.newValue);else if(p.action=="setMerge")a.FU.call(m,p.column,p.colspan,p.rowspan,1);else if(p.action=="setStyle")m.setStyle(p.newValue,null,null,1);else if(p.action=="setWidth")m.setWidth(p.column,p.newValue);else if(p.action=="setHeight")m.setHeight(p.row,p.newValue);else if(p.action=="setHeader")m.setHeader(p.column,p.newValue);else if(p.action=="setComments")m.setComments(p.newValue);else if(p.action=="orderBy")l.Th.call(m,p.column,p.order),l.iY.call(m,p.rows);else if(p.action=="setValue"){m.setValue(p.records);for(let g=0;g<p.records.length;g++)p.oldStyle&&m.resetStyle(p.newStyle);p.selection&&m.updateSelectionFromCoords(p.selection[0],p.selection[1],p.selection[2],p.selection[3])}}m.parent.ignoreEvents=j,m.ignoreHistory=f,s.A.call(m,"onredo",m,p)}},978:function(e,n,t){t.r(n),t.d(n,{createFromTable:function(){return C},getCaretIndex:function(){return o},getCellNameFromCoords:function(){return l},getColumnName:function(){return a},getCoordsFromCellName:function(){return c},getCoordsFromRange:function(){return u},invert:function(){return r},parseCSV:function(){return h}});var s=t(689);const o=function(d){let b;b=this.config.root?this.config.root:window;let m=0;const j=b.getSelection();if(j&&j.rangeCount!==0){const f=j.getRangeAt(0),p=f.cloneRange();p.selectNodeContents(d),p.setEnd(f.endContainer,f.endOffset),m=p.toString().length}return m},r=function(d){const b=[],m=Object.keys(d);for(let j=0;j<m.length;j++)b[d[m[j]]]=m[j];return b},a=function(d){let b,m=d+1,j="";for(;m>0;)b=(m-1)%26,j=String.fromCharCode(65+b).toString()+j,m=parseInt((m-b)/26);return j},l=function(d,b){return a(parseInt(d))+(parseInt(b)+1)},c=function(d){const b=/^[a-zA-Z]+/.exec(d);if(b){let m=0;for(let f=0;f<b[0].length;f++)m+=parseInt(b[0].charCodeAt(f)-64)*Math.pow(26,b[0].length-1-f);m--,m<0&&(m=0);let j=parseInt(/[0-9]+$/.exec(d))||null;return j>0&&j--,[m,j]}},u=function(d){const[b,m]=d.split(":");return[...c(b),...c(m)]},h=function(d,b){b=b||",",d=d.replace(/\r?\n$|\r$|\n$/g,"");const m=[];let j=!1,f=0,p=0,g=0;for(let w=0;w<d.length;w++){const B=d[w],v=d[w+1];m[p]=m[p]||[],m[p][g]=m[p][g]||"",B=='"'&&j&&v=='"'?(m[p][g]+=B,++w):B!='"'?B!=b||j?B!="\r"||v!=`
`||j?B==`
`&&!j||B=="\r"&&!j?(++p,f=Math.max(f,g),g=0):m[p][g]+=B:(++p,f=Math.max(f,g),g=0,++w):++g:j=!j}return m.forEach((w,B)=>{for(let v=w.length;v<=f;v++)w.push("")}),m},C=function(d,b){if(d.tagName=="TABLE"){b||(b={}),b.columns=[],b.data=[];const m=d.querySelectorAll("colgroup > col");if(m.length)for(let I=0;I<m.length;I++){let E=m[I].style.width;E||(E=m[I].getAttribute("width")),E&&(b.columns[I]||(b.columns[I]={}),b.columns[I].width=E)}const j=function(I,E){let N=I.getBoundingClientRect();const T=N.width>50?N.width:50;b.columns[E]||(b.columns[E]={}),I.getAttribute("data-celltype")?b.columns[E].type=I.getAttribute("data-celltype"):b.columns[E].type="text",b.columns[E].width=T+"px",b.columns[E].title=I.innerHTML,I.style.textAlign&&(b.columns[E].align=I.style.textAlign),(N=I.getAttribute("name"))&&(b.columns[E].name=N),(N=I.getAttribute("id"))&&(b.columns[E].id=N),(N=I.getAttribute("data-mask"))&&(b.columns[E].mask=N)},f=[];let p=d.querySelectorAll(":scope > thead > tr");if(p.length){for(let I=0;I<p.length-1;I++){const E=[];for(let N=0;N<p[I].children.length;N++){const T={title:p[I].children[N].textContent,colspan:p[I].children[N].getAttribute("colspan")||1};E.push(T)}f.push(E)}p=p[p.length-1].children;for(let I=0;I<p.length;I++)j(p[I],I)}let g=0;const w={},B={},v={},R={};let k=d.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let I=0;I<k.length;I++)if(b.data[g]=[],b.parseTableFirstRowAsHeader!=1||p.length||I!=0){for(let E=0;E<k[I].children.length;E++){let N=k[I].children[E].getAttribute("data-formula");N?N.substr(0,1)!="="&&(N="="+N):N=k[I].children[E].innerHTML,b.data[g].push(N);const T=(0,s.t3)([E,I]),M=k[I].children[E].getAttribute("class");M&&(R[T]=M);const _=parseInt(k[I].children[E].getAttribute("colspan"))||0,A=parseInt(k[I].children[E].getAttribute("rowspan"))||0;(_||A)&&(w[T]=[_||1,A||1]),k[I].children[E].style&&k[I].children[E].style.display=="none"&&(k[I].children[E].style.display="");const S=k[I].children[E].getAttribute("style");S&&(v[T]=S),k[I].children[E].classList.contains("styleBold")&&(v[T]?v[T]+="; font-weight:bold;":v[T]="font-weight:bold;")}k[I].style&&k[I].style.height&&(B[I]={height:k[I].style.height}),g++}else for(let E=0;E<k[I].children.length;E++)j(k[I].children[E],E);if(Object.keys(f).length>0&&(b.nestedHeaders=f),Object.keys(v).length>0&&(b.style=v),Object.keys(w).length>0&&(b.mergeCells=w),Object.keys(B).length>0&&(b.rows=B),Object.keys(R).length>0&&(b.classes=R),k=d.querySelectorAll("tfoot tr"),k.length){const I=[];for(let E=0;E<k.length;E++){let N=[];for(let T=0;T<k[E].children.length;T++)N.push(k[E].children[T].textContent);I.push(N)}Object.keys(I).length>0&&(b.footers=I)}if(b.parseTableAutoCellType==1){const I=[];for(let E=0;E<b.columns.length;E++){let N=!0,T=!0;I[E]=[];for(let _=0;_<b.data.length;_++){const A=b.data[_][E];I[E][A]||(I[E][A]=0),I[E][A]++,A.length>25&&(N=!1),A.length==10&&A.substr(4,1)=="-"&&A.substr(7,1)=="-"||(T=!1)}const M=Object.keys(I[E]).length;T?b.columns[E].type="calendar":N==1&&M>1&&M<=parseInt(.1*b.data.length)&&(b.columns[E].type="dropdown",b.columns[E].source=Object.keys(I[E]))}}return b}console.log("Element is not a table")}}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(n!==void 0)return n.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=function(e,n){for(var t in n)__webpack_require__.o(n,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},__webpack_require__.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},__webpack_require__.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:function(){return src}});const lib={jspreadsheet:{}};var libraryBase=lib,dispatch=__webpack_require__(805),internal=__webpack_require__(530),utils_history=__webpack_require__(911),helpers=__webpack_require__(978);const openEditor=function(e,n,t){const s=this,o=e.getAttribute("data-y"),r=e.getAttribute("data-x");dispatch.A.call(s,"oneditionstart",s,e,parseInt(r),parseInt(o)),r>0&&(s.records[o][r-1].element.style.overflow="hidden");const a=function(l){const c=e.getBoundingClientRect(),u=document.createElement(l);return u.style.width=c.width+"px",u.style.height=c.height-2+"px",u.style.minHeight=c.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(u),u};if(e.classList.contains("readonly")!=1){if(s.edition=[s.records[o][r].element,s.records[o][r].element.innerHTML,r,o],s.options.columns&&s.options.columns[r]&&typeof s.options.columns[r].type=="object")s.options.columns[r].type.openEditor(e,s.options.data[o][r],parseInt(r),parseInt(o),s,s.options.columns[r],t),dispatch.A.call(s,"oncreateeditor",s,e,parseInt(r),parseInt(o),null,s.options.columns[r]);else if(!(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="hidden"))if(s.options.columns&&s.options.columns[r]&&(s.options.columns[r].type=="checkbox"||s.options.columns[r].type=="radio")){const l=!e.children[0].checked;s.setValue(e,l),s.edition=null}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="dropdown"){let l,c=s.options.data[o][r];s.options.columns[r].multiple&&!Array.isArray(c)&&(c=c.split(";")),l=typeof s.options.columns[r].filter=="function"?s.options.columns[r].filter(s.element,e,r,o,s.options.columns[r].source):s.options.columns[r].source;const u=[];if(l)for(let d=0;d<l.length;d++)u.push(l[d]);const h=a("div");dispatch.A.call(s,"oncreateeditor",s,e,parseInt(r),parseInt(o),null,s.options.columns[r]);const C={data:u,multiple:!!s.options.columns[r].multiple,autocomplete:!!s.options.columns[r].autocomplete,opened:!0,value:c,width:"100%",height:h.style.minHeight,position:s.options.tableOverflow==1||s.parent.config.fullscreen==1,onclose:function(){closeEditor.call(s,e,!0)}};s.options.columns[r].options&&s.options.columns[r].options.type&&(C.type=s.options.columns[r].options.type),jSuites.dropdown(h,C)}else if(s.options.columns&&s.options.columns[r]&&(s.options.columns[r].type=="calendar"||s.options.columns[r].type=="color")){const l=s.options.data[o][r],c=a("input");dispatch.A.call(s,"oncreateeditor",s,e,parseInt(r),parseInt(o),null,s.options.columns[r]),c.value=l;const u=s.options.columns[r].options?{...s.options.columns[r].options}:{};if(s.options.tableOverflow!=1&&s.parent.config.fullscreen!=1||(u.position=!0),u.value=s.options.data[o][r],u.opened=!0,u.onclose=function(h,C){closeEditor.call(s,e,!0)},s.options.columns[r].type=="color"){jSuites.color(c,u);const h=e.getBoundingClientRect();u.position&&(c.nextSibling.children[1].style.top=h.top+h.height+"px",c.nextSibling.children[1].style.left=h.left+"px")}else u.format||(u.format="YYYY-MM-DD"),jSuites.calendar(c,u);c.focus()}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="html"){const l=s.options.data[o][r],c=a("div");dispatch.A.call(s,"oncreateeditor",s,e,parseInt(r),parseInt(o),null,s.options.columns[r]),c.style.position="relative";const u=document.createElement("div");u.classList.add("jss_richtext"),c.appendChild(u),jSuites.editor(u,{focus:!0,value:l});const h=e.getBoundingClientRect(),C=u.getBoundingClientRect();window.innerHeight<h.bottom+C.height?u.style.top=h.bottom-(C.height+2)+"px":u.style.top=h.top+"px",window.innerWidth<h.left+C.width?u.style.left=h.right-(C.width+2)+"px":u.style.left=h.left+"px"}else if(s.options.columns&&s.options.columns[r]&&s.options.columns[r].type=="image"){const l=e.children[0],c=a("div");dispatch.A.call(s,"oncreateeditor",s,e,parseInt(r),parseInt(o),null,s.options.columns[r]),c.style.position="relative";const u=document.createElement("div");u.classList.add("jclose"),l&&l.src&&u.appendChild(l),c.appendChild(u),jSuites.image(u,s.options.columns[r]);const h=e.getBoundingClientRect(),C=u.getBoundingClientRect();window.innerHeight<h.bottom+C.height?u.style.top=h.top-(C.height+2)+"px":u.style.top=h.top+"px",u.style.left=h.left+"px"}else{const l=n==1?"":s.options.data[o][r];let c;c=s.options.columns&&s.options.columns[r]&&s.options.columns[r].wordWrap==0||!(s.options.wordWrap==1||s.options.columns&&s.options.columns[r]&&s.options.columns[r].wordWrap==1)?a("input"):a("textarea"),setTimeout(()=>{const h=e.querySelector("input, textarea");if(h){const C=s.element;C._cellRefHandler&&(C.removeEventListener("mousedown",C._cellRefHandler,!0),C.removeEventListener("mousemove",C._cellRefHandlerMouseMove,!0),C.removeEventListener("mouseup",C._cellRefHandlerMouseUp,!0),C._cellRefHandler=null,C._cellRefHandlerMouseMove=null,C._cellRefHandlerMouseUp=null);let d=null,b=null,m=null,j=null;C._cellRefHandler=function(f){const p=f.target.closest("[data-x][data-y]");p&&e.classList.contains("editor")&&(f.stopImmediatePropagation(),f.preventDefault(),d=(0,helpers.getCellNameFromCoords)(p.getAttribute("data-x"),p.getAttribute("data-y")),p.getAttribute("data-x"),p.getAttribute("data-y"),b=h.value,m=h.selectionStart,j=h.selectionEnd,h.value=b.slice(0,m)+d+b.slice(j),h.selectionStart=h.selectionEnd=m+d.length,h.focus(),h.tagName==="TEXTAREA"?h.scrollTop=h.scrollHeight:h.scrollLeft=h.scrollWidth)},C._cellRefHandlerMouseMove=function(f){if(d&&e.classList.contains("editor")&&f.buttons===1){const p=f.target.closest("[data-x][data-y]");if(p){const g=(0,helpers.getCellNameFromCoords)(p.getAttribute("data-x"),p.getAttribute("data-y"));let w=d;g!==d&&(w=d+":"+g),h.value=b.slice(0,m)+w+b.slice(j),h.selectionStart=h.selectionEnd=m+w.length,h.focus(),h.tagName==="TEXTAREA"?h.scrollTop=h.scrollHeight:h.scrollLeft=h.scrollWidth}}},C._cellRefHandlerMouseUp=function(f){if(d&&e.classList.contains("editor")){const p=f.target.closest("[data-x][data-y]");let g=d;p&&(g=(0,helpers.getCellNameFromCoords)(p.getAttribute("data-x"),p.getAttribute("data-y")));let w=d;g!==d&&(w=d+":"+g),h.value=b.slice(0,m)+w+b.slice(j),h.selectionStart=h.selectionEnd=m+w.length,h.focus(),h.tagName==="TEXTAREA"?h.scrollTop=h.scrollHeight:h.scrollLeft=h.scrollWidth,d=null,b=null,m=null,j=null}},C.addEventListener("mousedown",C._cellRefHandler,!0),C.addEventListener("mousemove",C._cellRefHandlerMouseMove,!0),C.addEventListener("mouseup",C._cellRefHandlerMouseUp,!0)}},0),dispatch.A.call(s,"oncreateeditor",s,e,parseInt(r),parseInt(o),null,s.options.columns[r]),c.focus(),c.addEventListener("keydown",function(h){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(h.key)){h.preventDefault(),closeEditor.call(s,e,!0);let C=parseInt(r),d=parseInt(o);if(h.key==="ArrowUp"&&d--,h.key==="ArrowDown"&&d++,h.key==="ArrowLeft"&&C--,h.key==="ArrowRight"&&C++,s.records[d]&&s.records[d][C]){const b=s.records[d][C].element;b&&!b.classList.contains("readonly")&&openEditor.call(s,b,!1)}}}),c.value=l;const u=s.options.columns&&s.options.columns[r];if(!(0,internal.dw)(l)&&u){const h=(0,internal.rS)(u);if(h){if(!u.disabledMaskOnEdition)if(u.mask){const C=u.mask.split(";");c.setAttribute("data-mask",C[0])}else u.locale&&c.setAttribute("data-locale",u.locale);h.input=c,c.mask=h,jSuites.mask.render(l,h,!1)}}c.onblur=function(){closeEditor.call(s,e,!0)},c.scrollLeft=c.scrollWidth}}},closeEditor=function(e,n){const t=this,s=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));let r;if(n==1){if(t.options.columns&&t.options.columns[s]&&typeof t.options.columns[s].type=="object")r=t.options.columns[s].type.closeEditor(e,n,parseInt(s),parseInt(o),t,t.options.columns[s]);else if(!(t.options.columns&&t.options.columns[s]&&(t.options.columns[s].type=="checkbox"||t.options.columns[s].type=="radio"||t.options.columns[s].type=="hidden")))if(t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="dropdown")r=e.children[0].dropdown.close(!0);else if(t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="calendar")r=e.children[0].calendar.close(!0);else if(t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="color")r=e.children[0].color.close(!0);else if(t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="html")r=e.children[0].children[0].editor.getData();else if(t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="image"){const a=e.children[0].children[0].children[0];r=a&&a.tagName=="IMG"?a.src:""}else if(t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="numeric")r=e.children[0].value,(""+r).substr(0,1)!="="&&r==""&&(r=t.options.columns[s].allowEmpty?"":0),e.children[0].onblur=null;else{r=e.children[0].value,e.children[0].onblur=null;const a=t.options.columns&&t.options.columns[s];if(a){const l=(0,internal.rS)(a);if(l&&r!==""&&!(0,internal.dw)(r)&&typeof r!="number"){const c=jSuites.mask.extract(r,l,!0);c&&c.value!==""&&(r=c.value)}}}t.options.data[o][s]==r?e.innerHTML=t.edition[1]:t.setValue(e,r)}else t.options.columns&&t.options.columns[s]&&typeof t.options.columns[s].type=="object"?t.options.columns[s].type.closeEditor(e,n,parseInt(s),parseInt(o),t,t.options.columns[s]):t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="dropdown"?e.children[0].dropdown.close(!0):t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="calendar"?e.children[0].calendar.close(!0):t.options.columns&&t.options.columns[s]&&t.options.columns[s].type=="color"?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=t.edition&&t.edition[1]?t.edition[1]:"";dispatch.A.call(t,"oneditionend",t,e,s,o,r,n),e.classList.remove("editor"),t.edition=null},setCheckRadioValue=function(){const e=this,n=[],t=Object.keys(e.highlighted);for(let s=0;s<t.length;s++){const o=e.highlighted[s].element.getAttribute("data-x"),r=e.highlighted[s].element.getAttribute("data-y");e.options.columns[o].type!="checkbox"&&e.options.columns[o].type!="radio"||n.push(internal.k9.call(e,o,r,!e.options.data[r][o]))}if(n.length){utils_history.Dh.call(e,{action:"setValue",records:n,selection:e.selectedCell});const s=n.map(function(o){return{x:o.x,y:o.y,value:o.value,oldValue:o.oldValue}});dispatch.A.call(e,"onafterchanges",e,s)}};var lazyLoading=__webpack_require__(497);const upGet=function(e,n){const t=this;e=parseInt(e);for(let s=(n=parseInt(n))-1;s>=0;s--)if(t.records[s][e].element.style.display!="none"&&t.rows[s].element.style.display!="none"){if(t.records[s][e].element.getAttribute("data-merged")&&t.records[s][e].element==t.records[n][e].element)continue;n=s;break}return n},upVisible=function(e,n){const t=this;let s,o;if(e==0?(s=parseInt(t.selectedCell[0]),o=parseInt(t.selectedCell[1])):(s=parseInt(t.selectedCell[2]),o=parseInt(t.selectedCell[3])),n==0){for(let r=0;r<o;r++)if(t.records[r][s].element.style.display!="none"&&t.rows[r].element.style.display!="none"){o=r;break}}else o=upGet.call(t,s,o);e==0?(t.selectedCell[0]=s,t.selectedCell[1]=o):(t.selectedCell[2]=s,t.selectedCell[3]=o)},up=function(e,n){const t=this;if(e?t.selectedCell[3]>0&&upVisible.call(t,1,n?0:1):(t.selectedCell[1]>0&&upVisible.call(t,0,n?0:1),t.selectedCell[2]=t.selectedCell[0],t.selectedCell[3]=t.selectedCell[1]),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]),t.options.lazyLoading==1)if(t.selectedCell[1]==0||t.selectedCell[3]==0)lazyLoading.wu.call(t,0),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]);else if(lazyLoading.AG.call(t))t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]);else{const s=parseInt(t.tbody.firstChild.getAttribute("data-y"));t.selectedCell[1]-s<30&&(lazyLoading.G_.call(t),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]))}else if(t.options.pagination>0){const s=t.whichPage(t.selectedCell[3]);s!=t.pageNumber&&t.page(s)}internal.Rs.call(t,1)},rightGet=function(e,n){const t=this;e=parseInt(e),n=parseInt(n);for(let s=e+1;s<t.headers.length;s++)if(t.records[n][s].element.style.display!="none"){if(t.records[n][s].element.getAttribute("data-merged")&&t.records[n][s].element==t.records[n][e].element)continue;e=s;break}return e},rightVisible=function(e,n){const t=this;let s,o;if(e==0?(s=parseInt(t.selectedCell[0]),o=parseInt(t.selectedCell[1])):(s=parseInt(t.selectedCell[2]),o=parseInt(t.selectedCell[3])),n==0){for(let r=t.headers.length-1;r>s;r--)if(t.records[o][r].element.style.display!="none"){s=r;break}}else s=rightGet.call(t,s,o);e==0?(t.selectedCell[0]=s,t.selectedCell[1]=o):(t.selectedCell[2]=s,t.selectedCell[3]=o)},right=function(e,n){const t=this;e?t.selectedCell[2]<t.headers.length-1&&rightVisible.call(t,1,n?0:1):(t.selectedCell[0]<t.headers.length-1&&rightVisible.call(t,0,n?0:1),t.selectedCell[2]=t.selectedCell[0],t.selectedCell[3]=t.selectedCell[1]),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]),internal.Rs.call(t,2)},downGet=function(e,n){const t=this;e=parseInt(e);for(let s=(n=parseInt(n))+1;s<t.rows.length;s++)if(t.records[s][e].element.style.display!="none"&&t.rows[s].element.style.display!="none"){if(t.records[s][e].element.getAttribute("data-merged")&&t.records[s][e].element==t.records[n][e].element)continue;n=s;break}return n},downVisible=function(e,n){const t=this;let s,o;if(e==0?(s=parseInt(t.selectedCell[0]),o=parseInt(t.selectedCell[1])):(s=parseInt(t.selectedCell[2]),o=parseInt(t.selectedCell[3])),n==0){for(let r=t.rows.length-1;r>o;r--)if(t.records[r][s].element.style.display!="none"&&t.rows[r].element.style.display!="none"){o=r;break}}else o=downGet.call(t,s,o);e==0?(t.selectedCell[0]=s,t.selectedCell[1]=o):(t.selectedCell[2]=s,t.selectedCell[3]=o)},down=function(e,n){const t=this;if(e?t.selectedCell[3]<t.records.length-1&&downVisible.call(t,1,n?0:1):(t.selectedCell[1]<t.records.length-1&&downVisible.call(t,0,n?0:1),t.selectedCell[2]=t.selectedCell[0],t.selectedCell[3]=t.selectedCell[1]),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]),t.options.lazyLoading==1)t.selectedCell[1]==t.records.length-1||t.selectedCell[3]==t.records.length-1?(lazyLoading.wu.call(t,-1),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3])):lazyLoading.AG.call(t)?t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]):parseInt(t.tbody.lastChild.getAttribute("data-y"))-t.selectedCell[3]<30&&(lazyLoading.p6.call(t),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]));else if(t.options.pagination>0){const s=t.whichPage(t.selectedCell[3]);s!=t.pageNumber&&t.page(s)}internal.Rs.call(t,3)},leftGet=function(e,n){const t=this;e=parseInt(e),n=parseInt(n);for(let s=e-1;s>=0;s--)if(t.records[n][s].element.style.display!="none"){if(t.records[n][s].element.getAttribute("data-merged")&&t.records[n][s].element==t.records[n][e].element)continue;e=s;break}return e},leftVisible=function(e,n){const t=this;let s,o;if(e==0?(s=parseInt(t.selectedCell[0]),o=parseInt(t.selectedCell[1])):(s=parseInt(t.selectedCell[2]),o=parseInt(t.selectedCell[3])),n==0){for(let r=0;r<s;r++)if(t.records[o][r].element.style.display!="none"){s=r;break}}else s=leftGet.call(t,s,o);e==0?(t.selectedCell[0]=s,t.selectedCell[1]=o):(t.selectedCell[2]=s,t.selectedCell[3]=o)},left=function(e,n){const t=this;e?t.selectedCell[2]>0&&leftVisible.call(t,1,n?0:1):(t.selectedCell[0]>0&&leftVisible.call(t,0,n?0:1),t.selectedCell[2]=t.selectedCell[0],t.selectedCell[3]=t.selectedCell[1]),t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]),internal.Rs.call(t,0)},first=function(e,n){const t=this;if(e?n?t.selectedCell[3]=0:leftVisible.call(t,1,0):(n?t.selectedCell[1]=0:leftVisible.call(t,0,0),t.selectedCell[2]=t.selectedCell[0],t.selectedCell[3]=t.selectedCell[1]),t.options.lazyLoading!=1||t.selectedCell[1]!=0&&t.selectedCell[3]!=0){if(t.options.pagination>0){const s=t.whichPage(t.selectedCell[3]);s!=t.pageNumber&&t.page(s)}}else lazyLoading.wu.call(t,0);t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]),internal.Rs.call(t,1)},last=function(e,n){const t=this;if(e?n?t.selectedCell[3]=t.records.length-1:rightVisible.call(t,1,0):(n?t.selectedCell[1]=t.records.length-1:rightVisible.call(t,0,0),t.selectedCell[2]=t.selectedCell[0],t.selectedCell[3]=t.selectedCell[1]),t.options.lazyLoading!=1||t.selectedCell[1]!=t.records.length-1&&t.selectedCell[3]!=t.records.length-1){if(t.options.pagination>0){const s=t.whichPage(t.selectedCell[3]);s!=t.pageNumber&&t.page(s)}}else lazyLoading.wu.call(t,-1);t.updateSelectionFromCoords(t.selectedCell[0],t.selectedCell[1],t.selectedCell[2],t.selectedCell[3]),internal.Rs.call(t,3)};var merges=__webpack_require__(910),selection=__webpack_require__(657),internalHelpers=__webpack_require__(689);const copy=function(e,n,t,s,o,r,a){const l=this;n||(n="	");const c=new RegExp(n,"ig"),u=[];let h=[],C=[];const d=[],b=[],m=l.options.data[0].length,j=l.options.data.length;let f="",p=!1,g="",w="",B=0,v=0,R=0;for(let E=0;E<j;E++)for(let N=0;N<m;N++)e&&!l.records[E][N].element.classList.contains("highlight")||R<=E&&(R=E);if(o&&(l.parent.config.includeHeadersOnDownload==1||s)){if(l.options.nestedHeaders&&l.options.nestedHeaders.length>0){f=l.options.nestedHeaders;for(let E=0;E<f.length;E++){const N=[];for(let T=0;T<f[E].length;T++){const M=parseInt(f[E][T].colspan);N.push(f[E][T].title);for(let _=0;_<M-1;_++)N.push("")}w+=N.join(n)+`\r
`}}p=!0}l.style=[];for(let E=0;E<j;E++){h=[],C=[];for(let N=0;N<m;N++)if(!e||l.records[E][N].element.classList.contains("highlight")){p==1&&u.push(l.headers[N].textContent);let T,M=l.options.data[E][N];M.match&&(M.match(c)||M.match(/,/g)||M.match(/\n/)||M.match(/"/))&&(M=M.replace(new RegExp('"',"g"),'""'),M='"'+M+'"'),h.push(M),l.options.columns&&l.options.columns[N]&&(l.options.columns[N].type=="checkbox"||l.options.columns[N].type=="radio")?T=M:(T=l.records[E][N].element.innerHTML,T.match&&(T.match(c)||T.match(/,/g)||T.match(/\n/)||T.match(/"/))&&(T=T.replace(new RegExp('"',"g"),'""'),T='"'+T+'"')),C.push(T),f=l.records[E][N].element.getAttribute("style"),f=f.replace("display: none;",""),l.style.push(f||"")}h.length&&(p&&(B=h.length,d.push(u.join(n))),d.push(h.join(n))),C.length&&(v++,p&&(b.push(u.join(n)),p=!1),b.push(C.join(n)))}m==B&&j==v&&(g=w);const k=g+d.join(`\r
`);let I=g+b.join(`\r
`);if(!t){const E=[Math.min(l.selectedCell[0],l.selectedCell[2]),Math.min(l.selectedCell[1],l.selectedCell[3]),Math.max(l.selectedCell[0],l.selectedCell[2]),Math.max(l.selectedCell[1],l.selectedCell[3])],N=dispatch.A.call(l,"oncopy",l,E,I,r);if(N)I=N;else if(N===!1)return!1;l.textarea.value=I,l.textarea.select(),document.execCommand("copy")}if(l.data=a==1?I:k,l.hashString=selection.tW.call(l,l.data),!t&&(selection.kA.call(l),l.highlighted))for(let E=0;E<l.highlighted.length;E++)l.highlighted[E].element.classList.add("copying"),l.highlighted[E].element.classList.contains("highlight-left")&&l.highlighted[E].element.classList.add("copying-left"),l.highlighted[E].element.classList.contains("highlight-right")&&l.highlighted[E].element.classList.add("copying-right"),l.highlighted[E].element.classList.contains("highlight-top")&&l.highlighted[E].element.classList.add("copying-top"),l.highlighted[E].element.classList.contains("highlight-bottom")&&l.highlighted[E].element.classList.add("copying-bottom");return l.data},paste=function(e,n,t){const s=this,o=(0,selection.tW)(t);let r=o==s.hashString?s.style:null;o==s.hashString&&(t=s.data),t=(0,helpers.parseCSV)(t,"	");const a=s.selectedCell[2]-e+1,l=s.selectedCell[3]-n+1,c=t[0].length;if(a>1&Number.isInteger(a/c)){const C=a/c;if(r){const b=[];for(let m=0;m<r.length;m+=c){const j=r.slice(m,m+c);for(let f=0;f<C;f++)b.push(...j)}r=b}t=t.map(function(b,m){return Array.apply(null,{length:C*b.length}).map(function(f,p){return b[p%b.length]})})}const u=t.length;if(l>1&Number.isInteger(l/u)){const C=l/u;if(r){const b=[];for(let m=0;m<C;m++)b.push(...r);r=b}t=Array.apply(null,{length:C*u}).map(function(b,m){return t[m%u]})}const h=dispatch.A.call(s,"onbeforepaste",s,t.map(function(C){return C.map(function(d){return{value:d}})}),e,n);if(h===!1)return!1;if(h&&(t=h),e!=null&&n!=null&&t){let C=0,d=0;const b=[],m={},j={};let f=0,p=parseInt(e),g=parseInt(n),w=null;const B=s.headers.slice(p).filter(M=>M.style.display==="none").length,v=p+B+t[0].length,R=s.headers.length;v>R&&(s.skipUpdateTableReferences=!0,s.insertColumn(v-R));const k=s.rows.slice(g).filter(M=>M.element.style.display==="none").length,I=g+k+t.length,E=s.rows.length;for(I>E&&(s.skipUpdateTableReferences=!0,s.insertRow(I-E)),s.skipUpdateTableReferences&&(s.skipUpdateTableReferences=!1,internal.o8.call(s));w=t[d];){for(C=0,p=parseInt(e);w[C]!=null;){let M=w[C];s.options.columns&&s.options.columns[C]&&s.options.columns[C].type=="calendar"&&(M=jSuites.calendar.extractDateFromString(M,s.options.columns[C].options&&s.options.columns[C].options.format||"YYYY-MM-DD"));const _=internal.k9.call(s,p,g,M);if(b.push(_),internal.xF.call(s,p,g,b),r&&r[f]){const A=(0,internalHelpers.t3)([p,g]);m[A]=r[f],j[A]=s.getStyle(A),s.records[g][p].element.setAttribute("style",r[f]),f++}if(C++,w[C]!=null){if(p>=s.headers.length-1){if(s.options.allowInsertColumn==0)break;s.insertColumn()}p=rightGet.call(s,p,g)}}if(d++,t[d]){if(g>=s.rows.length-1){if(s.options.allowInsertRow==0)break;s.insertRow()}g=downGet.call(s,e,g)}}selection.AH.call(s,e,n,p,g),utils_history.Dh.call(s,{action:"setValue",records:b,selection:s.selectedCell,newStyle:m,oldStyle:j}),internal.am.call(s);const N=[];for(let M=0;M<t.length;M++)for(let _=0;_<t[M].length;_++)N.push({x:_+e,y:M+n,value:t[M][_]});dispatch.A.call(s,"onpaste",s,N);const T=b.map(function(M){return{x:M.x,y:M.y,value:M.value,oldValue:M.oldValue}});dispatch.A.call(s,"onafterchanges",s,T)}(0,selection.kA)()};var filter=__webpack_require__(829),footer=__webpack_require__(160);const getNumberOfColumns=function(){const e=this;let n=e.options.columns&&e.options.columns.length||0;if(e.options.data&&e.options.data[0]!==void 0){const t=Object.keys(e.options.data[0]);t.length>n&&(n=t.length)}return e.options.minDimensions&&e.options.minDimensions[0]>n&&(n=e.options.minDimensions[0]),n},createCellHeader=function(e){const n=this,t=n.options.columns&&n.options.columns[e]&&n.options.columns[e].width||n.options.defaultColWidth||100,s=n.options.columns&&n.options.columns[e]&&n.options.columns[e].align||n.options.defaultColAlign||"center";n.headers[e]=document.createElement("td"),n.headers[e].textContent=n.options.columns&&n.options.columns[e]&&n.options.columns[e].title||(0,helpers.getColumnName)(e),n.headers[e].setAttribute("data-x",e),n.headers[e].style.textAlign=s,n.options.columns&&n.options.columns[e]&&n.options.columns[e].title&&n.headers[e].setAttribute("title",n.headers[e].innerText),n.options.columns&&n.options.columns[e]&&n.options.columns[e].id&&n.headers[e].setAttribute("id",n.options.columns[e].id);const o=document.createElement("col");o.setAttribute("width",t),n.cols[e]={colElement:o,x:e},n.options.columns&&n.options.columns[e]&&n.options.columns[e].type=="hidden"&&(n.headers[e].style.display="none",o.style.display="none")},insertColumn=function(e,n,t,s){const o=this;if(o.options.allowInsertColumn!=0){let r,a=[];Array.isArray(e)?(r=1,e&&(a=e)):r=typeof e=="number"?e:1,t=!!t;const l=Math.max(o.options.columns.length,...o.options.data.map(function(p){return p.length}))-1;(n==null||n>=parseInt(l)||n<0)&&(n=l),s||(s=[]);for(let p=0;p<r;p++)s[p]||(s[p]={});const c=[];if(Array.isArray(e)){const p=[];for(let w=0;w<o.options.data.length;w++)p.push(w<e.length?e[w]:"");const g={column:n+(t?0:1),options:Object.assign({},s[0]),data:p};c.push(g)}else for(let p=0;p<e;p++){const g={column:n+p+(t?0:1),options:Object.assign({},s[p])};c.push(g)}if(dispatch.A.call(o,"onbeforeinsertcolumn",o,c)===!1)return!1;if(o.options.mergeCells&&Object.keys(o.options.mergeCells).length>0&&merges.Lt.call(o,n,t).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;o.destroyMerge()}const u=t?n:n+1;o.options.columns=(0,internalHelpers.Hh)(o.options.columns,u,s);const h=o.headers.splice(u),C=o.cols.splice(u),d=[],b=[],m=[],j=[],f=[];for(let p=u;p<r+u;p++)createCellHeader.call(o,p),o.headerContainer.insertBefore(o.headers[p],o.headerContainer.children[p+1]),o.colgroupContainer.insertBefore(o.cols[p].colElement,o.colgroupContainer.children[p+1]),d.push(o.headers[p]),b.push(o.cols[p]);if(o.options.footers)for(let p=0;p<o.options.footers.length;p++){f[p]=[];for(let g=0;g<r;g++)f[p].push("");o.options.footers[p].splice(u,0,f[p])}for(let p=0;p<o.options.data.length;p++){const g=o.options.data[p].splice(u),w=o.records[p].splice(u);j[p]=[],m[p]=[];for(let B=u;B<r+u;B++){const v=a[p]?a[p]:"";o.options.data[p][B]=v;const R=internal.P9.call(o,B,p,o.options.data[p][B]);o.records[p][B]={element:R,y:p},o.rows[p]&&o.rows[p].element.insertBefore(R,o.rows[p].element.children[B+1]),o.options.columns&&o.options.columns[B]&&typeof o.options.columns[B].render=="function"&&o.options.columns[B].render(R,v,parseInt(B),parseInt(p),o,o.options.columns[B]),j[p].push(v),m[p].push({element:R,x:B,y:p})}Array.prototype.push.apply(o.options.data[p],g),Array.prototype.push.apply(o.records[p],w)}Array.prototype.push.apply(o.headers,h),Array.prototype.push.apply(o.cols,C);for(let p=u;p<o.cols.length;p++)o.cols[p].x=p;for(let p=0;p<o.records.length;p++)for(let g=0;g<o.records[p].length;g++)o.records[p][g].x=g;if(o.options.nestedHeaders&&o.options.nestedHeaders.length>0&&o.options.nestedHeaders[0]&&o.options.nestedHeaders[0][0])for(let p=0;p<o.options.nestedHeaders.length;p++){const g=parseInt(o.options.nestedHeaders[p][o.options.nestedHeaders[p].length-1].colspan)+r;o.options.nestedHeaders[p][o.options.nestedHeaders[p].length-1].colspan=g,o.thead.children[p].children[o.thead.children[p].children.length-1].setAttribute("colspan",g);let w=o.thead.children[p].children[o.thead.children[p].children.length-1].getAttribute("data-column");w=w.split(",");for(let B=u;B<r+u;B++)w.push(B);o.thead.children[p].children[o.thead.children[p].children.length-1].setAttribute("data-column",w)}utils_history.Dh.call(o,{action:"insertColumn",columnNumber:n,numOfColumns:r,insertBefore:t,columns:s,headers:d,cols:b,records:m,footers:f,data:j}),internal.o8.call(o),dispatch.A.call(o,"oninsertcolumn",o,c)}},moveColumn=function(e,n){const t=this;if(t.options.mergeCells&&Object.keys(t.options.mergeCells).length>0){let r;if(r=e>n?1:0,merges.Lt.call(t,e).length||merges.Lt.call(t,n,r).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;t.destroyMerge()}}if((e=parseInt(e))>(n=parseInt(n))){t.headerContainer.insertBefore(t.headers[e],t.headers[n]),t.colgroupContainer.insertBefore(t.cols[e].colElement,t.cols[n].colElement);for(let r=0;r<t.rows.length;r++)t.rows[r].element.insertBefore(t.records[r][e].element,t.records[r][n].element)}else{t.headerContainer.insertBefore(t.headers[e],t.headers[n].nextSibling),t.colgroupContainer.insertBefore(t.cols[e].colElement,t.cols[n].colElement.nextSibling);for(let r=0;r<t.rows.length;r++)t.rows[r].element.insertBefore(t.records[r][e].element,t.records[r][n].element.nextSibling)}t.options.columns.splice(n,0,t.options.columns.splice(e,1)[0]),t.headers.splice(n,0,t.headers.splice(e,1)[0]),t.cols.splice(n,0,t.cols.splice(e,1)[0]);const s=Math.min(e,n),o=Math.max(e,n);for(let r=0;r<t.rows.length;r++)t.options.data[r].splice(n,0,t.options.data[r].splice(e,1)[0]),t.records[r].splice(n,0,t.records[r].splice(e,1)[0]);for(let r=s;r<=o;r++)t.cols[r].x=r;for(let r=0;r<t.records.length;r++)for(let a=s;a<=o;a++)t.records[r][a].x=a;if(t.options.footers)for(let r=0;r<t.options.footers.length;r++)t.options.footers[r].splice(n,0,t.options.footers[r].splice(e,1)[0]);utils_history.Dh.call(t,{action:"moveColumn",oldValue:e,newValue:n}),internal.o8.call(t),dispatch.A.call(t,"onmovecolumn",t,e,n,1)},deleteColumn=function(e,n){const t=this;if(t.options.allowDeleteColumn!=0)if(t.headers.length>1){if(e==null){const r=t.getSelectedColumns(!0);r.length?(e=parseInt(r[0]),n=parseInt(r.length)):(e=t.headers.length-1,n=1)}const s=t.options.data[0].length-1;(e==null||e>s||e<0)&&(e=s),n||(n=1),n>t.options.data[0].length-e&&(n=t.options.data[0].length-e);const o=[];for(let r=0;r<n;r++)o.push(r+e);if(dispatch.A.call(t,"onbeforedeletecolumn",t,o)===!1)return!1;if(parseInt(e)>-1){let r=!1;if(t.options.mergeCells&&Object.keys(t.options.mergeCells).length>0)for(let d=e;d<e+n;d++)merges.Lt.call(t,d,null).length&&(r=!0);if(r){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;t.destroyMerge()}const a=t.options.columns?t.options.columns.splice(e,n):void 0;for(let d=e;d<e+n;d++)t.cols[d].colElement.className="",t.headers[d].className="",t.cols[d].colElement.parentNode.removeChild(t.cols[d].colElement),t.headers[d].parentNode.removeChild(t.headers[d]);const l=t.headers.splice(e,n),c=t.cols.splice(e,n),u=[],h=[],C=[];for(let d=0;d<t.options.data.length;d++)for(let b=e;b<e+n;b++)t.records[d][b].element.className="",t.records[d][b].element.parentNode.removeChild(t.records[d][b].element);for(let d=0;d<t.options.data.length;d++)h[d]=t.options.data[d].splice(e,n),u[d]=t.records[d].splice(e,n);for(let d=e;d<t.cols.length;d++)t.cols[d].x=d;for(let d=0;d<t.records.length;d++)for(let b=e;b<t.records[d].length;b++)t.records[d][b].x=b;if(t.options.footers)for(let d=0;d<t.options.footers.length;d++)C[d]=t.options.footers[d].splice(e,n);if(selection.at.call(t,0,e,e+n-1),t.options.nestedHeaders&&t.options.nestedHeaders.length>0&&t.options.nestedHeaders[0]&&t.options.nestedHeaders[0][0])for(let d=0;d<t.options.nestedHeaders.length;d++){const b=parseInt(t.options.nestedHeaders[d][t.options.nestedHeaders[d].length-1].colspan)-n;t.options.nestedHeaders[d][t.options.nestedHeaders[d].length-1].colspan=b,t.thead.children[d].children[t.thead.children[d].children.length-1].setAttribute("colspan",b)}utils_history.Dh.call(t,{action:"deleteColumn",columnNumber:e,numOfColumns:n,insertBefore:1,columns:a,headers:l,cols:c,records:u,footers:C,data:h}),internal.o8.call(t),dispatch.A.call(t,"ondeletecolumn",t,o)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},getWidth=function(e){const n=this;let t;if(e===void 0){t=[];for(let s=0;s<n.headers.length;s++)t.push(n.options.columns&&n.options.columns[s]&&n.options.columns[s].width||n.options.defaultColWidth||100)}else t=parseInt(n.cols[e].colElement.getAttribute("width"));return t},setWidth=function(e,n,t){const s=this;if(n){if(Array.isArray(e)){t||(t=[]);for(let o=0;o<e.length;o++){t[o]||(t[o]=parseInt(s.cols[e[o]].colElement.getAttribute("width")));const r=Array.isArray(n)&&n[o]?n[o]:n;s.cols[e[o]].colElement.setAttribute("width",r),s.options.columns||(s.options.columns=[]),s.options.columns[e[o]]||(s.options.columns[e[o]]={}),s.options.columns[e[o]].width=r}}else t||(t=parseInt(s.cols[e].colElement.getAttribute("width"))),s.cols[e].colElement.setAttribute("width",n),s.options.columns||(s.options.columns=[]),s.options.columns[e]||(s.options.columns[e]={}),s.options.columns[e].width=n;utils_history.Dh.call(s,{action:"setWidth",column:e,oldValue:t,newValue:n}),dispatch.A.call(s,"onresizecolumn",s,e,n,t),selection.Aq.call(s)}},showColumn=function(e){const n=this;Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const s=e[t];n.headers[s].style.display="",n.cols[s].colElement.style.display="",n.filter&&n.filter.children.length>s+1&&(n.filter.children[s+1].style.display="");for(let o=0;o<n.options.data.length;o++)n.records[o][s].element.style.display=""}n.options.footers&&footer.e.call(n),n.resetSelection()},hideColumn=function(e){const n=this;Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const s=e[t];n.headers[s].style.display="none",n.cols[s].colElement.style.display="none",n.filter&&n.filter.children.length>s+1&&(n.filter.children[s+1].style.display="none");for(let o=0;o<n.options.data.length;o++)n.records[o][s].element.style.display="none"}n.options.footers&&footer.e.call(n),n.resetSelection()},getColumnData=function(e,n){const t=this,s=[];for(let o=0;o<t.options.data.length;o++)n?s.push(t.records[o][e].element.innerHTML):s.push(t.options.data[o][e]);return s},setColumnData=function(e,n,t){const s=this;for(let o=0;o<s.rows.length;o++){const r=(0,internalHelpers.t3)([e,o]);n[o]!=null&&s.setValue(r,n[o],t)}},createRow=function(e,n){const t=this;t.records[e]||(t.records[e]=[]),n||(n=t.options.data[e]);const s={element:document.createElement("tr"),y:e};t.rows[e]=s,s.element.setAttribute("data-y",e);let o=null;t.options.defaultRowHeight&&(s.element.style.height=t.options.defaultRowHeight+"px"),t.options.rows&&t.options.rows[e]&&(t.options.rows[e].height&&(s.element.style.height=t.options.rows[e].height),t.options.rows[e].title&&(o=t.options.rows[e].title)),o||(o=parseInt(e+1));const r=document.createElement("td");r.innerHTML=o,r.setAttribute("data-y",e),r.className="jss_row",s.element.appendChild(r);const a=getNumberOfColumns.call(t);for(let l=0;l<a;l++)t.records[e][l]={element:internal.P9.call(this,l,e,n[l]),x:l,y:e},s.element.appendChild(t.records[e][l].element),t.options.columns&&t.options.columns[l]&&typeof t.options.columns[l].render=="function"&&t.options.columns[l].render(t.records[e][l].element,n[l],parseInt(l),parseInt(e),t,t.options.columns[l]);return s},insertRow=function(e,n,t){const s=this;if(s.options.allowInsertRow!=0){let o,r=[];Array.isArray(e)?(o=1,e&&(r=e)):o=e!==void 0?e:1,t=!!t;const a=s.options.data.length-1;(n==null||n>=parseInt(a)||n<0)&&(n=a);const l=[];for(let j=0;j<o;j++){const f=[];for(let p=0;p<s.options.columns.length;p++)f[p]=r[p]?r[p]:"";l.push({row:j+n+(t?0:1),data:f})}if(dispatch.A.call(s,"onbeforeinsertrow",s,l)===!1)return!1;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0&&merges.D0.call(s,n,t).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}if(s.options.search==1){if(s.results&&s.results.length!=s.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;s.resetSearch()}s.results=null}const c=t?n:n+1,u=s.records.splice(c),h=s.options.data.splice(c),C=s.rows.splice(c),d=[],b=[],m=[];for(let j=c;j<o+c;j++){s.options.data[j]=[];for(let p=0;p<s.options.columns.length;p++)s.options.data[j][p]=r[p]?r[p]:"";const f=createRow.call(s,j,s.options.data[j]);C[0]?Array.prototype.indexOf.call(s.tbody.children,C[0].element)>=0&&s.tbody.insertBefore(f.element,C[0].element):Array.prototype.indexOf.call(s.tbody.children,s.rows[n].element)>=0&&s.tbody.appendChild(f.element),d.push([...s.records[j]]),b.push([...s.options.data[j]]),m.push(f)}Array.prototype.push.apply(s.records,u),Array.prototype.push.apply(s.options.data,h),Array.prototype.push.apply(s.rows,C);for(let j=c;j<s.rows.length;j++)s.rows[j].y=j;for(let j=c;j<s.records.length;j++)for(let f=0;f<s.records[j].length;f++)s.records[j][f].y=j;s.options.pagination>0&&s.page(s.pageNumber),utils_history.Dh.call(s,{action:"insertRow",rowNumber:n,numOfRows:o,insertBefore:t,rowRecords:d,rowData:b,rowNode:m}),internal.o8.call(s),dispatch.A.call(s,"oninsertrow",s,l)}},moveRow=function(e,n,t){const s=this;if(s.options.mergeCells&&Object.keys(s.options.mergeCells).length>0){let a;if(a=e>n?1:0,merges.D0.call(s,e).length||merges.D0.call(s,n,a).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;s.destroyMerge()}}if(s.options.search==1){if(s.results&&s.results.length!=s.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;s.resetSearch()}s.results=null}t||(Array.prototype.indexOf.call(s.tbody.children,s.rows[n].element)>=0?e>n?s.tbody.insertBefore(s.rows[e].element,s.rows[n].element):s.tbody.insertBefore(s.rows[e].element,s.rows[n].element.nextSibling):s.tbody.removeChild(s.rows[e].element)),s.rows.splice(n,0,s.rows.splice(e,1)[0]),s.records.splice(n,0,s.records.splice(e,1)[0]),s.options.data.splice(n,0,s.options.data.splice(e,1)[0]);const o=Math.min(e,n),r=Math.max(e,n);for(let a=o;a<=r;a++)s.rows[a].y=a;for(let a=o;a<=r;a++)for(let l=0;l<s.records[a].length;l++)s.records[a][l].y=a;s.options.pagination>0&&s.tbody.children.length!=s.options.pagination&&s.page(s.pageNumber),utils_history.Dh.call(s,{action:"moveRow",oldValue:e,newValue:n}),internal.o8.call(s),dispatch.A.call(s,"onmoverow",s,parseInt(e),parseInt(n),1)},deleteRow=function(e,n){const t=this;if(t.options.allowDeleteRow!=0)if(t.options.allowDeletingAllRows==1||t.options.data.length>1){if(e==null){const r=selection.R5.call(t);r.length===0?(e=t.options.data.length-1,n=1):(e=r[0],n=r.length)}let s=t.options.data.length-1;(e==null||e>s||e<0)&&(e=s),n||(n=1),e+n>=t.options.data.length&&(n=t.options.data.length-e);const o=[];for(let r=0;r<n;r++)o.push(r+e);if(dispatch.A.call(t,"onbeforedeleterow",t,o)===!1)return!1;if(parseInt(e)>-1){let r=!1;if(t.options.mergeCells&&Object.keys(t.options.mergeCells).length>0)for(let u=e;u<e+n;u++)merges.D0.call(t,u,!1).length&&(r=!0);if(r){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;t.destroyMerge()}if(t.options.search==1){if(t.results&&t.results.length!=t.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;t.resetSearch()}t.results=null}t.options.allowDeletingAllRows!=1&&s+1===n&&(n--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let u=e;u<e+n;u++)Array.prototype.indexOf.call(t.tbody.children,t.rows[u].element)>=0&&(t.rows[u].element.className="",t.rows[u].element.parentNode.removeChild(t.rows[u].element));const a=t.records.splice(e,n),l=t.options.data.splice(e,n),c=t.rows.splice(e,n);for(let u=e;u<t.rows.length;u++)t.rows[u].y=u;for(let u=e;u<t.records.length;u++)for(let h=0;h<t.records[u].length;h++)t.records[u][h].y=u;t.options.pagination>0&&t.tbody.children.length!=t.options.pagination&&t.page(t.pageNumber),selection.at.call(t,1,e,e+n-1),utils_history.Dh.call(t,{action:"deleteRow",rowNumber:e,numOfRows:n,insertBefore:1,rowRecords:a,rowData:l,rowNode:c}),internal.o8.call(t),dispatch.A.call(t,"ondeleterow",t,o)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},getHeight=function(e){const n=this;let t;if(e===void 0){t=[];for(let s=0;s<n.rows.length;s++){const o=n.rows[s].element.style.height;o&&(t[s]=o)}}else typeof e=="object"&&(e=e.getAttribute("data-y")),t=n.rows[e].element.style.height;return t},setHeight=function(e,n,t){const s=this;n>0&&(t||(t=s.rows[e].element.getAttribute("height"))||(t=s.rows[e].element.getBoundingClientRect().height),n=parseInt(n),s.rows[e].element.style.height=n+"px",s.options.rows||(s.options.rows=[]),s.options.rows[e]||(s.options.rows[e]={}),s.options.rows[e].height=n,utils_history.Dh.call(s,{action:"setHeight",row:e,oldValue:t,newValue:n}),dispatch.A.call(s,"onresizerow",s,e,n,t),selection.Aq.call(s))},showRow=function(e){const n=this;Array.isArray(e)||(e=[e]),e.forEach(function(t){n.rows[t].element.style.display=""})},hideRow=function(e){const n=this;Array.isArray(e)||(e=[e]),e.forEach(function(t){n.rows[t].element.style.display="none"})},getRowData=function(e,n){return n?this.records[e].map(function(t){return t.element.innerHTML}):this.options.data[e]},setRowData=function(e,n,t){const s=this;for(let o=0;o<s.headers.length;o++){const r=(0,internalHelpers.t3)([o,e]);n[o]!=null&&s.setValue(r,n[o],t)}};var version={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join(`\r
`)]}};const getElement=function(e){let n=0,t=0;return(function s(o){o.className&&(o.classList.contains("jss_container")&&(t=o),o.classList.contains("jss_spreadsheet")&&(t=o.querySelector(":scope > .jtabs-content > .jtabs-selected"))),o.tagName=="THEAD"?n=1:o.tagName=="TBODY"&&(n=2),o.parentNode&&(t||s(o.parentNode))})(e),[t,n]},mouseUpControls=function(e){if(libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.current.resizing){if(libraryBase.jspreadsheet.current.resizing.column){const n=parseInt(libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),t=libraryBase.jspreadsheet.current.getSelectedColumns();if(t.length>1){const s=[];for(let o=0;o<t.length;o++)s.push(parseInt(libraryBase.jspreadsheet.current.cols[t[o]].colElement.getAttribute("width")));s[t.indexOf(parseInt(libraryBase.jspreadsheet.current.resizing.column))]=libraryBase.jspreadsheet.current.resizing.width,setWidth.call(libraryBase.jspreadsheet.current,t,n,s)}else setWidth.call(libraryBase.jspreadsheet.current,parseInt(libraryBase.jspreadsheet.current.resizing.column),n,libraryBase.jspreadsheet.current.resizing.width);libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let s=0;s<libraryBase.jspreadsheet.current.records.length;s++)libraryBase.jspreadsheet.current.records[s][libraryBase.jspreadsheet.current.resizing.column]&&libraryBase.jspreadsheet.current.records[s][libraryBase.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let n=libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.getAttribute("height");setHeight.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.resizing.row,n,libraryBase.jspreadsheet.current.resizing.height),libraryBase.jspreadsheet.current.resizing.element.classList.remove("resizing")}libraryBase.jspreadsheet.current.resizing=null}else if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging.column){const n=e.target.getAttribute("data-x");libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let t=0;t<libraryBase.jspreadsheet.current.rows.length;t++)libraryBase.jspreadsheet.current.records[t][libraryBase.jspreadsheet.current.dragging.column]&&libraryBase.jspreadsheet.current.records[t][libraryBase.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let t=0;t<libraryBase.jspreadsheet.current.headers.length;t++)libraryBase.jspreadsheet.current.headers[t].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[t].classList.remove("dragging-right");n&&libraryBase.jspreadsheet.current.dragging.column!=libraryBase.jspreadsheet.current.dragging.destination&&libraryBase.jspreadsheet.current.moveColumn(libraryBase.jspreadsheet.current.dragging.column,libraryBase.jspreadsheet.current.dragging.destination)}else{let n;libraryBase.jspreadsheet.current.dragging.element.nextSibling?(n=parseInt(libraryBase.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row<n&&(n-=1)):n=parseInt(libraryBase.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row!=libraryBase.jspreadsheet.current.dragging.destination&&moveRow.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.dragging.row,n,!0),libraryBase.jspreadsheet.current.dragging.element.classList.remove("dragging")}libraryBase.jspreadsheet.current.dragging=null}}else libraryBase.jspreadsheet.current.selectedCorner&&(libraryBase.jspreadsheet.current.selectedCorner=!1,libraryBase.jspreadsheet.current.selection.length>0&&(selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selection[0],libraryBase.jspreadsheet.current.selection[libraryBase.jspreadsheet.current.selection.length-1]),selection.gG.call(libraryBase.jspreadsheet.current)));libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null),libraryBase.jspreadsheet.isMouseAction=!1},mouseDownControls=function(e){let n;n=(e=e||window.event).buttons?e.buttons:e.button?e.button:e.which;const t=getElement(e.target);if(t[0]?libraryBase.jspreadsheet.current!=t[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),libraryBase.jspreadsheet.current.resetSelection()),libraryBase.jspreadsheet.current=t[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),e.target.classList.contains("jss_object")||(selection.gE.call(libraryBase.jspreadsheet.current,!0),libraryBase.jspreadsheet.current=null)),libraryBase.jspreadsheet.current&&n==1){if(e.target.classList.contains("jss_selectall"))libraryBase.jspreadsheet.current&&selection.Ub.call(libraryBase.jspreadsheet.current);else if(e.target.classList.contains("jss_corner"))libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedCorner=!0);else{if(t[1]==1){const s=e.target.getAttribute("data-x");if(s){const o=e.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.columnResize!=0&&o.width-e.offsetX<6){libraryBase.jspreadsheet.current.resizing={mousePosition:e.pageX,column:s,width:o.width},libraryBase.jspreadsheet.current.headers[s].classList.add("resizing");for(let r=0;r<libraryBase.jspreadsheet.current.records.length;r++)libraryBase.jspreadsheet.current.records[r][s]&&libraryBase.jspreadsheet.current.records[r][s].element.classList.add("resizing")}else if(libraryBase.jspreadsheet.current.options.columnDrag!=0&&o.height-e.offsetY<6)if(merges.Lt.call(libraryBase.jspreadsheet.current,s).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:e.target,column:s,destination:s},libraryBase.jspreadsheet.current.headers[s].classList.add("dragging");for(let r=0;r<libraryBase.jspreadsheet.current.records.length;r++)libraryBase.jspreadsheet.current.records[r][s]&&libraryBase.jspreadsheet.current.records[r][s].element.classList.add("dragging")}else{let r,a;libraryBase.jspreadsheet.current.selectedHeader&&(e.shiftKey||e.ctrlKey)?(r=libraryBase.jspreadsheet.current.selectedHeader,a=s):(libraryBase.jspreadsheet.current.selectedHeader==s&&libraryBase.jspreadsheet.current.options.allowRenameColumn!=0&&(libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.setHeader(s)},800)),libraryBase.jspreadsheet.current.selectedHeader=s,r=s,a=s),selection.AH.call(libraryBase.jspreadsheet.current,r,0,a,libraryBase.jspreadsheet.current.options.data.length-1,e)}}else if(e.target.parentNode.classList.contains("jss_nested")){let o,r;if(e.target.getAttribute("data-column")){const a=e.target.getAttribute("data-column").split(",");o=parseInt(a[0]),r=parseInt(a[a.length-1])}else o=0,r=libraryBase.jspreadsheet.current.options.columns.length-1;selection.AH.call(libraryBase.jspreadsheet.current,o,0,r,libraryBase.jspreadsheet.current.options.data.length-1,e)}}else libraryBase.jspreadsheet.current.selectedHeader=!1;if(t[1]==2){const s=parseInt(e.target.getAttribute("data-y"));if(e.target.classList.contains("jss_row")){const o=e.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.rowResize!=0&&o.height-e.offsetY<6)libraryBase.jspreadsheet.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:s,height:o.height},e.target.parentNode.classList.add("resizing");else if(libraryBase.jspreadsheet.current.options.rowDrag!=0&&o.width-e.offsetX<6)merges.D0.call(libraryBase.jspreadsheet.current,s).length?console.error("Jspreadsheet: This row is part of a merged cell"):libraryBase.jspreadsheet.current.options.search==1&&libraryBase.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:e.target.parentNode,row:s,destination:s},e.target.parentNode.classList.add("dragging"));else{let r,a;libraryBase.jspreadsheet.current.selectedRow!=null&&(e.shiftKey||e.ctrlKey)?(r=libraryBase.jspreadsheet.current.selectedRow,a=s):(libraryBase.jspreadsheet.current.selectedRow=s,r=s,a=s),selection.AH.call(libraryBase.jspreadsheet.current,null,r,null,a,e)}}else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else{const o=function(a){const l=a.getAttribute("data-x"),c=a.getAttribute("data-y");return l&&c?[l,c]:a.parentNode?o(a.parentNode):void 0},r=o(e.target);if(r){const a=r[0],l=r[1];libraryBase.jspreadsheet.current.edition&&(libraryBase.jspreadsheet.current.edition[2]==a&&libraryBase.jspreadsheet.current.edition[3]==l||closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0)),libraryBase.jspreadsheet.current.edition||(e.shiftKey?selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],a,l,e):selection.AH.call(libraryBase.jspreadsheet.current,a,l,void 0,void 0,e)),libraryBase.jspreadsheet.current.selectedHeader=null,libraryBase.jspreadsheet.current.selectedRow=null}}}else libraryBase.jspreadsheet.current.selectedRow=!1;e.target.classList.contains("jss_page")&&(e.target.textContent=="<"?libraryBase.jspreadsheet.current.page(0):e.target.textContent==">"?libraryBase.jspreadsheet.current.page(e.target.getAttribute("title")-1):libraryBase.jspreadsheet.current.page(e.target.textContent-1))}libraryBase.jspreadsheet.current.edition?libraryBase.jspreadsheet.isMouseAction=!1:libraryBase.jspreadsheet.isMouseAction=!0}else libraryBase.jspreadsheet.isMouseAction=!1},mouseMoveControls=function(e){let n;if(n=(e=e||window.event).buttons?e.buttons:e.button?e.button:e.which,n||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.isMouseAction==1){if(libraryBase.jspreadsheet.current.resizing)if(libraryBase.jspreadsheet.current.resizing.column){const t=e.pageX-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.width+t>0){const s=libraryBase.jspreadsheet.current.resizing.width+t;libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.setAttribute("width",s),selection.Aq.call(libraryBase.jspreadsheet.current)}}else{const t=e.pageY-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.height+t>0){const s=libraryBase.jspreadsheet.current.resizing.height+t;libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.setAttribute("height",s),selection.Aq.call(libraryBase.jspreadsheet.current)}}else if(libraryBase.jspreadsheet.current.dragging)if(libraryBase.jspreadsheet.current.dragging.column){const t=e.target.getAttribute("data-x");if(t)if(merges.Lt.call(libraryBase.jspreadsheet.current,t).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let s=0;s<libraryBase.jspreadsheet.current.headers.length;s++)libraryBase.jspreadsheet.current.headers[s].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[s].classList.remove("dragging-right");libraryBase.jspreadsheet.current.dragging.column==t?libraryBase.jspreadsheet.current.dragging.destination=parseInt(t):e.target.clientWidth/2>e.offsetX?(libraryBase.jspreadsheet.current.dragging.column<t?libraryBase.jspreadsheet.current.dragging.destination=parseInt(t)-1:libraryBase.jspreadsheet.current.dragging.destination=parseInt(t),libraryBase.jspreadsheet.current.headers[t].classList.add("dragging-left")):(libraryBase.jspreadsheet.current.dragging.column<t?libraryBase.jspreadsheet.current.dragging.destination=parseInt(t):libraryBase.jspreadsheet.current.dragging.destination=parseInt(t)+1,libraryBase.jspreadsheet.current.headers[t].classList.add("dragging-right"))}}else{const t=e.target.getAttribute("data-y");if(t)if(merges.D0.call(libraryBase.jspreadsheet.current,t).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const s=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;libraryBase.jspreadsheet.current.dragging.element!=s&&(e.target.parentNode.parentNode.insertBefore(libraryBase.jspreadsheet.current.dragging.element,s),libraryBase.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(libraryBase.jspreadsheet.current.dragging.element.parentNode.children,libraryBase.jspreadsheet.current.dragging.element))}}}else{const t=e.target.getAttribute("data-x"),s=e.target.getAttribute("data-y"),o=e.target.getBoundingClientRect();libraryBase.jspreadsheet.current.cursor&&(libraryBase.jspreadsheet.current.cursor.style.cursor="",libraryBase.jspreadsheet.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&t&&!s&&o.width-(e.clientX-o.left)<6?(libraryBase.jspreadsheet.current.cursor=e.target,libraryBase.jspreadsheet.current.cursor.style.cursor="col-resize"):e.target&&!t&&s&&o.height-(e.clientY-o.top)<6&&(libraryBase.jspreadsheet.current.cursor=e.target,libraryBase.jspreadsheet.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!t&&s&&o.width-(e.clientX-o.left)<6||e.target&&t&&!s&&o.height-(e.clientY-o.top)<6)&&(libraryBase.jspreadsheet.current.cursor=e.target,libraryBase.jspreadsheet.current.cursor.style.cursor="move"))}},updateCopySelection=function(e,n){const t=this;selection.gG.call(t);const s=t.selectedContainer[0],o=t.selectedContainer[1],r=t.selectedContainer[2],a=t.selectedContainer[3];if(e!=null&&n!=null){let l,c,u,h;e-r>0?(l=parseInt(r)+1,c=parseInt(e)):(l=parseInt(e),c=parseInt(s)-1),n-a>0?(u=parseInt(a)+1,h=parseInt(n)):(u=parseInt(n),h=parseInt(o)-1),c-l<=h-u?(l=parseInt(s),c=parseInt(r)):(u=parseInt(o),h=parseInt(a));for(let C=u;C<=h;C++)for(let d=l;d<=c;d++)t.records[C][d]&&t.rows[C].element.style.display!="none"&&t.records[C][d].element.style.display!="none"&&(t.records[C][d].element.classList.add("selection"),t.records[u][d].element.classList.add("selection-top"),t.records[h][d].element.classList.add("selection-bottom"),t.records[C][l].element.classList.add("selection-left"),t.records[C][c].element.classList.add("selection-right"),t.selection.push(t.records[C][d].element))}},mouseOverControls=function(e){let n;if(n=(e=e||window.event).buttons?e.buttons:e.button?e.button:e.which,n||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.isMouseAction==1){const t=getElement(e.target);if(t[0]){if(libraryBase.jspreadsheet.current!=t[0].jssWorksheet&&libraryBase.jspreadsheet.current)return!1;let s=e.target.getAttribute("data-x");const o=e.target.getAttribute("data-y");if(!(libraryBase.jspreadsheet.current.resizing||libraryBase.jspreadsheet.current.dragging)){if(t[1]==1&&libraryBase.jspreadsheet.current.selectedHeader){s=e.target.getAttribute("data-x");const r=libraryBase.jspreadsheet.current.selectedHeader,a=s;selection.AH.call(libraryBase.jspreadsheet.current,r,0,a,libraryBase.jspreadsheet.current.options.data.length-1,e)}if(t[1]==2)if(e.target.classList.contains("jss_row")){if(libraryBase.jspreadsheet.current.selectedRow!=null){const r=libraryBase.jspreadsheet.current.selectedRow,a=o;selection.AH.call(libraryBase.jspreadsheet.current,0,r,libraryBase.jspreadsheet.current.options.data[0].length-1,a,e)}}else libraryBase.jspreadsheet.current.edition||s&&o&&(libraryBase.jspreadsheet.current.selectedCorner?updateCopySelection.call(libraryBase.jspreadsheet.current,s,o):libraryBase.jspreadsheet.current.selectedCell&&selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],s,o,e))}}}libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null)},doubleClickControls=function(e){if(libraryBase.jspreadsheet.current)if(e.target.classList.contains("jss_corner")){if(libraryBase.jspreadsheet.current.highlighted.length>0){const n=libraryBase.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),t=parseInt(libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,s=libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),o=libraryBase.jspreadsheet.current.records.length-1;selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[t][n].element,libraryBase.jspreadsheet.current.records[o][s].element)}}else if(e.target.classList.contains("jss_column_filter")){const n=e.target.getAttribute("data-x");filter.N$.call(libraryBase.jspreadsheet.current,n)}else{const n=getElement(e.target);if(n[1]==1&&libraryBase.jspreadsheet.current.options.columnSorting!=0){const t=e.target.getAttribute("data-x");t&&libraryBase.jspreadsheet.current.orderBy(parseInt(t))}if(n[1]==2&&libraryBase.jspreadsheet.current.options.editable!=0&&!libraryBase.jspreadsheet.current.edition){const t=function(o){if(o.parentNode){const r=o.getAttribute("data-x"),a=o.getAttribute("data-y");return r&&a?o:t(o.parentNode)}},s=t(e.target);s&&s.classList.contains("highlight")&&openEditor.call(libraryBase.jspreadsheet.current,s,void 0,e)}}},pasteControls=function(e){libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.selectedCell&&(libraryBase.jspreadsheet.current.edition||libraryBase.jspreadsheet.current.options.editable!=0&&(e&&e.clipboardData?(paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},getRole=function(e){if(e.classList.contains("jss_selectall"))return"select-all";if(e.classList.contains("jss_corner"))return"fill-handle";let n=e;for(;!n.classList.contains("jss_spreadsheet");){if(n.classList.contains("jss_row"))return"row";if(n.classList.contains("jss_nested"))return"nested";if(n.classList.contains("jtabs-headers"))return"tabs";if(n.classList.contains("jtoolbar"))return"toolbar";if(n.classList.contains("jss_pagination"))return"pagination";if(n.tagName==="TBODY")return"cell";if(n.tagName==="TFOOT")return getElementIndex(e)===0?"grid":"footer";if(n.tagName==="THEAD")return"header";n=n.parentElement}return"applications"},defaultContextMenu=function(e,n,t,s){const o=[];if(s==="header"&&(e.options.allowInsertColumn!=0&&o.push({title:jSuites.translate("Insert a new column before"),onclick:function(){e.insertColumn(1,parseInt(n),1)}}),e.options.allowInsertColumn!=0&&o.push({title:jSuites.translate("Insert a new column after"),onclick:function(){e.insertColumn(1,parseInt(n),0)}}),e.options.allowDeleteColumn!=0&&o.push({title:jSuites.translate("Delete selected columns"),onclick:function(){e.deleteColumn(e.getSelectedColumns().length?void 0:parseInt(n))}}),e.options.allowRenameColumn!=0&&o.push({title:jSuites.translate("Rename this column"),onclick:function(){const r=e.getHeader(n),a=prompt(jSuites.translate("Column name"),r);e.setHeader(n,a)}}),e.options.columnSorting!=0&&(o.push({type:"line"}),o.push({title:jSuites.translate("Order ascending"),onclick:function(){e.orderBy(n,0)}}),o.push({title:jSuites.translate("Order descending"),onclick:function(){e.orderBy(n,1)}}))),s!=="row"&&s!=="cell"||(e.options.allowInsertRow!=0&&(o.push({title:jSuites.translate("Insert a new row before"),onclick:function(){e.insertRow(1,parseInt(t),1)}}),o.push({title:jSuites.translate("Insert a new row after"),onclick:function(){e.insertRow(1,parseInt(t))}})),e.options.allowDeleteRow!=0&&o.push({title:jSuites.translate("Delete selected rows"),onclick:function(){e.deleteRow(e.getSelectedRows().length?void 0:parseInt(t))}})),s==="cell"&&e.options.allowComments!=0){o.push({type:"line"});const r=e.records[t][n].element.getAttribute("title")||"";o.push({title:jSuites.translate(r?"Edit comments":"Add comments"),onclick:function(){const a=prompt(jSuites.translate("Comments"),r);a&&e.setComments((0,helpers.getCellNameFromCoords)(n,t),a)}}),r&&o.push({title:jSuites.translate("Clear comments"),onclick:function(){e.setComments((0,helpers.getCellNameFromCoords)(n,t),"")}})}return o.length!==0&&o.push({type:"line"}),s!=="header"&&s!=="row"&&s!=="cell"||(o.push({title:jSuites.translate("Copy")+"...",shortcut:"Ctrl + C",onclick:function(){copy.call(e,!0)}}),navigator&&navigator.clipboard&&o.push({title:jSuites.translate("Paste")+"...",shortcut:"Ctrl + V",onclick:function(){e.selectedCell&&navigator.clipboard.readText().then(function(r){r&&paste.call(e,e.selectedCell[0],e.selectedCell[1],r)})}})),e.parent.config.allowExport!=0&&o.push({title:jSuites.translate("Save as")+"...",shortcut:"Ctrl + S",onclick:function(){e.download()}}),e.parent.config.about!=0&&o.push({title:jSuites.translate("About"),onclick:function(){e.parent.config.about===void 0||e.parent.config.about===!0?alert(version.print()):alert(e.parent.config.about)}}),o},getElementIndex=function(e){const n=e.parentElement.children;for(let t=0;t<n.length;t++)if(e===n[t])return t;return-1},contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,libraryBase.jspreadsheet.current){const n=libraryBase.jspreadsheet.current.parent;if(libraryBase.jspreadsheet.current.edition)e.preventDefault();else if(n.contextMenu.contextmenu.close(),libraryBase.jspreadsheet.current){const t=getRole(e.target);let s=null,o=null;if(t==="cell"){let a=e.target;for(;a.tagName!=="TD";)a=a.parentNode;o=a.getAttribute("data-y"),s=a.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||s<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||s>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||o<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||o>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,s,o,s,o,e)}else if(t==="row"||t==="header")t==="row"?o=e.target.getAttribute("data-y"):s=e.target.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||s<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||s>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||o<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||o>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,s,o,s,o,e);else if(t==="nested"){const a=e.target.getAttribute("data-column").split(",");s=getElementIndex(e.target)-1,o=getElementIndex(e.target.parentElement),libraryBase.jspreadsheet.current.selectedCell&&a[0]==parseInt(libraryBase.jspreadsheet.current.selectedCell[0])&&a[a.length-1]==parseInt(libraryBase.jspreadsheet.current.selectedCell[2])&&libraryBase.jspreadsheet.current.selectedCell[1]==null&&libraryBase.jspreadsheet.current.selectedCell[3]==null||selection.AH.call(libraryBase.jspreadsheet.current,a[0],null,a[a.length-1],null,e)}else t==="select-all"?selection.Ub.call(libraryBase.jspreadsheet.current):t==="tabs"?s=getElementIndex(e.target):t==="footer"&&(s=getElementIndex(e.target)-1,o=getElementIndex(e.target.parentElement));let r=defaultContextMenu(libraryBase.jspreadsheet.current,parseInt(s),parseInt(o),t);if(typeof n.config.contextMenu=="function"){const a=n.config.contextMenu(libraryBase.jspreadsheet.current,s,o,e,r,t,s,o);if(a)r=a;else if(a===!1)return}typeof n.plugins=="object"&&Object.entries(n.plugins).forEach(function([,a]){if(typeof a.contextMenu=="function"){const l=a.contextMenu(libraryBase.jspreadsheet.current,s!==null?parseInt(s):null,o!==null?parseInt(o):null,e,r,t,s!==null?parseInt(s):null,o!==null?parseInt(o):null);l&&(r=l)}}),n.contextMenu.contextmenu.open(e,r),e.preventDefault()}}},touchStartControls=function(e){const n=getElement(e.target);if(n[0]?libraryBase.jspreadsheet.current!=n[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=n[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=null),libraryBase.jspreadsheet.current&&!libraryBase.jspreadsheet.current.edition){const t=e.target.getAttribute("data-x"),s=e.target.getAttribute("data-y");t&&s&&(selection.AH.call(libraryBase.jspreadsheet.current,t,s,void 0,void 0,e),libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.options.columns[t].type=="color"?libraryBase.jspreadsheet.tmpElement=null:libraryBase.jspreadsheet.tmpElement=e.target,openEditor.call(libraryBase.jspreadsheet.current,e.target,!1,e)},500))}},touchEndControls=function(e){libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null,libraryBase.jspreadsheet.tmpElement&&libraryBase.jspreadsheet.tmpElement.children[0].tagName=="INPUT"&&libraryBase.jspreadsheet.tmpElement.children[0].focus(),libraryBase.jspreadsheet.tmpElement=null)},cutControls=function(e){libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition||(copy.call(libraryBase.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),libraryBase.jspreadsheet.current.options.editable!=0&&libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map(function(n){return n.element}),"")))},copyControls=function(e){libraryBase.jspreadsheet.current&&copyControls.enabled&&(libraryBase.jspreadsheet.current.edition||copy.call(libraryBase.jspreadsheet.current,!0))},isMac=function(){return navigator.platform.toUpperCase().indexOf("MAC")>=0},isCtrl=function(e){return isMac()?e.metaKey:e.ctrlKey},keyDownControls=function(e){if(libraryBase.jspreadsheet.current){if(libraryBase.jspreadsheet.current.edition)if(e.which==27)libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!1),e.preventDefault();else if(e.which==13){if(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="calendar")closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else if(!(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="dropdown"))if((libraryBase.jspreadsheet.current.options.wordWrap==1||libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].wordWrap==1||libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]].length>200)&&e.altKey){const n=libraryBase.jspreadsheet.current.edition[0].children[0];let t=libraryBase.jspreadsheet.current.edition[0].children[0].value;const s=n.selectionStart;t=t.slice(0,s)+`
`+t.slice(s),n.value=t,n.focus(),n.selectionStart=s+1,n.selectionEnd=s+1}else libraryBase.jspreadsheet.current.edition[0].children[0].blur()}else e.which==9&&(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type)?closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0):libraryBase.jspreadsheet.current.edition[0].children[0].blur());if(!libraryBase.jspreadsheet.current.edition&&libraryBase.jspreadsheet.current.selectedCell)if(e.which==37)left.call(libraryBase.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==39)right.call(libraryBase.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==38)up.call(libraryBase.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==40)down.call(libraryBase.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==36)first.call(libraryBase.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==35)last.call(libraryBase.jspreadsheet.current,e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==46||e.which==8)libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedRow!=null?libraryBase.jspreadsheet.current.options.allowDeleteRow!=0&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&libraryBase.jspreadsheet.current.deleteRow():libraryBase.jspreadsheet.current.selectedHeader?libraryBase.jspreadsheet.current.options.allowDeleteColumn!=0&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&libraryBase.jspreadsheet.current.deleteColumn():libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map(function(n){return n.element}),""));else if(e.which==13)e.shiftKey?up.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertRow!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertRow!=0&&libraryBase.jspreadsheet.current.selectedCell[1]==libraryBase.jspreadsheet.current.options.data.length-1&&libraryBase.jspreadsheet.current.insertRow(),down.call(libraryBase.jspreadsheet.current)),e.preventDefault();else if(e.which==9)e.shiftKey?left.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertColumn!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertColumn!=0&&libraryBase.jspreadsheet.current.selectedCell[0]==libraryBase.jspreadsheet.current.options.data[0].length-1&&libraryBase.jspreadsheet.current.insertColumn(),right.call(libraryBase.jspreadsheet.current)),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(libraryBase.jspreadsheet.current.selectedCell&&libraryBase.jspreadsheet.current.options.editable!=0){const n=libraryBase.jspreadsheet.current.selectedCell[1],t=libraryBase.jspreadsheet.current.selectedCell[0];e.keyCode==32?(e.preventDefault(),libraryBase.jspreadsheet.current.options.columns[t].type=="checkbox"||libraryBase.jspreadsheet.current.options.columns[t].type=="radio"?setCheckRadioValue.call(libraryBase.jspreadsheet.current):openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[n][t].element,!0,e)):e.keyCode==113?openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[n][t].element,!1,e):e.key.length!==1&&e.key!=="Process"||e.altKey||isCtrl(e)||(openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[n][t].element,!0,e),libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[t]&&libraryBase.jspreadsheet.current.options.columns[t].type=="calendar"&&e.preventDefault())}}else e.which==65?(selection.Ub.call(libraryBase.jspreadsheet.current),e.preventDefault()):e.which==83?(libraryBase.jspreadsheet.current.download(),e.preventDefault()):e.which==89?(libraryBase.jspreadsheet.current.redo(),e.preventDefault()):e.which==90?(libraryBase.jspreadsheet.current.undo(),e.preventDefault()):e.which==67?(copy.call(libraryBase.jspreadsheet.current,!0),e.preventDefault()):e.which==88?(libraryBase.jspreadsheet.current.options.editable!=0?cutControls():copyControls(),e.preventDefault()):e.which==86&&pasteControls();else e.target.classList.contains("jss_search")&&(libraryBase.jspreadsheet.timeControl&&clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=setTimeout(function(){libraryBase.jspreadsheet.current.search(e.target.value)},200))}},wheelControls=function(e){const n=this;n.options.lazyLoading==1&&libraryBase.jspreadsheet.timeControlLoading==null&&(libraryBase.jspreadsheet.timeControlLoading=setTimeout(function(){n.content.scrollTop+n.content.clientHeight>=n.content.scrollHeight-10?lazyLoading.p6.call(n)&&(n.content.scrollTop+n.content.clientHeight>n.content.scrollHeight-10&&(n.content.scrollTop=n.content.scrollTop-n.content.clientHeight),selection.Aq.call(n)):n.content.scrollTop<=n.content.clientHeight&&lazyLoading.G_.call(n)&&(n.content.scrollTop<10&&(n.content.scrollTop=n.content.scrollTop+n.content.clientHeight),selection.Aq.call(n)),libraryBase.jspreadsheet.timeControlLoading=null},100))};let scrollLeft=0;const updateFreezePosition=function(){const e=this;scrollLeft=e.content.scrollLeft;let n=0;if(scrollLeft>50)for(let t=0;t<e.options.freezeColumns;t++){if(t>0&&(!e.options.columns||!e.options.columns[t-1]||e.options.columns[t-1].type!=="hidden")){let s;s=e.options.columns&&e.options.columns[t-1]&&e.options.columns[t-1].width!==void 0?parseInt(e.options.columns[t-1].width):e.options.defaultColWidth!==void 0?parseInt(e.options.defaultColWidth):100,n+=parseInt(s)}e.headers[t].classList.add("jss_freezed"),e.headers[t].style.left=n+"px";for(let s=0;s<e.rows.length;s++)if(e.rows[s]&&e.records[s][t]){const o=scrollLeft+(t>0?e.records[s][t-1].element.style.width:0)-51+"px";e.records[s][t].element.classList.add("jss_freezed"),e.records[s][t].element.style.left=o}}else for(let t=0;t<e.options.freezeColumns;t++){e.headers[t].classList.remove("jss_freezed"),e.headers[t].style.left="";for(let s=0;s<e.rows.length;s++)e.records[s][t]&&(e.records[s][t].element.classList.remove("jss_freezed"),e.records[s][t].element.style.left="")}selection.Aq.call(e)},scrollControls=function(e){const n=this;wheelControls.call(n),n.options.freezeColumns>0&&n.content.scrollLeft!=scrollLeft&&updateFreezePosition.call(n),n.options.lazyLoading!=1&&n.options.tableOverflow!=1||n.edition&&e.target.className.substr(0,9)!="jdropdown"&&closeEditor.call(n,n.edition[0],!0)},setEvents=function(e){destroyEvents(e),e.addEventListener("mouseup",mouseUpControls),e.addEventListener("mousedown",mouseDownControls),e.addEventListener("mousemove",mouseMoveControls),e.addEventListener("mouseover",mouseOverControls),e.addEventListener("dblclick",doubleClickControls),e.addEventListener("paste",pasteControls),e.addEventListener("contextmenu",contextMenuControls),e.addEventListener("touchstart",touchStartControls),e.addEventListener("touchend",touchEndControls),e.addEventListener("touchcancel",touchEndControls),e.addEventListener("touchmove",touchEndControls),document.addEventListener("keydown",keyDownControls)},destroyEvents=function(e){e.removeEventListener("mouseup",mouseUpControls),e.removeEventListener("mousedown",mouseDownControls),e.removeEventListener("mousemove",mouseMoveControls),e.removeEventListener("mouseover",mouseOverControls),e.removeEventListener("dblclick",doubleClickControls),e.removeEventListener("paste",pasteControls),e.removeEventListener("contextmenu",contextMenuControls),e.removeEventListener("touchstart",touchStartControls),e.removeEventListener("touchend",touchEndControls),e.removeEventListener("touchcancel",touchEndControls),document.removeEventListener("keydown",keyDownControls)};var toolbar=__webpack_require__(392),pagination=__webpack_require__(167);const setData=function(e){const n=this;if(e&&(n.options.data=e),n.options.data||(n.options.data=[]),n.options.data&&n.options.data[0]&&!Array.isArray(n.options.data[0])){e=[];for(let d=0;d<n.options.data.length;d++){const b=[];for(let m=0;m<n.options.columns.length;m++)b[m]=n.options.data[d][n.options.columns[m].name];e.push(b)}n.options.data=e}let t=0,s=0;const o=n.options.columns&&n.options.columns.length||0,r=n.options.data.length,a=n.options.minDimensions[0],l=n.options.minDimensions[1],c=a>o?a:o,u=l>r?l:r;for(t=0;t<u;t++)for(s=0;s<c;s++)n.options.data[t]==null&&(n.options.data[t]=[]),n.options.data[t][s]==null&&(n.options.data[t][s]="");let h,C;for(n.rows=[],n.results=null,n.records=[],n.history=[],n.historyIndex=-1,n.tbody.innerHTML="",n.options.lazyLoading==1?(h=0,C=n.options.data.length<100?n.options.data.length:100,n.options.pagination&&(n.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):n.options.pagination?(n.pageNumber||(n.pageNumber=0),n.options.pagination,h=n.options.pagination*n.pageNumber,C=n.options.pagination*n.pageNumber+n.options.pagination,n.options.data.length<C&&(C=n.options.data.length)):(h=0,C=n.options.data.length),t=0;t<n.options.data.length;t++){const d=createRow.call(n,t,n.options.data[t]);t>=h&&t<C&&n.tbody.appendChild(d.element)}if(n.options.lazyLoading==1||n.options.pagination&&pagination.IV.call(n),n.options.mergeCells){const d=Object.keys(n.options.mergeCells);for(let b=0;b<d.length;b++){const m=n.options.mergeCells[d[b]];merges.FU.call(n,d[b],m[0],m[1],1)}}internal.am.call(n)},getValue=function(e,n){const t=this;let s,o;if(typeof e!="string")return null;s=(e=(0,internalHelpers.vu)(e,!0))[0],o=e[1];let r=null;return s!=null&&o!=null&&(t.records[o]&&t.records[o][s]&&n?r=t.records[o][s].element.innerHTML:t.options.data[o]&&t.options.data[o][s]!="undefined"&&(r=t.options.data[o][s])),r},getValueFromCoords=function(e,n,t){const s=this;let o=null;return e!=null&&n!=null&&(s.records[n]&&s.records[n][e]&&t?o=s.records[n][e].element.innerHTML:s.options.data[n]&&s.options.data[n][e]!="undefined"&&(o=s.options.data[n][e])),o},setValue=function(e,n,t){const s=this,o=[];if(typeof e=="string"){const a=(0,internalHelpers.vu)(e,!0),l=a[0],c=a[1];o.push(internal.k9.call(s,l,c,n,t)),internal.xF.call(s,l,c,o)}else{let a=null,l=null;if(e&&e.getAttribute&&(a=e.getAttribute("data-x"),l=e.getAttribute("data-y")),a!=null&&l!=null)o.push(internal.k9.call(s,a,l,n,t)),internal.xF.call(s,a,l,o);else{const c=Object.keys(e);if(c.length>0)for(let u=0;u<c.length;u++){let h,C;if(typeof e[u]=="string"){const d=(0,internalHelpers.vu)(e[u],!0);h=d[0],C=d[1]}else e[u].x!=null&&e[u].y!=null?(h=e[u].x,C=e[u].y,e[u].value!=null&&(n=e[u].value)):(h=e[u].getAttribute("data-x"),C=e[u].getAttribute("data-y"));h!=null&&C!=null&&(o.push(internal.k9.call(s,h,C,n,t)),internal.xF.call(s,h,C,o))}}}utils_history.Dh.call(s,{action:"setValue",records:o,selection:s.selectedCell}),internal.am.call(s);const r=o.map(function(a){return{x:a.x,y:a.y,value:a.value,oldValue:a.oldValue}});dispatch.A.call(s,"onafterchanges",s,r)},setValueFromCoords=function(e,n,t,s){const o=this,r=[];r.push(internal.k9.call(o,e,n,t,s)),internal.xF.call(o,e,n,r),utils_history.Dh.call(o,{action:"setValue",records:r,selection:o.selectedCell}),internal.am.call(o);const a=r.map(function(l){return{x:l.x,y:l.y,value:l.value,oldValue:l.oldValue}});dispatch.A.call(o,"onafterchanges",o,a)},getData=function(e,n,t,s){const o=this,r=[];let a=0,l=0;const c=Math.max(...o.options.data.map(function(h){return h.length})),u=o.options.data.length;for(let h=0;h<u;h++){a=0;for(let C=0;C<c;C++)e&&!o.records[h][C].element.classList.contains("highlight")||(r[l]||(r[l]=[]),r[l][a]=n?o.records[h][C].element.innerHTML:o.options.data[h][C],a++);a>0&&l++}return t?r.map(function(h){return h.join(t)}).join(`\r
`)+`\r
`:s?r.map(function(h){const C={};return h.forEach(function(d,b){C[b]=d}),C}):r},getDataFromRange=function(e,n){const t=this,s=(0,helpers.getCoordsFromRange)(e),o=[];for(let r=s[1];r<=s[3];r++){o.push([]);for(let a=s[0];a<=s[2];a++)n?o[o.length-1].push(t.records[r][a].element.innerHTML):o[o.length-1].push(t.options.data[r][a])}return o},search=function(e){const n=this;if(n.options.filters&&filter.dr.call(n),n.resetSelection(),n.pageNumber=0,n.results=[],e){n.searchInput.value!==e&&(n.searchInput.value=e);const t=function(r,a,l){for(let c=0;c<r.length;c++)if((""+r[c]).toLowerCase().search(a)>=0||(""+n.records[l][c].element.innerHTML).toLowerCase().search(a)>=0)return!0;return!1},s=function(r){n.results.indexOf(r)==-1&&n.results.push(r)};let o=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");o=new RegExp(o,"i"),n.options.data.forEach(function(r,a){if(t(r,o,a)){const l=merges.D0.call(n,a);if(l.length)for(let c=0;c<l.length;c++){const u=(0,internalHelpers.vu)(l[c],!0);for(let h=0;h<n.options.mergeCells[l[c]][1];h++)s(u[1]+h)}else s(a)}})}else n.results=null;internal.hG.call(n)},resetSearch=function(){const e=this;e.searchInput.value="",e.search(""),e.results=null},getHeader=function(e){return this.headers[e].textContent},getHeaders=function(e){const n=this,t=[];for(let s=0;s<n.headers.length;s++)t.push(n.getHeader(s));return e?t:t.join(n.options.csvDelimiter)},setHeader=function(e,n){const t=this;if(t.headers[e]){const s=t.headers[e].textContent,o=t.options.columns&&t.options.columns[e]&&t.options.columns[e].title||"";n||(n=(0,helpers.getColumnName)(e)),t.headers[e].textContent=n,t.headers[e].setAttribute("title",n),t.options.columns||(t.options.columns=[]),t.options.columns[e]||(t.options.columns[e]={}),t.options.columns[e].title=n,utils_history.Dh.call(t,{action:"setHeader",column:e,oldValue:s,newValue:n}),dispatch.A.call(t,"onchangeheader",t,parseInt(e),n,o)}},getStyle=function(e,n){const t=this;if(e)return e=(0,internalHelpers.vu)(e,!0),n?t.records[e[1]][e[0]].element.style[n]:t.records[e[1]][e[0]].element.getAttribute("style");{const s={},o=t.options.data[0].length,r=t.options.data.length;for(let a=0;a<r;a++)for(let l=0;l<o;l++){const c=n?t.records[a][l].element.style[n]:t.records[a][l].element.getAttribute("style");c&&(s[(0,internalHelpers.t3)([l,a])]=c)}return s}},setStyle=function(e,n,t,s,o){const r=this,a={},l={},c=function(h,C,d){const b=(0,internalHelpers.vu)(h,!0);if(r.records[b[1]]&&r.records[b[1]][b[0]]&&(r.records[b[1]][b[0]].element.classList.contains("readonly")==0||s)){const m=r.records[b[1]][b[0]].element.style[C];m!=d||s?r.records[b[1]][b[0]].element.style[C]=d:(d="",r.records[b[1]][b[0]].element.style[C]=""),l[h]||(l[h]=[]),a[h]||(a[h]=[]),l[h].push([C+":"+m]),a[h].push([C+":"+d])}};if(n&&t)typeof e=="string"&&c(e,n,t);else{const h=Object.keys(e);for(let C=0;C<h.length;C++){let d=e[h[C]];typeof d=="string"&&(d=d.split(";"));for(let b=0;b<d.length;b++)typeof d[b]=="string"&&(d[b]=d[b].split(":")),d[b][0].trim()&&c(h[C],d[b][0].trim(),d[b][1])}}let u=Object.keys(l);for(let h=0;h<u.length;h++)l[u[h]]=l[u[h]].join(";");u=Object.keys(a);for(let h=0;h<u.length;h++)a[u[h]]=a[u[h]].join(";");o||utils_history.Dh.call(r,{action:"setStyle",oldValue:l,newValue:a}),dispatch.A.call(r,"onchangestyle",r,a)},resetStyle=function(e,n){const t=this,s=Object.keys(e);for(let o=0;o<s.length;o++){const r=(0,internalHelpers.vu)(s[o],!0);t.records[r[1]]&&t.records[r[1]][r[0]]&&t.records[r[1]][r[0]].element.setAttribute("style","")}t.setStyle(e,null,null,null,n)},download=function(e,n){const t=this;if(t.parent.config.allowExport==0)console.error("Export not allowed");else{let s="";s+=copy.call(t,!1,t.options.csvDelimiter,!0,e,!0,void 0,n);const o=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,(t.options.csvFileName||t.options.worksheetName)+".csv");else{const r=document.createElement("a");r.setAttribute("target","_top");const a=URL.createObjectURL(o);r.href=a,r.setAttribute("download",(t.options.csvFileName||t.options.worksheetName)+".csv"),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}}},getComments=function(e){const n=this;if(e)return typeof e!="string"?getComments.call(n):(e=(0,internalHelpers.vu)(e,!0),n.records[e[1]][e[0]].element.getAttribute("title")||"");{const t={};for(let s=0;s<n.options.data.length;s++)for(let o=0;o<n.options.columns.length;o++){const r=n.records[s][o].element.getAttribute("title");r&&(t[(0,internalHelpers.t3)([o,s])]=r)}return t}},setComments=function(e,n){const t=this;let s;s=typeof e=="string"?{[e]:n}:e;const o={};Object.entries(s).forEach(function([r,a]){const l=(0,helpers.getCoordsFromCellName)(r);o[r]=t.records[l[1]][l[0]].element.getAttribute("title"),t.records[l[1]][l[0]].element.setAttribute("title",a||""),a?(t.records[l[1]][l[0]].element.classList.add("jss_comments"),t.options.comments||(t.options.comments={}),t.options.comments[r]=a):(t.records[l[1]][l[0]].element.classList.remove("jss_comments"),t.options.comments&&t.options.comments[r]&&delete t.options.comments[r])}),utils_history.Dh.call(t,{action:"setComments",newValue:s,oldValue:o}),dispatch.A.call(t,"oncomments",t,s,o)};var orderBy=__webpack_require__(94);const getWorksheetConfig=function(){return this.options},getSpreadsheetConfig=function(){return this.config},setConfig=function(e,n){const t=this,s=Object.keys(e);let o;t.parent?o=t.parent:(n=!0,o=t),s.forEach(function(r){n?(o.config[r]=e[r],r==="toolbar"&&(e[r]===!0?o.showToolbar():e[r]===!1&&o.hideToolbar())):t.options[r]=e[r]})};var meta=__webpack_require__(654);const setReadOnly=function(e,n){const t=this;let s;if(typeof e=="string"){const o=(0,helpers.getCoordsFromCellName)(e);s=t.records[o[1]][o[0]]}else{const o=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y"));s=t.records[r][o]}n?s.element.classList.add("readonly"):s.element.classList.remove("readonly")},isReadOnly=function(e,n){return typeof e=="string"&&n===void 0&&([e,n]=(0,helpers.getCoordsFromCellName)(e)),this.records[n][e].element.classList.contains("readonly")},setWorksheetFunctions=function(e){for(let n=0;n<worksheetPublicMethodsLength;n++){const[t,s]=worksheetPublicMethods[n];e[t]=s.bind(e)}},createTable=function(){let e=this;setWorksheetFunctions(e),e.table=document.createElement("table"),e.thead=document.createElement("thead"),e.tbody=document.createElement("tbody"),e.headers=[],e.cols=[],e.content=document.createElement("div"),e.content.classList.add("jss_content"),e.content.onscroll=function(C){scrollControls.call(e,C)},e.content.onwheel=function(C){wheelControls.call(e,C)};const n=document.createElement("div"),t=document.createElement("label");t.innerHTML=jSuites.translate("Search")+": ",n.appendChild(t),e.searchInput=document.createElement("input"),e.searchInput.classList.add("jss_search"),t.appendChild(e.searchInput),e.searchInput.onfocus=function(){e.resetSelection()};const s=document.createElement("div");if(e.options.pagination>0&&e.options.paginationOptions&&e.options.paginationOptions.length>0){e.paginationDropdown=document.createElement("select"),e.paginationDropdown.classList.add("jss_pagination_dropdown"),e.paginationDropdown.onchange=function(){e.options.pagination=parseInt(this.value),e.page(0)};for(let C=0;C<e.options.paginationOptions.length;C++){const d=document.createElement("option");d.value=e.options.paginationOptions[C],d.innerHTML=e.options.paginationOptions[C],e.paginationDropdown.appendChild(d)}e.paginationDropdown.value=e.options.pagination,s.appendChild(document.createTextNode(jSuites.translate("Show "))),s.appendChild(e.paginationDropdown),s.appendChild(document.createTextNode(jSuites.translate("entries")))}const o=document.createElement("div");o.classList.add("jss_filter"),o.appendChild(s),o.appendChild(n),e.colgroupContainer=document.createElement("colgroup");let r=document.createElement("col");if(r.setAttribute("width","50"),e.colgroupContainer.appendChild(r),e.options.nestedHeaders&&e.options.nestedHeaders.length>0&&e.options.nestedHeaders[0]&&e.options.nestedHeaders[0][0])for(let C=0;C<e.options.nestedHeaders.length;C++)e.thead.appendChild(internal.ju.call(e,e.options.nestedHeaders[C]));e.headerContainer=document.createElement("tr"),r=document.createElement("td"),r.classList.add("jss_selectall"),e.headerContainer.appendChild(r);const a=getNumberOfColumns.call(e);for(let C=0;C<a;C++)createCellHeader.call(e,C),e.headerContainer.appendChild(e.headers[C]),e.colgroupContainer.appendChild(e.cols[C].colElement);if(e.thead.appendChild(e.headerContainer),e.options.filters==1){e.filter=document.createElement("tr");const C=document.createElement("td");e.filter.appendChild(C);for(let d=0;d<e.options.columns.length;d++){const b=document.createElement("td");b.innerHTML="&nbsp;",b.setAttribute("data-x",d),b.className="jss_column_filter",e.options.columns[d].type=="hidden"&&(b.style.display="none"),e.filter.appendChild(b)}e.thead.appendChild(e.filter)}e.table=document.createElement("table"),e.table.classList.add("jss_worksheet"),e.table.setAttribute("cellpadding","0"),e.table.setAttribute("cellspacing","0"),e.table.setAttribute("unselectable","yes"),e.table.appendChild(e.colgroupContainer),e.table.appendChild(e.thead),e.table.appendChild(e.tbody),e.options.textOverflow||e.table.classList.add("jss_overflow"),e.corner=document.createElement("div"),e.corner.className="jss_corner",e.corner.setAttribute("unselectable","on"),e.corner.setAttribute("onselectstart","return false"),e.options.selectionCopy==0&&(e.corner.style.display="none"),e.textarea=document.createElement("textarea"),e.textarea.className="jss_textarea",e.textarea.id="jss_textarea",e.textarea.tabIndex="-1",e.textarea.ariaHidden="true";const l=document.createElement("a");l.setAttribute("href","https://bossanova.uk/jspreadsheet/"),e.ads=document.createElement("div"),e.ads.className="jss_about";const c=document.createElement("span");c.innerHTML="Jspreadsheet CE",l.appendChild(c),e.ads.appendChild(l),document.createElement("div").classList.add("jss_table"),e.pagination=document.createElement("div"),e.pagination.classList.add("jss_pagination");const u=document.createElement("div"),h=document.createElement("div");if(e.pagination.appendChild(u),e.pagination.appendChild(h),e.options.pagination||(e.pagination.style.display="none"),e.options.search==1&&e.element.appendChild(o),e.content.appendChild(e.table),e.content.appendChild(e.corner),e.content.appendChild(e.textarea),e.element.appendChild(e.content),e.element.appendChild(e.pagination),e.element.appendChild(e.ads),e.element.classList.add("jss_container"),e.element.jssWorksheet=e,e.element.jspreadsheet=e,e.options.tableOverflow==1&&(e.options.tableHeight&&(e.content.style["overflow-y"]="auto",e.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",e.content.style.maxHeight=typeof e.options.tableHeight=="string"?e.options.tableHeight:e.options.tableHeight+"px"),e.options.tableWidth&&(e.content.style["overflow-x"]="auto",e.content.style.width=typeof e.options.tableWidth=="string"?e.options.tableWidth:e.options.tableWidth+"px")),e.options.tableOverflow!=1&&e.parent.config.toolbar&&e.element.classList.add("with-toolbar"),e.options.columnDrag!=0&&e.thead.classList.add("draggable"),e.options.columnResize!=0&&e.thead.classList.add("resizable"),e.options.rowDrag!=0&&e.tbody.classList.add("draggable"),e.options.rowResize!=0&&e.tbody.classList.add("resizable"),e.setData.call(e),e.options.style&&(e.setStyle(e.options.style,null,null,1,1),delete e.options.style),Object.defineProperty(e.options,"style",{enumerable:!0,configurable:!0,get(){return e.getStyle()}}),e.options.comments&&e.setComments(e.options.comments),e.options.classes){const C=Object.keys(e.options.classes);for(let d=0;d<C.length;d++){const b=(0,internalHelpers.vu)(C[d],!0);e.records[b[1]][b[0]].element.classList.add(e.options.classes[C[d]])}}},prepareTable=function(){const e=this;e.options.lazyLoading==1&&e.options.tableOverflow!=1&&e.parent.config.fullscreen!=1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),e.options.lazyLoading=!1),e.options.columns||(e.options.columns=[]);let n,t=e.options.columns.length;if(e.options.data&&e.options.data[0]!==void 0)if(Array.isArray(e.options.data[0])){const o=e.options.data[0].length;o>t&&(t=o)}else n=Object.keys(e.options.data[0]),n.length>t&&(t=n.length);e.options.minDimensions||(e.options.minDimensions=[0,0]),e.options.minDimensions[0]>t&&(t=e.options.minDimensions[0]);const s=[];for(let o=0;o<t;o++)e.options.columns[o]||(e.options.columns[o]={}),!e.options.columns[o].name&&n&&n[o]&&(e.options.columns[o].name=n[o]),e.options.columns[o].type=="dropdown"&&e.options.columns[o].url&&s.push({url:e.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(r){e.options.columns[this.index].source||(e.options.columns[this.index].source=[]);for(let a=0;a<r.length;a++)e.options.columns[this.index].source.push(r[a])}});s.length?jSuites.ajax(s,function(){createTable.call(e)}):createTable.call(e)},getNextDefaultWorksheetName=function(e){const n=/^Sheet(\d+)$/;let t=0;return e.worksheets.forEach(function(s){const o=n.exec(s.options.worksheetName);o&&(t=Math.max(t,parseInt(o[1])))}),"Sheet"+(t+1)},buildWorksheet=async function(){const e=this,n=(e.element,e.parent);typeof n.plugins=="object"&&Object.entries(n.plugins).forEach(function([,s]){typeof s.beforeinit=="function"&&s.beforeinit(e)}),libraryBase.jspreadsheet.current=e;const t=[];if(e.options.csv){const s=new Promise(o=>{jSuites.ajax({url:e.options.csv,method:"GET",dataType:"text",success:function(r){const a=(0,helpers.parseCSV)(r,e.options.csvDelimiter);if(e.options.csvHeaders==1&&a.length>0){const l=a.shift();if(l.length>0){e.options.columns||(e.options.columns=[]);for(let c=0;c<l.length;c++)e.options.columns[c]||(e.options.columns[c]={}),e.options.columns[c].title===void 0&&(e.options.columns[c].title=l[c])}}e.options.data=a,prepareTable.call(e),o()}})});t.push(s)}else if(e.options.url){const s=new Promise(o=>{jSuites.ajax({url:e.options.url,method:"GET",dataType:"json",success:function(r){e.options.data=r.data?r.data:r,prepareTable.call(e),o()}})});t.push(s)}else prepareTable.call(e);await Promise.all(t),typeof n.plugins=="object"&&Object.entries(n.plugins).forEach(function([,s]){typeof s.init=="function"&&s.init(e)})},createWorksheetObj=function(e){const n=this.parent;e.worksheetName||(e.worksheetName=getNextDefaultWorksheetName(this.parent));const t={parent:n,options:e,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return n.config.worksheets.push(t.options),n.worksheets.push(t),t},createWorksheet=function(e){const n=this.parent;n.creationThroughJss=!0,createWorksheetObj.call(this,e),n.element.tabs.create(e.worksheetName)},openWorksheet=function(e){this.parent.element.tabs.open(e)},deleteWorksheet=function(e){const n=this;n.parent.element.tabs.remove(e);const t=n.parent.worksheets.splice(e,1)[0];dispatch.A.call(n.parent,"ondeleteworksheet",t,e)},worksheetPublicMethods=[["selectAll",selection.Ub],["updateSelectionFromCoords",function(e,n,t,s){return selection.AH.call(this,e,n,t,s)}],["resetSelection",function(){return selection.gE.call(this)}],["getSelection",selection.Lo],["getSelected",selection.ef],["getSelectedColumns",selection.Jg],["getSelectedRows",selection.R5],["getData",getData],["setData",setData],["getValue",getValue],["getValueFromCoords",getValueFromCoords],["setValue",setValue],["setValueFromCoords",setValueFromCoords],["getWidth",getWidth],["setWidth",function(e,n){return setWidth.call(this,e,n)}],["insertRow",insertRow],["moveRow",function(e,n){return moveRow.call(this,e,n)}],["deleteRow",deleteRow],["hideRow",hideRow],["showRow",showRow],["getRowData",getRowData],["setRowData",setRowData],["getHeight",getHeight],["setHeight",function(e,n){return setHeight.call(this,e,n)}],["getMerge",merges.fd],["setMerge",function(e,n,t){return merges.FU.call(this,e,n,t)}],["destroyMerge",function(){return merges.VP.call(this)}],["removeMerge",function(e,n){return merges.Zp.call(this,e,n)}],["search",search],["resetSearch",resetSearch],["getHeader",getHeader],["getHeaders",getHeaders],["setHeader",setHeader],["getStyle",getStyle],["setStyle",function(e,n,t,s){return setStyle.call(this,e,n,t,s)}],["resetStyle",resetStyle],["insertColumn",insertColumn],["moveColumn",moveColumn],["deleteColumn",deleteColumn],["getColumnData",getColumnData],["setColumnData",setColumnData],["whichPage",pagination.ho],["page",pagination.MY],["download",download],["getComments",getComments],["setComments",setComments],["orderBy",orderBy.My],["undo",utils_history.tN],["redo",utils_history.ZS],["getCell",internal.tT],["getCellFromCoords",internal.Xr],["getLabel",internal.p9],["getConfig",getWorksheetConfig],["setConfig",setConfig],["getMeta",function(e){return meta.IQ.call(this,e)}],["setMeta",meta.iZ],["showColumn",showColumn],["hideColumn",hideColumn],["showIndex",internal.C6],["hideIndex",internal.TI],["getWorksheetActive",internal.$O],["openEditor",openEditor],["closeEditor",closeEditor],["createWorksheet",createWorksheet],["openWorksheet",openWorksheet],["deleteWorksheet",deleteWorksheet],["copy",function(e){e?cutControls():copy.call(this,!0)}],["paste",paste],["executeFormula",internal.Em],["getDataFromRange",getDataFromRange],["quantiyOfPages",pagination.$f],["getRange",selection.eO],["isSelected",selection.sp],["setReadOnly",setReadOnly],["isReadOnly",isReadOnly],["getHighlighted",selection.kV],["dispatch",dispatch.A],["down",down],["first",first],["last",last],["left",left],["right",right],["up",up],["openFilter",filter.N$],["resetFilters",filter.dr]],worksheetPublicMethodsLength=worksheetPublicMethods.length,factory=function(){},createWorksheets=async function(e,n,t){let s=n.worksheets;if(!s)throw new Error("JSS: worksheets are not defined");{let o={animation:!0,onbeforecreate:function(c,u){return u||getNextDefaultWorksheetName(e)},oncreate:function(c,u){if(e.creationThroughJss)e.creationThroughJss=!1;else{const C=c.tabs.headers.children[c.tabs.headers.children.length-2].innerHTML;createWorksheetObj.call(e.worksheets[0],{minDimensions:[10,15],worksheetName:C})}const h=e.worksheets[e.worksheets.length-1];h.element=u,buildWorksheet.call(h).then(function(){(0,toolbar.nK)(h),dispatch.A.call(h,"oncreateworksheet",h,n,e.worksheets.length-1)})},onchange:function(c,u,h){e.worksheets.length!=0&&e.worksheets[h]&&(0,toolbar.nK)(e.worksheets[h])}};n.tabs==1?o.allowCreate=!0:o.hideHeaders=!0,o.data=[];let r=1;for(let c=0;c<s.length;c++)s[c].worksheetName||(s[c].worksheetName="Sheet"+r++),o.data.push({title:s[c].worksheetName,content:""});t.classList.add("jss_spreadsheet"),t.tabIndex=0;const a=jSuites.tabs(t,o),l=n.style;delete n.style;for(let c=0;c<s.length;c++)s[c].style&&Object.entries(s[c].style).forEach(function([u,h]){typeof h=="number"&&(s[c].style[u]=l[h])}),e.worksheets.push({parent:e,element:a.content.children[c],options:s[c],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await buildWorksheet.call(e.worksheets[c])}};factory.spreadsheet=async function(e,n,t){if(e.tagName=="TABLE"){n||(n={}),n.worksheets||(n.worksheets=[]);const o=(0,helpers.createFromTable)(e,n.worksheets[0]);n.worksheets[0]=o;const r=document.createElement("div");e.parentNode.insertBefore(r,e),e.remove(),e=r}let s={worksheets:t,config:n,element:e,el:e};return s.contextMenu=document.createElement("div"),s.contextMenu.className="jss_contextmenu",s.getWorksheetActive=internal.$O.bind(s),s.fullscreen=internal.Y5.bind(s),s.showToolbar=toolbar.ll.bind(s),s.hideToolbar=toolbar.Ar.bind(s),s.getConfig=getSpreadsheetConfig.bind(s),s.setConfig=setConfig.bind(s),s.setPlugins=function(o){s.plugins||(s.plugins={}),typeof o=="object"&&Object.entries(o).forEach(function([r,a]){s.plugins[r]=a.call(libraryBase.jspreadsheet,s,{},s.config)})},s.setPlugins(n.plugins),await createWorksheets(s,n,e),s.element.appendChild(s.contextMenu),jSuites.contextmenu(s.contextMenu,{onclick:function(){s.contextMenu.contextmenu.close(!1)}}),s.config.fullscreen==1&&s.element.classList.add("fullscreen"),toolbar.ll.call(s),n.root?setEvents(n.root):setEvents(document),e.spreadsheet=s,s},factory.worksheet=function(e,n,t){let s={parent:e,options:{}};return t===void 0?e.worksheets.push(s):e.worksheets.splice(t,0,s),Object.assign(s.options,n),s};var utils_factory=factory;libraryBase.jspreadsheet=function(e,n){try{let t=[];return utils_factory.spreadsheet(e,n,t).then(s=>{libraryBase.jspreadsheet.spreadsheet.push(s),dispatch.A.call(s,"onload",s)}),t}catch(t){console.error(t)}},libraryBase.jspreadsheet.getWorksheetInstanceByName=function(e,n){const t=libraryBase.jspreadsheet.spreadsheet.find(s=>s.config.namespace===n);if(t)return{};if(e==null){const s=t.worksheets.map(o=>[o.options.worksheetName,o]);return Object.fromEntries(s)}return t.worksheets.find(s=>s.options.worksheetName===e)},libraryBase.jspreadsheet.setDictionary=function(e){jSuites.setDictionary(e)},libraryBase.jspreadsheet.destroy=function(e,n){if(e.spreadsheet){const t=libraryBase.jspreadsheet.spreadsheet.indexOf(e.spreadsheet);libraryBase.jspreadsheet.spreadsheet.splice(t,1);const s=e.spreadsheet.config.root||document;e.spreadsheet=null,e.innerHTML="",n&&destroyEvents(s)}},libraryBase.jspreadsheet.destroyAll=function(){for(let e=0;e<libraryBase.jspreadsheet.spreadsheet.length;e++){const n=libraryBase.jspreadsheet.spreadsheet[e];libraryBase.jspreadsheet.destroy(n.element)}},libraryBase.jspreadsheet.current=null,libraryBase.jspreadsheet.spreadsheet=[],libraryBase.jspreadsheet.helpers={},libraryBase.jspreadsheet.version=function(){return version},Object.entries(helpers).forEach(([e,n])=>{libraryBase.jspreadsheet.helpers[e]=n});var src=libraryBase.jspreadsheet;jspreadsheet=__webpack_exports__.default})(),jspreadsheet}))})(dist$1)),dist$1.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports);export{jspreadsheet as j};
//# sourceMappingURL=jspreadsheet-ce-kKqtlqR-.js.map
