class k extends HTMLElement{constructor(){super(),this._shape="disk",this._filled=1,this._total=4,this._color="#5faedd",this._showFilledSlider=!1,this._borderMode="all",this._showPartNumbers=!1,this._showLabels=!1,this._labelStart=0,this._labelValues="",this._sliderMax=this.total,this._borderCount=0,this.previousFilled=!1,this._style=document.createElement("style"),this._wrapper=document.createElement("div"),this._wrapper.setAttribute("class","wrapper"),this._svgContainer=document.createElement("div"),this._svgContainer.setAttribute("class","svg-container"),this._filledSlider=document.createElement("input"),this._filledSlider.type="range",this._filledSlider.className="filled-slider",this._borderSlider=document.createElement("input"),this._borderSlider.type="range",this._borderSlider.className="border-slider",this._borderSlider.min="0",this._borderSlider.value="0",this._borderSlider.step="1",this._borderSlider.style.marginTop="0.5em",this._wrapper.append(this._svgContainer,this._filledSlider,this._borderSlider),this.append(this._style,this._wrapper)}static get observedAttributes(){return["shape","filled","total","show-filled-slider","border-mode","show-part-numbers","show-labels","label-start","label-unit-parts","label-values","slider-max-input","border-count"]}connectedCallback(){this._setupStyles(),this._setupSliderListener(),this._setupBorderSliderListener(),this._syncPropsFromAttributes(),this._render()}_syncPropsFromAttributes(){this.shape=this.getAttribute("shape")||this._shape,this.filled=parseInt(this.getAttribute("filled")||this._filled.toString(),10),this.total=parseInt(this.getAttribute("total")||this._total.toString(),10),this.showFilledSlider=this.hasAttribute("show-filled-slider"),this.sliderMax=parseInt(this.getAttribute("slider-max-input")||this._sliderMax.toString(),10),this.borderMode=this.getAttribute("border-mode")||this._borderMode,this.borderCount=parseInt(this.getAttribute("border-count")||this._borderCount.toString(),10),this.showPartNumbers=this.hasAttribute("show-part-numbers"),this.showLabels=this.hasAttribute("show-labels"),this.labelStart=parseFloat(this.getAttribute("label-start")||this._labelStart.toString()),this.labelValues=this.getAttribute("label-values")||this._labelValues}attributeChangedCallback(t,r,a){if(r!==a)switch(t){case"shape":this.shape=a;break;case"filled":this.filled=parseInt(a,10);break;case"total":this.total=parseInt(a,10);break;case"show-filled-slider":this.showFilledSlider=a!==null;break;case"border-mode":this.borderMode=a;break;case"border-count":this.borderCount=parseInt(a,10);break;case"show-part-numbers":this.showPartNumbers=a!==null;break;case"show-labels":this.showLabels=a!==null;break;case"label-start":this.labelStart=parseFloat(a);break;case"label-values":this.labelValues=a;break;case"slider-max-input":this.sliderMax=parseInt(a,10);break}}get shape(){return this._shape}set shape(t){this._shape!==t&&(this._shape=t,this.setAttribute("shape",t),this._render())}get filled(){return this._filled}set filled(t){const r=Math.max(0,t);this._filled!==r&&(this._filled=r,this.setAttribute("filled",r.toString()),this._render())}get total(){return this._total}set total(t){const r=Math.max(1,t);this._total!==r&&(this._total=r,this.setAttribute("total",r.toString()),this._render())}get showFilledSlider(){return this._showFilledSlider}set showFilledSlider(t){this._showFilledSlider!==t&&(this._showFilledSlider=t,t?this.setAttribute("show-filled-slider",""):this.removeAttribute("show-filled-slider"),this._render())}get sliderMax(){return this._sliderMax}set sliderMax(t){this._sliderMax!==t&&(this._sliderMax=t,this.setAttribute("slider-max-input",t.toString()),this._render())}get borderMode(){return this._borderMode}set borderMode(t){this._borderMode!==t&&(this._borderMode=t,this.setAttribute("border-mode",t),this._render())}get borderCount(){return this._borderCount}set borderCount(t){const r=Math.max(0,t);this._borderCount!==r&&(this._borderCount=r,this.setAttribute("border-count",r.toString()),this._render())}get showPartNumbers(){return this._showPartNumbers}set showPartNumbers(t){this._showPartNumbers!==t&&(this._showPartNumbers=t,t?this.setAttribute("show-part-numbers",""):this.removeAttribute("show-part-numbers"),this._render())}get showLabels(){return this._showLabels}set showLabels(t){this._showLabels!==t&&(this._showLabels=t,t?this.setAttribute("show-labels",""):this.removeAttribute("show-labels"),this._render())}get labelStart(){return this._labelStart}set labelStart(t){this._labelStart!==t&&(this._labelStart=t,this.setAttribute("label-start",t.toString()),this._render())}get labelValues(){return this._labelValues}set labelValues(t){this._labelValues!==t&&(this._labelValues=t,this.setAttribute("label-values",t),this._render())}_setupStyles(){this._style.textContent=`
  fraction-visualizer {
    display: inline-block;
    width: auto;
    height: auto;
    min-height: 7.5em;
    border: none;
    padding: 0.625em;
    font-family: sans-serif;
  }
  fraction-visualizer .wrapper {
    display: flex;
    flex-direction: column;
    align-items: start;
    justify-content: center;
    width: 100%;
    height: 100%;
    gap: 0.625em;
  }
  fraction-visualizer .svg-container {
    flex-grow: 1;
    display: flex;
    flex-wrap: wrap;
    gap: 1em;
    align-items: start;
    justify-content: center;
  }

  fraction-visualizer input[type="range"], fraction-visualizer input[type="range"]:focus {
    flex-shrink: 0;
    width: 10em;
    -webkit-appearance: none;
    appearance: none;
    background: transparent;
    cursor: pointer;
    accent-color: #f15929;
    outline: none;
  }
  fraction-visualizer input[type="range"].hidden {
    display: none;
  }

  /* Webkit (Chrome, Safari, Edge) */
  fraction-visualizer input[type="range"]::-webkit-slider-thumb, fraction-visualizer input[type="range"]:focus::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    background: #f15929;
    margin-top: -0.375em; /* Centrer sur la piste */
  }
  fraction-visualizer input[type="range"]::-webkit-slider-runnable-track, fraction-visualizer input[type="range"]:focus::-webkit-slider-runnable-track {
    width: 100%;
    height: 0.25em;
    background: #ccc;
    border-radius: 0.125em;
  }

  /* Firefox */
  fraction-visualizer input[type="range"]::-moz-range-thumb, input[type="range"]:focus::-moz-range-thumb {
    height: 1em;
    width: 1em;
    border-radius: 50%;
    background: #f15929;
    border: none;
  }
  fraction-visualizer input[type="range"]::-moz-range-track, input[type="range"]:focus::-moz-range-track {
    width: 100%;
    height: 0.25em;
    background: #ccc;
    border-radius: 0.125em;
  }
  fraction-visualizer input[type="range"]::-moz-range-progress, input[type="range"]:focus::-moz-range-progress {
    background-color: #f47a54;
    height: 0.25em;
    border-radius: 0.125em;
  }
`}_setupSliderListener(){this._filledSlider.addEventListener("input",()=>{const t=parseInt(this._filledSlider.value,10);this.filled=t,this.dispatchEvent(new CustomEvent("fractionChange",{detail:t,bubbles:!0,composed:!0}))})}_setupBorderSliderListener(){this._borderSlider.addEventListener("input",()=>{const t=parseInt(this._borderSlider.value,10);this.borderCount=t,this.dispatchEvent(new CustomEvent("borderCountChange",{detail:t,bubbles:!0,composed:!0}))})}_gcd(t,r){return r===0?t:this._gcd(r,t%r)}_simplifyFraction(t,r){if(r===0)return{num:t,den:0};const a=Math.round(t),l=Math.round(r),i=this._gcd(Math.abs(a),Math.abs(l));return{num:a/i,den:l/i}}_render(){if(!this._svgContainer)return;this._updateFilledSlider(),this._updateBorderSlider(),this._svgContainer.innerHTML="";const t=Math.max(1,this._total),r=Math.max(0,this._filled),a=Math.max(r,this._borderCount);if(this._shape==="bar"||this._shape==="segment"){const i=Math.ceil(Math.max(r,this._borderCount)/t)*t,s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("height","4em");let o=0,e=0;if(this._shape==="bar")e=200/t,o=e*i,s.setAttribute("viewBox",`0 0 ${o} 50`);else{e=180/t,o=e*i+20;const d=this._showLabels?70:50;s.setAttribute("viewBox",`0 0 ${o} ${d}`)}s.setAttribute("preserveAspectRatio","xMidYMid meet"),this._shape==="bar"?this._renderBar(s,r,i,e,t):this._renderSegment(s,r,i,e),this._svgContainer.appendChild(s)}else{const l=Math.max(1,Math.ceil(a/t));for(let i=0;i<l;i++){const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("height","8em");let o=0;const e=i*t;this._filled>e&&(o=Math.min(this._filled-e,t));let d=0;const u=i*t;switch(this._borderCount>u&&(d=Math.min(this._borderCount-u,t)),this._shape==="rectangle"?s.setAttribute("viewBox","0 0 150 100"):s.setAttribute("viewBox","0 0 100 100"),s.setAttribute("preserveAspectRatio","xMidYMid meet"),this._shape){case"disk":this._renderDisk(s,o,d);break;case"rectangle":this._renderSquare(s,o,!0,d);break;default:this._renderSquare(s,o,!1,d);break}this._svgContainer.appendChild(s)}}}_updateFilledSlider(){this._filledSlider.classList.toggle("hidden",!this._showFilledSlider),this._filledSlider.min="0";const t=this._sliderMax>0?this._sliderMax:Math.max(this._total,this._filled);this._filledSlider.max=t.toString(),this._filledSlider.value=this._filled.toString(),this._filledSlider.step="1"}_updateBorderSlider(){const t=this._borderMode==="cursor";this._borderSlider.classList.toggle("hidden",!t);const r=Math.max(this._sliderMax>0?this._sliderMax:this._total,this._borderCount);this._borderSlider.max=r.toString(),this._borderSlider.value=this._borderCount.toString()}_createSvgPart(t,r,a,l){const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",t),i.setAttribute("fill",r?this._color:"none"),i.setAttribute("stroke",this.getStrokeColor(r,a,l)),i.setAttribute("stroke-width","1"),i.setAttribute("vector-effect","non-scaling-stroke"),this.previousFilled=r,i}getStrokeColor(t,r,a){let l=this._color;if(this._borderMode==="none")t||(l="#fff");else if(this._borderMode==="all")l="#000";else if(this._borderMode==="filled")t?l="#000":l="#fff";else if(this._borderMode==="cursor"&&typeof r=="number"){const i=typeof a=="number"?a:this._borderCount;r<i?l="#000":!t&&!this.previousFilled&&(l="#fff")}return l}_createSvgOutline(t){const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",t),r.setAttribute("fill","none"),r.setAttribute("stroke","#000"),r.setAttribute("stroke-width",this._shape==="disk"?"1":this._shape==="bar"?"6":"2"),r.setAttribute("vector-effect","non-scaling-stroke"),r}_renderSegment(t,r,a,l){const s=10+a*l,o=25,e=4,d=12,u=document.createElementNS("http://www.w3.org/2000/svg","line");if(u.setAttribute("x1","10"),u.setAttribute("y1",o.toString()),u.setAttribute("x2",s.toString()),u.setAttribute("y2",o.toString()),u.setAttribute("stroke","#000"),u.setAttribute("stroke-width","1"),t.appendChild(u),r>0){const h=10+r*l,b=document.createElementNS("http://www.w3.org/2000/svg","line");b.setAttribute("x1","10"),b.setAttribute("y1",o.toString()),b.setAttribute("x2",h.toString()),b.setAttribute("y2",o.toString()),b.setAttribute("stroke",this._color),b.setAttribute("stroke-width","3"),t.appendChild(b)}const n=this._labelValues.trim().split(/\s+/).filter(Boolean);for(let h=0;h<=a;h++){const b=10+h*l;let c=!1;this._borderMode==="all"?c=!0:this._borderMode==="filled"?c=h<=r:this._borderMode==="cursor"?c=h<=this._borderCount:this._borderMode==="none"&&(c=h===0||h===a);const _=h===0||h===a,p=h%this._total===0;if((_||p)&&(c=!0),c){const m=h%this._total===0?d:e,$=o-m,A=o+m,g=document.createElementNS("http://www.w3.org/2000/svg","line");if(g.setAttribute("x1",b.toString()),g.setAttribute("y1",$.toString()),g.setAttribute("x2",b.toString()),g.setAttribute("y2",A.toString()),g.setAttribute("stroke","#000"),g.setAttribute("stroke-width","1.5"),g.setAttribute("vector-effect","non-scaling-stroke"),t.appendChild(g),this._showLabels){let w="";if(n.length>0)h<n.length&&(w=n[h]);else{const f=this._labelStart*this._total+h,{num:x,den:M}=this._simplifyFraction(f,this._total);M===1||x===0?w=`${x}`:w=`${x}/${M}`}if(w){const f=document.createElementNS("http://www.w3.org/2000/svg","text");f.setAttribute("x",b.toString()),f.setAttribute("y",(o+d+12).toString()),f.setAttribute("text-anchor","middle"),f.setAttribute("font-size","10"),f.setAttribute("fill","#333"),f.textContent=w,t.appendChild(f)}}h>0&&(this.borderMode==="all"||this.borderMode==="filled"&&h<=r||this.borderMode==="cursor"&&h<=this._borderCount)&&this._addPartNumber(t,b-l/2,o+18,h-1,a)}}}_renderBar(t,r,a,l,i){this.previousFilled=!1;for(let e=a-1;e>=0;e--){const d=e*l,u=e<r,n=`M ${d} 0 L ${d+l} 0 L ${d+l} 50 L ${d} 50 Z`;t.appendChild(this._createSvgPart(n,u,e)),this._addPartNumber(t,d+l/2,50/2,e,a)}const o=l*a;t.appendChild(this._createSvgOutline(`M 0 0 L ${o} 0 L ${o} 50 L 0 50 Z`));for(let e=a;e>0;e--){const d=e*l,u=e%i===0,n=document.createElementNS("http://www.w3.org/2000/svg","line");if(n.setAttribute("x1",d.toString()),n.setAttribute("x2",d.toString()),u)n.setAttribute("stroke","#000"),n.setAttribute("stroke-width","3"),n.setAttribute("y1","0"),n.setAttribute("y2","50");else{if(e===r&&e!==a&&this._borderMode!=="all"&&this._borderMode!=="filled"&&!(this._borderMode==="cursor"&&e<=this._borderCount))continue;n.setAttribute("y1","3"),n.setAttribute("y2","47");let h="#fff",b="1",c="3,3";e<r&&(h=this._color),this._borderMode==="filled"&&e<=r?h=this._color:this._borderMode==="cursor"&&(e<=r?h=this._color:h="#fff"),e===a&&(h=e===r?this._color:"#fff",b="6",c="3,3",n.setAttribute("y1","-3"),n.setAttribute("y2","53")),n.setAttribute("stroke",h),n.setAttribute("stroke-width",b),n.setAttribute("stroke-dasharray",c)}t.appendChild(n)}}_renderSquare(t,r,a,l=0){const i=a?150:100,s=100,o=i/2,e=s/2,d=[],u=`M 0 0 L ${i} 0 L ${i} ${s} L 0 ${s} Z`;switch(this._total){case 1:d.push(`M 0 0 L ${i} 0 L ${i} ${s} L 0 ${s} Z`);break;case 2:d.push(`M 0 0 L ${i} 0 L ${i} ${e} L 0 ${e} Z`),d.push(`M 0 ${e} L ${i} ${e} L ${i} ${s} L 0 ${s} Z`);break;case 4:d.push(`M ${o} 0 L ${i} 0 L ${i} ${e} L ${o} ${e} Z`),d.push(`M ${o} 0 L ${o} ${e} L 0 ${e} L 0 0 Z`),d.push(`M 0 ${e} L ${o} ${e} L ${o} ${s} L 0 ${s} Z`),d.push(`M ${o} ${e} L ${i} ${e} L ${i} ${s} L ${o} ${s} Z`);break;case 8:d.push(`M ${o} ${e} L ${i} 0 L ${i} ${e} Z`),d.push(`M ${o} ${e} L ${o} 0 L ${i} 0 Z`),d.push(`M ${o} ${e} L 0 0 L ${o} 0 Z`),d.push(`M ${o} ${e} L 0 ${e} L 0 0 Z`),d.push(`M ${o} ${e} L 0 ${s} L 0 ${e} Z`),d.push(`M ${o} ${e} L ${o} ${s} L 0 ${s} Z`),d.push(`M ${o} ${e} L ${i} ${s} L ${o} ${s} Z`),d.push(`M ${o} ${e} L ${i} ${e} L ${i} ${s} Z`);break;default:{const n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("x",`${o}`),n.setAttribute("y",`${e}`),n.setAttribute("text-anchor","middle"),n.setAttribute("dominant-baseline","central"),n.setAttribute("font-size","10"),n.textContent=`Total=${this._total} non supportÃ© (1,2,4,8 requis)`,t.appendChild(n)}}this.previousFilled=!1;for(let n=d.length-1;n>=0;n--){const h=d[n],b=n<r;t.appendChild(this._createSvgPart(h,b,n,l));let c=0,_=0;if(this._total===1)c=i/2,_=s/2;else if(this._total===2)c=i/2,_=n===0?s/4:3*s/4;else if(this._total===4){const p=[{x:3*i/4,y:s/4},{x:i/4,y:s/4},{x:i/4,y:3*s/4},{x:3*i/4,y:3*s/4}];c=p[n].x,_=p[n].y}else if(this._total===8){const p=i/2,S=s/2,m=(n*45+22.5)*Math.PI/180;c=p+p*.6*Math.cos(m),_=S-S*.6*Math.sin(m)}this._addPartNumber(t,c,_,n,this._total)}t.appendChild(this._createSvgOutline(u))}_polarToCartesian(t,r,a,l){const i=l*Math.PI/180;return{x:t+a*Math.cos(i),y:r-a*Math.sin(i)}}_renderDisk(t,r,a=0){const l=Math.max(1,this._total),i=Math.min(r,l),s=48,o=50,e=50;if(l===1)t.appendChild(this._createSvgPart("M 50 2 A 48 48 0 1 1 49.99 2 Z",i>=1));else{const u=360/l,n=u>180?"1":"0";this.previousFilled=!1;for(let h=l-1;h>=0;h--){const b=h*u,c=(h+1)*u,_=this._polarToCartesian(o,e,s,b),p=this._polarToCartesian(o,e,s,c),S=`M ${o} ${e} L ${_.x} ${_.y} A ${s} ${s} 0 ${n} 0 ${p.x} ${p.y} Z`,m=h<i;t.appendChild(this._createSvgPart(S,m,h,a));const $=(h+.5)*u,A=this._polarToCartesian(o,e,s*.65,$);this._addPartNumber(t,A.x,A.y,h,l)}}t.appendChild(this._createSvgOutline("M 50 2 A 48 48 0 1 1 49.99 2 Z"))}_addPartNumber(t,r,a,l,i){if(!this._showPartNumbers)return;const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",r.toString()),s.setAttribute("y",a.toString()),s.setAttribute("text-anchor","middle"),s.setAttribute("dominant-baseline","central"),s.setAttribute("font-size",i>8?"10":"14"),s.setAttribute("fill","#333"),s.textContent=(l+1).toString(),t.appendChild(s)}}customElements.define("fraction-visualizer",k);export{k as F};
//# sourceMappingURL=fraction-visualizer-s_FGNqtW.js.map
