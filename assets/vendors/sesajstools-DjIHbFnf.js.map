{"version":3,"file":"sesajstools-DjIHbFnf.js","sources":["../../../node_modules/.pnpm/sesajstools@git+https+++git.sesamath.net+sesamath+sesajstools.git+47c73bf8dc4892229cff930111fc66a1b9abd333/node_modules/sesajstools/index.js","../../../node_modules/.pnpm/sesajstools@git+https+++git.sesamath.net+sesamath+sesajstools.git+47c73bf8dc4892229cff930111fc66a1b9abd333/node_modules/sesajstools/utils/dump.js","../../../node_modules/.pnpm/sesajstools@git+https+++git.sesamath.net+sesamath+sesajstools.git+47c73bf8dc4892229cff930111fc66a1b9abd333/node_modules/sesajstools/utils/log.js","../../../node_modules/.pnpm/sesajstools@git+https+++git.sesamath.net+sesamath+sesajstools.git+47c73bf8dc4892229cff930111fc66a1b9abd333/node_modules/sesajstools/dom/index.js"],"sourcesContent":["/**\n * This file is part of Sesatheque.\n *   Copyright 2014-2015, Association Sésamath\n *\n * Sesatheque is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License version 3\n * as published by the Free Software Foundation.\n *\n * Sesatheque is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Sesatheque (LICENCE.txt).\n * @see http://www.gnu.org/licenses/agpl.txt\n *\n *\n * Ce fichier fait partie de l'application Sésathèque, créée par l'association Sésamath.\n *\n * Sésathèque est un logiciel libre ; vous pouvez le redistribuer ou le modifier suivant\n * les termes de la GNU Affero General Public License version 3 telle que publiée par la\n * Free Software Foundation.\n * Sésathèque est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE,\n * sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER.\n * Consultez la GNU Affero General Public License pour plus de détails.\n * Vous devez avoir reçu une copie de la GNU General Public License en même temps que Sésathèque\n * (cf LICENCE.txt et http://vvlibri.org/fr/Analyse/gnu-affero-general-public-license-v3-analyse\n * pour une explication en français)\n */\n'use strict'\n\n// ajoute du forEach sur les Array si le navigateur connait pas ça\nif (!Array.prototype.forEach) {\n  Array.prototype.forEach = function (fn) { // eslint-disable-line no-extend-native\n    for (var i = 0; i < this.length; i++) {\n      // on passe en argument (eltDuTableau, index, tableau)\n      fn(this[i], i, this)\n    }\n  }\n}\n\nvar specialHtmlChars = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#039;'\n}\n\n/**\n * Retourne le nb de slash dans la string\n * @param {sting} str\n * @return {number} le nombre de slashes dans str\n * @throws {TypeError} Si str n'était pas une string\n */\nfunction countSlash (str) {\n  if (typeof str !== 'string') throw new TypeError('countSlash n’accepte qu’une string en paramètre')\n  return str.replace(/[^/]+/g, '').length\n}\n\n/**\n * Échappe les caractères spéciaux en les remplaçant par leur équivalent html\n * Merci à jbo5112 https://stackoverflow.com/a/4835406\n * cf https://jsperf.com/escape-html-special-chars/11\n * @param {string} str\n * @param {boolean} [all] passer true pour remplacer les 5 caractères \"&<>' (sinon ça ne remplace que <), attention dans ce cas ce n'est plus invariant (il ne faut pas rappeler la fct sur une chaîne qui y serait déjà passée)\n * @return {void|string|*}\n */\nfunction escapeForHtml (str, all) {\n  if (!all) return str.replace(/</g, '&lt;')\n  return str.replace(/[&<>\"']/g, function (char) { return specialHtmlChars[char] })\n}\n\n/**\n * Formate une date, en retournant format avec les %x interprétés (si x est connu, laissé tel quel sinon).\n * Attention, pas la même syntaxe que an-format-date (©arNuméral).\n *\n * Formats gérés comme la commande unix date\n * - %% symbole %\n * - %F YYYY-mm-dd\n * - %T HH:MM:SS\n * - %d jour du mois (01 à 31)\n * - %m n° du mois (01 à 12)\n * - %Y année sur 4 chiffres\n * - %y année sur 2 chiffres\n * - %H heure (00 à 23)/\n * - %M minutes (00 à 59)\n * - %S secondes (00 à 59)\n * - %s timestamp (secondes depuis 01/01/1970/)\n * Formats ajoutés (o était la seule lettre dispo)\n * - %o millisecondes (000 à 999)\n * - %O heure avec ms (idem %T.%o ou %H:%M:%S.%o)\n * @param {string} format\n * @param {Date} [date] La date à formater (now si non fourni)\n * @return {string}\n */\nfunction formatDate (format, date) {\n  function pad0 (val, nb) {\n    return pad(val, '0', nb)\n  }\n  if (!date) date = new Date()\n  else if (!(date instanceof Date)) throw new TypeError('date is not a Date')\n  if (typeof format !== 'string') throw new TypeError('format is not a string')\n  return format.replace(/%(.)/g, function (capture, formatChar) {\n    switch (formatChar) {\n      case 'd': return pad0(date.getDate())\n      case 'F': return String(date.getFullYear()) + '-' + pad0(date.getMonth() + 1) + '-' + pad0(date.getDate()) // '%Y-%m-%d'\n      case 'H': return pad0(date.getHours())\n      case 'm': return pad0(date.getMonth() + 1)\n      case 'M': return pad0(date.getMinutes())\n      case 'o': return pad0(date.getMilliseconds(), 3)\n      case 'O': return pad0(date.getHours()) + ':' + pad0(date.getMinutes()) + ':' + pad0(date.getSeconds()) + '.' + pad0(date.getMilliseconds(), 3) // '%H:%M:%S.%o'\n      case 's': return pad0(Math.round(date.getTime() / 1000))\n      case 'S': return pad0(date.getSeconds())\n      case 'T': return pad0(date.getHours()) + ':' + pad0(date.getMinutes()) + ':' + pad0(date.getSeconds()) // '%H:%M:%S'\n      case 'y': return String(date.getFullYear()).substr(2)\n      case 'Y': return date.getFullYear()\n      case '%': return '%' // pour remplacer %% par %\n      // On change rien si on connait pas le format demandé\n      default: return '%' + formatChar\n    }\n  })\n}\n\n/**\n * Renvoie un token aléatoire de 22 caractères\n * Pas aussi random ni unique que l'usage de crypto ou d'un module uuid\n * mais suffisant dans pas mal de cas (utiliser an-uuid sinon)\n * @returns {string}\n */\nfunction getToken () {\n  return Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2)\n}\n\n/**\n * Retourne true si object est un objet avec la propriété prop\n * @param object\n * @param prop\n * @return {boolean}\n */\nfunction hasProp (object, prop) {\n  return typeof object === 'object' && Object.prototype.hasOwnProperty.call(object, prop)\n}\n\n/**\n * @param {*} arg\n * @returns {boolean}\n */\nfunction isArray (arg) {\n  return Array.isArray(arg)\n}\n\n/**\n * true si value est un array vide (mais false s'il contient un élément false|undefined)\n * @param value\n * @returns {boolean}\n */\nfunction isArrayEmpty (value) {\n  return Boolean(Array.isArray(value) && value.length === 0)\n}\n\n/**\n * true si value est un array non vide (même s'il contient un seul élément false|undefined|null|'')\n * @param value\n * @returns {boolean}\n */\nfunction isArrayNotEmpty (value) {\n  return Boolean(Array.isArray(value) && value.length)\n}\n\n/**\n * @param arg\n * @returns {boolean}\n */\nfunction isDate (arg) {\n  return typeof arg === 'object' && Object.prototype.toString.call(arg) === '[object Date]'\n}\n\n/**\n * Thanks to bugsnag-js\n * @param {*} value\n * @return {boolean}\n */\nfunction isError (value) {\n  switch (Object.prototype.toString.call(value)) {\n    case '[object Error]':\n      return true\n    case '[object Exception]':\n      return true\n    case '[object DOMException]':\n      return true\n    default:\n      return value instanceof Error\n  }\n}\n\n/**\n * Retourne true si l'argument est une fonction\n * cf https://github.com/lodash/lodash/blob/4.11.2/lodash.js#L10826\n * cette implémentation plus simple sur typeof bug dans phandomJs 1.9 qui retourne function pour typeof NodeList\n * @param {*} arg\n * @returns {boolean}\n */\nfunction isFunction (arg) {\n  return (typeof arg === 'function')\n}\n\n/**\n * Indique si un array contient un élément\n * @param {Array} ar  Le tableau dans lequel chercher\n * @param {*}     elt L'élément à chercher (type natif, marche pas si c'est un objet littéral)\n * @returns {boolean}\n * @throws {Error} si on lui passe pas un Array en 1er argument\n */\nfunction isInArray (ar, elt) {\n  if (!Array.isArray(ar)) throw new Error('isInArray veut un tableau en 1er argument')\n  return ar.indexOf(elt) !== -1\n}\n\n/**\n * Retourne true si c'est un entier (utiliser Number.isInteger si c'est dispo)\n * @param arg\n * @param {boolean} [isStringAllowed=false] Passer true pour accepter les strings comme \"42\"\n * @returns {boolean}\n */\nfunction isInt (arg, isStringAllowed) {\n  switch (typeof arg) {\n    case 'number':\n      return Math.floor(arg) === arg\n    case 'string':\n      return Boolean(isStringAllowed && arg && Math.floor(arg) == arg) // eslint-disable-line eqeqeq\n    default:\n      return false\n  }\n}\n\n/**\n * Retourne true pour un entier (number) positif\n * @param arg\n * @param {boolean} [strict=false] passer true pour que 0 renvoie false\n * @param {boolean} [isStringAllowed=false] Passer true pour accepter les strings comme \"42\"\n * @returns {boolean}\n */\nfunction isIntPos (arg, strict, isStringAllowed) {\n  return isInt(arg, isStringAllowed) && (strict ? arg > 0 : arg >= 0)\n}\n\n/**\n * Retourne true sur un objet (donc aussi une fonction, mais pas null)\n * Piqué à lodash (https://github.com/lodash/lodash/blob/4.11.2/lodash.js#L10921)\n * @param {*} arg\n * @returns {boolean}\n */\nfunction isObject (arg) {\n  var type = typeof arg\n  return !!arg && (type === 'object' || type === 'function')\n}\n\n/**\n * Retourne true pour les objets qui n'ont pas d'autre constructeur qu'object (ni null, ni fonction ni regexp ni date ni array…)\n * @param {*} arg\n * @returns {boolean}\n */\nfunction isObjectPlain (arg) {\n  return !!arg && typeof arg === 'object' && Object.prototype.toString.call(arg) === '[object Object]'\n}\n\n/**\n * Retourne true pour les RegExp\n * @param arg\n * @returns {boolean}\n */\nfunction isRegExp (arg) {\n  return !!arg && typeof arg === 'object' && Object.prototype.toString.call(arg) === '[object RegExp]'\n}\n\n/**\n * Retourne true si l'argument est une string\n * @param {*} arg\n * @returns {boolean}\n */\nfunction isString (arg) {\n  return (typeof arg === 'string')\n}\n\n/**\n * @param arg\n * @returns {boolean}\n */\nfunction isUndefined (arg) {\n  return typeof arg === 'undefined'\n}\n\n/**\n * Retourne true si l'argument est une url absolue\n * @param {*} arg\n * @returns {boolean}\n */\nfunction isUrlAbsolute (arg) {\n  return (typeof arg === 'string' && /^https?:\\/\\/[a-z0-9\\-._]+(:[0-9]+)?(\\/|$)/.test(arg))\n}\n\n/**\n * Complete la valeur avec des caractères initiaux pour atteindre la longueur voulue\n * @param {number|string} value\n * @param {string} [char=0| ] Le caractère à ajouter au début (par défaut 0 si value est un nombre, espace sinon)\n * @param {number) [nb=2] Nb de caractères finaux voulus\n * @return {string} padded value\n */\nfunction pad (value, char, nb) {\n  // check char\n  if (char) {\n    if (typeof char !== 'string') char = String(char)\n    if (char.length !== 1) {\n      console.error(new Error('char invalide ' + char))\n      char = undefined\n    }\n  }\n  // init char\n  if (!char) {\n    char = typeof value === 'number' ? '0' : ' '\n  }\n  // cast value\n  if (typeof value !== 'string') value = String(value)\n  // default nb\n  if (!nb) nb = 2\n  // padding\n  while (value.length < nb) value = char + value\n  return value\n}\n\n/**\n * Idem JSON.parse mais renvoie undefined en cas de plantage\n * @param jsonString La string à parser\n * @return {Object}\n */\nfunction parse (jsonString) {\n  var obj\n  if (typeof jsonString === 'string') {\n    try {\n      obj = JSON.parse(jsonString)\n    } catch (e) {\n      if (!isUndefined(console) && console.error) console.error(e)\n    }\n  }\n  return obj\n}\n\n/**\n * split une chaine et fait un trim sur chaque élément\n * @param str\n * @param {string|RegExp} [delim=/[,;\\s]+/] Délimiteur, par défaut  virgule, point virgule ou n'importe quel espace (incluant tab, \\n & co)\n * @returns {*}\n */\nfunction splitAndTrim (str, delim) {\n  if (typeof str === 'string') {\n    if (!delim) delim = /[,;\\s]+/\n    // split + trim + filter au cas où il y aurait un délimiteur au début ou à la fin\n    // serait plus lisible en es6 mais on peut être utilisé par qqun sans babel…\n    return str.split(delim).map(function (elt) { return elt.trim() }).filter(function (elt) { return elt })\n  }\n  return []\n}\n\n/**\n * Idem JSON.stringify mais sans planter, en cas de ref circulaire sur une propriété on renvoie quand même les autres\n * (avec le message d'erreur de JSON.stringify sur la propriété à pb)\n * @param obj\n * @param {number} [indent]  Le nb d'espaces d'indentation\n * @returns {string}\n */\nfunction stringify (obj, indent) {\n  var buffer\n  try {\n    // ça peut planter en cas de ref circulaire\n    buffer = indent ? JSON.stringify(obj, null, indent) : JSON.stringify(obj)\n  } catch (error) {\n    // on a un objet avec ref circulaire\n    var key\n    var value\n    var pile = []\n    for (key in obj) {\n      // on veut le même comportement que JSON.stringify qui omet les valeurs undefined et les fct\n      // et met du {} pour regexp et function\n      if (hasProp(obj, key) && !isUndefined(obj[key]) && !isFunction(obj[key])) {\n        value = obj[key]\n        buffer = '\"' + key + '\":'\n        try {\n          buffer += indent ? JSON.stringify(value, null, indent) : JSON.stringify(value)\n        } catch (error) {\n          buffer += '\"' + error.toString().replace(/\\n/g, '\\\\n') + '\"'\n        }\n        pile.push(buffer)\n      }\n    }\n    var sep = ','\n    buffer = '{'\n    if (indent) {\n      var sepSup = '\\n' + ' '.repeat(indent)\n      sep += sepSup\n      buffer += sepSup\n    }\n    buffer += pile.join(sep)\n    if (indent) buffer += '\\n'\n    buffer += '}'\n  }\n  return buffer\n}\n\n/**\n * Retire les accents d'une chaîne\n * @param {string} string\n * @return {string} la même désaccentuée\n */\nfunction toAscii (string) {\n  function reducer (acc, r) {\n    return acc.replace(r[0], r[1])\n  }\n  if (typeof string === 'string') {\n    // si c'est déjà sans accent on retourne\n    if (/^[\\w]*$/.test(string)) return string\n    // faut inspecter\n    var toReplace = [\n      [/[áàâäãå]/g, 'a'],\n      [/[ÁÀÂÄÃÅ]/g, 'A'],\n      ['ç', 'c'],\n      ['Ç', 'C'],\n      [/[éèêë]/g, 'e'],\n      [/[ÉÈÊË]/g, 'E'],\n      [/[íìîï]/g, 'i'],\n      [/[ÍÌÎÏ]/g, 'I'],\n      ['ñ', 'n'],\n      ['Ñ', 'N'],\n      [/[óòôöõ]/g, 'o'],\n      [/[ÓÒÔÖÕ]/g, 'O'],\n      [/[úùûü]/g, 'u'],\n      [/[ÚÙÛÜ]/g, 'U'],\n      [/[ýÿ]/g, 'y'],\n      [/[ÝŸ]/g, 'Y'],\n      ['æ', 'ae'],\n      ['Æ', 'AE'],\n      ['œ', 'oe'],\n      ['Œ', 'OE']\n    ]\n    return toReplace.reduce(reducer, string)\n  }\n  console.error(new TypeError('not a string'), string)\n  return ''\n}\n\n/**\n * Quasi alias de Math.round, cast en entier mais retourne NaN pour tout ce qui\n * ne ressemble pas à un nombre (chaine vide, boolean, null) là ou round retourne 0 (ou 1 pour true)\n * @param arg\n * @returns {number}\n */\nfunction toInt (arg) {\n  switch (typeof arg) {\n    case 'number':\n      return Math.round(arg)\n    case 'string':\n      if (arg === '') return NaN\n      else return Math.round(arg)\n    default:\n      return NaN\n  }\n}\n\n/**\n * Notre module pour toutes nos fonctions génériques\n * (cf aussi les extensions sesajstools/http/xhr, sesajstools/dom, etc.)\n * @module sesajstools\n */\nmodule.exports = {\n  countSlash,\n  escapeForHtml,\n  formatDate,\n  getToken,\n  hasProp,\n  isArray,\n  isArrayEmpty,\n  isArrayNotEmpty,\n  isDate,\n  isError,\n  isFunction,\n  isInArray,\n  isInt,\n  isIntPos,\n  isObject,\n  isObjectPlain,\n  isRegExp,\n  isString,\n  isUndefined,\n  isUrlAbsolute,\n  pad,\n  parse,\n  splitAndTrim,\n  stringify,\n  toAscii,\n  toInt\n}\n","/**\n * This file is part of SesaJsTools.\n *   Copyright 2014-2015, Association Sésamath\n *\n * SesaJsTools is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License version 3\n * as published by the Free Software Foundation.\n *\n * SesaJsTools is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with SesaJsTools (LICENCE.txt).\n * @see http://www.gnu.org/licenses/agpl.txt\n *\n *\n * Ce fichier fait partie de l'application Sésathèque, créée par l'association Sésamath.\n *\n * Sésathèque est un logiciel libre ; vous pouvez le redistribuer ou le modifier suivant\n * les termes de la GNU Affero General Public License version 3 telle que publiée par la\n * Free Software Foundation.\n * Sésathèque est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE,\n * sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER.\n * Consultez la GNU Affero General Public License pour plus de détails.\n * Vous devez avoir reçu une copie de la GNU General Public License en même temps que Sésathèque\n * (cf LICENCE.txt et http://vvlibri.org/fr/Analyse/gnu-affero-general-public-license-v3-analyse\n * pour une explication en français)\n */\n\n'use strict'\n\nvar tools = require('../index')\nvar hasProp = tools.hasProp\n\n/**\n * dump un objet de manière plus complète qu'un stringify\n * @param obj\n * @param indent\n * @returns {*}\n */\nmodule.exports = function dump (obj, indent) {\n  // on traite déjà null\n  if (obj === null) return 'null'\n  // puis les types natifs basiques\n  var type = typeof obj\n  switch (type) {\n    case 'undefined':\n      return obj\n    case 'number':\n    case 'boolean':\n      return String(obj)\n    case 'string':\n      return '\"' + obj.replace('\"', '\\\\\"') + '\"'\n    case 'symbol':\n      return '[Symbol ' + obj.toString() + ']'\n\n    default:\n      if (!indent) indent = 0\n      // decalage de base\n      var prefix = (' ').repeat(indent)\n      indent += 2\n      var innerPrefix = prefix + '  '\n      var pile = []\n      var buffer\n      // object et symbol\n      // on regarde d'abord si on a une méthode toSource toute prête qui existe sur cet objet\n      // (sauf pour les date qui posent pb sous node)\n      if (tools.isDate(obj)) {\n        return JSON.stringify(obj)\n      } else if (tools.isArray(obj)) {\n        buffer = '[\\n'\n        obj.forEach(function (elt, index) {\n          buffer += innerPrefix + dump(elt, indent) + (index === obj.length - 1 ? '\\n' : ',\\n')\n        })\n        if (obj.length) buffer += prefix + ']'\n        else buffer += ']'\n        return buffer\n      } else if (tools.isRegExp(obj) || tools.isFunction(obj)) {\n        // dans un navigateur toSource existe pour eux, mais pas dans node\n        return (typeof obj.toSource === 'function') ? obj.toSource() : obj.toString()\n      } else if (tools.isObject(obj)) {\n        var nbp = 0\n        for (var p in obj) {\n          if (hasProp(obj, p)) {\n            nbp++\n            // pour détecter les refs circulaires, on regarde si JSON.stringify plante,\n            // pas génial mais évite de lancer une récursion infinie, à pas si cher (et dump est vraiment rarement utilisé en prod)\n            try {\n              JSON.stringify(obj[p])\n              pile.push(p + ': ' + dump(obj[p], indent))\n            } catch (error) {\n              pile.push(p + ': \"' + error.toString().replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n') + '\"')\n            }\n          }\n        }\n        if (nbp) return '{\\n' + innerPrefix + pile.join(',\\n' + innerPrefix) + '\\n' + prefix + '}'\n        else if (tools.isObjectPlain(obj)) return prefix + '{}'\n        else return prefix + obj.toString()\n      } else {\n        console.error('dump est tombé sur un truc qui ne ressemble à rien de connu', obj)\n        return tools.stringify(obj, 2)\n      }\n  }\n}\n","/**\n * This file is part of Sesatheque.\n *   Copyright 2014-2015, Association Sésamath\n *\n * Sesatheque is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License version 3\n * as published by the Free Software Foundation.\n *\n * Sesatheque is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Sesatheque (LICENCE.txt).\n * @see http://www.gnu.org/licenses/agpl.txt\n *\n *\n * Ce fichier fait partie de l'application Sésathèque, créée par l'association Sésamath.\n *\n * Sésathèque est un logiciel libre ; vous pouvez le redistribuer ou le modifier suivant\n * les termes de la GNU Affero General Public License version 3 telle que publiée par la\n * Free Software Foundation.\n * Sésathèque est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE\n * sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER.\n * Consultez la GNU Affero General Public License pour plus de détails.\n * Vous devez avoir reçu une copie de la GNU General Public License en même temps que Sésathèque\n * (cf LICENCE.txt et http://vvlibri.org/fr/Analyse/gnu-affero-general-public-license-v3-analyse\n * pour une explication en français)\n */\n'use strict'\n\nvar dump = require('./dump')\nvar tools = require('../index')\nvar formatDate = tools.formatDate\nvar hasProp = tools.hasProp\n\n// attention, on duplique plus bas pour l'export\nvar levels = {\n  debug: 0,\n  info: 1,\n  notice: 1,\n  warn: 2,\n  warning: 2,\n  error: 3,\n  alert: 4,\n  critical: 4\n}\nvar prefixes = [\n  '[debug]',\n  '[info]',\n  '[warning]',\n  '[error]',\n  '[CRITICAL]'\n]\nvar loggers = [\n  // eslint-disable-next-line no-console\n  console.info || console.log, // 0 => debug\n  // eslint-disable-next-line no-console\n  console.log, // 1 => info|notice\n  // eslint-disable-next-line no-console\n  console.warn || console.error || console.log, // 2 => warning\n  // eslint-disable-next-line no-console\n  console.error || console.log, // 3 => error\n  // eslint-disable-next-line no-console\n  console.error || console.log // 4 => critical|alert\n]\n\n// valeurs par défaut\n/**\n * Niveau minimum requis pour affichage (un niveau 2 affiche warning, error et critical)\n * @private\n * @type {number}\n */\nvar logLevel = levels.info\n// on peut tourner sous node comme dans un navigateur\nvar isNode = typeof process !== 'undefined' && process.env\nvar isCluster = isNode && hasProp(process.env, 'NODE_APP_INSTANCE')\n/**\n * Flag pour savoir s'il faut ajouter la date en préfixe (false par défaut dans un navigateur et true ailleurs)\n * @private\n * @type {boolean}\n */\nvar hasDatePrefix = isNode && !isCluster // en mode cluster c'est pm2 qui met le préfixe de date\nvar datePrefix = '[%O]'\n\n// idem pour le process\nvar hasProcessPrefix = isCluster\n// NODE_APP_INSTANCE est une string, donc '0' ne sera pas falsy\nvar processPrefix = (isCluster && process.env.NODE_APP_INSTANCE) || 'N/A'\n\n/**\n * Écrit en console en ajoutant les préfixes\n * @param {Array} args arguments d'une autre fct (pseudo Array)\n * @param {number} level\n * @private\n */\nfunction _log (args, level) {\n  try {\n    // eslint-disable-next-line no-console\n    var logger = loggers[level] || console.log\n    var prefix = ''\n    // date en 1er\n    if (hasDatePrefix) prefix = formatDate(datePrefix)\n    // puis processId\n    if (hasProcessPrefix) {\n      if (prefix) prefix += ' '\n      prefix += '[' + processPrefix + ']'\n    }\n    // puis logLevel\n    if (prefix) prefix += ' '\n    prefix += prefixes[level]\n    // avec le 1er argument sur la même ligne, mais on râle si y’en a pas (pour avoir la trace et retrouver l'appelant)\n    if (args.length < 1) args = [Error('fonction de log appelée sans contenu')]\n    logger(prefix, args[0])\n    // puis les autres sans préfixe\n    if (args.length > 1) for (var i = 1; i < args.length; i++) logger(args[i])\n  } catch (e) {\n    // rien, fallait un environnement décent avec console...\n  }\n}\n\n/**\n * Un console.log qui plante pas sur les anciens IE (ou d'autres navigateurs qui n'auraient pas de console.log)\n * @param {...*} arguments Nombre variable d'arguments, chacun sera passé à console.log ou console.error si c'est une erreur\n * @service sesajstools/utils/log\n */\nfunction log () {\n  if (logLevel < levels.warning) {\n    _log(arguments, levels.info)\n  }\n}\n// les logger des ≠ niveaux\nlog.debug = function debug () {\n  if (logLevel < levels.info) {\n    _log(arguments, levels.debug)\n  }\n}\nlog.info = function info () {\n  if (logLevel < levels.warning) {\n    _log(arguments, levels.info)\n  }\n}\nlog.warn = function warn () {\n  if (logLevel < levels.error) {\n    _log(arguments, levels.warning)\n  }\n}\nlog.ifError = function error () {\n  if (error && logLevel < levels.critical) {\n    _log(arguments, levels.error)\n  }\n}\nlog.error = function error () {\n  if (logLevel < levels.critical) {\n    _log(arguments, levels.error)\n  }\n}\nlog.critical = function critical () {\n  _log(arguments, levels.critical)\n}\n\n/**\n * Passe logLevel au niveau error (désactive donc seulement les infos et warnings…)\n * Pour comptatibilité ascendante, à remplacer par log.setLevel(log.levels.error)\n * @deprecated\n */\nlog.disable = function disable () {\n  logLevel = levels.error\n}\n/**\n * Supprime le préfixe de date\n */\nlog.disableDatePrefix = function disableDatePrefix () {\n  hasDatePrefix = false\n}\n/**\n * Supprime le préfixe de process\n */\nlog.disableProcessPrefix = function disableProcessPrefix () {\n  hasProcessPrefix = false\n}\n/**\n * Dump un objet en console si le niveau de log est <= à celui indiqué\n * @param {string} message affiché avant le dump\n * @param {*} objToDump peut être n'importe quoi\n * @param {object} [options]\n * @param {string|number} [options.max=1000] le nb max de caractères affichés du dump\n * @param {string|number} [options.level=debug] le niveau d'affichage souhaité\n */\nlog.dump = function (message, objToDump, options) {\n  if (typeof options !== 'object') options = {}\n  var level = options.level || levels.debug\n  if (typeof level === 'string') level = levels[level] || levels.debug\n  var dumped = dump(objToDump)\n  var max = options.max || 1000\n  if (dumped.length > max) dumped = dumped.substr(0, max) + '…'\n  if (logLevel <= level) _log([message, dumped], level)\n}\n/**\n * Passe logLevel au niveau info (qui le rend plus bavard)\n * Pour comptatibilité ascendante, à remplacer par log.setLevel(log.levels.info)\n * @deprecated\n */\nlog.enable = function enable () {\n  logLevel = levels.info\n}\n/**\n * Active le préfixe de date\n */\nlog.enableDatePrefix = function enableDatePrefix () {\n  hasDatePrefix = true\n}\n/**\n * Active le préfixe de process\n */\nlog.enableProcessPrefix = function enableProcessPrefix () {\n  if (typeof process === 'undefined') console.error('process not available')\n  else hasProcessPrefix = true\n}\n/**\n * Modifie le préfixe de date (cf formats gérés par formatDate)\n * @param prefix\n */\nlog.setDatePrefix = function setDatePrefix (prefix) {\n  if (typeof prefix === 'string') datePrefix = prefix\n  else log.error(new Error('Le préfixe de log doit être une string'))\n}\n/**\n * Modifie le niveau de log\n * @param {number|string} level\n */\nlog.setLogLevel = function setLogLevel (level) {\n  switch (level) {\n    case 0:\n    case '0':\n    case 'debug':\n      logLevel = levels.debug\n      break\n    case 1:\n    case '1':\n    case 'info':\n    case 'notice':\n      logLevel = levels.notice\n      break\n    case 2:\n    case '2':\n    case 'warn':\n    case 'warning':\n      logLevel = levels.warning\n      break\n    case 3:\n    case '3':\n    case 'err':\n    case 'error':\n      logLevel = levels.error\n      break\n    case 4:\n    case '4':\n    case 'alert':\n    case 'crit':\n    case 'critical':\n      logLevel = levels.critical\n      break\n    default:\n      log.error('niveau d’erreur ' + level)\n  }\n}\n// et on ajoute les levels, mais sans ref pour empêcher de modifier nos constantes locale de l'extérieur\nlog.levels = {\n  debug: 0,\n  info: 1,\n  notice: 1,\n  warn: 2,\n  warning: 2,\n  error: 3,\n  alert: 4,\n  critical: 4\n}\n// ce serait plus élégant de cloner (quoi que, en es5 ça reste moche) mais ça empêche l'autocompletion\n\nmodule.exports = log\n","/**\n * This file is part of Sesatheque.\n *   Copyright 2014-2015, Association Sésamath\n *\n * Sesatheque is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License version 3\n * as published by the Free Software Foundation.\n *\n * Sesatheque is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Sesatheque (LICENCE.txt).\n * @see http://www.gnu.org/licenses/agpl.txt\n *\n *\n * Ce fichier fait partie de l'application Sésathèque, créée par l'association Sésamath.\n *\n * Sésathèque est un logiciel libre ; vous pouvez le redistribuer ou le modifier suivant\n * les termes de la GNU Affero General Public License version 3 telle que publiée par la\n * Free Software Foundation.\n * Sésathèque est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE,\n * sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER.\n * Consultez la GNU Affero General Public License pour plus de détails.\n * Vous devez avoir reçu une copie de la GNU General Public License en même temps que Sésathèque\n * (cf LICENCE.txt et http://vvlibri.org/fr/Analyse/gnu-affero-general-public-license-v3-analyse\n * pour une explication en français)\n */\n'use strict'\n\nvar log = require('../utils/log')\nvar hasProp = require('../index').hasProp\n\n/**\n * Ajoute une css dans le <head> de la page\n *\n * Déclaré par init (dès son chargement)\n * @param {string}  file Chemin du fichier css (mis dans href tel quel)\n */\nfunction addCss (file) {\n  var head = window.document.getElementsByTagName('head')[0]\n  var links = head.getElementsByTagName('link')\n  var dejala = false\n  for (var i = 0; i < links.length; i++) {\n    if (links[i].href === file) {\n      dejala = true\n      break\n    }\n  }\n\n  if (dejala) {\n    log(file + \" était déjà présent, on ne l'ajoute pas\")\n  } else {\n    var elt = window.document.createElement('link')\n    elt.rel = 'stylesheet'\n    elt.type = 'text/css'\n    elt.href = file\n    head.appendChild(elt)\n  }\n}\n\n/**\n * Ajoute un js à la fin du body et appelle la callback quand il est chargé\n * @param {string}  file Chemin du fichier jss (mis dans src tel quel)\n */\nfunction addJs (file, cb) {\n  /**\n   * @private\n   * @type {HTMLElement}\n   */\n  var body = window.document.getElementsByTagName('body')[0]\n  var elt = window.document.createElement('script')\n  elt.type = 'text/javascript'\n  // pour que ça marche mieux partout, il vaut mieux mettre le listener onload après avoir mis l'élément dans le dom\n  body.appendChild(elt)\n  // on ne passe pas directement cb comme listener sinon il recevrait l'event et risquerait de le prendre pour une erreur\n  elt.addEventListener('load', () => cb(), { once: true })\n  // et ensuite indiquer le fichier à charger\n  elt.src = file\n}\n\n/**\n * Ajoute un élément html de type tag à parent\n * @param {HTMLElement} parent\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'élément ajouté\n */\nfunction addElement (parent, tag, attrs, content) {\n  var elt = getElement(tag, attrs, content)\n  parent.appendChild(elt)\n\n  return elt\n}\n\n/**\n * Ajoute un élément html juste après element\n * @param {HTMLElement} element\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'élément ajouté\n */\nfunction addElementAfter (element, tag, attrs, content) {\n  var newElt = getElement(tag, attrs, content)\n  var parent = element.parentNode\n  // pas de insertAfter, si nextSibling est null ça le mettra à la fin, cf https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore\n  if (parent) parent.insertBefore(newElt, element.nextSibling)\n  else log.error(new Error(\"Navigateur incompatible (pas de parentNode), impossible d'ajouter l'élément\"))\n\n  return newElt\n}\n\n/**\n * Ajoute un élément html juste avant element\n * @param {HTMLElement} element\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'élément ajouté\n */\nfunction addElementBefore (element, tag, attrs, content) {\n  var newElt = getElement(tag, attrs, content)\n  var parent = element.parentNode\n  if (parent) parent.insertBefore(newElt, element)\n  else log.error(new Error(\"Navigateur incompatible (pas de parentNode), impossible d'insérer l'élément\"))\n\n  return newElt\n}\n\n/**\n * Ajoute un élément html comme premier enfant de parent\n * @param {HTMLElement} parent\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'élément ajouté\n */\nfunction addElementFirstChild (parent, tag, attrs, content) {\n  var newElt = getElement(tag, attrs, content)\n  parent.insertBefore(newElt, parent.firstChild)\n\n  return newElt\n}\n\n/**\n * Ajoute un élément html comme frère aîné de elementRef\n * @param {HTMLElement} elementRef\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'élément ajouté\n */\nfunction addElementFirstSibling (elementRef, tag, attrs, content) {\n  var newElt = getElement(tag, attrs, content)\n  elementRef.parentNode.insertBefore(newElt, elementRef.parentNode.firstChild)\n\n  return newElt\n}\n\n/**\n * Ajoute du texte dans un élément\n *\n * Déclaré par init (dès son chargement)\n * @param {HTMLElement} elt\n * @param {string} text\n */\nfunction addText (elt, text) {\n  elt.appendChild(window.document.createTextNode(text))\n}\n\n/**\n * Vide un élément html de tous ses enfants\n *\n * Déclaré par init (dès son chargement)\n * @param {HTMLElement} element\n */\nfunction empty (element) {\n  if (element && element.firstChild) {\n    while (element.firstChild) element.removeChild(element.firstChild)\n  }\n}\n\n/**\n * Retourne un élément html de type tag (non inséré dans le dom)\n *\n * Déclaré par init (dès son chargement)\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} txtContent\n */\nfunction getElement (tag, attrs, txtContent) {\n  var elt = window.document.createElement(tag)\n  var attr\n  try {\n    if (attrs) {\n      for (attr in attrs) {\n        if (hasProp(attrs, attr)) {\n          if (attr === 'class') elt.className = attrs.class\n          else if (attr === 'className') elt.className = attrs.className\n          else if (attr === 'style') setStyles(elt, attrs.style)\n          else elt.setAttribute(attr, attrs[attr])\n        }\n      }\n    }\n  } catch (error) {\n    log('plantage dans getElement ' + tag + ' avec les attributs ', attrs, error)\n  }\n\n  if (txtContent) addText(elt, txtContent)\n\n  return elt\n}\n\n/**\n * Retourne la taille de la fenêtre\n * @returns {{width: number, height: number}}\n */\nfunction getSize () {\n  // suivant que l'on est en mode standard ou quirk faut prendre l'un ou l'autre\n  var body = (window.document.compatMode === 'CSS1Compat') ? window.document.documentElement : window.document.body\n  // en cas de zoom, window.innerWidth est plus petit, et c'est la bonne valeur\n  return {\n    width: Math.floor(Math.min(body.clientWidth, window.innerWidth)),\n    height: Math.floor(Math.min(body.clientHeight, window.innerHeight))\n  }\n}\n\n/**\n * Retourne un id qui n'existe pas encore dans le dom (mais ne le créé pas)\n */\nvar getNewId = (function () {\n  // au dela de 10000 id dans un dom y'a un pb !\n  var max = 10000\n  // une closure pour conserver la valeur de cette variable privée entre 2 appels\n  var lastId = 0\n  var id = 'sesa' + lastId\n  return function getNewId () {\n    while (window.document.getElementById(id) && lastId < max) {\n      lastId++\n      id = 'sesa' + lastId\n    }\n    if (lastId === max) throw Error('Max de ' + max + ' id générés atteint')\n\n    return id\n  }\n})()\n\n/**\n * Affecte des styles à un élément html (on peut pas affecter elt.style directement car read only, faut faire du elt.style.foo = bar)\n * sans planter en cas de pb (on le signale juste en console)\n *\n * Déclaré par init (dès son chargement)\n * @param {HTMLElement} elt\n * @param {string|object} styles\n */\nfunction setStyles (elt, styles) {\n  try {\n    if (elt && elt.style) {\n      if (typeof styles === 'string') {\n        styles = styles.split(';')\n        styles.forEach(function (paire) {\n          paire = /([\\w]+):(.+)/.exec(paire)\n          if (paire && paire.length === 3) {\n            var key = paire[1]\n            elt.style[key] = paire[2]\n          }\n        })\n      } else if (typeof styles === 'object') {\n        for (var prop in styles) {\n          if (hasProp(styles, prop)) {\n            elt.style[prop] = styles[prop]\n          }\n        }\n      }\n    }\n  } catch (error) {\n    log.error(error)\n  }\n}\n\n/**\n * Fonctions génériques pour manipuler le dom\n * @service sesajstools/dom\n */\nmodule.exports = {\n  addCss,\n  addJs,\n  addElement,\n  addElementAfter,\n  addElementBefore,\n  addElementFirstChild,\n  addElementFirstSibling,\n  addText,\n  empty,\n  getElement,\n  getSize,\n  getNewId,\n  setStyles\n}\n"],"names":["fn","i","specialHtmlChars","countSlash","str","escapeForHtml","all","char","formatDate","format","date","pad0","val","nb","pad","capture","formatChar","getToken","hasProp","object","prop","isArray","arg","isArrayEmpty","value","isArrayNotEmpty","isDate","isError","isFunction","isInArray","ar","elt","isInt","isStringAllowed","isIntPos","strict","isObject","type","isObjectPlain","isRegExp","isString","isUndefined","isUrlAbsolute","parse","jsonString","obj","e","splitAndTrim","delim","stringify","indent","buffer","key","pile","error","sep","sepSup","toAscii","string","reducer","acc","r","toReplace","toInt","sesajstools","tools","require$$0","dump","prefix","innerPrefix","index","nbp","p","require$$1","levels","prefixes","loggers","logLevel","isNode","define_process_env_default","isCluster","hasDatePrefix","datePrefix","hasProcessPrefix","processPrefix","_log","args","level","logger","log","message","objToDump","options","dumped","max","log_1","addCss","file","head","links","dejala","addJs","cb","body","addElement","parent","tag","attrs","content","getElement","addElementAfter","element","newElt","addElementBefore","addElementFirstChild","addElementFirstSibling","elementRef","addText","text","empty","txtContent","attr","setStyles","getSize","getNewId","lastId","id","styles","paire","dom"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}