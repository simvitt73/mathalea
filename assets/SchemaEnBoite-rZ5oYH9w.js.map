{"version":3,"file":"SchemaEnBoite-rZ5oYH9w.js","sources":["../../src/lib/outils/SchemaEnBoite.ts"],"sourcesContent":["import { context } from '../../modules/context'\nimport { range } from './nombres'\nimport './ShemasEnBoite.css'\nimport { texNombre } from './texNombre'\n\n/**\n * @author Jean-Claude Lhote\n */\n\ntype AccoladeType = {\n  start: number // colonne de début (1 = première colonne)\n  end: number // colonne de fin = start + longueur de l'accolade\n  text: string\n  type?: 'accolade' | 'flèche' // pour le style de l'accolade, 'curl' pour les accolades classiques, 'arrow' pour les accolades avec une flèche\n  options?: {\n    justify?: 'start' | 'center' | 'end' // pour justifier le texte à gauche, au centre ou à droite\n    color?: string // pour la couleur du texte\n    fontSize?: string // pour la taille de la police\n    fontWeight?: string // pour le poids de la police\n    lineHeight?: string // pour la hauteur de ligne\n  }\n}\ntype BarreSchemaType = {\n  color: string\n  length: number\n  content: string\n  type?: 'boite' | 'flèche'\n  options?: {\n    borderless?: boolean // pour une boîte sans bordure\n    justify?: 'start' | 'center' | 'end' // pour justifier le texte à gauche, au centre ou à droite\n    color?: string // pour la couleur du texte\n    fontSize?: string // pour la taille de la police\n    fontWeight?: string // pour le poids de la police\n    textAlign?: 'left' | 'center' | 'right' // pour aligner le texte à gauche, au centre ou à droite\n    style?: string // pour ajouter un style CSS supplémentaire\n    // par exemple: 'border: 1px solid black;'\n    // pour ajouter une bordure ou d'autres styles\n    // on peut aussi ajouter d'autres options si besoin\n  }\n}\n\ntype LigneSchemaType = {\n  barres: BarreSchemaType[]\n  entete?: {\n    content: string // pour le titre de la ligne\n    longueur?: number // pour la longueur de l'entête (en nombre d'unité de grille) n\"cessaire sur la prémière ligne du schéma les autres lignes auront la même longueur\n    couleur?: string // pour la couleur du texte de l'entête (le fond est dans la couleur de la page)\n    fontSize?: string // pour la taille de la police de l'entête\n    fontWeight?: string // pour le poids de la police de l'entête\n  }\n  spacing?: number // pour l'espacement après la ligne\n  height?: number // pour la hauteur de la ligne (en em), si non défini, on utilise la hauteur par défaut\n}\n\ntype LigneAccoladeType = AccoladeType[]\nexport default class SchemaEnBoite {\n  topBraces?: LigneAccoladeType\n  bottomBraces?: LigneAccoladeType\n  lignes: LigneSchemaType[] = []\n  rightBraces?: AccoladeType[] // pour les accolades à droite, si nécessaire\n  maxEnteteLength?: number // pour la largeur max des entêtes (en nombre d'unité de grille), si nécessaire\n\n  constructor(\n    {\n      lignes,\n      bottomBraces,\n      topBraces,\n      rightBraces,\n    }: {\n      lignes: LigneSchemaType[]\n      bottomBraces?: LigneAccoladeType\n      topBraces?: LigneAccoladeType\n      rightBraces?: LigneAccoladeType\n    } = { lignes: [] },\n  ) {\n    this.lignes = lignes\n    this.rightBraces = []\n    if (bottomBraces) {\n      this.bottomBraces = bottomBraces\n    }\n    if (topBraces) {\n      this.topBraces = topBraces\n    }\n    if (rightBraces) {\n      this.rightBraces = rightBraces\n    }\n  }\n\n  display(texScale = 0.8): string {\n    if (context.isHtml) {\n      // Trouver la largeur max des entêtes (en nombre d'unité de grille)\n      let maxEnteteLength = 0\n      let hasEntete = false\n      for (const ligne of this.lignes) {\n        if (ligne.entete !== undefined) {\n          hasEntete = true\n          if ((ligne.entete.longueur ?? 0) > maxEnteteLength) {\n            maxEnteteLength = ligne.entete.longueur ?? 0\n          }\n        }\n      }\n      this.maxEnteteLength = maxEnteteLength\n      // Si aucune entête n'est définie, on ne met pas de colonne d'entête\n      let ligneAccoladeH = ''\n      if (this.topBraces) {\n        for (let k = 0; k < this.topBraces.length; k++) {\n          const brace = this.topBraces[k]\n          const start = brace.start\n          const end = brace.end\n          const texte = brace.text\n          const type = brace.type ?? 'accolade'\n          const options = brace.options ?? {}\n          const justify = options.justify ?? 'center'\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          const lineHeight = options.lineHeight ?? '1.2em'\n          if (start != null && end != null && texte != null) {\n            ligneAccoladeH +=\n              type === 'flèche'\n                ? `<div class=\"SchemaTop\" style=\"grid-row: 1; grid-column-start: ${start + maxEnteteLength}; grid-column-end: ${end + maxEnteteLength}; text-align:center; border: none; --arrow-color: ${color}\">\n                    <div class=\"latexAccoladeTop\" style=\"text-align: ${justify}; color: ${color}; font-size: ${fontSize}; font-weight: ${fontWeight}; line-height: ${lineHeight}\">${texte}</div>\n                  <div class=\"horizontalArrow\">\n                    <div class=\"horizontalArrowHead\" style=\"transform: rotate(180deg);\"></div>\n                    <div class=\"horizontalArrowLine\"></div>\n                    <div class=\"horizontalArrowHead\"></div>\n                  </div>\n                </div>\\n`\n                : `<div class=\"SchemaTop\" style=\"grid-row: 1; grid-column-start: ${start + maxEnteteLength}; grid-column-end: ${end + maxEnteteLength}; text-align:center; border: none\"; --brace-color: ${color}\">\n                    <div class=\"latexAccoladeTop\" style=\"text-align: ${justify}; color: ${color}; font-size: ${fontSize}; font-weight: ${fontWeight}; line-height: ${lineHeight}\">${texte}</div>\n                    <div class=\"braceTop\">\n                      <div class=\"braceTopLeft\">\n                        <div class=\"curlTopLeftLeft\"></div>\n                        <div class=\"lineTopLeftMiddle\"></div>\n                        <div class=\"curlTopLeftRight\"></div>\n                      </div>\n                      <div class=\"braceTopRight\">\n                        <div class=\"curlTopRightLeft\"></div>\n                        <div class=\"lineTopRightMiddle\"></div>\n                        <div class=\"curlTopRightRight\"></div>\n                      </div>\n                    </div>\n                </div>\\n`\n          }\n        }\n      }\n\n      // Générer les lignes de barres avec entête et gestion du spacing\n      const lignesHtml: string[] = []\n      let offset = 0\n      for (let i = 0; i < this.lignes.length; i++) {\n        const ligne = this.lignes[i]\n        const entete = ligne.entete?.content ?? ''\n        const couleurEntete = ligne.entete?.couleur ?? 'black'\n        const fontSizeEntete = ligne.entete?.fontSize ?? '1em'\n        const fontWeightEntete = ligne.entete?.fontWeight ?? 'normal'\n        const spacing = ligne.spacing ?? 0\n        const lineHeight = ligne.height ?? '1.2em'\n\n        let barresHtml = ''\n        let start = 1\n        const barres = ligne.barres ?? []\n        for (let k = 0; k < barres.length; k++) {\n          const barre = barres[k]\n          if (barre.length <= 0) continue\n          if (barre.content == null) barre.content = ''\n          if (barre.color == null) barre.color = 'lightgray'\n          if (barre.options == null) barre.options = {}\n          const options = barre.options ?? {}\n          const justify = options.justify ?? 'center'\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          const style = options.style ?? ''\n          const type = barre.type ?? 'boite'\n          const borderless = options.borderless ?? false // Si on veut une boîte sans bordure\n          barresHtml +=\n            type === 'boite'\n              ? `<div class=\"SchemaItem\" style=\"grid-row: ${i + 2 + offset};\n                  grid-column-start: ${start + maxEnteteLength};\n                  grid-column-end: ${start + barre.length + maxEnteteLength};\n                  background-color:${barre.color};\n                  justify-content:${justify};\n                  color:${color};\n                  font-size:${fontSize};\n                  font-weight:${fontWeight};\n                  line-height:${lineHeight};\n                  ${\n                    borderless\n                      ? 'border: none;'\n                      : k > 0\n                        ? 'border-left: none;'\n                        : 'border: solid 1px black;'\n                  }\n                   ${style}\">\n                ${\n                  barre.content.includes('<br>')\n                    ? `<div style=\"text-align: center;\">${barre.content}</div>\\n`\n                    : barre.content\n                }\n              </div>\\n`\n              : `<div class=\"SchemaItem\" style=\"grid-row: ${i + 2 + offset};\n                  grid-column-start: ${start + maxEnteteLength};\n                  grid-column-end: ${start + barre.length + maxEnteteLength};\n                  background-color:${barre.color};\n                  font-size:${fontSize};\n                  font-weight:${fontWeight};\n                  line-height:${lineHeight};\n                  display: flex;\n                  flex-direction: column;\n                  align-items: center;\n                  justify-content: center;\n                  border: ${borderless ? 'none' : 'solid 1px black'};\n                  ${style}\">\n                <div class=\"horizontalArrow\" style=\"width: 100%;margin-top: 0.5em; --arrow-color: ${color}\">\n                  <div class=\"horizontalArrowHead\" style=\"border-left: 12px solid ${color}; transform: rotate(180deg);\"></div>\n                  <div class=\"horizontalArrowLine\" style=\"--arrow-color: ${color}\"></div>\n                  <div class=\"horizontalArrowHead\" style=\"border-left: 12px solid ${color};\"></div>\n                </div>\n                <div style=\"width: 100%; text-align: center; color: ${color};\">${barre.content}</div>\n              </div>\\n`\n\n          start += barre.length\n        }\n        // Si on doit afficher une colonne d'entête\n        if (hasEntete) {\n          // On met un div d'entête devant la ligne\n          // On peut fixer la largeur en \"em\" selon maxEnteteLength, ou laisser le CSS gérer\n          lignesHtml.push(\n            `<div class=\"SchemaItem\" style=\"grid-row: ${i + 2 + offset}; grid-column-start: 1; grid-column-end: ${maxEnteteLength + 1}; border: none; color: ${couleurEntete}; font-size: ${fontSizeEntete}; font-weight: ${fontWeightEntete}\">${entete}</div>\\n` +\n              barresHtml,\n          )\n        } else {\n          lignesHtml.push(barresHtml)\n        }\n        // Espacement vertical si spacing > 0 (on ajoute un div vide)\n        if (spacing > 0) {\n          lignesHtml.push(\n            `<div class=\"SchemaItem\" style=\"grid-row: ${i + 3 + offset}; grid-column-start: 1; grid-column-end: 2; border: none; height: ${spacing}em\"></div>\\n`,\n          )\n          offset++\n        }\n      }\n\n      let ligneAccoladeB = ''\n      if (this.bottomBraces) {\n        for (let k = 0; k < this.bottomBraces.length; k++) {\n          const brace = this.bottomBraces[k]\n          const start = brace.start\n          const end = brace.end\n          const texte = brace.text\n          const type = brace.type ?? 'accolade'\n          const options = brace.options ?? {}\n          const justify = options.justify ?? 'center'\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          const lineHeight = options.lineHeight ?? '1.2em'\n          if (start != null && end != null && texte != null) {\n            ligneAccoladeB +=\n              type === 'flèche'\n                ? `<div class=\"SchemaBottom\" style=\"grid-row: ${this.lignes.length + 2 + offset}; grid-column-start: ${start}; grid-column-end: ${end}; text-align:center; border: none; --brace-color: ${color}\">\n                  <div class=\"horizontalArrow\">\n                    <div class=\"horizontalArrowHead\" style=\"transform: rotate(180deg);\"></div>\n                    <div class=\"horizontalArrowLine\"></div>\n                    <div class=\"horizontalArrowHead\"></div>\n                  </div>\n                    <div class=\"latexAccoladeBottom\" style=\"text-align: ${justify}; color: ${color}; font-size: ${fontSize}; font-weight: ${fontWeight}; line-height: ${lineHeight}\">${texte}</div>\n                </div>\\n`\n                : `<div class=\"SchemaBottom\" style=\"grid-row: ${this.lignes.length + 2 + offset}; grid-column-start: ${start + maxEnteteLength}; grid-column-end: ${end + maxEnteteLength}; text-align:center; border: none; --brace-color: ${color}\">\n                    <div class=\"braceBottom\">\n                      <div class=\"braceBottomLeft\">\n                        <div class=\"curlBottomLeftLeft\"></div>\n                        <div class=\"lineBottomLeftMiddle\"></div>\n                        <div class=\"curlBottomLeftRight\"></div>\n                      </div>\n                    <div class=\"braceBottomRight\">\n                      <div class=\"curlBottomRightLeft\"></div>\n                      <div class=\"lineBottomRightMiddle\"></div>\n                      <div class=\"curlBottomRightRight\"></div>\n                    </div>\n                  </div>\n                <div class=\"latexAccoladeBottom\" style=\"text-align: ${justify}; color: ${color}; font-size: ${fontSize}; font-weight: ${fontWeight}; line-height: ${lineHeight}\">\n                  ${\n                    texte.includes('<br>')\n                      ? `<div style=\"text-align: center;\">${texte}</div>\\n`\n                      : `${texte}`\n                  }</div>\\n\n                  </div>\\n`\n          }\n        }\n      }\n      let ligneAccoladeDroite = ''\n      if (this.rightBraces) {\n        for (let k = 0; k < this.rightBraces.length; k++) {\n          const gridLength = Math.max(\n            ...this.lignes.map(\n              (l) =>\n                l.barres.reduce((acc, b) => acc + (b.length ?? 0), 0) +\n                (maxEnteteLength ?? 0) +\n                1,\n            ),\n          ) // Longueur totale de la grille\n          const brace = this.rightBraces[k]\n          const start = brace.start\n          const end = brace.end\n          const texte = brace.text\n          // const type = brace.type ?? 'accolade'\n          const options = brace.options ?? {}\n          const justify = options.justify ?? 'center'\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          if (start != null && end != null && texte != null) {\n            ligneAccoladeDroite += `<div class=\"SchemaRight\" style=\"grid-row: ${start}/${end}; grid-column-start: ${gridLength + 1}; grid-column-end: ${gridLength + 2}; text-align:center; border: none; --brace-color: ${color}\">\n    <div class=\"braceRight\">\n      <div class=\"braceRightTop\">\n        <div class=\"curlRightTopTop\"></div>\n        <div class=\"lineRightTopMiddle\"></div>\n        <div class=\"curlRightTopBottom\"></div>\n      </div>\n      <div class=\"braceRightBottom\">\n        <div class=\"curlRightBottomTop\"></div>\n        <div class=\"lineRightBottomMiddle\"></div>\n        <div class=\"curlRightBottomBottom\"></div>\n      </div>\n    </div>\n  </div>\n    <div class=\"latexAccoladeRight\" style=\"grid-row: ${Math.round((start + end) / 2) - 1}; grid-column-start: ${gridLength + 2}; grid-column-end: ${gridLength + 10};text-align: ${justify}; color: ${color}; font-size: ${fontSize}; font-weight: ${fontWeight}\">\n     <div style=\"display: inline-block; text-align: center;\">${texte}</div>\\n\n    </div>\\n`\n          }\n        }\n      }\n      return `<div class=\"SchemaContainer\">${ligneAccoladeH}\\n${lignesHtml.join('\\n')}\\n${ligneAccoladeB}${ligneAccoladeDroite}</div>\\n`\n    } else {\n      // latex\n      // Trouver la largeur max des entêtes (en nombre de caractères)\n      let maxEnteteLength = 0\n      let hasEntete = false\n      for (const ligne of this.lignes) {\n        if (ligne.entete !== undefined) {\n          hasEntete = true\n          if ((ligne.entete.longueur ?? 0) > maxEnteteLength) {\n            maxEnteteLength = ligne.entete.longueur ?? 0\n          }\n        }\n      }\n      // Si aucune entête n'est définie, on ne met pas de colonne d'entête\n      // On peut aussi utiliser la plus grande largeur réelle (en px) mais ici on reste simple\n      let latex = `\\\\begin{tikzpicture}[scale=${texScale}]\\n`\n      if (this.topBraces) {\n        for (let k = 0; k < this.topBraces.length; k++) {\n          const brace = this.topBraces[k]\n          const start =\n            (brace.start + (hasEntete ? maxEnteteLength : 0) - 1) * texScale\n          const end =\n            (brace.end + (hasEntete ? maxEnteteLength : 0) - 1) * texScale\n          const texte = brace.text\n          const type = brace.type ?? 'accolade'\n          const options = brace.options ?? {}\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          if (start != null && end != null && texte != null) {\n            let styleTexte = ''\n            if (color && !texte.includes('tikzpicture'))\n              styleTexte += `\\\\textcolor{${color}}{`\n            let fontSizeCmd = ''\n            if (fontSize) {\n              if (fontSize === 'small') fontSizeCmd = '\\\\small '\n              else if (fontSize === 'large') fontSizeCmd = '\\\\large '\n              else if (fontSize === 'Large') fontSizeCmd = '\\\\Large '\n              else if (fontSize === 'footnotesize')\n                fontSizeCmd = '\\\\footnotesize '\n            }\n            let fontWeightCmd = ''\n            if (fontWeight === 'bold') fontWeightCmd = '\\\\textbf{'\n            const texteLatex = `${styleTexte}${fontSizeCmd}${fontWeightCmd}${texte}${fontWeight === 'bold' ? '}' : ''}${color && !texte.includes('tikzpicture') ? '}' : ''}`\n            if (type === 'flèche') {\n              latex += `\\\\draw[<->,thick, draw=${color}] (${start.toFixed(1)},3.2) -- (${end.toFixed(1)},3.2) node[above, pos=0.5] {${texteLatex}};\\n`\n            } else {\n              latex += `\\\\draw[decorate,decoration={brace,amplitude=10pt},xshift=0pt,yshift=0pt,draw=${color}] (${start.toFixed(1)},3) -- node[above=10pt, pos=0.5] {${texteLatex}} (${end.toFixed(1)},3);\\n`\n            }\n          }\n        }\n      }\n      let y = 3\n      for (let i = 0; i < this.lignes.length; i++) {\n        const ligne = this.lignes[i]\n        const entete = ligne.entete?.content ?? ''\n        const couleurEntete = ligne.entete?.couleur ?? 'black'\n        const fontSizeEntete = ligne.entete?.fontSize ?? '1em'\n        const fontWeightEntete = ligne.entete?.fontWeight ?? 'normal'\n\n        const barres = ligne.barres ?? []\n        if (hasEntete) {\n          // On ajoute une barre vide pour l'entête\n          barres.unshift({\n            color: 'white',\n            length: maxEnteteLength,\n            content: entete,\n            type: 'boite',\n            options: {\n              color: couleurEntete,\n              justify: 'center',\n              style: 'borderless',\n              fontSize: fontSizeEntete,\n              fontWeight: fontWeightEntete,\n            },\n          })\n        }\n        let start = 0\n        const lineHeight = ligne.height ?? '1.2em'\n\n        let rectHeight = 1\n        if (lineHeight && typeof lineHeight === 'string') {\n          const match = lineHeight.match(/^([\\d.]+)(em|pt|cm|mm)?$/)\n          if (match) {\n            const value = parseFloat(match[1])\n            if (match[2] === 'em' || !match[2]) {\n              rectHeight = value / 1.2\n            } else if (match[2] === 'pt') {\n              rectHeight = value / 12\n            } else if (match[2] === 'cm') {\n              rectHeight = value / 0.508\n            }\n          }\n        }\n\n        y -= rectHeight * texScale\n\n        for (let k = 0; k < barres.length; k++) {\n          const barre = barres[k]\n          if (barre.length <= 0) continue\n          if (barre.content == null) barre.content = ''\n          if (barre.color == null) barre.color = 'lightgray'\n          if (barre.options == null) barre.options = {}\n          const options = barre.options ?? {}\n          const justify = options.justify ?? 'center'\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n\n          let styleTexte = ''\n          if (color && !barre.content.includes('tikzpicture'))\n            styleTexte += `\\\\textcolor{${color}}{`\n          let fontSizeCmd = ''\n          if (fontSize) {\n            if (fontSize === 'small') fontSizeCmd = '\\\\small '\n            else if (fontSize === 'large') fontSizeCmd = '\\\\large '\n            else if (fontSize === 'Large') fontSizeCmd = '\\\\Large '\n            else if (fontSize === 'footnotesize')\n              fontSizeCmd = '\\\\footnotesize '\n          }\n          let fontWeightCmd = ''\n          if (fontWeight === 'bold') fontWeightCmd = '\\\\textbf{'\n          const texteLatex = barre.content.includes('<br>')\n            ? `${styleTexte}${fontSizeCmd}${fontWeightCmd}\\\\shortstack{${barre.content.replaceAll('<br>', '\\\\\\\\')}}${fontWeight === 'bold' ? '}' : ''}${color && !barre.content.includes('tikzpicture') ? '}' : ''}`\n            : `${styleTexte}${fontSizeCmd}${fontWeightCmd}${barre.content}${fontWeight === 'bold' ? '}' : ''}${color ? '}' : ''}`\n          if (barre.type === 'boite') {\n            if (barre.options?.style === 'borderless') {\n              latex += `\\\\draw[fill=${barre.color}, draw=none] (${(start * texScale).toFixed(1)},${y.toFixed(1)}) rectangle (${((start + barre.length) * texScale).toFixed(1)},${(rectHeight * texScale + y).toFixed(1)});\\n`\n            } else {\n              latex += `\\\\draw[fill=${barre.color}] (${(start * texScale).toFixed(1)},${y.toFixed(1)}) rectangle (${((start + barre.length) * texScale).toFixed(1)},${(rectHeight * texScale + y).toFixed(1)});\\n`\n            }\n            let anchor = 'center'\n            let align = 'center'\n            let x = ((start + barre.length / 2) * texScale).toFixed(1)\n            if (justify === 'start') {\n              anchor = 'west'\n              align = 'left'\n              x = (start * texScale).toFixed(1)\n            } else if (justify === 'end') {\n              anchor = 'east'\n              align = 'right'\n              x = ((start + barre.length) * texScale).toFixed(1)\n            }\n            latex += `\\\\node[anchor=${anchor}, align=${align}] at (${x},${(y + rectHeight / 2).toFixed(1)}) {${texteLatex}};\\n`\n          } else if (barre.type === 'flèche') {\n            latex += `\\\\draw[<->,thick, draw=${color}] (${(start * texScale).toFixed(1)},${(y + 0.56).toFixed(1)}) -- (${((start + barre.length) * texScale).toFixed(1)},${(y + 0.56).toFixed(1)}) node[pos=0.5, below] {${texteLatex}};\\n`\n            // Ligne verticale à l'extrémité droite de la flèche\n            latex += `\\\\draw[dashed, thick, draw=${color}] (${((start + barre.length) * texScale).toFixed(1)},${y}) -- (${((start + barre.length) * texScale).toFixed(1)},${(y + rectHeight * texScale).toFixed(1)});\\n`\n          } else {\n            latex += `\\\\draw[fill=${barre.color}] (${(start * texScale).toFixed(1)},${y.toFixed(1)}) rectangle (${((start + barre.length) * texScale).toFixed(1)},${(rectHeight * texScale + y).toFixed(1)}) node[pos=0.5] {${texteLatex}};\\n`\n          }\n\n          // On met à jour le start pour le prochain élément\n          start += barre.length // On ajoute un espace de 0.5 pour le prochain élément\n        }\n        y -= ligne?.spacing ?? 0\n      }\n      if (this.bottomBraces) {\n        for (let k = 0; k < this.bottomBraces.length; k++) {\n          const brace = this.bottomBraces[k]\n          const start =\n            (brace.start + (hasEntete ? maxEnteteLength : 0) - 1) * texScale\n          const end =\n            (brace.end + (hasEntete ? maxEnteteLength : 0) - 1) * texScale\n          const texte = brace.text\n          const type = brace.type ?? 'accolade'\n          const options = brace.options ?? {}\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          if (start != null && end != null && texte != null) {\n            let styleTexte = ''\n            if (color && !texte.includes('tikzpicture'))\n              styleTexte += `\\\\textcolor{${color}}{`\n            let fontSizeCmd = ''\n            if (fontSize) {\n              if (fontSize === 'small') fontSizeCmd = '\\\\small '\n              else if (fontSize === 'large') fontSizeCmd = '\\\\large '\n              else if (fontSize === 'Large') fontSizeCmd = '\\\\Large '\n              else if (fontSize === 'footnotesize')\n                fontSizeCmd = '\\\\footnotesize '\n            }\n            let fontWeightCmd = ''\n            if (fontWeight === 'bold') fontWeightCmd = '\\\\textbf{'\n            const texteLatex = texte.includes('<br>')\n              ? `${styleTexte}${fontSizeCmd}${fontWeightCmd}\\\\shortstack{${texte.replaceAll('<br>', '\\\\\\\\')}}${fontWeight === 'bold' ? '}' : ''}${color && !texte.includes('tikzpicture') ? '}' : ''}`\n              : `${styleTexte}${fontSizeCmd}${fontWeightCmd}${texte}${fontWeight === 'bold' ? '}' : ''}${color ? '}' : ''}`\n            if (type === 'flèche') {\n              latex += `\\\\draw[<->,thick, draw=${color}] (${start.toFixed(1)},${y - 0.2}) -- (${end.toFixed(1)},${y - 0.2}) node[below, pos=0.5] {${texteLatex}};\\n`\n            } else {\n              latex += `\\\\draw[decorate,decoration={brace,amplitude=10pt},xshift=0pt,yshift=0pt, draw=${color}] (${end.toFixed(1)},${y}) -- node[below=10pt, pos=0.5] {${texteLatex}} (${start.toFixed(1)},${y});\\n`\n            }\n          }\n        }\n      }\n      if (this.rightBraces) {\n        const longueurBarres = this.lignes.map(\n          (l) =>\n            l.barres.reduce((acc, b) => acc + (b.length ?? 0), 0) +\n            (maxEnteteLength ?? 0),\n        )\n        const gridLength = Math.max(...longueurBarres) // Longueur totale de la grille\n        for (let k = 0; k < this.rightBraces.length; k++) {\n          const brace = this.rightBraces[k]\n          const start =\n            3 +\n            (this.topBraces && this.topBraces.length > 0 ? 2 : 1) * texScale -\n            brace.start * texScale\n          const end =\n            3 +\n            (this.topBraces && this.topBraces.length > 0 ? 2 : 1) * texScale -\n            brace.end * texScale\n          const texte = brace.text\n          // const type = brace.type ?? 'accolade'\n          const options = brace.options ?? {}\n          const color = options.color ?? 'black'\n          const fontSize = options.fontSize ?? '1em'\n          const fontWeight = options.fontWeight ?? 'normal'\n          if (start != null && end != null && texte != null) {\n            let styleTexte = ''\n            if (color && !texte.includes('tikzpicture'))\n              styleTexte += `\\\\textcolor{${color}}{`\n            let fontSizeCmd = ''\n            if (fontSize) {\n              if (fontSize === 'small') fontSizeCmd = '\\\\small '\n              else if (fontSize === 'large') fontSizeCmd = '\\\\large '\n              else if (fontSize === 'Large') fontSizeCmd = '\\\\Large '\n              else if (fontSize === 'footnotesize')\n                fontSizeCmd = '\\\\footnotesize '\n            }\n            let fontWeightCmd = ''\n            if (fontWeight === 'bold') fontWeightCmd = '\\\\textbf{'\n            const texteLatex = texte.includes('<br>')\n              ? `${styleTexte}${fontSizeCmd}${fontWeightCmd}\\\\shortstack{${texte.replaceAll('<br>', '\\\\\\\\')}}${fontWeight === 'bold' ? '}' : ''}${color && !texte.includes('tikzpicture') ? '}' : ''}`\n              : `${styleTexte}${fontSizeCmd}${fontWeightCmd}${texte}${fontWeight === 'bold' ? '}' : ''}${color ? '}' : ''}`\n\n            latex += `\\\\draw[decorate,decoration={brace,amplitude=10pt},xshift=0pt,yshift=0pt, draw=${color}]  (${((gridLength + 0.3) * texScale).toFixed(1)},${start.toFixed(1)}) -- (${((gridLength + 0.3) * texScale).toFixed(1)},${end.toFixed(1)});\\n`\n            // Ajoute un petit espace horizontal (par exemple 0.3) entre l'accolade et le texte\n            latex += `\\\\node[anchor=west, align=left] at (${(gridLength * texScale + 0.8).toFixed(1)},${((start + end) / 2).toFixed(1)}) {${texteLatex}};\\n`\n          }\n        }\n      }\n      latex += '\\\\end{tikzpicture}'\n      return latex\n    }\n  }\n\n  /**\n   *\n   * @param nb1 Le premier facteur (celui de la ligne du haut)\n   * @param nb2 Le deuxième facteur (celui de l'accolade)\n   * @param precision Le nombre de décimales\n   * @param produit Le produit au format string si on veut écrire autre chose que '?' (écrit dans la case du dessous)\n   * @returns\n   */\n  static multiplication(\n    nb1: number | undefined,\n    nb2: number | undefined,\n    precision: number,\n    produit: string | undefined,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite({\n      topBraces: [\n        {\n          start: 1,\n          end: 8 + precision * 2,\n          text:\n            nb2 != null\n              ? `$${texNombre(nb2, precision)}\\\\text{ fois}$`\n              : '? fois',\n        },\n      ],\n      lignes: [\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content: nb1 != null ? `$${texNombre(nb1, precision)}$` : '?',\n              type: 'boite',\n            },\n            {\n              color: 'lightgray',\n              length: 3,\n              content: '\\\\ldots',\n              type: 'boite',\n            },\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content: nb1 != null ? `$${texNombre(nb1, precision)}$` : '?',\n              type: 'boite',\n            },\n          ],\n        },\n        {\n          barres: [\n            {\n              color: 'white',\n              length: 7 + precision * 2,\n              content: produit != null ? produit : '?',\n            }, // `${nb1 * nb2}`,\n          ],\n        },\n      ],\n    })\n    return seb\n  }\n\n  /**\n   *\n   * @param dividende Le dividende (écrit dans la case du dessous)\n   * @param quotient Le diviseur (nombre entier de fois écrit sur l'accolade)\n   * @param diviseur Le diviseur (écrit dans les cases du dessus)\n   * @param precision nombre de chiffres après la virgule du dividende et du diviseur\n   * @returns\n   */\n  static division(\n    dividende: number | undefined,\n    diviseur: number | undefined,\n    quotient: number | undefined,\n    precision: number,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite({\n      topBraces: [\n        {\n          start: 1,\n          end: 8 + 2 * precision,\n          text: quotient == null ? '? fois' : `${texNombre(quotient, 0)} fois`,\n        },\n      ],\n      lignes: [\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content:\n                diviseur == null ? '?' : `$${texNombre(diviseur, precision)}$`,\n              type: 'boite',\n            },\n            {\n              color: 'lightgray',\n              length: 3,\n              content: '\\\\ldots',\n              type: 'boite',\n            },\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content:\n                diviseur == null ? '?' : `$${texNombre(diviseur, precision)}$`,\n              type: 'boite',\n            },\n          ],\n        },\n        {\n          barres: [\n            {\n              color: 'white',\n              length: 7 + 2 * precision,\n              content:\n                dividende == null\n                  ? '?'\n                  : `$${texNombre(dividende, precision)}$`,\n            },\n          ],\n        },\n      ],\n    })\n    return seb\n  }\n\n  static multiplicationPuisDivisionAvecReste(\n    nbFois: number | string | undefined,\n    nb1: number | string | undefined,\n    nb2: number | string | undefined,\n    nbParts: number | String | undefined,\n    reste: number | string | undefined,\n    precison: number,\n  ): SchemaEnBoite {\n    const longueur = typeof nbFois === 'number' ? nbFois * 3 : 10\n    const seb = new SchemaEnBoite({\n      topBraces:\n        nbFois != null\n          ? typeof nbFois === 'string'\n            ? [\n                {\n                  start: 1,\n                  end: longueur + 1,\n                  text: `${nbFois}`,\n                  type: 'accolade',\n                },\n              ]\n            : [\n                {\n                  start: 1,\n                  end: longueur + 1,\n                  text: `${texNombre(nbFois, 0)}`,\n                  type: 'accolade',\n                },\n              ]\n          : [{ start: 1, end: longueur + 1, text: '? fois', type: 'accolade' }],\n      lignes: [\n        {\n          spacing: 0.5,\n          barres:\n            typeof nbFois === 'number'\n              ? range(nbFois - 1).map((i) => {\n                  const nb1Tex =\n                    nb1 != null\n                      ? typeof nb1 === 'number'\n                        ? `$${texNombre(nb1, precison)}$`\n                        : `${nb1}`\n                      : '?'\n                  return {\n                    color: 'white',\n                    length: 3,\n                    content: nb1Tex,\n                    type: 'boite',\n                  }\n                })\n              : [\n                  {\n                    color: 'lightgray',\n                    length: 3,\n                    content:\n                      nb1 != null\n                        ? typeof nb1 === 'number'\n                          ? `$${texNombre(nb1, precison)}$`\n                          : `${nb1}`\n                        : '?',\n                    type: 'boite',\n                  },\n                  {\n                    color: 'lightgray',\n                    length: longueur - 3,\n                    content: '\\\\ldots',\n                    type: 'boite',\n                    options: { justify: 'start' },\n                  },\n                ],\n        },\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 3,\n              content:\n                nb2 != null\n                  ? typeof nb2 === 'number'\n                    ? `$${texNombre(nb2, precison)}$`\n                    : `${nb2}`\n                  : '?',\n              type: 'boite' as const,\n            },\n            {\n              color: 'lightgray',\n              length: longueur - 6,\n              content: '\\\\ldots',\n              type: 'boite' as const,\n              options: { justify: 'start' as 'start' },\n            },\n            {\n              color: 'lightgray',\n              length: 3,\n              content:\n                reste != null\n                  ? typeof reste === 'number'\n                    ? `$${texNombre(reste, precison)}$`\n                    : `${reste}`\n                  : '?',\n              type: 'boite' as const,\n              options: { justify: 'center' as const },\n            },\n          ],\n        },\n      ],\n      bottomBraces: [\n        {\n          start: 1,\n          end: longueur - 2,\n          text:\n            nbParts != null\n              ? typeof nbParts === 'string'\n                ? nbParts\n                : `$${texNombre(Number(nbParts), precison)}$`\n              : '?',\n          type: 'accolade',\n        },\n      ],\n    })\n\n    return seb\n  }\n\n  /**\n   *\n   * @param diviseur diviseur (est écrit dans les cases du dessus)\n   * @param dividende dividende (est écrit dans la case du dessous, mettre undefined pour avoir un ?)\n   * @param quotient Le nombre de fois écrit sur l'accolade (un string qui peut être égal à '?')\n   * @param reste Le reste de la division (un string qui peut être égal à '?')\n   * @param precision\n   * @returns\n   */\n  static divisionAvecReste(\n    dividende: number | undefined,\n    diviseur: number | undefined,\n    quotient: number | undefined,\n    precision: number,\n    reste?: string,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite({\n      topBraces: [\n        {\n          start: 1,\n          end: 8 + 2 * precision,\n          text: quotient == null ? '? fois' : `$${quotient}$ fois`,\n        },\n      ],\n      lignes: [\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content:\n                diviseur == null ? '?' : `$${texNombre(diviseur, precision)}$`,\n            },\n            { color: 'lightgray', length: 3, content: '\\\\ldots' },\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content:\n                diviseur == null ? '?' : `$${texNombre(diviseur, precision)}$`,\n            },\n            { color: 'lightgray', length: 2, content: reste ?? '?' },\n          ],\n        },\n        {\n          barres: [\n            {\n              color: 'white',\n              length: 9 + 2 * precision,\n              content:\n                dividende == null\n                  ? '?'\n                  : `$${texNombre(dividende, precision)}$`,\n            },\n          ],\n        },\n      ],\n    })\n    return seb\n  }\n\n  static addition(\n    nb1: number | undefined,\n    nb2: number | undefined,\n    precision: number,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite({\n      lignes: [\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content: nb1 != null ? `$${texNombre(nb1, precision)}$` : '?',\n            },\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content: nb2 != null ? `$${texNombre(nb2, precision)}$` : '?',\n            },\n          ],\n        },\n        {\n          barres: [{ color: 'white', length: 4 + precision * 2, content: '?' }],\n        },\n      ],\n    })\n    return seb\n  }\n\n  static additionPartiesTout(\n    tout: number | string | undefined,\n    precision: number,\n    parties: (number | string | undefined)[],\n  ): SchemaEnBoite {\n    const nbParties = parties.length\n    const partieLength = nbParties < 3 ? 4 : 3\n    const seb = new SchemaEnBoite({\n      topBraces: [\n        {\n          start: 1,\n          end: nbParties * partieLength + 1,\n          text:\n            tout != null\n              ? typeof tout === 'string'\n                ? tout\n                : `$${texNombre(tout, precision)}$`\n              : '?',\n          type: 'accolade',\n        },\n      ],\n      lignes: [\n        {\n          barres: parties.map((partie, index) =>\n            Object.assign(\n              {\n                color: 'lightgray',\n                length: partieLength,\n                content:\n                  partie != null\n                    ? typeof partie === 'string'\n                      ? partie\n                      : `$${texNombre(Number(partie), precision)}$`\n                    : '?',\n              },\n              {},\n            ),\n          ),\n        },\n      ],\n    })\n    return seb\n  }\n\n  static additionPartiesToutComparaison(\n    partie1: number | undefined,\n    partie2: number | undefined,\n    difference: number | undefined,\n    tout: number | undefined,\n    precision: number,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite({\n      rightBraces: [\n        {\n          start: 1,\n          end: 5,\n          text: tout != null ? `${texNombre(tout, precision)}$` : '?',\n          type: 'accolade',\n        },\n      ],\n      lignes: [\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 8 + precision,\n              content:\n                partie1 == null ? '?' : `$${texNombre(partie1, precision)}$`,\n            },\n          ],\n        },\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 4 + precision,\n              content:\n                partie2 == null ? '?' : `$${texNombre(partie2, precision)}$`,\n            },\n            {\n              color: 'white',\n              type: 'flèche',\n              length: 4 + precision,\n              content:\n                difference != null\n                  ? `$${texNombre(difference, precision)}$`\n                  : 'différence',\n              options: {\n                style:\n                  'border-left: none;border-top: none; border-bottom: none;border-right: dashed;',\n              },\n            },\n          ],\n        },\n      ],\n    })\n    return seb\n  }\n\n  static additionPartiesToutComparaison2(\n    partie1: string,\n    partie2: string,\n    partie3: string,\n    difference: string,\n    tout?: string,\n    afficherTout?: boolean,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite(\n      afficherTout\n        ? Object.assign(\n            {},\n            {\n              lignes: [\n                {\n                  spacing: 0.5,\n                  barres: [\n                    { color: 'lightgray', length: 3, content: partie1 },\n                    { color: 'lightgray', length: 7, content: partie2 },\n                  ],\n                },\n                {\n                  barres: [\n                    { color: 'lightgray', length: 6, content: partie3 },\n                    {\n                      color: 'white',\n                      type: 'flèche' as const,\n                      length: 4,\n                      content: difference,\n                      options: {\n                        style:\n                          'border-left: none;border-top: none; border-bottom: none;border-right: dashed;',\n                      },\n                    },\n                  ],\n                },\n              ],\n              topBraces: [\n                {\n                  start: 1,\n                  end: 11,\n                  text: tout,\n                  type: 'accolade',\n                },\n              ],\n            },\n          )\n        : Object.assign(\n            {},\n            {\n              lignes: [\n                {\n                  spacing: 0.5,\n                  barres: [\n                    { color: 'lightgray', length: 3, content: partie1 },\n                    { color: 'lightgray', length: 7, content: partie2 },\n                  ],\n                },\n                {\n                  barres: [\n                    { color: 'lightgray', length: 6, content: partie3 },\n                    {\n                      color: 'white',\n                      type: 'flèche' as const,\n                      length: 4,\n                      content: difference,\n                      options: {\n                        style:\n                          'border-left: none;border-top: none; border-bottom: none;border-right: dashed;',\n                      },\n                    },\n                  ],\n                },\n              ],\n            },\n          ),\n    )\n\n    return seb\n  }\n\n  static soustraction(\n    terme1: number | undefined,\n    difference: number | undefined,\n    terme2: number | undefined,\n    precision: number,\n  ): SchemaEnBoite {\n    const seb = new SchemaEnBoite({\n      lignes: [\n        {\n          barres: [\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content:\n                terme1 == null ? '?' : `$${texNombre(terme1, precision)}$`,\n            },\n            {\n              color: 'lightgray',\n              length: 2 + precision,\n              content:\n                terme2 == null ? '?' : `$${texNombre(terme2, precision)}$`,\n            },\n          ],\n        },\n        {\n          barres: [\n            {\n              color: 'white',\n              length: 4 + precision * 2,\n              content:\n                difference == null\n                  ? '?'\n                  : `$${texNombre(difference, precision)}$`,\n            },\n          ],\n        },\n      ],\n    })\n    return seb\n  }\n}\n"],"names":["SchemaEnBoite","lignes","bottomBraces","topBraces","rightBraces","__publicField","texScale","context","maxEnteteLength","hasEntete","ligne","ligneAccoladeH","k","brace","start","end","texte","type","options","justify","color","fontSize","fontWeight","lineHeight","lignesHtml","offset","i","entete","_a","couleurEntete","_b","fontSizeEntete","_c","fontWeightEntete","_d","spacing","barresHtml","barres","barre","style","borderless","ligneAccoladeB","ligneAccoladeDroite","gridLength","l","acc","b","latex","styleTexte","fontSizeCmd","fontWeightCmd","texteLatex","y","_e","_f","_g","_h","rectHeight","match","value","_i","anchor","align","x","longueurBarres","nb1","nb2","precision","produit","texNombre","dividende","diviseur","quotient","nbFois","nbParts","reste","precison","longueur","range","tout","parties","nbParties","partieLength","partie","index","partie1","partie2","difference","partie3","afficherTout","terme1","terme2"],"mappings":"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"}