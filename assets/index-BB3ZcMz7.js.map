{"version":3,"mappings":"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K,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACtE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACtE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACtE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACtE,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,K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CA,EACA,EACA,MACA,EACA,EACA,EACA,OACA,EACA,EACA,EACA,MACA,EACA,QACA,KACA,MAEJ,EACMC,GAAgC,CACpC,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,QACA,QACA,OACA,OACA,KACA,KACA,MACA,OACA,MACA,OAEF,MAAO,CACL,OACA,MACA,EACA,EACA,EACA,OACA,MACA,EACA,EACA,EACA,KACA,OACA,EACA,EACA,EACA,KACA,MACA,QACA,EACA,QAEJ,EACMC,GAA2C,CAC/C,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,QACA,QACA,MACA,OACA,MACA,OAEF,MAAO,CACL,EACA,EACA,EACA,MACA,EACA,EACA,EACA,OACA,EACA,EACA,EACA,MACA,EACA,QACA,QACA,MAEJ,EACMC,GAAqC,CACzC,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,QACA,QACA,MACA,OACA,MACA,OAEF,MAAO,CACL,EACA,EACA,EACA,MACA,EACA,EACA,EACA,OACA,EACA,EACA,EACA,MACA,EACA,QACA,QACA,MAEJ,EACMC,GAAiC,CACrC,OAAQ,CACN,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,IACA,KAEF,MAAO,CACL,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,IACA,IAEJ,EACMC,GAAuC,CAC3C,OAAQ,CAAC,MAAO,MAAO,OAAQ,MAAO,KAAM,OAAQ,IAAK,GAAG,EAC5D,MAAO,CAAC,MAAO,MAAO,OAAQ,MAAO,KAAM,OAAQ,IAAK,GAAG,CAC7D,EACMC,GAA2C,CAC/C,OAAQ,CACN,MACA,MACA,OACA,MACA,QACA,KACA,MACA,OACA,IACA,IACA,WACA,aAEF,MAAO,CACL,QACA,MACA,MACA,KACA,OACA,MACA,MACA,WACA,OACA,YACA,IACA,IAEJ,EACMC,GAAwC,CAC5C,OAAQ,CAAC,MAAO,MAAO,OAAQ,MAAO,IAAK,OAAQ,IAAK,GAAG,EAC3D,MAAO,CAAC,MAAO,MAAO,OAAQ,MAAO,IAAK,OAAQ,IAAK,GAAG,CAC5D,EACMC,GAAsC,CAC1C,OAAQ,CACN,MACA,MACA,OACA,MACA,OACA,IACA,IACA,IACA,QACA,OACA,KACA,MACA,QACA,MACA,UACA,aAEF,MAAO,CACL,MACA,MACA,QACA,MACA,OACA,MACA,KACA,OACA,IACA,IACA,MACA,UACA,IACA,OACA,QACA,YAEJ,EACMC,GAAkC,CACtC,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,MACA,KACA,MACA,OACA,YACA,QACA,MACA,OACA,MACA,MACA,OACA,QACA,KACA,QACA,cACA,QACA,SACA,YAEF,MAAO,CACL,OACA,QACA,KACA,MACA,EACA,EACA,EACA,MACA,KACA,OACA,QACA,EACA,EACA,EACA,QACA,cACA,SACA,QACA,EACA,EACA,EACA,MACA,MACA,OACA,MACA,EACA,QACA,YAEJ,EAEMC,GAAmC,CACvC,OAAQ,CACN,WACA,UACA,QACA,WACA,UACA,QACA,KACA,UACA,WACA,WACA,eACA,gBACA,cACA,SACA,MACA,QACA,SACA,WACA,YACA,WACA,eACA,eACA,mBACA,QAEF,MAAO,CACL,WACA,UACA,QACA,WACA,UACA,QACA,KACA,UACA,WACA,WACA,eACA,gBACA,cACA,SACA,MACA,QACA,SACA,WACA,YACA,WACA,eACA,eACA,mBACA,OAEJ,EAEMC,GAAoC,CACxC,OAAQ,CACN,OACA,QACA,WACA,QACA,QACA,QACA,YACA,cACA,MACA,SACA,QACA,KAEF,MAAO,CACL,OACA,QACA,WACA,QACA,QACA,QACA,YACA,cACA,MACA,SACA,QACA,IAEJ,EAEMC,GAAiC,CACrC,OAAQ,CACN,MACA,MACA,QACA,SACA,IACA,IACA,KACA,YACA,OACA,OACA,MACA,SAEF,MAAO,CACL,MACA,MACA,QACA,SACA,IACA,IACA,KACA,YACA,OACA,OACA,MACA,QAE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ASs6B,GACT,KAAM,EACN,MAAO,YACP,QAAS,EACX,EAEa0C,GAAsB,CACjC,QAASnB,GACT,KAAM,EACN,MAAO,uBACP,QAAS,EACX,EAEaoB,GAAiC,CAC5C,QAAS1C,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEa2C,GAAkC,CAC7C,QAASzC,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEa0C,GAAqC,CAChD,QAAS3C,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEa4C,GAAgC,CAC3C,QAAS1C,GACT,KAAM,EACN,MAAO,uBACP,QAAS,EACX,EAEa2C,GAA4C,CACvD,QAAS1C,GACT,KAAM,EACN,MAAO,0BACP,QAAS,EACX,EAEa2C,GAA4B,CACvC,QAAS1C,GACT,KAAM,EACN,MAAO,0BACP,QAAS,EACX,EAEa2C,GAA6B,CACxC,QAAS1C,GACT,KAAM,EACN,MAAO,eACP,QAAS,EACX,EAEa9tC,GAAqB,CAChC,QAASkuC,GACT,KAAM,EACN,MAAO,QACP,QAAS,EACX,EAEauC,GAAuB,CAClC,QAAStC,GACT,KAAM,EACN,MAAO,mBACP,QAAS,EACX,EAEaxM,GAAyB,CACpC,QAASyM,GACT,KAAM,EACN,MAAO,cACP,QAAS,EACX,EAEasC,GAAuB,CAClC,QAASrC,GACT,KAAM,EACN,MAAO,QACP,QAAS,EACX,EAEasC,GAA8B,CACzC,QAASrC,GACT,KAAM,EACN,MAAO,gBACP,QAAS,EACX,EAEasC,GAAuB,CAClC,QAASrC,GACT,KAAM,EACN,MAAO,gBACP,QAAS,EACX,EACasC,GAA0B,CACrC,QAASrC,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEasC,GAAyB,CACpC,QAAS9B,GACT,KAAM,EACN,MAAO,YACP,QAAS,EACX,EAEa+B,GAAuB,CAClC,QAAS7B,GACT,KAAM,EACN,MAAO,QACP,QAAS,EACX,EAEa8B,GAA0B,CACrC,QAASjD,GACT,KAAM,EACN,MAAO,YACP,QAAS,EACX,EAEakD,GAAgC,CAC3C,QAASjD,GACT,KAAM,EACN,MAAO,mB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AA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;A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","names":["minVersion","checkBrowserVersion","uap","UAParser","browser","cpu","device","os","ua","browserName","browserVersion","popupMessage","url","key","value","localVersion","fetchServerVersion","version","error","response","getLocalVersion","forceLocalVersion","checkForServerUpdate","KEYBOARD_CATEGORIES","isKeyboardCategory","category","KeyboardType","obj","convertToKeyboardCategory","str","convertKeyboardTypeToBlocks","type","buildDataKeyboardFromStyle","style","blocks","styleValues","unitValuesMatches","unitValues","e","s","v","element","index","array","getKeyboardShortcusts","mf","keyboardShortcuts","shortcutsByKeyboards","keyboards","_b","_a","keyboard","_CRC32","table","i","c","k","bytes","crc","strings","combinedCRC","input","inputs","resu","__publicField","CRC32","produitsEnCroix","a","b","d","result","texNombre","n","precision","Decimal","quatriemeProportionnelle","p4","extraireRacineCarree","reste","sommeDesTermesParSigne","liste","sommeDesPositifs","sommeDesNegatifs","context","epsilon","compareArrays","array1","array2","areSameObject","o1","o2","areSameValues","areSameArray","ar1","ar2","elt","v1","v2","creerCouples","E1","E2","nombreDeCouplesMin","forcerElementsDifferents","temp","j","shuffle","enleveElement","item","compteOccurences","cpt","enleveElementBis","tableaucopie","enleveElementNo","remplaceDansTableau","arr","search","replace","completerNombresUniques","tableau","nbQuestions","valeurMax","existants","valeursManquantes","nombreAAjouter","ajouts","choice","listeAEviter","listebis","enleveDoublonNum","tolerance","kk","currentIndex","temporaryValue","randomIndex","arrayBis","shuffleLettres","txt","shuffle2tableaux","obj1","obj2","rnd","tmp1","tmp2","shuffle2tableauxSansModif","obj1bis","obj2bis","shuffle3tableaux","obj3","tmp3","combinaisonListes","tailleMinimale","l","combinaisonListes2","combinaisonListesSansChangerOrdre","getRandomSubarray","size","shuffled","min","listOfRandomIndexes","originalArraySize","nbOfIndexes","arrayCloneObject","clonedObj","arrayClone","originalArray","genererBinomesAleatoires","tab","options","premierNombre","dernierNombre","ordreCroissant","ordreDecroissant","binomes","isFractionEtendue","x","miseEnEvidence","texte","couleur","isArray","coloreUnSeulChiffre","position","getColorLatex","contenu","indexGauche","indexDroite","estDroite","partieEntiere","partieDecimale","avant","chiffreCible","apres","colored","pos","prefixe","suffixe","miseEnCouleur","texteEnCouleur","texteEnCouleurEtGras","barreTexte","text","texteGras","texteItalique","texteEnBoite","gcd","gcdMultiple","args","acc","current","isPrime","sqrt","pgcd","ppcm","ppcmListe","numbers","obtenirListeFacteursPremiers","facteurs","signe","nAbs","obtenirSemiPremier","max","listePremiers","listeNombresPremiersStrictJusqua","semiPremiers","semiPremier","indexAleatoire","factorisation","facto","texFactorisation","puissancesOn","texFacto","listeDesDiviseurs","diviseurs","estPremier","premierMultipleSuperieur","premierMultipleInferieur","borneSup","liste1000","cribleEratostheneN","tabEntiers","testMax","premiersEntreBornes","premiersASupprimer","premiersJusqueMax","decompositionFacteursPremiersArray","decomposition","obtenirListeNombresPremiers","prems","decompositionFacteursPremiers","premierAvec","inferieur","candidat","sommeDesChiffres","nString","somme","sommeString","arrondi","nombre","round","troncature","tmp","tronc","abs","triePositifsNegatifs","positifs","negatifs","nombreDeChiffresDansLaPartieDecimale","nb","except","sauf","nombreDeChiffresDansLaPartieEntiere","nombreDeChiffresDe","ordreDeGrandeur","range","rangeMinMax","step","range1","compareNombres","numTrie","unSiPositifMoinsUnSinon","tousDeMemeSigne","val","math","format","evaluate","sp","texRacineCarree","texNombreCoul","positif","negatif","nul","numberFormat","completerZeros","aussiCompleterEntiers","afficherNombre","texNombre2","rangVirgule","texNombre3","nombreAvecEspace","scientifiqueToDecimal","mantisse","exp","stringNombre","fonction","insereEspacesNombre","nbChiffresPartieEntiere","maximumSignificantDigits","trouveLaPrecision","fix","xx","nbFormatAnglais","texPrix","decimalToScientifique","nbDecimal","exposant","mantisseNb","formatMinute","minute","ecritureAlgebrique","ecritureParentheseSiNegatif","signeMoinsEnEvidence","r","p","definePropRo","prop","get","rationnalise","FractionEtendue","numDen","normalizeFraction","num","den","decimal","numDec","denDec","nDecimal","dDecimal","nNbChiffresDecimaux","dNbChiffresDecimaux","pow","facteur","prodNumDen","numIrred","denIrred","sign","pourcentage","signeString","texFraction","texFractionSR","texFSD","texFractionSignee","valeurDecimale","texFractionSaufUn","texFractionSaufUnSignee","texFSP","texParentheses","texFractionSimplifiee","estEntiere","estParfaite","estIrreductible","fractions","f","multiply","f2","lcm","f2Arg","simplify","f1","calcul","commonDenominator","coeffMultiplicatorA","coeffMultiplicatorB","fResult","simplification","symbole","space","space2","couleurFinale","listenum","listeden","listeNumvf","listeDenvf","numerateur","denominateur","redaction","redactionFinale","n2","n5","detaillee","rac","factoDen","factoNum","etape","exportedNouvelleVersionWrapper","numeroExercice","numeroQuestion","signature","seedrandom","exportedReinit","fig","Figure","leDragAndDrop","listener","exportedApplyNewSeed","seed","generateSeed","empreinteTexte","CryptoJS","exportedQuestionJamaisPosee","argsConcatenes","arg","empreinte","includeUpperCase","includeNumbers","length","startsWithLowerCase","Exercice","ExerciceSimple","deuxColonnes","cont1","cont2","largeur1","troisColonnes","cont3","largeur2","deuxColonnesResp","centrage","texMulticols","nbCols","texteCentre","listeQuestionsToContenu","exercice","vspace","texConsigne","texIntroduction","texEnumerate","listeQuestionsToContenuSansNumero","retourCharriot","supprimerReferenceCheckbox","texParagraphe","contraindreValeur","valeur","defaut","accu","gestionnaireFormulaireTexte","params","saisie","listeOfCase","melange","enleveDoublons","exclus","listeIndex","listeIndexProvisoire","Max","el","egal","superieurouegal","inferieurouegal","estentier","quotientier","carreParfait","randint","rand","randFloat","diff","checkSum","checkString","entries","o","spacing","texEnumerateSansNumero","consigne","itemize","tableauDeTexte","factorielle","creerNomDePolygone","nbsommets","premiersommet","polygone","augmentation","possedeUnCaractereInterdit","motAeviter","lettreDepuisChiffre","saufD","lettreMinusculeDepuisChiffre","lettreIndiceeDepuisChiffre","indiceLettre","premiereLettreEnMajuscule","numAlpha","nospace","numAlphaNum","reverseString","Grandeur","mesure","unite","uniteParsee","parseUnite","uniteConversion","uniteConversionParsee","isVitesseUnit","baseMps","toMps","cible","fromMps","isDureeUnit","baseSeconds","toSecondsDuree","fromSecondsDuree","unite2","u1","u2","formatHHMMSS","nbChiffrePartieDecimale","sec","formatDureeTexHMS","seconds","hhmmssToSeconds","enSecondes","u","unit","mps","t","H","M","S","total","h","m","parts","puissanceUnite","avantPuissanceUnite","puissancePrefixe","prefixeToPuissance","uniteDeReference","Hms","week","day","hour","second","hms","regexComplete","match","regex","time","hasProp","object","setStyles","styles","paire","paireArr","addText","id","strict","create","tag","attrs","txtContent","attr","addElement","parent","content","engine","ComputeEngine","cleanFractions","cleanFractionsMemesNegatives","modif","p1","p2","p3","cleanDivisions","replaceUnescapedCommas","offset","string","replaceThinSpaces","cleanComas","cleanSpaces","patterns","cleanDoubleSpaces","cleanEspaceNormal","cleanParentheses","cleanMathRm","cleanImaginaire","cleanOperatorName","cleanUnity","cleanPower","cleanLatex","cleanMultiplyByOne","generateCleaner","operations","cleaningFunctions","operation","cleaned","cleaningFn","inputToGrandeur","split","split2","flatten","expr","op","base","expo","exprs","allFactorsMatch","ops1","ops2","exclusifFactorisation","signeCurrent","nbMatchOK","nbNonAttendu","allMatch","op2","newOp2","factorisationCompare","goodAnswer","nbFacteursIdentiquesFactorisation","unSeulFacteurLitteral","clean","aCleaned","bCleaned","saisieParsedInit","reponseParsedInit","saisieHead","answerHead","saisieParsed","reponseParsed","saisieDev","reponseDev","isOk1","feedback","reponseFactors","saisieFactors","result2","nbNumber","hmsCompare","cleanInput","inputHms","parser","lhs","terminator","rhs","fonctionComparaison","expressionsForcementReduites","avecSigneMultiplier","avecFractions","sansTrigo","fractionIrreductible","fractionSimplifiee","fractionReduite","fractionDecimale","fractionEgale","fractionIdentique","nombreDecimalSeulement","expressionNumerique","additionSeulementEtNonResultat","soustractionSeulementEtNonResultat","multiplicationSeulementEtNonResultat","divisionSeulementEtNonResultat","ensembleDeNombres","kUplet","suiteDeNombres","suiteRangeeDeNombres","puissance","seulementCertainesPuissances","sansExposantUn","HMS","developpementEgal","intervalle","estDansIntervalle","ecritureScientifique","precisionUnite","texteAvecCasse","texteSansCasse","egaliteExpression","calculFormel","nonReponseAcceptee","variable","entier","domaine","functionCompare","intervalsCompare","intervalCompare","scientifiqueCompare","unitsCompare","comparaisonPuissances","texteAvecCasseCompare","texteSansCasseCompare","egaliteCompare","numberWithSpaceCompare","expressionNumeriqueCompare","ensembleNombres","comparaisonFraction","ontDeveloppementsEgaux","expressionDeveloppeeEtReduiteCompare","customCanonical","expression","numericVal","cleanIput","cleanGoodAnswer","saisieNativeParsed","reponseNativeParsed","localInput","localGoodAnswer","substitutions","parsedExpression","saisieCalculeeParsed","reponseCalculeeParsed","negateBeforeDelimiter","node","iNeg","iDel","saisieJSON","evaluateExpression","expr1","expr2","expr1Reduite","item1","expr2Reduite","item2","substituted","expressionDeveloppeeEtNonReduiteCompare","isScientific","regex1","regex2","exponent","saisieClean","reponseClean","saisieCleanFormattee","number","decoupageSaisie","mantisseSaisie","reponseCleanFormattee","cleaner","goodAnswerParsed","inputParsed","equalFractionCompareSansRadical","contenuDeuxiemeAccolade","nombreSaisi","goodAnswerSplit","exposantGoodAnswer","exposantSaisi","exposantSaisiNumber","isOk","exposantGoodAnswerNumber","avecAccolades","splitInput","splitGoodAnswer","inputSorted","goodAnswerSorted","currentInput","replacement","lettre","isOk2","extractBornesAndOp","extractCrochets","borneAndOpSaisie","borneAndOpReponse","crochetsSaisie","crochetsReponse","inputGrandeur","goodAnswerGrandeur","okPrecision1","okPrecision2","inputNumber","strictGauche","strictDroit","bornes","borneInf","okGauche","okDroit","consecutiveCompare","entierInf","valeurInter","entierSup","goodAnswerEntierInf","goodAnswerEntierSup","diff1","diff2","approximatelyCompare","answerClean","inputFn","cleanAnswer","goodAnswerFn","valAlea","variablea","variableb","variablec","vars","y1","y2","m1","m2","goodAnswerMb1","goodAnswerMb2","isOk3","isOk4","formatNumberWithSpaces","separator","entierFormate","decimalFormate","inputCleanFirst","inputClean","goodAnswerClean","goodAnswerNew","exprCompare","noUselessParen","nbParenInput","nbParenAnswer","numbersInput","_c","numbersAnswer","_d","opsInput","_e","opsAnswer","_f","checkLeCompteEstBon","target","quatreOperationsObligatoires","answer","addCount","multiplyCount","divideCount","subtractCount","tropDeNombres","nombresEnDoublon","mauvaisNombre","symboleNonAutorise","operationNonAutorisee","listeNombresEnonce","visit","toutPourUnPoint","listePoints","toutAUnPoint","prev","verifQuestionMathLive","writeResult","noFeedback","champTexte","getCustomFeedback","formatInteractif","spanReponseLigne","reponses","bareme","callback","variables","mfe","points","resultat","cellules","reponse","compareFunction","spanFedback","ii","nbBonnesReponses","nbReponses","saisies","compteurSaisiesVides","compteurBonnesReponses","spanFeedback","customFeedback","objetReponse","check","MySpreadsheetElement","eventName","data","minDimensions","columns","interactif","showVerifyButton","container","nbLignesCachees","nbColonnesCachees","jspreadsheet","question","idMatch","feedBackElt","resultCheck","divFeedback","bouton","column","row","formula","rowIndex","colIndex","compareSheetFunction","goodAnswers","sheetTestDatas","userSheet","userData","messages","testFormulas","goodFormulas","cellData","cellRef","col","userFormula","maxMessages","testSheetForGoodAnswers","testSheetForUserResponses","messagesPerTest","answerIndex","testData","testCellRef","startRef","endRef","startCol","startRow","endCol","endRow","randomValue","goodAnswerValue","userAnswerValue","testCol","testRow","verifQuestionTableur","questionIndex","sheetAnswer","goodAnswersFormulas","sheetElement","spanResultat","res","createTableurLatex","rowNbr","colNbr","output","alphabet","rowData","cell","styleCell","color","addSheet","afficheScore","nbMauvaisesReponses","divScore","divButton","types","addFeedback","message","titre","div","cssIcon","divTitre","messageFeedback","tropDeChiffres","dragStartHandler","dragOverHandler","icone","dragEndHandler","dropHandler","dropTarget","etiquetteId","etiquette","matches","numeroExQuest","numeroEx","numeroQuest","clonedEtiquette","addDeleteButton","touchStartHandler","ele","touchMoveHandler","touch","top","left","rectangleBounds","touchX","touchY","rectangles","rectangle","touchEndHandler","centerX","centerY","dragEnterHandler","dragLeaveHandler","deleteBtn","verifDragAndDrop","exoDragAndDrops","objetReponses","etiquettesAbsentes","etiquettesMalPlacees","etiquettesBienPlacees","etiquettesDedans","etiquetteDedans","z","etiquettesIds","etiquettesTxts","listeOfIds","ordered","typeFeedback","eltFeedback","DragAndDrop","etiquettes","enonceATrous","duplicable","html","rule","etiquetteRaw","etiquettesEnDesordreOuPas","resteEnonce","htmlEnonce","chunks","start","end","name","divEtiquettes","shuffleJusquaWithIndexes","lastChoice","newArray","indexes","_","qcmCamExport","questions","propositions","laConsigne","introduction","enonceBis","enonce","props","statuts","proposition","bonneReponse","qcmCamExportAll","exercices","questionnaire","listExercices","exo","materiel","verifQuestionQcm","nbBonnesReponsesAttendues","nbReps","divReponseLigne","indice","label","propositionsQcm","texteCorr","espace","vertical","classCss","elimineDoublons","isTrueFalse","vrai","faux","vraiProp","fauxProp","formateQ","rep","formateRV","formateRF","isRadio","doublonsTrouves","empty","elts","renderLatexToHTMLFragment","li","latex","renderMathInElement","spanToInvisible","afficheChoice","image","span","svg","ListeDeroulante","choices","choix0","conteneur","sansFleche","select","char","event","code","fleche","height","widthSpan","withoutOffset","realIndex","choix","ul","ld","ListeDeroulanteElement","oldValue","newValue","verifQuestionListeDeroulante","choixDeroulant","listeDeroulanteToQcm","body","isClickFiguresArray","figures","setCliqueFigure","isMetaExercice","exerciceInteractif","buttonScore","nbQuestionsValidees","nbQuestionsNonValidees","verifExerciceCustom","verifQuestionMetaInteractif2d","verifQuestionCliqueFigure","eltExercice","correction","prepareExerciceCliqueFigure","objetFigure","figSvg","mouseOverSvgEffect","mouseOutSvgEffect","mouseSvgClick","erreur","nbFiguresCliquees","eltFigure","setReponse","valeurs","laReponseDemandee","handleAnswers","isValidNumber","cleanedValue","handleDefaultValeur","reponseAttendueEstUnNombre","ee","field","showDialogForLimitedTime","dialogId","nbOfMilliseconds","innerHTML","dialog","sleep","ms","resolve","showPopupAndWait","popup","refreshButton","closeButton","createURL","ex","canOptions","writable","debug","log","optionalParams","logDebug","statsTracker","exercise","recorder","vue","isreview","oldUrl","statsPageTracker","getIntrus","list1","list2","count","count1","count2","allKeys","intrus","globalOptions","buildDsParams","ds","EXAMS","isExerciceItemInReferentiel","isExamItemInReferentiel","isJSONReferentielEnding","isTool","resourceHasPlace","resourceHasMonth","isLevelType","codeList","isNonEmptyArrayOfStrings","isStaticType","isCrpeType","isStaticWithoutPngUrl","isGeoDynamic","geoDynRegExp","freezeUrl","isInIframe","exercicesParams","changes","isReordering","darkMode","capytaleMode","capytaleStudentAssignment","resultsByExercice","isMenuNeededForExercises","isMenuNeededForQuestions","previousView","bibliothequeDisplayedContent","moveExercice","iDepart","iArrivee","urlToWrite","timerId","updateGlobalOptionsInURL","canStore","es","presModeId","currentUrl","logParam","pdfParam","bigInt","handleBugsnag","Bugsnag","isDevMode","notifyLocal","metadatas","notify","appendCell","isInteractif","line","icell","indexCol","indexLine","classes","NoEx","NoQ","spanAvant","classeString","spanApres","classe","fillLine","AddTabPropMathlive","ligne1","ligne2","tableauMathlive","firstLine","entete1","secondLine","entete2","spanCheckOuterHTML","lgn1","lgn2","gras","nbColonnes","cellule","AddTabDbleEntryMathlive","newLine","sty","raw","nbLines","tabEntetesColonnes","tabEntetesLignes","tabLignes","headingCols","enTete","headingLines","raws","haveHeadC","haveHeadL","buildDataKeyboardString","ajouteQuestionMathlive","reponseParams","typeInteractivite","typeTableau","texteAvant","texteApres","blocCenter","remplisLesBlancs","ajouteChampTexte","ajouteChampTexteMathLive","ajouteFeedback","ajouteChamp","placeholder","dataKeyboard","balise","blanc","mfeValue","resteContent","FILTER_SECTIONS_TITLES","isInteractivityType","isValeur","isGrandeur","isDecimal","isAnswerValueType","isOldFormatInteractifType","isStatic","uuid","isSvelte","urlExercice","uuidToUrl","setSizeWithinSvgContainer","originalClientWidth","originalClientHeight","zoom","svgContainers","svgContainer","updateFigures","resizeSchemaContainer","schemaContainer","originalWidth","originalHeight","resizeContent","scratchDivs","scratchDiv","svgDivs","resizeTags","checkboxes","checkbox","schemaContainers","svgDiv","figure","width","newHeight","newWidth","eltsInVariationTables","initialTop","initialLeft","tags","factor","widthUnit","heightUnit","widthAttributeExists","heightAttributeExists","w","updateIframeSize","iframe","formattedTimeStamp","nbOfSeconds","nbOfHours","nbOfMinutes","nbOfSecondsLeft","setPhraseDuree","duree","getUniqueStringBasedOnTimeStamp","prefix","timeStamp","debounce","delay","immediate","timeout","later","callNow","millisecondToMinSec","milliseconds","VueTypeArray","convertVueType","MathAleaURL","paramToBeRemoved","param","buildMathAleaURL","global","can","buildEsParams","title","cryptedUrl","encrypt","mode","presentationMode","urlParts","newUrl","nextChar","combinedCharCode","partEncrypted","partToEncrypt","hexPartEncrypted","hex","decrypt","part1","part2withEEEE","codeStr","firstCharCode","lastCharCode","decryptedPart","part2","isCrypted","mathaleaGoToView","destinationView","originView","waitFor","conditionFn","interval","trace","reject","waitForElement","elementId","timeWait","tempTime","timeWait1000","checkExist","domSnapshot","mathaleaWriteStudentPreviousAnswers","answers","promiseAnswers","selectors","selector","reason","evt","idOriginalAndDate","etiquetteOriginale","clock","actions","action","labyrinthe","eles","serviceId","rpc","RPC","answersFromCapytale","assignmentDataFromCapytale","firstTime","currentMode","toolSetActivityParams","activity","workflow","studentAssignment","assignmentData","canOptionsStore","newExercicesParams","newGlobalOptions","newCanOptions","waitForSvelteToBeStable","starttime","newState","sendToCapytaleMathaleaHasChanged","tick","sendToCapytaleSaveStudentAssignment","indiceExercice","results","newStudentAssignement","evaluation","resultExercice","bestScore","err","sendToCapytaleActivityParams","handleCapytale","activityParams","sortFractions","ListeFraction","listetemp","dens","frac","nombreEnLettres","nbstring","nbDec","decstring","partieEntiereEnLettres","dictionnaire","nbString","classeDesMilliards","classeDesMillions","classeDesMilliers","classeDesUnites","obtenirListeFractionsIrreductibles","obtenirListeFractionsIrreductiblesFaciles","listeFractions","fraction","denominateurEnLettre","pluriel","denEnLettre","rienSi1","rienSi0","ecritureNombreRelatif","ecritureNombreRelatifc","ecritureAlgebriqueSauf1","equal","ecritureAlgebriqueSauf0","ecritureAlgebriquec","orangeMathalea","ecritureParentheseSiMoins","egalOuApprox","reduireAxPlusB","inconnue","reduireAxPlusByPlusC","inconnueX","inconnueY","valeurDecimaleFraction","aEgalZero","bEgalZero","cEgalZero","termeA","termeB","termeC","reduirePolynomeDegre3","ordreAlphabetique","lister","doubleDeveloppement","reduire","simpleDeveloppement","simpleDeveloppementAvecDoubleX","expression1","expression2","expression3","sommeAGauche","doubleX","xCarre","xSeul","formaterReponse","renderScratchDiv","root","scratchblocks","scratchFr","preBlocks","inlineBlocks","scales","scaleAttr","scale","targets","ALLOWED_LANGUAGES","isLanguage","VUES_WITH_LANG_STATUS_ONLY","localisedIDToUuid","refToUuidCH","refToUuidFR","referentielLocale","updateReferentielLocaleFromURL","urlString","lang","updateURLFromReferentielLocale","locale","getLang","isIntegerInRange0to2","isIntegerInRange0to3","isIntegerInRange0to4","isIntegerInRange1to4","ERROR_MESSAGE","getExerciceByUuid","targetUUID","child","foundObject","getSvelteComponent","paramsExercice","filename","directory","__variableDynamicImportRuntimeHelper","__vitePreload","checkHEAD","mathaleaLoadExerciceFromUuid","isCan","attempts","maxAttempts","pathToCheck","module","modules","path","loader","ClasseExercice","serverUpdated","exists","mathaleaGetExercicesFromParams","infosExerciceStatique","referentielStaticCH","referentielStaticFR","contentCorr","sujet","annee","lieu","mois","numeroInitial","examen","mathaleaHandleParamOfOneExercice","mathaleaHandleStringFromUrl","mathaleaGenerateSeed","mathaleaHandleSup","mathaleaRenderDiv","renderKatex","renderDiv","HtmlElement","_content","chaine","mathaleaUpdateUrlFromExercicesParams","mathaleaUpdateExercicesParamsFromUrl","currentRefToUuid","urlNeedToBeFreezed","durationGlobal","nbVues","flow","screenBetweenSlides","pauseAfterEachQuestion","isImagesOnSides","sound","manualMode","order","done","presMode","setInteractive","isSolutionAccessible","isInteractiveFree","oneShot","twoColumns","isTitleDisplayed","beta","canDuration","canTitle","canSolAccess","canSolMode","canIsInteractive","newExercisesParams","previousEntryWasUuid","entry","newExercisesParamsFiltered","nbVuesCandidate","flowCandidate","soundCandidate","mathaleaHandleExerciceSimple","cptSecours","compare","getDistracteurs","distracteur","qcm","inputsIds","exerciceSimple","distracteursNonSolutions","reponseReponse","mathaleaFormatExercice","formattedText","getExercisesFromExercicesParams","exercises","vendor","MetaExercice","ExercicesCAN","listeTypeDeQuestions","listeDeQuestions","exercicesRef","nbTotalQuestions","repartition","exercices1","exercices2","exercices3","indexQuestion","numExo","UnExercice","Question","formatChampTexte","optionsChampTexte","that","_g","monQcm","YEARS","MONTHS","isLessThan1Month","dateString","jour","date","elapsedTime","unMois","toMap","dico","cle","getRecentExercices","refObj","findResourcesAndPaths","getAllEndings","codeToLevelTitle","levelCode","listeNiveaux","codeListForLevels","listeThemes","codeListForThemes","fetchThrough","referentiel","harvest","goalReachedWith","find","ref","retrieveResourceFromUuid","targetUuid","resource","pathToObject","pathsToObjectsArray","items","buildReferentiel","refList","mergeReferentielObjects","objects","isObject","pVal","oVal","allStaticReferentiels","buildExercisesList","filter","promiseExos","exosParams","foundResource","splitExercisesIntoQuestions","consignes","corrections","consignesCorrections","isCorrectionVisible","indiceQuestionInExercice","cumulConsignesCorrections","newQuestions","newCorrections","indexQuestionCliqueFigure","elementArray","documentPositionComparator","figs","numbs","questionCliqueFigure","activeStats","_paq","g","paramExos","uuids","vueUuids","paraConvert","par","vueUuids1","parsedExo","statsCanTracker","keyboardState","button","$.child","root_1","i_1","root_2","$darkMode","$$render","consequent","alternate","$.store_mutate","$.untrack","$.append","$$anchor","state","$.prop","$$props","onMount","counter","nextcount","$.update_pre_prop","disabled","icon","iconFirst","$.template_effect","$.set_class","root_4","consequent_2","consequent_1","$.set_attribute","$.clsx","$$sanitized_props","$.event","$$arg","inverted","$2","$.derived_safe_equal","ButtonText","score","div_1","$.sibling","div_2","$.first_child","fragment","$canOptions","div_3","span_1","text_1","node_1","ButtonTextAction","subTitle","buildStringScore","getScore","div_4","prefixes","units","Unit","pre","cat","symbol","UnitSystem","prefixList","lengthUnits","areaMetricUnits","areaOtherUnits","volumeMetricUnits","volumeOtherUnits","massUnits","basicKeys","massUnitsKeys","lengthUnitsKeys","areaUnitsKeys","volumeUnitsKeys","capacityUnitsKeys","keys","specialKeysCaps","numbersCaps","complexesCap","numbersCaps2","numbersCapsX","numbersOperationsCaps","limitesCaps","numbersOperationsXCaps","numbersSpaceCaps","variableCaps","basicOperationCaps","basicOperationPlusCaps","basicOperationCaps2","fullOperationCaps","terminaleCaps","numerationCaps","probabiliteCaps","ensembleCaps","ensembleDefiniCaps","suiteCaps","hmsCaps","greekCaps","compareCaps","degreCaps","degreCelsiusCaps","trigoCaps","advancedCaps","anglesCaps","aToHCaps","iToPCaps","qToWCaps","xToZCaps","vFONCaps","eosnCaps","lengthsCaps","areasUnitsKeys","areasCaps","volumesUnitsKeys","volumesCaps","capacitiesUnitsKeys","capacitiesCaps","massesUnitsKeys","massesCaps","specialKeys","complexes","numbersX","numbers2","numbersOperations","numbersOperationsX","limites","numbersSpace","vFON","basicOperations","basicOperations2","basicOperationsPlus","fullOperations","clavierFonctionsTerminales","numeration","probabilite","greek","degre","degreCelsius","trigo","advanced","lengths","areas","ensemble","ensembleDefini","suite","volumes","capacities","masses","angles","uppercaseAToH","uppercaseIToP","uppercaseQToW","uppercaseXToZ","estOuestSudNord","keyboardBlocks","KEYCAP_WIDTH","KEYCAP_HEIGHT","GAP_BETWEEN_BLOCKS","GAP_BETWEEN_KEYS","SM_BREAKPOINT","MD_BREAKPOINT","LG_BREAKPOINT","getMode","innerWidth","isInLine","rowsAlphaLow","rowsAlphaUp","rowsNum","alphanumericLayouts","isSpecialKey","isPageKey","pageType","clickKeycap","rows","$.get","$.each","keyName","isSpecial","$.mutable_source","$.set","keycapwidth","keycapheight","button_1","$$value","$.deep_read_state","block","gapsize","Key","$.set_style","$0","blocksList","toRegularCharacters","possibleBlocks","switchToBlock","newBlock","currentBlock","blockgapsize","$1","$.index","root_3","BlockOfKeycaps","unitsBlocks","usualBlocks","page","beforeUpdate","afterUpdate","BlockOfKeyCaps","fragment_1","BlockOfKeycapsWithPagination","Keyboard","kb","inLineBlockWidth","numberOfKeys","pages","currentPageIndex","divKeyboard","alphanumericDisplayed","isVisible","myKeyboard","computePages","$.mutate","pageWidth","blockList","blockWidth","navRight","navLeft","$keyboardState","idMathField","Alphanumeric","KeyboardPage","node_2","button_2","button_3","$.transition","fly","floatUnderText","cornerIcon","cornerIconClass","isDisplayed","isWithCloseButton","dispatch","createEventDispatcher","dialog_1","ButtonIcon","div_5","$.self","resultsByQuestion","$.set_text","numberOfQuestions","handleEndOfRace","isModalOpen","swipe","touchStartX","touchStartY","touchStartTime","minSwipeDistance","maxSwipeTime","handleTouchStart","handleTouchEnd","touchEndX","touchEndY","touchEndTime","deltaX","deltaY","deltaTime","endButtonDiv","ShortPagination","i_2","i_3","button_4","$.action","$$node","node_3","BasicClassicModal","button_5","button_6","nav","loadMathLive","divExercice","champs","MathfieldElement","handleFocusMathField","handleFocusOutMathField","filteredContent","setMathfield","hauteurExercice","domExerciceInteractifReady","isCorrected","consigneCorrection","visible","nextQuestion","questionContainer","onDestroy","handleKeyUp","handleMathfieldElement","questionContent","updateInteractivity","ev","figureCliquables","figureCliquable","clocks","box","apigeoms","handleApigeomClick","selects","onHoverEnd","div_6","widthFactor","displayedTime","durationInMilliSeconds","elapsed","duration","lastTime","frame","update","terminateTimer","timeD","formattedtime","ElapsedTime","numberOfSeconds","checkAnswers","timerComponent","exercicesAffiches","endTimer","du","Timer","Pagination","NavigationButtons","titles","isDisabled","classAddenda","textSize","buttonSize","toggle","solutionDisplayed","displayCorrection","answersContents","formatAnswer","cleanFillInTheBlanks","removeMathField","removeDollar","removeInteractiveClock","cleanSelect","node_5","node_6","fragment_2","node_8","root_5","span_2","text_2","div_7","ButtonToggle","node_9","ol","root_6","div_8","div_9","text_3","div_10","root_7","root_8","div_11","div_12","node_11","div_13","node_12","div_14","span_3","node_14","recordedTimeFromCapytale","$$_import_context","gOpt","splitResults","$globalOptions","answersType","qcmAnswers","resultsByExerciceArray","ind","q","quest","$resultsByExercice","getDuration","getRecordedScore","getScoreTotal","buildTime","KickOff","CountDown","Race","End","consequent_3","Solutions","consequent_4","node_4","ButtonToggleDarkMode","canvas","remToPixels","rem","getTextWidth","font","getCssStyle","getCanvasFont","fontWeight","fontSize","fontFamily","readySent","attemptStartedSentFor","postFlowmathRpc","sendFlowmathReady","sendFlowmathAttemptStarted","attemptId","normalized","sendFlowmathAttemptFinished","payload","sendFlowmathReplayCompleted","sendFlowmathError","getFlowmathAttemptIdFromUrl","handleFlowmath","onMessage","opts","newOpts","totalQuestions","correctAnswers","exercicesData","expectedButtonCount","waitForValidationButtons","checkButtons","foundCount","mathaleaUtils","onWindowError","onUnhandledRejection","isLocalStorageAvailable","countMathField","numbOfAnswerFields","autoCorr","handleCorrectionAffichee","observer","showNumber","h1","isOnStateActive","svg_1","indiceLastExercice","newData","switchCorrectionVisible","switchInteractif","columnsCount","columnsCountUpdate","showCorrectionButton","showInteractivityButton","$$args","InteractivityIcon","exerciseIndex","interfaceParams","level","subscribeExercicesParamsStore","isCorrectVisible","boutonValidationUrlFlag","boutonCorrectionUrlFlag","boutonInteractiviteUrlFlag","headerExerciceProps","numberOfAnswerFields","forceUpdate","adjustMathalea2dFiguresWidth","updateAnswers","q1","objAnswers","urlParams","setAllInteractif","removeAllInteractif","updateDisplay","changed","interactifValue","verifExerciceVueEleve","previousBestScore","numberOfPoints","isThisTryBetter","previousResultatByExercice","initialDimensionsAreNeeded","mathalea2dFigures","initialWidth","initialHeight","eltsInFigures","consigneDiv","coef","newdata","plusMinus","$.update","HeaderExerciceVueEleve","$.spread_props","$isMenuNeededForExercises","ExerciceVueEleveButtons","article","p_1","node_7","uuidCount","counts","exercisesUuidRanking","codesList","ranks","rank","genericPreamble","loadFonts","latexFileInfos","loadNoteBasExercices","contents","testIfLoaded","loadPreambule","loadPreambuleCan","loadPackagesFromContent","loadProfCollegeIfNeed","values","valueToPut","display","decompDNB","squareO","valuetoSearch","Latex","indiceVersion","getUrlFromExercice","questionLiee","subTab","questionSuivante","buildContent","writeIntroduction","seedOld","confExo","phrases","firstQuestion","secondQuestion","contentVersion","addPackages","latexCmds","latexPackages","pack","cmd","preamble","intro","latexWithoutPreamble","latexWithPreamble","packLatex","packageFiltered","numbersNeeded","blocrep","specs","buildImagesUrlsList","exosContentList","picsNames","imagesFilesUrls","year","serie","file","getExosContentList","getPicsNames","picsList","regDeleteCommentaires","regExpImage","regExpImageName","pics","list","matchIm","imgObj","imgFile","doesLatexNeedsPics","exos","makeImageFilesUrls","AvecLesDoublesEspaces","blob","pdfBlob","$.state","downloadFilename","pdfUrl","clockAbled","errorMessage","errorLog","original","timer","tweened","generateFilename","ext","now","pad","downloadAndExtractPDF","compileToPDF","picsWanted","imagesUrls","formData","im","imaUrl","timeValue","$.user_effect","progress","$timer","PdFviewer","consequent_5","consequent_6","root_9","text_4","consequent_7","root_10","consequent_8","onClose","ready","exoParam","$exercicesParams","close","PdfResult","descendre","monter","interactifReady","randomReady","settingsReady","correctionReady","correctionExists","isSortable","isDeletable","isHidable","isSettingsVisible","isContentVisible","showPdfDialog","titleAddendum","titleBase","ressourcesUuids","uuidsRessources","profsUuids","refProfs","remove","duplicate","newExercice","decompo","button_7","PdfDialog","BoutonMonter","BoutonDescendre","isChecked","darkBackground","sizeClass","label_1","$.bind_checked","handleInput","rawValue","numValue","decrement","increment","displayValue","$.set_value","showTitle","inputID","autocomplete","autocorrect","autocapitalize","spellcheck","handleChange","$.bind_value","option","option_1","$.bind_select_value","supIndex","exerciceIndex","supValue","formNum","suffix","caseACocher","formNumOptions","entree","CheckboxWithLabel","form","SelectUnique","InputNumber","form_1","fragment_3","InputText","$.preventDefault","sup","sup2","sup3","sup4","sup5","versionQcm","alea","correctionDetaillee","isCommentDisplayed","formNum1","formNum2","formNum3","formNum4","formNum5","previousSeed","parseFormNumerique","entreesFormulaire","entrees","dernier","dispatchNewSettings","SupParameterGroup","toggleSidenav","exercicesNumber","exerciceHasNoSettings","isExerciceChecked","generateTitleAddendum","headerProps","unsubscribeToChangesStore","updateExerciceAfterLanguageChange","initButtonScore","handleNewSettings","withNewVersion","verifExercice","handleExerciseRemoved","HeaderExerciceVueProf","node_10","$$action_arg","Settings","ExerciceMathaleaVueProf","ExerciceMathaleaVueEleve","section","referentielBibliotheque","zoomFactor","filiere","resourceToDisplay","noCorrectionAvailable","handleNoCorrectionAvailable","img","img_1","exerciseType","ComponentExercice","getExercise","getExerciseType","ExerciceStatic","ExerciceHtml","$$component","ExerciceMathalea","alternate_1","alternate_2","alternate_3","isBorderTransparent","zoomMinus","updateSize","zoomPlus","zoomEvent","tooltip","tooltipPosition","brandImagePath","productImagePath","goToVueProf","ButtonIconTooltip","footer","isDisabledButton","divsCorrection","currentWindowWidth","eleveSection","$vendor","urlToDisplay","urlOptions","buildExoTitle","dim","nbOfExercises","navigationHeaderElt","exerciseTitleElt","roomForOne","$.store_set","buildQuestionTitle","nbOfQuestions","questionTitleElt","resizeObserver","buildQuestions","checkQuestion","interactifType","handleIndexChange","exoNum","questionEvent","exerciseTitle","questionTitle","section_1","Banner","BtnZoom","$isMenuNeededForQuestions","div_15","div_16","div_17","root_11","text_5","div_18","root_12","div_19","div_20","root_14","div_21","root_15","div_22","root_17","div_23","root_18","node_16","div_24","root_20","div_25","root_21","div_26","div_27","text_6","div_28","node_18","div_29","fragment_8","div_30","div_31","div_32","node_19","node_20","div_33","root_24","div_34","div_35","div_36","div_37","root_25","node_24","div_38","root_26","div_39","div_40","node_26","$.bind_this","div_41","root_27","node_28","div_42","root_29","node_30","div_43","root_31","FlipCard","div_44","root_33","div_45","div_46","div_47","div_48","root_34","div_49","node_35","div_50","root_35","node_37","Footer2","handleUrl","generateLatex","userSettings","itemsWithExercises","preambuleLight","outputCorr","document","numberOfVersions","downloadZip","filesUrls","zipFileName","zip","JSZip","JSZipUtils","splitUrl","fileName","saveAs","downloadTexWithImagesZip","latexFile","withImages","urls","imagesFolder","downloadFile","contentDisplayed","successMessage","displayDuration","isSuccessDisplayed","isErrorDisplayed","textToCopy","urlToDownload","useCurrentUrl","removeSeed","actionFunction","copyToClipboard","download","returnString","BasicInfoModal","languages","buildLangIconPath","country","showLanguageChoiceModal","handleLanguage","loc","$$array","LanguageIcon","isMenuOpen","subtitle","subtitleType","NavBarSubtitle","LanguageStatus","LanguageDropdown","ModalLanguageChoice","userInput","latexOutput","formatUserInput","parsedInput","$userInput","handleValidate","exercisesParams","handleKeyDownUserInput","main","NavBar","$referentielLocale","textarea","ButtonActionInfo","$latexOutput","Footer","exportQcmAmc","idExo","autoCorrection","texQr","horizontalite","lastchoice","nbChiffresPd","nbChiffresPe","sautDeLigneApresEnonce","valeurAMCNum","digitsBase","digitsExposant","digitsNum","digitsDen","signeNum","reponseF","reponseAlsoCorrect","nbChiffresExpo","demiMediane","qr","qrType","creerDocumentAmc","nbExemplaires","matiere","typeEntete","indexOfCode","nombreDeQuestionsIndefinie","graine","groupeDeQuestions","texQuestions","titreQuestion","melangeQuestion","formatLatex","isImpressionRectoVerso","checkBoxImpressionRectoVerso","codeLatex","preambule","debutDocument","enteteTypeCodeGrid","enteteTypeChampnomSimple","enteteTypePreremplie","enteteCopie","contenuCopie","valueSelected","labelsValues","orientation","valueHasChanged","labelValue","entete","nbQuestionsModif","exercicesARetirer","refsExercicesARetirer","textForOverleaf","isNonAMCModaleDisplayed","isOverleafModalDisplayed","initExercices","proprietes","overleafForm","handleOverLeaf","nbQ","FormRadio","reference","ul_1","input_1","input_2","input_3","node_13","notes","chargement","paramUrl","logs","ANKI_API_URL","ankiConnect","importer","note","nbExos","nbExosDejaPresent","customUrl","imageId","QRCodeOptions","QRCodeCopyState","updateQRCodeImage","QRCode","imageElement","copyQRCodeImageToClipboard","canCopyImagesToClipboard","getBlobFromImageElement","copyBlobToClipboard","downloadQRCodeImage","timestamp","imageSrc","downloadLink","h3","explanations","inLine","$.set_checked","tabs","activeTab","handleClick","tabId","handleTabChange","toggleCan","handleSeed","availableLinkFormats","currentLinkFormat","handleVueSetUp","nextView","isDataRandom","Tabs","ButtonToggleAlt","node_15","node_17","ButtonQRCode","node_21","zoomUpdate","isQuestionsVisible","currentVue","nbOfVues","setCurrentVue","setQuestionsVisible","setCorrectionVisible","handleCorrectionsStepsClick","newDataForAll","backToSettings","seriesIndex","series","correctionsSteps","currentSeriesIndex","seriesId","SlideshowOverviewSeries","slideshow","updateExercises","correctionVisibility","questionsVisibility","newParams","oldZoom","newZoom","questionsNb","slide","ZoomButtons","aside","SlideshowOverviewLeftPanel","main_1","SlideshowOverviewMainPanel","returnToStart","goToOverview","slideView","correctionSvg","consigneSvg","questionSvg","divQuestion","isQuestionVisible","currentSlide","currentQuestion","selectedQuestionsNumber","QuestionWithImagesOnSides","QuestionWithImagesInside","CorrectionWithImagesOnSides","CorrectionWithImagesInside","isFullscreenRequestEnabled","isFullscreenExitEnabled","doc","appId","isFullScreen","handleFullscreenChange","isInFullScreen","switchFullScreen","handleFullScreenError","requestFullScreen","exitFullScreen","method","TwoStatesIcon","BUTTONS_CLASS","FullscreenButton","isPause","isManualModeActive","prevQuestion","switchPause","cursorTimeValue","messageDuree","handleTimerChange","isTimerSettingsModalDisplayed","RangeSlider","switchDisplayMode","pause","play","currentSlideDuration","isTimerSettingsModalDisplayedOnce","displayTimerSettingsModal","getDisplayMode","SlideshowPlayTimerSettingsModal","SlideshowPlayDisplaySettings","SlideshowPlayControlSettings","SlideshowPlayOtherSettings","currentQuestionNumber","totalQuestionsNumber","goToQuestion","ratioTime","stepsContainer","steps","diapoProgressContainer","classes_1","transitionSounds","isManualPause","advanceRatioTimeInterval","optimalZoom","userZoom","renderAllViews","playCurrentQuestion","optimalZoomUpdate","findOptimalZoom","vueIndex","exerciseContainerDiv","optimalZoomForViews","findOptimalZoomForView","questionDiv","correctionDiv","questionHeight","questionWidth","getSizes","correctionHeight","correctionWidth","containerWidth","containerHeight","questionWidthOptimalZoom","correctionWidthOptimalZoom","questionCorrectionHeightOptimalZoom","handleShortcut","updateZoom","zoomIncrease","currentZoom","currentUuid","slidesCount","isUserAction","questionNumber","header","SlideshowPlaySteps","SlideshowPlayQuestion","SlideshowPlaySettings","SlideshowPlayEndButtons","selectedExercisesIndexes","stringDureeTotale","getTotalDuration","sum","updateQuestionsNb","updateDuration","getTotalNbOfQuestions","thead","tr","th","th_1","th_2","tbody","tr_1","td","span_4","td_1","NumberInput","td_2","td_3","updateManualMode","updateDurationGlobal","previousDurationGlobal","isSameDurationForAll","handleChangeIsSameDurationForAll","newIsSameDurationForAll","updatePreviousDurationGlobal","newDurationGlobal","isSameData","isQuestionsOrdered","updateQuestionsOrder","applyRandomSelectionOfExercises","isSelectedExercises","selectedExercisesCount","updateFlow","updateScreenBetweenSlides","updateTune","updatePauseAfterEachQuestion","questionThenCorrectionToggle","questionWithCorrectionToggle","labelsForSounds","soundToggle","tuneCandidate","tune","nbOfViews","updateNbOfViews","updateIsImagesOnSides","labelsForMultivue","startSlideshow","goToHome","divTableDurationsQuestions","previousNumberOfSelectedExercises","numberOfSelectedExercises","selection","updateSelect","DisplaySettings","ViewSettings","TransitionSettings","OrderSettings","SelectedExercisesSettings","LinksSettings","GlobalDurationSettings","ExercisesSettings","$previousView","updateSlidesContent","updateParamsFromUrl","setSlidesContent","adjustQuestionsOrder","updateExerciseParams","newExercises","slides","reroll","isSelected","idVue","questionSvgs","questionText","splitSvgFromText","consigneSvgs","consigneText","correctionSvgs","correctionText","originalSeed","sourceText","mathalea2dContainers","scratchContainers","svgs","removeSvgContainers","wholeQuestion","questionWithoutSvgContainers","selectedIndexes","getSelectedQuestionsIndexes","isSameArray","SlideshowOverview","SlideshowSettings","SlideshowPlay","idkey","defaultengine","defaultreturn","handleKeyDown","addinput","inp","addinputnoenc","addtextarea","submitFormToIframe","resetIframe","iframe2","ace.edit","stringfile","dialogToDisplayToggle","editor","edite","imageLatex","iframe_1","form_2","ProfMaquette","textForOverleafInput","textForProfMaquette","copyDocumentToOverleaf","imageUrl","input_4","input_5","input_6","images","intervalId","nextSlide","startAutoPlay","stopAutoPlay","h5","$$slots","labelsOptions","selectedExos","globalConfig","applyGlobalConfig","idx","exoConfig","cancelAllChanges","exercicesOptions","fieldset","SelectMultiple","legend","label_2","label_3","fieldset_1","label_4","label_5","dialogConfigToDisplayToggle","FormConfigGlobal","FormConfigIndividual","promise","isExerciceStaticInTheList","ButtonConfig","span_5","node_22","span_6","node_25","encodeBase64","decodeBase64","decoded","imgStylePartialUrls","dialogLua","messageForCopyPasteModal","divText","isDownloadPicsModalDisplayed","buildMessageForCopyPaste","updateLatexWithAbortController","clone","UpdateController","rej","updateLatex","_UpdateController","handleActionFromDownloadPicsModal","handleDownloadPicsModalDisplay","carouselImages","FormConfigSection","ImageCarousel","SimpleCard","ButtonCompileLatexToPDF","ButtonOverleaf","p_2","root_13","p_3","root_16","root_19","p_4","root_22","node_23","root_23","node_27","li_1","root_30","node_29","p_5","p_6","root_32","node_32","node_33","loading","pre_1","showAdvanced","indexesToLoad","newPdfParam","classes_2","ButtonCompileLatexToPdf","downloadGift","preElt","downloadScorm","contentScorm","indexHtml","contentGift","justBookmarklet","xmlScorm","xmlManifest","xmlMetadata","xmlSchema","xmlSchemaVersion","xmlOrganizations","xmlOrganization","xmlTitle","xmlResources","aleaType","xmlItem","xmlResource","useAlea","xmlDependency","xmlFile","ident","dir","moodleTabs","sendActivityParams","exoParams","isOpen","ripple","rect","y","rippleEl","newColor","isBackToTopButtonVisible","backToTop","$.effect","$.animation","flip","$isReordering","setupButtonsList","exportButtonsList","trash","buildUrlAndOpenItInNewTab","showSettingsDialog","importExercises","isExercisesListEmpty","isCapytale","handleRecorder","urlFeuilleEleve","ButtonsDeck","chipsListDisplayed","listIdsForChips","buildChipsList","lIFC","insert","Sortable","moved","ChipExo","reorderModalDisplayed","ChipsList","blur","isSidenavOpened","isRecorder","isMd","handleExport","exportQcmCam","PdfTextIcon","AmcIcon","AnkiIcon","MoodleIcon","QcmCamIcon","setAllInteractive","isAllInteractive","setFullScreen","InteractivityButton","ReorderButton","NewDataButton","TrashButton","SetupButtons","ExportButtons","isExerciseDisplayed","isNavBarVisible","NavBarRecorder","SideMenuWrapper","HeaderButtons","ModalReorder","setInteractivity","isSettingsDialogDisplayed","updateParams","ModalCapytalSettingsInteractivity","ModalCapytalSettingsCan","ModalCapytalSettingsData","ModalCapytalSettingsTitles","ModalCapytalSettingsCorrection","application","reversed","selected","loadImages","listeCodes","addAppToList","isPresent","removeAppFromList","matchingIndex","handelSelection","StarIcon","thirdAppsChoiceModal","showThirdAppsChoiceDialog","appsTierceInExercisesList","appsTierceReferentielArray","appsTierce","group","app","Card","currentSlideIndex","carouselContent","legacyCarouselContent","SLIDE_DURATION","scrollToSlide","goToSlide","slideElement","handleMouseEnter","handleMouseLeave","handleIndicatorClick","video","Carousel","monthes","ending","nestedLevelCount","nomDeExercice","selectedCount","compareCodes","countOccurences","unsubscribeToExerciceParams","endingTitre","addToList","newExercise","$changes","removeFromList","regexp","matchs","katex","NoInteractivityIcon","span_7","span_8","text_10","consequent_9","consequent_10","themes","themesList","themesCH","themesListCH","subset","unfold","indexBase","levelTitle","pathToThisNode","levels","codeToLevelList","themeTitle","themeCode","themeCodeisSubthemeCode","regexp3Auto","regexp1Auto","prepareSubset","keyA","valueA","keyB","valueB","key2","jourA","jourB","moisA","bibliothequeUuidInExercisesList","uuidList","$bibliothequeDisplayedContent","$$item","ReferentielEnding","ReferentielNode","$3","$4","stringWithNoAccent","MultiCriteria","criterion","OrCriteria","firstCriterion","secondCriterion","firstResult","secondResult","AtLeastOneOfCriteria","criteriaList","resultCriterion","featuresCriteria","amcCriterion","qcmCriterion","qcmcamCriterion","interactifCriterion","spec","levelCriterion","considerCAN","tagCriterion","selectedTag","monthCriterion","monthToMatch","idCriterion","idToMatch","examCriterion","examToMatch","yearCriterion","yearToMatch","subjectCriterion","subject","isCanIncluded","subjectToLowerCaseWithoutAccent","placeMatch","buildCriteriaFromString","criteria","re","regExpResult","wordsTemp","words","premier","word","theArray","connector","realWord","stringToCriterion","justAndCriteria","orAssociations","orListTransit","first","others","orCriteriaUnion","allFilters","getSelectedLevels","filters","selectedLevels","getSelectedFiltersObjects","filterType","filterObject","getSelectedFeatures","selectedFeatures","handleUncheckingMutipleFilters","clgKeys","lyceeKeys","applyFilters","collection","selectedSpecs","finalLevelsCriterion","levelsCriteria","specsCriteria","filtersHaveChanged","timeTag","handleFiltersChanges","selectedEntry","$allFilters","bgColor","textColor","triggerAction","thisStringRepresentsANumber","customSortingForResources","transformAutomatismId","digit1","letter","digit2","optionalSuffix","sortArrayOfResourcesBasedOnProp","mapped","sortArrayOfResourcesBasedOnYearAndMonth","resourceAYear","resourceBYear","resourceAMonth","resourceBMonth","customSortStringNumber","splitAlphaNumeric","part","compareAlphaNumeric","aParts","bParts","aPart","bPart","comparison","triAnnales","origin","addExercise","inputSearch","searchField","isFiltersVisible","selectedFilters","lastInput","isInputFocused","isCtrlDown","isKDown","isEnterDown","unsubscribeToFiltersStore","fetchResults","updateResults","inputSearchSamples","typeWriter","resultsWithDuplicates","getResults","unsortedResults","getUniques","nonStatics","statics","eltA","eltB","nameA","nameB","uniques","treatedUuids","beginsWithQuote","$filtersHaveChanged","triggerUpdate","onFocusInput","onBlurInput","matchOnResultsList","onEnterDown","matchingResource","onKeyDown","getFocusOnSearchInput","onKeyUp","selectorTarget","textList","textListI","delayMs","inputDiv","Chip","Filtres","resourcesSet","foundResources","searchInput","triggerUpdateFromSearchBlock","SearchInput","toggleThirdAppsChoiceDialog","getContext","createOriginalReferentiels","isFR","activations","referentielsActivation","baseReferentiel","referentielAlea","referentielAleaCH","examsReferentiel","referentielExams","referentielExamsCH","referentielOutils","referentielProfs","referentielHtml","referentielRessources","biblioReferentiel","baseGeometrieDynamiqueReferentiel","referentielGeometrieDynamique","examens","orderedExamsReferentiel","newExercisesReferentiel","baseAndNewsReferentiel","aleaReferentiel","exercicesGeometrieDynamique","geometrieDynamiqueReferentiel","allReferentielsInMenus","activatedReferentielsInMenu","deepReferentielInMenuCopy","originals","copy","referentiels","getReferentiels","excludedReferentiels","searchBlock","referentielsForMenu","localeValue","unsubscribeToReferentielLocale","updateRepositories","updatedRepositories","repositoriesInMenu","repositoryInMenu","filteredRepository","buildFilteredRepository","orderFollowingSchoolLevel","allExercices","filteredExercices","keyToBeFirst","buildResourcesSet","refList2","clavier","SearchBlock","SideMenuApps","selectedThirdApps","addScrollListener","status","selectedLanguage","localeID","frenchID","updateBackToTopButtonVisibility","updateSelectedThirdApps","exerciceParams","tempRecorder","setContext","forceOpening","exercisesQcms","Header","Sidenav","SideMenu","Exercices","Placeholder","ButtonBackToTop","ModalThirdApps","ModalCapytalSettings","closePopup","showPopup","globalOptionsUnsubscriber","exercicesParamsUnsubscriber","handlePopupClose","updateContext","updateVendor","canSub","Popup","Diaporama","Can","Eleve","RawLatex","Alacarte","ConfigEleve","Amc","Moodle","Anki","Pdf","Start","consequent_12","consequent_11","alternate_4","alternate_5","alternate_6","alternate_7","alternate_8","alternate_9","alternate_10","alternate_11","consequent_13","mount","App"],"ignoreList":[],"sources":["../../src/lib/components/browserVersion.ts","../../src/lib/components/version.ts","../../src/lib/interactif/claviers/keyboard.ts","../../src/modules/crc32.ts","../../src/lib/outils/calculs.ts","../../src/modules/context.ts","../../src/lib/outils/arrayOutils.ts","../../src/lib/outils/embellissements.ts","../../src/lib/outils/primalite.ts","../../src/lib/outils/nombres.ts","../../src/lib/outils/texNombre.ts","../../src/modules/FractionEtendue.ts","../../src/exercices/exerciseMethods.ts","../../src/exercices/Exercice.ts","../../src/exercices/ExerciceSimple.ts","../../src/lib/format/miseEnPage.js","../../src/modules/outils.ts","../../src/lib/outils/outilString.ts","../../src/modules/Grandeur.ts","../../src/modules/Hms.ts","../../src/lib/html/dom.ts","../../src/lib/interactif/comparisonFunctions.ts","../../src/lib/interactif/mathLive.ts","../../src/lib/tableur/MySpreadSheet.ts","../../src/lib/tableur/outilsTableur.ts","../../src/lib/interactif/afficheScore.ts","../../src/modules/messages.js","../../src/lib/interactif/DragAndDrop.ts","../../src/lib/amc/qcmCam.ts","../../src/lib/interactif/qcm.ts","../../src/lib/interactif/listeDeroulante/ListeDeroulante.ts","../../src/lib/interactif/listeDeroulante/ListeDeroulanteElement.ts","../../src/lib/interactif/questionListeDeroulante.ts","../../src/lib/interactif/gestionInteractif.ts","../../src/lib/components/dialogs.ts","../../src/lib/createURL.ts","../../src/lib/stores/canStore.ts","../../src/modules/statsUtils.ts","../../src/lib/stores/globalOptions.ts","../../src/lib/components/buildDsParams.ts","../../src/lib/types/referentiels.ts","../../src/lib/stores/generalStore.ts","../../src/bugsnag.ts","../../src/lib/interactif/tableaux/AjouteTableauMathlive.ts","../../src/lib/interactif/questionMathLive.ts","../../src/lib/types.ts","../../src/lib/components/componentsUtils.ts","../../src/lib/components/sizeTools.ts","../../src/lib/components/time.ts","../../src/lib/VueType.ts","../../src/lib/components/urls.ts","../../src/lib/mathaleaUtils.ts","../../src/lib/handleCapytale.ts","../../src/modules/ListeFraction.js","../../src/modules/nombreEnLettres.ts","../../src/modules/fractions.ts","../../src/lib/outils/ecritures.ts","../../src/lib/renderScratch.js","../../src/lib/types/languages.ts","../../src/lib/stores/languagesStore.ts","../../src/lib/types/integerInRange.ts","../../src/lib/mathalea.ts","../../src/lib/stores/vendorStore.ts","../../src/exercices/MetaExerciceCan.ts","../../src/lib/types/dates.ts","../../src/lib/components/toMap.js","../../src/lib/components/refUtils.ts","../../src/lib/components/exercisesUtils.ts","../../src/lib/interactif/cliqueFigure.js","../../src/modules/stats.ts","../../src/components/keyboard/stores/keyboardStore.ts","../../src/components/shared/forms/ButtonToggleDarkMode.svelte","../../src/components/display/can/presentationalComponents/CountDown.svelte","../../src/components/shared/forms/ButtonText.svelte","../../src/components/shared/forms/ButtonTextAction.svelte","../../src/components/display/can/presentationalComponents/End.svelte","../../src/components/display/can/presentationalComponents/KickOff.svelte","../../src/components/keyboard/lib/unitsSystem.ts","../../src/components/keyboard/lib/keycaps.ts","../../src/components/keyboard/layouts/keysBlocks.ts","../../src/components/keyboard/lib/sizes.ts","../../src/components/keyboard/layouts/alphanumericRows.ts","../../src/components/keyboard/types/keycap.ts","../../src/components/keyboard/presentationalComponents/alphanumeric/Alphanumeric.svelte","../../src/components/keyboard/presentationalComponents/keyboardpage/keyboardblock/keycap/Keycap.svelte","../../src/components/keyboard/presentationalComponents/keyboardpage/keyboardblock/BlockOfKeycaps.svelte","../../src/components/keyboard/presentationalComponents/keyboardpage/keyboardblock/BlockOfKeycapsWithPagination.svelte","../../src/components/keyboard/presentationalComponents/keyboardpage/KeyboardPage.svelte","../../src/components/keyboard/types/keyboardContent.ts","../../src/components/keyboard/Keyboard.svelte","../../src/components/shared/forms/ButtonIcon.svelte","../../src/components/shared/modal/BasicClassicModal.svelte","../../src/components/display/can/presentationalComponents/ShortPagination.svelte","../../src/components/display/can/presentationalComponents/NavigationButtons.svelte","../../src/components/display/can/presentationalComponents/Pagination.svelte","../../src/modules/loaders.js","../../src/components/display/can/presentationalComponents/Question.svelte","../../src/components/display/can/presentationalComponents/ElapsedTime.svelte","../../src/components/display/can/presentationalComponents/Timer.svelte","../../src/components/display/can/presentationalComponents/Race.svelte","../../src/components/shared/forms/ButtonToggle.svelte","../../src/components/display/can/presentationalComponents/Solutions.svelte","../../src/components/display/can/Can.svelte","../../src/lib/components/measures.ts","../../src/lib/flowmathRpc.ts","../../src/lib/handleFlowmath.ts","../../src/lib/stores/storage.ts","../../src/components/shared/exercice/countMathField.ts","../../src/components/shared/exercice/handleCorrection.ts","../../src/components/shared/exercice/presentationalComponents/shared/HeaderExerciceVueEleve.svelte","../../src/components/shared/icons/TwoStatesIcon.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueEleve/presentationalComponents/ExerciceVueEleveButtons.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueEleve/presentationalComponents/Question.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueEleve/ExerciceMathaleaVueEleve.svelte","../../src/lib/components/counts.ts","../../src/lib/latex/preambule.tex?raw","../../src/lib/latex/preambuleTex.ts","../../src/lib/Latex.ts","../../src/components/shared/forms/PDFviewer.svelte","../../src/components/setup/latex/PdfResult.svelte","../../src/components/setup/latex/PdfDialog.svelte","../../src/components/shared/exercice/shared/headerExerciceVueProf/BoutonDescendre.svelte","../../src/components/shared/exercice/shared/headerExerciceVueProf/BoutonMonter.svelte","../../src/components/shared/exercice/shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte","../../src/components/shared/forms/CheckboxWithLabel.svelte","../../src/components/shared/forms/InputNumber.svelte","../../src/components/shared/forms/InputText.svelte","../../src/components/shared/forms/SelectUnique.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueProf/presentationalComponents/SupParameterGroup.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueProf/presentationalComponents/Settings.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueProf/ExerciceMathaleaVueProf.svelte","../../src/components/shared/exercice/exerciceMathalea/ExerciceMathalea.svelte","../../src/components/shared/exercice/presentationalComponents/exerciceHtml/ExerciceHtml.svelte","../../src/components/shared/exercice/presentationalComponents/exerciceStatic/ExerciceStatic.svelte","../../src/components/shared/exercice/Exercice.svelte","../../src/components/shared/ui/btnZoom.svelte","../../src/components/shared/forms/ButtonIconTooltip.svelte","../../src/components/shared/vendors/Banner.svelte","../../src/components/display/eleve/FlipCard.svelte","../../src/components/display/eleve/Footer2.svelte","../../src/components/display/eleve/Eleve.svelte","../../src/lib/alacarte.ts","../../src/components/Footer.svelte","../../src/lib/files.ts","../../src/components/shared/modal/BasicInfoModal.svelte","../../src/components/shared/forms/ButtonActionInfo.svelte","../../src/lib/components/languagesUtils.ts","../../src/components/shared/ui/LanguageIcon.svelte","../../src/components/shared/modal/ModalLanguageChoice.svelte","../../src/components/shared/ui/LanguageDropdown.svelte","../../src/components/shared/ui/LanguageStatus.svelte","../../src/components/shared/header/NavBarSubtitle.svelte","../../src/components/shared/header/NavBar.svelte","../../src/components/setup/alacarte/Alacarte.svelte","../../src/lib/amc/creerDocumentAmc.js","../../src/components/shared/forms/FormRadio.svelte","../../src/components/setup/amc/Amc.svelte","../../src/components/setup/anki/Anki.svelte","../../src/components/shared/forms/ButtonQRCode.svelte","../../src/components/shared/forms/ButtonToggleAlt.svelte","../../src/components/shared/ui/Tabs.svelte","../../src/components/setup/configEleve/ConfigEleve.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/ZoomButtons.svelte","../../src/components/setup/diaporama/slideshowOverview/presentationalComponent/SlideshowOverviewLeftPanel.svelte","../../src/components/setup/diaporama/slideshowOverview/presentationalComponent/mainPanel/SlideshowOverviewSerie.svelte","../../src/components/setup/diaporama/slideshowOverview/presentationalComponent/mainPanel/SlideshowOverviewMainPanel.svelte","../../src/components/setup/diaporama/slideshowOverview/SlideshowOverview.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/SlideshowPlayEndButtons.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/CorrectionWithImagesInside.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/CorrectionWithImagesOnSides.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/QuestionWithImagesInside.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/QuestionWithImagesOnSides.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/SlideshowPlayQuestion.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/FullscreenButton.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayDisplaySettings.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayControlSettings.svelte","../../src/components/shared/forms/RangeSlider.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayTimerSettingsModal.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayOtherSettings.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlaySettings.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/SlideshowPlaySteps.svelte","../../src/components/setup/diaporama/slideshowPlay/SlideshowPlay.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/DisplaySettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/ExercisesSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/GlobalDurationSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/LinksSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/OrderSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/SelectedExercisesSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/TransitionSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/ViewSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/SlideshowSettings.svelte","../../src/components/setup/diaporama/Diaporama.svelte","../../src/components/shared/forms/ButtonCompileLatexToPDF.svelte","../../src/lib/latex/ProfMaquette.sty?raw","../../src/components/shared/forms/ButtonOverleaf.svelte","../../src/components/shared/ui/ImageCarousel.svelte","../../src/components/shared/ui/SimpleCard.svelte","../../src/components/shared/forms/SelectMultiple.svelte","../../src/components/shared/forms/FormConfigGlobal.svelte","../../src/components/shared/forms/FormConfigIndividual.svelte","../../src/components/shared/forms/ButtonConfig.svelte","../../src/components/setup/latex/FormConfigSection.svelte","../../src/components/setup/latex/LatexConfig.ts","../../src/components/setup/latex/Latex.svelte","../../src/components/setup/latex/RawLatex.svelte","../../src/components/setup/latex/Pdf.svelte","../../src/components/setup/moodle/Moodle.svelte","../../src/lib/handleRecorder.ts","../../src/components/shared/sidenav/Sidenav.svelte","../../src/lib/actions/ripple.ts","../../src/components/setup/start/presentationalComponents/ButtonBackToTop.svelte","../../src/components/setup/start/presentationalComponents/Exercices.svelte","../../src/components/shared/ui/ButtonsDeck.svelte","../../src/components/setup/start/capytale/NavBarRecorder.svelte","../../src/components/shared/ui/ChipExo.svelte","../../src/components/shared/ui/ChipsList.svelte","../../src/components/setup/start/presentationalComponents/header/ModalReorder.svelte","../../src/components/setup/start/presentationalComponents/header/SideMenuWrapper.svelte","../../src/components/shared/icons/AmcIcon.svelte","../../src/components/shared/icons/AnkiIcon.svelte","../../src/components/shared/icons/MoodleIcon.svelte","../../src/components/shared/icons/PdfTextIcon.svelte","../../src/components/shared/icons/QcmCamIcon.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/exportButtons/ExportButtons.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/InteractivityButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/ReorderButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/NewDataButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/TrashButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/SetupButtons.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/HeaderButtons.svelte","../../src/components/setup/start/presentationalComponents/header/Header.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsCAN.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsCorrection.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsData.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsInteractivity.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsTitles.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettings.svelte","../../src/components/shared/icons/StarIcon.svelte","../../src/components/shared/ui/Card.svelte","../../src/components/setup/start/presentationalComponents/ModalThirdApps.svelte","../../src/components/setup/start/presentationalComponents/carousel/Carousel.svelte","../../src/components/setup/start/presentationalComponents/Placeholder.svelte","../../src/lib/components/handleDate.ts","../../src/components/shared/icons/NoInteractivityIcon.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/referentielNode/ReferentielEnding.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/referentielNode/ReferentielNode.svelte","../../src/lib/components/textUtils.ts","../../src/lib/components/filters.ts","../../src/components/setup/start/presentationalComponents/sideMenu/filtersStore.ts","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/searchInput/Filtres.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/searchInput/Chip.svelte","../../src/lib/components/sorting.ts","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/searchInput/SearchInput.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/SearchBlock.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/SideMenuApps.svelte","../../src/lib/stores/referentielsStore.ts","../../src/components/setup/start/presentationalComponents/sideMenu/SideMenu.svelte","../../src/components/setup/start/Start.svelte","../../src/components/shared/modal/Popup.svelte","../../src/components/App.svelte","../../src/main.ts"],"sourcesContent":["import { UAParser } from 'ua-parser-js'\n\nconst minVersion = {\n  // Mgu  ajouter en fonction des problmes...\n  Chrome: 80,\n  Firefox: 75,\n  Safari: 16,\n  Edge: 80,\n  Opera: 67,\n  GSA: 387, // Google Search App (iOS)\n  WebKit: 605, // Apple WebView (iOS)\n  'MIUI Browser': 14, // Xiaomi MIUI, bas sur Chromium\n  'Chrome WebView': 140, // WebView embarque dans une app\n  'Samsung Internet': 14,\n  'Mobile Safari': 12,\n  'Mobile Chrome': 63,\n  'Chrome Headless': 80,\n  'Mobile Firefox': 136,\n  'Android Browser': 4,\n  'Avast Secure Browser': 143,\n  'Opera Touch': 6,\n  Facebook: 544,\n}\n\nexport function checkBrowserVersion() {\n  const uap = new UAParser()\n  const { browser, cpu, device, os, ua } = uap.getResult()\n\n  // console.log(uap.getResult())\n  // console.log(cpu)\n  // console.log(device)\n\n  const browserName = browser.name\n  const browserVersion = browser.major ? parseInt(browser.major, 10) : 0\n  let popupMessage = ''\n  if (\n    browserName &&\n    minVersion[browserName as keyof typeof minVersion] &&\n    browserVersion < minVersion[browserName as keyof typeof minVersion]\n  ) {\n    popupMessage = `Votre navigateur (${browserName} ${browserVersion}) est trop vieux. Veuillez mettre  jour votre navigateur pour une meilleure exprience.`\n  }\n  if (!minVersion[browserName as keyof typeof minVersion]) {\n    window.notify('Navigateur inconnu', {\n      browserName,\n      browserVersion,\n      browser,\n      cpu,\n      os,\n      device,\n      ua,\n    })\n  }\n  const url = new URL(window.location.href)\n  if (url.hostname === 'localhost' && url.searchParams.get('log') === '2') {\n    popupMessage = Object.entries({\n      browserName,\n      browserVersion,\n      browser,\n      cpu,\n      os,\n      device,\n      ua,\n    })\n      .map(([key, value]) => `${key}: ${value}`)\n      .join('<br>')\n  }\n  return { popupMessage, browserName, browserVersion }\n}\n","let localVersion: string = ''\n\nfetchServerVersion()\n  .then((version) => {\n    localVersion = version\n  })\n  .catch((error) => {\n    console.error('Error fetching local version:', error)\n  })\n\n// Fonction pour rcuprer la version du serveur\nexport async function fetchServerVersion(): Promise<string> {\n  // const path = window.location.href.startsWith('http://localhost') ? '' : '/alea'\n  // const response = await fetch(path + '/version.txt')\n  const path = import.meta.env.DEV ? '' : '/alea'\n  const response = await fetch(`${path}/version.txt`)\n  if (!response.ok) {\n    throw new Error('Failed to fetch server version')\n  }\n\n  const data = await response.json()\n  return data.version\n}\n\nexport function getLocalVersion(): string {\n  return localVersion\n}\n\n/**  ne pas utiliser: pour les tests... */\nexport function forceLocalVersion(): void {\n  localVersion = localVersion + '1'\n}\n\n// Fonction pour vrifier si le serveur a t mis  jour\nexport async function checkForServerUpdate(): Promise<boolean> {\n  try {\n    const serverVersion = await fetchServerVersion()\n    // console.log('Server updated from', localVersion, 'to', serverVersion)\n    if (serverVersion !== localVersion) {\n      return true // Le serveur a t mis  jour\n    }\n    return false // Le serveur n'a pas t mis  jour\n  } catch (error) {\n    console.error('Error checking for server update:', error)\n    return false\n  }\n}\n","import type { MathfieldElement } from 'mathlive'\nimport type { BlockForKeyboard } from '../../../components/keyboard/types/keyboardContent'\n\nconst KEYBOARD_CATEGORIES = [\n  'aire',\n  'alphanumericAvecEspace',\n  'alphanumeric',\n  'angles',\n  'clavierHms',\n  'clavierDeBase',\n  'clavierLimites',\n  'clavierCompare',\n  'clavierCompareAvecNombres',\n  'clavierDeBaseAvecX',\n  'clavierDeBaseAvecFraction',\n  'clavierDeBaseAvecFractionPuissanceCrochets',\n  'clavierDeBaseAvecEgal',\n  'clavierDeBaseAvecVariable',\n  'clavierEnsemble',\n  'clavierEnsemblePredefini',\n  'clavierFullOperations',\n  'clavierNumbers',\n  'clavierProbabilite',\n  'clavierSuite',\n  'college6eme',\n  'complexes',\n  'geolocalisation',\n  'grecTrigo',\n  'longueur',\n  'lycee',\n  'lyceeClassique',\n  'masse',\n  'clavierFonctionsTerminales',\n  'nombresEtDegre',\n  'nombresEtDegreCelsius',\n  'numbersSpace',\n  'numeration',\n  'vFON',\n  'volume',\n] as const\n\nexport type KeyboardCategory = (typeof KEYBOARD_CATEGORIES)[number] // on cre le type  partir du tableau de strings comme un union type de toutes les strings\n\n/**\n * Dtermine si un type de clavier pass en paramtre est bien connu\n * @param category type de clavier  vrifier\n * @returns `true` si le type de clavier est dans la liste\n */\nexport const isKeyboardCategory = (\n  category: unknown,\n): category is KeyboardCategory =>\n  category !== null &&\n  typeof category === 'string' &&\n  KEYBOARD_CATEGORIES.includes(category as KeyboardCategory)\n\ntype KbType = Record<KeyboardCategory, string>\nexport type PartialKbType = Partial<KbType>\nexport const KeyboardType: PartialKbType = KEYBOARD_CATEGORIES.reduce(\n  (obj, key) => {\n    return { ...obj, [key]: key }\n  },\n  {},\n)\n\nexport const convertToKeyboardCategory = (\n  str: string,\n): KeyboardCategory | undefined => {\n  const type = isKeyboardCategory(str) ? str : undefined\n  return type\n}\n\nexport const convertKeyboardTypeToBlocks = (\n  type: KeyboardCategory,\n): BlockForKeyboard[] => {\n  switch (type) {\n    case KeyboardType.clavierDeBase:\n      return ['numbersOperations']\n    case KeyboardType.college6eme: // A supprimer\n      return ['numbersOperations']\n    case KeyboardType.clavierLimites:\n      return ['limites']\n    case KeyboardType.vFON:\n      return ['numbersOperations', 'vFON']\n    case KeyboardType.clavierDeBaseAvecX:\n      return ['numbersOperationsX']\n    case KeyboardType.grecTrigo:\n      return ['numbers', 'fullOperations', 'greek', 'trigo']\n    case KeyboardType.clavierHms:\n      return ['numbers', 'hms']\n    case KeyboardType.clavierCompare:\n      return ['compare']\n    case KeyboardType.clavierCompareAvecNombres:\n      return ['numbers', 'compare', 'basicOperations']\n    case KeyboardType.clavierFonctionsTerminales:\n      return ['clavierFonctionsTerminales']\n    case KeyboardType.lycee:\n      return ['numbers', 'fullOperations', 'variables', 'advanced']\n    case KeyboardType.lyceeClassique:\n      return ['numbers', 'fullOperations', 'variables']\n    case KeyboardType.clavierDeBaseAvecFraction:\n      return ['numbers', 'basicOperations']\n    case KeyboardType.clavierDeBaseAvecFractionPuissanceCrochets:\n      return ['numbers', 'basicOperationsPlus']\n    case KeyboardType.clavierDeBaseAvecEgal:\n      return ['numbers2', 'basicOperations']\n    case KeyboardType.clavierDeBaseAvecVariable:\n      return ['numbers', 'basicOperations', 'variables']\n    case KeyboardType.clavierEnsemble:\n      return ['numbersX', 'ensemble', 'ensembleDefini']\n    case KeyboardType.clavierEnsemblePredefini:\n      return ['ensembleDefini']\n    case KeyboardType.clavierSuite:\n      return ['numbers', 'fullOperations', 'suite']\n    case KeyboardType.clavierNumbers:\n      return ['numbers']\n    case KeyboardType.complexes:\n      return ['complexes']\n    case KeyboardType.numbersSpace:\n      return ['numbersSpace']\n    case KeyboardType.clavierFullOperations:\n      return ['numbers', 'fullOperations']\n    case KeyboardType.clavierProbabilite:\n      return [\n        'numbers',\n        'probabilite',\n        'uppercaseXToZ',\n        'uppercaseQToW',\n        'uppercaseIToP',\n        'uppercaseAToH',\n      ]\n    case KeyboardType.alphanumeric:\n      return ['alphanumeric']\n    case KeyboardType.alphanumericAvecEspace:\n      return ['alphanumeric']\n    case KeyboardType.longueur:\n      return ['numbers', 'lengths']\n    case KeyboardType.numeration:\n      return ['numbers', 'numeration']\n    case KeyboardType.aire:\n      return ['numbers', 'areas']\n    case KeyboardType.volume:\n      return ['numbers', 'volumes', 'capacities']\n    case KeyboardType.masse:\n      return ['numbers', 'masses']\n    case KeyboardType.angles:\n      return [\n        'angles',\n        'uppercaseXToZ',\n        'uppercaseQToW',\n        'uppercaseIToP',\n        'uppercaseAToH',\n      ]\n    case KeyboardType.nombresEtDegre:\n      return ['numbers', 'degre']\n    case KeyboardType.geolocalisation:\n      return ['numbers', 'estOuestSudNord']\n    case KeyboardType.nombresEtDegreCelsius:\n      return ['numbers', 'degreCelsius']\n\n    default:\n      window.notify(\n        \"This error shouldn't occur. Clavier type: '\" + type + \"'\",\n        {},\n      )\n      return ['numbersOperations']\n  }\n}\n\nexport const buildDataKeyboardFromStyle = (\n  style: string,\n): BlockForKeyboard[] => {\n  // traitement\n  if (style === '') {\n    // clavier basique\n    return ['numbers', 'fullOperations', 'variables']\n  }\n  const blocks: BlockForKeyboard[] = []\n  const styleValues = style?.split(' ')\n  for (const value of styleValues) {\n    if (isKeyboardCategory(value)) {\n      blocks.push(...convertKeyboardTypeToBlocks(value))\n    } else {\n      // peut-tre des units... du style unites[longueurs,aires]\n      if (value.startsWith('unit') || value.startsWith('Unit')) {\n        // extraire les informations entre les [...] pour avoir les units\n        const unitValuesMatches = value.match(/\\[(.*?)\\]/g)\n        const unitValues =\n          unitValuesMatches\n            ?.map((e) => e.slice(1, -1))\n            .join(',')\n            .split(',')\n            .map((s) => s.toLowerCase().replace(/[s]$/, '')) || [] // tout en minuscule et virer les 's'  la fin\n        for (const v of unitValues) {\n          if (isKeyboardCategory(v)) {\n            blocks.push(...convertKeyboardTypeToBlocks(v))\n          }\n        }\n      }\n    }\n  }\n  if (blocks.length !== 0) {\n    const blks = blocks.filter((element, index, array) => {\n      return array.indexOf(element) === index\n    })\n    return blks\n  }\n  return ['numbers', 'fullOperations', 'variables']\n}\n\ntype Shortcut = {\n  mode: 'math' | 'text'\n  value: string\n}\n\ntype ShortcutsByKeyboards = {\n  [keyboard: string]: {\n    [key: string]: Shortcut | string\n  }\n}\n\nexport function getKeyboardShortcusts(mf: MathfieldElement): void {\n  let keyboardShortcuts = { ...shortcutsByKeyboards.default }\n  const keyboards = mf.dataset?.keyboard?.split(' ')\n  if (keyboards == null) return\n  for (const keyboard of keyboards) {\n    if (keyboard in shortcutsByKeyboards) {\n      keyboardShortcuts = {\n        ...keyboardShortcuts,\n        ...shortcutsByKeyboards[keyboard],\n      }\n    }\n    if (\n      ['lengths', 'volumes', 'capacities', 'masses', 'areas'].includes(\n        keyboard as KeyboardCategory,\n      )\n    ) {\n      keyboardShortcuts = {\n        ...keyboardShortcuts,\n        ...shortcutsByKeyboards.unit,\n      }\n    }\n  }\n  mf.inlineShortcuts = keyboardShortcuts\n}\n\nconst shortcutsByKeyboards = {\n  default: {\n    // D: { mode: 'math', value: 'd' }, // On avait un problme avec la notation D et mathLive\n    '*': { mode: 'math', value: '\\\\times' },\n    '.': { mode: 'math', value: '{,}' },\n    ',': { mode: 'math', value: '{,}' },\n    '%': { mode: 'math', value: '\\\\%' },\n    '': { mode: 'math', value: '^2' },\n    '': { mode: 'math', value: '^3' },\n    '**': { mode: 'math', value: '^{#1}' },\n    pi: { mode: 'math', value: '\\\\pi' },\n    ang: { mode: 'math', value: '\\\\widehat{#@}' },\n    rac: { mode: 'math', value: '\\\\sqrt{#@}' },\n    frac: { mode: 'math', value: '\\\\frac{#@}{#1}' },\n    '/': { mode: 'math', value: '\\\\frac{#@}{#1}' },\n    '<': '<',\n    '>': '>',\n    '>=': '\\\\geq',\n    '<=': '\\\\leq',\n    '(': '\\\\lparen',\n    ')': '\\\\rparen',\n\n    alpha: { mode: 'math', value: '\\\\alpha' },\n    beta: { mode: 'math', value: '\\\\beta' },\n    gamma: { mode: 'math', value: '\\\\gamma' },\n    delta: { mode: 'math', value: '\\\\delta' },\n    epsilon: { mode: 'math', value: '\\\\epsilon' },\n    theta: { mode: 'math', value: '\\\\theta' },\n    omega: { mode: 'math', value: '\\\\omega' },\n    lambda: { mode: 'math', value: '\\\\lambda' },\n    cos: { mode: 'math', value: '\\\\cos(#0)' },\n    sin: { mode: 'math', value: '\\\\sin(#0)' },\n    tan: { mode: 'math', value: '\\\\tan(#0)' },\n    '{': { mode: 'math', value: '\\\\{#0\\\\}' },\n    '[': { mode: 'math', value: '$[$' },\n    singleton: { mode: 'math', value: '\\\\{#0\\\\}' },\n    inf: { mode: 'math', value: '\\\\infty' },\n    union: { mode: 'math', value: '\\\\cup' },\n    inter: { mode: 'math', value: '\\\\cap' },\n    sauf: { mode: 'math', value: '\\\\backslash\\\\{#0\\\\}' },\n    integ: { mode: 'math', value: '\\\\int_#0^#1' },\n    lim: { mode: 'math', value: '\\\\lim_{#0\\\\to\\\\ #1}}' },\n    som: { mode: 'math', value: '\\\\sum_#0^#1' },\n    Un: { mode: 'math', value: 'U_n' },\n    ln: { mode: 'math', value: '\\\\ln(#0)' },\n    exp: { mode: 'math', value: 'e^#0' }, //\n    parmi: { mode: 'math', value: '\\\\tbinom{#0}{#1}' },\n    pasachantb: { mode: 'math', value: 'P_{#0}({#1})' },\n    barre: { mode: 'math', value: '\\\\overline{#@}' },\n    vec: { mode: 'math', value: '\\\\overrightarrow{#@}' },\n    pow: { mode: 'math', value: '#@^{#1}' },\n    gdC: { mode: 'math', value: '\\\\mathbb{C}' },\n    gdR: { mode: 'math', value: '\\\\mathbb{R}' },\n    gdQ: { mode: 'math', value: '\\\\mathbb{Q}' },\n    gdZ: { mode: 'math', value: '\\\\mathbb{Z}' },\n    gdN: { mode: 'math', value: '\\\\mathbb{N}' },\n  },\n\n  hms: {\n    D: { mode: 'math', value: 'd' },\n    sem: { mode: 'text', value: '{\\\\:\\\\text{semaines}\\\\:}' },\n    j: { mode: 'text', value: '{\\\\:\\\\text{j}\\\\:}' },\n    h: { mode: 'text', value: '{\\\\:\\\\text{h}\\\\:}' },\n    H: { mode: 'text', value: '{\\\\:\\\\text{h}\\\\:}' },\n    min: { mode: 'text', value: '{\\\\:\\\\text{min}\\\\:}' },\n    MIN: { mode: 'text', value: '{\\\\:\\\\text{min}\\\\:}' },\n    s: { mode: 'text', value: '{\\\\:\\\\text{s}\\\\:}' },\n    S: { mode: 'text', value: '{\\\\:\\\\text{s}\\\\:}' },\n    '*': { mode: 'math', value: '\\\\times' },\n    '.': { mode: 'math', value: ',' },\n  },\n\n  complexes: {\n    i: { mode: 'text', value: '{\\\\mathrm{i}}' },\n  },\n\n  unit: {\n    mg: { mode: 'math', value: '\\\\operatorname{mg}' },\n    cg: { mode: 'math', value: '\\\\operatorname{cg}' },\n    dg: { mode: 'math', value: '\\\\operatorname{dg}' },\n    g: { mode: 'math', value: '\\\\operatorname{g}' },\n    dag: { mode: 'math', value: '\\\\operatorname{dag}' },\n    hg: { mode: 'math', value: '\\\\operatorname{hg}' },\n    kg: { mode: 'math', value: '\\\\operatorname{kg}' },\n    mL: { mode: 'math', value: '\\\\operatorname{mL}' },\n    cL: { mode: 'math', value: '\\\\operatorname{cL}' },\n    dL: { mode: 'math', value: '\\\\operatorname{dL}' },\n    L: { mode: 'math', value: '\\\\operatorname{L}' },\n    daL: { mode: 'math', value: '\\\\operatorname{daL}' },\n    hL: { mode: 'math', value: '\\\\operatorname{hL}' },\n    mm: { mode: 'math', value: '\\\\operatorname{mm}' },\n    cm: { mode: 'math', value: '\\\\operatorname{cm}' },\n    dm: { mode: 'math', value: '\\\\operatorname{dm}' },\n    m: { mode: 'math', value: '\\\\operatorname{m}' },\n    dam: { mode: 'math', value: '\\\\operatorname{dam}' },\n    hm: { mode: 'math', value: '\\\\operatorname{hm}' },\n    km: { mode: 'math', value: '\\\\operatorname{km}' },\n    mm2: { mode: 'math', value: '\\\\operatorname{mm}^2' },\n    cm2: { mode: 'math', value: '\\\\operatorname{cm}^2' },\n    dm2: { mode: 'math', value: '\\\\operatorname{dm}^2' },\n    m2: { mode: 'math', value: '\\\\operatorname{m}^2' },\n    dam2: { mode: 'math', value: '\\\\operatorname{dam}^2' },\n    hm2: { mode: 'math', value: '\\\\operatorname{hm}^2' },\n    km2: { mode: 'math', value: '\\\\operatorname{km}^2' },\n    mm3: { mode: 'math', value: '\\\\operatorname{mm}^3' },\n    cm3: { mode: 'math', value: '\\\\operatorname{cm}^3' },\n    dm3: { mode: 'math', value: '\\\\operatorname{dm}^3' },\n    m3: { mode: 'math', value: '\\\\operatorname{m}^3' },\n    dam3: { mode: 'math', value: '\\\\operatorname{dam}^3' },\n    hm3: { mode: 'math', value: '\\\\operatorname{hm}^3' },\n    km3: { mode: 'math', value: '\\\\operatorname{km}^3' },\n    a: { mode: 'math', value: '\\\\operatorname{a}' },\n    ha: { mode: 'math', value: '\\\\operatorname{ha}' },\n    '*': { mode: 'math', value: '\\\\times' },\n    '.': { mode: 'math', value: ',' },\n  },\n\n  numbersOperations: {\n    '/': { mode: 'math', value: '\\\\div' },\n  },\n\n  numbersSpace: {\n    ' ': '\\\\,',\n  },\n} as ShortcutsByKeyboards\n","/**\n * Calcul de checksum CRC32 UTF-8 compatible.\n * Fonctionne pour tout type de texte (accents, emojis, etc.)\n * et pour des tableaux de chanes (string[]).\n */\n\nexport class CRC32 {\n  private static readonly TABLE = CRC32.makeTable()\n\n  // Gnration unique de la table CRC32\n  private static makeTable(): Uint32Array {\n    const table = new Uint32Array(256)\n    for (let i = 0; i < 256; i++) {\n      let c = i\n      for (let k = 0; k < 8; k++) {\n        c = c & 1 ? 0xedb88320 ^ (c >>> 1) : c >>> 1\n      }\n      table[i] = c >>> 0\n    }\n    return table\n  }\n\n  /**\n   * Calcule le CRC32 d'une chane de caractres (UTF-8)\n   * @param str Chane d'entre\n   * @returns Entier non sign 32 bits\n   */\n  static fromString(str: string): number {\n    const encoder = new TextEncoder()\n    const bytes = encoder.encode(str)\n    let crc = 0xffffffff\n    for (let i = 0; i < bytes.length; i++) {\n      crc = this.TABLE[(crc ^ bytes[i]) & 0xff] ^ (crc >>> 8)\n    }\n    return (crc ^ 0xffffffff) >>> 0\n  }\n\n  /**\n   * Calcule un CRC32 unique pour un tableau de chanes\n   * @param strings Tableau de chanes\n   * @returns Entier non sign 32 bits\n   */\n  static fromArray(strings: string[]): number {\n    let combinedCRC = 0xffffffff\n    for (const str of strings) {\n      const crc = this.fromString(str)\n      // combine de manire dterministe\n      combinedCRC =\n        this.TABLE[(combinedCRC ^ (crc & 0xff)) & 0xff] ^ (combinedCRC >>> 8)\n      combinedCRC ^= crc >>> 8\n    }\n    return (combinedCRC ^ 0xffffffff) >>> 0\n  }\n\n  /**\n   * Renvoie un identifiant court en hexadcimal\n   * @param input chane ou tableau\n   * @returns exemple: \"b1e6b084\"\n   */\n  static hex(input: string | string[]): string {\n    const value = Array.isArray(input)\n      ? this.fromArray(input)\n      : this.fromString(input)\n    return value.toString(16).padStart(8, '0')\n  }\n\n  /**\n   * Renvoie un identifiant court en hexadcimal\n   * @param inputs tableau\n   * @returns exemple: \"b1e6b084\"\n   */\n  static hexQuestions(inputs: string[]): string {\n    let resu = ''\n    inputs.forEach((input, i) => {\n      const v = this.hex(input)\n      resu += i === 0 ? v : '|' + v\n    })\n    return resu\n  }\n}\n\n// --- Exemple d'utilisation ---\n// console.log(CRC32.hex(\"bonjour\"));           //  \"b1e6b084\"\n// console.log(CRC32.hex([\"cole\", \"anne\"]));  //  \"7b5b55a1\"\n","import Decimal from 'decimal.js'\n\n/**\n * Retourne la somme des chiffres (ou d'un tableau de chiffres) d'un nombre en valeur et sous forme de String [valeur, String]\n * @Example\n * sommeDesChiffres(123)\n * // [ 6, '1+2+3']\n * @author Rmi Angot (Rajout Tableau par EE)\n */ export function sommeDesChiffres(n: number) {\n  let nString: string\n  if (Array.isArray(n)) nString = n.join('').toString()\n  else nString = n.toString()\n  let somme = 0\n  let sommeString = ''\n  for (let i = 0; i < nString.length - 1; i++) {\n    if (\n      ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(nString[i]) !==\n      -1\n    ) {\n      sommeString += nString[i] + '+'\n      somme += Number(nString[i])\n    }\n  }\n  if (\n    ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(\n      nString[nString.length - 1],\n    ) !== -1\n  ) {\n    sommeString += nString[nString.length - 1]\n    somme += Number(nString[nString.length - 1])\n  }\n  return [somme, sommeString]\n}\n\n/**\n * Retourne l'galit des produits en croix  partir d'un tableau contenant les deux fractions [[a,b],[c,d]] pour a/b=c/d retourne ad=bc\n * Le rsultat est un string en mode maths inline\n * @author Jean-Claude Lhote\n */\n\nexport function produitsEnCroix([[a, b], [c, d]]: [\n  [number | string, number | string],\n  [number | string, number | string],\n]): string {\n  // crit une chaine pour a*d=b*c\n  let result = ''\n  result += `$${a}\\\\times${d}=${b}\\\\times${c}$`\n  return result\n}\n\n/**\n * Retourne la quatrime proportionnelle de 3 nombres en fonction d'une prcision demande\n * Le rsultat est un string qui doit tre entour de $ pour le mode mathmatique\n * @author Jean-Claude Lhote\n */\nconst texNombre = (n: number | Decimal, precision: number) => {\n  if (precision === 0) return n.toString()\n  else {\n    const dn = new Decimal(n)\n    return dn.toDP(precision).toString().replace('.', '{,}')\n  }\n}\n\nexport function quatriemeProportionnelle(\n  a: number | string,\n  b: number | string,\n  c: number | string,\n  precision = 0,\n): string {\n  // calcul de b*c/a\n  let result = ''\n  if (typeof a === 'number' && typeof b === 'number' && typeof c === 'number') {\n    if (a === 0) {\n      result = '=erreur : division par zro'\n      return result\n    }\n    const p4 = new Decimal(b).mul(c).div(a)\n    result += `\\\\dfrac{${texNombre(b, precision)}\\\\times${texNombre(c, precision)}}{${texNombre(a, precision)}}`\n    if (p4.eq(p4.toDP(precision))) result += '='\n    else result += '\\\\approx'\n    result += `${texNombre(p4, precision)}`\n    return result\n  } else {\n    return `\\\\dfrac{${b} \\\\times${c}}{${a}}`\n  }\n}\n\n/**\n * Extrait le plus grand facteur entier a dont le carr divise n\n * @param {number} n - Le nombre entier dont on veut extraire la racine carre\n * @returns {[number, number]} - [a, n/a] o a est le plus grand carr parfait divisant n\n * @author Jean-Claude Lhote (rimplmentation sans dpendance circulaire)\n */\nexport function extraireRacineCarree(n: number): [number, number] {\n  if (n <= 0) return [0, n]\n  if (n === 1) return [1, 1]\n\n  let a = 1\n  let reste = n\n\n  // On teste tous les nombres de 2  sqrt(n)\n  for (let i = 2; i * i <= reste; i++) {\n    // Tant que i divise reste, on l'extrait\n    while (reste % (i * i) === 0) {\n      a *= i\n      reste = Math.floor(reste / (i * i))\n    }\n  }\n\n  return [a, reste]\n}\n\n/**\n * Renvoie un tableau (somme des termes positifs, somme des termes ngatifs)\n * @author Rmi Angot\n */\nexport function sommeDesTermesParSigne(liste: number[]) {\n  let sommeDesPositifs = 0\n  let sommeDesNegatifs = 0\n  for (let i = 0; i < liste.length; i++) {\n    if (liste[i] > 0) {\n      sommeDesPositifs += liste[i]\n    } else {\n      sommeDesNegatifs += liste[i]\n    }\n  }\n  return [sommeDesPositifs, sommeDesNegatifs]\n}\n","// valeurs par dfaut\nexport const context = {\n  isInEditor: false,\n  isHtml: true,\n  isAmc: false,\n  isAlc: false,\n  isMoodle: false,\n  issortieNB: false,\n  isDiaporama: false,\n  anglePerspective: 30,\n  coeffPerspective: 0.5,\n  pixelsParCm: 20,\n  scale: 1,\n  unitesLutinParCm: 50,\n  isMainlevee: false,\n  amplitude: 1,\n  fenetreMathalea2d: [-1, -10, 29, 10],\n  objets2D: [],\n  graine: '',\n  // duree: 10,\n  nbBonnesReponses: 0,\n  nbMauvaisesReponses: 0,\n  zoom: 1,\n  seedSpecial: false, // Change le numro de srie si une correction est cache\n  son: 0, // pour ajouter du son au changement de diapo dans le diaporama\n  vue: '', // context.vue = 'diaporama' est utilis pour modifier l'affichage d'un exercice en mode diaporama\n  questionCanEnCours: 0,\n  timer: '',\n}\n\nexport function setOutputHtml() {\n  context.isHtml = true\n  context.isAmc = false\n}\n\nexport function setOutputMoodle() {\n  context.isHtml = true\n  context.isAmc = false\n  context.isMoodle = true\n}\n\nexport function setOutputLatex() {\n  context.isHtml = false\n  context.isAmc = false\n}\n\nexport function setOutputAmc() {\n  context.isHtml = false\n  context.isAmc = true\n}\n\nexport function setOutputAlc() {\n  context.isHtml = false\n  context.isAmc = false\n  context.isAlc = true\n}\n","const epsilon = 0.000001\ndeclare global {\n  interface Window {\n    notify: (message: string, object: unknown) => void\n    notifyLocal: (message: string, object: unknown) => void\n  }\n}\n/**\n *\n * @param {any[]} array1\n * @param {any[]} array2\n * @return boolean\n */\nexport function compareArrays(array1: unknown[], array2: unknown[]): boolean {\n  if (!Array.isArray(array1)) array1 = [array1]\n  if (!Array.isArray(array2)) array2 = [array2]\n  if (array1.length !== array2.length) return false\n  for (let i = 0; i < array1.length; i++) {\n    // le test suivant ne fonctionne pas avec des array contenant des objets, car objet1 === objet2 est toujours false.\n    // il fonctionne avec des arrays d'array ou de primitives.\n    const test = Array.isArray(array1[i])\n      ? compareArrays(array1[i] as unknown[], array2[i] as unknown[])\n      : array1[i] === array2[i]\n    if (!test) return false\n  }\n  return true\n}\n\n/**\n * Retourne true si o1 et o2 ont les mmes proprits avec les mmes valeurs\n * @param o1\n * @param o2\n */\nexport function areSameObject(o1: unknown, o2: unknown): boolean {\n  if (typeof o1 !== 'object' || typeof o2 !== 'object') return false\n  // les deux sont object\n  if (o1 === null) return o2 === null\n  // o1 objet non null\n  if (o2 === null) return false\n  if (Object.keys(o1).length !== Object.keys(o2).length) return false\n  // return Object.entries(o1).every(([key, value]) => areSameValues((o2)[key], value))\n  // EE 24/10/2024 : Tentative de typage de la dernire ligne en remmplacement de la prcdente maintenant commente\n  return Object.entries(o1).every(([key, value]) =>\n    areSameValues((o2 as Record<string, unknown>)[key], value),\n  )\n}\n/**\n * Retourne true si ar1 et ar2 sont deux tableaux de mme longueur, avec les mme valeurs dans le mme ordre\n */\nexport function areSameArray(ar1: unknown[], ar2: unknown[]): boolean {\n  if (!Array.isArray(ar1) || !Array.isArray(ar2) || ar1.length !== ar2.length) {\n    return false\n  }\n  return ar1.every((elt, i) => areSameValues(elt, ar2[i]))\n}\n/**\n * Retourne true si v1 et v2 ont la mme valeur (gaux pour string|boolean|number, mme contenu pour Object|Array)\n * Ne fonctionne pas pour les Object qui ne sont pas des \"plain object\" comme Regexp, Date, etc.\n */\nexport function areSameValues(v1: unknown, v2: unknown): boolean {\n  // une valeur qui n'est pas gale  elle mme en js\n  if (typeof v1 === 'undefined') return typeof v2 === 'undefined'\n  if (v1 === null) return v2 === null\n  if (Number.isNaN(v1)) return Number.isNaN(v2)\n  if (Array.isArray(v1)) return Array.isArray(v2) ? areSameArray(v1, v2) : false\n  if (typeof v1 === 'object') {\n    if (v1 instanceof Date) {\n      if (!(v2 instanceof Date)) return false\n      return v1.valueOf() === v2.valueOf()\n    }\n    if (v1 instanceof RegExp) {\n      if (!(v2 instanceof RegExp)) return false\n      return v1.source === v2.source && v1.flags === v2.flags\n    }\n    return areSameObject(v1, v2)\n  }\n  return v1 === v2\n}\n\n/**\n * Cr tous les couples possibles avec un lment de E1 et un lment de E2.\n * L'ordre est pris en compte, donc on pourra avoir (3,4) et (4,3).\n * Si le nombre de couples possibles est infrieur  nombreDeCouplesMin alors\n * on concatne 2 fois la mme liste, mais avec des ordres diffrents.\n * @param {int} nombreDeCouplesMin=10 - Nombre de couples souhaits\n * @author Rmi Angot\n */\nexport function creerCouples<T1, T2>(\n  E1: T1[],\n  E2: T2[],\n  nombreDeCouplesMin = 10,\n  forcerElementsDifferents = false,\n) {\n  let result = []\n  let temp = []\n  for (const i of E1) {\n    for (const j of E2) {\n      if (!forcerElementsDifferents) {\n        result.push([i, j])\n      } else {\n        if (typeof i !== typeof j || String(i) !== String(j)) {\n          result.push([i, j])\n        }\n      }\n    }\n  }\n\n  temp = shuffle(result).slice(0) // crer un clone du tableau result mlang\n  result = temp.slice(0)\n  while (result.length < nombreDeCouplesMin) {\n    result = result.concat(shuffle(temp))\n  }\n  return result\n}\n\n/**\n * Enlve toutes les occurences d'un lment d'un tableau donn\n * Ajout par Jean-Claude Lhote : la gestion des listes contenant des listes. (par exemple, dans 6N20-2).\n * @param liste\n * @param element\n *\n * @author Rmi Angot\n */\nexport function enleveElement<T>(array: Array<T>, item: T) {\n  //\n  for (let i = array.length - 1; i >= 0; i--) {\n    if (typeof item === 'number') {\n      if (Math.abs((array[i] as number) - item) < epsilon) {\n        array.splice(i, 1)\n      }\n    } else if (Array.isArray(array[i]) && Array.isArray(item)) {\n      if (compareArrays(array[i] as unknown[], item)) {\n        array.splice(i, 1)\n      }\n    } else {\n      if (array[i] === item) {\n        array.splice(i, 1)\n      }\n    }\n  }\n}\n\n/**\n * Enlve toutes les occurences d'un lment d'un tableau donn (array1) et enlve les lments associs dans un autre tableau (array2)\n * @param array array1\n * @param array array2\n * @param element item\n *\n * @author Rmi Angot\n */\nexport function enleveElementDouble<T>(array1: T[], array2: T[], item: T) {\n  //\n  for (let i = array1.length - 1; i >= 0; i--) {\n    if (typeof item === 'number') {\n      if (Math.abs((array1[i] as number) - item) < epsilon) {\n        array1.splice(i, 1)\n        array2.splice(i, 1)\n      }\n    } else {\n      if (array1[i] === item) {\n        array1.splice(i, 1)\n        array2.splice(i, 1)\n      }\n    }\n  }\n}\n\n/**\n *\n * Compter les occurences d'un item dans un tableau\n * @param {array} array\n * @param item\n * @Author Rmi Angot\n */\nexport function compteOccurences<T>(array: T[], value: T): number {\n  let cpt = 0\n  array.forEach((v) => v === value && cpt++)\n  return cpt\n}\n\n/**\n * Enlve toutes les occurences d'un lment d'un tableau donn, mais sans modifier le tableau en paramtre et renvoie le tableau modifi\n * @author Rmi Angot & Jean-Claude Lhote\n */\n\nexport function enleveElementBis<T>(array: T[], item?: T) {\n  const tableaucopie = []\n  for (let i = 0; i < array.length; i++) {\n    tableaucopie.push(array[i])\n  }\n  for (let i = tableaucopie.length - 1; i >= 0; i--) {\n    if (tableaucopie[i] === item) {\n      tableaucopie.splice(i, 1)\n    }\n  }\n  return tableaucopie\n}\n\n/**\n * Enlve l'lment index d'un tableau attention ! modifie le tableau pass en argument ne retourne rien\n * @param {Array<any>} le tableau  modifier\n * @param {number} index de l'lment  retirer\n * @author Jean-Claude Lhote\n */\nexport function enleveElementNo<T>(array: T[], index: number) {\n  if (index >= 0 && index < array.length) array.splice(index, 1)\n}\n\n/**\n * Enlve l'lment index d'un tableau sans modifier le tableau et retourne le rsultat\n * @param {Array<any>} le tableau  modifier\n * @param {number} index de l'lment  retirer\n * @return {Array<any>} une copie du tableau modifi\n * @author Jean-Claude Lhote\n */\nexport function nouveauTableauPriveDunElement<T>(array: T[], index: number) {\n  const tableaucopie = array.slice()\n  return tableaucopie.splice(index, 1)\n}\n\n/**\n * Remplace toutes les occurrences d'une valeur dans un tableau par une autre.\n *\n * @template T - Type des lments du tableau (string ou number).\n * @param {T[]} arr - Le tableau original dans lequel effectuer le remplacement.\n * @param {T} search - La valeur  rechercher dans le tableau.\n * @param {T} replace - La valeur de remplacement  insrer  la place de `search`.\n * @returns {T[]} Un nouveau tableau avec les valeurs remplaces.\n * @author Eric Elter\n * @example\n * remplaceDansTableau(['a', 'b', 'a'], 'a', 'z'); // ['z', 'b', 'z']\n *\n * @example\n * remplaceDansTableau([1, 2, 3, 2], 2, 99); // [1, 99, 3, 99]\n */\nexport function remplaceDansTableau<T extends string | number>(\n  arr: T[],\n  search: T,\n  replace: T,\n): T[] {\n  return arr.map((item) => (item === search ? replace : item))\n}\n\n/**\n * Complte un tableau de nombres uniques dans une plage donne jusqu' atteindre nbQuestions,\n * en ajoutant des nombres alatoires qui ne sont pas dj prsents dans le tableau.\n *\n * @param {number[]} tableau - Le tableau actuel de nombres uniques.\n * @param {number} nbQuestions - Le nombre total de valeurs souhaites.\n * @param {number} valeurMax - La valeur maximale autorise (minimum = 1).\n * @returns {number[]} Un nouveau tableau complt, sans doublons, avec des valeurs entre 1 et valeurMax.\n * @author Eric Elter\n *\n * @throws {Error} Si nbQuestions est suprieur  valeurMax.\n *\n * @example\n * completerNombresUniques([1, 3, 5], 5, 10); // [1, 3, 5, 8, 2] (par exemple)\n */\nexport function completerNombresUniques(\n  tableau: number[],\n  nbQuestions: number,\n  valeurMax: number,\n): number[] {\n  if (nbQuestions > valeurMax) {\n    throw new Error(\n      `Impossible de gnrer ${nbQuestions} valeurs uniques entre 1 et ${valeurMax}.`,\n    )\n  }\n\n  if (tableau.length >= nbQuestions) {\n    return tableau.slice(0, nbQuestions)\n  }\n\n  const existants = new Set(tableau)\n\n  // Gnrer les valeurs manquantes\n  let valeursManquantes: number[] = []\n  for (let i = 1; i <= valeurMax; i++) {\n    if (!existants.has(i)) {\n      valeursManquantes.push(i)\n    }\n  }\n\n  valeursManquantes = shuffle(valeursManquantes)\n\n  const nombreAAjouter = nbQuestions - tableau.length\n  const ajouts = valeursManquantes.slice(0, nombreAAjouter)\n\n  return [...tableau, ...ajouts]\n}\n\n/**\n * Retourne un lment au hasard de la liste sans appartenir  une liste donne\n * @param {liste}\n * @param {listeAEviter}\n *\n * @example\n * // Renvoie 1, 2 ou 3\n * choice([1,2,3])\n * @example\n * // Renvoie Rmi ou La\n * choice(['Rmi','La'])\n *\n * @author Rmi Angot\n */\nexport function choice<T>(liste: T[], listeAEviter: T[] | T = []): T {\n  if (!Array.isArray(listeAEviter)) {\n    listeAEviter = [listeAEviter]\n  }\n  const listebis = liste.slice()\n  // Supprime les lments de liste  viter\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(listebis, listeAEviter[i])\n  }\n  const index = Math.floor(Math.random() * listebis.length)\n  if (listebis[index] != null) return listebis[index]\n  else {\n    window.notify(\n      'choice a limin toutes les possibilits, il ne reste rien  choisir ! ',\n      { liste, listeAEviter },\n    )\n    return listebis[index] // C'est null...\n  }\n}\n\n/**\n * retourne un tableau dans lequel les doublons ont t supprims s'il y en a MAIS SANS TRI\n * @param {array} arr Tableau duquel on veut supprimer les doublons numriques\n * @param {number} tolerance La diffrence minimale entre deux valeurs pour les considrer comme gales\n * @author Jean-Claude Lhote\n **/\nexport function enleveDoublonNum(arr: number[], tolerance = epsilon) {\n  let k = 0\n  while (k < arr.length - 1) {\n    let kk = k + 1\n    while (kk <= arr.length - 1) {\n      if (Math.abs(arr[k] - arr[kk]) < tolerance) {\n        arr[k] = (arr[k] + arr[kk]) / 2 // On remplace la valeur dont on a trouv un double par la moyenne des deux valeurs\n        arr.splice(kk, 1) // on supprime le doublon.\n      } else {\n        kk++\n      }\n    }\n    k++\n  }\n  return arr\n}\n\n/**\n * Mlange les items d'un tableau, sans modifier le tableau pass en argument\n *\n * @Example\n * tableau_melange = shuffle (tableau_origine)\n * @see https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\n */\nexport function shuffle<T>(array: T[]): T[] {\n  let currentIndex = array.length\n  let temporaryValue\n  let randomIndex\n\n  // While there remain elements to shuffle...\n  const arrayBis = [...array]\n  while (currentIndex !== 0) {\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex)\n    currentIndex -= 1\n\n    // And swap it with the current element.\n    temporaryValue = arrayBis[currentIndex]\n    arrayBis[currentIndex] = arrayBis[randomIndex]\n    arrayBis[randomIndex] = temporaryValue\n  }\n\n  return arrayBis\n}\n\nexport function shuffleJusqua<T>(array: T[], indice: number): T[] {\n  if (indice > array.length || indice < 0 || indice === undefined) {\n    return shuffle(array)\n  } else {\n    const tableau1 = array.slice(0, indice)\n    const tableau2 = array.slice(indice)\n    return [...shuffle(tableau1), ...tableau2]\n  }\n}\n\n/**\n * Mlange les lettres d'un string\n *\n * @Example\n * motMelange = shuffleLettres (mot)\n * @see https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\n */\nexport function shuffleLettres(txt: string) {\n  const array = txt.split('')\n  return shuffle(array).join('')\n}\n\n/**\n * Mlange les items de deux tableaux de la mme manire\n *\n *\n * @see https://stackoverflow.com/questions/18194745/shuffle-multiple-javascript-arrays-in-the-same-way\n */\nexport function shuffle2tableaux<T, U>(obj1: T[], obj2: U[]): void {\n  let index = obj1.length\n  let rnd, tmp1, tmp2\n\n  while (index) {\n    rnd = Math.floor(Math.random() * index)\n    index -= 1\n    tmp1 = obj1[index]\n    tmp2 = obj2[index]\n    obj1[index] = obj1[rnd]\n    obj2[index] = obj2[rnd]\n    obj1[rnd] = tmp1\n    obj2[rnd] = tmp2\n  }\n}\n\n/**\n * Mlange les items de deux tableaux de la mme manire\n *\n *\n * @see https://stackoverflow.com/questions/18194745/shuffle-multiple-javascript-arrays-in-the-same-way\n */\nexport function shuffle2tableauxSansModif<T, U>(\n  obj1: T[],\n  obj2: U[],\n): [T[], U[]] {\n  let index = obj1.length\n  let rnd, tmp1, tmp2\n  const obj1bis = obj1.slice()\n  const obj2bis = obj2.slice()\n  while (index) {\n    rnd = Math.floor(Math.random() * index)\n    index -= 1\n    tmp1 = obj1bis[index]\n    tmp2 = obj2bis[index]\n    obj1bis[index] = obj1bis[rnd]\n    obj2bis[index] = obj2bis[rnd]\n    obj1bis[rnd] = tmp1\n    obj2bis[rnd] = tmp2\n  }\n  return [obj1bis, obj2bis]\n}\n\n/**\n * Mlange les items de trois tableaux de la mme manire\n *\n *\n */\nexport function shuffle3tableaux<T, U, V>(\n  obj1: T[],\n  obj2: U[],\n  obj3: V[],\n): void {\n  let index = obj1.length\n  let rnd, tmp1, tmp2, tmp3\n\n  while (index) {\n    rnd = Math.floor(Math.random() * index)\n    index -= 1\n    tmp1 = obj1[index]\n    tmp2 = obj2[index]\n    tmp3 = obj3[index]\n    obj1[index] = obj1[rnd]\n    obj2[index] = obj2[rnd]\n    obj3[index] = obj3[rnd]\n    obj1[rnd] = tmp1\n    obj2[rnd] = tmp2\n    obj3[rnd] = tmp3\n  }\n}\n\n/**\n * Concatne liste  elle-mme en changeant l'ordre  chaque cycle\n * @param {Array | ReadonlyArray} liste - Un tableau\n * @param {number} tailleMinimale - La taille minimale du tableau de sortie\n * @returns {Array} Un tableau du mme type que liste\n *\n * @Example\n * combinaisonListes([A,B,C],7)\n * // [B,C,A,C,B,A,A,B,C]\n *\n * @author Rmi Angot\n */\nexport function combinaisonListes<T>(liste: T[], tailleMinimale?: number) {\n  if (tailleMinimale === undefined) tailleMinimale = liste.length\n  if (liste.length === 0) {\n    window.notify(\n      'erreur dans CombinaisonListes : la liste  combiner est vide',\n      { liste },\n    )\n  }\n  let l = shuffle(liste) // on ne modifie pas la liste passe en argument !\n  while (l.length < tailleMinimale) {\n    l = l.concat(shuffle(liste))\n  }\n  return l\n}\n\n/**\n * Concatne liste  elle-mme en imposant  la nouvelle liste de contenir au moins tous les lements\n * de la liste initiale, mais sans gestion de nombre de doublons.\n * @Example\n * combinaisonListes2([A,B,C],7)\n * // [B,C,B,B,C,A,B]\n * combinaisonListes2([A,B,C,D],6)\n * // [B,C,D,B,C,A,B]\n * @author Eric Elter\n */\nexport function combinaisonListes2<T>(liste: T[], tailleMinimale: number) {\n  if (liste.length === 0) {\n    window.notify(\n      'erreur dans CombinaisonListes : la liste  combiner est vide',\n      { liste },\n    )\n  }\n  let l = [...liste] // on ne modifie pas la liste passe en argument !\n  while (l.length < tailleMinimale) {\n    l = l.concat(choice(liste) as T[])\n  }\n  return shuffle(l)\n}\n\nexport function combinaisonListesSansChangerOrdre<T>(\n  liste: T[],\n  tailleMinimale: number,\n) {\n  // Concatne liste  elle-mme sans changer l'ordre\n  if (liste.length === 0) {\n    window.notify(\n      'erreur dans CombinaisonListes : la liste  combiner est vide',\n      { liste },\n    )\n  }\n  let l = [...liste] // on ne modifie pas la liste passe en argument !\n  while (l.length < tailleMinimale) {\n    l = l.concat(liste)\n  }\n  return l\n}\n\nexport function getRandomSubarray<T>(arr: T[], size: number): T[] {\n  // Copy the array to avoid mutating the original\n  const shuffled = [...arr]\n  let i = arr.length\n  const min = i - size\n  while (i > min) {\n    // Generate a random index from 0 to i (exclusive)\n    const index = Math.floor(Math.random() * i)\n    i--\n    // Swap elements\n    ;[shuffled[i], shuffled[index]] = [shuffled[index], shuffled[i]]\n  }\n  // Return the last 'size' elements after shuffling\n  return shuffled.slice(min)\n}\n\n/**\n * Construit une liste d'index alatoires base sur la taille\n * du tableau originel et le nombre d'index  prlever dans\n * ce tableau.\n * @param {number} originalArraySize taille du tableau d'origine\n * @param {number} nbOfIndexes nombre d'index  choisir\n * @returns {number[]} tableau d'index\n * @author sylvain\n */\nexport function listOfRandomIndexes(\n  originalArraySize: number,\n  nbOfIndexes: number,\n) {\n  const indexes = shuffle([...Array(originalArraySize).keys()])\n  return indexes.slice(0, nbOfIndexes)\n}\n\nexport // Fonction utilitaire pour cloner rcursivement un objet simple\nfunction arrayCloneObject(obj: any): any {\n  const clonedObj: any = {}\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      const value = obj[key]\n      if (Array.isArray(value)) {\n        clonedObj[key] = arrayClone(value)\n      } else if (value && typeof value === 'object') {\n        clonedObj[key] = arrayCloneObject(value)\n      } else {\n        clonedObj[key] = value\n      }\n    }\n  }\n  return clonedObj\n}\n\nexport function arrayClone(originalArray: any[]): any[] {\n  return originalArray.map((item) => {\n    if (Array.isArray(item)) {\n      return arrayClone(item)\n    } else if (item && typeof item === 'object') {\n      // Clone rcursif pour les objets simples\n      const clonedObj: any = {}\n      for (const key in item) {\n        if (Object.prototype.hasOwnProperty.call(item, key)) {\n          const value = item[key]\n          if (Array.isArray(value)) {\n            clonedObj[key] = arrayClone(value)\n          } else if (value && typeof value === 'object') {\n            clonedObj[key] = arrayCloneObject(value)\n          } else {\n            clonedObj[key] = value\n          }\n        }\n      }\n      return clonedObj\n    } else {\n      // Primitives (number, string, boolean, null, undefined)\n      return item\n    }\n  })\n}\n\ntype OptionsBinomes = {\n  premierNombre?: number\n  dernierNombre?: number\n  ordreCroissant?: boolean\n  ordreDecroissant?: boolean\n}\n\n/**\n * Gnre tous les binmes possibles  partir dun tableau de nombres,\n * en respectant ventuellement certaines options de filtrage.\n *\n * @param {number[]} tab - Tableau de nombres  combiner.\n * @param {Object} [options={}] - Options permettant de restreindre ou filtrer les binmes.\n * @param {number} [options.premierNombre] - Si dfini, ne garde que les binmes dont le premier lment est ce nombre.\n * @param {number} [options.dernierNombre] - Si dfini, ne garde que les binmes dont le second lment est ce nombre.\n * @param {boolean} [options.ordreCroissant=false] - Si true, ne conserve que les binmes [a, b] o a < b.\n * @param {boolean} [options.ordreDecroissant=false] - Si true, ne conserve que les binmes [a, b] o a > b.\n * @returns {[number, number][]} Liste de binmes valides.\n * @author Eric Elter\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3])\n * // =>\n * // [\n * //   [0,1],[0,2],[0,3],\n * //   [1,0],[1,2],[1,3],\n * //   [2,0],[2,1],[2,3],\n * //   [3,0],[3,1],[3,2]\n * // ]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { ordreCroissant: true })\n * // => [[0,1],[0,2],[0,3],[1,2],[1,3],[2,3]]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { premierNombre: 2 })\n * // => [[2,0],[2,1],[2,3]]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { dernierNombre: 2 })\n * // => [[0,2],[1,2],[3,2]]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { premierNombre: 1, dernierNombre: 3 })\n * // => [[1,3]]\n */\nexport function genererBinomesAleatoires(\n  tab: number[],\n  options: OptionsBinomes = {},\n): [number, number][] {\n  const {\n    premierNombre = undefined,\n    dernierNombre = undefined,\n    ordreCroissant = false,\n    ordreDecroissant = false,\n  } = options\n\n  const binomes: [number, number][] = []\n\n  for (let i = 0; i < tab.length; i++) {\n    for (let j = 0; j < tab.length; j++) {\n      if (i === j) continue\n\n      const a = tab[i]\n      const b = tab[j]\n\n      // Appliquer les options\n      if (premierNombre !== undefined && a !== premierNombre) continue\n      if (dernierNombre !== undefined && b !== dernierNombre) continue\n      if (ordreCroissant && a >= b) continue\n      if (ordreDecroissant && a <= b) continue\n\n      binomes.push([a, b])\n    }\n  }\n\n  // Mlange alatoire (Fisher-Yates)\n  for (let i = binomes.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    ;[binomes[i], binomes[j]] = [binomes[j], binomes[i]]\n  }\n  return binomes\n}\n","import { isArray, isInteger } from 'mathjs'\nimport { context } from '../../modules/context'\nimport type { IFractionEtendue } from '../../modules/FractionEtendue.type'\nimport { choice } from './arrayOutils'\n\n// Garde structurel pour dtecter une FractionEtendue\nconst isFractionEtendue = (x: unknown): x is IFractionEtendue =>\n  typeof x === 'object' &&\n  x !== null &&\n  typeof (x as any).sommeFraction === 'function'\n\n/**\n * Met en couleur et en gras\n *\n * Met en couleur et gras un texte. JCL dit : \"S'utilise entre $ car utilise des commandes qui fonctionnent en math inline\"\n * @param {string|number} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Rmi Angot\n */\nexport function miseEnEvidence(\n  texte: string | IFractionEtendue | number,\n  couleur: string = '#f15929',\n) {\n  if (isFractionEtendue(texte)) texte = texte.texFraction\n  if (typeof texte === 'number') texte = String(texte)\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `{\\\\color{${couleur}}\\\\boldsymbol{${texte}}}`\n  } else {\n    if (couleur[0] === '#') {\n      return `{\\\\color[HTML]{${couleur.replace('#', '')}}\\\\boldsymbol{${texte}}}`\n    } else if (couleur === 'green') {\n      return `{\\\\color[HTML]{008002}\\\\boldsymbol{${texte}}}`\n    } else {\n      return `{\\\\color{${couleur.replace('#', '')}}\\\\boldsymbol{${texte}}}`\n    }\n  }\n}\n\n/**\n * Met en vidence un seul chiffre dun nombre au format LaTeX, en le coloriant et le mettant en gras.\n *\n * - Si le texte contient une virgule, la fonction identifie la partie entire ( gauche)\n *   et la partie dcimale ( droite), puis colore le chiffre selon la position demande.\n * - Si le texte ne contient pas de virgule, seul un chiffre de la partie entire est cibl.\n *\n * @param {string | FractionEtendue | number} texte - Le nombre ou texte  analyser.\n *   Peut tre :\n *   - une chane (ex. \"123,45\")\n *   - un nombre (ex. 123.45)\n *   - une instance de `FractionEtendue` (sa proprit `texFraction` sera utilise)\n *\n * @param {string} [couleur='#f15929'] - Couleur  utiliser pour le chiffre mis en vidence.\n *   Peut tre un nom de couleur LaTeX (ex. `\"red\"`) ou un code hexadcimal (ex. `\"#FF0000\"`).\n *\n * @param {number} [position=1] - La position du chiffre  mettre en vidence :\n *   - `0.001`  3e chiffre  droite de la virgule (millime)\n *   - `0.01`   2e chiffre  droite de la virgule (centime)\n *   - `0.1`    1er chiffre  droite de la virgule (dixime)\n *   - `1`      chiffre immdiatement  gauche de la virgule (unit)\n *   - `10`     2e chiffre  gauche de la virgule (dizaine)\n *   - `100`    3e chiffre  gauche de la virgule (centaine)\n *   - `1000`   4e chiffre  gauche de la virgule (millier)\n * @author Eric Elter\n * @returns {string} Une chane LaTeX avec un seul chiffre mis en couleur et en gras.\n *   Le reste du nombre est laiss tel quel.\n */\n\nexport function coloreUnSeulChiffre(\n  texte: string | IFractionEtendue | number,\n  couleur: string = '#f15929',\n  position: number = 1,\n): string {\n  if (isFractionEtendue(texte)) texte = texte.texFraction\n  if (typeof texte === 'number') texte = String(texte)\n  if (Array.isArray(couleur)) couleur = couleur[0]\n\n  const getColorLatex = (contenu: string): string => {\n    if (context.isHtml) {\n      return `\\\\color{${couleur}}\\\\boldsymbol{${contenu}}`\n    } else if (couleur === 'green') {\n      return `\\\\color[HTML]{008002}\\\\boldsymbol{${contenu}}`\n    } else if (couleur.startsWith('#')) {\n      return `\\\\color[HTML]{${couleur.slice(1)}}\\\\boldsymbol{${contenu}}`\n    } else {\n      return `\\\\color{${couleur}}\\\\boldsymbol{${contenu}}`\n    }\n  }\n\n  const indexGauche = new Map<number, number>([\n    [1, -1], // units\n    [10, -2], // dizaines\n    [100, -3], // centaines\n    [1000, -6], // milliers -6  cause du sparateur de milliers\n  ])\n\n  const indexDroite = new Map<number, number>([\n    [0.1, 0], // diximes\n    [0.01, 1], // centimes\n    [0.001, 2], // millimes\n  ])\n\n  const estDroite = position < 1\n  const index = estDroite\n    ? indexDroite.get(position)\n    : indexGauche.get(position)\n  if (index === undefined) return texte // scurit\n\n  // Cas avec virgule\n  if (texte.includes('{,}')) {\n    const [partieEntiere, partieDecimale] = texte.split('{,}')\n\n    if (estDroite) {\n      if (index >= partieDecimale.length) return texte\n      const avant = partieDecimale.slice(0, index)\n      const chiffreCible = partieDecimale.charAt(index)\n      const apres = partieDecimale.slice(index + 1)\n      const colored = getColorLatex(chiffreCible)\n      return `\\\\boldsymbol{${partieEntiere}{,}${avant}}{${colored}}\\\\boldsymbol{${apres}}`\n    } else {\n      const pos = partieEntiere.length + index\n      if (pos < 0 || pos >= partieEntiere.length) return texte\n      const prefixe = partieEntiere.slice(0, pos)\n      const chiffreCible = partieEntiere.charAt(pos)\n      const suffixe = partieEntiere.slice(pos + 1)\n      const colored = getColorLatex(chiffreCible)\n\n      return `\\\\boldsymbol{${prefixe}}{${colored}}\\\\boldsymbol{${suffixe}{,}${partieDecimale}}`\n    }\n  }\n\n  // Cas sans virgule\n  const partieEntiere = texte\n  if (estDroite) {\n    // Pas de partie dcimale  on ne peut pas accder  des chiffres  droite\n    return texte\n  } else {\n    const pos = partieEntiere.length + index\n    if (pos < 0 || pos >= partieEntiere.length) return texte\n    const prefixe = partieEntiere.slice(0, pos)\n    const chiffreCible = partieEntiere.charAt(pos)\n    const suffixe = partieEntiere.slice(pos + 1)\n    const colored = getColorLatex(chiffreCible)\n    return `\\\\boldsymbol{${prefixe}}{${colored}}\\\\boldsymbol{${suffixe}}`\n  }\n}\n\n/**\n * Met en couleur\n * Met en couleur un texte. JCL dit : \"S'utilise entre $ car utilise des commandes qui fonctionnent en math inline\"\n * @param {string} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Guillaume Valmont d'apres MiseEnEvidence() de Rmi Angot\n */\nexport function miseEnCouleur(\n  texte: string | number,\n  couleur: string = '#f15929',\n) {\n  texte = typeof texte === 'number' ? String(texte) : texte\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `{\\\\color{${couleur}} ${texte}}`\n  } else {\n    if (couleur[0] === '#') {\n      return `{\\\\color[HTML]{${couleur.replace('#', '')}} ${texte}}`\n    } else if (couleur === 'green') {\n      return `{\\\\color[HTML]{008002} ${texte}}`\n    } else {\n      return `{\\\\color{${couleur}} ${texte}}`\n    }\n  }\n}\n\n/**\n * Met en couleur un texte\n * @param {string} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Rmi Angot\n */\nexport function texteEnCouleur(texte: string | number, couleur = '#f15929') {\n  texte = typeof texte === 'number' ? String(texte) : texte\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `<span style=\"color:${couleur};\">${texte}</span>`\n  } else {\n    if (couleur[0] === '#') {\n      return `{\\\\color[HTML]{${couleur.replace('#', '')}}${texte}}`\n    } else if (couleur === 'green') {\n      return `{\\\\color[HTML]{008002} ${texte}}`\n    } else {\n      return `{\\\\color{${couleur.replace('#', '')}}${texte}}`\n    }\n  }\n}\n\n/**\n * Met en couleur et gras un texte. JCL dit : \"Ne fonctionne qu'en dehors de $....$\". Utiliser miseEnEvidence si $....$.\n * @param {string} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Rmi Angot\n */\nexport function texteEnCouleurEtGras(\n  texte: string | number,\n  couleur = '#f15929',\n) {\n  if (typeof texte === 'number') texte = String(texte)\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `<span style=\"color:${couleur};font-weight: bold;\">${texte}</span>`\n  }\n  if (couleur[0] === '#') {\n    return `{\\\\bfseries \\\\color[HTML]{${couleur.replace('#', '')}}${texte}}`\n  }\n  if (couleur === 'green') {\n    return `{\\\\bfseries \\\\color[HTML]{008002} ${texte}}`\n  }\n  return `{\\\\bfseries \\\\color{${couleur.replace('#', '')}}${texte}}`\n}\n\nexport function barreTexte(text: string) {\n  if (context.isHtml) {\n    return `<span class=\"oblique-strike\">${text}</span>`\n  } else {\n    return `\\\\strike{${text}}`\n  }\n}\n\n/**\n * couleurAleatoire() renvoie le code d'une couleur au hasard\n *\n * @author Rmi Angot\n */\nexport function couleurAleatoire() {\n  return choice([\n    'white',\n    'black',\n    'red',\n    'green',\n    'blue',\n    'cyan',\n    'magenta',\n    'yellow',\n  ])\n}\n\n/**\n * couleurTab() renvoie :\n * soit le code d'une couleur au hasard, ainsi que sa traduction franaise au masculin et au fminin,\n * soit le code d'une couleur impose, ainsi que sa traduction franaise au masculin et au fminin.\n * @example couleurTab() peut renvoyer ['black','noir','noire'].\n * @example couleurTab(0) renverra de faon certaine ['black','noir','noire'].\n * @author Eric Elter\n */\nexport function couleurTab(choixCouleur = 999) {\n  const panelCouleurs = [\n    ['black', 'noir', 'noire'],\n    ['red', 'rouge', 'rouge'],\n    ['green', 'vert', 'verte'],\n    ['blue', 'bleu', 'bleue'],\n    ['HotPink', 'rose', 'rose'],\n    ['Sienna', 'marron', 'marron'],\n    ['darkgray', 'gris', 'grise'],\n    ['DarkOrange', 'orange', 'orange'],\n  ]\n  return choixCouleur === 999 ||\n    choixCouleur >= panelCouleurs.length ||\n    !isInteger(choixCouleur)\n    ? choice(panelCouleurs)\n    : panelCouleurs[choixCouleur]\n}\n\nexport function arcenciel(i: number, fondblanc = true) {\n  let couleurs\n  if (fondblanc)\n    couleurs = ['violet', 'purple', 'blue', 'green', 'lime', '#f15929', 'red']\n  else\n    couleurs = ['violet', 'indigo', 'blue', 'green', 'yellow', '#f15929', 'red']\n  return couleurs[i % 7]\n}\n\nexport function texcolors(i: number, fondblanc = true) {\n  const couleurs = [\n    'black',\n    'blue',\n    'brown',\n    'green',\n    'cyan',\n    'darkgray',\n    'pink',\n    'orange',\n    'red',\n    'magenta',\n    'purple',\n    'violet',\n    'white',\n    'yellow',\n  ]\n  if (fondblanc && i % couleurs.length >= couleurs.length - 2) i += 2\n  return couleurs[i % couleurs.length]\n}\n\n/**\n * Met gras un texte\n * @param {string} texte  mettre en gras\n * @author Rmi Angot\n */\nexport function texteGras(texte: string) {\n  if (context.isHtml) {\n    return `<b>${texte}</b>`\n  } else {\n    return `\\\\textbf{${texte}}`\n  }\n}\n\n/**\n * Texte en italique\n */\nexport function texteItalique(texte: string) {\n  if (context.isHtml) {\n    return `<i>${texte}</i>`\n  } else {\n    return `\\\\textit{${texte}}`\n  }\n}\n\nexport function blocCode(texte: string) {\n  if (context.isHtml) {\n    return `<pre style=\"background-color: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; padding: 10px; font-family: Courier New, monospace; white-space: pre-wrap;\">\n    ${texte}</pre>`\n  }\n  return `\\\\fbox{\n    \\\\parbox{0.5\\\\linewidth}{\n    \\\\setlength{\\\\parskip}{.5cm}\n    \\\\texttt{${texte}\n    }\n    }\\\\newline`\n}\n\nexport function texteCode(texte: string) {\n  if (context.isHtml) {\n    return `<span style=\"background-color: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; font-family: Courier New, monospace; white-space: pre-wrap;\">${texte}</span>`\n  }\n  return `\\\\colorbox{lightgray}{\\\\texttt{${texte}}}`\n}\n\nexport function texteEnBoite(texte: string) {\n  if (context.isHtml) {\n    return `<div style=\"display: inline-block; max-width: fit-content; border: 2px solid #444; border-radius: 4px; padding: 10px;\">${texte}</div>`\n  }\n  return `\\\\fbox{\\\\parbox{0.5\\\\linewidth}{\\\\setlength{\\\\parskip}{.5cm}${texte}}}\\\\newline`\n}\n","/**\n * Calcule le PGCD (Plus Grand Commun Diviseur) de deux nombres en utilisant l'algorithme d'Euclide\n * @param {number} a - Premier nombre\n * @param {number} b - Deuxime nombre\n * @returns {number} Le PGCD de a et b\n */\nexport function gcd(a: number, b: number): number {\n  a = Math.abs(a)\n  b = Math.abs(b)\n\n  if (b === 0) return a\n  if (a === 0) return b\n\n  while (b !== 0) {\n    const temp = b\n    b = a % b\n    a = temp\n  }\n  return a\n}\n\n/**\n * Calcule le PGCD de plusieurs nombres\n * @param {...number} args - Liste des nombres\n * @returns {number} Le PGCD de tous les nombres\n */\nexport function gcdMultiple(...args: number[]): number {\n  if (args.length === 0) return 0\n  if (args.length === 1) return Math.abs(args[0])\n\n  return args.reduce((acc, current) => gcd(acc, current))\n}\n\n/**\n * Vrifie si un nombre est premier\n * @param {number} n - Le nombre  tester\n * @returns {boolean} true si le nombre est premier, false sinon\n */\nfunction isPrime(n: number): boolean {\n  if (!Number.isInteger(n) || n < 2) return false\n  if (n === 2) return true\n  if (n % 2 === 0) return false\n\n  // On teste seulement les nombres impairs jusqu' sqrt(n)\n  const sqrt = Math.sqrt(n)\n  for (let i = 3; i <= sqrt; i += 2) {\n    if (n % i === 0) return false\n  }\n  return true\n}\n\n/**\n * Renvoie le PGCD de deux nombres\n * @author Rmi Angot\n */\nexport function pgcd(...args: number[]) {\n  return gcdMultiple(...args)\n}\n\n/**\n * Renvoie le PPCM de deux nombres\n * @author Rmi Angot\n */\nexport function ppcm(a: number, b: number): number {\n  if (a === 0 || b === 0) return 0\n  return Math.abs(a * b) / pgcd(a, b)\n}\n\n/**\n * Renvoie le PPCM d'une liste de nombres\n * @param numbers - Liste des nombres\n * @returns Le PPCM de tous les nombres de la liste\n * @author Nathan Scheinmann\n */\nexport function ppcmListe(numbers: number[]): number {\n  if (numbers.length === 0) return 0\n  if (numbers.length === 1) return Math.abs(numbers[0])\n\n  return numbers.reduce((acc, current) => ppcm(acc, current))\n}\n\n/**\n * Donne la liste des facteurs premiers d'un nombre\n * @param { number } n - Nombre  dcomposer\n * @returns {number[]} - Liste des facteurs premiers\n */\nexport function obtenirListeFacteursPremiers(n: number) {\n  if (n === 1 || n === 0) return [] // 1 n'est pas premier, mais, sinon, a retourne [NaN]\n  const facteurs = []\n  const signe = n < 0 ? -1 : 1\n  let nAbs = Math.abs(n)\n\n  for (let i = 2; i <= nAbs; i++) {\n    while (nAbs % i === 0) {\n      facteurs.push(i)\n      nAbs /= i\n    }\n  }\n\n  if (facteurs.length > 0) {\n    facteurs[0] = signe * facteurs[0]\n  }\n  return facteurs\n}\n\n/**\n * Retourne un nombre semi-premier alatoire infrieur ou gal  max\n * @param {number} max\n * @return {number} un nombre semi-premier <= max\n * @author Guillaume Valmont\n */\nexport function obtenirSemiPremier(max: number): number {\n  const listePremiers = listeNombresPremiersStrictJusqua(max + 1)\n  const semiPremiers: number[] = []\n\n  // Gnre tous les produits de deux premiers distincts <= max\n  for (let i = 0; i < listePremiers.length; i++) {\n    for (let j = i + 1; j < listePremiers.length; j++) {\n      const semiPremier = listePremiers[i] * listePremiers[j]\n      if (semiPremier <= max) semiPremiers.push(semiPremier)\n    }\n  }\n\n  if (semiPremiers.length === 0) {\n    window.notify('Pas de semi-premier < max trouv.', { max })\n    return 6\n  }\n\n  // Renvoie un semi-premier au hasard en utilisant Math.random()\n  const indexAleatoire = Math.floor(Math.random() * semiPremiers.length)\n  return semiPremiers[indexAleatoire]\n}\n\n/**\n *\n * @param {Entier} n\n * Retourne la factorisation d'un entier sous la forme [[a0,n0],[a1,n1],...] o a0,a1 sont les facteurs premiers et n0, n1 sont les exposants de ces facteurs.\n * @author Jean-Claude Lhote\n */\n\nexport function factorisation(n: number): [number, number][] {\n  if (n === 1) return [[1, 1]]\n  const liste = obtenirListeFacteursPremiers(n)\n  const facto: [number, number][] = []\n  let index = 0\n  for (let i = 0; i < liste.length; ) {\n    if (liste[i] === 0) i++\n    else {\n      facto.push([liste[i], 1])\n      index++\n      for (let j = i + 1; j < liste.length; j++) {\n        if (liste[j] === liste[i]) {\n          facto[index - 1][1]++\n          liste[j] = 0\n        }\n      }\n      i++\n    }\n  }\n  return facto\n}\n\n/**\n *\n * @param {number} n\n * @param {boolean} puissancesOn\n * @returns {string} texFacto\n */\nexport function texFactorisation(n: number, puissancesOn = true) {\n  let texFacto = ''\n  let facto = []\n  if (puissancesOn) {\n    facto = factorisation(n)\n    for (let i = 0; i < facto.length - 1; i++) {\n      texFacto += `${facto[i][0]}${facto[i][1] > 1 ? '^{' + facto[i][1] + '}\\\\times ' : '\\\\times '}`\n    }\n    texFacto += `${facto[facto.length - 1][0]}${facto[facto.length - 1][1] > 1 ? '^{' + facto[facto.length - 1][1] + '}' : ''}`\n  } else {\n    facto = obtenirListeFacteursPremiers(n)\n    for (let i = 0; i < facto.length - 1; i++) {\n      texFacto += `${facto[i]}\\\\times `\n    }\n    texFacto += `${facto[facto.length - 1]}`\n  }\n  return texFacto\n}\n\n/**\n * Renvoie un tableau contenant les diviseurs d'un nombre entier, rangs dans l'ordre croissant\n * @param {number} n\n * @author Sbastien Lozano\n */\nexport function listeDesDiviseurs(n: number) {\n  let i = 2\n  const diviseurs = [1]\n  while (i <= n) {\n    if (n % i === 0) {\n      diviseurs.push(i)\n    }\n    i++\n  }\n  return diviseurs\n}\n\nexport function estPremier(n: number) {\n  return isPrime(n)\n}\n/**\n * Retourne la liste des nombres premiers infrieurs  N N<300 N exclu\n * @param {number} k On cherchera un multiple de k\n * @param {number} n Ce multiple sera suprieur ou gal  n\n * @author Rmi Angot\n */\nexport function premierMultipleSuperieur(k: number, n: number) {\n  let result = n\n  let reste\n  if (Number.isInteger(k) && Number.isInteger(n)) {\n    while (result % k !== 0) {\n      result += 1\n    }\n    return result\n  } else {\n    if (Math.floor(n / k) === n / k) return n\n    else {\n      reste = n / k - Math.floor(n / k)\n      return n - reste * k + k\n    }\n  }\n}\n\nexport function premierMultipleInferieur(k: number, n: number) {\n  const result = premierMultipleSuperieur(k, n)\n  if (result !== n) return result - k\n  else return n\n}\n\n/**\n * Retourne la liste des nombres premiers infrieurs  N N<1000 N exclu\n * @param {number} borneSup\n * @author Sbastien Lozano\n * Augment des N<300  N<1000 par Guillaume Valmont\n */\nexport function listeNombresPremiersStrictJusqua(borneSup: number) {\n  // tableau contenant les 1000 premiers nombres premiers\n  const liste1000 = [\n    2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,\n    73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151,\n    157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233,\n    239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317,\n    331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419,\n    421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503,\n    509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607,\n    613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701,\n    709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811,\n    821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911,\n    919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013,\n    1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091,\n    1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181,\n    1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277,\n    1279, 1283, 1289, 1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361,\n    1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451,\n    1453, 1459, 1471, 1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531,\n    1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609,\n    1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699,\n    1709, 1721, 1723, 1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789,\n    1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889,\n    1901, 1907, 1913, 1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997,\n    1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083,\n    2087, 2089, 2099, 2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161,\n    2179, 2203, 2207, 2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273,\n    2281, 2287, 2293, 2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357,\n    2371, 2377, 2381, 2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441,\n    2447, 2459, 2467, 2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551,\n    2557, 2579, 2591, 2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663,\n    2671, 2677, 2683, 2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729,\n    2731, 2741, 2749, 2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819,\n    2833, 2837, 2843, 2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917,\n    2927, 2939, 2953, 2957, 2963, 2969, 2971, 2999, 3001, 3011, 3019, 3023,\n    3037, 3041, 3049, 3061, 3067, 3079, 3083, 3089, 3109, 3119, 3121, 3137,\n    3163, 3167, 3169, 3181, 3187, 3191, 3203, 3209, 3217, 3221, 3229, 3251,\n    3253, 3257, 3259, 3271, 3299, 3301, 3307, 3313, 3319, 3323, 3329, 3331,\n    3343, 3347, 3359, 3361, 3371, 3373, 3389, 3391, 3407, 3413, 3433, 3449,\n    3457, 3461, 3463, 3467, 3469, 3491, 3499, 3511, 3517, 3527, 3529, 3533,\n    3539, 3541, 3547, 3557, 3559, 3571, 3581, 3583, 3593, 3607, 3613, 3617,\n    3623, 3631, 3637, 3643, 3659, 3671, 3673, 3677, 3691, 3697, 3701, 3709,\n    3719, 3727, 3733, 3739, 3761, 3767, 3769, 3779, 3793, 3797, 3803, 3821,\n    3823, 3833, 3847, 3851, 3853, 3863, 3877, 3881, 3889, 3907, 3911, 3917,\n    3919, 3923, 3929, 3931, 3943, 3947, 3967, 3989, 4001, 4003, 4007, 4013,\n    4019, 4021, 4027, 4049, 4051, 4057, 4073, 4079, 4091, 4093, 4099, 4111,\n    4127, 4129, 4133, 4139, 4153, 4157, 4159, 4177, 4201, 4211, 4217, 4219,\n    4229, 4231, 4241, 4243, 4253, 4259, 4261, 4271, 4273, 4283, 4289, 4297,\n    4327, 4337, 4339, 4349, 4357, 4363, 4373, 4391, 4397, 4409, 4421, 4423,\n    4441, 4447, 4451, 4457, 4463, 4481, 4483, 4493, 4507, 4513, 4517, 4519,\n    4523, 4547, 4549, 4561, 4567, 4583, 4591, 4597, 4603, 4621, 4637, 4639,\n    4643, 4649, 4651, 4657, 4663, 4673, 4679, 4691, 4703, 4721, 4723, 4729,\n    4733, 4751, 4759, 4783, 4787, 4789, 4793, 4799, 4801, 4813, 4817, 4831,\n    4861, 4871, 4877, 4889, 4903, 4909, 4919, 4931, 4933, 4937, 4943, 4951,\n    4957, 4967, 4969, 4973, 4987, 4993, 4999, 5003, 5009, 5011, 5021, 5023,\n    5039, 5051, 5059, 5077, 5081, 5087, 5099, 5101, 5107, 5113, 5119, 5147,\n    5153, 5167, 5171, 5179, 5189, 5197, 5209, 5227, 5231, 5233, 5237, 5261,\n    5273, 5279, 5281, 5297, 5303, 5309, 5323, 5333, 5347, 5351, 5381, 5387,\n    5393, 5399, 5407, 5413, 5417, 5419, 5431, 5437, 5441, 5443, 5449, 5471,\n    5477, 5479, 5483, 5501, 5503, 5507, 5519, 5521, 5527, 5531, 5557, 5563,\n    5569, 5573, 5581, 5591, 5623, 5639, 5641, 5647, 5651, 5653, 5657, 5659,\n    5669, 5683, 5689, 5693, 5701, 5711, 5717, 5737, 5741, 5743, 5749, 5779,\n    5783, 5791, 5801, 5807, 5813, 5821, 5827, 5839, 5843, 5849, 5851, 5857,\n    5861, 5867, 5869, 5879, 5881, 5897, 5903, 5923, 5927, 5939, 5953, 5981,\n    5987, 6007, 6011, 6029, 6037, 6043, 6047, 6053, 6067, 6073, 6079, 6089,\n    6091, 6101, 6113, 6121, 6131, 6133, 6143, 6151, 6163, 6173, 6197, 6199,\n    6203, 6211, 6217, 6221, 6229, 6247, 6257, 6263, 6269, 6271, 6277, 6287,\n    6299, 6301, 6311, 6317, 6323, 6329, 6337, 6343, 6353, 6359, 6361, 6367,\n    6373, 6379, 6389, 6397, 6421, 6427, 6449, 6451, 6469, 6473, 6481, 6491,\n    6521, 6529, 6547, 6551, 6553, 6563, 6569, 6571, 6577, 6581, 6599, 6607,\n    6619, 6637, 6653, 6659, 6661, 6673, 6679, 6689, 6691, 6701, 6703, 6709,\n    6719, 6733, 6737, 6761, 6763, 6779, 6781, 6791, 6793, 6803, 6823, 6827,\n    6829, 6833, 6841, 6857, 6863, 6869, 6871, 6883, 6899, 6907, 6911, 6917,\n    6947, 6949, 6959, 6961, 6967, 6971, 6977, 6983, 6991, 6997, 7001, 7013,\n    7019, 7027, 7039, 7043, 7057, 7069, 7079, 7103, 7109, 7121, 7127, 7129,\n    7151, 7159, 7177, 7187, 7193, 7207, 7211, 7213, 7219, 7229, 7237, 7243,\n    7247, 7253, 7283, 7297, 7307, 7309, 7321, 7331, 7333, 7349, 7351, 7369,\n    7393, 7411, 7417, 7433, 7451, 7457, 7459, 7477, 7481, 7487, 7489, 7499,\n    7507, 7517, 7523, 7529, 7537, 7541, 7547, 7549, 7559, 7561, 7573, 7577,\n    7583, 7589, 7591, 7603, 7607, 7621, 7639, 7643, 7649, 7669, 7673, 7681,\n    7687, 7691, 7699, 7703, 7717, 7723, 7727, 7741, 7753, 7757, 7759, 7789,\n    7793, 7817, 7823, 7829, 7841, 7853, 7867, 7873, 7877, 7879, 7883, 7901,\n    7907, 7919, 7927, 7933, 7937, 7949, 7951, 7963, 7993, 8009, 8011, 8017,\n    8039, 8053, 8059, 8069, 8081, 8087, 8089, 8093, 8101, 8111, 8117, 8123,\n    8147, 8161, 8167, 8171, 8179, 8191, 8209, 8219, 8221, 8231, 8233, 8237,\n    8243, 8263, 8269, 8273, 8287, 8291, 8293, 8297, 8311, 8317, 8329, 8353,\n    8363, 8369, 8377, 8387, 8389, 8419, 8423, 8429, 8431, 8443, 8447, 8461,\n    8467, 8501, 8513, 8521, 8527, 8537, 8539, 8543, 8563, 8573, 8581, 8597,\n    8599, 8609, 8623, 8627, 8629, 8641, 8647, 8663, 8669, 8677, 8681, 8689,\n    8693, 8699, 8707, 8713, 8719, 8731, 8737, 8741, 8747, 8753, 8761, 8779,\n    8783, 8803, 8807, 8819, 8821, 8831, 8837, 8839, 8849, 8861, 8863, 8867,\n    8887, 8893, 8923, 8929, 8933, 8941, 8951, 8963, 8969, 8971, 8999, 9001,\n    9007, 9011, 9013, 9029, 9041, 9043, 9049, 9059, 9067, 9091, 9103, 9109,\n    9127, 9133, 9137, 9151, 9157, 9161, 9173, 9181, 9187, 9199, 9203, 9209,\n    9221, 9227, 9239, 9241, 9257, 9277, 9281, 9283, 9293, 9311, 9319, 9323,\n    9337, 9341, 9343, 9349, 9371, 9377, 9391, 9397, 9403, 9413, 9419, 9421,\n    9431, 9433, 9437, 9439, 9461, 9463, 9467, 9473, 9479, 9491, 9497, 9511,\n    9521, 9533, 9539, 9547, 9551, 9587, 9601, 9613, 9619, 9623, 9629, 9631,\n    9643, 9649, 9661, 9677, 9679, 9689, 9697, 9719, 9721, 9733, 9739, 9743,\n    9749, 9767, 9769, 9781, 9787, 9791, 9803, 9811, 9817, 9829, 9833, 9839,\n    9851, 9857, 9859, 9871, 9883, 9887, 9901, 9907, 9923, 9929, 9931, 9941,\n    9949, 9967, 9973,\n  ]\n  const liste = []\n  let i = 0\n  while (liste1000[i] < borneSup) {\n    liste.push(liste1000[i])\n    i++\n  }\n  return liste\n}\n\n/**\n * Liste les nombres premiers jusque n avec la mthode du crible d'Eratosthene optimise\n * @param {number} n\n * @author Sbastien Lozano\n */\nexport function cribleEratostheneN(n: number) {\n  const tabEntiers = [] // pour tous les entiers de 2  n\n  const testMax = Math.sqrt(n + 1) // inutile de tester au dela de racine de n\n  const liste = [] // tableau de la liste des premiers jusqu' n\n\n  // On rempli un tableau avec des booleens de 2  n\n  for (let i = 0; i < n + 1; i++) {\n    tabEntiers.push(true)\n  }\n\n  // On supprime les multiples des nombres premiers  partir de 2, 3, 5,...\n  for (let i = 2; i <= testMax; i++) {\n    if (tabEntiers[i]) {\n      for (let j = i * i; j < n + 1; j += i) {\n        tabEntiers[j] = false\n      }\n    }\n  }\n\n  // On rcupre tous les indices du tableau des entiers dont le boolen est  true qui sont donc premiers\n  for (let i = 2; i < n + 1; i++) {\n    if (tabEntiers[i]) {\n      liste.push(i)\n    }\n  }\n\n  return liste\n}\n\n/**\n * Liste les premiers compris entre min et max au sens large,\n * min est inclu\n * max est inclu.\n * @param {number} min\n * @param {number} max\n * @author Sbastien Lozano\n */\n\nexport function premiersEntreBornes(min: number, max: number) {\n  // on cre les premiers jusque min\n  const premiersASupprimer = cribleEratostheneN(min - 1)\n  // on cre les premiers jusque max\n  const premiersJusqueMax = cribleEratostheneN(max)\n  // on supprime le dbut de la liste jusque min\n  premiersJusqueMax.splice(0, premiersASupprimer.length)\n  // on renvoie le tableau restant\n  return premiersJusqueMax\n}\n\n/**\n * renvoie un tableau avec la decomposition en facteurs premiers sous forme dveloppe\n * @param {number} n\n * @author Sbastien Lozano\n */\nexport function decompositionFacteursPremiersArray(n: number) {\n  const decomposition = []\n  const liste = obtenirListeFacteursPremiers(n)\n  for (const i in liste) {\n    decomposition.push(liste[i])\n  }\n  return decomposition\n}\n\n/**\n * Retourne la liste des nombres premiers infrieurs  300\n * @author Rmi Angot\n */\nexport function obtenirListeNombresPremiers(n = 300) {\n  const prems = [\n    2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,\n    73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151,\n    157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233,\n    239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293,\n  ]\n  for (let i = 307; i <= n; i++) {\n    if (isPrime(i)) prems.push(i)\n  }\n  return prems\n}\n\n/**\n * Retourne le code LaTeX de la dcomposition en produit de facteurs premiers d'un nombre\n * @author Rmi Angot\n */\nexport function decompositionFacteursPremiers(n: number) {\n  let decomposition = ''\n  if (Math.abs(n) === 1) return n // EE : Ncessaire pour 4C22... Vrifier si aucun dommage collatral ailleurs (29/04/2024)\n  const liste = obtenirListeFacteursPremiers(n)\n  for (const i in liste) {\n    decomposition += `${liste[i] < 0 ? `(${liste[i]})` : `${liste[i]}`}\\\\times`\n  }\n  decomposition = decomposition.substring(0, decomposition.length - 6)\n  return decomposition\n}\n\n/**\n *\n * @param {number} n\n * @param {boolean} infrieur si true, commence la recherche  2 en croissant sinon commence  n+1\n * @returns {number}\n */\nexport function premierAvec(\n  n: number,\n  listeAEviter: number[] = [],\n  inferieur = true,\n) {\n  if (n < 2) throw Error(`Impossible de trouver un nombre premier avec ${n}`)\n  let candidat = inferieur ? 2 : n + 1\n  do {\n    if (pgcd(n, candidat) === 1 && !listeAEviter.includes(candidat))\n      return candidat\n    candidat++\n  } while (true)\n}\n","/**\n * Retourne le signe d'un nombre\n * @Example\n * // + ou -\n * @author Rmi Angot\n */\nimport Decimal from 'decimal.js'\nimport { round } from 'mathjs'\nimport { enleveElement } from './arrayOutils'\n\nexport function signe(a: number) {\n  // + ou -\n  let result\n  if (a > 0) {\n    result = '+'\n  } else {\n    result = '-'\n  }\n  return result\n}\n\n/**\n * Retourne la somme des chiffres (ou d'un tableau de chiffres) d'un nombre en valeur et sous forme de String [valeur, String]\n * @Example\n * sommeDesChiffres(123)\n * // [ 6, '1+2+3']\n * @author Rmi Angot (Rajout Tableau par EE)\n */ export function sommeDesChiffres(n: number | number[]): [number, string] {\n  let nString\n  if (Array.isArray(n)) nString = n.join('').toString()\n  else nString = n.toString()\n  let somme = 0\n  let sommeString = ''\n  for (let i = 0; i < nString.length - 1; i++) {\n    if (\n      ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(nString[i]) !==\n      -1\n    ) {\n      sommeString += nString[i] + '+'\n      somme += Number(nString[i])\n    }\n  }\n  if (\n    ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(\n      nString[nString.length - 1],\n    ) !== -1\n  ) {\n    sommeString += nString[nString.length - 1]\n    somme += Number(nString[nString.length - 1])\n  }\n  return [somme, sommeString]\n}\n\n/**\n * Retourne l'arrondi (par dfaut au millionime prs)\n * @author Rmi Angot\n * @param {number} nombre\n * @param {number} precision\n * @return {number}\n */\nexport function arrondi(nombre: number, precision = 6) {\n  if (isNaN(nombre)) {\n    window.notify(\"Le nombre  arrondir n'en est pas un, a retourne NaN\", {\n      nombre,\n      precision,\n    })\n    return NaN\n  } else {\n    return round(nombre, precision)\n  }\n}\n\n/**\n * Retourne la troncature signe de nombre.\n * @author Jean-Claude Lhote\n */\nexport function troncature(nombre: number, precision: number) {\n  const tmp = Math.pow(10, precision)\n  const absolu = new Decimal(nombre).abs()\n  const tronc = absolu.mul(tmp).floor().div(tmp)\n  if (nombre < 0) return tronc.mul(-1).toNumber()\n  else return tronc.toNumber()\n}\n\n/**\n * Renvoie la valeur absolue\n * @author Rmi Angot + ajout du support des dcimaux par Jean-Claude Lhote\n * @returns {number|Decimal}\n */\nexport function abs<T extends number | Decimal>(a: T): T {\n  if (a instanceof Decimal) return a.abs() as T\n  return Math.abs(a) as T\n}\n\n/**\n * prend une liste de nombres relatifs et la retourne avec les positifs au dbut et les ngatifs  la fin.\n * @param {array} liste la liste de nombres  trier\n */\nexport function triePositifsNegatifs(liste: number[]) {\n  const positifs = []\n  const negatifs = []\n  for (let i = 0; i < liste.length; i++) {\n    if (liste[i] > 0) positifs.push(liste[i])\n    else negatifs.push(liste[i])\n  }\n  return positifs.concat(negatifs)\n}\n\n/**\n * Renvoie le nombre de chiffres de la partie dcimale\n * @param {number} nb : nombre dcimal\n * @param {number} except : chiffre  ne pas compter (0 par exemple) [Ajout EE]\n * @author Rmi Angot\n */\nexport function nombreDeChiffresDansLaPartieDecimale(\n  nb: number | string | Decimal,\n  except?: number,\n) {\n  let sauf = 0\n  if (nb instanceof Decimal || typeof nb === 'number') nb = nb.toString()\n  if (nb.indexOf('.') > 0) {\n    if (except && !isNaN(except))\n      sauf = String(nb).split('.')[1].split(String(except)).length - 1\n    return nb.split('.')[1].length - sauf\n  } else {\n    return 0\n  }\n}\n\n/**\n * Renvoie le nombre de chiffres dans la partie entire\n * @author ?\n */\nexport function nombreDeChiffresDansLaPartieEntiere(\n  nb: number,\n  except?: number,\n) {\n  let nombre\n  let sauf = 0\n  if (nb < 0) {\n    nombre = -nb\n  } else {\n    nombre = nb\n  }\n  if (String(nombre).indexOf('.') > 0) {\n    if (except && !isNaN(except))\n      sauf = String(nombre).split('.')[0].split(String(except)).length - 1\n    return String(nombre).split('.')[0].length - sauf\n  } else {\n    // if (!isNaN(except)) sauf = (String(nombre).split(String(except)).length - 1) @fixme  quoi sert cette affectation inutile ?\n    return String(nombre).length\n  }\n}\n\n/**\n * Renvoie le nombre de chiffres d'un nombre dcimal\n * @param {number} nb : nombre dcimal\n * @param {number} except : chiffre  ne pas compter (0 par exemple) [Ajout EE]\n * @author Jean-Claude Lhote\n */\nexport function nombreDeChiffresDe(nb: number | Decimal, except?: number) {\n  if (nb instanceof Decimal) nb = nb.toNumber()\n  return (\n    nombreDeChiffresDansLaPartieDecimale(nb, except) +\n    nombreDeChiffresDansLaPartieEntiere(nb, except)\n  )\n}\n\n/**\n *\n * x le nombre dont on cherche l'ordre de grandeur\n * type = 0 pour la puissance de 10 infrieure, 1 pour la puissance de 10 suprieur et 2 pour la plus proche\n */\nexport function ordreDeGrandeur(x: number, type: number) {\n  let signe\n  if (x < 0) signe = -1\n  else signe = 1\n  x = Math.abs(x)\n  const P = 10 ** Math.floor(Math.log10(x))\n  if (type === 0) return P * signe\n  else if (type === 1) return P * 10 * signe\n  else if (x - P < 10 * P - x) return P * signe\n  else return P * 10 * signe\n}\n\n/**\n * Retourne une liste des entiers de 0  max sans appartenir  une liste donne\n * @param {number} max\n * @param {number[]} listeAEviter\n *\n * @example\n * // Renvoie [0,1,4,5,6,7,8,9,10]\n * range(10,[2,3])\n *\n * @author Rmi Angot\n */\nexport function range(max: number = 10, listeAEviter: number[] = []) {\n  // Crer un tableau avec toutes les valeurs de 0  max sauf celle de la liste  viter\n  const liste = [...Array(max + 1).keys()]\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(liste, listeAEviter[i])\n  }\n  return liste\n}\n\n/**\n * Retourne une liste entre 2 bornes sans appartenir  une liste donne (par dfaut des entiers, mais on peut changer le pas)\n * @param {number} min\n * @param {number} max\n * @param {number[]} listeAEviter\n * @param {number} step\n * @example\n * // Renvoie [6,7,10]\n * rangeMinMax(6,10,[8,9])\n *\n * @author Rmi Angot\n */\nexport function rangeMinMax(\n  min: number,\n  max: number,\n  listeAEviter: number | number[] = [],\n  step = 1,\n) {\n  // Crer un tableau avec toutes les valeurs de 0  max sauf celle de la liste  viter\n  const liste = []\n  for (let i = min; i <= max; i = i + step) {\n    liste.push(i)\n  }\n  if (typeof listeAEviter === 'number') listeAEviter = [listeAEviter]\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(liste, listeAEviter[i])\n  }\n  return liste\n}\n\n/**\n * Cr un tableau avec toutes les valeurs de 1  max sauf celle de la liste  viter\n *\n *\n * @param {number} max\n * @param {number[]} listeAEviter valeurs  viter\n * @author Rmi Angot\n */\nexport function range1(max: number = 10, listeAEviter: number[] = []) {\n  const liste = []\n  for (let i = 1; i <= max; i++) {\n    liste.push(i)\n  }\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(liste, listeAEviter[i])\n  }\n  return liste\n}\n\n/**\n * Fonction de comparaison  utiliser avec <tableau.sort(compareNombres)>\n *\n *\n * @author Rmi Angot\n */\nexport function compareNombres(a: number, b: number) {\n  return a - b\n}\n\n/**\n *\n * Copi sur https://delicious-insights.com/fr/articles/le-piege-de-array-sort/\n */\nexport function numTrie(arr: number[]) {\n  return arr.sort(function (a, b) {\n    return a - b\n  })\n}\n\n/**\n *\n * @param {number} a\n * -1 si a est ngatif, 1 sinon.\n * @author Jean-Claude Lhote\n */\nexport function unSiPositifMoinsUnSinon(a: number) {\n  if (a < 0) return -1\n  else return 1\n}\n\n/**\n *\n * @param a retourne vrai si tous les lments de a sont de mme signe\n * @returns boolean\n * @author Jean-Claude Lhote\n */\nexport function tousDeMemeSigne(a: number[]) {\n  if (a.length === 0) return true\n  return a.every((val) => {\n    return signe(val) === signe(a[0])\n  })\n}\n","import Decimal from 'decimal.js'\nimport { evaluate, format, round } from 'mathjs'\nimport { context } from '../../modules/context'\nimport type { IFractionEtendue } from '../../modules/FractionEtendue.type'\nimport { extraireRacineCarree } from './calculs'\nimport { miseEnEvidence } from './embellissements'\nimport { nombreDeChiffresDansLaPartieDecimale } from './nombres'\n\n// Garde structurel pour dtecter une FractionEtendue\nconst isFractionEtendue = (x: unknown): x is IFractionEtendue =>\n  typeof x === 'object' &&\n  x !== null &&\n  typeof (x as any).sommeFraction === 'function'\n\nconst math = { format, evaluate }\n\nfunction sp(nb = 1) {\n  let s = ''\n  for (let i = 0; i < nb; i++) {\n    if (context.isHtml) s += '&nbsp;'\n    else s += '\\\\,'\n  }\n  return s\n}\n\n/**\n *\n * @param {number} n\n * retourne le code Latex de la racine carre de n rduite\n * @author Jean-CLaude Lhote\n */\nexport function texRacineCarree(n: number) {\n  const result = extraireRacineCarree(n)\n  if (result[1] === 1) return `${result[0]}`\n  else if (result[0] === 1) return `\\\\sqrt{${result[1]}}`\n  else return `${result[0]}\\\\sqrt{${result[1]}}`\n}\n\n/**\n * renvoie le rsultat de l'expression en couleur (vert=positif, rouge=ngatif, noir=nul)\n * @param {number|Decimal} nombre l'expression  calculer\n * @param {string} positif couleur si positif\n * @param {string} negatif couleur si negatif\n * @param {string} nul couleur si 0\n * @param {number} precision\n */\nexport function texNombreCoul(\n  nombre: number | Decimal,\n  positif = 'green',\n  negatif = 'red',\n  nul = 'black',\n  precision: number,\n) {\n  if (typeof nombre === 'string') {\n    window.notify(\n      \"texNombreCouleur appel avec un string  la place d'un nombre\",\n      { nombre },\n    )\n  }\n  if (nombre instanceof Decimal) {\n    if (nombre.isZero()) return miseEnEvidence(texNombre(0, precision), nul)\n    else if (nombre.isNeg())\n      return miseEnEvidence(texNombre(nombre, precision), negatif)\n    else return miseEnEvidence(texNombre(nombre, precision), positif)\n  } else {\n    if (nombre > 0) return miseEnEvidence(texNombre(nombre, precision), positif)\n    else if (nombre < 0)\n      return miseEnEvidence(texNombre(nombre, precision), negatif)\n    else return miseEnEvidence(texNombre(0, precision), nul)\n  }\n}\n\n/**\n * @author Frdric Piou\n * @param {number} nb\n * @returns retourne un nombre au format franais\n */\nexport function numberFormat(nb: number) {\n  return Intl.NumberFormat('fr-FR', { maximumFractionDigits: 20 })\n    .format(nb)\n    .toString()\n    .replace(/\\s+/g, '\\\\thickspace ')\n}\n\n/**\n * La chane de caractres en sortie doit tre interprte par KateX et doit donc tre place entre des $ $\n * Renvoie \"Trop de chiffres\" s'il y a plus de 15 chiffres significatifs (et donc un risque d'erreur d'approximation)\n * S'utilise indiffremment avec des nombres (nb) au format natif (entier, flottant) ou au format Decimal (ncessite la librairie decimal.js)\n * Avec comme avantage immdiat pour le format Decimal : precision est illimit.\n * Sinon, renvoie un nombre dans le format franais (avec une virgule et des espaces pour sparer les classes dans la partie entire et la partie dcimale)\n * @author Guillaume Valmont\n * @param {number|Decimal|FractionEtendue} nb nombre qu'on veut afficher\n * @param {number} precision nombre de dcimales demand\n * @param {boolean} completerZeros si true, le nombre de dcimale en precision est impos (ajout de zros inutiles ventuels)\n * @param {boolean} aussiCompleterEntiers si true ajoute des zros inutiles aux entiers si complterZeros est true aussi\n * @returns string avec le nombre dans le format franais  mettre entre des $ $\n */\nexport function texNombre(\n  nb: number | Decimal | IFractionEtendue,\n  precision = 8,\n  completerZeros = false,\n  aussiCompleterEntiers = false,\n) {\n  // if (precision == null) window.notifyLocal('Il faut 2 arguments  texNombre ! La prcision attendue est obligatoire !', { nombre: nb, precision })\n  if (typeof nb === 'string') {\n    window.notify(\"texNombre appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n    nb = Number(nb)\n  }\n  const result = afficherNombre(\n    nb,\n    precision,\n    'texNombre',\n    completerZeros,\n    aussiCompleterEntiers,\n  )\n  return (result ?? '').replace(',', '{,}').replace(/\\s+/g, '\\\\,')\n}\n\n/**\n * Renvoie un nombre dans le format franais (sparateur de classes) pour la partie entire comme pour la partie dcimale\n * @author Rmi Angot\n */\nexport function texNombre2(nb: number) {\n  if (typeof nb === 'string') {\n    window.notify(\"texNombre2 appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n  }\n  let nombre = math\n    .format(nb, {\n      notation: 'auto',\n      lowerExp: -12,\n      upperExp: 12,\n      precision: 12,\n    })\n    .replace('.', ',')\n  const rangVirgule = nombre.indexOf(',')\n  let partieEntiere\n  if (rangVirgule !== -1) {\n    partieEntiere = nombre.substring(0, rangVirgule)\n  } else {\n    partieEntiere = nombre\n  }\n  let partieDecimale = ''\n  if (rangVirgule !== -1) {\n    partieDecimale = nombre.substring(rangVirgule + 1)\n  }\n\n  for (let i = partieEntiere.length - 3; i > 0; i -= 3) {\n    partieEntiere =\n      partieEntiere.substring(0, i) + '\\\\,' + partieEntiere.substring(i)\n  }\n  for (let i = 3; i < partieDecimale.length; i += 5) {\n    partieDecimale =\n      partieDecimale.substring(0, i) + '\\\\,' + partieDecimale.substring(i)\n    i += 12\n  }\n  if (partieDecimale === '') {\n    nombre = partieEntiere\n  } else {\n    nombre = partieEntiere + '{,}' + partieDecimale\n  }\n  return nombre\n}\n\n/**\n * Renvoie un nombre dans le format franais (sparateur de classes) pour la partie entire comme pour la partie dcimale\n * Avec espace gr par nbsp en HTML pour pouvoir l'inclure dans une phrase formate en franais et pas seulement un calcul.\n * Modif EE pour la gestion de l'espace dans un texte non mathmatique\n * @author Eric Elter d'aprs la fonction de Rmi Angot\n * Rajout Octobre 2021 pour 6C14\n */\nexport function texNombre3(nb: number) {\n  if (typeof nb === 'string') {\n    window.notify(\"texNombre3 appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n  }\n  let nombre = math\n    .format(nb, {\n      notation: 'auto',\n      lowerExp: -12,\n      upperExp: 12,\n      precision: 12,\n    })\n    .replace('.', ',')\n  const rangVirgule = nombre.indexOf(',')\n  let partieEntiere\n  if (rangVirgule !== -1) {\n    partieEntiere = nombre.substring(0, rangVirgule)\n  } else {\n    partieEntiere = nombre\n  }\n  let partieDecimale = ''\n  if (rangVirgule !== -1) {\n    partieDecimale = nombre.substring(rangVirgule + 1)\n  }\n\n  for (let i = partieEntiere.length - 3; i > 0; i -= 3) {\n    partieEntiere =\n      partieEntiere.substring(0, i) + sp() + partieEntiere.substring(i)\n  }\n  for (let i = 3; i <= partieDecimale.length; i += 3) {\n    partieDecimale =\n      partieDecimale.substring(0, i) + sp() + partieDecimale.substring(i)\n    i += 12\n  }\n  if (partieDecimale === '') {\n    nombre = partieEntiere\n  } else {\n    nombre = partieEntiere + ',' + partieDecimale\n  }\n  return nombre\n}\n\n/**\n * Renvoie un nombre dans le format franais (sparateur de classes)\n * Fonctionne sans le mode maths contrairement  texNombre()\n * insereEspaceDansNombre fonctionne peut-tre mieux\n * @author Rmi Angot\n */\nexport function nombreAvecEspace(nb: number) {\n  if (isNaN(nb)) {\n    window.notify('nombreAvecEspace : argument NaN ou undefined', { nb })\n    return 'NaN'\n  }\n  // Ecrit \\nombre{nb} pour tous les nombres suprieurs  1 000 (pour la gestion des espaces)\n  if (context.isHtml) {\n    return Intl.NumberFormat('fr-FR', { maximumFractionDigits: 20 })\n      .format(nb)\n      .toString()\n      .replace(/\\s+/g, ' ')\n  } else {\n    let result\n    if (nb > 999 || nombreDeChiffresDansLaPartieDecimale(nb) > 3) {\n      result = '\\\\numprint{' + nb.toString().replace('.', ',') + '}'\n    } else {\n      result = Number(nb).toString().replace('.', '{,}')\n    }\n    return result\n  }\n}\n\n/**\n *\n * @param {number} mantisse\n * @param {number} exp\n * @returns {string} criture dcimale avec espaces\n */\nexport function scientifiqueToDecimal(mantisse: number, exp: number) {\n  if (exp < -6) Decimal.set({ toExpNeg: exp - 1 })\n  else if (exp > 20) Decimal.set({ toExpPos: exp + 1 })\n  return texNombre(new Decimal(mantisse).mul(Decimal.pow(10, exp)), 10)\n}\n\n/**\n * Destine  tre utilise hors des $ $\n * Signale une erreur en console s'il y a plus de 15 chiffres significatifs (et donc qu'il y a un risque d'erreur d'approximation)\n * Sinon, renvoie le nombre  afficher dans le format franais (avec virgule et des espaces pour sparer les classes dans la partie entire et la partie dcimale)\n * @author Jean-Claude Lhote\n * @author Guillaume Valmont\n * @param {number|Decimal} nb nombre qu'on veut afficher\n * @param {number} precision nombre de dcimales demand\n * @param {boolean?} completerZeros=false si true, le nombre de dcimale en precision est impos (ajout de zros inutiles ventuels)\n * @param {boolean?} aussiCompleterEntiers=false si true ajoute des zros inutiles aux entiers si complterZeros est true aussi\n * @returns string avec le nombre dans le format franais  placer hors des $ $\n */\nexport function stringNombre(\n  nb: number | Decimal,\n  precision?: number,\n  completerZeros?: boolean,\n  aussiCompleterEntiers?: boolean,\n) {\n  if (completerZeros === undefined) completerZeros = false\n  if (aussiCompleterEntiers === undefined) aussiCompleterEntiers = false\n  if (precision === undefined) precision = 8\n  if (typeof nb === 'string') {\n    window.notify(\"stringNombre appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n  }\n  return afficherNombre(\n    nb,\n    precision,\n    'stringNombre',\n    completerZeros,\n    aussiCompleterEntiers,\n  )\n}\n\n/**\n * Fonction auxiliaire aux fonctions stringNombre et texNombre\n * Vrifie le nombre de chiffres significatifs en fonction du nombre de chiffres de la partie entire de nb et du nombre de dcimales demandes par le paramtre precision\n * S'il y a plus de 15 chiffres significatifs, envoie un message  bugsnag et renvoie un nombre avec 15 chiffres significatifs\n * Sinon, renvoie un nombre avec le nombre de dcimales demand\n * @author Guillaume Valmont\n * @param {number|string|FractionEtendue|Decimal} nb nombre qu'on veut afficher\n * @param {number} precision nombre de dcimales demand\n * @param {'stringNombre'|'texNombre'} fonction nom de la fonction qui appelle afficherNombre (texNombre ou stringNombre) -> sert pour le message envoy  bugsnag\n * @param {boolean} completerZeros si true, le nombre de dcimale en precision est impos (ajout de zros inutiles ventuels)\n * @param {boolean} aussiCompleterEntiers true si on veut ajouter des zros inutiles aux entiers\n */\nfunction afficherNombre(\n  nb: number | Decimal | IFractionEtendue | string,\n  precision: number,\n  fonction: 'texNombre' | 'stringNombre',\n  completerZeros = false,\n  aussiCompleterEntiers: boolean,\n) {\n  /**\n   * Fonction auxiliaire de stringNombre pour une meilleure lisibilit\n   * Elle renvoie un nombre dans le format franais (avec virgule et des espaces pour sparer les classes dans la partie entire et la partie dcimale)\n   * @author Rmi Angot\n   * @author Guillaume Valmont\n   * @param {number|string|FractionEtendue|Decimal} nb nombre  afficher\n   * @param {number} nbChiffresPartieEntiere nombre de chiffres de la partie entire\n   * @param {number} precision nombre de dcimales demand\n   * @param {'stringNombre'|'texNombre'} fonction la fonction appelante\n   * @returns string avec le nombre dans le format franais\n   */\n\n  function insereEspacesNombre(\n    nb: number | Decimal,\n    nbChiffresPartieEntiere: number,\n    precision: number,\n    fonction: 'stringNombre' | 'texNombre',\n  ) {\n    let signe\n    let nombre\n    const maximumSignificantDigits = nbChiffresPartieEntiere + precision\n    if (nb instanceof Decimal) {\n      Decimal.set({ toExpNeg: -precision - 1 })\n      signe = nb.isNeg()\n      if (nb.abs().gte(1)) {\n        if (completerZeros) {\n          nombre = nb.toFixed(precision).replace('.', ',')\n        } else {\n          nombre = nb.toDP(precision).toString().replace('.', ',')\n        }\n      } else {\n        if (completerZeros) {\n          nombre = nb.toFixed(precision).replace('.', ',')\n        } else {\n          nombre = nb.toDP(precision).toString().replace('.', ',')\n        }\n      }\n    } else {\n      // nb est un number\n      signe = nb < 0\n      // let nombre = math.format(nb, { notation: 'fixed', lowerExp: -precision, upperExp: precision, precision: precision }).replace('.', ',')\n      if (Math.abs(nb) < 1) {\n        // si il est < 1, on n'a pas  se proccuper de savoir si il est entier pour aussiCompleterEntiers\n        if (completerZeros) {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumFractionDigits: precision,\n            minimumFractionDigits: precision,\n          }).format(nb)\n        } else {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumFractionDigits: precision,\n          })\n            .format(nb)\n            .replaceAll(/\\s+/g, ' ')\n        }\n      } else {\n        if (\n          completerZeros &&\n          ((aussiCompleterEntiers && Number.isInteger(nb)) ||\n            !Number.isInteger(nb))\n        ) {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumSignificantDigits,\n            minimumSignificantDigits: Math.min(maximumSignificantDigits, 15),\n          })\n            .format(nb)\n            .replaceAll(/\\s+/g, ' ')\n        } else {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumSignificantDigits: Math.min(maximumSignificantDigits, 15),\n          })\n            .format(nb)\n            .replaceAll(/\\s+/g, ' ')\n        }\n      }\n    }\n    const rangVirgule = nombre.indexOf(',')\n    let partieEntiere\n    if (rangVirgule !== -1) {\n      partieEntiere = nombre.substring(0, rangVirgule)\n    } else {\n      partieEntiere = nombre\n    }\n    let partieDecimale = ''\n    if (rangVirgule !== -1) {\n      partieDecimale = nombre.substring(rangVirgule + 1)\n    }\n    // La partie entire est dj formate par le Intl.NumberFormat('fr-FR', { maximumSignificantDigits }).format(nb)\n    // Dans le cas d'un Number, mais pas d'un Decimal\n    if (nb instanceof Decimal) {\n      if (signe) partieEntiere = partieEntiere.substring(1)\n      for (let i = partieEntiere.length - 3; i > 0; i -= 3) {\n        partieEntiere =\n          partieEntiere.substring(0, i) + ' ' + partieEntiere.substring(i)\n      }\n      if (signe) partieEntiere = '-' + partieEntiere\n    }\n    for (\n      let i = 3;\n      i < partieDecimale.length;\n      i += fonction === 'texNombre' ? 5 : 4\n    ) {\n      // des paquets de 3 nombres + 1 espace\n      partieDecimale =\n        partieDecimale.substring(0, i) +\n        (fonction === 'texNombre' ? '\\\\,' : ' ') +\n        partieDecimale.substring(i)\n    }\n    if (partieDecimale === '') {\n      nombre = partieEntiere\n    } else {\n      nombre = partieEntiere + ',' + partieDecimale\n    }\n    return nombre\n  } // fin insereEspacesNombre()\n  /**\n   * retourne la prcision souhaite pour le number x, c'est  dire le nombre de chiffres significatifs aprs la virgule\n   * @param {number} x\n   * @return {number}\n   */\n  const trouveLaPrecision = function (x: number) {\n    if (Math.abs(x) > 1e-10 && Math.abs(x) < 1e11) {\n      let fix = x.toFixed(18)\n      if (fix.includes('.')) {\n        fix = fix.split('.')[1]\n      }\n      const xx = Number('.' + fix)\n      let precision = 1\n      for (let i = 1; i < fix.length; i++) {\n        const x = round(Number('.' + fix.substring(0, i + 1)), i)\n        const diff = Math.abs(x - xx)\n        if (diff > 1e-10) {\n          precision++\n        } else {\n          return precision\n        }\n      }\n      return precision\n    } else {\n      // On a  faire  un number trop petit ou trop grand pour que l'algorithme classique fonctionne.\n      // x.toFixed(18) ne contiendrait pas assez de chiffres significatifs\n      // afficherNombre n'est pas prvu pour des nombres pareils sauf ventuellement au format Decimal\n      window.notify(\n        `trouveLaPrecision de ${x} n'est pas possible : il ne peut pas tre transform en criture dcimale. Il faut adapter le code de l'exercice ou verifier que ce nombre n'est pas un bug`,\n        { x },\n      )\n      return 10\n    }\n  }\n  // fin trouveLaPrecision()\n  // eh oui, il y a eu des appels  texNombre() avec des FractionEtendue... alors que c'est pas fait pour a.\n  if (!(nb instanceof Decimal) && typeof nb !== 'number') {\n    if (isFractionEtendue(nb)) {\n      nb = nb.toNumber()\n    } else if (typeof nb === 'string') {\n      const nbFormatAnglais = nb.replaceAll(',', '.') ?? ''\n      if (nb !== '') {\n        nb = new Decimal(nbFormatAnglais)\n      } else {\n        window.notify(`TrouveLaPrecision : problme avec ce nombre : ${nb}`, {\n          nb,\n        })\n      }\n    } else if (typeof nb !== 'number') {\n      window.notify(\n        `afficherNombre a reu un argument de type inconnu come nombre : ${nb}`,\n        { nombreEntrant: nb },\n      )\n      nb = Number(nb)\n      if (isNaN(nb)) {\n        window.notify(\n          \"Et ce paramtre n'est pas convertible en nombre ! il faut donc vrifier l'exercice qui comporte un bug !\",\n          { nb },\n        )\n        nb = 0\n      }\n    }\n  }\n\n  if (precision === undefined) {\n    // la prcision n'a pas t fournie  texNombre ou  stringNombre, alors on va essayer de la deviner.\n    if (nb instanceof Decimal) {\n      precision = nb.e < 0 ? nb.precision() + -nb.e : nb.precision(true)\n    } else {\n      if (Number.isInteger(nb)) {\n        precision = 0\n      } else {\n        const ordreGrandeur = Math.round(Math.log10(Number(nb)))\n        if (ordreGrandeur < -10) {\n          // a veut dire que le nombre est trop insignifiant pour donner un rsultat affich convenable\n          precision = 0 // on retourne 0 pour avoir un arrondi  zro !\n        } else {\n          precision = trouveLaPrecision(Number(nb))\n        }\n      }\n    }\n  }\n  // si nb n'est pas un nombre, on le retourne tel quel, on ne fait rien.\n  if (Number.isNaN(nb) && !(nb instanceof Decimal)) {\n    window.notify(\"AfficherNombre : Le nombre n'en est pas un\", {\n      nb,\n      precision,\n      fonction,\n    })\n    return ''\n  }\n  if (nb instanceof Decimal) {\n    if (nb.isZero()) return '0'\n  } else if (Number(nb) === 0) return '0'\n  let nbChiffresPartieEntiere\n  if (nb instanceof Decimal) {\n    if (nb.abs().lt(1)) {\n      nbChiffresPartieEntiere = 0\n    } else {\n      nbChiffresPartieEntiere = nb.abs().floor().toFixed(0).length\n    }\n    if (nb.isInteger() && !aussiCompleterEntiers) precision = 0\n    else if (typeof precision !== 'number') {\n      // Si precision n'est pas un nombre, on le remplace par la valeur max acceptable\n      precision = 15 - nbChiffresPartieEntiere\n    } else if (precision < 0) {\n      precision = 0\n    }\n  } else {\n    // nb est un number\n    if (Math.abs(Number(nb)) < 1) {\n      nbChiffresPartieEntiere = 0\n    } else {\n      // attention 9.7 donner 10 avec Math.abs(9.7).toFixed(0)\n      nbChiffresPartieEntiere = Math.floor(Math.abs(Number(nb))).toFixed(\n        0,\n      ).length\n    }\n    if (Number.isInteger(nb) && !completerZeros) {\n      precision = 0\n    } else {\n      if (typeof precision !== 'number') {\n        // Si precision n'est pas un nombre, on le remplace par la valeur max acceptable\n        precision = 15 - nbChiffresPartieEntiere\n      } else if (precision < 0) {\n        precision = 0\n      }\n    }\n  }\n\n  const maximumSignificantDigits = nbChiffresPartieEntiere + precision\n\n  if (maximumSignificantDigits > 15 && !(nb instanceof Decimal)) {\n    // au del de 15 chiffres significatifs, on risque des erreurs d'arrondi\n    window.notify(\n      fonction +\n        ` : Trop de chiffres le nombre pass  la fonction a trop de chiffres significatifs, soit c'est un bug  corriger, soit il faut utiliser un Decimal !`,\n      { nb, precision },\n    )\n    return insereEspacesNombre(\n      Number(nb),\n      nbChiffresPartieEntiere,\n      precision,\n      fonction,\n    )\n  } else {\n    return insereEspacesNombre(\n      Number(nb),\n      nbChiffresPartieEntiere,\n      precision,\n      fonction,\n    )\n  }\n}\n\n/**\n * Pour bien afficher les centimes avec 2 chiffres aprs la virgule\n * @author Rmi Angot\n */\nexport function texPrix(nb: number | Decimal) {\n  if (nb instanceof Decimal) {\n    if (nb.isInteger()) return texNombre(nb, 0)\n    else return texNombre(nb, 2, true)\n  }\n  const nombre = Number(nb)\n  if (nombre.toString() === nombre.toFixed(0)) {\n    return texNombre(nb, 0)\n  } else {\n    return texNombre(nb, 2, true)\n  }\n}\n\n/**\n * Fonction qui renvoie un tableau contenant la mantisse et l'exposant de l'criture scientique d'un nombre donn en paramtres sous sa forme dcimale.\n * @param nbDecimal\n *\n * @example\n * // Renvoie [4.1276,1]\n * range(decimalToScientifique,[41.276])\n * // Renvoie [3.48,-2]\n * range(decimalToScientifique,[0.0348])\n * // Renvoie [-2.315,3]\n * range(decimalToScientifique,[-2315])\n *\n * @author Eric Elter\n */\nexport function decimalToScientifique(nbDecimal: number) {\n  let exposant = 0\n  let mantisseNb = new Decimal(nbDecimal)\n  if (mantisseNb.abs().gte(10)) {\n    while (exposant < 50 && mantisseNb.abs().gt(10)) {\n      mantisseNb = mantisseNb.div(10)\n      exposant++\n    }\n    return [mantisseNb.toNumber(), exposant]\n  } else if (mantisseNb.abs().lt(1)) {\n    while (exposant < 50 && mantisseNb.abs().lt(1)) {\n      mantisseNb = mantisseNb.mul(10)\n      exposant++\n    }\n    return [mantisseNb.toNumber(), -1 * exposant]\n  } else return [nbDecimal, 0]\n}\n\n/**\n * Fonction qui renvoie une chaine avec un O pour chiffre des dizaines si celui-ci n'en contient pas.\n * @param nbDecimal\n *\n * @example\n\n * @author Rmi Angot\n */\nexport function formatMinute(minute: number): string {\n  return minute < 10 ? `0${minute}` : minute.toString()\n}\n","import Decimal from 'decimal.js'\nimport { abs, gcd, lcm, multiply, round } from 'mathjs'\nimport { extraireRacineCarree } from '../lib/outils/calculs'\nimport { miseEnEvidence } from '../lib/outils/embellissements'\nimport {\n  decompositionFacteursPremiers,\n  obtenirListeFacteursPremiers,\n  ppcm,\n} from '../lib/outils/primalite'\nimport { texNombre } from '../lib/outils/texNombre'\n\n// Versions locales (scope module) pour viter la dpendance circulaire avec ecritures.ts\nfunction ecritureAlgebrique(n: number): string {\n  return n >= 0 ? '+' + texNombre(n, 7) : texNombre(n, 7)\n}\n\nfunction ecritureParentheseSiNegatif(n: number): string {\n  return n >= 0 ? texNombre(n, 8) : `(${texNombre(n, 8)})`\n}\n\nfunction signeMoinsEnEvidence(r: number, precision = 0): string {\n  if (typeof r !== 'number') {\n    window.notify(\n      \"signeMoinsEnEvidence() appel avec autre chose qu'un nombre.\",\n      { argument: r },\n    )\n  }\n  if (r < 0) {\n    return miseEnEvidence('-') + texNombre(Math.abs(r), precision)\n  }\n  return texNombre(Math.abs(r), precision)\n}\n\nconst arrondi = (x: number, p: number) => {\n  return Number(x.toFixed(p))\n}\n\n// Fonction crite par Daniel Caillibaud pour crer ajouter les proprits  la premire utilisation de celles-ci.\nconst definePropRo = (\n  obj: FractionEtendue,\n  prop: string,\n  get: (args?: unknown) => unknown,\n) => {\n  Object.defineProperty(obj, prop, {\n    enumerable: true,\n    get,\n    set: () => {\n      throw Error(`${prop} est en lecture seule`)\n    },\n  })\n}\n\n/**\n * Une fonction pour transformer en FractionEtendue\n * @param x\n * @return {FractionEtendue}\n */\nexport function rationnalise(x: number | FractionEtendue | Decimal | null) {\n  if (x == null) {\n    window.notify(\n      'rationnalise est appel avec une valeur undefined ou nulle',\n      { x },\n    )\n    return new FractionEtendue(0, 1)\n  }\n  if (x instanceof FractionEtendue) return x\n  if (x instanceof Decimal) {\n    const numDen = x.toFraction(10000) // On limite le dnominateur  10000\n    return new FractionEtendue(numDen[0].toNumber(), numDen[1].toNumber())\n  }\n  if (typeof x === 'number') {\n    // MGU  : C'est dangereux ce truc mais bon...\n    // Dj a gre au del des centimes...\n    if (Number.isInteger(x)) {\n      return new FractionEtendue(x, 1)\n    }\n    const numDen = new Decimal(x.toFixed(5)).toFraction(10000)\n    return new FractionEtendue(numDen[0].toNumber(), numDen[1].toNumber())\n  }\n  // c'est pas un number, c'est pas une FractionEtendue... a doit tre une Fraction de mathjs\n  window.notify(\n    'rationnalise est appel avec un nombre dont le format est inconnu :',\n    { x },\n  )\n  return x\n}\n\n/**\n * transforme si besoin les numrateurs et dnominateurs en number\n * @param n\n * @param d\n */\nfunction normalizeFraction(n: number | Decimal, d: number): [number, number] {\n  let num: number\n  let den: number\n\n  if (d == null) {\n    // Un seul argument : convertir en fraction\n    const decimal = n instanceof Decimal ? n : new Decimal(n)\n    const [numDec, denDec] = decimal.toFraction(10000) // Limite le dnominateur\n    num = numDec.toNumber()\n    den = denDec.toNumber()\n  } else {\n    // Deux arguments : calculer le quotient puis convertir en fraction\n    if (Number.isInteger(n) && Number.isInteger(d)) {\n      num = Number(n)\n      den = Number(d)\n    } else {\n      // attention aux flottants en javascript...\n      // La fraction retourne sera irreductible\n      // il vaut mieux utiliser n et d entiers !\n      const nDecimal = n instanceof Decimal ? n : new Decimal(n)\n      const dDecimal = new Decimal(d)\n      const nNbChiffresDecimaux = nDecimal.decimalPlaces()\n      const dNbChiffresDecimaux = dDecimal.decimalPlaces()\n      const pow = Math.min(\n        5,\n        Math.max(nNbChiffresDecimaux, dNbChiffresDecimaux),\n      )\n      if (pow > 0) {\n        const facteur = Math.pow(10, pow)\n        n = nDecimal.mul(facteur).round().toNumber()\n        d = dDecimal.mul(facteur).round().toNumber()\n      }\n      num = Number(n)\n      den = Number(d)\n    }\n  }\n\n  if (isNaN(num) || isNaN(den)) {\n    window.notify(\n      'FractionEtendue : valeurs impossibles  convertir en fraction',\n      { n, d },\n    )\n    return [NaN, NaN]\n  }\n\n  return [num, den]\n}\n\n/**\n * La classe FractionEtendue est une extension de la classe  FractionMathjs  de mathjs\n * @author Jean-Claude Lhote\n * Merci  Daniel Caillibaud pour son aide.\n * Pour crer une instance de la classe FractionEtendue on peut utiliser la fonction fraction() qui se trouve dans le fichier modules/fractions\n * Ou utiliser la syntaxe f = new FractionEtendue () qui cre une  FractionMathjs  nulle.\n * On peut utiliser tous les arguments utilisables par  FractionMathjs  :\n * @example\n * // cre la  FractionMathjs  $\\frac{1}{3}$\n * f = new FractionEtendue ('0.(3)')\n * @example\n * // cre la  FractionMathjs  $\\frac{12}{15}$ (Remarque : new FractionEtendue(12,15) cre $\\frac{4}{5}$)\n * f = fraction(12,15)\n * @example\n * // cre la  FractionMathjs  $\\frac{2}{5}$\n * f = fraction(0.4)\n */\nclass FractionEtendue {\n  num: number\n  den: number\n  /**\n   * Numrateur rduit // Le numrateur rduit peut tre ngatif\n   */\n  numIrred: number\n  /**\n   * Dnominateur rduit // le dnominateur rduit est toujours positif.\n   */\n  denIrred: number\n  n: number\n  d: number\n  s: -1 | 1 | 0\n  type: 'FractionEtendue'\n  signe!: -1 | 1 | 0\n  sign!: -1 | 1 | 0\n  signeString!: '+' | '-' | ''\n  /**\n   * Valeur de la  FractionMathjs   100 arrondi au centime\n   */\n  pourcentage!: number\n  /**\n   * num/den mais sans traitement des signes des numrateur et dnominateur\n   */\n  texFraction!: string\n  /**\n   * le code LaTeX de la  FractionMathjs  simplifie\n   */\n  texFractionSimplifiee!: string\n  /**\n   * num/den mais avec simplification des signes (numrateur et dnominateur positifs, signe - eventuellement devant.)\n   * littralement texFractionSigneDevant (si c'est un moins sinon rien... pour avoir le + devant, utiliser texFractionSignee)\n   */\n  texFSD!: string\n  /**\n   * retourne la  Fraction avec signe devant  mis entre parenthses notamment pour l'exponentiation.\n   */\n  texParentheses!: string\n  /**\n   * num/den avec mise en vidence des signes - s'il y en a au numrateur et au dnominateur\n   */\n  texFractionSR!: string\n  /**\n   * + n/d si positif, - n/d si ngatif\n   * proprit qui n'est pas trs utile puisque ecritureAlgebrique gre les fractions maintenant (dfini pour compatibilit avec les exos qui l'utilisent)\n   */\n  texFractionSignee!: string\n  /**\n   * -1 => '-'\n   * 1 => ''\n   * inchang sinon\n   * permet d'crire le coefficient devant une lettre ou une parenthse\n   */\n  texFractionSaufUn!: string\n  /**\n   * Valeur dcimale de la  FractionMathjs  (arrondie  la sixime dcimale)\n   */\n  valeurDecimale!: number\n  /**\n   * -1 => '-'\n   * 1 => '+'\n   * texFractionSignee sinon\n   * permet d'crire le coefficient devant une lettre ou une parenthse\n   */\n  texFractionSaufUnSignee!: string\n  /**\n   * num/den si positif, (- num/den) sinon\n   * @property texFSP littralement texFractionSigneParentheses\n   * @type {string}\n   */\n  texFSP!: string\n  /**\n   * le code LaTeX de l'criture algbrique de la fraction\n   * Pour compatibilit avec les anciens exos... la fonction de outils ecritureAlgebrique() est compatible avec les fractions\n   */\n  ecritureAlgebrique!: string\n  /**\n   * le code LaTeX de l'criture avec parenthse si ngatif\n   */\n  ecritureParentheseSiNegatif!: string\n  /**\n   * true si la  FractionMathjs  est un entier false sinon\n   */\n  estEntiere!: boolean\n  /**\n   * true si la FractionEtendue est le carr d'une FractionEtendue\n   */\n  estParfaite!: boolean\n  /**\n   * @return true si la FractionEtendue est irrductible\n   */\n  estIrreductible!: boolean\n  /**\n   * le code LaTeX de l'criture avec parenthse si ngatif\n   */\n\n  constructor(n: number | Decimal, d: number) {\n    const [num, den] = normalizeFraction(n, d)\n    if (isNaN(num) || isNaN(den))\n      throw Error(\n        `Fraction Etendue les donnes ne permettent pas de dfinir une fraction : n=${n}, d=${d}`,\n      )\n    const pgcd =\n      Math.abs(num) === 1 && Math.abs(den) === 1\n        ? 1\n        : gcd(Math.abs(num), Math.abs(den))\n    const prodNumDen = num * den\n    this.s = prodNumDen === 0 ? 0 : prodNumDen < 0 ? -1 : 1\n    const numIrred = this.s * Math.abs(num / pgcd)\n    const denIrred = Math.abs(den / pgcd)\n    this.num = num\n    this.den = den\n    this.n = Math.abs(num / pgcd)\n    this.d = Math.abs(den / pgcd)\n    /**\n     * le signe de la  FractionMathjs  : -1 pour ngatif , 0 ou 1 pour positif\n     * Au cas o quelqu'un oublie le e de this.signe\n     * @type {number}\n     */\n    /**\n     * le signe de la fraction : -1 pour ngatif , 0 ou 1 pour positif\n     * @type {number}\n     */\n    let sign: 0 | 1 | -1 // Au cas o quelqu'un le demande en anglais\n    definePropRo(this, 'sign', () => {\n      if (!sign) sign = this.s\n      return sign\n    })\n    let signe: 0 | 1 | -1\n    definePropRo(this, 'signe', () => {\n      if (!signe) signe = this.s\n      return signe\n    })\n    this.type = 'FractionEtendue'\n    this.numIrred = numIrred\n    this.denIrred = denIrred\n\n    // this.pourcentage = arrondi(num * 100 / den, 2)\n    // pour ne pas faire ces calculs  chaque instanciation de Fraction, on passe par defineProperty\n    // (qui permet de ne faire le calcul qu' la premire lecture de la proprit)\n    /**\n     * Valeur de la fraction  100\n     * @property pourcentage\n     * @type {number}\n     */\n    let pourcentage: number\n    definePropRo(this, 'pourcentage', () => {\n      if (!pourcentage)\n        pourcentage = arrondi((this.s * this.n * 100) / this.d, 2)\n      return pourcentage\n    })\n    // Le signe en string\n    let signeString: string\n    definePropRo(this, 'signeString', () => {\n      if (!signeString) signeString = this.s === -1 ? '-' : '+'\n      return signeString\n    })\n\n    /**\n     * num/den\n     * @property texFraction\n     * @type {string}\n     */\n    let texFraction: string // num/den mais sans traitement des signes des numrateur et dnominateur\n    definePropRo(this, 'texFraction', () => {\n      if (!texFraction)\n        texFraction =\n          this.s === 0\n            ? '0'\n            : den === 1\n              ? `${texNombre(num, 0)}`\n              : `\\\\dfrac{${texNombre(num, 0)}}{${texNombre(den, 0)}}`\n      return texFraction\n    })\n\n    /**\n     * num/den\n     * @property texFractionSR\n     * @type {string}\n     */\n    let texFractionSR: string // num/den mais sans traitement des signes des numrateur et dnominateur\n    definePropRo(this, 'texFractionSR', () => {\n      if (!texFractionSR)\n        texFractionSR = `\\\\dfrac{${signeMoinsEnEvidence(this.num)}}{${signeMoinsEnEvidence(this.den)}}`\n      return texFractionSR\n    })\n\n    /**\n     * num/den mais avec simplification des signes (numrateur et dnominateur positifs, signe - eventuellement devant.)\n     * @property texFSD littralement texFractionSigneDevant (si c'est un moins sinon rien... pour avoir le + devant, utiliser ecritureAlgebrique)\n     * @type {string}\n     */\n    let texFSD: string\n    definePropRo(this, 'texFSD', () => {\n      if (!texFSD) {\n        texFSD =\n          this.s === 0\n            ? '0'\n            : this.s === -1\n              ? Math.abs(den) === 1\n                ? '-' + texNombre(Math.abs(num), 0)\n                : `-\\\\dfrac{${texNombre(Math.abs(num), 0)}}{${texNombre(Math.abs(den), 0)}}`\n              : Math.abs(den) === 1\n                ? texNombre(Math.abs(num), 0)\n                : `\\\\dfrac{${texNombre(Math.abs(num), 0)}}{${texNombre(Math.abs(den), 0)}}`\n      }\n      return texFSD\n    })\n\n    /**\n     * + n/d si positif, - n/d si ngatif\n     * proprit qui n'est pas trs utile puisque ecritureAlgebrique gre les fractions maintenant (dfini pour compatibilit avec les exos qui l'utilisent)\n     * @property texFractionSignee\n     * @type {string}\n     */\n    let texFractionSignee: string\n    definePropRo(this, 'texFractionSignee', () => {\n      if (!texFractionSignee)\n        texFractionSignee = this.s === -1 ? this.texFSD : '+' + this.texFSD\n      return texFractionSignee\n    })\n\n    /**\n     * Valeur dcimale de la fraction (arrondie  la sixime dcimale)\n     * @property valeurDecimale\n     * @type {number}\n     */\n    let valeurDecimale: number\n    definePropRo(this, 'valeurDecimale', () => {\n      if (!valeurDecimale)\n        valeurDecimale = Number((this.num / this.den).toFixed(6))\n      return valeurDecimale\n    })\n\n    /**\n     * -1 => '-'\n     * 1 => ''\n     * inchang sinon\n     * permet d'crire le coefficient devant une lettre ou une parenthse\n     * @property texFractionSaufUn\n     * @type {string}\n     */\n    let texFractionSaufUn: string\n    definePropRo(this, 'texFractionSaufUn', () => {\n      if (!texFractionSaufUn)\n        texFractionSaufUn =\n          this.valeurDecimale === -1\n            ? '-'\n            : this.valeurDecimale === 1\n              ? ''\n              : this.texFSD\n      return texFractionSaufUn\n    })\n\n    /**\n     * -1 => '-'\n     * 1 => '+'\n     * texFractionSignee sinon\n     * permet d'crire le coefficient devant une lettre ou une parenthse\n     * @property texFractionSaufUnSignee\n     * @type {string}\n     */\n    let texFractionSaufUnSignee: string\n    definePropRo(this, 'texFractionSaufUnSignee', () => {\n      if (!texFractionSaufUnSignee)\n        texFractionSaufUnSignee =\n          this.valeurDecimale === -1\n            ? '-'\n            : this.valeurDecimale === 1\n              ? '+'\n              : this.texFractionSignee\n      return texFractionSaufUnSignee\n    })\n\n    /**\n     * num/den si positif, (- num/den) sinon\n     * @property texFSP littralement texFractionSigneParentheses\n     * @type {string}\n     */\n    let texFSP: string\n    definePropRo(this, 'texFSP', () => {\n      if (!texFSP)\n        texFSP =\n          this.s === 0\n            ? '0'\n            : this.s > 0\n              ? this.texFSD\n              : '\\\\left(' + this.texFSD + '\\\\right)'\n      return texFSP\n    })\n\n    /**\n     * retourne la fraction mis entre parenthses notamment pour l'exponentiation.\n     */\n    let texParentheses: string\n    definePropRo(this, 'texParentheses', () => {\n      if (!texParentheses)\n        texParentheses =\n          this.s === 0\n            ? '0'\n            : den === 1 && this.s === 1\n              ? this.texFSD\n              : '\\\\left(' + this.texFSD + '\\\\right)'\n      return texParentheses\n    })\n\n    /**\n     * le code LaTeX de la fraction simplifie\n     * @property texFractionSimplifiee\n     * @type {string}\n     */\n    let texFractionSimplifiee: string\n    definePropRo(this, 'texFractionSimplifiee', () => {\n      if (!texFractionSimplifiee) {\n        texFractionSimplifiee =\n          this.s === 0\n            ? '0'\n            : this.denIrred === 1\n              ? `${this.s === -1 ? '-' : ''}${texNombre(Math.abs(numIrred), 0)}`\n              : `${this.s === -1 ? '-' : ''}\\\\dfrac{${texNombre(Math.abs(numIrred), 0)}}{${texNombre(Math.abs(denIrred), 0)}}`\n      }\n      return texFractionSimplifiee\n    })\n\n    /**\n     * le code LaTeX de l'criture algbrique de la fraction\n     * Pour compatibilit avec les anciens exos... la fonction de outils ecritureAlgebrique() est compatible avec les fractions\n     * @property ecritureAlgebrique\n     * @type {string}\n     */\n    let ecritureAlgebrique: string\n    definePropRo(this, 'ecritureAlgebrique', () => {\n      if (!ecritureAlgebrique)\n        ecritureAlgebrique =\n          this.s === 0 ? '' : this.s === 1 ? '+' + this.texFSD : this.texFSD\n      return ecritureAlgebrique\n    })\n\n    /**\n     * le code LaTeX de l'criture avec parenthse si ngatif\n     * @property ecritureParentheseSiNegatif\n     * @type {string}\n     */\n    let ecritureParentheseSiNegatif: string\n    definePropRo(this, 'ecritureParentheseSiNegatif', () => {\n      if (!ecritureParentheseSiNegatif)\n        ecritureParentheseSiNegatif =\n          this.s === 0\n            ? '0'\n            : this.s === 1\n              ? this.texFSD\n              : '\\\\left(' + this.texFSD + '\\\\right)'\n      return ecritureParentheseSiNegatif\n    })\n\n    /**\n     * true si la fraction est un entier false sinon\n     */\n    let estEntiere: boolean\n    definePropRo(this, 'estEntiere', () => {\n      if (!estEntiere) estEntiere = this.d === 1\n      return estEntiere\n    })\n\n    /**\n     * @returns true si la FractionX est le carr d'une fractionX\n     */\n    let estParfaite: boolean\n    definePropRo(this, 'estParfaite', () => {\n      if (!estParfaite)\n        estParfaite =\n          Number.isInteger(Math.sqrt(this.n)) &&\n          Number.isInteger(Math.sqrt(this.d))\n      return estParfaite\n    })\n\n    /**\n     * @returns true si la FractionX est irrductible\n     */\n    let estIrreductible: boolean\n    definePropRo(this, 'estIrreductible', () => {\n      if (!estIrreductible)\n        estIrreductible =\n          gcd(Math.abs(this.num), Math.abs(this.den)) === 1 && this.den !== 1\n      return estIrreductible\n    })\n  }\n\n  /**\n   * bas sur la mthode toLatex() de mathjs, on remplace \\frac par \\dfrac plus joli.\n   * @return {string} la chaine Latex pour crire la  FractionMathjs  (signe devant)\n   */\n  toLatex(): string {\n    const text = this.texFSD\n    return text.replace('\\\\frac', '\\\\dfrac')\n  }\n\n  /**\n   * retourne un flottant pour compatibilit de FractionEtendue() avec Number().\n   * @return {number}\n   */\n  toNumber(): number {\n    return this.num / this.den\n  }\n\n  /**\n   *\n   */\n  toString() {\n    // Cette fonction n'a pas vocation  tre utilise ! si on veut du latex, il faut utiliser sa proprit texFraction.\n    // Cette mthode vient se substituer  la mthode toString() de Object.prototype qui renvoie '[object object]' elle est utilise si la FractionEtendue a t utilise par erreur  la place de sa proprit texFraction\n    window.notify(\n      'Pour obtenir du Latex avec une FractionEtendue, il faut utiliser sa proprit texFraction !',\n      { numerateur: this.num, denominateur: this.den },\n    )\n    return this.texFraction\n  }\n\n  /**\n   * Pour la conversion automatique en number\n   * @returns {number}\n   */\n  valueOf(): number {\n    return this.toNumber()\n  }\n\n  /**\n   *\n   * @param {FractionEtendue[]} fractions\n   * @return {FractionEtendue}\n   */\n  sommeFractions(...fractions: FractionEtendue[]) {\n    // retourne un rsultat simplifi\n    let s = new FractionEtendue(this.num, this.den)\n    if (s != null) {\n      for (const f of fractions) {\n        s = s.sommeFraction(f)\n      }\n    }\n    if (s == null) {\n      window.notify(\n        'il se passe quelque chose de travers dans sommeFractions() avec les fractions passes',\n        { fractions },\n      )\n      return this\n    }\n    return s.simplifie()\n  }\n\n  /**\n   * @return {FractionEtendue} la FractionEtendue irreductible\n   */\n  simplifie() {\n    return new FractionEtendue(\n      (abs(this.num) * this.signe) / gcd(abs(this.num), abs(this.den)),\n      abs(this.den) / gcd(abs(this.num), abs(this.den)),\n    )\n  }\n\n  /**\n   * Convertit la FractionEtendue en Fraction\n   * @return {FractionEtendue} un objet  FractionMathjs  (mathjs)\n   */\n  valeurAbsolue(): FractionEtendue {\n    return new FractionEtendue(abs(this.num), abs(this.den))\n  }\n\n  /**\n   * @return {FractionEtendue} oppos de la FractionEtendue\n   */\n  oppose() {\n    return new FractionEtendue(-1 * this.num, this.den)\n  }\n\n  /**\n   * On pourra utiliser k = 0.5 pour simplifier par 2 la  FractionMathjs  par exemple.\n   * @param {number} k\n   * @return {FractionEtendue} La FractionEtendue dont le numrateur et le dnominateur ont t multiplis par k.\n   */\n  reduire(k: number) {\n    const num = multiply(this.num, k)\n    const den = multiply(this.den, k)\n    return new FractionEtendue(num, den)\n  }\n\n  /**\n   * @param {FractionEtendue  | number} f2\n   * @return true si la FractionEtendue est gale  la  FractionMathjs  passe en argument.\n   */\n  isEqual(f2: FractionEtendue | number) {\n    if (f2 instanceof FractionEtendue) {\n      return f2.differenceFraction(this).simplifie().num === 0\n    } else {\n      const f2bis = new FractionEtendue(f2, 1)\n      return f2bis.differenceFraction(this).simplifie().num === 0\n    }\n  }\n\n  /**\n   * @param {FractionEtendue  | number} f\n   * @return {FractionEtendue} la FractionEtendue - f rsultat non simplifi\n   */\n  differenceFraction(f: FractionEtendue | number) {\n    if (!(f instanceof FractionEtendue)) {\n      f = new FractionEtendue(f, 1)\n    }\n    return this.sommeFraction(f.oppose())\n  }\n\n  /**\n   * @param {number} n\n   * @return {FractionEtendue}La FractionEtendue multiplie par n (numrateur n fois plus grand)\n   */\n  multiplieEntier(n: number) {\n    if (Number.isInteger(n)) return new FractionEtendue(this.num * n, this.den)\n    else {\n      window.notify(\n        `multiplieEntier() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(this.num * Math.round(n), this.den)\n    }\n  }\n\n  /**\n   * @param {number} n\n   * @return {FractionEtendue} La FractionEtendue divise par n (denominateur n fois plus grand)\n   */\n  entierDivise(n: number): FractionEtendue {\n    if (Number.isInteger(n)) return new FractionEtendue(this.num, n * this.den)\n    else {\n      window.notify(\n        `entierDivise() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(this.num, this.den * Math.round(n))\n    }\n  }\n\n  /**\n   *\n   * @param {number} n\n   * @return {FractionEtendue} n + la FractionEtendue\n   */\n  ajouteEntier(n: number) {\n    if (Number.isInteger(n))\n      return new FractionEtendue(this.num + n * this.den, this.den)\n    else {\n      window.notify(\n        `ajouteEntier() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(this.num + Math.round(n) * this.den, this.den)\n    }\n  }\n\n  /**\n   * @param {number} n\n   * @return {FractionEtendue} n - la FractionEtendue\n   */\n  entierMoinsFraction(n: number): FractionEtendue {\n    if (Number.isInteger(n))\n      return new FractionEtendue(n * this.den - this.num, this.den)\n    else {\n      window.notify(\n        `entierMoinsFraction() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(Math.round(n) * this.den - this.num, this.den)\n    }\n  }\n\n  /**\n   *\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean} true si FractionEtendue >= f\n   */\n  superieurLarge(f2: FractionEtendue | number) {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.num * f2.den >= f2.num * this.den\n  }\n\n  /**\n   * fonctions de comparaison avec une autre fraction.\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean} true si\n   */\n  superieurstrict(f2: FractionEtendue | number): boolean {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.num * f2.den > f2.num * this.den\n  }\n\n  /**\n   * Retourne true si la  FractionMathjs  courante est strictement infrieure  f2\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean}\n   */\n  inferieurstrict(f2: FractionEtendue | number): boolean {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.differenceFraction(f2).valeurDecimale < 0\n  }\n\n  /**\n   * Retourne true si la  FractionMathjs  courante est infrieure ou gale  f2\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean}\n   */\n  inferieurlarge(f2: FractionEtendue | number) {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.num * f2.den <= f2.num * this.den\n  }\n\n  /**\n   *\n   * @param {FractionEtendue} f2\n   * @return {boolean} true si f2 = f et  f2 est plus rduite que f\n   */\n  estUneSimplification(f2: FractionEtendue): boolean {\n    if (f2.num == null || f2.den == null)\n      throw Error(\n        `estUneSimplification(f2) : f2 n'est pas une FractionEtendue ! f2=${JSON.stringify(f2)}`,\n      )\n    return this.isEqual(f2) && abs(this.num) < abs(f2.num)\n  }\n\n  /**\n   *\n   * @param {FractionEtendue   | nombre} f2\n   * @return {FractionEtendue} f + FractionEtendue\n   */\n  sommeFraction(f2: FractionEtendue) {\n    if (f2 instanceof FractionEtendue) {\n      if (this.den === f2.den) {\n        // on ajoute 2 fractions de mme dnominateur\n        return new FractionEtendue(this.num + f2.num, f2.den)\n      } else if ([this.den, f2.den].indexOf(lcm(this.den, f2.den)) !== -1) {\n        // un dnominateur est multiple de l'autre\n        if (this.den === lcm(this.den, f2.den)) {\n          // c'est this qui a le dnominateur commun.\n          return new FractionEtendue(\n            this.num + f2.num * round(this.den / f2.den),\n            this.den,\n          ) // on transforme f2\n        } else {\n          // c'est f2 qui a le dnominateur commun\n          return new FractionEtendue(\n            f2.num + this.num * round(f2.den / this.den),\n            f2.den,\n          ) // on transforme this\n        }\n      } else {\n        // besoin d'tablir le dnominateur commun.\n        return new FractionEtendue(\n          this.num * round(lcm(this.den, f2.den) / this.den) +\n            f2.num * round(lcm(this.den, f2.den) / f2.den),\n          lcm(this.den, f2.den),\n        )\n      }\n    } else {\n      window.notify(\n        `FractionEtendue.sommeFraction(fractionAAjouter) a t appele avec autre chose qu'une  FractionMathjs  tendue, alors que c'est obligatoire !\\nVoilci l'argument pass : ${f2}... je retourne la fraction de dpart`,\n        { argument: f2 },\n      )\n      return this\n    }\n  }\n\n  /**\n   * Effectue la somme de this et de f2 et retourne la string latex du calcul avec simplification si simplify est true (true par dfaut)\n   * @param {FractionEtendue} f2Arg\n   * @param {boolean} simplify\n   * @returns {string}\n   */\n  texSommeFraction(f2Arg: FractionEtendue, simplify = true): string {\n    if (f2Arg instanceof FractionEtendue) {\n      // on cre une fraction indpendante pour ne pas modifier f2 (c'est un objet et si on le bricole, il sera modifi pour le code appelant.\n      const f2 = new FractionEtendue(f2Arg.num, f2Arg.den)\n      if (f2.den < 0) {\n        // il arrive qu'un dnominateur soit ngatif, alors on change le signe du numrateur et du dnominateur\n        f2.den = -f2.den\n        f2.num = -f2.num\n      }\n      // on fait de mme avec this\n      const f1 = new FractionEtendue(this.num, this.den)\n      if (this.den < 0) {\n        f1.den = -f1.den\n        f1.num = -f1.num\n      }\n      let calcul = `${f1.texFraction}+${f2.texFraction}=`\n      const commonDenominator = ppcm(f1.den, f2.den)\n      const coeffMultiplicatorA = commonDenominator / f1.den\n      const coeffMultiplicatorB = commonDenominator / f2.den\n      if (coeffMultiplicatorA !== 1 || coeffMultiplicatorB !== 1) {\n        if (coeffMultiplicatorA !== 1) {\n          // on modifie la fraction1\n          calcul += `\\\\dfrac{${f1.num}\\\\times ${coeffMultiplicatorA}}{${f1.den}\\\\times ${coeffMultiplicatorA}}+`\n          calcul +=\n            coeffMultiplicatorB === 1\n              ? `${f2.texFraction}=`\n              : `\\\\dfrac{${String(f2.num)}\\\\times ${String(coeffMultiplicatorB)}}{${String(f2.den)}\\\\times ${String(coeffMultiplicatorB)}}=`\n        } else {\n          // si c'est pas la 1 c'est forcment la 2\n          calcul += `${f1.texFraction}+\\\\dfrac{${String(f2.num)}\\\\times ${String(coeffMultiplicatorB)}}{${String(f2.den)}\\\\times ${String(coeffMultiplicatorB)}}=`\n        }\n        // on a crit les multiplication des numrateur et des dnominateurs par les coeff respectifs\n        // on crit le rsultat\n        if (coeffMultiplicatorA !== 1) {\n          // on modifie la fraction1\n          calcul += `\\\\dfrac{${String(f1.num * coeffMultiplicatorA)}}{${String(f1.den * coeffMultiplicatorA)}}+`\n          calcul +=\n            coeffMultiplicatorB === 1\n              ? `${f2.texFraction}=`\n              : `\\\\dfrac{${String(f2.num * coeffMultiplicatorB)}}{${String(f2.den * coeffMultiplicatorB)}}=`\n        } else {\n          // sinon, il y a forcment modification de la fraction2\n          calcul += `${f1.texFraction}+\\\\dfrac{${String(f2.num * coeffMultiplicatorB)}}{${String(f2.den * coeffMultiplicatorB)}}=`\n        }\n      }\n      // les fractions ont le mme dnominateur, on les ajoute\n      calcul += `\\\\dfrac{${String(f1.num * coeffMultiplicatorA)}${ecritureAlgebrique(f2.num * coeffMultiplicatorB)}}{${String(commonDenominator)}}=`\n      calcul += `\\\\dfrac{${String(f1.num * coeffMultiplicatorA + f2.num * coeffMultiplicatorB)}}{${String(commonDenominator)}}`\n      if (!simplify) return calcul\n      const fResult = new FractionEtendue(\n        f1.num * coeffMultiplicatorA + f2.num * coeffMultiplicatorB,\n        commonDenominator,\n      )\n      if (fResult.estIrreductible) return calcul\n      calcul += `=${fResult.texFractionSimplifiee}`\n      return calcul\n    } else {\n      window.notify(\n        \"texSommeFraction : pour l'instant on n'ajoute que une fractionEtendue et rien d'autre\",\n        { fraction: JSON.stringify(f2Arg) },\n      )\n      return ''\n    }\n  }\n\n  /**\n   * @param {FractionEtendue   | number} f2\n   * @return {FractionEtendue} f * FractionEtendue  // retourne un non rsultat simplifi\n   */\n  produitFraction(f2: FractionEtendue | number) {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    if (this.signe * f2.signe === 1) {\n      return new FractionEtendue(\n        Math.abs(this.num * f2.num),\n        Math.abs(this.den * f2.den),\n      )\n    } else {\n      return new FractionEtendue(\n        -Math.abs(this.num * f2.num),\n        Math.abs(this.den * f2.den),\n      )\n    }\n  }\n\n  /**\n   * @param  {Array<FractionEtendue>} fractions\n   * @return {FractionEtendue} produit de FractionEtendue par toutes les fractions passes en argument.\n   */\n  produitFractions(...fractions: FractionEtendue[]) {\n    // retourne un rsultat simplifi\n    let s = new FractionEtendue(this.num, this.den)\n    for (const f of fractions) {\n      s = s.produitFraction(f)\n    }\n    return s.simplifie()\n  }\n\n  /**\n   * @param {FractionEtendue} f2 la  FractionMathjs  qui multiplie.\n   *  @param {'none'|true|false} simplification true si on veut afficher la simplification par dcomposition false si on veut celle par le pgcd et 'none' si on ne veut pas simplifier\n   * @return {string} Le calcul du produit de deux fractions avec tape intermdiaire\n   */\n  texProduitFraction(\n    f2: FractionEtendue,\n    simplification: boolean | 'none' = 'none',\n  ): string {\n    if (this.estEntiere) {\n      return `${this.texFraction}\\\\times ${f2.texFraction}=\\\\dfrac{${`${this.simplifie().num}\\\\times ${ecritureParentheseSiNegatif(f2.num)}`}}{${ecritureParentheseSiNegatif(f2.den)}}${\n        simplification === 'none' || this.produitFraction(f2).estIrreductible\n          ? '=\\\\dfrac{' + this.num * f2.num + '}{' + this.den * f2.den + '}'\n          : this.produitFraction(f2).texSimplificationAvecEtapes(simplification)\n      }`\n    } else {\n      return `${this.texFraction}\\\\times ${f2.texFraction}=\\\\dfrac{${this.num}\\\\times ${ecritureParentheseSiNegatif(f2.num)}}{${this.den} \\\\times ${ecritureParentheseSiNegatif(f2.den)}}${\n        simplification === 'none' || this.produitFraction(f2).estIrreductible\n          ? '=\\\\dfrac{' + this.num * f2.num + '}{' + this.den * f2.den + '}'\n          : `${\n              this.den !== f2.num && f2.den !== this.num\n                ? '=\\\\dfrac{' +\n                  (decompositionFacteursPremiers(this.num) || '1') +\n                  '\\\\times ' +\n                  (decompositionFacteursPremiers(f2.num) || '1') +\n                  '}{' +\n                  (decompositionFacteursPremiers(this.den) || '1') +\n                  '\\\\times ' +\n                  (decompositionFacteursPremiers(f2.den) || '1') +\n                  '}' +\n                  this.produitFraction(f2).texSimplificationAvecEtapes(\n                    simplification,\n                  )\n                : `${\n                    this.den === f2.num\n                      ? '=\\\\dfrac{' +\n                        this.num +\n                        '}{' +\n                        f2.den +\n                        '}' +\n                        new FractionEtendue(\n                          this.num,\n                          f2.den,\n                        ).texSimplificationAvecEtapes(simplification)\n                      : '=\\\\dfrac{' +\n                        f2.num +\n                        '}{' +\n                        this.den +\n                        '}' +\n                        new FractionEtendue(\n                          f2.num,\n                          this.den,\n                        ).texSimplificationAvecEtapes(simplification)\n                  }`\n            }`\n      }`\n    }\n  }\n\n  /**\n   * @param {FractionEtendue} f2 la  FractionMathjs  qui multiplie.\n   * @param {string} simplification true si on veut afficher la simplification par dcomposition false si on veut celle par le pgcd et 'none' si on ne veut pas simplifier\n   *  @param {string} symbole '/' pour la forme fractionnaire de la division, ':' ou autre chose pour l'oble\n   * @return {string} Le calcul du produit de deux fractions avec tape intermdiaire\n   */\n  texDiviseFraction(\n    f2: FractionEtendue,\n    simplification: boolean | 'none' = 'none',\n    symbole = '/',\n  ) {\n    const space = '\\\\phantom{\\\\dfrac{(_(^(}{(_(^(}}' // Utilis pour mettre de l'espace dans une  FractionMathjs  de fraction\n    const space2 = '\\\\phantom{(_(^(}' // Utilis pour mettre de l'espace dans une  FractionMathjs  de  FractionMathjs  lorsque le numrateur ou le dnominateur est entier\n    if (this.estEntiere) {\n      if (f2.inverse().estEntiere && f2.num === 1) {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space2 + this.texFraction + space2}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.simplifie().texFSD}\\\\times ${f2.inverse().simplifie().texFSP}=${this.simplifie().num * f2.inverse().simplifie().num}`\n          // pas de simplification : on multiplie deux entiers !\n        } else {\n          return `${this.simplifie().texFraction}\\\\div${f2.texFraction}=${this.simplifie().texFSD}\\\\times ${f2.inverse().simplifie().texFSP}=${this.simplifie().num * f2.inverse().simplifie().num}`\n          // pas de simplification : on multiplie deux entiers !\n        }\n      } else {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space2 + this.texFraction + space2}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.texFractionSimplifiee}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.texFractionSimplifiee} \\\\times ${ecritureParentheseSiNegatif(f2.den)}}{${ecritureParentheseSiNegatif(f2.num)}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.simplifie().num * f2.den}}{${f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}\\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(\n                  f2,\n                ).texSimplificationAvecEtapes(simplification)}`\n          }`\n        } else {\n          return `${this.texFraction}\\\\div${f2.texFraction}=${this.texFractionSimplifiee}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.texFractionSimplifiee + '\\\\times ' + ecritureParentheseSiNegatif(f2.den)}}{${ecritureParentheseSiNegatif(f2.num)}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.simplifie().num * f2.den}}{${f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)} \\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)} \\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        }\n      }\n    } else {\n      if (f2.inverse().estEntiere && f2.num === 1) {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space + this.texFraction + space}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.texFraction}\\\\times ${f2.inverse().simplifie().texFSP}=\\\\dfrac{${this.num + '\\\\times ' + f2.inverse().simplifie().texFSP}}{${this.den}}\n      ${\n        simplification === 'none' || this.diviseFraction(f2).estIrreductible\n          ? '=\\\\dfrac{' + this.num * f2.den + '}{' + this.den * f2.num + '}'\n          : '=\\\\dfrac{' +\n            decompositionFacteursPremiers(this.num) +\n            '\\\\times ' +\n            decompositionFacteursPremiers(f2.den) +\n            '}{' +\n            decompositionFacteursPremiers(this.den) +\n            '}' +\n            this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)\n      }`\n        } else {\n          return `${this.texFraction}\\\\div${f2.texFraction}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times ' + f2.inverse().texFraction}}{${this.den}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        }\n      } else {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space + this.texFraction + space}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times ' + ecritureParentheseSiNegatif(f2.den)}}{${this.den + '\\\\times ' + ecritureParentheseSiNegatif(f2.num)}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}\\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        } else {\n          return `${this.texFraction}\\\\div${f2.texFraction}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times ' + f2.den}}{${this.den + '\\\\times ' + f2.num}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}\\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {number} n l'exposant de la fraction\n   * @return {FractionEtendue} La puissance n de la fraction\n   */\n  puissanceFraction(n: number): FractionEtendue {\n    if (Number.isInteger(n))\n      return new FractionEtendue(this.num ** n, this.den ** n)\n    else {\n      window.notify(\n        \"puissanceFraction() l'argument n'est pas un entier j'arrondis !\",\n        { argument: n },\n      )\n      return new FractionEtendue(\n        this.num ** Math.round(n),\n        this.den ** Math.round(n),\n      )\n    }\n  }\n\n  /**\n   * @return {FractionEtendue} inverse de la fraction\n   */\n  inverse(): FractionEtendue {\n    if (this.num === 0)\n      throw Error(`Division par 0 dans inverse() : ${JSON.stringify(this)}`)\n    return new FractionEtendue(this.den, this.num)\n  }\n\n  /**\n   *\n   * @param {FractionEtendue} f2\n   * @return {FractionEtendue} f/f2\n   */\n  diviseFraction(f2: FractionEtendue | number): FractionEtendue {\n    if (!(f2 instanceof FractionEtendue)) {\n      window.notify(\n        \"FractionEtendue.diviseFraction() : l'argument n'est pas une fraction\",\n        { f2 },\n      )\n      if (typeof f2 === 'number') return this.multiplieEntier(1 / f2)\n      else {\n        window.notify(\n          \"FractionEtendue.diviseFraction() : l'argument n'est pas un nombre, je retourne la fraction de dpart.\",\n          { f2 },\n        )\n        return this\n      }\n    } else return this.produitFraction(f2.inverse())\n  }\n\n  /**\n   * @param {number} n entier divis par la fraction\n   * @return {FractionEtendue} n divis par fraction\n   */\n  diviseEntier(n: number): FractionEtendue {\n    if (Number.isInteger(n))\n      return new FractionEtendue(n * this.den, this.num).simplifie()\n    else {\n      window.notify(\n        \"diviseEntier() : l'argument n'est pas un entier, j'arrondis\",\n        { n },\n      )\n      return new FractionEtendue(Math.round(n) * this.den, this.num).simplifie()\n    }\n  }\n\n  /**\n   *\n   * @param {FractionEtendue} f2\n   * @return {string} Calcul f/f2 avec les tapes mais sans simplification\n   */\n  texQuotientFraction(f2: FractionEtendue): string {\n    if (!(f2 instanceof FractionEtendue)) {\n      window.notify(\n        \"texQuotientFraction() : l'argument n'est pas une fraction\",\n        { f2 },\n      )\n      if (typeof f2 === 'number') f2 = new FractionEtendue(f2, 1)\n      else {\n        window.notify(\n          \"texQuotientFraction() : l'argument n'est pas un nombre, je retourne la fraction de dpart.\",\n          { f2 },\n        )\n        return this.texFraction\n      }\n    }\n    return `${this.texFraction}\\\\div ${f2.texFraction}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times' + f2.den}}{${this.den + '\\\\times' + f2.num}}=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n  }\n\n  /**\n   * Si la  FractionMathjs  est rductible, retourne une suite d'galits permettant d'obtenir la  FractionMathjs  irrductible\n   * @param {true|false|'none'} factorisation\n   * @param {string} couleurFinale\n   * @return {string}\n   */\n  texSimplificationAvecEtapes(\n    factorisation: boolean | 'none' = false,\n    couleurFinale: string = '',\n  ): string {\n    if (this.isEqual(0)) return ''\n    if (this.estIrreductible && this.num > 0 && this.den > 0)\n      return '' // irreductible et positifs\n    else if (this.estIrreductible && this.num * this.den < 0) {\n      // irrductible mais ngatifs\n      return couleurFinale === ''\n        ? `=${this.texFSD}`\n        : `=${miseEnEvidence(this.texFSD, couleurFinale)}`\n    } else {\n      if (factorisation) {\n        const signe = this.sign === -1 ? '-' : ''\n        const num = Math.abs(this.num)\n        const den = Math.abs(this.den)\n        const listenum = obtenirListeFacteursPremiers(num)\n        const listeden = obtenirListeFacteursPremiers(den)\n        let result = '='\n        const listeNumvf = []\n        const listeDenvf = []\n        listenum.forEach(function aAjouterDansListeAvf(element) {\n          listeNumvf.push([element, true])\n        })\n        listeden.forEach(function aAjouterDansListeBvf(element) {\n          listeDenvf.push([element, true])\n        })\n\n        for (let index = 0; index < listeden.length; ) {\n          for (let j = 0; j <= listenum.length; ) {\n            if (listeden[index] === listenum[j]) {\n              listeDenvf[index] = [listeden[index], false]\n              listeNumvf[j] = [listenum[j], false]\n              listenum[j] = 1\n              listeden[index] = 1\n              break\n            }\n            j++\n          }\n          index++\n        }\n\n        let a = 1\n        let b = 1\n        for (const k of listenum) {\n          a = a * k\n        }\n        for (const k of listeden) {\n          b = b * k\n        }\n\n        let numerateur = ''\n        let denominateur = ''\n\n        for (const j in listeNumvf) {\n          if (listeNumvf[j][1] === true) {\n            numerateur += listeNumvf[j][0] + '\\\\times'\n          } else {\n            numerateur += '\\\\cancel{' + listeNumvf[j][0] + '}\\\\times'\n          }\n        }\n        numerateur = numerateur.substring(0, numerateur.length - 6)\n\n        for (const j in listeDenvf) {\n          if (listeDenvf[j][1] === true) {\n            denominateur += listeDenvf[j][0] + '\\\\times'\n          } else {\n            denominateur += '\\\\cancel{' + listeDenvf[j][0] + '}\\\\times'\n          }\n        }\n        denominateur = denominateur.substring(0, denominateur.length - 6)\n\n        result += `${signe}\\\\dfrac{${numerateur}}{${denominateur}}`\n        result +=\n          couleurFinale !== ''\n            ? `=${miseEnEvidence(`${signe}${new FractionEtendue(a, b).simplifie().texFraction}`, couleurFinale)}`\n            : `=${signe}${new FractionEtendue(a, b).simplifie().texFraction}`\n        return result\n      } else {\n        const signe = this.sign === -1 ? '-' : ''\n        const num = Math.abs(this.num)\n        const den = Math.abs(this.den)\n        const pgcd = gcd(num, den)\n        if (pgcd !== 1) {\n          const redaction = `=${signe}\\\\dfrac{${num / pgcd}${miseEnEvidence('\\\\times' + ecritureParentheseSiNegatif(pgcd), '#2563a5')} }{${den / pgcd}${miseEnEvidence('\\\\times' + ecritureParentheseSiNegatif(pgcd), '#2563a5')}}=`\n          let redactionFinale\n          if (Math.abs(den / pgcd) !== 1)\n            redactionFinale = `${signe}\\\\dfrac{${Math.abs(num / pgcd)}}{${Math.abs(den / pgcd)}}`\n          else redactionFinale = `${signe}${Math.abs(num / pgcd)}`\n          if (couleurFinale !== '')\n            redactionFinale = miseEnEvidence(redactionFinale, couleurFinale)\n          return redaction + redactionFinale\n        } else {\n          let redactionFinale\n          if (Math.abs(den / pgcd) - 1 !== 0)\n            redactionFinale = `=${signe}\\\\dfrac{${Math.abs(num / pgcd)}}{${Math.abs(den / pgcd)}}`\n          else redactionFinale = `=${signe}${Math.abs(num / pgcd)}`\n          if (couleurFinale !== '')\n            redactionFinale = miseEnEvidence(redactionFinale, couleurFinale)\n          return redactionFinale\n        }\n      }\n    }\n  }\n\n  /**\n   * @return {FractionEtendue|number} NaN si la FractionEtendue n'est pas un nombre dcimal sinon retourne une FractionEtendue avec la bonne puissance de 10 au dnominateur\n   */\n  fractionDecimale(): FractionEtendue {\n    const den = Math.abs(this.simplifie().den)\n    const num = Math.abs(this.simplifie().num)\n    const signe = this.simplifie().signe\n    const liste = obtenirListeFacteursPremiers(den)\n    let n2 = 0\n    let n5 = 0\n    for (const n of liste) {\n      if (n === 2) {\n        n2++\n      } else if (n === 5) {\n        n5++\n      } else {\n        window.notify(\n          'FractionEtendue.valeurDecimale :  FractionMathjs  non dcimale',\n          { fraction: this },\n        )\n        return this\n      }\n    }\n    if (n5 === n2) {\n      return new FractionEtendue(num * signe, den)\n    } else if (n5 > n2) {\n      return new FractionEtendue(\n        signe * num * 2 ** (n5 - n2),\n        den * 2 ** (n5 - n2),\n      )\n    } else {\n      return new FractionEtendue(\n        signe * num * 5 ** (n2 - n5),\n        den * 5 ** (n2 - n5),\n      )\n    }\n  }\n\n  /**\n   * Retourne la chaine latex contenant la racine carre de la fraction\n   * @param {boolean} detaillee Si detaillee est true, une tape de calcul se place avant le rsultat.\n   * @return {string}\n   */\n  texRacineCarree(detaillee: boolean = false): string {\n    if (this.num === 0) {\n      return '0'\n    } else {\n      if (this.estParfaite) {\n        const rac = this.racineCarree()\n        if (rac) return rac.texFraction\n        else return `\\\\sqrt{${this.texFraction}}`\n      }\n      if (this.signe === -1) return 'Not a real number !'\n      let factoDen: [number, number] = extraireRacineCarree(Math.abs(this.den))\n      let factoNum\n      let etape\n      if (!this.estEntiere) {\n        etape = detaillee ? `\\\\sqrt{\\\\dfrac{${this.num}}{${this.den}}}=` : ''\n      } else {\n        factoNum = extraireRacineCarree(Math.abs(this.num))\n        if (factoNum[0] !== 1) {\n          etape = detaillee ? `\\\\sqrt{${Math.abs(this.num)}}=` : ''\n        } else {\n          etape = ''\n        }\n      }\n      if (factoDen[1] !== 1) {\n        if (!this.estEntiere) {\n          etape += detaillee\n            ? `\\\\sqrt{\\\\dfrac{${Math.abs(this.num)}\\\\times ${factoDen[1]}}{${Math.abs(this.den)}\\\\times ${factoDen[1]}}}=`\n            : ''\n          etape += detaillee\n            ? `\\\\sqrt{\\\\dfrac{${Math.abs(this.num * factoDen[1])}}{${Math.abs(this.den * factoDen[1])}}}=`\n            : ''\n        }\n        factoNum = extraireRacineCarree(Math.abs(this.num * factoDen[1]))\n        factoDen = extraireRacineCarree(Math.abs(this.den * factoDen[1]))\n      } else {\n        factoNum = extraireRacineCarree(Math.abs(this.num))\n      }\n      const k = new FractionEtendue(factoNum[0], factoDen[0]).simplifie()\n      const r = new FractionEtendue(factoNum[1], factoDen[1]).simplifie()\n\n      if (detaillee) {\n        if (k.valeurDecimale !== 1) {\n          if (k.denIrred === 1) {\n            etape += detaillee\n              ? `\\\\sqrt{${factoNum[0]}^2\\\\times${factoNum[1]}}=`\n              : ''\n            etape += detaillee\n              ? `${factoNum[0]}${factoNum[1] !== 1 ? '\\\\sqrt{' + factoNum[1] + '}' : '}'}`\n              : ''\n          } else {\n            if (factoNum[0] !== 1) {\n              etape += detaillee\n                ? `\\\\sqrt{\\\\dfrac{${factoNum[0]}^2${factoNum[1] !== 1 ? '\\\\times ' + factoNum[1] : ''}}{${factoDen[0]}^2${factoDen[1] !== 1 ? '\\\\times' + factoDen[1] : ''}}}=`\n                : ''\n              etape += detaillee\n                ? `\\\\dfrac{${factoNum[0]}${factoNum[1] !== 1 ? '\\\\times\\\\sqrt{' + factoNum[1] + '}' : ''}}{${factoDen[0]}${factoDen[1] !== 1 ? '\\\\times\\\\sqrt{' + factoDen[1] + '}' : ''}}=`\n                : ''\n            } else {\n              if (factoDen[1] !== 1) {\n                etape += detaillee\n                  ? `\\\\sqrt{\\\\dfrac{${factoNum[1]}}{${factoDen[0]}^2\\\\times ${factoDen[1]}}}=`\n                  : ''\n              } else {\n                etape += detaillee\n                  ? `\\\\sqrt{\\\\dfrac{${factoNum[1]}}{${factoDen[0]}^2}}=`\n                  : ''\n              }\n            }\n          }\n        }\n      }\n\n      if (arrondi(factoNum[1] / factoDen[1], 6) === 1) {\n        return etape + k.texFraction\n      } else {\n        if (k.numIrred === 1 && k.denIrred !== 1) {\n          if (r.denIrred === 1) {\n            return k.valeurDecimale === 1\n              ? etape\n              : etape + `\\\\dfrac{\\\\sqrt{${r.numIrred}}}{${k.denIrred}}`\n          } else {\n            return (\n              (k.valeurDecimale === 1 ? etape : etape + k.texFraction) +\n              `\\\\sqrt{${r.toLatex()}}`\n            )\n          }\n        } else {\n          return (\n            (k.valeurDecimale === 1 ? etape : etape + k.texFraction) +\n            `\\\\sqrt{${r.toLatex()}}`\n          )\n        }\n      }\n    }\n  }\n\n  /**\n   * Retourne la racine carre de la  FractionMathjs  si c'est une  FractionMathjs  et false sinon\n   * @return {FractionEtendue|boolean}\n   */\n  racineCarree(): FractionEtendue | false {\n    if (this.isEqual(0)) {\n      return new FractionEtendue(0, 1)\n    } // sqrt(0)=0\n    const factoNum = extraireRacineCarree(Math.abs(this.num))\n    const factoDen = extraireRacineCarree(Math.abs(this.den))\n    const k = new FractionEtendue(factoNum[0], factoDen[0]).simplifie()\n    const r = new FractionEtendue(factoNum[1], factoDen[1]).simplifie()\n    if (r.valeurDecimale !== 1 || this.signe === -1) {\n      return false\n    } else {\n      return k\n    }\n  }\n}\n\nexport default FractionEtendue\n","import Figure from 'apigeom/src/Figure'\nimport CryptoJS from 'crypto-js'\nimport type Decimal from 'decimal.js'\nimport seedrandom from 'seedrandom'\nimport type { IExercice, IExerciceSimple } from '../lib/types'\nimport { CRC32 } from '../modules/crc32'\nimport FractionEtendue from '../modules/FractionEtendue'\nimport type { IFractionEtendue } from '../modules/FractionEtendue.type'\ntype EventListener = (evt: Event) => void\n\nexport function exportedNouvelleVersionWrapper(\n  this: IExercice,\n  numeroExercice?: number,\n  numeroQuestion?: number,\n): void {\n  const signature = [\n    this.seed,\n    this.sup,\n    this.sup2,\n    this.sup3,\n    this.sup4,\n    this.sup5,\n    this.correctionDetaillee,\n    this.interactif,\n    this.nbQuestions,\n    numeroExercice,\n    numeroQuestion,\n  ]\n    .map(String)\n    .join('')\n  if (this.lastCallback === signature) {\n    // identique\n    // pas de recalcul  faire\n    return\n  }\n  this.lastCallback = signature\n  this.reinit()\n  seedrandom(this.seed, { global: true })\n  this.nouvelleVersion(numeroExercice, numeroQuestion)\n  this.checkSum = CRC32.hexQuestions(this.listeQuestions)\n}\n\nexport function exportedReinit(this: IExerciceSimple) {\n  this.listeQuestions = []\n  this.listeCorrections = []\n  this.listeCanEnonces = []\n  this.listeCanReponsesACompleter = []\n  this.listeCanLiees = []\n  this.listeCanNumerosLies = []\n  this.listeArguments = []\n  this.autoCorrection = []\n  this.distracteurs = []\n  this.checkSum = undefined\n  if (this.figures) {\n    // figure APIGEOM\n    this.figures.forEach((fig) => {\n      if (fig instanceof Figure) {\n        fig.destroy()\n      }\n    })\n  }\n  this.figures = []\n  if (this.dragAndDrops && this.dragAndDrops.length > 0) {\n    for (const leDragAndDrop of this.dragAndDrops) {\n      for (const [element, type, listener] of leDragAndDrop.listeners) {\n        element.removeEventListener(type, listener as EventListener)\n      }\n    }\n    this.dragAndDrops = []\n  }\n}\n\nexport function exportedApplyNewSeed(this: IExercice) {\n  const seed = generateSeed({\n    includeUpperCase: true,\n    includeNumbers: true,\n    length: 4,\n    startsWithLowerCase: false,\n  })\n  this.seed = seed\n}\n\nfunction empreinteTexte(str: string): string {\n  // Utiliser CryptoJS pour calculer une empreinte SHA256 de la chane de caractres\n  const hash = CryptoJS.SHA256(str)\n  // Convertir l'empreinte en chane de caractres hexadcimale\n  const empreinteTexte = hash.toString(CryptoJS.enc.Hex)\n  return empreinteTexte.length > str.length ? str : empreinteTexte\n}\n\n/**\n * Compare chaque nouvelle version d'un exercice aux prcdentes pour s'assurer de ne pas avoir deux exercices identiques\n * @param {int} i indice de la question\n * @param  {...any} args toutes les variables pertinentes qui \"rsumeraient\" la question\n * @returns {boolean} true si la question n'a jamais t pose\n */\nexport function exportedQuestionJamaisPosee(\n  this: IExercice,\n  i: number,\n  ...args: (string | number | IFractionEtendue | Decimal)[]\n) {\n  if (i === 0) this.listeArguments = []\n  let argsConcatenes = ''\n  for (const arg of args) {\n    if (arg !== undefined)\n      argsConcatenes +=\n        arg instanceof FractionEtendue ? arg.texFraction : arg.toString()\n  }\n  const empreinte = empreinteTexte(argsConcatenes)\n  if (\n    this.listeArguments != null &&\n    this.listeArguments.indexOf(empreinte) > -1\n  ) {\n    return false\n  } else if (this.listeArguments != null) {\n    this.listeArguments.push(empreinte)\n    return true\n  }\n}\n\nfunction generateSeed({\n  includeUpperCase = true,\n  includeNumbers = true,\n  length = 4,\n  startsWithLowerCase = false,\n}: {\n  includeUpperCase?: boolean\n  includeNumbers?: boolean\n  length?: number\n  startsWithLowerCase?: boolean\n} = {}) {\n  let a = 10\n  const b = 'abcdefghijklmnopqrstuvwxyz'\n  let c = ''\n  let d = 0\n  let e = '' + b\n  if (startsWithLowerCase) {\n    c = b[Math.floor(Math.random() * b.length)]\n    d = 1\n  }\n  if (length) {\n    a = length\n  }\n  if (includeUpperCase) {\n    e += b.toUpperCase()\n  }\n  if (includeNumbers) {\n    e += '1234567890'\n  }\n\n  for (; d < a; d++) {\n    c += e[Math.floor(Math.random() * e.length)]\n  }\n  return c\n}\n","import type Figure from 'apigeom/src/Figure'\nimport type Decimal from 'decimal.js'\nimport {\n  KeyboardType,\n  type PartialKbType,\n} from '../lib/interactif/claviers/keyboard'\nimport type {\n  AnswerValueType,\n  AutoCorrection,\n  ClickFigures,\n  IDragAndDrop,\n  IExercice,\n  IExerciceSimple,\n  InteractivityType,\n  OldFormatInteractifType,\n  OptionsComparaisonType,\n  CompareFunction,\n  Valeur,\n} from '../lib/types'\nimport type { IFractionEtendue } from '../modules/FractionEtendue.type'\nimport {\n  exportedApplyNewSeed,\n  exportedNouvelleVersionWrapper,\n  exportedQuestionJamaisPosee,\n  exportedReinit,\n} from './exerciseMethods'\n\n/**\n *\n *  Classe parente de tous les exercices.\n *\n * @author Rmi Angot\n */\nexport default class Exercice implements IExercice {\n  titre: string\n  id?: string\n  uuid!: string\n  sup: any\n  sup2: any\n  sup3: any\n  sup4: any\n  sup5: any\n  exoCustomResultat?: boolean // Lorsqu'il est  true, correctionInteractive renvoie un tableau de string ce qui permet  une question de rapporter plusieurs points\n  duree?: number\n  seed?: string\n  numeroExercice?: number\n  typeExercice?: string\n  duration?: number\n  // boutonAide: boolean | HTMLButtonElement\n  consigne: string\n  consigneCorrection: string\n  introduction: string\n  listeQuestions: string[] = []\n  listeCorrections: string[] = []\n  listeCanReponsesACompleter: string[] = []\n  listeCanEnonces: string[] = []\n  listeCanLiees: number[][] = []\n  listeCanNumerosLies: number[] = []\n  question?: string // Seulement pour les exercices de type simple\n  reponse?: AnswerValueType | Valeur // Seulement pour les exercices de type simple\n  correction?: string // Seulement pour les exercices de type simple\n  canOfficielle?: boolean = false\n  canEnonce?: string // Seulement pour les exercices de type simple ??? NON ! NOTE de Jena-claude Lhote du 2/02/2025 : et pourquoi a ???\n  // On peut tre amen  utiliser un Exercice non simple  une seule question dans une can, parce qu'il a 3 champs et une correction custom.\n  // Et vouloir un this.canEnonce sur cet exercice, pour le document CAN !\n  canReponseACompleter: string = '' // Seulement pour les exercices de type simple\n  canNumeroLie: number = 0 //  Pour la sortie LaTeX des CAN dont les noncs sont lies, cette variable contient le numro de la question actuelle.\n  canLiee: number[] = [] //  Pour la sortie LaTeX des CAN dont les noncs sont lies, cette variable contient, dans un tableau, les numros des CAN lies  l'actuelle.\n  formatChampTexte: string | undefined | PartialKbType =\n    KeyboardType.clavierDeBase // Seulement pour les exercices de type simple\n\n  optionsChampTexte?: object // Seulement pour les exercices de type simple\n  // tailleDiaporama?: number // Pour fixer un zoom de base en mode diaporama\n  compare?: CompareFunction // Seulement pour les exercices de type simple\n\n  // optionsDeComparaison?: { [key in keyof OptionsComparaisonType]?: boolean }\n  optionsDeComparaison?: Partial<OptionsComparaisonType>\n  formatInteractif?: InteractivityType | OldFormatInteractifType // Options par dfaut pour les champs Mathlive (trs utile dans les exercices simples)\n  contenu?: string\n  contenuCorrection?: string\n  autoCorrection: AutoCorrection[]\n  figures?: Figure[] | ClickFigures[]\n  amcReady?: boolean\n  amcType?: string\n  tableauSolutionsDuQcm?: object[]\n  spacing: number\n  spacingCorr: number\n  pasDeVersionLatex: boolean\n  listePackages?: string[]\n  consigneModifiable: boolean\n  nbQuestionsModifiable: boolean\n  nbCols: number // Nombre de colonnes pour la sortie LaTeX\n  nbColsCorr: number\n  nbColsModifiable: boolean\n  nbColsCorrModifiable: boolean\n  spacingModifiable: boolean\n  spacingCorrModifiable: boolean\n  listeAvecNumerotation?: boolean\n  beamer: boolean\n  nbQuestions: number\n  pointsParQuestions: number\n  correctionDetailleeDisponible: boolean\n  correctionDetaillee: boolean\n  correctionIsCachee: boolean\n  video: string\n  interactif: boolean // l'exercice est affich en mode interactif si `true`\n  interactifObligatoire: boolean\n  interactifReady: boolean // flag pour indiquer si l'exercice est dispo en interactif ou pas\n  interactifType?: string\n  besoinFormulaireNumerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaireTexte: boolean | [string, string]\n  besoinFormulaireCaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire2Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire2Texte: boolean | [string, string]\n  besoinFormulaire2CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire3Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire3Texte: boolean | [string, string]\n  besoinFormulaire3CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire4Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire4Texte: boolean | [string, string]\n  besoinFormulaire4CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire5Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire5Texte: boolean | [string, string]\n  besoinFormulaire5CaseACocher: boolean | [string] | [string, boolean]\n  listeArguments: string[] // Variable servant  comparer les exercices pour ne pas avoir deux exercices identiques\n  lastCallback: string // La dernire signature de listeArguments afin de comparaison : permet d'viter un nouvelleVersionWrapper inutile\n  checkSum?: string // Empreinte CRC32 des questions de l'exercice pour comparaison rapide\n  examen?: string // Pour les exercices statiques\n  mois?: string // Pour les exercices statiques\n  annee?: string // Pour les exercices statiques\n  lieu?: string // Pour les exercices statiques\n  content?: string // Pour les exercices statiques\n  contentCorr?: string // Pour les exercices statiques\n  comment?: string // Commentaire facultatif de l'auteur de l'exercice\n  answers?: { [key: string]: string } // Rponses de l'lve\n  dragAndDrops?: IDragAndDrop[]\n  isDone?: boolean\n  private _html: HTMLElement = document.createElement('div')\n  score?: number\n  vspace?: number // Ajoute un \\vspace{[number]cm} avant l'nonc ce qui peut tre pratique pour des exercices avec des figures.\n\n  constructor() {\n    // ////////////////////////////////////////////////\n    // Autour de l'exercice\n    // ////////////////////////////////////////////////\n    this.titre = '' // Chane de caractre sans point  la fin. C'est le titre de l'exercice qui sera affich avec la rfrence dans le gnrateur d'exercices.\n\n    // ///////////////////////////////////////////////\n    // Construction de l'exercice\n    // ///////////////////////////////////////////////\n    this.consigne = '' // Chane de caractre qui apparat en gras au-dessus des questions de prfrence  l'infinitif et AVEC point  la fin.\n    this.consigneCorrection = '' // Chane de caractre en gnral vide qui apparat au-dessus des corrections.\n    this.introduction = '' // Texte qui n'est pas forcment en gras et qui apparat entre la consigne et les questions.\n\n    this.listeQuestions = []\n    this.listeCorrections = [] // Idem avec la correction.\n    this.contenu = '' // Chane de caractres avec tout l'nonc de l'exercice construit  partir de `this.listeQuestions` suivant le `context`\n    this.contenuCorrection = '' // Idem avec la correction\n    this.autoCorrection = [] // Liste des objets par question pour correction interactive || export AMC.\n    this.tableauSolutionsDuQcm = [] // Pour sauvegarder les solutions des QCM.\n\n    // ///////////////////////////////////////////////\n    // Mise en forme de l'exercice\n    // ///////////////////////////////////////////////\n    this.spacing = 1 // Interligne des questions\n    this.spacingCorr = 1 // Interligne des rponses\n\n    // ////////////////////////////////////////////\n    // Gestion de la sortie LateX\n    // ////////////////////////////////////////////\n    this.pasDeVersionLatex = false // boolen qui indique qu'une sortie LateX est impossible.\n    this.consigneModifiable = true // boolen pour dterminer si la consigne est modifiable en ligne dans la sortie LaTeX.\n    this.nbQuestionsModifiable = true // boolen pour dterminer si le nombre de questions est modifiable en ligne.\n    this.nbCols = 1 // Nombre de colonnes pour la sortie LaTeX des questions (environnement multicols).\n    this.nbColsCorr = 1 // Nombre de colonnes pour la sortie LaTeX des rponses (environnement multicols).\n    this.nbColsModifiable = true // boolen pour dterminer si le nombre de colonnes est modifiable en ligne dans la sortie LaTeX.\n    this.nbColsCorrModifiable = true // boolen pour dterminer si le nombre de colonnes de la correction est modifiable en ligne dans la sortie LaTeX.\n    this.spacingModifiable = true // boolen pour dterminer si l'espacement est modifiable en ligne dans la sortie LaTeX.\n    this.spacingCorrModifiable = true // boolen pour dterminer si l'espacement est modifiable en ligne dans la sortie LaTeX.\n\n    // ////////////////////////////////////////////\n    // Gestion de la sortie autre que LateX\n    // ////////////////////////////////////////////\n    this.beamer = false // boolen pour savoir si la sortie devra tre un diaporama beamer\n\n    // ////////////////////////////////////////////\n    // Paramtres\n    // ////////////////////////////////////////////\n    this.nbQuestions = 10 // Nombre de questions par dfaut (rcupr dans l'url avec le paramtre `,n=`)\n    this.pointsParQuestions = 1 // Pour dfinir la note par dfaut d'un exercice dans sa sortie Moodle\n    this.correctionDetailleeDisponible = false // boolen qui indique si une correction dtaille est disponible.\n    this.correctionDetaillee = true // boolen indiquant si la correction dtaille doit tre affich par dfaut (rcupr dans l'url avec le paramtre `,cd=`).\n    this.correctionIsCachee = false // pour cacher une correction\n    this.video = '' // Chaine de caractre pour un complment numrique (id Youtube, url, code iframe...).\n    // Interactivit\n    this.interactif = false // Exercice sans saisie utilisateur par dfaut.\n    this.interactifReady = false // Exercice sans saisie utilisateur par dfaut.\n    this.interactifObligatoire = false // Certains exercices sont uniquement des QCM et n'ont pas de version non interactive.\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup ou dans le paramtre d'url ',s='\n    this.besoinFormulaireNumerique = false // Sinon this.besoinFormulaireNumerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaireTexte = false // Sinon this.besoinFormulaireTexte = [texte, tooltip]\n    this.besoinFormulaireCaseACocher = false // Sinon this.besoinFormulaireCaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup2 ou dans le paramtre d'url ',s2='\n    this.besoinFormulaire2Numerique = false // Sinon this.besoinFormulaire2Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire2Texte = false // Sinon this.besoinFormulaire2Texte = [texte, tooltip]\n    this.besoinFormulaire2CaseACocher = false // Sinon this.besoinFormulaire2CaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup3 ou dans le paramtre d'url ',s3='\n    this.besoinFormulaire3Numerique = false // Sinon this.besoinFormulaire3Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire3Texte = false // Sinon this.besoinFormulaire3Texte = [texte, tooltip]\n    this.besoinFormulaire3CaseACocher = false // Sinon this.besoinFormulaire3CaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup4 ou dans le paramtre d'url ',s4='\n    this.besoinFormulaire4Numerique = false // Sinon this.besoinFormulaire4Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire4Texte = false // Sinon this.besoinFormulaire4Texte = [texte, tooltip]\n    this.besoinFormulaire4CaseACocher = false // Sinon this.besoinFormulaire4CaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup4 ou dans le paramtre d'url ',s5='\n    this.besoinFormulaire5Numerique = false // Sinon this.besoinFormulaire5Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire5Texte = false // Sinon this.besoinFormulaire5Texte = [texte, tooltip]\n    this.besoinFormulaire5CaseACocher = false // Sinon this.besoinFormulaire5CaseACocher = [texte]\n\n    // ///////////////////////////////////////////////\n    // Exercice avec des dpendances particulires\n    // ///////////////////////////////////////////////\n    // this.typeExercice = 'Scratch' // Pour charger Scratchblocks.\n    // this.typeExercice = 'dnb' // Ce n'est pas un exercice alatoire il est trait diffremment. Les exercices DNB sont des images pour la sortie Html et du code LaTeX statique pour la sortie latex.\n    // this.typeExercice = 'simple' // Pour les exercices plus simples destins aux courses aux nombres\n\n    this.listeArguments = [] // Variable servant  comparer les exercices pour ne pas avoir deux exercices identiques\n    this.lastCallback = ''\n    this.answers = {}\n    this.listeAvecNumerotation = true\n  }\n\n  get html(): HTMLElement {\n    return this._html\n  }\n\n  set html(value: HTMLElement) {\n    this._html = value\n  }\n\n  get key(): string {\n    return [\n      this.nbQuestions,\n      this.interactif,\n      this.sup,\n      this.sup2,\n      this.sup3,\n      this.sup4,\n      this.sup5,\n      this.seed,\n      this.correctionDetaillee,\n    ].join('_')\n  }\n\n  destroy(): void {\n    // Ncessaire pour viter les fuites de mmoire des exercices HTML\n  }\n\n  nouvelleVersionWrapper = exportedNouvelleVersionWrapper.bind(\n    this as IExercice,\n  )\n\n  correctionInteractive?(i: number): string | string[]\n\n  nouvelleVersion(numeroExercice?: number, numeroQuestion?: number): void {\n    console.info(numeroExercice)\n  }\n\n  reinit = exportedReinit.bind(this as unknown as IExerciceSimple)\n\n  applyNewSeed = exportedApplyNewSeed.bind(this as IExercice)\n\n  questionJamaisPosee = (\n    i: number,\n    ...args: (string | number | IFractionEtendue | Decimal)[]\n  ): boolean => {\n    return (\n      exportedQuestionJamaisPosee.bind(this as IExercice)(i, ...args) || false\n    )\n  }\n}\n","import type { IExerciceQcmOptions } from '../lib/types'\nimport Exercice from './Exercice'\n\nexport default class ExerciceSimple extends Exercice {\n  distracteurs: (string | number)[]\n  typeExercice: 'simple'\n  versionQcmDisponible?: boolean // Pour les exercices de type simple, si des distracteurs sont dfinis, on peut proposer une version QCM\n  versionQcm?: boolean // Seulement pour les exercices de type simple, version QCM active si 'true'\n  versionQcmOptions?: IExerciceQcmOptions\n  constructor() {\n    super()\n    this.distracteurs = []\n    this.typeExercice = 'simple'\n  }\n\n  get key(): string {\n    return [\n      this.nbQuestions,\n      this.interactif,\n      this.sup,\n      this.sup2,\n      this.sup3,\n      this.sup4,\n      this.sup5,\n      this.seed,\n      this.correctionDetaillee,\n      this.versionQcm,\n    ].join('_')\n  }\n}\n","import { context } from '../../modules/context'\n\n/**\n * Renvoie le html ou le latex qui met les 2 chaines de caractres fournies sur 2 colonnes diffrentes\n * @author Rmi Angot\n * @param {string} cont1 - Contenu de la premire colonne\n * @param {string} cont2 - Contenu de la deuxime colonne\n * @param {number} [largeur1=50] Largeur de la premire colonne\n * @return {string}\n */\nexport function deuxColonnes(cont1, cont2, largeur1 = 50) {\n  if (context.isHtml) {\n    return `\n    <div>\n    <div class=\"question\" style=\"float:left;max-width: ${largeur1}%;margin-right: 30px\">\n    ${cont1}\n   </div>\n   <div style=\"float:left; max-width: ${90 - largeur1}%\">\n    ${cont2}\n   </div>\n   <div style=\"clear:both\"></div>\n   <div class=\"ui hidden divider\"></div>\n   </div>\n`\n  } else {\n    return `\\\\begin{multicols}{2}\n    ${cont1.replaceAll('<br>', '\\\\\\\\\\n')}\n\n    ${cont2.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{multicols}\n`\n  }\n}\n\n/**\n * Renvoie le html ou le latex qui met les 2 chaines de caractres fournies sur 2 colonnes diffrentes\n * @author Nathan Scheinmann\n * @param {string} cont1 - Contenu de la premire colonne\n * @param {string} cont2 - Contenu de la deuxime colonne\n * @param {string} cont3 - Contenu de la deuxime colonne\n * @param {number} [largeur1=33] Largeur de la premire colonne\n * @param {number} [largeur2=33] Largeur de la premire colonne\n * @return {string}\n */\nexport function troisColonnes(\n  cont1,\n  cont2,\n  cont3,\n  largeur1 = 33,\n  largeur2 = 33,\n) {\n  if (context.isHtml) {\n    return `\n    <div>\n      <div class=\"question\" style=\"float:left;max-width: ${largeur1}%;margin-right: 10px;\">\n        ${cont1}\n      </div>\n      <div style=\"float:left; max-width: ${largeur2}%;margin-right: 10px;\">\n        ${cont2}\n      </div>\n      <div style=\"float:left; max-width: ${100 - largeur1 - largeur2}%;margin-right: 10px;\">\n        ${cont3}\n      </div>\n      <div style=\"clear:both\"></div>\n      <div class=\"ui hidden divider\"></div>\n    </div>\n    `\n  } else {\n    return `\\\\begin{multicols}{3}\n    ${cont1.replaceAll('<br>', '\\\\\\\\\\n')}\n\n    ${cont2.replaceAll('<br>', '\\\\\\\\\\n')}\n\n    ${cont3.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{multicols}\n    `\n  }\n}\n/**\n * Renvoie le html ou le latex qui met les 2 chaines de caractres fournies sur 2 colonnes diffrentes\n * Si en sortie html, il n'y a pas assez de places alors on passe en momocolonne !\n * @author Mickael Guironnet\n * @param {string} cont1 - Contenu de la premire colonne\n * @param {string} cont2 - Contenu de la deuxime colonne\n * @param {{eleId?: string, largeur1: number, widthmincol1: string, widthmincol2: string, stylecol1?: string, stylecol2?: string}} options\n *          eleId : identifiant ID pour retrouver la colonne\n *          largeur1 : largeur de la premire colonne en latex en pourcentage\n *          widthmincol1 : largeur de la premire minimum en html en px\n *          widthmincol2 : largeur de la deuxime minimum en html en px\n *  ex : deuxColonnesResp (enonce, correction, {eleId : '1_1', largeur1:50, widthmincol1: '400px', widthmincol2: '200px'})\n * @return {string}\n */\nexport function deuxColonnesResp(cont1, cont2, options) {\n  if (options === undefined) {\n    options = { largeur1: 50 }\n  } else if (typeof options === 'number') {\n    options = { largeur1: options }\n  }\n  if (options.largeur1 === undefined) {\n    options.largeur1 = 50\n  }\n  if (options.stylecol1 === undefined) {\n    options.stylecol1 = ''\n  }\n  if (options.stylecol2 === undefined) {\n    options.stylecol2 = ''\n  }\n  if (options.widthmincol1 === undefined) {\n    options.widthmincol1 = '0px'\n  }\n  if (options.widthmincol2 === undefined) {\n    options.widthmincol2 = '0px'\n  }\n\n  if (context.isHtml) {\n    return `\n    <style>\n    .cols-responsive {\n      max-width: 1200px;\n      margin: 0 auto;\n      display: grid;\n      grid-gap: 1rem;\n    }\n    /* Screen larger than 900px? 2 column */\n    @media (min-width: 900px) {\n      .cols-responsive { grid-template-columns: repeat(2, 1fr); }\n    }\n    </style>\n    <div class='cols-responsive'>\n      <div id='cols-responsive1-${options.eleId}'style='min-width:${options.widthmincol1};${options.stylecol1}' >\n      ${cont1}\n      </div>\n      <div id='cols-responsive2-${options.eleId}' style='min-width:${options.widthmincol2};${options.stylecol2}' >\n      ${cont2}\n      </div>\n    </div>\n`\n  } else {\n    return `\\\\begin{minipage}{${options.largeur1 / 100}\\\\linewidth}\n    ${cont1.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{minipage}\n    \\\\begin{minipage}{${(100 - options.largeur1) / 100}\\\\linewidth}\n    ${cont2.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{minipage}\n    `\n  }\n}\n\n/**\n *\n * @param {string} texte\n * @returns le texte centr dans la page selon le contexte.\n * @author Jean-Claude Lhote\n */\nexport function centrage(texte) {\n  return context.isHtml\n    ? `<center>${texte}</center>`\n    : `\\\\begin{center}\\n \\t${texte}\\n \\\\end{center}\\n`\n}\n\n/**\n * Renvoie un environnent LaTeX multicolonnes\n * @author Rmi Angot\n */\nexport function texMulticols(texte, nbCols = 2) {\n  let result\n  if (nbCols > 1) {\n    result =\n      '\\\\begin{multicols}{' + nbCols + '}\\n' + texte + '\\n\\\\end{multicols}'\n  } else {\n    result = texte\n  }\n  return result\n}\n\n/**\n * Centre un texte\n *\n * @author Rmi Angot\n */\nexport function texteCentre(texte) {\n  if (context.isHtml) {\n    return `<p style=\"text-align: center\">${texte}</p>`\n  } else {\n    return `\\\\begin{center}\n${texte}\n\\\\end{center}`\n  }\n}\n","import Decimal from 'decimal.js'\nimport { texMulticols } from '../lib/format/miseEnPage'\nimport {\n  combinaisonListes,\n  combinaisonListesSansChangerOrdre,\n  compteOccurences,\n  enleveDoublonNum,\n} from '../lib/outils/arrayOutils'\nimport { arrondi, rangeMinMax } from '../lib/outils/nombres'\nimport type { IExercice } from '../lib/types'\nimport { context } from './context'\nimport type { IFractionEtendue } from './FractionEtendue.type'\n\n// Garde structurel pour dtecter une FractionEtendue\nconst isFractionEtendue = (x: unknown): x is IFractionEtendue =>\n  typeof x === 'object' &&\n  x !== null &&\n  typeof (x as any).sommeFraction === 'function'\n\nexport const epsilon = 0.000001\n\n/**\n * Affecte les proprits contenues et contenuCorrection (d'aprs les autres proprits de l'exercice)\n * @param {Exercice} exercice\n */\nexport function listeQuestionsToContenu(exercice: IExercice) {\n  let vspace = ''\n  if (exercice.vspace) {\n    vspace = `\\\\vspace{${exercice.vspace} cm}\\n`\n  }\n  if (!context.isAmc) {\n    exercice.contenu =\n      texConsigne(exercice.consigne) +\n      vspace +\n      texIntroduction(exercice.introduction) +\n      texMulticols(\n        texEnumerate(exercice.listeQuestions, exercice.spacing),\n        exercice.nbCols,\n      )\n  }\n  exercice.contenuCorrection =\n    texConsigne('') +\n    texIntroduction(exercice.consigneCorrection) +\n    texMulticols(\n      texEnumerate(exercice.listeCorrections, exercice.spacingCorr),\n      exercice.nbColsCorr,\n    )\n  exercice.contenuCorrection = exercice.contenuCorrection.replace(\n    /\\\\\\\\\\n*/g,\n    '\\\\\\\\\\n',\n  )\n  // console.log(exercice.contenu) // Pour rcuprer le code latex des exos pour les cahiers de vacances\n  exercice.contenu = exercice.contenu?.replace(/\\\\\\\\\\n*/g, '\\\\\\\\\\n')\n}\n\n/**\n * Utilise liste_questions et liste_corrections pour remplir contenu et contenuCorrection\n * La liste des questions devient une liste HTML ou LaTeX avec html_ligne() ou tex_paragraphe()\n * @param {Exercice} exercice\n * @param {boolean} retourCharriot\n * @author Rmi Angot\n */\nexport function listeQuestionsToContenuSansNumero(\n  exercice: IExercice,\n  retourCharriot = true,\n) {\n  const supprimerReferenceCheckbox = document.getElementById(\n    'supprimer_reference',\n  )\n  if (\n    supprimerReferenceCheckbox &&\n    supprimerReferenceCheckbox instanceof HTMLInputElement &&\n    supprimerReferenceCheckbox.checked === true\n  ) {\n    exercice.contenu =\n      texConsigne(exercice.consigne) +\n      texIntroduction(exercice.introduction) +\n      texMulticols(\n        texParagraphe(\n          exercice.listeQuestions,\n          exercice.spacing,\n          retourCharriot,\n        ),\n        exercice.nbCols,\n      )\n  } else {\n    exercice.contenu =\n      texConsigne(exercice.consigne) +\n      `\\n\\\\marginpar{\\\\footnotesize ${exercice.id}}` +\n      texIntroduction(exercice.introduction) +\n      texMulticols(\n        texParagraphe(\n          exercice.listeQuestions,\n          exercice.spacing,\n          retourCharriot,\n        ),\n        exercice.nbCols,\n      )\n  }\n  // exercice.contenuCorrection = texConsigne(exercice.consigneCorrection) + texMulticols(texEnumerateSansNumero(exercice.listeCorrections,exercice.spacingCorr),exercice.nbColsCorr)\n  exercice.contenuCorrection =\n    texConsigne(exercice.consigneCorrection) +\n    texMulticols(\n      texParagraphe(\n        exercice.listeCorrections,\n        exercice.spacingCorr,\n        retourCharriot,\n      ),\n      exercice.nbColsCorr,\n    )\n}\n\n/**\n * Contraint une valeur  rester dans un intervalle donn. Si elle est trop petite, elle prend la valeur min, si elle est trop grande elle prend la valeur max\n * @author Jean-Claude Lhote  partir du code d'Eric Elter\n * @param {number|string} min borne infrieure\n * @param {number|string} max borne suprieure\n * @param {number|string} valeur la valeur  contraindre\n * @param {number|string} defaut valeur par dfaut si non entier\n */\nexport function contraindreValeur(\n  min: number,\n  max: number,\n  valeur: string | number,\n  defaut: number,\n) {\n  // if (isNaN(min) || isNaN(max) || (defaut !== undefined && isNaN(defaut))) { // Rajout de Remi\n  if (isNaN(min) || isNaN(max) || isNaN(defaut)) {\n    throw Error(\n      `Erreur dans contraindreValeur : un des paramtres de contrainte est NaN : ${[\n        'min : ' + String(min) + ' ',\n        max,\n        valeur,\n        defaut,\n      ].reduce(\n        (accu, value, index) =>\n          String(accu) +\n          ['min', ',max', ',valeur', ',defaut'][index] +\n          ' : ' +\n          String(value) +\n          ' ',\n      )}`,\n    )\n  }\n  return !isNaN(Number(valeur))\n    ? Number(valeur) < Number(min)\n      ? Number(min)\n      : Number(valeur) > Number(max)\n        ? Number(max)\n        : Number(valeur)\n    : Number(defaut)\n}\n\ntype GestionnaireFormulaireTexteParams = {\n  saisie: string | number\n  min?: number\n  max: number\n  defaut: number\n  listeOfCase?: string[] | number[]\n  shuffle?: boolean\n  nbQuestions: number\n  melange: number\n  enleveDoublons?: boolean\n  exclus?: number[]\n}\n\n/**\n * @param {Object} params - Les paramtres de la fonction\n * @param {string|number} params.saisie - Ce qui vient du formulaireTexte donc une srie de nombres spars par des tirets ou un seul nombre (normalement en string) ou rien\n * @param {number?} [params.min=1]\n * @param {number} params.max - Obligatoirement >min\n * @param {number} params.defaut - Obligatoirement compris entre min et max inclus ou alors gal  melange\n * @param {string[] | number[]} [params.listeOfCase] - La liste des valeurs  mettre dans la liste en sortie. Si aucune liste n'est fournie, ce sont les nombres qui seront dans la liste. La premire valeur de listeOfCase correspond  la saisie numrique min et listeOfCase doit contenir max-min+1 valeurs\n * @param {boolean} [params.shuffle=true] - Si true, on brasse la liste en sortie sinon on garde l'ordre\n * @param {number} params.nbQuestions - Obligatoire : c'est la taille de la liste en sortie. Si 0, alors le nbQuestions correspond  la longueur de saisie.\n * @param {number} params.melange - La valeur utilise pour l'option mlange\n * @param {boolean} [params.enleveDoublons=false] - Si true, la liste en sortie ne peut pas contenir deux fois la mme valeur\n * @param {number[]} [params.exclus] - Liste de valeurs  exclure entre min et max\n */\nexport function gestionnaireFormulaireTexte(\n  params: GestionnaireFormulaireTexteParams,\n) {\n  let {\n    saisie,\n    min = 1,\n    max,\n    defaut,\n    listeOfCase,\n    shuffle = true,\n    nbQuestions,\n    melange = 0,\n    enleveDoublons = false,\n    exclus,\n  } = params\n  if (exclus) {\n    exclus = exclus.filter((element) => element >= min && element <= max)\n  }\n  if (max == null || isNaN(max) || max < min)\n    throw Error(\n      'La fonction gestionnaireFormulaireTexte rclame un paramtre max de type number',\n    )\n  if (\n    defaut == null ||\n    isNaN(defaut) ||\n    (defaut < min && defaut !== melange) ||\n    (defaut > max && defaut !== melange)\n  )\n    throw Error(\n      `La fonction gestionnaireFormulaireTexte rclame un paramtre defaut (ici, ${defaut}) compris entre min (ici, ${min}) et max (ici, ${max})`,\n    )\n  let listeIndex, listeIndexProvisoire\n  listeIndex = []\n  if (\n    typeof saisie === 'boolean' ||\n    saisie === '' ||\n    saisie === null ||\n    saisie === undefined\n  ) {\n    // Si aucune liste n'est saisie\n    listeIndex = [defaut]\n  } else {\n    if (typeof saisie === 'number' || Number.isInteger(saisie)) {\n      // Si c'est un nombre, c'est que le nombre a t saisi dans la barre d'adresses\n      listeIndex = [\n        contraindreValeur(\n          Math.min(min, melange ?? min),\n          Math.max(max, melange ?? max),\n          saisie,\n          defaut,\n        ),\n      ]\n    } else {\n      listeIndexProvisoire = saisie.split('-') // Sinon on cre un tableau  partir des valeurs spares par des tirets\n      for (let i = 0; i < listeIndexProvisoire.length; i++) {\n        // on a un tableau avec des strings : ['1', '1', '2']\n        if (!isNaN(parseInt(listeIndexProvisoire[i]))) {\n          listeIndex.push(\n            contraindreValeur(\n              Math.min(min, melange ?? min),\n              Math.max(max, melange ?? max),\n              parseInt(listeIndexProvisoire[i]),\n              defaut,\n            ),\n          )\n        } // parseInt en fait un tableau d'entiers\n      }\n    }\n  }\n  if (listeIndex.length === 0) listeIndex = [defaut] // EE : Le cas o finalement listeIndex est vide car la saisie n'tait pas un paramtre attendu.\n\n  if (exclus && exclus.length > 0) {\n    listeIndex = listeIndex.filter((element) => !exclus.includes(element))\n  }\n  if (listeIndex.length === 0) listeIndex = [defaut] // EE : Le cas o finalement listeIndex est vide car la saisie n'tait pas un paramtre attendu.\n\n  if (melange != null && compteOccurences(listeIndex, melange)) {\n    listeIndex = rangeMinMax(min, max, exclus)\n  }\n  if (nbQuestions === 0) {\n    nbQuestions = listeIndex.length\n  } else {\n    nbQuestions = Math.min(nbQuestions, 100) // Faut pas dconner, un jour quelqu'un a fait pter la fonction en demandant une liste de 10000 questions !\n  }\n  listeIndex = shuffle\n    ? combinaisonListes(listeIndex, nbQuestions)\n    : combinaisonListesSansChangerOrdre(listeIndex, nbQuestions)\n\n  const Max = Math.max(...listeIndex)\n  if (enleveDoublons) listeIndex = enleveDoublonNum(listeIndex)\n  if (Array.isArray(listeOfCase)) {\n    // si une listeOfCase est fournie, on retourne la liste des valeurs construites avec listeIndex\n    if (listeOfCase.length < Max)\n      throw Error(\n        'La liste de cas fournie ne contient pas assez de valeurs par rapport  max',\n      )\n    return listeIndex.map((el) => listeOfCase[el - min]).slice(0, nbQuestions)\n  }\n  return listeIndex.slice(0, nbQuestions)\n}\n\n/** Retourne un nombre dcimal entre a et b, sans tre trop prs de a et de b\n * @param {number} a borne infrieure\n * @param {number} b borne suprieure\n * @author Eric Elter\n * @returns {number}\n */\nexport function entreDeux(a: number, b: number) {\n  if (a < b) return arrondi(a + ((b - a) * randint(10, 90)) / 100, 2)\n  else return arrondi(b + ((a - b) * randint(10, 90)) / 100, 2)\n}\n\n/**\n * Compare deux nombres (pour les nombres en virgule flottante afin d'viter les effets de la conversion en virgule flottante).\n * Devient compatible avec les FractionEtendue le 7/05/2024 en comparant leur valeur dcimale\n * Pour les Decimal, la conversion automatique en number doit fonctionner.\n * @author Jean-Claude Lhote\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function egal(\n  a: number | IFractionEtendue,\n  b: number | IFractionEtendue,\n  tolerance = epsilon,\n) {\n  tolerance = tolerance === 0 ? 1e-10 : tolerance\n  if (isFractionEtendue(a)) a = a.valeurDecimale\n  if (isFractionEtendue(b)) b = b.valeurDecimale\n  return Math.abs(a - b) <= tolerance\n}\n\n/**\n * Retourne true si le nombre a est infrieur  b\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function inferieur(a: number, b: number, tolerance = epsilon) {\n  return b - a > tolerance\n}\n\n/**\n * Retourne true si le nombre a est suprieur ou gal  b\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function superieurouegal(a: number, b: number, tolerance = epsilon) {\n  return a - b > tolerance || egal(a, b, tolerance)\n}\n\n/**\n * Retourne true si le nombre a est infrieur ou gal  b\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function inferieurouegal(a: number, b: number, tolerance = epsilon) {\n  return b - a > tolerance || egal(a, b, tolerance)\n}\n\n/**\n * Retourne true si le nombre a est entier ou \"presque\" entier\n * @param {number} a premier nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function estentier(a: number, tolerance = epsilon) {\n  if (typeof a !== 'number') window.notify('Erreur dans estEntier()', { a })\n  return Math.abs(a - Math.round(a)) < tolerance\n}\n\n/**\n * Retourne le quotient entier (donc sans le reste) de a/b si a & b sont entiers, false sinon\n * @param {number} a\n * @param {number} b\n * @return {number}\n */\nexport function quotientier(a: number, b: number) {\n  if (estentier(a) && estentier(b)) return Math.floor(a / b)\n  return Math.floor(Math.round(a) / Math.round(b))\n}\n\n/**\n * Retourne true si x est un carr parfait ( epsilon prs)\n * @param {number} x\n * @return {boolean}\n */\nexport function carreParfait(x: number) {\n  return estentier(Math.sqrt(x))\n}\n\n// Fonctions mathmatiques\n\n/**\n * Choisit un nombre au hasard entre min et max sans appartenir  liste\\_a\\_eviter.\n * @param {number} min\n * @param {number} max\n * @param {number | Array<number>} [listeAEviter] - Tous les lments que l'on souhaite supprimer\n * @return {number} Nombre au hasard entre min et max non compris dans la listeAEviter\n *\n * @example\n * // Renvoie 1, 2 ou 3\n * randint (1,3)\n * @example\n * // Renvoie -1 ou 1\n * randint(-1,1,[0])\n * @example\n * Renvoie 0 ou 1 ou 4 ou 6 ou 8 ou 9\n * randint(0,9, '2357') // mme rsultat avec randint(0,9, ['2','3','5','7']) ou randint(0,9, [2,3,5,7])\n * @author Rmi Angot\n * @see https://gist.github.com/pc035860/6546661\n */\nexport function randint(\n  min: number | Decimal,\n  max: number | Decimal,\n  listeAEviter: (number | Decimal | string)[] | string | number = [],\n) {\n  // Source : https://gist.github.com/pc035860/6546661\n  if (min instanceof Decimal) min = min.toNumber()\n  if (max instanceof Decimal) max = max.toNumber()\n  if (!Number.isInteger(min) || !Number.isInteger(max)) {\n    window.notify('Les min et max de randint doivent tre entiers', {\n      min,\n      max,\n    })\n    min = Math.floor(min)\n    max = Math.ceil(max)\n    if (max - min < 1) max = min + 1\n  }\n  const range = max - min\n  let rand = Math.floor(Math.random() * (range + 1))\n  if (typeof listeAEviter === 'string') {\n    listeAEviter = listeAEviter.split('')\n  }\n  if (typeof listeAEviter === 'number') {\n    if (Number.isInteger(listeAEviter)) {\n      listeAEviter = [listeAEviter]\n    } else {\n      window.notify(\n        \"Le nombre fourni  randint en exclusion n'est pas un entier\",\n        { listeAEviter },\n      )\n      listeAEviter = [listeAEviter] // ce n'est pas grave de mettre un nombre non entier, randint ne choisit que des entiers\n    }\n  }\n  if (Array.isArray(listeAEviter)) {\n    listeAEviter = listeAEviter\n      .map(Number)\n      .filter((el) => Math.round(el) === el) // on filtre les non-nombres et les non-entiers\n  } else {\n    window.notify(\n      \"La liste d'exclusion de randint n'est pas d'un type pris en compte\",\n      { listeAEviter },\n    )\n    listeAEviter = []\n  }\n  if (listeAEviter.length > 0) {\n    let cpt = 0\n    while (listeAEviter.includes(min + rand) && cpt < 50) {\n      // On met une condition de fin car si toutes les valeurs sont dans la liste  viter, ce serait une boucle infinie\n      rand = Math.floor(Math.random() * (range + 1))\n      cpt++\n    }\n    if (cpt === 50) {\n      window.notify(\n        `Randint n'a pas pu trouver de valeur en dehors de la liste  viter, c'est donc cette valeur qui a t choisie : ${min + rand}`,\n        { min, max, listeAEviter, rand },\n      )\n    }\n  }\n  return min + rand\n}\n\n// Fonction pour gnrer un nombre alatoire dans [a, b] (flottant)\n/**\n *\n * @param a : le minimim\n * @param b : le maximum\n * @author Jean-Claude Lhote\n * @returns un nombre alatoire entre a et b\n */\nexport const randFloat = (a: number, b: number, precision = 3): number => {\n  const diff = b - a\n  return (\n    Math.round((a + Math.random() * diff) * 10 ** precision) / 10 ** precision\n  )\n}\n\n/**\n * fonction qui retourne une chaine construite en concatnant les arguments\n * Le rle de cette fonction est de construire un identifiant unique de question\n * afin de contrler que l'alatoire ne produit pas deux questions identiques.\n * @author Jean-Claude Lhote\n */\nexport function checkSum(...args: (number | string)[]) {\n  let checkString = ''\n  for (let i = 0; i < args.length; i++) {\n    if (typeof args[i] === 'number') {\n      checkString += Number(args[i]).toString()\n    } else {\n      checkString += args[0]\n    }\n  }\n  return checkString\n}\n\n/**\n * Polyfill Object.fromEntries\n *\n * @see : https://gitlab.com/moongoal/js-polyfill-object.fromentries/\n */\nif (!Object.fromEntries) {\n  Object.defineProperty(Object, 'fromEntries', {\n    value(entries: Iterable<[string, any]>) {\n      if (!entries || typeof (entries as any)[Symbol.iterator] !== 'function') {\n        throw new Error(\n          'Object.fromEntries() requires a single iterable argument',\n        )\n      }\n      const o: Record<string, any> = {}\n      for (const [k, v] of entries as Iterable<[string, any]>) {\n        o[k] = v\n      }\n      return o\n    },\n  })\n}\n\n/*\nconst sansPrecision = (arrondir === undefined)\n  // if (sansPrecision) arrondir = 6\n  if (typeof x === 'string') {\n    window.notify('Calcul : Reoit une chaine de caractre et pas un nombre', { x })\n    x = parseFloat(evaluate(x))\n  }\n  if (sansPrecision && !egal(x, arrondi(x, arrondir), 10 ** (-arrondir - 1))) {\n    window.notify('calcul : arrondir semble avoir tronqu des dcimales sans avoir eu de paramtre de prcision', {\n      x,\n      arrondir\n    })\n  }\n  return parseFloat(x.toFixed(arrondir))\n}\n*/\n\n// Fonctions LaTeX\n\n/**\n * * Retourne un environnement LaTeX enumerate  partir d'une liste.\n * * `<br>`est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * * L'espacement est gnr avec spacing\n * @author Rmi Angot\n */\nexport function texEnumerate(liste: string[], spacing: number) {\n  let result = ''\n  if (liste.length > 1) {\n    result = '\\\\begin{enumerate}\\n'\n    if (spacing > 1) {\n      result += `\\\\begin{spacing}{${spacing}}\\n`\n    }\n    for (const i in liste) {\n      result += '\\t\\\\item ' + liste[i] + '\\n'\n    }\n    if (spacing > 1) {\n      result += '\\\\end{spacing}\\n'\n    }\n    result += '\\\\end{enumerate}\\n'\n  } else {\n    if (spacing > 1) {\n      result += `\\\\begin{spacing}{${spacing}}\\n`\n    }\n    result += liste[0] + '\\n'\n    if (spacing > 1) {\n      result += '\\\\end{spacing}\\n'\n    }\n  }\n  return result\n    .replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n    .replace(/<br>/g, '\\\\\\\\\\n')\n    .replace(//g, '\\\\euro{}')\n}\n\n/**\n * * Retourne un environnement LaTeX enumerate  partir d'une liste sans afficher les numros.\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * * L'espacement est gnr avec spacing\n * @author Rmi Angot\n */\nexport function texEnumerateSansNumero(liste: string[], spacing: number) {\n  // return texEnumerate(liste,spacing).replace('\\\\begin{enumerate}[label={}]','\\\\begin{enumerate}[label={}]')\n  return texEnumerate(liste, spacing).replace(\n    '\\\\begin{enumerate}',\n    '\\\\begin{enumerate}[label={}]',\n  )\n}\n\n/**\n * * Concatne les lments d'une liste avec un saut de ligne entre chaque lment\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * @author Rmi Angot\n */\nexport function texParagraphe(\n  liste: string[],\n  spacing: number = 0,\n  retourCharriot: boolean,\n) {\n  let result = ''\n  if (spacing > 1) {\n    result = `\\\\begin{spacing}{${spacing}}\\n`\n  }\n\n  for (const i in liste) {\n    if (retourCharriot) {\n      result += `\\t${liste[i]}\\\\\\\\\\n`\n    } else {\n      result += `\\t${liste[i]}\\n`\n    }\n  }\n  if (spacing > 1) {\n    result += '\\\\end{spacing}'\n  }\n  // les <br> peuvent tre 2 ou plus et peuvent tre spars par des sauts de ligne ou des espaces\n  return result\n    .replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n    .replace(/<br>/g, '\\\\\\\\\\n')\n    .replace(//g, '\\\\euro{}')\n}\n\n/**\n * * Recopie le texte.\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * @param {string} texte\n * @return {string}\n * @author Rmi Angot\n */\nexport function texIntroduction(texte: string) {\n  if (typeof texte === 'string' && texte !== '') {\n    return texte\n      .replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n      .replace(/<br>/g, '\\\\\\\\\\n')\n  } else {\n    return ''\n  }\n}\n\n/**\n * Renvoie une liste HTML ou LaTeX suivant le contexte\n *\n * @param liste une liste de questions\n * @param spacing interligne (line-height en css)\n * @author Rmi Angot\n */\nexport function enumerate(liste: string[], spacing: number) {\n  return texEnumerate(liste, spacing)\n}\n\n/**\n * Renvoie une liste sans puce ni numro HTML ou LaTeX suivant le contexte\n *\n * @param liste une liste de questions\n * @param spacing interligne (line-height en css)\n * @author Sbastien Lozano\n */\nexport function enumerateSansPuceSansNumero(liste: string[], spacing: number) {\n  return texEnumerate(liste, spacing).replace(\n    '\\\\begin{enumerate}',\n    '\\\\begin{enumerate}[label={}]',\n  )\n}\n\n/**\n * Renvoie \\exo{consigne}\n * @author Rmi Angot\n */\nexport function texConsigne(consigne: string) {\n  return (\n    (consigne != null && typeof consigne === 'string'\n      ? consigne.replace(/<br>/g, '\\\\\\\\')\n      : '') + '\\n\\n'\n  )\n}\n\n/**\n * @author Frdric Piou\n * @param {number} nb\n * @returns retourne un nombre au format franais sans espace aprs la virgule\n */\nexport function num(nb: number) {\n  if (typeof nb === 'number') {\n    return Intl.NumberFormat('fr-FR', { maximumFractionDigits: 20 })\n      .format(nb)\n      .toString()\n      .replace(/\\s+/g, '\\\\thickspace ')\n      .replace(',', '{,}')\n  } else {\n    window.notify(\"Fonction num() appele avec autre chose qu'un number\", {\n      nb,\n    })\n  }\n}\n\n/**\n * Affiche un lien vers une URL\n * @param {string} texte  afficher\n * @param {string} lien\n * @author Rmi Angot\n */\nexport function href(texte: string, lien: string) {\n  if (\n    typeof texte === 'string' &&\n    texte !== '' &&\n    typeof lien === 'string' &&\n    lien !== ''\n  ) {\n    if (context.isHtml) {\n      return `<a target=\"_blank\" href=${lien}> ${texte} </a>`\n    } else {\n      return `\\\\href{${lien}}{${texte}}`\n    }\n  }\n}\n\n/**\n * Retourne un environnement LaTeX itemize  partir d'une liste\n * @author Rmi Angot\n */\nexport function itemize(tableauDeTexte: string[]) {\n  if (\n    Array.isArray(tableauDeTexte) &&\n    tableauDeTexte.filter((el) => typeof el === 'string').length !== 0\n  ) {\n    let texte\n    if (context.isHtml) {\n      texte = '<div>'\n      for (let i = 0; i < tableauDeTexte.length; i++) {\n        texte += '<div>  ' + tableauDeTexte[i] + '</div>'\n      }\n      texte += '</div>'\n    } else {\n      texte = '\\t\\\\begin{itemize}\\n'\n      for (let i = 0; i < tableauDeTexte.length; i++) {\n        texte += '\\t\\t\\\\item ' + tableauDeTexte[i] + '\\n'\n      }\n      texte += '\\t\\\\end{itemize}'\n    }\n    return texte\n  } else {\n    window.notify(\n      \"Fonction itemize appele avec autre chose qu'un array de string\",\n      { tableauDeTexte },\n    )\n  }\n}\n/**\n * Retourne la factorielle d'un nombre\n *\n * @author Stphane Guyon\n *\n */\nexport function factorielle(num: number): number {\n  if (num === 0 || num === 1) return 1\n  return num * factorielle(num - 1)\n}\n","import { context } from '../../modules/context'\nimport { quotientier, randint } from '../../modules/outils'\n\n/**\n * Cr un string de nbsommets caractres dans l'ordre alphabtique et en majuscule qui ne soit pas dans la liste donne en 2e argument\n * @param {number} nbsommets\n * @param {string|string[]} listeAEviter\n * @author Rmi Angot\n * Ajout des while pour s'assurer de bien avoir des lettres majuscules le 08/05/2022 par Guillaume Valmont\n **/\nexport function creerNomDePolygone(\n  nbsommets: number,\n  listeAEviter: string | string[] = [],\n) {\n  let premiersommet = randint(65, 90 - nbsommets)\n  let polygone = ''\n  if (typeof listeAEviter === 'string') listeAEviter = Array.from(listeAEviter)\n  for (let i = 0; i < nbsommets; i++) {\n    let augmentation = i\n    while (premiersommet + augmentation > 90) augmentation -= 26\n    while (premiersommet + augmentation < 65) augmentation += 26\n    polygone += String.fromCharCode(premiersommet + augmentation)\n  }\n\n  if (listeAEviter.length <= 26 - nbsommets) {\n    // On vite la liste  viter si elle n'est pas trop grosse sinon on n'en tient pas compte\n    let cpt = 0\n    while (possedeUnCaractereInterdit(polygone, listeAEviter) && cpt < 20) {\n      polygone = ''\n      premiersommet = randint(65, 90 - nbsommets)\n      for (let i = 0; i < nbsommets; i++) {\n        polygone += String.fromCharCode(premiersommet + i)\n      }\n      cpt++ // Au bout de 20 essais, on laisse tomber la liste  viter\n    }\n  } else {\n    console.info(\n      'Trop de questions donc plusieurs polygones peuvent avoir le mme nom',\n    )\n  }\n  return polygone\n}\n\n/**\n * Vrifie dans un texte si un de ses caractres appartient  une liste  viter\n * @author Rmi Angot\n */\nexport function possedeUnCaractereInterdit(\n  texte: string,\n  listeAEviter: string[],\n) {\n  let result = false\n  for (const motAeviter of listeAEviter) {\n    for (let i = 0; i < motAeviter.length; i++) {\n      if (texte.indexOf(motAeviter[i]) > -1) {\n        result = true\n      }\n    }\n  }\n  return result\n}\n\n/**\n * Renvoie une lettre majuscule depuis un nombre compris entre 1 et 702\n * Le 2e paramtre est un boolen qui permet d'viter la lettre D (et donc dcale tout d'une lettre aprs le C) en vue du bug de MathLive\n * @author Rmi Angot\n *@Example\n * // 0 -> @ 1->A ; 2->B...\n * // 27->AA ; 28 ->AB ...\n */\nexport function lettreDepuisChiffre(i: number, saufD = false) {\n  let result = ''\n  if (i <= 26) {\n    result = String.fromCharCode(64 + i)\n    if (saufD && i >= 4) result = String.fromCharCode(64 + i + 1)\n  } else {\n    if (i % 26 === 0) {\n      result = String.fromCharCode(64 + Math.floor(i / 26) - 1)\n      result += String.fromCharCode(64 + 26)\n    } else {\n      result = String.fromCharCode(64 + Math.floor(i / 26))\n      result += String.fromCharCode(64 + (i % 26))\n    }\n  }\n  return result\n}\n\n/**\n * Renvoie une lettre minuscule depuis un nombre compris entre 1 et 702\n * @author Rmi Angot\n *@Example\n * // 0 -> @ 1->a ; 2->b...\n * // 27->aa ; 28 ->ab ...\n */\nexport function lettreMinusculeDepuisChiffre(i: number) {\n  return lettreDepuisChiffre(i).toLowerCase()\n}\n\n/**\n * Renvoie une lettre majuscule (ventuellement indice) depuis un nombre compris entre 1 et... sans limite.\n * @author Eric Elter\n *@Example\n * // 0 -> @ 1->A ; 2->B...\n * // 27->A_1 ; 28 ->A_2 ...\n */\nexport function lettreIndiceeDepuisChiffre(i: number) {\n  const indiceLettre =\n    quotientier(i - 1, 26) === 0 ? '' : quotientier(i - 1, 26)\n  return (\n    String.fromCharCode(64 + ((i - 1) % 26) + 1) +\n    (i > 26 ? `_{${indiceLettre}}` : '')\n  )\n}\n\n/**\n * Renvoie une lettre minuscule (ventuellement indice) depuis un nombre compris entre 1 et... sans limite.\n * @author EricElter\n *@Example\n * // 0 -> @ 1->a ; 2->b...\n * // 27->a_1 ; 28 ->a_2 ...\n */\nexport function lettreIndiceeMinusculeDepuisChiffre(i: number) {\n  return lettreIndiceeDepuisChiffre(i).toLowerCase()\n}\n\n/**\n * Renvoie un espace inscable pour le mode texte suivant la sortie html ou Latex.\n * @author Jean-Claude Lhote\n */\nexport function sp(nb = 1) {\n  let s = ''\n  for (let i = 0; i < nb; i++) {\n    if (context.isHtml) s += '&nbsp;'\n    else s += '\\\\,'\n  }\n  return s\n}\n\nexport function insertCharInString(str: string, index: number, char: string) {\n  return str.substring(0, index) + char + str.substring(index, str.length)\n}\n\n/**\n * Convertit en majuscule la premire lettre\n * @author Rmi Angot\n */\nexport function premiereLettreEnMajuscule(text: string) {\n  if (typeof text === 'string' && text.length > 0)\n    return (text + '').charAt(0).toUpperCase() + text.substring(1)\n  else return ''\n}\n\n/**\n * Cre une liste de questions alphabtique\n * @param {number} k valeur numrique\n * @author Sbastien Lozano (Rajout par EE, l'opportunit d'enlever l'espace final qui est par dfaut)\n */\nexport function numAlpha(k: number, nospace = false) {\n  if (context.isHtml)\n    return (\n      '<span style=\"color:#f15929; font-weight:bold\">' +\n      String.fromCharCode(97 + k) +\n      ')' +\n      (nospace ? '' : '&nbsp;') +\n      '</span>'\n    )\n  else\n    return (\n      '\\\\textbf {' + String.fromCharCode(97 + k) + '.}' + (nospace ? '' : ' ')\n    )\n}\n\n/**\n * Cre une liste de questions numrique\n * @param {number} k valeur numrique\n * @author Eric Elter\n */\nexport function numAlphaNum(k: number, nospace = false) {\n  k = k + 1\n  if (context.isHtml)\n    return (\n      '<span style=\"color:#f15929; font-weight:bold\">' +\n      k +\n      ')' +\n      (nospace ? '' : '&nbsp;') +\n      '</span>'\n    )\n  else return '\\\\textbf {' + k + '.}' + (nospace ? '' : ' ')\n}\n\nexport function reverseString(s: string) {\n  let str = ''\n  for (let i = 0; i < s.length; i++) {\n    str += s[s.length - 1 - i]\n  }\n  return str\n}\n","import Decimal from 'decimal.js'\nimport { stringNombre, texNombre } from '../lib/outils/texNombre'\nimport type { IGrandeur } from '../lib/types'\n\n/**\n * @class\n * @param {number|Decimal} mesure\n * @param {string} unite (cm, cm^2, m^3, L, kg, m/s, km/h, hhmmss, hdec, mindec, a, ha, ...)\n * Keeps existing behavior and adds vitesse & dure conversions.\n * @author Jean-Claude Lhote et Sbastien Lozano, Nathan Scheinmann (ajout des unit de vitesse et de dure)\n */\nclass Grandeur implements IGrandeur {\n  mesureDecimal: Decimal\n  unite: string\n  puissanceUnite: number\n  uniteDeReference: string\n  prefixe: string\n  puissancePrefixe: number\n\n  constructor(mesure: number | Decimal, unite: string) {\n    this.mesureDecimal =\n      mesure instanceof Decimal ? mesure : new Decimal(mesure)\n    this.unite = unite\n    const uniteParsee = parseUnite(unite)\n    this.puissanceUnite = uniteParsee.puissanceUnite\n    this.uniteDeReference = uniteParsee.uniteDeReference\n    this.prefixe = uniteParsee.prefixe\n    this.puissancePrefixe = uniteParsee.puissancePrefixe\n  }\n\n  get mesure() {\n    return this.mesureDecimal.toNumber()\n  }\n\n  set mesure(mesure: number) {\n    this.mesureDecimal = new Decimal(mesure)\n  }\n\n  /**\n   * Conversion rules preserved + extended:\n   * - Same reference unit with SI prefixes (existing)\n   * - m^3  L (existing)\n   * - m^2  a/ha (existing)\n   * - NEW: vitesse (m/s  km/h)\n   * - NEW: dure (hhmmss  hdec  mindec) [base = seconds]\n   * @param {string} uniteConversion\n   * @returns {Grandeur}\n   */\n  convertirEn(uniteConversion: string) {\n    const uniteConversionParsee = parseUnite(uniteConversion)\n\n    // ===== NEW: vitesse (m/s <-> km/h) =====\n    if (isVitesseUnit(this.unite) && isVitesseUnit(uniteConversion)) {\n      const baseMps = toMps(this.mesureDecimal, this.unite) //  m/s\n      const cible = fromMps(baseMps, uniteConversion) //  m/s -> target\n      return new Grandeur(cible, uniteConversion)\n    }\n\n    // ===== NEW: dure (hhmmss <-> hdec <-> mindec) =====\n    if (isDureeUnit(this.unite) && isDureeUnit(uniteConversion)) {\n      const baseSeconds = toSecondsDuree(this.mesureDecimal, this.unite) //  s\n      const cible = fromSecondsDuree(baseSeconds, uniteConversion) //  s -> target unit\n      return new Grandeur(cible, uniteConversion)\n    }\n\n    // ===== Existing logic kept below =====\n    if (\n      uniteConversionParsee.puissanceUnite === this.puissanceUnite &&\n      uniteConversionParsee.uniteDeReference === this.uniteDeReference\n    ) {\n      // Same underlying unit (e.g., m  cm, m^2  cm^2, g  kg, etc.)\n      // factor = 10^((p_src - p_dst)*power)\n      const exp = new Decimal(this.puissancePrefixe)\n        .minus(uniteConversionParsee.puissancePrefixe)\n        .times(this.puissanceUnite)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), uniteConversion)\n    } else if (\n      uniteConversionParsee.uniteDeReference === 'm^3' &&\n      this.uniteDeReference === 'L'\n    ) {\n      // Tout en litres -> m^3\n      // src in L-derivatives to m^3: exp = (p_src - p_dst - 3)*power\n      const exp = new Decimal(this.puissancePrefixe)\n        .minus(uniteConversionParsee.puissancePrefixe)\n        .minus(3)\n        .times(this.puissanceUnite)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'L') // keep target doc behavior (existing)\n    } else if (\n      uniteConversionParsee.uniteDeReference === 'L' &&\n      this.uniteDeReference === 'm^3'\n    ) {\n      // Tout en m^3 -> L\n      // exp = p_src*power + 3\n      const exp = new Decimal(this.puissancePrefixe)\n        .times(this.puissanceUnite)\n        .plus(3)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'm^3') // keep target doc behavior (existing)\n    } else if (\n      uniteConversionParsee.uniteDeReference === 'm^2' &&\n      this.uniteDeReference === 'a'\n    ) {\n      // a/ha -> m^2\n      // a = 100 m^2 ; ha = 10000 m^2\n      const exp = new Decimal(this.puissancePrefixe).plus(2)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'm^2')\n    } else if (\n      uniteConversionParsee.uniteDeReference === 'a' &&\n      this.uniteDeReference === 'm^2'\n    ) {\n      // m^2 -> a/ha\n      const exp = new Decimal(this.puissancePrefixe)\n        .times(this.puissanceUnite)\n        .minus(2)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'a')\n    } else {\n      throw new Error(\n        `Conversion impossible de ${this.unite} en ${uniteConversion}`,\n      )\n    }\n  }\n\n  estEgal(unite2: Grandeur) {\n    if (unite2.uniteDeReference !== this.uniteDeReference) return false\n    try {\n      const u1 = this.convertirEn(this.uniteDeReference)\n      const u2 = unite2.convertirEn(this.uniteDeReference)\n      if (u1 && u2) {\n        return u1.mesure === u2.mesure\n      } else {\n        return false\n      }\n    } catch (error) {\n      console.error(error)\n      return false\n    }\n  }\n\n  /**\n   * La prcision est donne dans l'unit la plus petite des deux grandeurs\n   */\n  estUneApproximation(unite2: Grandeur, precision: number) {\n    if (unite2.uniteDeReference !== this.uniteDeReference) return false\n    try {\n      let u1: Grandeur\n      let u2: Grandeur\n      if (this.puissancePrefixe > unite2.puissancePrefixe) {\n        u1 = this.convertirEn(unite2.unite)\n        u2 = unite2\n      } else {\n        u1 = this.convertirEn(this.unite)\n        u2 = unite2.convertirEn(this.unite)\n      }\n      if (u1 !== undefined && u2 !== undefined) {\n        return Math.abs(u1.mesure - u2.mesure) <= precision\n      } else {\n        return false\n      }\n    } catch (error) {\n      console.error(error)\n      return false\n    }\n  }\n\n  /**\n   * Retourne une chane :\n   * - valeurs usuelles : '12,345 cm'\n   * - NEW dure hhmmss : '3 h 45 min 28 s'\n   */\n  toString(precision = 12) {\n    if (this.unite === 'hhmmss') {\n      return formatHHMMSS(this.mesureDecimal)\n    }\n    const nbChiffrePartieDecimale = String(this.mesure).split('.')[1]?.length\n    if (nbChiffrePartieDecimale < precision) precision = nbChiffrePartieDecimale\n    return `${stringNombre(this.mesure, precision).replace('.', ',')}\\u202f${this.unite}`\n  }\n\n  /**\n   * Retourne une chane LaTeX :\n   * - valeurs usuelles : '12,345\\\\text{ cm}'\n   * - NEW dure hhmmss : '3~\\\\text{h} 45~\\\\text{min} 28~\\\\text{s}'\n   */\n  toTex(precision = 12) {\n    if (isDureeUnit(this.unite)) {\n      const sec = toSecondsDuree(this.mesureDecimal, this.unite) // Decimal seconds\n      return formatDureeTexHMS(sec)\n    }\n    return `${texNombre(this.mesure, precision).replace('.', ',')}~\\\\text{${this.unite}}`\n  }\n\n  get latexUnit() {\n    if (isVitesseUnit(this.unite) || isDureeUnit(this.unite)) {\n      // vitesse/dure: render raw unit (already human-friendly)\n      return `\\\\text{${this.unite}}`\n    }\n    return `\\\\text{${this.prefixe}${this.uniteDeReference.split('^')[0]}}${this.puissanceUnite === 1 ? '' : `^{${this.puissanceUnite.toString()}}`}`\n  }\n\n  /**\n   * Cre une grandeur  partir d'un texte '1 cm', '2 m^2', '3~\\\\text{L}'...\n   * (existing behavior kept; not parsing hh:mm:ss literal)\n   */\n  static fromString(text: string) {\n    text = text.replace('\\\\,', '')\n    text = text.replace('~', '')\n    text = text.replace(',', '.')\n    text = text.replace(' ', '')\n    text = text.replace(/\\\\text{([^}]+)}/g, '$1')\n    const mesure = parseFloat(text)\n    const unite = text.replace(String(mesure), '')\n    const grandeur = new Grandeur(mesure, unite)\n    return grandeur\n  }\n\n  /**\n   * Cre une grandeur de dure  partir d'une chane \"HH:MM:SS\" ou \"HHMMSS\".\n   * La valeur interne est stocke en secondes, unit = \"hhmmss\".\n   */\n  static fromHHMMSS(text: string): Grandeur {\n    const seconds = hhmmssToSeconds(text) // helper already defined below\n    return new Grandeur(seconds, 'hhmmss')\n  }\n\n  /**\n   * Retourne toujours la valeur convertie en HH:MM:SS (string).\n   * Utile mme si la grandeur n'est pas dj en \"hhmmss\".\n   */\n  toHHMMSS(): string {\n    if (!isDureeUnit(this.unite)) {\n      throw new Error(\n        `Impossible d'appeler toHHMMSS() sur une grandeur qui n'est pas une dure (unit: ${this.unite})`,\n      )\n    }\n    // convertir vers hhmmss si besoin\n    const enSecondes = toSecondsDuree(this.mesureDecimal, this.unite)\n    return formatHHMMSS(enSecondes)\n  }\n}\n\nexport default Grandeur\n\n// =======================================================\n// ===== Helpers: units, parsing, vitesse & dure logic ===\n// =======================================================\n\nfunction isVitesseUnit(u: string) {\n  return u === 'm/s' || u === 'km/h'\n}\n\nfunction isDureeUnit(u: string) {\n  return u === 'hhmmss' || u === 'hdec' || u === 'mindec' || u === 'sec'\n}\n\n// vitesse base = m/s\nfunction toMps(value: Decimal, unit: string): Decimal {\n  if (unit === 'm/s') return value\n  if (unit === 'km/h') return value.div(3.6)\n  throw new Error(`Unit de vitesse inconnue: ${unit}`)\n}\nfunction fromMps(mps: Decimal, unit: string): Decimal {\n  if (unit === 'm/s') return mps\n  if (unit === 'km/h') return mps.times(3.6)\n  throw new Error(`Unit de vitesse inconnue: ${unit}`)\n}\n\n// dure base = secondes\nfunction toSecondsDuree(value: Decimal, unit: string): Decimal {\n  if (unit === 'hhmmss') return value // convention: value already in seconds\n  if (unit === 'hdec') return value.times(3600)\n  if (unit === 'mindec') return value.times(60)\n  if (unit === 'sec') return value // already in seconds\n  throw new Error(`Unit de dure inconnue: ${unit}`)\n}\nfunction fromSecondsDuree(seconds: Decimal, unit: string): Decimal {\n  if (unit === 'hhmmss') return seconds // stocke en secondes\n  if (unit === 'hdec') return seconds.div(3600)\n  if (unit === 'mindec') return seconds.div(60)\n  if (unit === 'sec') return seconds // already in seconds\n  throw new Error(`Unit de dure inconnue: ${unit}`)\n}\n\nfunction hhmmssToSeconds(str: string): Decimal {\n  const t = str.trim()\n  if (/^\\d{1,2}:\\d{2}:\\d{2}$/.test(t)) {\n    const [H, M, S] = t.split(':').map(Number)\n    return new Decimal(H).times(3600).plus(new Decimal(M).times(60)).plus(S)\n  }\n  if (/^\\d{6}$/.test(t)) {\n    const H = Number(t.slice(0, 2))\n    const M = Number(t.slice(2, 4))\n    const S = Number(t.slice(4, 6))\n    return new Decimal(H).times(3600).plus(new Decimal(M).times(60)).plus(S)\n  }\n  throw new Error(`Format hhmmss invalide: \"${str}\"`)\n}\n\nfunction formatDureeTexHMS(seconds: Decimal): string {\n  const total = seconds.toDecimalPlaces(0, Decimal.ROUND_HALF_UP).toNumber()\n  const h = Math.floor(total / 3600)\n  const m = Math.floor((total % 3600) / 60)\n  const s = total % 60\n  const parts: string[] = []\n  if (h > 0) parts.push(`${h}~\\\\text{h}`)\n  if (m > 0) parts.push(`${m}~\\\\text{min}`)\n  if (s > 0) parts.push(`${s}~\\\\text{s}`)\n  return parts.join('~')\n}\n\nfunction formatHHMMSS(seconds: Decimal): string {\n  const total = seconds.toDecimalPlaces(0, Decimal.ROUND_HALF_UP).toNumber()\n  const h = Math.floor(total / 3600)\n  const m = Math.floor((total % 3600) / 60)\n  const s = total % 60\n  const parts: string[] = []\n  if (h > 0) parts.push(`${h} h`)\n  if (m > 0) parts.push(`${m} min`)\n  if (s > 0) parts.push(`${s} s`)\n  return parts.join(' ')\n}\n\n/**\n * parseUnite:\n *  - Keeps existing SI/prefix parsing\n *  - Adds vitesse & dure special cases with reasonable bases:\n *      vitesse -> base 'm/s'\n *      dure   -> base 's' (seconds)\n */\nfunction parseUnite(unite: string) {\n  // vitesse\n  if (isVitesseUnit(unite)) {\n    return {\n      prefixe: '',\n      uniteDeReference: 'm/s',\n      puissanceUnite: 1,\n      puissancePrefixe: 0,\n    }\n  }\n  // dure\n  if (isDureeUnit(unite)) {\n    return {\n      prefixe: '',\n      uniteDeReference: 's',\n      puissanceUnite: 1,\n      puissancePrefixe: 0,\n    }\n  }\n\n  let puissanceUnite: number\n  let avantPuissanceUnite: string\n\n  if (unite === '') {\n    puissanceUnite = 1\n    avantPuissanceUnite = ''\n  }\n  if (unite === 'C') {\n    puissanceUnite = 1\n    avantPuissanceUnite = 'C'\n  }\n\n  if (unite.indexOf('^') > 0) {\n    // m^2, m^3 et drives\n    puissanceUnite = Number(unite.split('^')[1])\n    avantPuissanceUnite = unite.split('^')[0]\n  } else if (unite.indexOf('ha') === 0) {\n    // hectares\n    puissanceUnite = 1\n    avantPuissanceUnite = 'ha'\n  } else if (unite.indexOf('a') === 0) {\n    // ares\n    puissanceUnite = 1\n    avantPuissanceUnite = 'a'\n  } else if (unite.indexOf('ca') === 0) {\n    // centiares\n    puissanceUnite = 1\n    avantPuissanceUnite = 'ca'\n  } else {\n    // m, g, L et leurs drives\n    puissanceUnite = 1\n    avantPuissanceUnite = unite\n  }\n\n  const prefixe =\n    unite === 'C'\n      ? ''\n      : ['t', 'q'].includes(unite)\n        ? unite\n        : avantPuissanceUnite.substring(0, avantPuissanceUnite.length - 1) // tonne/quintal handled below\n\n  const puissancePrefixe = prefixeToPuissance(prefixe, unite)\n  const uniteDeReference = ['t', 'q'].includes(unite)\n    ? 'g'\n    : unite.substring(prefixe.length)\n\n  return { prefixe, uniteDeReference, puissanceUnite, puissancePrefixe }\n}\n\nfunction prefixeToPuissance(prefixe: string, unite: string) {\n  let puissancePrefixe: number\n  switch (prefixe) {\n    case 'm':\n      puissancePrefixe = -3\n      break\n    case 'c':\n      puissancePrefixe = -2\n      break\n    case 'd':\n      puissancePrefixe = -1\n      break\n    case '':\n      puissancePrefixe = 0\n      break\n    case 'da':\n      puissancePrefixe = 1\n      break\n    case 'h':\n      puissancePrefixe = 2\n      break\n    case 'k':\n      puissancePrefixe = 3\n      break\n    case 'q':\n      puissancePrefixe = unite === 'q' ? 5 : NaN\n      break\n    case 't':\n      puissancePrefixe = unite === 't' ? 6 : NaN\n      break\n    case 'M':\n      puissancePrefixe = 6\n      break\n    case 'G':\n      puissancePrefixe = 9\n      break\n    case 'T':\n      puissancePrefixe = 12\n      break\n    case '\\\\mu{}':\n      puissancePrefixe = -6\n      break\n    case 'n':\n      puissancePrefixe = -9\n      break\n    default:\n      puissancePrefixe = NaN\n  }\n  return puissancePrefixe\n}\n","/**\n * Classe pour grer les dures au format HMS (Heures, Minutes, Secondes)\n * @author Rmi Angot\n * @example const time = new Hms({hour: 2, minute: 5, second: 30})\n * @example const time = Hms.fromString('2 h 5 min 30 s')\n * @example const time = Hms.fromString('5min')\n * @example const time = Hms.fromString('14000s')\n * time.normalize().toString() // 3 h 53 min 20 s\n *\n */\nclass Hms {\n  week: number\n  day: number\n  hour: number\n  minute: number\n  second: number\n  sign: '' | '+' | '-'\n  constructor({\n    week = 0,\n    day = 0,\n    hour = 0,\n    minute = 0,\n    second = 0,\n    sign = '',\n  }: {\n    week?: number\n    day?: number\n    hour?: number\n    minute?: number\n    second?: number\n    sign?: '+' | '-' | ''\n  } = {}) {\n    this.week = week\n    this.day = day\n    this.hour = hour\n    this.minute = minute\n    this.second = second\n    this.sign = sign\n  }\n\n  static fromString(text: string): Hms {\n    const hms = new Hms()\n    text = text.replaceAll(' ', '')\n    text = text.replaceAll('&nbsp;', '')\n    text = text.replaceAll('{\\\\:\\\\text{semaines}\\\\:}', 'semaines')\n    text = text.replaceAll('{\\\\:\\\\text{j}\\\\:}', 'j')\n    text = text.replaceAll('{\\\\:\\\\text{h}\\\\:}', 'h')\n    text = text.replaceAll('{\\\\:\\\\text{min}\\\\:}', 'min')\n    text = text.replaceAll('{\\\\:\\\\text{s}\\\\:}', 's')\n    text = text.replaceAll('sem', 'semaines')\n    // Format avec semaines et jours\n    const regexComplete =\n      /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+)\\s*min\\s*)?(?:(?<second>\\d+)\\s*s)?/gm\n    for (const match of text.matchAll(regexComplete)) {\n      if (match.groups !== undefined) {\n        if (Number.isInteger(parseInt(match.groups.week)))\n          hms.week = parseInt(match.groups.week)\n        if (Number.isInteger(parseInt(match.groups.day)))\n          hms.day = parseInt(match.groups.day)\n        if (Number.isInteger(parseInt(match.groups.hour)))\n          hms.hour = parseInt(match.groups.hour)\n        if (Number.isInteger(parseInt(match.groups.minute)))\n          hms.minute = parseInt(match.groups.minute)\n        if (Number.isInteger(parseInt(match.groups.second)))\n          hms.second = parseInt(match.groups.second)\n        if (match.groups.sign === '+' || match.groups.sign === '-')\n          hms.sign = match.groups.sign\n      }\n    }\n    if (text.includes('min') && !text.endsWith('s')) {\n      // Format sans le s pour les secondes 4min33, 5h3min15\n      const regex =\n        /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+)\\s*min\\s*)?(?:(?<second>\\d+))?/gm\n      for (const match of text.matchAll(regex)) {\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.week))\n        )\n          hms.week = parseInt(match.groups.week)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.day))\n        )\n          hms.day = parseInt(match.groups.day)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.hour))\n        )\n          hms.hour = parseInt(match.groups.hour)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.minute))\n        )\n          hms.minute = parseInt(match.groups.minute)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.second))\n        )\n          hms.second = parseInt(match.groups.second)\n        if (\n          match.groups !== undefined &&\n          (match.groups.sign === '+' || match.groups.sign === '-')\n        )\n          hms.sign = match.groups.sign\n      }\n    } else if (\n      text.includes('h') &&\n      !text.includes('min') &&\n      !text.endsWith('s')\n    ) {\n      // Format sans le min pour les minutes 5h13\n      const regex =\n        /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+))?/gm\n      for (const match of text.matchAll(regex)) {\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.week))\n        )\n          hms.week = parseInt(match.groups.week)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.day))\n        )\n          hms.day = parseInt(match.groups.day)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.hour))\n        )\n          hms.hour = parseInt(match.groups.hour)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.minute))\n        )\n          hms.minute = parseInt(match.groups.minute)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.second))\n        )\n          hms.second = parseInt(match.groups.second)\n        if (\n          match.groups !== undefined &&\n          (match.groups.sign === '+' || match.groups.sign === '-')\n        )\n          hms.sign = match.groups.sign\n      }\n    } else {\n      // Format HMS classique\n      const regex =\n        /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+)\\s*min\\s*)?(?:(?<second>\\d+)\\s*s)?/gm\n      for (const match of text.matchAll(regex)) {\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.week))\n        )\n          hms.week = parseInt(match.groups.week)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.day))\n        )\n          hms.day = parseInt(match.groups.day)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.hour))\n        )\n          hms.hour = parseInt(match.groups.hour)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.minute))\n        )\n          hms.minute = parseInt(match.groups.minute)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.second))\n        )\n          hms.second = parseInt(match.groups.second)\n        if (\n          match.groups !== undefined &&\n          (match.groups.sign === '+' || match.groups.sign === '-')\n        )\n          hms.sign = match.groups.sign\n      }\n    }\n    return hms\n  }\n\n  toString(): string {\n    let result = ''\n    if (this.week > 0) {\n      result += `${this.week} semaines `\n      if (this.day > 0 || this.hour > 0 || this.minute > 0 || this.second > 0)\n        result += ' '\n    }\n    if (this.day > 0) {\n      result += `${this.day} jours `\n      if (this.hour > 0 || this.minute > 0 || this.second > 0) result += ' '\n    }\n    if (this.hour > 0) {\n      if (this.hour % 24 === 0) {\n        result += '0 h'\n      } else {\n        result += `${this.hour} h`\n      }\n      if (this.minute > 0 || this.second > 0) result += ' '\n    }\n    if (this.minute > 0) {\n      result += this.minute > 9 ? `${this.minute} min` : `0${this.minute} min`\n      if (this.second > 0) result += ' '\n    }\n    if (this.second > 0) result += `${this.second} s`\n    return result\n  }\n\n  /** Sortie string sans la dernire unit si elle n'est pas seule\n   * Exemples : 4 h 12 ou 2 min 54\n   */\n  toString2(): string {\n    if (this.hour > 0 && this.second === 0)\n      return this.toString().replace(' min', '')\n    else if (this.minute > 0) return this.toString().replace(' s', '')\n    else return this.toString()\n  }\n\n  isGreaterThan(time: Hms): boolean {\n    return this.toSeconds() > time.toSeconds()\n  }\n\n  /** Dures identiques */\n  isEqual(time: Hms): boolean {\n    return this.toSeconds() === time.toSeconds()\n  }\n\n  /** Dures identiques et crites de la mme manire\n   * 1 min et 60 s => false\n   */\n  isTheSame(time: Hms): boolean {\n    return (\n      this.week === time.week &&\n      this.day === time.day &&\n      this.hour === time.hour &&\n      this.minute === time.minute &&\n      this.second === time.second\n    )\n  }\n\n  /**\n   * Dure identiques\n   */\n  isEquivalentToString(text: string): boolean {\n    return Hms.fromString(text).toSeconds() === this.toSeconds()\n  }\n\n  toSecondsString(): string {\n    return `${this.toSeconds()} s`\n  }\n\n  toSeconds(): number {\n    return (\n      this.week * 604800 +\n      this.day * 86400 +\n      this.hour * 3600 +\n      this.minute * 60 +\n      this.second\n    )\n  }\n\n  /**\n   * Normalise l'criture au format HMS. Les secondes et les minutes seront infrieures  60\n   */\n  normalize(): Hms {\n    this.minute += Math.floor(this.second / 60)\n    this.second = this.second % 60\n    this.hour += Math.floor(this.minute / 60)\n    this.minute = this.minute % 60\n    return this\n  }\n\n  add(time: Hms): Hms {\n    const result = new Hms()\n    result.second = this.toSeconds() + time.toSeconds()\n    result.normalize()\n    return result\n  }\n\n  /**\n   * Renvoie la valeur absolue de la diffrence des temps au format HMS\n   * @param time HMS\n   * @returns HMS\n   */\n  substract(time: Hms): Hms {\n    const result = new Hms()\n    result.second = Math.abs(this.toSeconds() - time.toSeconds())\n    result.normalize()\n    return result\n  }\n}\n\nexport default Hms\n","/* global HTMLElement SVGElement Element fetch */\n/**\n * Fonctions de gestion du dom\n * @module\n */\n\n/**\n * Retourne true si l'objet  la proprit\n * @param {Object} object\n * @param {string} prop\n * @return {boolean}\n */\nconst hasProp = (object: object, prop: string) =>\n  typeof object === 'object' &&\n  Object.prototype.hasOwnProperty.call(object, prop)\n\n/**\n * Affecte des styles  un lment html (on peut pas affecter elt.style directement car read only, faut faire du elt.style.foo = bar)\n * sans planter en cas de pb (on le signale juste en console)\n * Les styles doivent tre crits en camelCase dans le version JS et non CSS\n * @param {HTMLElement} elt\n * @param {string|object} styles\n */\nexport function setStyles(\n  elt: HTMLElement,\n  styles: string | { [key: string]: string },\n) {\n  try {\n    if (elt && elt.style) {\n      if (typeof styles === 'string') {\n        const stylesArr = styles.split(';')\n        stylesArr.forEach(function (paire: string) {\n          const paireArr = /([\\w]+):(.+)/.exec(paire)\n          if (paireArr) {\n            const [, key, value] = paireArr as unknown as [\n              string,\n              keyof CSSStyleDeclaration,\n              string,\n            ]\n            try {\n              if (!elt.style.getPropertyValue(key.toString())) {\n                elt.style.setProperty(key.toString(), value)\n              }\n            } catch (error) {\n              console.warn(\n                `Cannot assign value to style property ${String(key)}: ${error}`,\n              )\n            }\n          }\n        })\n      } else if (typeof styles === 'object') {\n        for (const prop in styles) {\n          if (hasProp(styles, prop)) {\n            try {\n              Object.assign(elt.style, { [prop]: styles[prop] })\n            } catch (error) {\n              console.warn(\n                `Cannot assign value to style property ${prop}: ${error}`,\n              )\n            }\n          }\n        }\n      }\n    }\n  } catch (error) {\n    console.error(error)\n  }\n}\n\n/**\n * Ajoute du texte dans un lment\n * @param {HTMLElement} elt\n * @param {string} text\n */\nexport function addText(elt: HTMLElement, text: string) {\n  elt.appendChild(window.document.createTextNode(text))\n}\n\n/**\n * Retourne l'lment du dom\n * @param {string} id\n * @param {boolean} [strict=true] Passer false pour retourner null plutt que throw une erreur si id n'existe pas\n * @return {HTMLElement}\n * @throws {TypeError} Si id n'est pas une string\n * @throws {Error} Si l'lment id n'existe pas\n */\nexport function get(id: string, strict = true) {\n  if (typeof id !== 'string') throw TypeError('argument invalide')\n  const elt = document.getElementById(id)\n  if (!elt && strict) throw Error(`Llment html ${id} nexiste pas`)\n  return elt\n}\n\n/**\n * Retourne un lment html de type tag (non insr dans le dom)\n * @param {string} tag\n * @param {Object} [attrs] Les attributs\n * @param {string} [txtContent] Contenu textuel ventuel\n */\nexport function create(\n  tag: keyof HTMLElementTagNameMap,\n  attrs: { [key: string]: any },\n  txtContent?: string,\n) {\n  const elt = window.document.createElement(tag)\n  let attr\n  try {\n    if (attrs) {\n      for (attr in attrs) {\n        if (hasProp(attrs, attr)) {\n          if (attr === 'class') elt.className = attrs.class\n          else if (attr === 'className') elt.className = attrs.className\n          else if (attr === 'style') setStyles(elt, attrs.style)\n          else elt.setAttribute(attr, attrs[attr])\n        }\n      }\n    }\n  } catch (error) {\n    console.error(error)\n  }\n\n  if (txtContent) addText(elt, txtContent)\n\n  return elt\n}\n\n/**\n * Ajoute un lment html de type tag  parent\n * @param {HTMLElement} parent\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'lment ajout\n */\nexport function addElement(\n  parent: HTMLElement,\n  tag: keyof HTMLElementTagNameMap,\n  attrs: { [key: string]: any },\n  content: string,\n) {\n  const elt = create(tag, attrs, content)\n  parent.appendChild(elt)\n  return elt\n}\n\n/**\n * S'assure que elt est bien un lment du DOM et le retourne (throw sinon)\n * @param {string|HTMLElement|SVGElement|Element} elt Si c'est une string on ira chercher l'lment avec getElementById\n * @param {string} [type] pour restreindre  un type d'lment, html|svg\n * @return {HTMLElement|SVGElement|Element}\n * @throws {TypeError} Si elt n'tait pas un lment du type voulu\n */\nexport function enforceElt(elt: HTMLElement | string, type: string) {\n  let newElt: HTMLElement | SVGElement | Element | null\n  if (typeof elt === 'string') {\n    newElt = document.getElementById(elt) ?? null\n    if (!newElt) throw Error(`Aucun lment did ${elt}`)\n  } else {\n    newElt = elt\n  }\n  switch (type) {\n    case 'html':\n      if (newElt instanceof HTMLElement) return newElt\n      throw TypeError('HTMLElement indispensable manquant')\n    case 'svg':\n      if (newElt instanceof SVGElement) return newElt\n      throw TypeError('SVGElement indispensable manquant')\n    default:\n      if (newElt instanceof Element) return newElt\n  }\n  throw TypeError('Element indispensable manquant')\n}\n\n/**\n *\n * @param {string} url du fichier HTML\n * @param {HTMLElement} element dont le innerHTML va tre remplac par le contenu du fichier\n */\nexport async function fetchHtmlToElement(url: string, element: HTMLElement) {\n  const response = await fetch(url)\n  element.innerHTML = await response.text()\n}\n\n/**\n *\n * @param {string} url du fichier HTML\n * @param {element} parent dans lequel l'lment va tre ajout en dernier enfant\n * @param {string=} tag 'div' par dfaut\n * @param {Object=} attrs Les attributs\n * @returns {HTMLElement} L'lment ajout\n */\nexport async function addFetchHtmlToParent(\n  url: string,\n  parent: HTMLElement,\n  tag = 'div',\n  attrs: { [key: string]: any },\n) {\n  const child = addElement(\n    parent,\n    tag as keyof HTMLElementTagNameMap,\n    attrs,\n    '',\n  )\n  return fetchHtmlToElement(url, child)\n}\n","import {\n  ComputeEngine,\n  type BoxedExpression,\n  type LatexDictionaryEntry,\n  type ParseLatexOptions,\n  type Parser,\n} from '@cortex-js/compute-engine'\nimport { number } from 'mathjs'\nimport type { Expression } from 'mathlive'\nimport Grandeur from '../../modules/Grandeur'\nimport Hms from '../../modules/Hms'\nimport { areSameArray } from '../outils/arrayOutils'\nimport { texNombre } from '../outils/texNombre'\nimport type {\n  CleaningOperation,\n  OptionsComparaisonType,\n  ResultType,\n} from '../types'\n\nconst engine = new ComputeEngine()\nexport default engine\n\n/**\n * Nettoie la saisie des \\\\dfrac en les remplaant par des \\frac comprises par ComputeEngine\n * @param {string} str\n */\nfunction cleanFractions(str: string): string {\n  return str.replaceAll(/dfrac/g, 'frac')\n}\n\n/**\n * Nettoie la saisie des \\\\frac pour mieux grer les fractions ngatives et que le moins soit toujours au dnominateur\n * Rajout des regex de MD pour grer les fractions ngatives (30/08/2024 : pas de solution directement par ComputeEngine mais ArnoG est sur le coup)\n * Cette fraction est amen  remplacer cleanFractions mais dans le doute (laissons-lui du temps pour vrifier qu'elle ne buggue pas), et pour vexer personne, je la mets en doublon.\n * @param {string} str\n * @author Eric Elter\n */\nfunction cleanFractionsMemesNegatives(str: string): string {\n  // EE :\n  let modif: string\n  modif = str.replaceAll(/dfrac/g, 'frac')\n\n  // regex made by Mathieu Degrange\n  modif = modif.replace(\n    /^-\\\\frac(?:(\\d)(\\d)|{(-?\\d+)}{(-?\\d+)})$/i,\n    (match, p1, p2, p3, p4) =>\n      `\\\\frac{${(p1 || p3) * (p2 || p4) > 0 ? '-' : ''}${Math.abs(p1 || p3)}}{${Math.abs(p2 || p4)}}`,\n  ) // Permet de transformer -\\frac{13}{15} en \\frac{-13}{15} et -\\frac{-13}{15} en \\frac{13}{15}\n\n  modif = modif.replace(\n    /^\\\\frac(?:(\\d)(\\d)|{(-?\\d+)}{(-?\\d+)})$/i,\n    (match, p1, p2, p3, p4) =>\n      `\\\\frac{${(p1 || p3) * (p2 || p4) < 0 ? '-' : ''}${Math.abs(p1 || p3)}}{${Math.abs(p2 || p4)}}`,\n  ) // Permet de transformer \\frac{-13}{-15} en \\frac{13}{15}\n\n  return modif\n}\n\n/**\n * Nettoie la saisie des \\\\div en les remplaant par des / compris par ComputeEngine\n * @param {string} str\n */\nfunction cleanDivisions(str: string): string {\n  return str.replaceAll(/\\\\div/g, '/')\n}\n\n/**\n * Remplace les virgules non chappes par des points.\n * @param {string} str\n * @returns {string}\n */\nfunction replaceUnescapedCommas(str: string): string {\n  return str.replace(/,/g, (match, offset, string) => {\n    // Vrifie si la virgule est prcde d'un antislash\n    if (offset > 0 && string[offset - 1] === '\\\\') {\n      return match // Ne remplace pas la virgule chappe\n    }\n    return '.'\n  })\n} /**\n * Remplace les espaces fins `\\,` par une chane vide.\n * @param {string} str\n * @returns {string}\n */\nfunction replaceThinSpaces(str: string): string {\n  return str.replaceAll(/\\\\,/g, '')\n}\n/**\n *\n * Nettoie la saisie des virgules dcimales en les remplaant par des points.\n * @warning Attention ne fonctionne avec Safari que depuis 2023\n * @param {string} str\n */\nfunction cleanComas(str: string): string {\n  return replaceThinSpaces(replaceUnescapedCommas(str.replaceAll(/\\{,}/g, '.')))\n}\n\n/** Ancien cleanSpaces\n * Nettoie la saisie des espaces\n * @param {string} str\n \nfunction cleanSpaces(str: string): string {\n  return str.replaceAll(/\\s/g, '').replaceAll(/\\\\,/g, '')\n}\n*/\n\n/**\n * Supprime tous les espaces \"classiques\" et les espaces LaTeX d'une chane.\n *\n * Espaces supprims :\n * - Espaces standards (espace, tab, retour ligne, etc.)\n * - `~` (espace inscable LaTeX)\n * - `\\,` (petit espace LaTeX)\n * - `\\:` (espace moyen LaTeX)\n * - `\\;` (espace large LaTeX)\n * - `\\!` (espace ngatif LaTeX)\n * - `\\quad` (espace quad LaTeX)\n * - `\\qquad` (espace double quad LaTeX)\n *\n * @param {string} str - La chane  nettoyer.\n * @returns {string} La chane sans aucun espace ni commande d'espacement LaTeX.\n *\n * @example\n * removeLatexSpaces(\"Hello ~ world\\\\, test \\\\: math \\\\quad fini\");\n * //  \"Helloworldtestmathfini\"\n *\n * @author Eric Elter\n */\nfunction cleanSpaces(str: string): string {\n  const patterns = [\n    /\\s/g, // espaces normaux (tab, retour ligne)\n    /~/g, // espace inscable (~)\n    /\\\\,/g, // petit espace \\,\n    /\\\\:/g, // espace moyen \\:\n    /\\\\;/g, // espace large \\;\n    /\\\\!/g, // espace ngatif \\!\n    /\\\\quad/g, // espace quad\n    /\\\\qquad/g, // espace double quad\n  ]\n\n  for (const regex of patterns) {\n    str = str.replace(regex, '')\n  }\n  return str\n}\n\n/**\n * Rduit les espaces doubles ou triples  de simples espaces mais ne supprime pas les simples espaces\n * supprime aussi les espaces simples en dbut et fin de saisie\n */\nfunction cleanDoubleSpaces(str: string): string {\n  let s = str\n  while (s.includes('  ')) {\n    s = s.replace('  ', ' ')\n  }\n  if (s[0] === ' ') s = s.substring(1, s.length)\n  if (s[s.length - 1] === ' ') s = s.substring(0, s.length - 1)\n  return s\n}\n\n/**\n * Remplace les espaces Latex par des espaces normaux\n * @param {string} str\n */\nfunction cleanEspaceNormal(str: string): string {\n  return str.replaceAll(/\\\\,/g, ' ')\n}\n\n/**\n * Nettoie les parenthses en remplaant par celles supportes par le ComputeEngine\n * @param {string} str\n */\nfunction cleanParentheses(str: string): string {\n  return str\n    .replaceAll(/\\\\lparen(\\+?-?\\d+,?\\.?\\d*)\\\\rparen/g, '($1)')\n    .replaceAll(/\\\\left\\((\\+?-?\\d+)\\\\right\\)/g, '($1)')\n    .replaceAll(/\\\\lparen(\\+?-?\\d+)\\\\rparen/g, '($1)')\n    .replaceAll(/\\\\left\\\\{(.*?)\\\\right\\\\}/g, '\\\\{$1\\\\}')\n    .replaceAll('\\\\lparen', '(')\n    .replaceAll('\\\\rparen', ')')\n    .replaceAll('\\\\left\\\\lbrack', '[')\n    .replaceAll('\\\\right\\\\rbrack', ']')\n    .replaceAll('\\\\right\\\\lbrack', '[')\n    .replaceAll('\\\\left\\\\rbrack', ']')\n    .replaceAll('\\\\left[', '[')\n    .replaceAll('\\\\right]', ']')\n    .replaceAll('\\\\right[', '[')\n    .replaceAll('\\\\left]', ']')\n    .replace(/\\{\\}/g, (match, offset, string) => {\n      // Vrifie si les accolades sont prcdes de ^ ou si elles sont seules dans la chane\n      if (offset > 0 && string[offset - 1] === '^') {\n        return match // Conserve les ^{}\n      }\n      if (string === '{}') {\n        return match // Conserve les chanes uniquement contenant {}\n      }\n      return '' // Remplace les autres occurrences de {}\n    }) // Cela permet de supprimer les doubles accolades vierges sauf :\n  // quand elles sont prcdes de ^ (cette gestion est propre aux puissances)\n  // et que la chaine ne contient que {} (qui serait le cas d'un ensemble vide)\n}\n\nfunction cleanMathRm(str: string): string {\n  return str.replace(/\\\\mathrm\\{(\\w+)}/g, '$1')\n}\n\nfunction cleanImaginaire(str: string): string {\n  return str.replace(/\\\\mathrm\\{i\\}|\\{i\\}/g, 'i')\n}\n\nfunction cleanOperatorName(str: string): string {\n  return str\n    .replace(/\\\\operatorname\\{\\s*\\}/g, ' ') // remplace les accolades vides\n    .replace(/\\\\operatorname(?!\\s*\\{)/g, '') // supprime operatorname sans accolades\n}\n\n/**\n * Nettoie le latex \\text{} mis pour sparer le nombre de l'unit en mode texte\n * @param {string} str\n */\nfunction cleanUnity(str: string): string {\n  return str\n    .replaceAll('}}', '')\n    .replaceAll('{\\\\text{', '')\n    .replaceAll('{\\\\:\\\\text{', '')\n    .replaceAll('}\\\\:}', '')\n}\n\n/**\n * Nettoie tout ce qui peut arriver  l'utilisation des puissances\n * @param {string} str\n */\nfunction cleanPower(str: string): string {\n  return str\n    .replaceAll('', '^2') // '' c'est pas correct en latex !\n    .replaceAll('', '^3') // '' non plus\n    .replaceAll('^{}', '') // les exposants vides, il n'aime pas a non plus\n    .replaceAll('^{^', '^{') // EE : Pour supprimer les puissances de puissances malencontreuses\n}\n\n/**\n * transforme \\text{truc} en truc utiliser cleanUnity si le \\text{} est au milieu de la chaine.\n * @param str\n */\nfunction cleanLatex(str: string): string {\n  const text = str.match(/(\\\\text\\{)(.*)}/)\n  if (text && text?.length > 2) return text[2]\n  return str\n}\n\nfunction cleanMultiplyByOne(str: string): string {\n  if (!str.match(/(?<!\\d)1([a-z])/)) return str //  priori, rien  nettoyer ici\n  return str.replace(/(?<!\\d)1([a-z])/g, '$1')\n}\n\nexport function generateCleaner(\n  operations: CleaningOperation[],\n): (str: string) => string {\n  const cleaningFunctions = operations.map((operation) => {\n    switch (operation) {\n      case 'fractions':\n        return cleanFractions\n      case 'imaginaires':\n        return cleanImaginaire\n      case 'fractionsMemesNegatives':\n        return cleanFractionsMemesNegatives\n      case 'virgules':\n        return cleanComas\n      case 'espaces':\n        return cleanSpaces\n      case 'parentheses':\n        return cleanParentheses\n      case 'puissances':\n        return cleanPower\n      case 'mathrm':\n        return cleanMathRm\n      case 'operatorName':\n        return cleanOperatorName\n      case 'divisions':\n        return cleanDivisions\n      case 'latex':\n        return cleanLatex\n      case 'foisUn':\n        return cleanMultiplyByOne\n      case 'unites':\n        return cleanUnity\n      case 'doubleEspaces':\n        return cleanDoubleSpaces\n      case 'espaceNormal':\n        return cleanEspaceNormal\n      default:\n        throw new Error(`Unsupported cleaning operation: ${operation}`)\n    }\n  })\n\n  return (str: string) => {\n    let cleaned = String(str)\n\n    // Supprimer tous les '_{}' et tous les '^{}'\n    cleaned = cleaned.replaceAll('_{}', '').replaceAll('^{}', '')\n\n    // Appliquer les fonctions de nettoyage\n    return cleaningFunctions.reduce(\n      (result, cleaningFn) => cleaningFn(result),\n      cleaned,\n    )\n  }\n}\n\n/**\n * fonction initialement dans mathlive.js, j'en ai besoin ici, et plus dans mathlive.js\n * @param {string} input la chaine qui contient le nombre avec son unit\n * @return {Grandeur|false} l'objet de type Grandeur qui contient la valeur et l'unit... ou false si c'est pas une grandeur.\n */\nfunction inputToGrandeur(input: string): Grandeur | false {\n  if (input.indexOf('C') > 0) {\n    const split = input.split('C')\n    return new Grandeur(Number.parseFloat(split[0].replace(',', '.')), 'C')\n  }\n  if (input.indexOf('') > 0) {\n    const split = input.split('')\n    return new Grandeur(Number.parseFloat(split[0].replace(',', '.')), '')\n  }\n  if (input.split('operatorname').length !== 2) return false\n  const split = input.split('\\\\operatorname{')\n  const mesure = Number.parseFloat(split[0].replace(',', '.'))\n  if (split[1]) {\n    const split2 = split[1].split('}')\n    const unite = split2[0] + split2[1]\n    return new Grandeur(mesure, unite)\n  }\n  return false\n}\n\n/**\n * Transformation de toute sorte d'expressions factorises (multiply, power, square) en une expression factorise qu'avec multiply o les puissances et les carrs sont rcrits comme des produits explicites.\n * Cette fonction sert pour la fonction de comparaison d'expressions factorises.\n * @param {BoxedExpression} expr\n * @return BoxedExpression\n */\nexport function flatten(expr: BoxedExpression): BoxedExpression {\n  if (expr.operator === 'Multiply') {\n    if (expr.ops == null) {\n      window.notify(\n        'flatten a rencontr un problme avec une multiplication sans oprandes',\n        { expr },\n      )\n      return engine.parse(expr.latex) as BoxedExpression\n    }\n    return engine.box([\n      'Multiply',\n      ...(expr.ops as BoxedExpression[]).map((op) => flatten(op)),\n    ]) as BoxedExpression\n  }\n  const base = ['Power', 'Square'].includes(expr.op1.operator)\n    ? flatten(expr.op1)\n    : expr.op1\n  if (expr.operator === 'Square') {\n    return engine.box(['Multiply', base, base], { canonical: true })\n  }\n  if (expr.operator === 'Power' && expr.op2.operator === 'Number') {\n    const expo = Number(expr.op2.value)\n    const exprs = []\n    for (let i = 0; i < expo; i++) {\n      exprs.push(base)\n    }\n    return engine.box(['Multiply', ...exprs], { canonical: true })\n  }\n  return expr\n}\n\n/**\n * Ici, on considre que les expressions ops1 et ops2 sont factorises et leurs valeurs absolues sont quivalentes mathmatiquement .\n * Cette fonction est un outil de vrification pour sassurer que chaque facteur dans ops1 est bien dans ops2, avec prise en compte du bon signe.\n * Cette fonction sert pour la fonction de comparaison d'expressions factorises.\n * @param {BoxedExpression[]} ops1\n * @param {BoxedExpression[]} ops2\n * @param {boolean} signe // Si true, alors les expresssions sont quivalentes mathmatiquement. Si false, alors les expressions sont opposes.\n * @param {boolean} exclusifFactorisation // Si true, seuls les facteurs identiques (modulo l'ordre) sont considrs gaux.\n * @return ResultType\n */\nfunction allFactorsMatch(\n  ops1: readonly BoxedExpression[],\n  ops2: readonly BoxedExpression[],\n  signe: boolean,\n  exclusifFactorisation = false,\n): ResultType {\n  let signeCurrent = signe\n  let nbMatchOK = 0\n  let nbNonAttendu = 0\n  let allMatch = true\n  for (const op of ops2) {\n    // Les facteurs du second paramtre\n    let match = false\n    for (const op2 of ops1) {\n      // Les facteurs du premier paramtre\n      if (\n        (exclusifFactorisation && op2.isSame(op)) ||\n        (!exclusifFactorisation && op2.isEqual(op))\n      ) {\n        match = true\n        nbMatchOK++\n        break\n      } else if (exclusifFactorisation && !op2.isSame(op) && op2.isEqual(op)) {\n        nbNonAttendu++\n        break\n      }\n      const newOp2 = engine.box(['Subtract', '0', op2.json], {\n        canonical: true,\n      }) // Pour tester avec l'oppos du facteur.\n      if (\n        (exclusifFactorisation && op.isSame(newOp2)) ||\n        (!exclusifFactorisation && op.isEqual(newOp2))\n      ) {\n        signeCurrent = !signeCurrent\n        match = true\n        nbMatchOK++\n        break\n      } else if (\n        exclusifFactorisation &&\n        !op.isSame(newOp2) &&\n        op.isEqual(newOp2)\n      ) {\n        nbNonAttendu++\n        break\n      }\n    }\n    allMatch &&= match\n  }\n\n  if (!allMatch) {\n    if (nbMatchOK > 0)\n      return {\n        isOk: false,\n        feedback:\n          nbMatchOK > 1\n            ? `Seulement $${nbMatchOK}$ facteurs sont corrects.`\n            : `Seulement $${nbMatchOK}$ facteur est correct.`,\n      }\n    if (nbNonAttendu > 0)\n      return {\n        isOk: false,\n        feedback:\n          nbNonAttendu > 1\n            ? `$${nbMatchOK}$ facteurs ne sont pas sous la forme attendue.`\n            : `$${nbMatchOK}$ facteur n'est pas  sous la forme attendue..`,\n      }\n    return { isOk: false, feedback: \"Aucun facteur n'est correct.\" }\n  }\n  return {\n    isOk: signeCurrent,\n    feedback: signeCurrent\n      ? ''\n      : \"L'expression saisie est l'oppos de l'expression attendue.\",\n  }\n}\n\n/**\n * comparaison d'expressions factorises'\n * @param {string} input\n * @param {string} goodAnswer\n * @param {Object} [options={}] - Options pour la comparaison.\n * @param {boolean} [options.exclusifFactorisation=false] // si true, seuls les facteurs (modulo l'ordre) gaux  ceux de goodAnswer seront considrs corrects.\n * @param {boolean} [options.nbFacteursIdentiquesFactorisation=false] // si true, input et goodAnswer sont considrs gaux que s'ils contiennent le mme nombre de facteurs.\n * @param {boolean} [options.unSeulFacteurLitteral=false] // si true, input peut tre factoris et ne contenir qu'un seul facteur littral (les autres sont des nombres)\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction factorisationCompare(\n  input: string,\n  goodAnswer: string,\n  {\n    exclusifFactorisation = false,\n    nbFacteursIdentiquesFactorisation = false,\n    unSeulFacteurLitteral = false,\n  } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'puissances',\n    'virgules',\n    'fractions',\n    'parentheses',\n  ])\n\n  let signe = true\n  const aCleaned = clean(input)\n  if (\n    input.includes('\\\\times1\\\\') ||\n    input.endsWith('\\\\times1') ||\n    input.startsWith('1\\\\times')\n  ) {\n    return { isOk: false, feedback: \"Une factorisation par 1 a peu d'intrt.\" }\n  }\n  const bCleaned = clean(goodAnswer)\n  const saisieParsedInit = engine.parse(aCleaned, { canonical: true })\n  const reponseParsedInit = engine.parse(bCleaned, { canonical: true })\n\n  if (saisieParsedInit == null || reponseParsedInit == null) {\n    window.notify(\n      'factorisationCompare a rencontr un problme en analysant la rponse ou la saisie ',\n      { saisie: input, reponse: goodAnswer },\n    )\n    return { isOk: false }\n  }\n  let saisieHead = saisieParsedInit.operator\n  let answerHead = reponseParsedInit.operator\n  let saisieParsed = saisieParsedInit\n  let reponseParsed = reponseParsedInit\n  if (saisieHead === 'Negate') {\n    // on gre le cas o la saisie commence par le signe moins\n    saisieParsed = saisieParsedInit.op1\n    saisieHead = saisieParsed.operator\n    signe = !signe\n  }\n  if (answerHead === 'Negate') {\n    // on gre le cas o la rponse commence par le signe moins\n    reponseParsed = reponseParsedInit.op1\n    answerHead = reponseParsed.operator\n    signe = !signe\n  }\n\n  // isOk1 atteste que le dveloppement de la saisie et de la reponse attendue sont gales\n  const saisieDev = engine\n    .box(['ExpandAll', saisieParsed])\n    .evaluate()\n    .simplify().canonical\n  const reponseDev = engine\n    .box(['ExpandAll', reponseParsed])\n    .evaluate()\n    .simplify().canonical\n  const isOk1 = saisieDev.isEqual(reponseDev)\n  // const isOk1 = saisieParsedInit.isEqual(reponseParsedInit) // EE : Depuis la version 0.26 de cortexEngine, ce qui prcde devrait tre inutile sauf que (x+5)^2 diffrent de (x+5)(x+5)\n\n  if (!['Multiply', 'Power', 'Square'].includes(saisieHead)) {\n    let feedback = \"L'expression saisie n'est pas factorise\"\n    feedback += isOk1\n      ? \" bien qu'elle soit gale  l'expression attendue.\"\n      : '.'\n    return { isOk: false, feedback }\n  }\n  const reponseFactors = flatten(reponseParsed).ops\n  const saisieFactors = flatten(saisieParsed).ops\n  if (reponseFactors == null) {\n    // EE : Y a aucune raison que ce soit null si l'exercice est bien cod et la rponse fournie dans handleAnswers est correct.\n    window.notify(\n      'factorisationCompare a rencontr un problme en analysant la rponse. ',\n      { reponse: goodAnswer },\n    )\n    return {\n      isOk: false,\n      feedback: 'Un problme a eu lieu lors de la comparaison.',\n    } // EE : Eviter ce genre de feedback car cela ne doit se produire.\n  }\n  if (saisieFactors == null) {\n    // EE : Je ne vois pas quand saisieFactors peut-tre null. Un exemple ?\n    return {\n      isOk: false,\n      feedback: \"L'expression saisie n'a pas le format attendu.\",\n    }\n  }\n  if (nbFacteursIdentiquesFactorisation) {\n    if (saisieFactors.length > reponseFactors.length) {\n      if (isOk1)\n        return {\n          isOk: false,\n          feedback: \"L'expression saisie est trop factorise.\",\n        }\n      return {\n        isOk: false,\n        feedback: \"L'expression saisie a trop de facteurs.\",\n      }\n    } else if (saisieFactors.length < reponseFactors.length) {\n      if (isOk1)\n        return {\n          isOk: false,\n          feedback: \"L'expression saisie peut tre davantage factorise.\",\n        }\n      return {\n        isOk: false,\n        feedback: \"Il manque des facteurs  l'expression saisie.\",\n      }\n    }\n    const result = allFactorsMatch(\n      saisieFactors,\n      reponseFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    if (!result.isOk) return { isOk: false, feedback: `${result.feedback}` }\n\n    const result2 = allFactorsMatch(\n      reponseFactors,\n      saisieFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    return { isOk: result2.isOk, feedback: `${result2.feedback ?? ''}` }\n  }\n\n  if (!isOk1 || exclusifFactorisation) {\n    const result = allFactorsMatch(\n      saisieFactors,\n      reponseFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    if (!result.isOk) return { isOk: false, feedback: `${result.feedback}` }\n\n    const result2 = allFactorsMatch(\n      reponseFactors,\n      saisieFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    return { isOk: result2.isOk, feedback: `${result2.feedback ?? ''}` }\n  }\n  if (isOk1 && unSeulFacteurLitteral) {\n    let nbNumber = 0\n    for (const op of saisieFactors) {\n      if (!isNaN(Number(op.json))) nbNumber++\n    }\n    if (nbNumber === saisieFactors.length - 1)\n      return {\n        isOk: false,\n        feedback: \"L'expression saisie peut tre davantage factorise.\",\n      }\n  }\n  return { isOk: true }\n}\n\n/**\n * comparaison de dures\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction hmsCompare(input: string, goodAnswer: string): ResultType {\n  const clean = generateCleaner(['unites'])\n  const cleanInput = clean(input)\n  const inputHms = Hms.fromString(cleanInput)\n  const goodAnswerHms = Hms.fromString(goodAnswer)\n  return { isOk: goodAnswerHms.isTheSame(inputHms) }\n}\n\nengine.latexDictionary = [\n  ...engine.latexDictionary.filter((x) => x.name !== 'Subtract'),\n  {\n    ...(engine.latexDictionary.find(\n      (x) => x.name === 'Subtract',\n    ) as unknown as LatexDictionaryEntry),\n    parse: (parser: Parser, lhs: Expression, terminator: ParseLatexOptions) => {\n      // Reculer d'un jeton : nous allons analyser le '-' comme faisant partie du rhs afin de\n      // pouvoir conserver l'expression en tant que 'Add'.\n      parser.index -= 1\n      const rhs = parser.parseExpression({ ...terminator, minPrec: 275 + 3 })\n      return ['Add', lhs, rhs]\n    },\n  } as unknown as LatexDictionaryEntry, // Conversion en 'unknown' puis en 'LatexDictionaryEntry'\n]\n\n// Pour viter que G en Latex soit pris pour CatalanConstant\nengine.latexDictionary = [\n  ...engine.latexDictionary,\n  { identifierTrigger: 'G', name: 'G' } as LatexDictionaryEntry,\n]\n\n/****************************************************************************************************\n *\n *                  C'est la fonction, ci-dessous, la future fonction couteauSuisse\n *                            qu'il faudra nommer fonctionComparaison ?\n *\n ****************************************************************************************************/\n/**\n * comparaison gnrique : notre couteau suisse\n * @param {string} input\n * @param {string} goodAnswer\n /**\n * @param {{\n *   expressionsForcementReduites: boolean,\n *   avecSigneMultiplier: boolean,\n *   avecFractions: boolean,\n *   sansTrigo;boolean,\n *   fractionIrreductible: boolean,\n *   fractionSimplifiee: boolean,\n *   fractionReduite: boolean,\n *   fractionDecimale: boolean,\n *   fractionEgale: boolean,\n *   fractionIdentique : boolean,\n *   nombreDecimalSeulement: boolean,\n *   expressionNumerique: boolean,\n *   additionSeulementEtNonResultat: boolean,\n *   soustractionSeulementEtNonResultat:boolean,\n *   multiplicationSeulementEtNonResultat:boolean,\n *   divisionSeulementEtNonResultat:boolean,\n *   HMS: boolean,\n *   intervalle: boolean,\n *   estDansIntervalle: boolean,\n *   ecritureScientifique: boolean,\n *   unite: boolean,\n *   precisionUnite: number,\n *   ensembleDeNombres: boolean,\n *   kUplet: boolean,\n *   suiteDeNombres,\n *   suiteRangeeDeNombres,\n *   puissance: boolean,\n *   seulementCertainesPuissances: boolean,\n *   sansExposantUn: boolean,\n *   factorisation: boolean,\n *   exclusifFactorisation: boolean,\n *   nbFacteursIdentiquesFactorisation: boolean,\n *   unSeulFacteurLitteral,\n *   developpementEgal,\n *   texteAvecCasse: boolean,\n *   texteSansCasse: boolean\n * }} [options]\n * @author Eric Elter\n * @return ResultType\n */\nexport function fonctionComparaison(\n  input: string,\n  goodAnswer: string,\n  {\n    expressionsForcementReduites,\n    avecSigneMultiplier,\n    avecFractions,\n    sansTrigo,\n    fractionIrreductible, // Document\n    fractionSimplifiee, // Document\n    fractionReduite, // Document\n    fractionDecimale, // Document\n    fractionEgale, // Document\n    fractionIdentique, // Document\n    nombreDecimalSeulement, // Document\n    expressionNumerique, // Document\n    additionSeulementEtNonResultat, // Document\n    soustractionSeulementEtNonResultat, // Document\n    multiplicationSeulementEtNonResultat, // Document\n    divisionSeulementEtNonResultat, // Document\n    ensembleDeNombres, // Document\n    fonction,\n    kUplet, // Document\n    suiteDeNombres, // Document\n    suiteRangeeDeNombres, // Document\n    puissance, // Document\n    seulementCertainesPuissances, // Document\n    sansExposantUn, // Document\n    factorisation, // Document\n    exclusifFactorisation, // Document\n    nbFacteursIdentiquesFactorisation, // Document\n    unSeulFacteurLitteral, // Document\n    HMS, // Document\n    developpementEgal,\n    intervalle,\n    estDansIntervalle,\n    ecritureScientifique, // Document\n    unite,\n    precisionUnite,\n    texteAvecCasse,\n    texteSansCasse,\n    nombreAvecEspace,\n    egaliteExpression,\n    calculFormel, // Document\n    nonReponseAcceptee,\n    variable,\n    entier,\n    domaine,\n  }: OptionsComparaisonType = {\n    expressionsForcementReduites: true,\n    avecSigneMultiplier: true,\n    avecFractions: true,\n    sansTrigo: false,\n    fractionIrreductible: false,\n    fractionSimplifiee: false,\n    fractionReduite: false,\n    fractionDecimale: false,\n    fractionEgale: false,\n    fractionIdentique: false,\n    nombreDecimalSeulement: false,\n    expressionNumerique: false,\n    additionSeulementEtNonResultat: false,\n    soustractionSeulementEtNonResultat: false,\n    multiplicationSeulementEtNonResultat: false,\n    divisionSeulementEtNonResultat: false,\n    ensembleDeNombres: false,\n    fonction: false,\n    kUplet: false,\n    seulementCertainesPuissances: false,\n    sansExposantUn: false,\n    suiteDeNombres: false,\n    suiteRangeeDeNombres: false,\n    factorisation: false,\n    exclusifFactorisation: false,\n    nbFacteursIdentiquesFactorisation: false,\n    unSeulFacteurLitteral: false,\n    HMS: false,\n    developpementEgal: false,\n    intervalle: false,\n    estDansIntervalle: false,\n    ecritureScientifique: false,\n    unite: false,\n    precisionUnite: 0,\n    puissance: false,\n    texteAvecCasse: false,\n    texteSansCasse: false,\n    nombreAvecEspace: false,\n    egaliteExpression: false,\n    calculFormel: false,\n    nonReponseAcceptee: false,\n    variable: 'x',\n    entier: false,\n    domaine: [-100, 100],\n  },\n): ResultType {\n  // nonReponseAcceptee = true permet d'avoir des champs vides (on pense aux fillInTheBlank qui peuvent tre facultatifs, comme par exemple un facteur 1)\n  // si false (valeur par dfaut ou si non prcise) alors une rponse vide entrane isOk = false et un feedback pour notifier l'absence de rponse\n  if (nonReponseAcceptee) {\n    if (input === '' && goodAnswer === '') return { isOk: true }\n    return { isOk: false, feedback: 'Une rponse doit tre saisie' }\n  }\n  if (input === '') {\n    return { isOk: false, feedback: 'Une rponse doit tre saisie' }\n  }\n  // ici, on met tous les tests particuliers (HMS, intervalle)\n  // if (HMS) return comparaisonExpressions(input, goodAnswer)\n  input = input.replaceAll('', '\\\\times') // Indispensable pour ceux qui font du copier-coller\n  if (HMS) return hmsCompare(input, goodAnswer)\n  if (fonction)\n    return functionCompare(input, goodAnswer, {\n      variable: variable ?? 'x',\n      domaine: domaine ?? [-100, 100],\n      entier: entier ?? false,\n    })\n  if (intervalle) return intervalsCompare(input, goodAnswer)\n  if (estDansIntervalle) return intervalCompare(input, goodAnswer)\n  if (ecritureScientifique) return scientifiqueCompare(input, goodAnswer)\n  if (unite) {\n    return unitsCompare(input, goodAnswer, { precision: precisionUnite })\n  }\n  if (\n    factorisation ||\n    exclusifFactorisation ||\n    nbFacteursIdentiquesFactorisation ||\n    unSeulFacteurLitteral\n  )\n    return factorisationCompare(input, goodAnswer, {\n      exclusifFactorisation,\n      nbFacteursIdentiquesFactorisation,\n      unSeulFacteurLitteral,\n    })\n  if (puissance || seulementCertainesPuissances || sansExposantUn)\n    return comparaisonPuissances(input, goodAnswer, {\n      seulementCertainesPuissances,\n      sansExposantUn,\n    })\n  if (texteAvecCasse) return texteAvecCasseCompare(input, goodAnswer)\n  if (texteSansCasse) return texteSansCasseCompare(input, goodAnswer)\n  if (egaliteExpression) return egaliteCompare(input, goodAnswer)\n  if (nombreAvecEspace) return numberWithSpaceCompare(input, goodAnswer)\n  if (expressionNumerique) return expressionNumeriqueCompare(input, goodAnswer)\n  if (ensembleDeNombres || kUplet)\n    return ensembleNombres(input, goodAnswer, { kUplet }) // ensembleDeNombres est non tri alors que kUplet ncessite le tri\n  if (suiteDeNombres || suiteRangeeDeNombres)\n    return ensembleNombres(input, goodAnswer, {\n      kUplet: suiteRangeeDeNombres,\n      avecAccolades: false,\n    })\n  if (\n    fractionSimplifiee ||\n    fractionReduite ||\n    fractionIrreductible ||\n    fractionDecimale ||\n    fractionEgale ||\n    fractionIdentique\n  )\n    return comparaisonFraction(input, goodAnswer, {\n      fractionReduite,\n      fractionIrreductible,\n      fractionDecimale,\n      fractionEgale,\n      fractionIdentique,\n      nombreDecimalSeulement,\n    }) // feedback OK\n  if (developpementEgal) return ontDeveloppementsEgaux(input, goodAnswer)\n\n  // Ici, c'est la comparaison par dfaut qui fonctionne dans la trs grande majorit des cas\n  return expressionDeveloppeeEtReduiteCompare(input, goodAnswer, {\n    expressionsForcementReduites,\n    avecSigneMultiplier,\n    avecFractions,\n    sansTrigo,\n    fractionIrreductible,\n    additionSeulementEtNonResultat,\n    soustractionSeulementEtNonResultat,\n    multiplicationSeulementEtNonResultat,\n    divisionSeulementEtNonResultat,\n    nombreDecimalSeulement,\n    calculFormel,\n  })\n}\n\n/**\n * Cette fonction permet que ComputeEngine fasse un super job avec la rduction d'expression et avec des options supplmentaires\n * @param {BoxedExpression} expr\n * @param {{\n *   expressionsForcementReduites: boolean,\n *   fractionIrreducibleSeulement: boolean,\n *   nombreDecimalSeulement: boolean,\n * }} [options]\n * @author Eric Elter (aid par ArnoG)\n * @return BoxedExpression\n */\nfunction customCanonical(\n  expr: BoxedExpression,\n  {\n    expressionsForcementReduites = true,\n    fractionIrreductible = false, // SANS DOUTE INUTILE MAINTENANT. A VERIFIER\n    nombreDecimalSeulement = false,\n  } = {},\n): BoxedExpression {\n  let expression = expr\n  if (nombreDecimalSeulement) {\n    // Fonctionnement : On retourne le calcul\n    return expression\n  }\n  // Fonctionnement par dfaut : Tout est accept si l'expression est un nombre\n  // Ci-dessous, on accepte le rsultat d'un calcul mais pas un autre enchanement Ici, si 4+2 est attendu, alors 4+2=6 mais 4+2!=5+1. C'est la valeur par dfaut\n  // Note: depuis compute-engine v0.30, .value ne retourne plus un number directement.\n  // On utilise .canonical.N().numericValue pour vrifier si l'expression est numrique.\n  const numericVal = expression.canonical.N().numericValue\n  if (numericVal !== null) {\n    // L'expression est une expression numrique, les expressions littrales ne sont pas traites ici\n    if (fractionIrreductible) {\n      if (\n        (expression.operator === 'Divide' ||\n          expression.operator === 'Rational') && // L'expression contient une division ou une fraction fractionIrreductible\n        (expression.engine\n          .box(['GCD', expression.op1, expression.op2])\n          .evaluate().numericValue !== 1 ||\n          expression.op2.numericValue === 1)\n      )\n        return expression\n\n      if (expression.operator === 'Number') {\n        // Ce cas est si un lve note 1.4 pour une fraction de 7/5 par exemple.\n        return engine.parse(`\\\\frac{${Number(numericVal)}}{1}`, {\n          canonical: false,\n        })\n      }\n    }\n    return expression.engine.number(Number(numericVal))\n  }\n  /* Supprim depuis la cration de expressionNumerique\n  if (expressionsForcementReduites) {\n    // Ici, le traitement n'est fait que pour des expressions forcment rduites\n    // Ci-dessous, on accepte que l'enchanement propos et pas le rsultat. Ici, si 4+2 est attendu, alors4+2!=6 et 4+2!=5+1\n    if (\n      (expression.operator === 'Divide' ||\n        expression.operator === 'Rational') &&\n      typeof expression.value === 'number'\n    ) {\n      if (fractionIrreductible) {\n        if (\n          expression.engine.box(['GCD', expression.op1, expression.op2])\n            .value !== 1 ||\n          expression.op2.value === 1\n        ) {\n          return expression\n        }\n      }\n      return expression.engine.number(expression.value)\n    }\n  }\n  */\n  if (expression.operator === 'Divide' || expression.operator === 'Rational') {\n    // Pour enlever les divisions ventuelles par 1\n    if (expression.op2.numericValue === 1) expression = expression.op1\n  }\n\n  // Ne pas prendre en compte les indices comme c_{n} // Sans doute plus du tout utile depuis l'introduction de l'option calculFormel\n  if (expression.operator !== 'Subscript')\n    if (expression.ops) {\n      // Pour ne pas accepter les +0, les \\\\times1, pour ne pas se soucier de l'ordre\n      return expression.engine.box(\n        [\n          expression.operator,\n          ...expression.ops.map((x) =>\n            customCanonical(x, {\n              expressionsForcementReduites,\n              fractionIrreductible,\n              nombreDecimalSeulement,\n            }),\n          ),\n        ],\n        { canonical: ['InvisibleOperator', 'Order', 'Flatten'] },\n      )\n    }\n  return expression.canonical\n}\n\n/**\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\n\nfunction comparaisonFraction(\n  input: string,\n  goodAnswer: string,\n  {\n    fractionReduite = false,\n    fractionIrreductible = false,\n    fractionDecimale = false,\n    fractionEgale = false,\n    fractionIdentique = false,\n    nombreDecimalSeulement = false,\n  } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    // 'fractions'\n    'fractionsMemesNegatives',\n  ])\n\n  const cleanIput = clean(input)\n  const cleanGoodAnswer = clean(goodAnswer)\n  const saisieNativeParsed = engine.parse(cleanIput, { canonical: false })\n  const reponseNativeParsed = engine.parse(cleanGoodAnswer, {\n    canonical: false,\n  })\n  // if (nombreDecimalSeulement) { console.log(reponseNativeParsed.toLatex(), reponseNativeParsed.N().toString()) }\n  if (nombreDecimalSeulement) {\n    if (\n      expressionDeveloppeeEtReduiteCompare(\n        cleanIput,\n        reponseNativeParsed.N().toString(),\n        { nombreDecimalSeulement: true },\n      ).isOk\n    ) {\n      return { isOk: true, feedback: '' }\n    }\n    // if (!(reponseNativeParsed.operator === 'Number' || (reponseNativeParsed.operator === 'Negate' && reponseNativeParsed.ops !== null && reponseNativeParsed.ops.length === 1))) return { isOk: false, feedback: 'Rsultat incorrect car une valeur dcimale (ou entire) est attendue.' }\n  }\n\n  // Note: depuis compute-engine v0.30, .value retourne undefined pour les fractions.\n  // On utilise .canonical.N().numericValue pour obtenir la valeur numrique.\n  const reponseParsed = reponseNativeParsed.engine.number(\n    Number(reponseNativeParsed.canonical.N().numericValue),\n  ) // Ici, c'est la valeur numrique (mme approche) de cleanGoodAnswer.\n  // Note: depuis compute-engine v0.30, isEqual sur des expressions non-canoniques\n  // compare la structure et non la valeur. On utilise .canonical pour comparer les valeurs.\n  if (saisieNativeParsed.canonical.isEqual(reponseNativeParsed.canonical)) {\n    if (fractionIdentique) {\n      if (saisieNativeParsed.isSame(reponseNativeParsed))\n        return { isOk: true, feedback: '' }\n      return {\n        isOk: false,\n        feedback: 'Le rsultat ne correspond pas  la fraction attendue.',\n      }\n    }\n    if (saisieNativeParsed.operator === 'Number' && reponseParsed.isInteger) {\n      // rponse est gale  un entier et saisie est un nombre entier (2) ou dcimal (2.0).\n      return { isOk: true }\n    }\n    if (fractionEgale) {\n      if (\n        saisieNativeParsed.operator === 'Divide' ||\n        saisieNativeParsed.operator === 'Rational' ||\n        (saisieNativeParsed.operator === 'Negate' &&\n          (saisieNativeParsed.op1.operator === 'Divide' ||\n            saisieNativeParsed.op1.operator === 'Rational'))\n      ) {\n        // saisie doit tre une fraction (ou une division)\n        // reponse doit avoir des numrateur/dnominateur multiples de ceux de saisie ou bien fractionReduite est true\n        let num, den\n        if (saisieNativeParsed.operator !== 'Negate') {\n          // Traitement des cas si la fraction est ngative ou pas.\n          num = saisieNativeParsed.op1.canonical.evaluate().numericValue\n          den = saisieNativeParsed.op2.canonical.evaluate().numericValue\n        } else {\n          num = saisieNativeParsed.op1.op1.canonical.evaluate().numericValue\n          den = saisieNativeParsed.op1.op2.canonical.evaluate().numericValue\n        }\n        if (Number.isInteger(num) && Number.isInteger(den)) {\n          return { isOk: true }\n        }\n        return {\n          isOk: false,\n          feedback:\n            'Rsultat incorrect car dnominateur et numrateur doivent tre entiers.',\n        }\n      }\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction est attendue.',\n      }\n    }\n    if (fractionDecimale) {\n      if (\n        (saisieNativeParsed.operator === 'Divide' ||\n          saisieNativeParsed.operator === 'Rational') &&\n        Number.isInteger(Math.log10(Number(saisieNativeParsed.op2.value))) &&\n        Math.log10(Number(saisieNativeParsed.op2.value)) >= 0\n      ) {\n        if (!saisieNativeParsed.op1.isInteger)\n          return {\n            isOk: false,\n            feedback: \"Rsultat incorrect car le numrateur n'est pas entier.\",\n          }\n        return { isOk: true }\n      }\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction dcimale est attendue.',\n      } // Sous-entendu : Et pas une autre fraction qu'irrductible\n    }\n    if (fractionIrreductible) {\n      if (\n        ((saisieNativeParsed.operator === 'Divide' ||\n          saisieNativeParsed.operator === 'Rational') &&\n          // Note: depuis compute-engine v0.30, .value retourne undefined pour les expressions.\n          // On utilise .evaluate().numericValue pour obtenir la valeur du GCD.\n          saisieNativeParsed.engine\n            .box(['GCD', saisieNativeParsed.op1, saisieNativeParsed.op2])\n            .evaluate().numericValue === 1) ||\n        saisieNativeParsed.canonical.isInteger\n      ) {\n        return { isOk: true }\n      }\n      return {\n        isOk: false,\n        feedback:\n          'Rsultat incorrect car une fraction irrductible est attendue.',\n      } // Sous-entendu : Et pas une autre fraction qu'irrductible\n    }\n    if (\n      (saisieNativeParsed.operator === 'Divide' ||\n        saisieNativeParsed.operator === 'Rational') && // saisie doit tre une fraction (ou une division)\n      Math.abs(Number(saisieNativeParsed.op1.value)) <\n        Math.abs(Number(reponseNativeParsed.op1.value)) && // saisie doit avoir des numrateur/dnominateur plus petits que reponse. Les valeurs absolues grent le cas des fractions ngatives.\n      saisieNativeParsed.op1.isInteger &&\n      saisieNativeParsed.op2.isInteger && // saisie doit avoir des numrateur/dnominateur entiers\n      (fractionReduite ||\n        Number(reponseNativeParsed.op1.value) %\n          Number(saisieNativeParsed.op1.value) ===\n          0)\n    ) {\n      // reponse doit avoir des numrateur/dnominateur multiples de ceux de saisie ou bien fractionReduite est true\n      return { isOk: true }\n      /// Ci-dessous : le traitement des feedback : les saisies sont gales aux rponses mais la saisie ne convient tout de mme pas.\n    }\n    if (!saisieNativeParsed.op1.value && !reponseParsed.isInteger) {\n      // Si pas de op1.value, c'est que saisie est un nombre alors que reponse n'est pas entier.\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction est attendue.',\n      } // Sous-entendu : Et pas un nombre\n    }\n    if (\n      saisieNativeParsed.operator === 'Divide' ||\n      saisieNativeParsed.operator === 'Rational'\n    ) {\n      if (\n        Math.abs(Number(saisieNativeParsed.op1.value)) >=\n        Math.abs(Number(reponseNativeParsed.op1.value))\n      ) {\n        return {\n          isOk: false,\n          feedback:\n            'Rsultat incorrect car une fraction simplifie est attendue.',\n        } // Sous-entendu : Et pas numrateur/dnominateur plus grands ou gaux que reponse.  Les valeurs absolues grent le cas des fractions ngatives.\n      }\n      if (\n        !saisieNativeParsed.op1.isInteger ||\n        !saisieNativeParsed.op2.isInteger\n      ) {\n        return {\n          isOk: false,\n          feedback:\n            'Rsultat incorrect car dnominateur et numrateur doivent tre entiers.',\n        } // Sous-entendu : Et pas numrateur/dnominateur dcimaux pour au moins l'un d'entre eux\n      }\n      // if (reponseNativeParsed.op1.value % saisieNativeParsed.op1.value !== 0) {\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction rduite est attendue.',\n      } // Sous-entendu : Et pas numrateur/dnominateur de reponse non multiples de ceux de saisie\n    }\n    return {\n      isOk: false,\n      feedback: 'Rsultat incorrect car une fraction est attendue.',\n    } // Sous-entendu : Et pas une opration autre qu'une division\n  }\n  return { isOk: false, feedback: 'Rsultat incorrect.' }\n}\n\n// Dfinir le type pour les substitutions\ntype Substitutions = { [variable: string]: number }\n\n/**\n * Comparaison d'expressions developpes ET REDUITES (multiplications acceptes, fractions acceptes... PAS ENCORE AVEC DES RACINES CARREES mais cela arrive.)\n * Comparaison aussi de tous les nombres (puisque c'est une expression rduite particulire)\n * On peut paramtrer si :\n * - on accepte ou pas les signes multiplier dans ces expressions,\n * - on accepte ou pas les fractions,\n * - on accepte ou pas les fractions irrductibles seulement (ou les entiers si den = 1),\n * - on n'accepte que l'enchanement de calculs fourni en goodAnswer et non le rsultat de cet enchanement de calculs\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{expressionsForcementReduites:boolean, avecSigneMultiplier:boolean, avecFractions:boolean, sansTrigo:boolean, fractionIrreducibleSeulement:boolean, nombreDecimalSeulement:boolean}} [options]\n * @author Eric Elter\n * @return ResultType\n */\n\nfunction expressionDeveloppeeEtReduiteCompare(\n  input: string,\n  goodAnswer: string,\n  {\n    expressionsForcementReduites = true,\n    avecSigneMultiplier = true,\n    avecFractions = true,\n    sansTrigo = false,\n    fractionIrreductible = false,\n    nombreDecimalSeulement = false,\n    additionSeulementEtNonResultat = false,\n    soustractionSeulementEtNonResultat = false,\n    multiplicationSeulementEtNonResultat = false,\n    divisionSeulementEtNonResultat = false,\n    calculFormel = false,\n  } = {},\n): ResultType {\n  let feedback = ''\n  // Ces 2 lignes sont  amliorer... EE : Faut que je teste un truc... et rajouter les racines carres aussi\n  if (!avecSigneMultiplier && input.includes('times'))\n    return { isOk: false, feedback: \"Aucun signe $\\\\times$ n'est autoris.\" }\n  if (!avecFractions && input.includes('frac'))\n    return { isOk: false, feedback: \"Aucune fraction n'est autorise.\" }\n  if (\n    sansTrigo &&\n    (input.includes('cos') || input.includes('sin') || input.includes('tan'))\n  )\n    return {\n      isOk: false,\n      feedback: \"Aucune fonction trigonomtrique n'est autorise.\",\n    }\n\n  const clean = generateCleaner([\n    'puissances',\n    'virgules',\n    // 'fractions',\n    'fractionsMemesNegatives',\n    'parentheses',\n    'foisUn',\n    'imaginaires',\n  ])\n  let localInput = clean(input)\n  const localGoodAnswer = clean(goodAnswer)\n\n  if (calculFormel)\n    if (\n      engine\n        .parse(localInput, { canonical: false })\n        .isEqual(engine.parse(localGoodAnswer, { canonical: false }))\n    )\n      return { isOk: true, feedback: '' }\n    else\n      return {\n        isOk: false,\n        feedback: 'La rponse fournie est incorrecte.',\n      }\n\n  if (nombreDecimalSeulement) {\n    localInput = localInput\n      .replace('(', '')\n      .replace(')', '')\n      .replace('\\\\lparen', '')\n      .replace('\\\\rparen', '') // Utile pour 5R20\n    const saisieParsed = engine.parse(localInput, { canonical: false })\n    if (\n      !(\n        saisieParsed.operator === 'Number' ||\n        (saisieParsed.operator === 'Negate' &&\n          saisieParsed.ops !== null &&\n          saisieParsed.ops.length === 1)\n      )\n    )\n      return {\n        isOk: false,\n        feedback:\n          'Rsultat incorrect car une valeur dcimale (ou entire) est attendue.',\n      }\n  }\n  const saisieParsed = customCanonical(\n    engine.parse(localInput, { canonical: false }),\n    {},\n  )\n\n  const reponseParsed = customCanonical(\n    engine.parse(localGoodAnswer, { canonical: false }),\n    {},\n  )\n\n  /* console.info(\n    JSON.stringify(engine.parse(localInput, { canonical: false }).json),\n  )\n  console.info(\n    JSON.stringify(engine.parse(localGoodAnswer, { canonical: false }).json),\n  )\n*/\n  /// Code JCL\n  // Ci-dessous, si on a une comparaison fausse mais que l'expression donne est mathmatiquement correcte, on fait un feedback.\n  const substitutions: Substitutions = { a: 2, b: 2, c: 2, x: 2, y: 2, z: 2 } // On peut ajouter d'autres variables si ncessaire\n\n  if (\n    additionSeulementEtNonResultat ||\n    soustractionSeulementEtNonResultat ||\n    multiplicationSeulementEtNonResultat ||\n    divisionSeulementEtNonResultat\n  ) {\n    const parsedExpression = engine.parse(localInput, { canonical: false })\n    if (\n      parsedExpression.operator === 'Add' &&\n      (parsedExpression.op1.is(0) || parsedExpression.op2.is(0))\n    ) {\n      feedback = 'Rsultat incorrect car la somme par 0 est inutile.' // Sous-entendu : Pas de '+0'\n      return { isOk: false, feedback }\n    }\n    if (input.includes('-0')) {\n      feedback = 'Rsultat incorrect car la diffrence par 0 est inutile.' // Sous-entendu : Pas de '-0'\n      return { isOk: false, feedback }\n    }\n    if (\n      parsedExpression.operator === 'Multiply' &&\n      (parsedExpression.op1.is(1) || parsedExpression.op2.is(1))\n    ) {\n      feedback = 'Rsultat incorrect car le produit par 1 est inutile.' // Sous-entendu : Pas de 'fois 1'\n      return { isOk: false, feedback }\n    }\n    if (\n      (parsedExpression.operator === 'Divide' ||\n        parsedExpression.operator === 'Rational') &&\n      parsedExpression.op2.is(0)\n    ) {\n      feedback = 'Rsultat incorrect car la division par 1 est inutile.' // Sous-entendu : Pas de 'divis par 1'\n      return { isOk: false, feedback }\n    }\n  }\n\n  if (\n    saisieParsed.isEqual(reponseParsed) &&\n    !saisieParsed.isSame(reponseParsed)\n  ) {\n    if (\n      additionSeulementEtNonResultat ||\n      soustractionSeulementEtNonResultat ||\n      multiplicationSeulementEtNonResultat ||\n      divisionSeulementEtNonResultat\n    ) {\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n          nombreDecimalSeulement,\n        },\n      )\n      const reponseCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n        },\n      )\n      if (saisieCalculeeParsed.isSame(reponseCalculeeParsed)) {\n        if (additionSeulementEtNonResultat && saisieParsed.operator === 'Add')\n          // Todo : On a, ici, un pb. Si on attend 3+2, alors 6-1 sera accept. Et on ne peut pas exclure le '-' car 6+(-1) serait correct\n          // 26/08/2025 : Pb dans les mains de @ArnoG qui ne sait pas encore commment le rgler.\n          return { isOk: true, feedback: '' }\n        if (\n          multiplicationSeulementEtNonResultat &&\n          (saisieParsed.operator === 'Multiply' ||\n            saisieParsed.operator === 'Power')\n        )\n          return { isOk: true, feedback: '' }\n        if (\n          divisionSeulementEtNonResultat &&\n          (saisieParsed.operator === 'Divide' ||\n            saisieParsed.operator === 'Power')\n        )\n          return { isOk: true, feedback: '' }\n\n        // Ce code ci-dessous dans l'absolu devrait fonctionner sauf que parse transforme une soustraction en une addition : 6-3=6+(-3)\n        // if (soustractionSeulementEtNonResultat && saisieParsed.operator === 'Substract') return { isOk: true, feedback: '' }\n\n        // Donc par rapport  ce qui est au-dessus, il faut chercher l'absence d'un dlimiter devant le -.\n        // console.info(JSON.stringify(ce.parse('12+(-2)', { canonical: false }).json));\n        // -> [\"Add\",12,[\"Delimiter\",[\"Negate\",2]]]\n        // console.info(JSON.stringify(ce.parse('12-2', { canonical: false }).json));\n        // -> [\"Add\",12,[\"Negate\",2]]\n\n        // Il faut en plus que le negate soit devant le Delimiter sinon 3+(-2) serait accept comme soustraction pour 3-2.\n        const saisieJSON = JSON.stringify(\n          engine.parse(localInput, { canonical: false }).json,\n        )\n        function negateBeforeDelimiter(node: string): boolean {\n          const iNeg = node.indexOf('Negate')\n          const iDel = node.indexOf('Delimiter')\n          return iNeg !== -1 && (iDel === -1 || iNeg < iDel)\n        }\n\n        // Todo : On a, ici, encore un pb. Si on attend 3-2, alors 3+-2 et 3-+2 seront accepts.\n        // 26/08/2025 : Pb dans les mains de @ArnoG qui ne sait pas encore commment le rgler.\n\n        if (\n          soustractionSeulementEtNonResultat &&\n          negateBeforeDelimiter(saisieJSON)\n        ) {\n          return { isOk: true, feedback: '' }\n        }\n      }\n    }\n  }\n  if (!saisieParsed.isSame(reponseParsed)) {\n    // On va essayer de traiter ici tous les feedbacks de faon exhaustive\n    if (nombreDecimalSeulement) {\n      // On veut un rsultat numrique et pas un enchanement de calculs\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n          nombreDecimalSeulement: false,\n        },\n      )\n\n      if (saisieCalculeeParsed.isSame(reponseParsed))\n        feedback = 'Rsultat incorrect car une valeur numrique est attendue.' // Sous-entendu : Et pas une opration\n      else feedback = 'Rsultat incorrect.'\n    } else if (\n      additionSeulementEtNonResultat ||\n      soustractionSeulementEtNonResultat ||\n      multiplicationSeulementEtNonResultat ||\n      divisionSeulementEtNonResultat\n    ) {\n      // On veut un enchanement de calculs et pas un rsultat numrique\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n          nombreDecimalSeulement,\n        },\n      )\n      const reponseCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n        },\n      )\n      if (saisieCalculeeParsed.isSame(reponseCalculeeParsed)) {\n        if (saisieParsed.operator === 'Number') {\n          feedback = 'Rsultat incorrect car un calcul est attendu.' // Sous-entendu : Et pas une valeur numrique\n        } else {\n          feedback = 'Rsultat incorrect car '\n          feedback += additionSeulementEtNonResultat\n            ? \"c'est une somme qui est attendue.\"\n            : soustractionSeulementEtNonResultat\n              ? \"c'est une diffrence qui est attendue.\"\n              : multiplicationSeulementEtNonResultat\n                ? \"c'est un produit qui est attendu.\"\n                : divisionSeulementEtNonResultat\n                  ? \"c'est un quotient qui est attendu.\"\n                  : \"ce n'est pas ce calcul qui est attendu.\" // Sous-entendu : La bonne opration */\n        }\n      } else feedback = 'Rsultat incorrect.'\n    } else if (fractionIrreductible) {\n      // On veut une fraction irrductible\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible: false,\n        },\n      )\n      const reponseCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible: false,\n        },\n      )\n      if (saisieCalculeeParsed.isSame(reponseCalculeeParsed)) {\n        // Ci-dessous, ce n'est pas saisieParsed car saisieParsed n'est jamais un nombre  cause de customCanonical et fractionIrreductible.\n        if (\n          engine.parse(localInput, { canonical: false }).operator === 'Number'\n        )\n          feedback = 'Rsultat incorrect car une fraction est attendue.' // Sous-entendu : Et pas une valeur numrique\n        else\n          feedback =\n            'Rsultat incorrect car une fraction irrductible est attendue.' // Sous-entendu : La bonne opration\n      } else feedback = 'Rsultat incorrect.'\n    } else if (\n      // Code JCL. ---> EE : Ce code renvoie un feebback incorrect si input = (-5)^n \\\\times (-8) et goodAnswer = -8 \\\\times (-5)^n. Dommage ! Je laisse ce code car s'il est l, c'est qu'il doit tre utile  un moment. Pas encore compris lequel.\n      !saisieParsed.isSame(reponseParsed) &&\n      evaluateExpression(localGoodAnswer, substitutions) ===\n        evaluateExpression(localInput, substitutions)\n    ) {\n      feedback = 'Incorrect'\n      /* Ce feedback ne devrait fonctionner que si on a des expressions littrales mais actuellement, ce n'est pas le cas donc on l'enlve provisoirement\n      // Ajout d'un test sur goodAnswer pour vrifier la prsence de lettres (aprs avoir retir les div, times, frac...)\n  const adjectif =\n    localGoodAnswer\n      .replaceAll('div', '')\n      .replaceAll('times', '')\n      .replaceAll('frac', '')\n      .replaceAll('log', '')\n      .replaceAll('ln', '')\n      .replaceAll('sin', '')\n      .replaceAll('cos', '')\n      .replaceAll('tan', '')\n      .match(/[a-z]/) == null\n      ? 'numrique'\n      : 'littrale'\nfeedback = expressionsForcementReduites\n        ? `L'expression ${adjectif} attendue devrait tre dveloppe et rduite or ce n'est pas le cas.`\n        : `L'expression ${adjectif} attendue devrait tre simplement dveloppe or ce n'est pas le cas.`\n      */\n    }\n  }\n  return { isOk: saisieParsed.isSame(reponseParsed), feedback }\n}\n\n/**\n * Fonction pour valuer une expression avec des substitutions dynamiques (quelle que soit la lettre utilise dans substitutions)\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return {boolean}\n */\n\nexport function ontDeveloppementsEgaux(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const clean = generateCleaner([\n    'puissances',\n    'virgules',\n    'parentheses',\n    'foisUn',\n  ])\n  const localInput = clean(input)\n  const localGoodAnswer = clean(goodAnswer)\n  const expr1 = engine.parse(localInput, { canonical: true })\n  const expr2 = engine.parse(localGoodAnswer, { canonical: true })\n\n  if (!expr1.ops || !expr2.ops)\n    return { isOk: false, feedback: \"Cette expression n'est pas dveloppe.\" }\n  if (expr1.operator !== expr2.operator)\n    return { isOk: false, feedback: \"Cette expression n'est pas dveloppe.\" }\n\n  // On va tenter de rduire expr1\n  let expr1Reduite = engine.parse('0')\n  for (const item1 of expr1.ops) {\n    expr1Reduite = expr1Reduite.add(item1)\n  }\n\n  // On va tenter de rduire expr2\n  let expr2Reduite = engine.parse('0')\n  for (const item2 of expr2.ops) {\n    expr2Reduite = expr2Reduite.add(item2)\n  }\n\n  return {\n    isOk: expr1Reduite.isSame(expr2Reduite),\n    feedback: expr1Reduite.isSame(expr2Reduite)\n      ? ''\n      : expr1Reduite.isEqual(expr2Reduite)\n        ? \"Cette expression n'est pas assez dveloppe.\"\n        : 'Incorrect',\n  }\n}\n\n/**\n * Fonction pour valuer une expression avec des substitutions dynamiques (quelle que soit la lettre utilise dans substitutions)\n * @param {BoxedExpression} expr\n * @param {Substitutions} substitutions\n * @example evaluateExpression('3x+5', { x: 2}) -> 11\n * @example evaluateExpression('3x+5', { y: 2}) -> NAN\n * @example evaluateExpression('3x+5', { c: 2, x: 2, y: 2}) -> 5\n * @author Eric Elter\n * @return {integer||string}\n */\nfunction evaluateExpression(\n  expr: string,\n  substitutions: Substitutions,\n): number | string {\n  // Dfinir l'expression\n  const expression = engine.parse(expr)\n\n  // Faire les substitutions\n  let substituted = expression\n  for (const [variable, value] of Object.entries(substitutions)) {\n    substituted = substituted.subs({ [variable]: value })\n  }\n\n  // valuer l'expression substitue\n  const result = substituted.evaluate().value\n\n  // Convertir le rsultat en nombre ou 'NAN' si ce n'est pas un nombre\n  if (typeof result === 'number') {\n    return result\n  }\n  return 'NAN'\n}\n/**\n * comparaison d'expressions developpes NON REDUITES\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\nexport function expressionDeveloppeeEtNonReduiteCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  return expressionDeveloppeeEtReduiteCompare(input, goodAnswer, {\n    expressionsForcementReduites: false,\n  })\n}\n\n/**\n * Vrifie si une chane est en notation scientifique LaTeX valide.\n * Gre les formes \"a\\\\times10^{b}\" et \"10^{b}\\\\timesa\".\n * Retourne un objet avec isOk et feedback.\n * @author Eric Elter\n */\n/**\n * Vrifie si une chane est en notation scientifique LaTeX valide.\n * Gre les formes \"a\\\\times10^b\" et \"10^b\\\\timesa\" avec ou sans accolades.\n * Retourne un objet avec isOk et feedback.\n * @author Eric Elter\n */\nfunction isScientific(str: string): { isOk: boolean; feedback: string } {\n  // Regex 1 : a\\times10^b ou a\\times10^{b}\n  const regex1 = /^(-?\\d+(?:\\.\\d+)?)\\\\times10\\^{?(-?\\d+)}?$/\n  // Regex 2 : 10^b\\timesa ou 10^{b}\\timesa\n  const regex2 = /^10\\^{?(-?\\d+)}?\\\\times(-?\\d+(?:\\.\\d+)?)$/\n\n  let base: number | null = null\n  let exponent: number | null = null\n\n  if (regex1.test(str)) {\n    const match = str.match(regex1)!\n    base = Number(match[1])\n    exponent = Number(match[2])\n  } else if (regex2.test(str)) {\n    const match = str.match(regex2)!\n    exponent = Number(match[1])\n    base = Number(match[2])\n  } else {\n    return {\n      isOk: false,\n      feedback: 'Format incorrect : utilisez a\\\\times10^b ou 10^b\\\\timesa.',\n    }\n  }\n\n  if (isNaN(base) || isNaN(exponent)) {\n    return {\n      isOk: false,\n      feedback: \"La mantisse ou l'exposant n'est pas un nombre valide.\",\n    }\n  }\n\n  if (Math.abs(base) < 1) {\n    return { isOk: false, feedback: 'La mantisse doit tre  1.' }\n  }\n\n  if (Math.abs(base) >= 10) {\n    return { isOk: false, feedback: 'La mantisse doit tre < 10.' }\n  }\n\n  return { isOk: true, feedback: 'La notation est correcte.' }\n}\n\n/**\n * Comparaison de nombres en notation scientifique\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Eric Elter\n */\nfunction scientifiqueCompare(input: string, goodAnswer: string): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'espaces',\n    'parentheses',\n    'puissances',\n  ])\n  const saisieClean = clean(input)\n  const reponseClean = clean(goodAnswer)\n\n  let saisieCleanFormattee = saisieClean\n    .replace(/\\s+/g, '') // Supprimer tous les espaces\n    .replace(/\\\\times/g, '\\\\cdot') // Remplacer \\times par \\cdot\n    .replace(/\\^(\\d+)/g, '^{$1}') // Ajouter des accolades autour des exposants\n    .replace(/\\{\\+(\\d+)\\}/g, '{$1}') // Remplacer {+a} par {a}\n\n  // Si la puissance est 0, on accepte mais computeEngine ne met pas en notation scientitique et donc la comparaison entre notation scientifique n'est pas possible.\n  // Donc il faut ces trois lignes pour comparer les nombres dcimaux, dans ce cas prcis.\n  const match = saisieCleanFormattee.match(/\\^{(-?\\d+)}$/) // Recherche des nombres entre accolades\n  const puissance = match ? number(match[match.length - 1]) : null\n  if (puissance === 0)\n    saisieCleanFormattee = engine\n      .parse(saisieClean)\n      .toLatex({ notation: 'scientific', avoidExponentsInRange: [0, 0] })\n\n  // Ce code ci-dessous sera  supprimer aprs correction de l'issue 223 de computeEngine 0.27.0\n  const regex = /(?:\\{(-?\\d+(?:\\.\\d+)?)\\}|(-?\\d+(?:\\.\\d+)?))\\\\cdot(.+)/ // Expression rgulire pour capturer le nombre avant et ce qui suit \\cdot\n  const decoupageSaisie = saisieCleanFormattee.match(regex)\n\n  let mantisseSaisie: string | null = null\n  if (decoupageSaisie) {\n    mantisseSaisie = decoupageSaisie[1] || decoupageSaisie[2] || null\n    if (mantisseSaisie === '1' && decoupageSaisie[3])\n      saisieCleanFormattee = decoupageSaisie[3].trim()\n  }\n  // Ce code ci-dessus sera  supprimer aprs correction de l'issue 223 de computeEngine 0.27.0\n\n  const reponseCleanFormattee = engine\n    .parse(reponseClean)\n    .toLatex({ notation: 'scientific', avoidExponentsInRange: [0, 0] })\n\n  saisieCleanFormattee = saisieCleanFormattee.replace(\n    /(\\d+\\.?\\d*?)0*(?=\\\\cdot)/,\n    '$1',\n  ) // Pour corriger 9.040\\\\cdot10^{4} en 9.04\\\\cdot10^{4}\n\n  if (saisieCleanFormattee === reponseCleanFormattee) return { isOk: true }\n  if (engine.parse(saisieClean).isEqual(engine.parse(reponseClean)))\n    return {\n      isOk: false,\n      feedback:\n        \"La rponse fournie est bien gale  celle attendue mais la rponse fournie n'est pas en notation scientifique.\",\n    }\n  if (isScientific(saisieClean).isOk)\n    return {\n      isOk: false,\n      feedback:\n        \"La rponse fournie est bien en notation scientifique mais la rponse fournie n'est pas gale  celle attendue.\",\n    }\n  return {\n    isOk: false,\n    feedback: \"La rponse fournie n'est pas gale  celle attendue.\",\n  }\n}\n\n/**\n * comparaison de textes... ben parce qu'il en faut une\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n * @return ResultType\n */\nfunction texteAvecCasseCompare(input: string, goodAnswer: string): ResultType {\n  const cleaner = generateCleaner([\n    'parentheses',\n    'mathrm',\n    'fractions',\n    'virgules',\n  ])\n\n  // Ligne ci-dessous utile si la rponse est (B,F) comme dans 2S30-5\n  input = input.replace(\n    /\\\\lparen\\s*([^{}]+)\\s*\\{,\\}\\s*([^{}]+)\\s*\\\\rparen/g,\n    '($1,$2)',\n  )\n\n  // Ligne ci-dessous utile si la rponse est P(A\\cap B) comme dans 1P10-1\n  input = input.replace(/\\\\lparen\\s*/g, '(').replace(/\\\\rparen/g, ')')\n\n  goodAnswer = goodAnswer.replace(/\\\\lparen\\s*/g, '(').replace(/\\\\rparen/g, ')')\n\n  let localInput = cleaner(input)\n  const localGoodAnswer = cleaner(goodAnswer)\n  const clean = generateCleaner(['espaceNormal', 'doubleEspaces'])\n  localInput = clean(localInput)\n\n  // Cette commande ci-dessous est mauvaise Je la laisse pour expliquer pourquoi elle est mauvaise.\n  // Autant, elle serait utile pour comparer 'aucun' et 'Aucun'\n  // mais elle ne le serait plus pour comparer [AB] et [ab] ce qui serait dommage.\n  // return { isOk: input.toLowerCase() === goodAnswer.toLowerCase() }\n  return { isOk: localGoodAnswer === localInput }\n}\n\n/**\n * comparaison de textes avec espaces comme son nom l'indique : avec un nettoyage adapt  la situation\n * Utilise String.localeCompare() pour les spcificits du langage local utilis.\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nexport function textWithSpacesCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'latex',\n    'doubleEspaces',\n  ])\n  const localGoodAnswer = clean(goodAnswer)\n  const localInput = clean(input)\n  const result = localInput.localeCompare(localGoodAnswer)\n  return { isOk: result === 0 }\n}\n/* Cette fonction n'a pas lieu d'exister car elle ne fait pas ce pour quoi elle est prvue.\nUne autre fonction fait ce qu'il faut en dessous.\n/**\n * comparaison de textes sans s'occuper de la casse.\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n * @return ResultType\n\n////////////  -> Mettre etoile /\nexport function upperCaseCompare (input: string, goodAnswer: string): ResultType {\n\n  // @ToDo supprimer toutes les traces de LaTeX (gestion du - typographique...)\n  input = input.replaceAll('\\\\lparen', '(').replaceAll('\\\\rparen', ')')\n  return { isOk: input.toUpperCase() === goodAnswer.toUpperCase() }\n}\n*/\n\n/**\n * comparaison de textes sans s'occuper de la casse.\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\nexport function texteSansCasseCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const localInput = input.toLowerCase()\n  const localGoodAnswer = goodAnswer.toLowerCase()\n  return texteAvecCasseCompare(localInput, localGoodAnswer)\n}\n\nexport function expressionNumeriqueCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const cleaner = generateCleaner(['fractions'])\n  const localGoodAnswer = cleaner(goodAnswer)\n  const goodAnswerParsed = engine.parse(localGoodAnswer, { canonical: true }) // Important ce canonical  true\n  const inputParsed = engine.parse(input, { canonical: true })\n  // console.log(input, localGoodAnswer, goodAnswerParsed.json)\n  if (goodAnswerParsed.isSame(inputParsed)) return { isOk: true }\n  if (goodAnswerParsed.isEqual(inputParsed))\n    if (inputParsed.isNumber) {\n      return {\n        isOk: false,\n        feedback:\n          'Ce rsultat pourrait tre correct mais un calcul est attendu.',\n      }\n    } else\n      return {\n        isOk: false,\n        feedback:\n          \"Ce rsultat pourrait tre correct mais ce n'est pas ce calcul qui est attendu.\",\n      }\n  return {\n    isOk: false,\n    feedback:\n      \"Ce rsultat pourrait tre correct mais ce n'est pas ce calcul qui est attendu.\",\n  }\n}\n\n/**\n * comparaison de fraction simplifie\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nexport function simplerFractionCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const cleaner = generateCleaner(['fractions', 'espaces'])\n  const localGoodAnswer = cleaner(goodAnswer)\n  const goodAnswerParsed = engine.parse(localGoodAnswer, { canonical: false })\n  const inputParsed = engine.parse(input, { canonical: false })\n  if (\n    inputParsed.operator === 'Divide' &&\n    goodAnswerParsed.operator === 'Divide'\n  ) {\n    const num = (inputParsed.json as [string, number, number])[1] as number\n    const numGoodAnswer = (\n      goodAnswerParsed.json as [string, number, number]\n    )[1] as number\n    if (numGoodAnswer == null) {\n      throw Error(\n        `problme avec ${localGoodAnswer} dans simplerFractionCompare : fReponse.op1.numericValue est nul`,\n      )\n    }\n    if (\n      inputParsed.isEqual(goodAnswerParsed) &&\n      num &&\n      num < numGoodAnswer &&\n      Number.isInteger(num)\n    ) {\n      return { isOk: true }\n    }\n  }\n  return { isOk: false }\n}\n\n/**\n * Comparaison de fraction en acceptant toute valeur (y compris la valeur dcimale) mais n'acceptant de racine carre au dnominateur\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\nexport function equalFractionCompareSansRadical(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const cleaner = generateCleaner(['fractions'])\n  const localInput = cleaner(input)\n  const localGoodAnswer = cleaner(goodAnswer)\n\n  // Utilisation d'une expression rgulire pour extraire le contenu de la deuxime accolade\n  const contenuDeuxiemeAccolade: string | null =\n    localInput.match(/\\\\frac{[^}]*}{(\\\\sqrt[^}]*)/)?.[1] || null\n\n  // if (contenuDeuxiemeAccolade === null) return { isOk: equalFractionCompare(input, goodAnswer).isOk }\n  // else if (!contenuDeuxiemeAccolade.includes('sqrt')) return { isOk: equalFractionCompare(input, goodAnswer).isOk }\n  if (contenuDeuxiemeAccolade === null) {\n    return { isOk: fonctionComparaison(localInput, localGoodAnswer).isOk }\n  }\n  if (!contenuDeuxiemeAccolade.includes('sqrt')) {\n    return { isOk: fonctionComparaison(localInput, localGoodAnswer).isOk }\n  }\n  return { isOk: false }\n}\n\n/**\n * Comparaison de puissances\n * @param {string} input\n * @param {string} goodAnswer\n * @param {Object} [options={}] - Options pour la comparaison.\n * @param {boolean} [options.seulementCertainesPuissances=false] - Si false, toutes les formes de puissances seront acceptes.\n * @param {boolean} [options.sansExposantUn=false] - Si false, l'exposant 1 sera accept comme valide.\n * @return ResultType\n * @author Eric Elter\n */\nfunction comparaisonPuissances(\n  input: string,\n  goodAnswer: string,\n  { seulementCertainesPuissances = false, sansExposantUn = false } = {},\n): ResultType {\n  const clean = generateCleaner(['virgules', 'puissances'])\n  const nombreSaisi = clean(input).split('^')\n  const goodAnswerSplit = clean(goodAnswer).split('^')\n\n  // input n'est pas une puissance (mais cas possiblement correct si exposant de goodAnswer est 1 ou 0)\n  if (nombreSaisi.length === 1) {\n    const exposantGoodAnswer = isNaN(\n      Number(goodAnswerSplit[1].replace(/[{}]/g, '')),\n    )\n      ? 1\n      : goodAnswerSplit[1].replace(/[{}]/g, '')\n    if (\n      (Number(exposantGoodAnswer) === 1 || Number(exposantGoodAnswer) === 0) &&\n      engine.parse(clean(input)).isEqual(engine.parse(clean(goodAnswer)))\n    )\n      return { isOk: true }\n    return { isOk: false, feedback: 'Une puissance est attendue.' }\n  }\n  // input n'est pas une puissance de puissance\n  if (seulementCertainesPuissances && nombreSaisi.length > 2)\n    return { isOk: false, feedback: 'Un seul exposant est attendu.' }\n\n  let mantisseSaisie = nombreSaisi[0]\n  mantisseSaisie = mantisseSaisie.replace(/\\\\lparen|\\\\rparen|\\(|\\)/g, '') // Pour enlever les parenthses afin que (-4)^2 soit accepte\n  mantisseSaisie = mantisseSaisie.replace(/--/g, '') // Pour accepter les deux - conscutifs.\n\n  // La mantisse saisie est-elle un nombre ?\n  if (Number.isNaN(mantisseSaisie))\n    return {\n      isOk: false,\n      feedback: \"Avant l'exposant, on attend un nombre unique.\",\n    } // Pour viter 1\\times4^2\n\n  let exposantSaisi = nombreSaisi[1]\n  exposantSaisi = exposantSaisi.replace(/\\\\lparen|\\\\rparen|\\(|\\)/g, '') // Pour enlever les parenthses\n  exposantSaisi = exposantSaisi.replace(/--/g, '') // Pour accepter les deux - conscutifs.\n  exposantSaisi = exposantSaisi.replace(/[{}]/g, '') // Pour enlever les accolades (possible si exposant dcimal ou ngatif)\n  const exposantSaisiNumber = Number(exposantSaisi)\n  // L'exposnat saisi est-il un nombre ?\n  if (Number.isNaN(exposantSaisiNumber))\n    return {\n      isOk: false,\n      feedback: 'On attend un nombre unique comme exposant.',\n    } // Pour viter 4^{1+1}\n\n  // goodAnswer n'est pas une puissance donc toute puissance gale  goodAnswer est correcte (modulo sansExposantUn)\n  if (goodAnswerSplit.length === 1) {\n    if (sansExposantUn && exposantSaisiNumber === 1)\n      return { isOk: false, feedback: 'On attend un exposant diffrent de 1.' }\n    const isOk = engine\n      .parse(clean(input))\n      .isEqual(engine.parse(clean(goodAnswer)))\n    return {\n      isOk: !!isOk,\n      feedback: isOk ? '' : \"La puissance n'est pas gale au rsultat attendu.\",\n    }\n  }\n\n  // goodAnswer et input sont des puissances alors deux cas se prsentent.\n  if (sansExposantUn) {\n    // On accepte un input avec un exposant de 1 que si goodAnswer en a un aussi.\n    let exposantGoodAnswer = goodAnswerSplit[1]\n    exposantGoodAnswer = exposantGoodAnswer.replace(\n      /\\\\lparen|\\\\rparen|\\(|\\)/g,\n      '',\n    ) // Pour enlever les parenthses\n    exposantGoodAnswer = exposantGoodAnswer.replace(/--/g, '') // Pour accepter les deux - conscutifs.\n    const exposantGoodAnswerNumber = Number(exposantGoodAnswer)\n    if (exposantSaisiNumber === 1) {\n      if (exposantGoodAnswerNumber !== 1)\n        return {\n          isOk: false,\n          feedback: 'On attend un exposant diffrent de 1.',\n        } // Trs important car parfois, par le calcul, on attend 4^1\n    }\n  }\n  // Ou bien on n'accepte que si goodAnswer et input sont parfaitement identiques : seulementCertainesPuissances = true\n  // Ou bien on n'accepte toute galit entre goodAnswer et input : seulementCertainesPuissances = false\n  const isOk = !seulementCertainesPuissances\n    ? engine.parse(clean(input)).isEqual(engine.parse(clean(goodAnswer)))\n    : engine.parse(clean(input)).isSame(engine.parse(clean(goodAnswer)))\n  if (!isOk) {\n    if (engine.parse(clean(input)).isEqual(engine.parse(clean(goodAnswer))))\n      return {\n        isOk: false,\n        feedback:\n          \"La puissance est gale au rsultat attendu mais ne correspond pas  l'nonc.\",\n      }\n    return {\n      isOk: false,\n      feedback: \"La puissance n'est pas gale au rsultat attendu.\",\n    }\n  }\n  return { isOk: true }\n}\n\n/**\n * Comparaison d'ensembles de solutions spars par des ; dans des {} comme {-5;4;10}\n * Si kUplet = true, alors les nombres de l'usager devront tre rangs par ordre croissant. Sinon non importance de l'ordre des nombres\n * Mise en place de feedback\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Eric Elter\n */\nexport function ensembleNombres(\n  input: string,\n  goodAnswer: string,\n  { kUplet = false, avecAccolades = true } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'fractions',\n    'parentheses',\n    'espaces',\n    'espaceNormal',\n    'doubleEspaces',\n  ])\n  const cleanInput = clean(input)\n    .replaceAll('', '\\\\emptyset')\n    .replaceAll('\\\\lbrace', '\\\\{')\n    .replaceAll('\\\\rbrace', '\\\\}')\n  goodAnswer = clean(goodAnswer)\n\n  if (goodAnswer === '\\\\emptyset' && cleanInput === goodAnswer)\n    return { isOk: true }\n  if (goodAnswer === '\\\\emptyset' && cleanInput.includes('\\\\emptyset'))\n    return {\n      isOk: false,\n      feedback: 'Rsultat incorrect car $\\\\emptyset doit tre crit seul.',\n    }\n  let splitInput: string[]\n  let splitGoodAnswer: string[]\n  if (avecAccolades) {\n    if (cleanInput[1] !== '{')\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble doit commencer par une accolade ou bien tre l'ensemble vide.\",\n      }\n    if (cleanInput[cleanInput.length - 1] !== '}')\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble doit se terminer par une accolade ou bien tre l'ensemble vide.\",\n      }\n    splitInput = cleanInput\n      .replaceAll('\\\\{', '')\n      .replaceAll('\\\\}', '')\n      .split(';')\n    splitGoodAnswer = clean(goodAnswer)\n      .replaceAll('\\\\{', '')\n      .replaceAll('\\\\}', '')\n      .split(';')\n  } else {\n    if (cleanInput.endsWith(';'))\n      return {\n        isOk: false,\n        feedback:\n          'Une suite de nombres ne doit pas se terminer par un point-virgule.',\n      }\n\n    if (!/^-?\\d+(?:\\.\\d+)?(?:;-?\\d+(?:\\.\\d+)?)*$/.test(cleanInput))\n      // Pour vrifier que le sparateur est bien un point-virgule.\n      return {\n        isOk: false,\n        feedback: 'Les nombres doivent tous tre spars par un point-virgule.',\n      }\n    splitInput = cleanInput.split(';')\n    splitGoodAnswer = clean(goodAnswer).split(';')\n  }\n\n  // Pour vrifier la prsence de doublons\n  if (new Set(splitInput).size !== splitInput.length)\n    return {\n      isOk: false,\n      feedback:\n        'Rsultat incorrect car cet ensemble contient des valeurs redondantes.',\n    }\n\n  // Pour vrifier si les tableaux sont de la mme taille\n  if (splitInput.length > splitGoodAnswer.length) {\n    return {\n      isOk: false,\n      feedback: 'Rsultat incorrect car cet ensemble contient trop de nombres.',\n    }\n  }\n  if (splitInput.length < splitGoodAnswer.length) {\n    return {\n      isOk: false,\n      feedback:\n        'Rsultat incorrect car cet ensemble ne contient pas assez de nombres (les nombres doivent tre spars par un ; et non par une virgule).',\n    }\n  }\n\n  const inputSorted = splitInput\n  const goodAnswerSorted = splitGoodAnswer\n\n  const AllExist = inputSorted.every((value) => {\n    for (let index = 0; index < goodAnswerSorted.length; index++) {\n      if (engine.parse(value).isEqual(engine.parse(goodAnswerSorted[index]))) {\n        // Laisser isEqual car avec certaines fractions, on a des misres\n        return true // L'lment est trouv\n      }\n    }\n    return false // L'lment n'est pas trouv\n  })\n\n  if (!AllExist) {\n    if (splitGoodAnswer.length === 1)\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble n'a pas la valeur attendue.\",\n      }\n    else\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble n'a pas toutes les valeurs attendues.\",\n      }\n  }\n  if (\n    kUplet &&\n    !splitInput.every((value, index) =>\n      engine.parse(value).isSame(engine.parse(goodAnswerSorted[index])),\n    )\n  ) {\n    return {\n      isOk: false,\n      feedback:\n        'Rsultat incorrect car les nombres ne sont pas rangs dans le bon ordre.',\n    }\n  }\n  return { isOk: true }\n}\n\n/**\n * La fonction de comparaison des intervalles pour l'interactif\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n */\nfunction intervalsCompare(input: string, goodAnswer: string) {\n  const clean = generateCleaner(['virgules', 'parentheses', 'espaces'])\n  const replaceTable = [\n    // Indispensable pour grer les copier-coller\n    ['', '\\\\emptyset'],\n    ['', '\\\\cup'],\n    ['', '\\\\cup'],\n    ['', '\\\\cap'],\n    ['', '\\\\cap'],\n    ['', '\\\\mathbb{N}'],\n    ['', '\\\\mathbb{Z}'],\n    ['', '\\\\mathbb{D}'],\n    ['', '\\\\mathbb{Q}'],\n    ['', '\\\\mathbb{R}'],\n    ['', '\\\\mathbb{C}'],\n  ]\n  const localInput = replaceTable.reduce((currentInput, replacement) => {\n    return currentInput.replaceAll(replacement[0], replacement[1])\n  }, clean(input))\n  const localGoodAnswer = clean(goodAnswer)\n  if (localGoodAnswer === '\\\\emptyset') {\n    if (localInput === '\\\\emptyset' || localInput === '\\\\{\\\\}')\n      return { isOk: true, feedback: '' }\n    return {\n      isOk: false,\n      feedback: \"la bonne rponse tait l'ensemble vide : $\\\\emptyset$\",\n    }\n  } else {\n    const match = localGoodAnswer.match(/\\\\mathbb\\{([A-Za-z])\\}/)\n    if (match && typeof match[1] === 'string') {\n      if (localGoodAnswer === localInput) return { isOk: true, feedback: '' }\n      else {\n        const lettre = match[1]\n        if (localInput === lettre)\n          return {\n            isOk: false,\n            feedback: `La bonne rponse tait $\\\\mathbb{${lettre}}$ et non ${lettre}.`,\n          }\n        else\n          return {\n            isOk: false,\n            feedback: `La bonne rponse tait cet ensemble : $\\\\mathbb{${lettre}}$.`,\n          }\n      }\n    }\n  }\n  let isOk1 = true\n  let isOk2 = true\n  let feedback = ''\n  const extractBornesAndOp = /[^[\\];]+/g\n  const extractCrochets = /[[\\]]/g\n  const borneAndOpSaisie = localInput.match(extractBornesAndOp)\n  const borneAndOpReponse = localGoodAnswer.match(extractBornesAndOp)\n  const crochetsSaisie = localInput.match(extractCrochets)\n  const crochetsReponse = localGoodAnswer.match(extractCrochets)\n  // console.log(localInput, localGoodAnswer, borneAndOpSaisie, borneAndOpReponse)\n  if (\n    borneAndOpSaisie != null &&\n    borneAndOpReponse != null &&\n    crochetsSaisie != null &&\n    crochetsReponse != null\n  ) {\n    if (borneAndOpSaisie.length !== borneAndOpReponse.length) {\n      return { isOk: false }\n    }\n    // On teste les bornes et les oprateurs\n    let i: number\n    isOk1 = true\n    for (i = 0; i < borneAndOpSaisie.length; i++) {\n      isOk1 &&= fonctionComparaison(\n        borneAndOpSaisie[i],\n        borneAndOpReponse[i],\n      ).isOk\n      if (!isOk1) {\n        feedback += ['\\\\cup', '\\\\cap'].includes(borneAndOpSaisie[i])\n          ? `Il y a une erreur avec l'oprateur : $${borneAndOpSaisie[i]}$.<br>`\n          : `Il y a une erreur avec la valeur : $${borneAndOpSaisie[i]}$.<br>`\n      }\n    }\n    // on teste maintenant les crochets\n    isOk2 = crochetsSaisie.length === crochetsReponse.length\n    if (!isOk2) {\n      feedback += 'Il y a une erreur avec les crochets.'\n    }\n    if (isOk2) {\n      for (i = 0; i < crochetsSaisie.length; i++) {\n        isOk2 = crochetsSaisie[i] === crochetsReponse[i] && isOk2\n        if (crochetsSaisie[i] !== crochetsReponse[i]) {\n          feedback += `Le crochet plac en position ${i + 1} est mal orient.<br>`\n        }\n      }\n    }\n    return { isOk: isOk1 && isOk2, feedback }\n  }\n  return {\n    isOk: false,\n    feedback: \"Il faut donner un intervalle ou une runion d'intervalles\",\n  }\n}\n\n/**\n * Comparaison de chanes (principalement des noms de classes\n * @param {string} input ce que saisit l'lve\n * @param {{pluriels: boolean}} [options]\n * @param {{value: string, nombre:boolean}} goodAnswer value est ce qui est attendu, si nombre est true, on compte faux l'absence de s quand il en faut un et la prsence de s quand il n'y en a pas besoin\n * si pluriels est false, on compte juste une rponse au pluriel ou au singulier quelque soit la rponse attendue, mais on met un feedback si le pluriel ou le singulier n'est pas respect\n * @author Jean-Claude Lhote\n */\nexport function numerationCompare(\n  input: string,\n  goodAnswer: string,\n  { pluriels = true } = {},\n): ResultType {\n  // normalement, il n'y a rien  nettoyer au niveau de l'input ou de goodAnswer\n  const clean = generateCleaner(['latex'])\n  const saisie: string[] = clean(input).toLowerCase().split(' ')\n  const answer: string[] = goodAnswer.toLowerCase().split(' ')\n  let result: boolean\n  let feedback = ''\n  if (pluriels) {\n    result = true\n    for (let i = 0; i < answer.length; i++) {\n      result = result && saisie[i] === answer[i]\n      if (!result) {\n        if (saisie[i].endsWith('s') && !answer[i].endsWith('s')) {\n          if (saisie[i].substring(0, saisie[i].length - 1) === answer[i]) {\n            feedback = `${saisie[i]} est au pluriel alors qu'il faut le mettre au singulier.<br>`\n          }\n        } else if (!saisie[i].endsWith('s') && answer[i].endsWith('s')) {\n          if (saisie[i] === answer[i].substring(0, answer[i].length - 1)) {\n            feedback = `${saisie[i]} est au singulier alors qu'il faut le mettre au pluriel.<br>`\n          }\n        }\n      }\n      if (!result) break\n    }\n  } else {\n    // ici on tolre singulier ou pluriel\n    // On regarde quand mme si le singulier/pluriel est respect pour le feedback\n    result = true\n    for (let i = 0; i < answer.length; i++) {\n      if (saisie[i].endsWith('s') && !answer[i].endsWith('s')) {\n        if (saisie[i].substring(0, saisie[i].length - 1) === answer[i]) {\n          feedback = `${saisie[i]} est au pluriel alors qu'il faut le mettre au singulier.<br>`\n        }\n      } else if (!saisie[i].endsWith('s') && answer[i].endsWith('s')) {\n        if (saisie[i] === answer[i].substring(0, answer[i].length - 1)) {\n          feedback = `${saisie[i]} est au singulier alors qu'il faut le mettre au pluriel.<br>`\n        }\n      }\n      // on vire le 's' final ventuel\n      if (saisie[i].endsWith('s')) {\n        saisie[i] = saisie[i].substring(0, saisie[i].length - 1)\n      }\n      if (answer[i].endsWith('s')) {\n        answer[i] = answer[i].substring(0, answer[i].length - 1)\n      }\n      result = result && saisie[i] === answer[i]\n    }\n    if (!result) feedback = '' // c'est pas bon, on se fout du feedback\n  }\n  return { isOk: result, feedback }\n}\n\n/**\n * comparaison de grandeurs avec une unit\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{precision: number }} [options]\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction unitsCompare(\n  input: string,\n  goodAnswer: string,\n  { precision = 1 } = {},\n): {\n  isOk: boolean\n  feedback?: string\n} {\n  const localInput = input.replace('^\\\\circ', '').replace('\\\\degree', '')\n  const cleaner = generateCleaner([\n    'virgules',\n    'espaces',\n    'fractions',\n    'parentheses',\n    'mathrm',\n    'operatorName',\n  ])\n  const inputGrandeur = inputToGrandeur(cleaner(localInput))\n  const goodAnswerGrandeur = Grandeur.fromString(\n    cleaner(goodAnswer).replace('^\\\\circ', '').replace('\\\\degree', ''),\n  )\n\n  if (inputGrandeur) {\n    if (\n      inputGrandeur.uniteDeReference !== goodAnswerGrandeur.uniteDeReference\n    ) {\n      return {\n        isOk: false,\n        feedback: `Il faut donner la rponse en $${goodAnswerGrandeur.latexUnit}$.`,\n      }\n    }\n    if (precision !== undefined) {\n      const okPrecision1: boolean = inputGrandeur.estUneApproximation(\n        goodAnswerGrandeur,\n        precision,\n      )\n      const okPrecision2: boolean = goodAnswerGrandeur.estUneApproximation(\n        inputGrandeur,\n        precision / 10,\n      )\n      if (okPrecision1 && okPrecision2) {\n        return { isOk: true }\n      } else {\n        if (okPrecision1) {\n          return {\n            isOk: false,\n            feedback: `La rponse n'est pas arrondie  $${texNombre(10 ** -precision, precision)}$ prs.`,\n          }\n        }\n      }\n      return { isOk: false }\n    }\n    if (inputGrandeur.estEgal(goodAnswerGrandeur)) {\n      return { isOk: true }\n    }\n    return { isOk: false }\n  }\n  // Oubli de l'unit ?\n  const inputNumber = Number(engine.parse(cleaner(input)))\n  const inputWithAddedUnit = new Grandeur(inputNumber, goodAnswerGrandeur.unite)\n  if (inputWithAddedUnit.estEgal(goodAnswerGrandeur)) {\n    return {\n      isOk: false,\n      feedback: \"La rponse est correcte mais l'unit n'a pas t prcise.\",\n    }\n  }\n  if (inputNumber !== 0) {\n    return {\n      isOk: false,\n      feedback: \"La rponse est fausse et il faut saisir l'unit.\",\n    }\n  }\n  return { isOk: false }\n}\n\n/**\n * vrifie qu'une valeur saisie est dans un intervalle strict\n * @param {string} input\n * @param {string} goodAnswer Un intervalle par exemple ]-5.5;2]\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction intervalCompare(\n  input: string,\n  goodAnswer: string,\n): {\n  isOk: boolean\n  feedback?: string\n} {\n  let strictGauche = true\n  let strictDroit = true\n  if (goodAnswer.startsWith('[')) strictGauche = false\n  if (goodAnswer.endsWith(']')) strictDroit = false\n  const bornes = goodAnswer.match(/[[\\]](.+);(.+)[[\\]]/)\n  if (bornes == null) {\n    window.notify(\"Il faut revoir la dfinition de l'intervalle \", {\n      goodAnswer,\n    })\n    return { isOk: false, feedback: 'Un problme avec goodAnswer !' }\n  }\n  const clean = generateCleaner(['virgules', 'fractions', 'espaces'])\n  const borneInf = Number(engine.parse(clean(bornes[1])).N())\n  const borneSup = Number(engine.parse(clean(bornes[2])).N())\n  const inputNumber = Number(engine.parse(clean(input)).N())\n  // @todo vrifier que l'lve a bien saisi un nombre\n  if (Number.isNaN(inputNumber)) return { isOk: false }\n  const okGauche = strictGauche\n    ? inputNumber > borneInf\n    : inputNumber >= borneInf\n  const okDroit = strictDroit ? inputNumber < borneSup : inputNumber <= borneSup\n  return { isOk: okGauche && okDroit }\n}\n\n/**\n * comparaison de nombres entiers conscutifs\n * Cette fonction sert essentiellement pour le feedback dans des exercices de comparaison car elle prend pour l'instant un encadrement sous la forme a<b<c ou a>b>c\n * Exercices d'exemple : 6N20-1 et 6N20-3\n * Peut-tre en faire une variation pour vrifier des ingalits ?\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n * @return ResultType\n */\nexport function consecutiveCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  let feedback = ''\n  const [entierInf, valeurInter, entierSup] = input.includes('<')\n    ? input.split('<').map((el) => Number(engine.parse(el).numericValue))\n    : input\n        .split('>')\n        .map((el) => Number(engine.parse(el).numericValue))\n        .sort((a: number, b: number) => a - b)\n  if (\n    !(\n      Number.isInteger(Number(entierSup)) && Number.isInteger(Number(entierInf))\n    )\n  ) {\n    feedback = 'On attend comme rponse deux nombres entiers.'\n    return { isOk: false, feedback }\n  }\n  const [goodAnswerEntierInf, , goodAnswerEntierSup] = goodAnswer.includes('<')\n    ? goodAnswer.split('<').map((el) => Number(engine.parse(el).numericValue))\n    : goodAnswer\n        .split('>')\n        .map((el) => Number(engine.parse(el).numericValue))\n        .sort((a: number, b: number) => a - b)\n  const diff = Number(\n    engine.box(['Subtract', String(entierSup), String(entierInf)]).N()\n      .numericValue,\n  )\n  if (diff === -1) {\n    feedback =\n      \"Les nombres sont bien deux entiers conscutifs, mais ils sont donns dans l'ordre inverse.\"\n    return { isOk: false, feedback }\n  }\n  if (diff !== 1) {\n    return {\n      isOk: false,\n      feedback: 'Les deux nombres entiers donns ne sont pas conscutifs.',\n    }\n  }\n  if (valeurInter != null) {\n    const diff1 = Number(\n      engine.box(['Subtract', String(entierSup), String(valeurInter)]).N()\n        .numericValue,\n    )\n    const diff2 = Number(\n      engine.box(['Subtract', String(valeurInter), String(entierInf)]).N()\n        .numericValue,\n    )\n    if (\n      !(\n        diff1 != null &&\n        diff2 != null &&\n        diff1 < 1 &&\n        diff1 >= 0 &&\n        diff2 < 1 &&\n        diff2 >= 0\n      )\n    ) {\n      return {\n        isOk: false,\n        feedback: `Les deux nombres entiers sont biens conscutifs mais n'encadrent pas la valeur ${valeurInter}`,\n      }\n    }\n  }\n  const isOk1 = true\n  const isOk2 =\n    expressionDeveloppeeEtReduiteCompare(\n      String(entierInf),\n      String(goodAnswerEntierInf),\n    ).isOk &&\n    expressionDeveloppeeEtReduiteCompare(\n      String(entierSup),\n      String(goodAnswerEntierSup),\n    ).isOk\n  return { isOk: isOk1 && isOk2, feedback: '' }\n}\n\n/**\n * Compare deux nombres avec une certaine tolrance\n * Exercice exemple : 5N11-4\n * @param {string} input\n * @param { string} goodAnswer\n * @param {{tolerance: number}} [options]\n * @author Jean-Claude Lhote\n */\nexport function approximatelyCompare(\n  input: string,\n  goodAnswer: string,\n  { tolerance = 0.1 } = {},\n) {\n  const cleaner = generateCleaner([\n    'virgules',\n    'fractions',\n    'espaces',\n    'parentheses',\n    'puissances',\n  ])\n  const saisieClean = Number(engine.parse(cleaner(input)).numericValue)\n  const answerClean = Number(engine.parse(cleaner(goodAnswer)).numericValue)\n  return { isOk: Math.abs(saisieClean - answerClean) <= tolerance }\n}\n\n/**\n * Comparaison de fonction f(x)\n * @param {string} input\n * @param {{ variable: string, domaine: [number, number]}} [options]\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n */\nexport function functionCompare(\n  input: string,\n  goodAnswer: string,\n  { variable = 'x', domaine = [-100, 100], entier = false } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'fractions',\n    'divisions',\n  ])\n  const cleanInput = clean(input)\n  const inputParsed = engine.parse(cleanInput)\n  const inputFn = inputParsed.compile()\n  const cleanAnswer = clean(goodAnswer)\n  const goodAnswerFn = engine.parse(cleanAnswer).compile()\n  const min = domaine[0]\n  const max = domaine[1]\n  const range = max - min\n  const valAlea = () => min + range * Math.random()\n  if (inputFn == null || goodAnswerFn == null) {\n    throw Error(\n      `functionCompare : La saisie ou la bonne rponse ne sont pas des fonctions (saisie : ${input} et rponse attendue : ${goodAnswer}`,\n    )\n  }\n  let a: number\n  let b: number\n  let c: number\n  let variablea: Record<string, number>\n  let variableb: Record<string, number>\n  let variablec: Record<string, number>\n  let cpt = 0\n  do {\n    ;[a, b, c] = entier\n      ? [valAlea(), valAlea(), valAlea()].map(Math.round)\n      : [valAlea(), valAlea(), valAlea()]\n    variablea = Object.fromEntries([[variable ?? 'x', a]])\n    variableb = Object.fromEntries([[variable ?? 'x', b]])\n    variablec = Object.fromEntries([[variable ?? 'x', c]])\n    cpt++\n  } while (\n    cpt < 1000 &&\n    (Number.isNaN(goodAnswerFn(variablea) as number) ||\n      Number.isNaN(goodAnswerFn(variableb) as number) ||\n      Number.isNaN(goodAnswerFn(variablec) as number))\n  )\n  if (cpt === 1000) {\n    window.notify(\n      \"functionCompare n'a pas russi  trouver 3 valeurs dans le domaine qui donnent une image par la fonction goodAnswer !\",\n      { fonction: goodAnswer, domaine },\n    )\n    return { isOk: false, feedback: 'erreur dans le programme' }\n  }\n  let isOk = true\n  for (const x of [a, b, c]) {\n    const vars = Object.fromEntries([[variable ?? 'x', x]])\n    const y1 = Number(inputFn(vars))\n    const y2 = Number(goodAnswerFn(vars))\n    isOk = isOk && Math.abs(y1 - y2) < 1e-10\n  }\n  return { isOk }\n}\n\n/*\n * Comparaison de fonction f(x,y) (ou tout autre variable) x et y tant les lettres par dfaut\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{variables: string[]}} [options]\n * @author Jean-Claude Lhote\n *\nexport function functionXyCompare (input: string, goodAnswer: string, { variables = ['x', 'y'] } = { }): ResultType {\n  const clean = generateCleaner(['espaces', 'virgules', 'parentheses', 'fractions', 'divisions'])\n  // Pour l'instant les fonctions trigo saisies au clavier ne sont pas les fonction trigo latex.\n  const cleanInput = clean(input)\n  const inputParsed = engine.parse(cleanInput)\n\n  const inputFn = inputParsed.compile()\n  const cleanAnswer = clean(goodAnswer)\n  const goodAnswerFn = engine.parse(cleanAnswer).compile()\n\n  let isOk = true\n  if (inputFn == null || goodAnswerFn == null) throw Error(`functionCompare : La saisie ou la bonne rponse ne sont pas des fonctions (saisie : ${input} et rponse attendue : ${goodAnswer}`)\n  const [a, b, c] = [Math.random(), Math.random(), Math.random()]\n  const [A, B, C] = [Math.random(), Math.random(), Math.random()]\n  for (const x of [a, b, c]) {\n    for (const y of [A, B, C]) {\n      const vars = Object.fromEntries([[variables[0], x], [variables[1], y]])\n      isOk = isOk && Math.abs(inputFn(vars) - goodAnswerFn(vars)) < 1e-10\n    }\n  }\n  return { isOk }\n} */\n\n/*\n * Comparaison d'galits (pour l'instant strictement gal, il est prvu d'implmenter l'quivalence d'galits)\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{membre1Variable?: string, membre2Variable?: string, strict?: boolean, domaine: [number, number]}} [options]\n * @author Jean-Claude Lhote\n *\nexport function equalityCompare (input: string, goodAnswer: string, { membre1Variable = 'x', membre2Variable = 'x', strict = true, domaine = [-100, 100] } = {}):ResultType {\n  const [m1, m2] = input.split('=')\n  const [goodAnswerMb1, goodAnswerMb2] = goodAnswer.split('=')\n  if (m1 == null || m2 == null) return { isOk: false, feedback: 'Une galit est attendue' }\n  if (strict) {\n    const { isOk: isOk1 } = functionCompare(m1, goodAnswerMb1, { variable: membre1Variable ?? 'x', domaine })\n    const { isOk: isOk2 } = functionCompare(m2, goodAnswerMb2, { variable: membre2Variable ?? 'x', domaine })\n    return { isOk: isOk1 && isOk2 }\n  } else {\n    // @todo  implmenter : permettre de saisir une galit et de vrifier l'quivalence avec celle propose comme bonne rponse.\n    // En attendant, je recopie le code de strict = true\n    const { isOk: isOk1 } = functionCompare(m1, goodAnswerMb1, { variable: membre1Variable ?? 'x', domaine })\n    const { isOk: isOk2 } = functionCompare(m2, goodAnswerMb2, { variable: membre2Variable ?? 'x', domaine })\n    return {\n      isOk: isOk1 && isOk2,\n      feedback: ''\n    }\n  }\n} */\n\n/**\n * Comparaison d'galits (pour les quations de droites ou d'autres galits comme dans can2L11 ou can1a-2024-Q14)\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n */\nexport function egaliteCompare(input: string, goodAnswer: string): ResultType {\n  const [m1, m2] = input.split('=')\n  const [goodAnswerMb1, goodAnswerMb2] = goodAnswer.split('=')\n  if (m1 == null || m2 == null) {\n    return { isOk: false, feedback: 'Une galit est attendue' }\n  }\n\n  const { isOk: isOk1 } = fonctionComparaison(m2, goodAnswerMb1)\n  const { isOk: isOk2 } = fonctionComparaison(m1, goodAnswerMb1)\n  const { isOk: isOk3 } = fonctionComparaison(m2, goodAnswerMb2)\n  const { isOk: isOk4 } = fonctionComparaison(m1, goodAnswerMb2)\n  return { isOk: (isOk1 && isOk4) || (isOk3 && isOk2) }\n}\n\n/**\n * Format des nombres avec les espaces adquats\n * @param {string} nombre // Un nombre sans espace sous forme d'une chane de caractres\n * @author Eric Elter (aide par ChatGPT)\n * @example formatNumberWithSpaces('1234567') renvoie '1 234 567'\n * @example formatNumberWithSpaces('1239,4567') renvoie '1 239,456 7'\n * @returns {string}\n */\nfunction formatNumberWithSpaces(nombre: string): string {\n  return nombre.replace(/\\b\\d+(?:[.,]\\d+)?\\b/g, (match) => {\n    // Dtection du sparateur utilis\n    const separator = match.includes(',') ? ',' : '.'\n\n    // Sparer la partie entire et la partie dcimale\n    const [entier, decimal] = match.split(separator)\n\n    // Formater la partie entire : espace tous les 3 chiffres de gauche  droite\n    const entierFormate = entier.replace(/(\\d)(?=(\\d{3})+$)/g, '$1 ')\n\n    if (decimal) {\n      // Formater la partie dcimale : espace tous les 3 chiffres de droite  gauche\n      const decimalFormate = decimal.replace(/(\\d{3})(?=\\d)/g, '$1 ')\n      return `${entierFormate}${separator}${decimalFormate.trim()}`\n    }\n\n    return entierFormate // Retourne uniquement la partie entire si pas de dcimale\n  })\n}\n\n/**\n * Comparaison de nombres avec les espaces exigs\n * @param {string} input\n * @param {string} goodAnswer\n * @author Rmi Angot\n */\nexport function numberWithSpaceCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  let inputCleanFirst = input.replaceAll(/(\\s{2,})(?=\\d{3})/g, ' ').trim() // EE : l'lve peut avoir un saisi un espace avant ou aprs le nombre et avoir saisi des doubles espaces sans qu'on lui en tienne rigueur tant qu'ils sparent bien les classes, videmment.\n  inputCleanFirst = inputCleanFirst.replaceAll(/\\\\,/g, ' ') // EE : Permet  input que les espaces ressemblent uniquement  ' ' et non  '\\,'.\n  const clean = generateCleaner(['espaces'])\n  const inputClean = clean(input)\n  const goodAnswerClean = clean(goodAnswer)\n  let goodAnswerNew = goodAnswerClean.replace(/\\s+/g, '') // EE : On enlve tous les espaces s'il y en a.\n\n  // Gestion pnible de la virgule ci-dessous dans le cas de plus de 3 chiffres dans la partie dcimale.\n  goodAnswerNew = goodAnswerNew.replace('{,}', ',') // EE : On enlve toutes les virgules sous la forme {,} s'il y en a.\n  goodAnswerNew = formatNumberWithSpaces(goodAnswerNew) // EE : On rajoute tous les espaces adquats.\n  goodAnswerNew = goodAnswerNew.replace(',', '{,}') // EE : On rajoute toutes les virgules sous la forme {,} s'il y en a.\n\n  let feedback = ''\n  if (inputCleanFirst !== goodAnswerNew && inputClean === goodAnswerClean) {\n    feedback = 'Le nombre est mal crit, il faut faire attention aux espaces. '\n  }\n  return { isOk: inputCleanFirst === goodAnswerNew, feedback }\n}\n\nexport function exprCompare(\n  input: string,\n  goodAnswer: string,\n  { noUselessParen = false },\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'divisions',\n    'fractions',\n    'puissances',\n    'fractions',\n    'mathrm',\n  ])\n  const inputClean = clean(input) ?? ''\n  const answerClean = clean(goodAnswer) ?? ''\n  let feedback = ''\n  let isOk = true\n  const nbParenInput = inputClean.match(/([[()\\]])/g)?.length\n  const nbParenAnswer = answerClean.match(/([[()\\]])/g)?.length\n  const numbersInput = inputClean\n    .match(/\\d+/g)\n    ?.sort((a, b) => Number(a) - Number(b))\n  const numbersAnswer = answerClean\n    .match(/\\d+/g)\n    ?.sort((a, b) => Number(a) - Number(b))\n  const opsInput = inputClean\n    .match(/[+\\-/*]|(times)|(div)|(frac)/g)\n    ?.sort((a, b) => a.charCodeAt(0) - b.charCodeAt(0))\n  const opsAnswer = answerClean\n    .match(/[+\\-/*]|(times)|(div)|(frac)/g)\n    ?.sort((a, b) => a.charCodeAt(0) - b.charCodeAt(0))\n  const isOk1 = nbParenAnswer === nbParenInput // doit tre true si noUselessParen est true\n  const isOk2 =\n    numbersInput != null &&\n    numbersAnswer != null &&\n    areSameArray(numbersInput, numbersAnswer) // doit tre obligatoirement true\n  const isOk3 =\n    opsInput != null && opsAnswer != null && areSameArray(opsInput, opsAnswer) // doit obligatoirement tre true\n  const isOk4 = engine\n    .parse(inputClean)\n    .isEqual(engine.parse(clean(goodAnswer))) // doit obligatoirement tre true\n  if (noUselessParen && inputClean != null && answerClean !== null) {\n    isOk = (isOk1 && isOk2 && isOk3 && isOk4) ?? false\n    if (!isOk1 && isOk4) {\n      feedback =\n        \"L'expression donne le bon rsultat mais n'a pas la forme attendue.\"\n    }\n  } else {\n    isOk = (isOk2 && isOk3 && isOk4) ?? false\n    if (!isOk) {\n      if (!isOk4) {\n        feedback = \"L'expression ne donne pas le bon rsultat.\"\n      } else if (!isOk3) {\n        feedback = \"L'expression ne contient pas les bonnes oprations.\"\n      } else {\n        feedback = \"L'expression ne contient pas les bons nombres.\"\n      }\n    }\n  }\n  return { isOk, feedback }\n}\n\nexport function checkLeCompteEstBon( // Ne fonctionne que si numbers est un tableau de nombres POSITIFS.\n  input: string,\n  numbers: number[],\n  target: number,\n  quatreOperationsObligatoires: boolean,\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'fractions',\n    'divisions',\n  ])\n  const inputClean = clean(input)\n\n  // At first, check that the value of the expression is correct\n  const answer = engine.parse(inputClean, {\n    canonical: false,\n  }) as BoxedExpression\n  const value = answer.value\n  if (value === undefined || Number(value) !== target) {\n    return {\n      isOk: false,\n      feedback: `L'expression vaut ${value} et non ${target}.`,\n    }\n  }\n\n  // Count each operator\n  let addCount = 0\n  let multiplyCount = 0\n  let divideCount = 0\n  let subtractCount = 0\n\n  let tropDeNombres = false\n  let nombresEnDoublon = false\n  let mauvaisNombre = false\n  let symboleNonAutorise = false\n  let operationNonAutorisee = false\n\n  const listeNombresEnonce = [...numbers]\n  const visit: (node: BoxedExpression) => void = (node) => {\n    if (node.numericValue !== null) {\n      if (listeNombresEnonce.length === 0) {\n        if (numbers.includes(Math.abs(Number(node.value)))) {\n          // abs obligatoire car sinon, pour 5-3, il tente de chercher -3.\n          nombresEnDoublon = true\n          return 'Au moins un nombre en doublon'\n        }\n        tropDeNombres = true\n        return 'Au moins un nombre en trop'\n      }\n      if (listeNombresEnonce.includes(Math.abs(Number(node.value)))) {\n        // J'enlve cet lment de la liste\n        listeNombresEnonce.splice(\n          listeNombresEnonce.indexOf(Math.abs(Number(node.value))),\n          1,\n        )\n      } else {\n        mauvaisNombre = true\n        return 'Au moins un mauvais nombre parmi ceux proposs'\n      }\n    }\n\n    if (node.symbol) {\n      symboleNonAutorise = true\n      return \"L'expression contient un symbole non autoris.\"\n    }\n    if (node.operator) {\n      if (node.operator !== 'Number' && node.operator !== 'Delimiter') {\n        switch (node.operator) {\n          case 'Add':\n            addCount++\n            break\n          case 'Multiply':\n            multiplyCount++\n            break\n          case 'Divide':\n            divideCount++\n            break\n          case 'Subtract':\n          case 'Negate':\n            subtractCount++\n            break\n          default:\n            operationNonAutorisee = true\n        }\n      }\n      if (node.ops !== null) {\n        for (const op of node.ops) {\n          visit(op)\n        }\n      } else return 'OK'\n    }\n  }\n\n  visit(answer)\n  if (tropDeNombres)\n    return {\n      isOk: false,\n      feedback: \"L'expression utilise plus de nombres que demands.\",\n    }\n  if (nombresEnDoublon)\n    return {\n      isOk: false,\n      feedback:\n        \"L'expression utilise plusieurs fois un mme nombre parmi ceux proposs.\",\n    }\n  if (mauvaisNombre)\n    return {\n      isOk: false,\n      feedback: \"L'expression utilise au moins un nombre non autoris.\",\n    }\n  if (symboleNonAutorise)\n    return {\n      isOk: false,\n      feedback: \"L'expression contient un symbole non autoris.\",\n    }\n  if (operationNonAutorisee)\n    return {\n      isOk: false,\n      feedback:\n        \"L'expression doit contenir que des additions, des soustractions, des multiplications, des divisions ou des parenthses.\",\n    }\n  if (\n    quatreOperationsObligatoires &&\n    !(\n      addCount === 1 &&\n      divideCount === 1 &&\n      subtractCount === 1 &&\n      multiplyCount === 1\n    )\n  )\n    return {\n      isOk: false,\n      feedback:\n        \"L'expression doit contenir une addition, une soustraction, une multiplication et une division.\",\n    }\n\n  return { isOk: true, feedback: '' } // L'expression est correcte.\n}\n","import type { MathfieldElement } from 'mathlive'\nimport type { IExercice } from '../../lib/types'\nimport { sp } from '../outils/outilString'\nimport { fonctionComparaison } from './comparisonFunctions'\n\n// Un barme qui ne met qu'un point si tout est juste\nexport function toutPourUnPoint(listePoints: number[]): [number, number] {\n  return [Math.min(...listePoints), 1]\n}\n// le barme par dfaut un point pour chaque rponse\nexport function toutAUnPoint(listePoints: number[]) {\n  return [\n    listePoints.reduce((prev, current) => prev + current),\n    listePoints.length,\n  ] as [number, number]\n}\n\n/**\n * fonction gnrale de vrification qui utilise le contenu de exercice.autoCorrection pour comparer la saisie utilisateur avec la rponse attendue\n * @param {Exercice} exercice\n * @param {number} i\n * @param {boolean} writeResult // inutilis ! toujours true ! @fixme  quoi sert cette variable ??? JCL le 5/03/2024\n * @returns {{feedback: string, score: {nbBonnesReponses: (number|number), nbReponses: (number|number)}, isOk: string}|{feedback: string, score: {nbBonnesReponses: number, nbReponses: number}, resultat: string}|{feedback: string, score: {nbBonnesReponses: number, nbReponses: number}, isOk: string}|*|{feedback: string, score: {nbBonnesReponses: (number), nbReponses: number}, resultat: string}}\n */\nexport function verifQuestionMathLive(\n  exercice: IExercice,\n  i: number,\n  writeResult = true,\n) {\n  let noFeedback = false\n  let champTexte: HTMLInputElement | MathfieldElement | null = null\n  const getCustomFeedback =\n    exercice.autoCorrection[i]?.reponse?.valeur?.feedback\n  if (exercice.autoCorrection[i]?.reponse == null) {\n    throw Error(\n      `verifQuestionMathlive appel sur une question sans rponse: ${JSON.stringify(\n        {\n          exercice,\n          question: i,\n          autoCorrection: exercice.autoCorrection[i],\n        },\n      )}`,\n    )\n  }\n  if (exercice.autoCorrection[i].reponse.param == null) {\n    throw Error(\n      `verifQuestionMathlive appel sur une question sans param : ${JSON.stringify(\n        {\n          exercice,\n          question: i,\n          param: exercice.autoCorrection[i].reponse,\n        },\n      )}`,\n    )\n  }\n  const formatInteractif =\n    exercice.autoCorrection[i].reponse.param.formatInteractif ?? 'mathlive'\n  const spanReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  ) as HTMLSpanElement\n  // On compare le texte avec la rponse attendue en supprimant les espaces pour les deux\n  const reponses = exercice.autoCorrection[i].reponse.valeur\n  if (reponses == null) {\n    window.notify(\n      `verifQuestionMathlive: reponses est null pour la question ${i} de l'exercice ${exercice.id}`,\n      { exercice, i },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n  const bareme: (arg: number[]) => [number, number] =\n    reponses.bareme ?? toutPourUnPoint\n  const callback = reponses.callback\n  try {\n    const variables = Object.entries(reponses).filter(\n      ([key]) => key !== 'callback' && key !== 'bareme' && key !== 'feedback',\n    )\n    if (callback != null && typeof callback === 'function') {\n      // L c'est une correction custom ! Celui qui passe une callback doit savoir ce qu'il fait !\n      // La fonction de callback gre le score et le feedback\n      // Ici, on sauvegarde les rponses dans l'objet exercice.answers\n      const mfe = document.querySelector(\n        `#champTexteEx${exercice.numeroExercice}Q${i}`,\n      ) as MathfieldElement\n      if (mfe != null) {\n        if (mfe.getValue().length > 0 && typeof exercice.answers === 'object') {\n          exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = mfe.getValue()\n        }\n        if (mfe.value.length > 0 && typeof exercice.answers === 'object') {\n          exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = mfe.value\n        }\n      }\n      return callback(exercice, i, variables, bareme)\n    }\n    if (variables.length > 1 || variables[0][0] !== 'reponse') {\n      if (variables[0][0].match(/L\\dC\\d/)) {\n        // un tableau avec Lignes (L) et Colonnes (L)\n        // Je trate le cas des tableaux  part : une question pour de multiples inputs mathlive !\n        // on pourra faire d'autres formats interactifs sur le mme modle\n        const points = []\n        let resultat = 'OK'\n        const table = document.querySelector(\n          `table#tabMathliveEx${exercice.numeroExercice}Q${i}`,\n        )\n        if (table == null) {\n          throw Error(\n            `verifQuestionMathlive: type tableauMathlive ne trouve pas le tableau dans le dom${JSON.stringify({ selecteur: `table#tabMathliveEx${exercice.numeroExercice}Q${i}` })}`,\n          )\n        }\n        const cellules = Object.entries(reponses).filter(\n          ([key]) => key.match(/L\\dC\\d/) != null,\n        )\n        for (let k = 0; k < cellules.length; k++) {\n          const [key, reponse] = cellules[k]\n          const options = reponse.options\n          noFeedback = noFeedback || Boolean(options?.noFeedback)\n          const compareFunction = reponse.compare ?? fonctionComparaison\n          const inputs = Array.from(table.querySelectorAll('math-field'))\n          const input = inputs.find(\n            (el) =>\n              el.id === `champTexteEx${exercice.numeroExercice}Q${i}${key}`,\n          ) as MathfieldElement\n          let result\n          const spanFedback = table.querySelector(\n            `span#resultatCheckEx${exercice.numeroExercice}Q${i}${key}`,\n          )\n          if (input == null || input.value === '') {\n            result = {\n              isOk: false,\n              feedback: noFeedback\n                ? ''\n                : `Vous devez saisir une rponse dans la cellule ${key}.<br>`,\n            }\n          } else {\n            if (Array.isArray(reponse.value)) {\n              let ii = 0\n              while (!result?.isOk && ii < reponse.value.length) {\n                result = compareFunction(\n                  input.value,\n                  reponse.value[ii],\n                  options,\n                )\n                ii++\n              }\n            } else {\n              result = compareFunction(input.value, reponse.value, options)\n            }\n          }\n          // On ne nettoie plus les input et les rponses, c'est la fonction de comparaison qui doit s'en charger !\n          if (result.isOk) {\n            points.push(1)\n            if (spanFedback != null) spanFedback.innerHTML = ''\n          } else {\n            points.push(0)\n            resultat = 'KO'\n            if (spanFedback != null) spanFedback.innerHTML = ''\n          }\n          if (input.value.length > 0 && typeof exercice.answers === 'object') {\n            exercice.answers[`Ex${exercice.numeroExercice}Q${i}${key}`] =\n              input.value\n          }\n        }\n        const [nbBonnesReponses, nbReponses] = bareme(points)\n        return {\n          isOk: resultat,\n          feedback: '',\n          score: { nbBonnesReponses, nbReponses },\n        }\n      }\n      if (\n        variables[0][0].match(/champ\\d/) ||\n        formatInteractif === 'fillInTheBlank'\n      ) {\n        // on n'aurait plus besoin de formatInteractif si on respecte la convention de nommage champ1, champ2...\n        // Le format fillInTheBlank requiert un \"objetReponse\" avec le format objet.\n        // cet objet contient des proprits (autant que de blancs, et ont le mme nom que les blancs crs avec la fonction remplisLesBlanc())\n        // chaque proprit a une valeur : de la forme {value: string, compare: ComparaisonFonction} c'est la valeur attendue et sa mthode de comparaison facultatitve\n        // La reponse pourrait contenir aussi une proprit callback facultative (non implment pour l'instant car pas de besoin)\n        // c'est une fonction qui serait utilise  la place de la procdure normale de traitement ci-dessous\n        // en fait ce serait la fonction de correctionInteractive 'custom' qui se trouverait avant dans l'exo et qui permet, par exemple, de raliser des traitements spciaux\n        const mfe = document.querySelector(\n          `#champTexteEx${exercice.numeroExercice}Q${i}`,\n        ) as MathfieldElement\n        if (mfe == null) {\n          throw Error(\n            `verifQuestionMathlive: type fillInTheBlank ne trouve pas le mathfieldElement dans le dom : ${JSON.stringify({ selecteur: `math-field#champTexteEx${exercice.numeroExercice}Q${i}` })}`,\n          )\n        }\n        const points = []\n        const saisies: Record<string, string> = {}\n        let feedback = ''\n        let compteurSaisiesVides = 0\n        let compteurBonnesReponses = 0\n        let noFeedback = false\n        for (let k = 0; k < variables.length; k++) {\n          const [key, reponse] = variables[k]\n          if (key === 'feedback' || key === 'bareme') continue\n          const saisie = mfe.getPromptValue(key)\n          saisies[key] = saisie\n          const compareFunction = reponse.compare ?? fonctionComparaison\n          const options = reponse.options\n          noFeedback = noFeedback || Boolean(options?.noFeedback)\n          let result\n          // On ne nettoie plus les input et les rponses, c'est la fonction de comparaison qui doit s'en charger !\n          if (saisie == null || saisie === '') {\n            compteurSaisiesVides++\n            result = { isOk: false, feedback: 'saisieVide' }\n            // result = { isOk: false, feedback: ` Pas de rponse dans la zone de saisie${variables.length > 1 ? ` N${key.charAt(key.length - 1)}` : ''}.<br>` }\n          } else {\n            if (Array.isArray(reponse.value)) {\n              let ii = 0\n              while (!result?.isOk && ii < reponse.value.length) {\n                result = compareFunction(saisie, reponse.value[ii], options)\n                ii++\n              }\n            } else {\n              result = compareFunction(saisie, reponse.value, options)\n            }\n          }\n          if (result.isOk) {\n            compteurBonnesReponses++\n            points.push(1)\n            mfe.setPromptState(key, 'correct', true)\n          } else {\n            points.push(0)\n            mfe.setPromptState(key, 'incorrect', true)\n            if (result.feedback === 'saisieVide') result.feedback = null\n            else {\n              result = {\n                isOk: false,\n                feedback:\n                  ` Le rsultat dans la zone de saisie${variables.length > 1 ? ` N${key.charAt(key.length - 1)}` : ''}  est incorrect.<br>` +\n                  sp(7),\n              }\n            }\n          }\n          mfe.classList.add('corrected')\n          if (result.feedback != null) feedback += result.feedback\n        }\n        if (compteurBonnesReponses === variables.length) feedback = ''\n        else if (compteurBonnesReponses === 0 && compteurSaisiesVides === 0) {\n          feedback =\n            variables.length === 1\n              ? \" Le rsultat n'est pas correct.\"\n              : \" Aucun rsultat n'est correct.\"\n        }\n\n        if (compteurSaisiesVides === 1) {\n          feedback += ` Il manque une rponse dans ${variables.length === 1 ? 'la' : 'une'} zone de saisie.<br>`\n        } else if (compteurSaisiesVides > 1) {\n          feedback += ` Il manque une rponse dans ${compteurSaisiesVides} zones de saisie.<br>`\n        }\n\n        if (typeof reponses.feedback === 'function') {\n          feedback += reponses.feedback(saisies)\n          const spanFeedback = document.querySelector(\n            `#feedbackEx${exercice.numeroExercice}Q${i}`,\n          )\n          if (feedback != null && spanFeedback != null && feedback.length > 0) {\n            spanFeedback.innerHTML = ` ${feedback}`\n            spanFeedback.classList.add(\n              'py-2',\n              'italic',\n              'text-coopmaths-warn-darkest',\n              'dark:text-coopmathsdark-warn-darkest',\n            )\n          }\n        }\n        const [nbBonnesReponses, nbReponses] = bareme(points)\n        if (mfe.getValue().length > 0 && typeof exercice.answers === 'object') {\n          /*    const prompts = mfe.getPrompts()\n            const answers = []\n            for (const prompt of prompts) {\n              answers.push([prompt, mfe.getPromptValue(prompt)])\n            }\n            exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = Object.assign({}, Object.fromEntries(answers))\n         */\n          exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = mfe.getValue()\n        }\n        if (spanReponseLigne != null) {\n          spanReponseLigne.innerHTML =\n            nbBonnesReponses === nbReponses ? '' : ''\n        }\n        // le feedback est dj assur par la fonction feedback(), donc on le met  ''\n        return {\n          isOk: nbBonnesReponses === nbReponses,\n          feedback: noFeedback ? '' : feedback,\n          score: { nbBonnesReponses, nbReponses },\n        }\n      }\n    }\n    // ici, il n'y a qu'un seul input une seule saisie (mme si la rponse peut contenir des variantes qui seront toutes compares  la saisie\n    champTexte = document.getElementById(\n      `champTexteEx${exercice.numeroExercice}Q${i}`,\n    ) as MathfieldElement | HTMLInputElement\n    if (champTexte == null) {\n      throw Error(\n        `verifQuestionMathlive: type ${formatInteractif} ne trouve pas le champ de saisie dans le dom ${JSON.stringify({ selecteur: `champTexteEx${String(exercice.numeroExercice)}Q${String(i)}` })}`,\n      )\n    }\n    if (champTexte.value.length > 0 && typeof exercice.answers === 'object') {\n      exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = champTexte.value\n    }\n    const saisie = champTexte.value\n    let customFeedback = ''\n    if (getCustomFeedback != null) {\n      customFeedback = getCustomFeedback({ saisie })\n    }\n    const objetReponse = reponses.reponse\n    if (objetReponse == null) {\n      window.notify(\n        `verifQuestionMathlive: objetReponse est null pour la question ${i} de l'exercice ${exercice.id}`,\n        { exercice, i },\n      )\n      return {\n        isOk: false,\n        feedback: 'erreur dans le programme',\n        score: { nbBonnesReponses: 0, nbReponses: 1 },\n      }\n    }\n\n    const options = objetReponse.options ?? {}\n    noFeedback = options.noFeedback ?? false\n    if (saisie == null || saisie === '') {\n      return {\n        isOk: false,\n        feedback: noFeedback ? '' : 'Vous devez saisir une rponse.',\n        score: { nbBonnesReponses: 0, nbReponses: 1 },\n      }\n    }\n    let isOk = false\n    let ii = 0\n    let reponse\n    let feedback = ''\n    const compareFunction = objetReponse.compare ?? fonctionComparaison\n\n    if (Array.isArray(objetReponse.value)) {\n      while (!isOk && ii < objetReponse.value.length) {\n        reponse = objetReponse.value[ii]\n        const check = compareFunction(saisie, reponse, options)\n        if (check.isOk) {\n          isOk = true\n          feedback = ''\n          break\n        }\n        if (check.feedback) {\n          feedback = check.feedback\n        }\n        ii++\n      }\n    } else {\n      reponse = objetReponse.value\n      const check = compareFunction(saisie, reponse, options)\n      if (check.isOk) {\n        isOk = true\n        feedback = check.feedback ?? ''\n      } else if (check.feedback) {\n        feedback = check.feedback ?? ''\n      }\n    }\n\n    if (spanReponseLigne != null) {\n      spanReponseLigne.innerHTML = ''\n      if (customFeedback.length > 0) {\n        feedback = `${feedback} ${feedback.length > 0 ? '<br>' : ''} ${customFeedback}`\n      }\n      if (isOk) {\n        spanReponseLigne.innerHTML = ''\n        spanReponseLigne.style.fontSize = 'large'\n        champTexte.readOnly = true\n        return {\n          isOk,\n          feedback: noFeedback ? '' : feedback,\n          score: { nbBonnesReponses: 1, nbReponses: 1 },\n        }\n      }\n      if (writeResult) {\n        spanReponseLigne.innerHTML = ''\n        spanReponseLigne.style.fontSize = 'large'\n        champTexte.readOnly = true\n        return {\n          isOk,\n          feedback: noFeedback ? '' : feedback,\n          score: { nbBonnesReponses: 0, nbReponses: 1 },\n        }\n      }\n      return {\n        isOk,\n        feedback: noFeedback ? '' : feedback,\n        score: { nbBonnesReponses: isOk ? 1 : 0, nbReponses: 1 },\n      } // ce code n'est jamais excut vu que writeResult est toujours true\n    }\n  } catch (error) {\n    window.notify(\n      `Erreur dans verif QuestionMathLive : ${error}\\n Avec les mtadonnes : `,\n      {\n        champTexteValue: champTexte?.value ?? null,\n        exercice: exercice?.id,\n        i,\n        autoCorrection: exercice?.autoCorrection[i],\n        formatInteractif,\n        spanReponseLigne,\n      },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n}\n\n// # sourceMappingURL=mathLive.js.map\n","import jspreadsheet from 'jspreadsheet-ce'\nimport 'jspreadsheet-ce/dist/jspreadsheet.css'\n\nexport class MySpreadsheetElement extends HTMLElement {\n  private _spreadsheet: any = null\n  private _buttonListener?: EventListener\n  private _customListeners: { [eventName: string]: EventListener } = {}\n  private showVerifyButton: boolean = true\n\n  constructor() {\n    super()\n    this._spreadsheet = null\n  }\n\n  /**\n   * Ajoute un listener sur l'lment et le mmorise pour suppression ultrieure\n   */\n  public addListener(eventName: string, callback: EventListener) {\n    this.addEventListener(eventName, callback)\n    this._customListeners[eventName] = callback\n  }\n\n  /**\n   * Mthode statique pour crer et configurer un MySpreadsheetElement\n   */\n  static create({\n    id,\n    data = [],\n    minDimensions = [5, 5],\n    style = {},\n    columns = [],\n    interactif = false,\n    showVerifyButton = true,\n  }: {\n    id?: string\n    data?: (string | number)[][]\n    minDimensions?: [number, number]\n    style?: any\n    columns?: any[]\n    interactif?: boolean\n    showVerifyButton?: boolean\n  } = {}) {\n    const elt = new MySpreadsheetElement()\n    if (id) elt.id = id\n    elt.setAttribute('data', JSON.stringify(data))\n    elt.setAttribute('min-dimensions', JSON.stringify(minDimensions))\n    elt.setAttribute('style', JSON.stringify(style))\n    elt.setAttribute('columns', JSON.stringify(columns))\n    elt.setAttribute('interactif', interactif ? 'true' : 'false')\n    if (showVerifyButton !== undefined) {\n      elt.setAttribute(\n        'show-verify-button',\n        showVerifyButton ? 'true' : 'false',\n      )\n    }\n    return elt\n  }\n\n  connectedCallback() {\n    this.innerHTML = '<div></div>'\n    const container = (this.firstElementChild ??\n      document.createElement('div')) as HTMLDivElement\n\n    let data: (number | string)[][] = []\n    let minDimensions = [5, 5]\n    let style = {}\n    let columns = []\n    let nbLignesCachees = 0\n    let nbColonnesCachees = 0\n    try {\n      if (this.getAttribute('data'))\n        data = JSON.parse(this.getAttribute('data') ?? '') as (\n          | string\n          | number\n        )[][]\n    } catch {}\n    try {\n      if (this.getAttribute('min-dimensions'))\n        minDimensions = JSON.parse(this.getAttribute('min-dimensions') ?? '')\n    } catch {}\n    try {\n      if (this.getAttribute('style'))\n        style = JSON.parse(this.getAttribute('style') ?? '')\n    } catch {}\n    try {\n      if (this.getAttribute('columns'))\n        columns = JSON.parse(this.getAttribute('columns') ?? '[]')\n    } catch {}\n    try {\n      if (this.getAttribute('nb-lignes-cachees'))\n        nbLignesCachees = Number(this.getAttribute('nb-lignes-cachees') ?? '0')\n    } catch {}\n    try {\n      if (this.getAttribute('nb-colonnes-cachees'))\n        nbColonnesCachees = Number(\n          this.getAttribute('nb-colonnes-cachees') ?? '0',\n        )\n    } catch {}\n    this._spreadsheet = jspreadsheet(container, {\n      tabs: false,\n      toolbar: false,\n      worksheets: [\n        {\n          data,\n          minDimensions,\n          tableOverflow: true,\n          tableHeight: '300px',\n          style,\n          columns,\n        } as any,\n      ],\n    })[0]\n    for (let i = 0; i < nbLignesCachees; i++) {\n      this.hideRow(i)\n    }\n    for (let j = 0; j < nbColonnesCachees; j++) {\n      this.hideColumn(j)\n    }\n    let numeroExercice = 0\n    let question = 0\n    const idMatch = this.id.match(/sheet-Ex(\\d+)Q(\\d+)$/)\n    if (idMatch) {\n      numeroExercice = Number(idMatch[1])\n      question = Number(idMatch[2])\n    }\n\n    const feedBackElt = document.createElement('div')\n    feedBackElt.id = 'message-faux'\n    container.appendChild(feedBackElt)\n    const resultCheck = document.createElement('span')\n    resultCheck.id = `resultatCheckEx${numeroExercice}Q${question}`\n    container.appendChild(resultCheck)\n    const divFeedback = document.createElement('div')\n    divFeedback.id = `feedbackEx${numeroExercice}Q${question}`\n    divFeedback.className =\n      'italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest'\n    container.appendChild(divFeedback)\n\n    if (this.getAttribute('show-verify-button') === 'false') {\n      this.showVerifyButton = false\n    }\n    const bouton = document.createElement('button')\n    bouton.id = 'runCode'\n    bouton.textContent = 'Vrifier'\n    bouton.style.boxSizing = 'border-box'\n    bouton.style.position = 'relative'\n    bouton.style.zIndex = '10'\n    bouton.style.marginTop = '10px'\n    // Styles personnaliss\n    bouton.style.backgroundColor = '#2b6cb0' // Bleu coopmaths\n    bouton.style.color = 'white' // Texte blanc\n    bouton.style.border = 'none' // Pas de bordure\n    bouton.style.borderRadius = '6px' // Bords arrondis\n    bouton.style.padding = '8px 20px' // Espacement interne\n    bouton.style.fontSize = '1rem' // Taille du texte\n    bouton.style.fontWeight = 'bold' // Texte en gras\n    bouton.style.cursor = 'pointer' // Curseur main au survol\n    bouton.style.boxShadow = '0 2px 6px rgba(0,0,0,0.08)' // Ombre lgre\n\n    // Effet au survol\n    bouton.onmouseover = () => {\n      bouton.style.backgroundColor = '#174ea6'\n    }\n    bouton.onmouseout = () => {\n      bouton.style.backgroundColor = '#2b6cb0'\n    }\n    bouton.style.display =\n      this.getAttribute('interactif') === 'true' ||\n      this.showVerifyButton === false\n        ? 'none'\n        : 'block'\n    container.appendChild(bouton)\n    if (idMatch) {\n      const numeroExercice = Number(idMatch[1])\n      const question = Number(idMatch[2])\n      if (this.showVerifyButton) {\n        this._setupButton(bouton, numeroExercice, question)\n      }\n    }\n    this.dispatchEvent(new CustomEvent('spreadsheet-ready'))\n  }\n\n  disconnectedCallback() {\n    if (this._spreadsheet) {\n      this._spreadsheet = null\n    }\n    // Retire le listener personnalis\n    const bouton = this.querySelector('#runCode')\n    if (bouton && this._buttonListener) {\n      bouton.removeEventListener('click', this._buttonListener)\n    }\n    // Retire tous les listeners ajouts via addListener\n    Object.entries(this._customListeners).forEach(([eventName, callback]) => {\n      this.removeEventListener(eventName, callback)\n    })\n    this._customListeners = {}\n  }\n\n  _setupButton(\n    bouton: HTMLButtonElement,\n    numeroExercice: number,\n    question: number,\n  ) {\n    const eventName = `checkEx${numeroExercice}Q${question}`\n    this._buttonListener = () => {\n      this.dispatchEvent(\n        new CustomEvent(eventName, { detail: { sheet: this } }),\n      )\n    }\n    bouton.addEventListener('click', this._buttonListener)\n  }\n\n  getCellValue(column: number, row: number) {\n    return this._spreadsheet.getValueFromCoords(column, row, true)\n  }\n\n  getCellFormula(column: number, row: number) {\n    return String(\n      this._spreadsheet.getValueFromCoords(column, row, false),\n    ).toUpperCase()\n  }\n\n  getData() {\n    // Retourne les donnes de la premire worksheet\n    return this._spreadsheet.getData() ?? []\n  }\n\n  setCellValue(column: number, row: number, value: string | number) {\n    this._spreadsheet.setValueFromCoords(column, row, value, true)\n  }\n\n  setCellFormula(column: number, row: number, formula: string) {\n    if (!formula.startsWith('=')) formula = '=' + formula.toUpperCase()\n    this._spreadsheet.setValueFromCoords(column, row, formula, true)\n  }\n\n  setData(data: any[]) {\n    this._spreadsheet.setData(data)\n  }\n\n  isMounted() {\n    return this._spreadsheet !== null\n  }\n\n  getMinDimensions() {\n    return this._spreadsheet.minDimensions ?? [5, 5]\n  }\n\n  getStyle() {\n    return this._spreadsheet.style ?? {}\n  }\n\n  setCellStyle(style: Record<string, string>) {\n    this._spreadsheet.setStyle(style)\n  }\n\n  getColumns() {\n    return this._spreadsheet.columns ?? []\n  }\n\n  showRow(rowIndex: number) {\n    this._spreadsheet.showRow(rowIndex)\n  }\n\n  hideRow(rowIndex: number) {\n    this._spreadsheet.hideRow(rowIndex)\n  }\n\n  showColumn(colIndex: number) {\n    this._spreadsheet.showColumn(colIndex)\n  }\n\n  hideColumn(colIndex: number) {\n    this._spreadsheet.hideColumn(colIndex)\n  }\n}\n\ncustomElements.define('my-spreadsheet', MySpreadsheetElement)\n","import { randint } from '../../modules/outils'\nimport { toutPourUnPoint } from '../interactif/mathLive'\nimport type { GoodAnswersFormulas, IExercice, SheetTestDatas } from '../types'\nimport { MySpreadsheetElement } from './MySpreadSheet'\n\nexport function compareSheetFunction(\n  exercice: IExercice,\n  question: number,\n  goodAnswers: GoodAnswersFormulas,\n  sheetTestDatas: SheetTestDatas,\n  userSheet: MySpreadsheetElement,\n): { isOk: boolean; messages: string } {\n  // 1. Rcupre les donnes de l'utilisateur\n  const userData = userSheet.getData()\n  // D'abord contrler que des formules sont bien prsentes aux bons endroits\n  const messages: string[] = []\n  let testFormulas = true\n  let goodFormulas = 0\n  goodAnswers.forEach((cellData) => {\n    const cellRef = cellData.ref\n    const col = cellRef.charCodeAt(0) - 65\n    const row = parseInt(cellRef.slice(1)) - 1\n    if (cellData.formula && cellData.value === undefined) {\n      const userFormula = userSheet.getCellFormula(col, row)\n      if (!userFormula.startsWith('=')) {\n        messages.push(\n          `La cellule ${cellRef} devrait contenir une formule mais elle ne contient pas de formule.<br>`,\n        )\n        testFormulas = false\n        const style: Record<string, string> = {}\n        style[cellRef] =\n          'background-color: #ffcccc; border: 2px solid #ff0000; border-radius: 8px; padding: 4px;'\n        userSheet.setCellStyle(style)\n        return\n      }\n      if (\n        String(userFormula).toUpperCase() === cellData.formula.toUpperCase()\n      ) {\n        const style: Record<string, string> = {}\n        style[cellRef] =\n          'background-color: #ccffcc; border: 2px solid #008000; border-radius: 8px; padding: 4px;'\n        userSheet.setCellStyle(style)\n        goodFormulas++\n      }\n    } else if (cellData.value !== undefined) {\n      const userValue = userSheet.getCellValue(col, row)\n      if (userValue === cellData.value) {\n        const style: Record<string, string> = {}\n        style[cellRef] =\n          'background-color: #ccffcc; border: 2px solid #008000; border-radius: 8px; padding: 4px;'\n        userSheet.setCellStyle(style)\n        goodFormulas++\n      }\n    } else {\n      window.notify(\n        `compareSheetFunction: cellData invalide ${JSON.stringify(\n          cellData,\n        )} pour la question ${question} de l'exercice ${exercice.id}`,\n        { exercice, question, cellData },\n      )\n    }\n  })\n  if (testFormulas && goodFormulas === goodAnswers.length) {\n    return {\n      isOk: true,\n      messages:\n        goodAnswers.length === 1\n          ? ' La saisie est correcte !'\n          : ' Toutes les saisies sont correctes !',\n    }\n  }\n  let maxMessages = ''\n  // sinon contrler que les rsultats sont corrects pour diffrentes valeurs avec les formules saisies par l'utilisateur\n\n  const testSheetForGoodAnswers = MySpreadsheetElement.create({\n    data: userData,\n    minDimensions: userSheet.getMinDimensions(),\n    style: userSheet.getStyle(),\n    columns: userSheet.getColumns(),\n    interactif: false,\n    id: 'testSheet',\n  })\n\n  const testSheetForUserResponses = MySpreadsheetElement.create({\n    data: userData,\n    minDimensions: userSheet.getMinDimensions(),\n    style: userSheet.getStyle(),\n    columns: userSheet.getColumns(),\n    interactif: false,\n    id: 'testSheetUser',\n  })\n  testSheetForGoodAnswers.style.position = 'absolute'\n  testSheetForGoodAnswers.style.left = '-9999px'\n  document.body.appendChild(testSheetForGoodAnswers)\n  goodAnswers.forEach((cellData) => {\n    const cellRef = cellData.ref\n    const col = cellRef.charCodeAt(0) - 65\n    const row = parseInt(cellRef.slice(1)) - 1\n    // Remettre les bonnes formules\n    if (cellData.formula) {\n      testSheetForGoodAnswers.setCellFormula(col, row, cellData.formula)\n    } else if (cellData.value !== undefined) {\n      testSheetForGoodAnswers.setCellValue(col, row, cellData.value)\n    }\n  })\n  testSheetForUserResponses.style.position = 'absolute'\n  testSheetForUserResponses.style.left = '-5999px'\n  document.body.appendChild(testSheetForUserResponses)\n  const messagesPerTest: string[][] = []\n  goodAnswers.forEach(() => {\n    messagesPerTest.push([])\n  })\n  goodAnswers.forEach((cellData, answerIndex) => {\n    const cellRef = cellData.ref\n    const col = cellRef.charCodeAt(0) - 65\n    const row = parseInt(cellRef.slice(1)) - 1\n    sheetTestDatas.forEach((testData) => {\n      // Appliquer les valeurs de test\n      const testCellRef = testData.ref\n      if (testCellRef.includes(':')) {\n        const [startRef, endRef] = testCellRef.split(':')\n        const startCol = startRef.charCodeAt(0) - 65\n        const startRow = parseInt(startRef.slice(1)) - 1\n        const endCol = endRef.charCodeAt(0) - 65\n        const endRow = parseInt(endRef.slice(1)) - 1\n        for (let r = startRow; r <= endRow; r++) {\n          for (let c = startCol; c <= endCol; c++) {\n            const [min, max] = testData.rangeValues\n            const randomValue = randint(min, max)\n            testSheetForGoodAnswers.setCellValue(c, r, randomValue)\n            testSheetForUserResponses.setCellValue(c, r, randomValue)\n          }\n        }\n        // Recalculer les deux feuilles\n        const goodAnswerValue = testSheetForGoodAnswers.getCellValue(col, row)\n        const userAnswerValue = testSheetForUserResponses.getCellValue(col, row)\n        if (goodAnswerValue !== userAnswerValue) {\n          const style: Record<string, string> = {}\n          style[cellRef] =\n            'background-color: #ffcccc; border: 2px solid #ff0000; border-radius: 8px; padding: 4px;'\n          userSheet.setCellStyle(style)\n          messagesPerTest[answerIndex].push(\n            `La saisie de la cellule ${cellRef} [${userSheet.getCellFormula(col, row)}] est incorrecte .<br>`,\n          )\n        }\n      } else {\n        const testCol = testCellRef.charCodeAt(0) - 65\n        const testRow = parseInt(testCellRef.slice(1)) - 1\n        const [min, max] = testData.rangeValues\n        const randomValue = randint(min, max)\n        testSheetForGoodAnswers.setCellValue(testCol, testRow, randomValue)\n        testSheetForUserResponses.setCellValue(testCol, testRow, randomValue)\n        // Recalculer les deux feuilles\n        const goodAnswerValue = testSheetForGoodAnswers.getCellValue(col, row)\n        const userAnswerValue = testSheetForUserResponses.getCellValue(col, row)\n        if (goodAnswerValue !== userAnswerValue) {\n          const style: Record<string, string> = {}\n          style[cellRef] =\n            'background-color: #ffcccc; border: 2px solid #ff0000; border-radius: 8px; padding: 4px;'\n          userSheet.setCellStyle(style)\n          messagesPerTest[answerIndex].push(\n            `La saisie de la cellule ${cellRef} [${userSheet.getCellFormula(col, row)}] est incorrecte .<br>`,\n          )\n        }\n      }\n    })\n  })\n  // Consolider les messages\n  messages.push(...messagesPerTest.flat())\n\n  maxMessages = messages.sort((a, b) => b.length - a.length)[0] ?? ''\n\n  document.body.removeChild(testSheetForGoodAnswers)\n  document.body.removeChild(testSheetForUserResponses)\n  const feedback =\n    maxMessages.length === 0\n      ? ' Toutes les saisies sont correctes !'\n      : ' Des erreurs ont t dtctes.'\n  return {\n    isOk: maxMessages.length === 0,\n    messages: maxMessages + feedback,\n  }\n}\n\nexport function verifQuestionTableur(\n  exercice: IExercice,\n  questionIndex: number,\n): {\n  isOk: boolean\n  feedback: string\n  score: { nbBonnesReponses: number; nbReponses: number }\n} {\n  if (exercice.autoCorrection[questionIndex]?.reponse == null) {\n    throw Error(\n      `verifQuestionMathlive appel sur une question sans rponse: ${JSON.stringify(\n        {\n          exercice,\n          question: questionIndex,\n          autoCorrection: exercice.autoCorrection[questionIndex],\n        },\n      )}`,\n    )\n  }\n  if (exercice.autoCorrection[questionIndex].reponse.param == null) {\n    window.notify(\n      `verifQuestionTableur appel sur une question sans param : ${JSON.stringify(\n        {\n          exercice,\n          question: questionIndex,\n          param: exercice.autoCorrection[questionIndex].reponse,\n        },\n      )}`,\n      { exercice, questionIndex },\n    )\n  }\n\n  if (exercice.answers === undefined) exercice.answers = {}\n  const reponses = exercice.autoCorrection[questionIndex].reponse.valeur\n  if (reponses == null) {\n    window.notify(\n      `verifQuestionTableur: reponses est null pour la question ${questionIndex} de l'exercice ${exercice.id}`,\n      { exercice, questionIndex },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n  const bareme: (arg: number[]) => [number, number] =\n    reponses.bareme ?? toutPourUnPoint\n  const sheetAnswer = reponses.sheetAnswer\n  if (sheetAnswer == null) {\n    window.notify(\n      `verifQuestionTableur: sheetAnswer est null pour la question ${questionIndex} de l'exercice ${exercice.id}`,\n      { exercice, questionIndex },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n  let result: string[] = []\n  const goodAnswersFormulas = sheetAnswer.goodAnswerFormulas\n  const sheetTestDatas = sheetAnswer.sheetTestDatas\n\n  const sheetElement = document.getElementById(\n    `sheet-Ex${exercice.numeroExercice}Q${questionIndex}`,\n  ) as MySpreadsheetElement\n  if (!sheetElement) {\n    if (!sheetElement) {\n      console.error(\n        `sheet-Ex${exercice.numeroExercice}Q${questionIndex} not found`,\n      )\n      result = goodAnswersFormulas.map(() => 'KO')\n      return {\n        isOk: false,\n        feedback: 'erreur dans le programme',\n        score: { nbBonnesReponses: 0, nbReponses: result.length },\n      }\n    }\n  }\n  if (sheetElement && sheetElement.isMounted()) {\n    exercice.answers[`sheet-Ex${exercice.numeroExercice}Q${questionIndex}`] =\n      JSON.stringify(sheetElement.getData())\n    const spanResultat = document.querySelector(\n      `#resultatCheckEx${exercice.numeroExercice}Q${questionIndex}`,\n    )\n    const divFeedback = document.querySelector<HTMLElement>(\n      `#feedbackEx${exercice.numeroExercice}Q${questionIndex}`,\n    )\n    const { isOk, messages } = compareSheetFunction(\n      exercice,\n      questionIndex,\n      goodAnswersFormulas,\n      sheetTestDatas,\n      sheetElement,\n    )\n    if (messages.length > 0 && spanResultat && divFeedback) {\n      divFeedback.innerHTML = messages\n      if (!isOk) {\n        if (spanResultat) spanResultat.innerHTML = ''\n        result = goodAnswersFormulas.map(() => 'KO')\n      } else {\n        if (spanResultat) spanResultat.innerHTML = ''\n        result = goodAnswersFormulas.map(() => 'OK')\n      }\n    }\n  } else {\n    console.error(\n      `sheet-Ex${exercice.numeroExercice}Q${questionIndex} is not mounted`,\n    )\n    result = goodAnswersFormulas.map(() => 'KO')\n  }\n  const [nbBonnesReponses, nbReponses] = bareme(\n    result.map((res) => (res === 'OK' ? 1 : 0)),\n  )\n  return {\n    isOk: nbBonnesReponses === nbReponses,\n    feedback: '', // feedback gr dans compareSheetFunction\n    score: { nbBonnesReponses, nbReponses },\n  }\n}\n\nexport function createTableurLatex(\n  rowNbr: number,\n  colNbr: number,\n  data: any,\n  styles: any,\n  options: {\n    formule?: boolean\n    formuleTexte?: string\n    formuleCellule?: string\n    firstColHeaderWidth?: string\n  } = {},\n) {\n  let output = `\\\\begin{tabularx}{0.9\\\\linewidth}\n  {|>{\\\\cellcolor{lightgray}}c|\n  ${options.firstColHeaderWidth ? `>{\\\\centering \\\\arraybackslash}p{${options.firstColHeaderWidth}}|` : '>{\\\\centering \\\\arraybackslash}X|'}\n  *{${colNbr - 1}}{>{\\\\centering \\\\arraybackslash}X|}}\\\\hline\\n`\n\n  if (options.formule) {\n    output += `\\\\multicolumn{1}{|l}{${options.formuleCellule}}&\\\\multicolumn{1}{r|}{}&\\\\multicolumn{${colNbr - 1}}{l|}{${options.formuleTexte}}\\\\\\\\ \\\\hline\\n`\n  }\n  // en-tte\n  output += '\\\\rowcolor{lightgray} &'\n  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'\n  for (let colIndex = 0; colIndex < colNbr - 1; colIndex++) {\n    output += `\\\\textbf{\\\\sffamily ${alphabet[colIndex]}}  & `\n  }\n  output += `\\\\textbf{\\\\sffamily ${alphabet[colNbr - 1]}} \\\\\\\\ \\\\hline\\n`\n\n  for (let rowIndex = 0; rowIndex < rowNbr; rowIndex++) {\n    const rowData = data[rowIndex] || {}\n    output += `\\\\textbf{\\\\sffamily ${rowIndex + 1}} &`\n    for (let colIndex = 0; colIndex < colNbr; colIndex++) {\n      const cell = rowData[colIndex] || {}\n      const styleCell = styles[cell.s ?? ''] || {}\n      let color = ''\n      if (styleCell.bg?.startsWith('#')) {\n        color = `\\\\cellcolor[HTML]{${styleCell.bg.replace('#', '')}}`\n      } else if (styleCell.bg) {\n        color = `\\\\cellcolor{${styleCell.bg}}`\n      }\n      if (cell?.t === 1) {\n        // texte\n        output += `\\\\raggedright ${color} ${cell.v || ''}  &`\n      } else if (cell?.t === 2) {\n        // number\n        output += `\\\\raggedleft ${color} ${cell.v || ''}  &`\n      } else if (cell?.t === 3) {\n        // boolean\n        output += `\\\\centering ${color} ${cell.v ? 'VRAI' : 'FAUX'}  &`\n      } else {\n        output += `${color} ${cell.v || ''}  &`\n      }\n    }\n    output = output.slice(0, -1) // enlever le dernier &\n    output += '\\\\\\\\ \\\\hline\\n'\n  }\n  output += '\\\\end{tabularx}\\n'\n  return output\n}\n\nexport function addSheet({\n  numeroExercice,\n  question,\n  data,\n  minDimensions,\n  style,\n  columns,\n  interactif,\n  showVerifyButton,\n  nbLignesCachees,\n  nbColonnesCachees,\n}: {\n  numeroExercice: number\n  question: number\n  data: any[][]\n  minDimensions: [number, number]\n  style?: any\n  columns: any[]\n  interactif: boolean\n  showVerifyButton: boolean\n  nbLignesCachees?: number\n  nbColonnesCachees?: number\n}): string {\n  return (\n    `<my-spreadsheet\n  id=\"sheet-Ex${numeroExercice}Q${question}\"\n  data='${JSON.stringify(data)}'\n  min-dimensions='${JSON.stringify(minDimensions)}'\n  ${style ? `style='${JSON.stringify(style)}'` : ''}\n  columns='${JSON.stringify(columns)}'\n  interactif='${interactif}'\n    ${showVerifyButton !== undefined ? `show-verify-button='${showVerifyButton}'` : ''}\n    ${nbLignesCachees !== undefined ? `nb-lignes-cachees='${nbLignesCachees}'` : ''}\n    ${nbColonnesCachees !== undefined ? `nb-colonnes-cachees='${nbColonnesCachees}'` : ''}\n>` +\n    (interactif\n      ? `<div class=\"ml-2 py-2\" id=\"resultatCheckEx${numeroExercice}Q${question}\"></div>\n<div class =\"ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest\" id=\"feedbackEx${numeroExercice}Q${question}\"}></div>`\n      : '') +\n    '</my-spreadsheet>'\n  )\n}\n","import type { IExercice, ResultOfExerciceInteractif } from '../../lib/types'\n\nexport function afficheScore(\n  exercice: IExercice,\n  nbBonnesReponses: number,\n  nbMauvaisesReponses: number,\n  divScore?: HTMLDivElement,\n  divButton?: HTMLButtonElement,\n): ResultOfExerciceInteractif {\n  if (divButton != null) {\n    divButton.classList.add(\n      'cursor-not-allowed',\n      'opacity-50',\n      'pointer-events-none',\n    )\n  }\n  if (divScore != null) {\n    divScore.innerHTML = `${nbBonnesReponses} / ${nbBonnesReponses + nbMauvaisesReponses}`\n    divScore.style.color = '#f15929'\n    divScore.style.fontWeight = 'bold'\n    divScore.style.fontSize = 'x-large'\n    divScore.style.display = 'inline'\n  }\n  return {\n    numberOfPoints: nbBonnesReponses,\n    numberOfQuestions: nbBonnesReponses + nbMauvaisesReponses,\n  }\n}\n","import { addElement, addText, get } from '../lib/html/dom'\n/**\n * Fonctions pour grer les messages utilisateur (feedback erreur|warning ou messages positifs)\n * @module\n */\n\n/**\n * Les types possibles\n * @type {string[]}\n */\nconst types = ['info', 'warning', 'error', 'positive']\n\n/**\n * Ajoute le feedback dans container\n * @param {HTMLElement} container\n * @param {Object} feedback\n * @param {string} feedback.message\n * @param {string} [feedback.type=error]\n * @param {string} [feedback.titre]\n * @return {HTMLElement} L'lment du feedback (dj ajout dans le container)\n */\nexport function addFeedback(\n  container,\n  { message, type = 'error', titre } = {},\n) {\n  if (!types.includes(type)) {\n    console.error(Error(`type de message inconnu : ${type}`))\n    type = 'error'\n  }\n  if (!message) throw Error('Message obligatoire pour tout retour utilisateur')\n  const cssDiv = type === 'info' ? '' : type\n  const div = addElement(container, 'div', {\n    className: `ui message ${cssDiv}`,\n  })\n  const cssIcon =\n    type === 'error'\n      ? 'frown outline'\n      : type === 'warning'\n        ? 'bullhorn'\n        : 'bell outline' // info\n  const iconClose = addElement(div, 'i', { className: 'close icon' })\n  iconClose.addEventListener('click', () => div.remove())\n  if (titre) {\n    const divTitre = addElement(div, 'div', { className: 'header' })\n    addElement(divTitre, 'i', { className: `${cssIcon} icon` })\n    addText(divTitre, titre)\n  }\n  if (/<[a-zA-Z0-9_ \"']+/.test(message)) div.innerHTML += message\n  else addText(div, message)\n  return div\n}\n\n/**\n * Ajoute un feedback (erreur ou encouragement)\n * @param {Object} feedback\n * @param {string} feedback.id id du div conteneur  utiliser\n * @param {string} feedback.message Le message  afficher\n * @param {string} feedback.type error|positive\n * @author Rmi ANGOT\n */\nexport function messageFeedback({ id, message = '', type = 'error' } = {}) {\n  if (!id || !message) return console.error(TypeError('arguments manquants'))\n  const container = get(id)\n  const div = addFeedback(container, { message, type })\n  // div.style.width = '400px' MGu ne jamais mettre en dure une largeur, c'est pas responsive\n  div.classList.add('my-2', 'p-1')\n  if (type === 'error') {\n    div.classList.add('bg-coopmaths-action-200', 'rounded-lg', 'p-3')\n  } else if (type === 'positive') {\n    div.classList.add('bg-coopmaths-warn-100', 'rounded-lg', 'p-3')\n  } else {\n    div.style.color = 'rgb(33,109,54)'\n  }\n  return div\n}\n\nexport class UserFriendlyError extends Error {\n  /**\n   * Erreur destine  tre affiche  l'utilisateur\n   * @param {string} [message] Si non fourni ce sera le texte gnrique 'Une erreur est survenue\n   * @param {Object} [options]\n   * @param {string} [options.titre=Erreur interne]\n   * @param {string} [options.type=error]\n   */\n  constructor(message, { titre, type } = {}) {\n    if (!message)\n      message =\n        'Une erreur est survenue.<br>Essayez de rafraichir la page.<br>Si l\\'erreur persiste merci de contacter : <a href=\"mailto:contact@coopmaths.fr\">contact@coopmaths.fr</a>'\n    super(message)\n    this.isUserFriendly = true // pour indiquer que le message peut tre affich tel quel  l'utilisateur\n\n    this.type = (types.includes(type) && type) || 'error'\n  }\n}\n\nexport const getInvalidModuleError = (path) =>\n  new UserFriendlyError(\n    `${path} existe mais ne fournit pas les donnes attendues, impossible de charger cet exercice`,\n  )\nexport const getNoLatexError = (id) =>\n  new UserFriendlyError(\n    `L'exercice ${id} n'a, pour l'instant, pas de version Latex`,\n    { titre: 'Pas de contenu Latex pour cet exercice', type: 'warning' },\n  )\nexport const getUnknownError = (id) =>\n  new UserFriendlyError(\n    `L'identifiant ${id} ne correspond  aucun exercice MathALEA.<br>Ceci est peut-tre d  un lien incomplet ou obsolte.`,\n    { titre: 'Le code de lexercice nest pas valide' },\n  )\n\n/**\n * Gestionnaire d'erreur gnrique ( mettre dans un catch). Il affichera l'erreur  l'utilisateur en cas de UserFriendlyError, ou le message d'erreur par dfaut\n * @param {Error} error\n */\nexport function errorHandler(error) {\n  // on sort toujours l'erreur d'origine en console\n  console.error(error)\n  // et on gre un retour utilisateur\n  const container = get('containerErreur')\n  if (!error.isUserFriendly) error = new UserFriendlyError() // le message d'erreur par dfaut\n  addFeedback(container, error)\n}\n\nexport const tropDeChiffres = 'Trop de chiffres'\n","import type { DragHandler, IExercice, TouchHandler } from '../../lib/types'\nimport { context } from '../../modules/context'\nimport { messageFeedback } from '../../modules/messages'\nimport { get } from '../html/dom'\nimport { shuffle } from '../outils/arrayOutils'\nimport { toutPourUnPoint } from './mathLive'\n\nexport type Etiquette = {\n  id: string // Un numro unique par tiquette ! (valeur rserve : 0 pour signaler l'absence d'tiquette !)\n  contenu: string // Ce que contient l'tiquette (aussi bien du texte, que du latex, qu'une image...)\n  duplicable?: boolean\n  callback?: (e: Event) => void // @todo  implmenter.\n}\n\n/*\nL'utilisation de l'interactif faon drag&drop ncessite la dclaration des bonnes rponses avec handleHanswers() :\nUn exemple :\nhandleHanswers(this, i, {\nrectangle1: {value: etiquetteId, callback?: ()=>void},\nrectangle2: {value: etiquetteId, callback?: ()=>void},\n....,\n{formatInteractif: 'dnd'})\n\nLa fonction de callback est excute sur le rectangle (div) correspondant.\nPar exemple, on peut imaginer un fonction qui regarde le textContent de l'lment prcdent et qui,\nsi c'est un nombre suprieur  1, ajoute un 's' au contenu de l'tiquette 'droppe' dans le rectangle.\nCe n'est qu'une ide, je ne sais mme pas si c'est ralisable, ni mme souhaitable  l'heure o je mets au point ces fonctions !\nEn fait, c'tait pour viter de doubler le nombre d'tiquettes avec des singuliers et des pluriels...\nPour l'instant, l'utilisation de cette callback n'est pas implmente.\n*/\n\n/**\n * On stocke l'lment en dplacement\n * @param e\n */\nfunction dragStartHandler(e: DragEvent) {\n  // console.log('dragStartHandler', e)\n  if (e.target instanceof HTMLDivElement) {\n    e.dataTransfer?.setData('text/plain', e.target.id)\n  }\n}\n\nfunction dragOverHandler(e: DragEvent) {\n  e.preventDefault() // Ncessaire pour autoriser le drop\n  const target = e.target as HTMLElement\n  if (target.classList.contains('trashDND')) {\n    const icone = target.firstChild\n    if (icone && icone instanceof HTMLElement) {\n      icone.classList.add('hovered')\n    }\n  }\n}\n/**\n * glisser  la souris termin on relche...\n * @param e\n */\nfunction dragEndHandler(e: DragEvent) {\n  // console.log('dragEndHandler', e)\n  e.preventDefault()\n  // Rinitialise la position de l'tiquette originale aprs le drop\n  // if (e.target instanceof HTMLElement) {\n  //  e.target.style.position = 'relative'\n  // }\n}\n/**\n * gre le dpot  la souris\n * @param e\n */\nfunction dropHandler(e: DragEvent) {\n  // console.log('dropHandler', e)\n  e.preventDefault()\n  const dropTarget = e.target as HTMLDivElement\n  const etiquetteId = e.dataTransfer?.getData('text/plain')\n  if (etiquetteId) {\n    const etiquette = document.getElementById(etiquetteId)\n    if (etiquette && dropTarget) {\n      if (\n        (!dropTarget.id || !dropTarget.id.includes('rectangle')) &&\n        etiquette.id.includes('clone')\n      ) {\n        etiquette.parentElement?.removeChild(etiquette)\n        return\n      }\n      // Expression rgulire pour capturer les 3 groupes de chiffres\n      const regex = /Ex(\\d+)Q(\\d+)I(\\d+)/\n      const matches = etiquette.id.match(regex)\n      let numeroExQuest = ''\n      if (matches) {\n        const numeroEx = matches[1]\n        const numeroQuest = matches[2]\n        numeroExQuest = `Ex${numeroEx}Q${numeroQuest}`\n      }\n      if (\n        etiquette.classList.contains('duplicable') &&\n        dropTarget.classList.contains('rectangleDND') &&\n        dropTarget.id.includes(numeroExQuest)\n      ) {\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        dropTarget.appendChild(clonedEtiquette)\n      } else if (\n        dropTarget.classList.contains('rectangleDND') &&\n        dropTarget.id.includes(numeroExQuest)\n      ) {\n        addDeleteButton(etiquette, etiquette.parentElement)\n        dropTarget.appendChild(etiquette)\n      } else if (\n        dropTarget.parentElement?.classList.contains('rectangleDND') &&\n        dropTarget.parentElement?.id.includes(numeroExQuest)\n      ) {\n        // on est sur une tiquette dj depose\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        dropTarget.after(clonedEtiquette)\n      }\n      dropTarget.classList.remove('hovered') // Enlve l'effet aprs le drop\n    }\n  }\n}\n/**\n *  dmarre le dplacement de l'tiquette sur interface tactile et s'assure que toute l'tiquette est dplace\n */\nfunction touchStartHandler(e: TouchEvent) {\n  // console.log('touchStartHandler', e)\n  let target = e.target as HTMLElement\n  // Si le touch a t dclench sur un lment interne (comme un <span>), on remonte jusqu'au div parent\n  while (target && target.tagName !== 'DIV') {\n    target = target.parentElement as HTMLElement\n  }\n\n  if (\n    target?.classList.contains('etiquette') &&\n    target?.classList.contains('dragOk')\n  ) {\n    // Stocker l'lment HTML complet (pour clonage)\n    const ele = target.cloneNode(true) as HTMLElement\n    ele.style.display = 'none'\n    target.before(ele)\n  }\n}\n\n// gre le dplacement de l'tiquette sur interface tactile\nfunction touchMoveHandler(e: TouchEvent) {\n  // console.log('touchMoveHandler', e)\n  e.preventDefault()\n  const touch = e.changedTouches[0]\n  let etiquette = touch.target as HTMLElement\n  while (etiquette && etiquette.tagName !== 'DIV') {\n    etiquette = etiquette.parentElement as HTMLElement\n  }\n\n  if (\n    etiquette &&\n    etiquette.classList.contains('etiquette') &&\n    etiquette.classList.contains('dragOk')\n  ) {\n    if (etiquette.parentElement) {\n      const top = etiquette.parentElement.offsetTop\n      const left = etiquette.parentElement.offsetLeft\n      const rectangleBounds = etiquette.parentElement.getBoundingClientRect()\n      if (rectangleBounds) {\n        const touchX = touch.clientX\n        const touchY = touch.clientY\n        ;(etiquette.previousElementSibling as HTMLDivElement).style.display =\n          'block'\n        ;(etiquette as HTMLDivElement).style.position = 'absolute'\n        ;(etiquette as HTMLDivElement).style.left =\n          `${touchX - rectangleBounds.left + left - etiquette.clientWidth / 2}px`\n        ;(etiquette as HTMLDivElement).style.top =\n          `${touchY - rectangleBounds.top + top - etiquette.clientHeight / 2}px`\n      }\n    }\n    // Expression rgulire pour capturer les 3 groupes de chiffres\n    const regex = /Ex(\\d+)Q(\\d+)I(\\d+)/\n    const matches = etiquette.id.match(regex)\n    let numeroExQuest = ''\n    if (matches) {\n      const numeroEx = matches[1]\n      const numeroQuest = matches[2]\n      numeroExQuest = `Ex${numeroEx}Q${numeroQuest}`\n    }\n\n    // rectangleEx0Q0R1 : on s'intresse qu'au rectangle de la question et NON toute la page\n    const rectangles = document.querySelectorAll(\n      `div.rectangleDND[id^=\"rectangle${numeroExQuest}\"`,\n    )\n    for (const rectangle of rectangles) {\n      const rectangleBounds = rectangle.getBoundingClientRect()\n      const isHovered =\n        touch.clientX > rectangleBounds.left &&\n        touch.clientX < rectangleBounds.right &&\n        touch.clientY > rectangleBounds.top &&\n        touch.clientY < rectangleBounds.bottom\n      if (isHovered) {\n        rectangle.classList.add('hovered')\n      } else {\n        rectangle.classList.remove('hovered')\n      }\n    }\n  }\n}\n/**\n * gre le dpot de l'tiquette sur interface tactile\n * @param e\n * @returns\n */\nfunction touchEndHandler(e: TouchEvent) {\n  // console.log('touchEndHandler', e)\n  const touch = e.changedTouches[0]\n  let etiquette = touch.target as HTMLElement\n  /* on a fait un TOUCH sur le bouton SUPPRIMER */\n  if (\n    etiquette &&\n    etiquette.tagName === 'BUTTON' &&\n    etiquette.classList.contains('delete-btn')\n  ) {\n    etiquette.click()\n    return\n  }\n  // On cherche l'tiquette\n  while (etiquette && etiquette.tagName !== 'DIV') {\n    etiquette = etiquette.parentElement as HTMLElement\n  }\n  if (\n    etiquette &&\n    etiquette.classList.contains('etiquette') &&\n    etiquette.classList.contains('dragOk')\n  ) {\n    const centerX = touch.clientX\n    const centerY = touch.clientY\n    // Expression rgulire pour capturer les 3 groupes de chiffres\n    const regex = /Ex(\\d+)Q(\\d+)I(\\d+)/\n    const matches = etiquette.id.match(regex)\n    let numeroExQuest = ''\n    if (matches) {\n      const numeroEx = matches[1]\n      const numeroQuest = matches[2]\n      numeroExQuest = `Ex${numeroEx}Q${numeroQuest}`\n    }\n\n    // rectangleEx0Q0R1 : on s'intresse qu'au rectangle de la question et NON toute la page.\n    const rectangles = document.querySelectorAll(\n      `div.rectangleDND[id^=\"rectangle${numeroExQuest}\"`,\n    )\n    let dropTarget: HTMLDivElement | null = null\n    for (const rectangle of rectangles) {\n      const rectangleBounds = rectangle.getBoundingClientRect()\n      if (\n        centerX > rectangleBounds.left &&\n        centerX < rectangleBounds.right &&\n        centerY > rectangleBounds.top &&\n        centerY < rectangleBounds.bottom\n      ) {\n        // on a trouch un rectangle qui peut rceptionner l'tiquette\n        dropTarget = rectangle as HTMLDivElement\n        break\n      }\n    }\n\n    if (dropTarget?.children?.length) {\n      for (let i = 0; i < dropTarget?.children?.length; i++) {\n        const rectangleBounds = dropTarget.children[i].getBoundingClientRect()\n        if (\n          centerX > rectangleBounds.left &&\n          centerX < rectangleBounds.right &&\n          centerY > rectangleBounds.top &&\n          centerY < rectangleBounds.bottom\n        ) {\n          // on a trouv une tiquette dans le rectangle qui peut rceptionner l'tiquette\n          dropTarget = dropTarget.children[i] as HTMLDivElement\n          break\n        }\n      }\n    }\n    if (\n      dropTarget?.classList.contains('rectangleDND') ||\n      dropTarget?.parentElement?.classList.contains('rectangleDND')\n    ) {\n      if (\n        etiquette.classList.contains('duplicable') &&\n        dropTarget.classList.contains('rectangleDND')\n      ) {\n        // console.log('cloneEtiquette', etiquette)\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        clonedEtiquette.style.position = 'relative'\n        clonedEtiquette.style.top = '0px'\n        clonedEtiquette.classList.remove('dragOk')\n        ;(clonedEtiquette as HTMLDivElement).style.left = '0px'\n        ;(clonedEtiquette as HTMLDivElement).style.zIndex = '1'\n        dropTarget.appendChild(clonedEtiquette)\n      } else if (dropTarget.classList.contains('rectangleDND')) {\n        // console.log('cloneEtiquette', etiquette)\n        addDeleteButton(etiquette, etiquette.parentElement)\n        // etiquette.style.position = 'relative'\n        // etiquette.style.top = '0px'\n        // etiquette.classList.remove('dragOk')\n        // etiquette.style.left = '0px'\n        // etiquette.style.zIndex = '1'\n        etiquette.previousElementSibling?.remove()\n        dropTarget.appendChild(etiquette)\n      } else {\n        // console.log('cloneEtiquette2', etiquette)\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        clonedEtiquette.style.position = 'relative'\n        clonedEtiquette.style.top = '0px'\n        clonedEtiquette.classList.remove('dragOk')\n        ;(clonedEtiquette as HTMLDivElement).style.left = '0px'\n        ;(clonedEtiquette as HTMLDivElement).style.zIndex = '1'\n        dropTarget.after(clonedEtiquette)\n      }\n      dropTarget.classList.remove('hovered')\n    }\n    // on remet l'tiquette  sa place\n    ;(etiquette as HTMLDivElement).style.position = 'relative'\n    ;(etiquette as HTMLDivElement).style.top = '0px'\n    ;(etiquette as HTMLDivElement).style.left = '0px'\n    if (etiquette.classList.contains('duplicable'))\n      etiquette.previousElementSibling?.remove()\n  }\n}\n// met le rectangle en effet 'green glowing'\nfunction dragEnterHandler(e: DragEvent) {\n  if (\n    e.target instanceof HTMLElement &&\n    e.target.classList.contains('rectangleDND')\n  ) {\n    e.target.classList.add('hovered')\n  }\n}\n// retire l'effet 'green glowing'\nfunction dragLeaveHandler(e: DragEvent) {\n  const target = e.target\n  if (\n    target instanceof HTMLElement &&\n    (target.classList.contains('rectangleDND') ||\n      target.classList.contains('trashDND'))\n  ) {\n    target.classList.remove('hovered')\n  }\n}\n\nfunction addDeleteButton(\n  etiquette: HTMLElement,\n  parent: HTMLElement | null = null,\n) {\n  const deleteBtn = document.createElement('button')\n  deleteBtn.textContent = 'x'\n  deleteBtn.classList.add('delete-btn')\n  deleteBtn.addEventListener('click', () => {\n    if (etiquette.classList.contains('duplicable')) {\n      etiquette.remove() // Supprime l'tiquette du DOM\n    } else {\n      parent?.appendChild(etiquette)\n      // delete le bouton\n      etiquette.removeChild(deleteBtn)\n    }\n  })\n  etiquette.appendChild(deleteBtn)\n}\n\n/**\n * C'est la fonction utilise par exerciceInteractif pour vrifier ce type de question\n * @param exercice\n * @param question\n * @returns\n */\nexport function verifDragAndDrop(\n  exercice: IExercice,\n  question: number,\n): {\n  isOk: boolean\n  feedback: string\n  score: { nbBonnesReponses: number; nbReponses: number }\n} {\n  // tout d'abord on va supprimer les listeners !\n  const exoDragAndDrops = exercice.dragAndDrops\n  if (exoDragAndDrops == null) {\n    window.notify(\n      \"Problme survenu dans verifDragAndDrop : il n'y a pas d'array dragAndDrops dans exercice\",\n      {},\n    )\n    return {\n      isOk: false,\n      feedback: 'Un problme est survenu',\n      score: { nbBonnesReponses: 0, nbReponses: 0 },\n    }\n  }\n  const leDragAndDrop = exoDragAndDrops[question]\n  for (const [element, type, listener] of leDragAndDrop.listeners) {\n    element.removeEventListener(type, listener as EventListener)\n  }\n  // fin de suppression des listeners\n  const numeroExercice = exercice.numeroExercice\n  const objetReponses = exercice.autoCorrection[question].reponse?.valeur\n  let nbBonnesReponses = 0\n  let etiquettesAbsentes = 0\n  let etiquettesMalPlacees = 0\n  let etiquettesBienPlacees = 0\n  if (objetReponses) {\n    const bareme = objetReponses.bareme ?? toutPourUnPoint\n\n    const variables = Object.entries(objetReponses).filter(\n      ([key]) => key !== 'callback' && key !== 'bareme' && key !== 'feedback',\n    )\n\n    let nbReponses = objetReponses != null ? variables.length : 0\n    const rectangles = get(\n      `rectanglesEx${exercice.numeroExercice}Q${question}`,\n      false,\n    )\n    if (!rectangles) {\n      window.notify(\n        'Un problme avec verifDragAndDrop, je ne trouve pas la zone de drop !',\n        {},\n      )\n      return {\n        isOk: false,\n        feedback: 'Un problme est survenu',\n        score: { nbBonnesReponses, nbReponses },\n      }\n    }\n    if (objetReponses == null) {\n      window.notify(\n        \"Un problme avec verifDragAndDrop, il n'y a pas de rponses de dfinies !\",\n        {},\n      )\n      return {\n        isOk: false,\n        feedback: 'Un problme est survenu',\n        score: { nbBonnesReponses, nbReponses },\n      }\n    }\n    const reponses = Object.entries(objetReponses)\n    const points: number[] = []\n\n    if (!exercice.answers) exercice.answers = {}\n    for (let k = 1; k <= nbReponses; k++) {\n      const rectangle = get(\n        `rectangleEx${numeroExercice}Q${question}R${k}`,\n        false,\n      )\n      if (rectangle) {\n        const goodAnswer = reponses.find(([key]) => key === `rectangle${k}`)\n        const etiquettesDedans =\n          rectangle.querySelectorAll<HTMLElement>('.etiquette')\n        if (goodAnswer && !goodAnswer[1]?.options?.multi) {\n          // Ici, il ne doit y avoir qu'une seule tiquette dans le rectangle\n          etiquettesMalPlacees += etiquettesDedans.length - 1\n          const etiquetteDedans = etiquettesDedans[0]\n          const id =\n            etiquetteDedans?.id ?? `etiquetteEx${numeroExercice}Q${question}I0`\n          const etiquetteId = id.split('-')[0].split('I')[1] // on dbarasse du nom du clone et de ce qui est avant I pour rcuprer juste l'Id\n          exercice.answers = Object.assign(\n            exercice.answers,\n            Object.fromEntries([\n              [`rectangleDNDEx${numeroExercice}Q${question}R${k}`, id],\n            ]),\n          )\n          if (!etiquetteDedans) {\n            // Faut peut-tre pas compter faux si l'absence d'tiquette est normal, mais faut voir comment on fait\n            // si le rectangle peut rester vide, il faut que goodAnswer[1].value soit ''\n            if (\n              goodAnswer &&\n              goodAnswer[1] != null &&\n              goodAnswer[1].value.length === 0\n            ) {\n              nbBonnesReponses++\n              points.push(1)\n            } else {\n              rectangle.classList.add('bg-coopmaths-action-200')\n              points.push(0)\n              etiquettesAbsentes++\n            }\n          } else if (\n            goodAnswer &&\n            goodAnswer[1] != null &&\n            etiquetteId === goodAnswer[1].value &&\n            etiquettesMalPlacees === 0\n          ) {\n            etiquetteDedans?.classList.remove('bg-gray-200')\n            etiquetteDedans.classList.add('bg-coopmaths-warn-100')\n            nbBonnesReponses++\n            points.push(1)\n          } else {\n            if (\n              goodAnswer &&\n              goodAnswer[1] != null &&\n              etiquetteId === goodAnswer[1].value\n            ) {\n              etiquetteDedans?.classList.remove('bg-gray-200')\n              etiquetteDedans.classList.add('bg-coopmaths-warn-100')\n              for (let z = 1; z < etiquettesDedans.length; z++) {\n                etiquettesDedans[z].classList.remove('bg-gray-200')\n                etiquettesDedans[z].classList.add('bg-coopmaths-action-200')\n              }\n            } else {\n              etiquetteDedans?.classList.remove('bg-gray-200')\n              etiquetteDedans.classList.add('bg-coopmaths-action-200')\n            }\n            points.push(0)\n          }\n        } else {\n          // Ici, il y a plus d'une tiquette dans le rectangle ! l'option multi est true\n          const etiquettesIds = []\n          const etiquettesTxts = []\n          for (const etiquette of etiquettesDedans) {\n            const id = etiquette.id\n            // const etiquetteId = id.split('-')[0].split('I')[1] // on dbarasse du nom du clone et de ce qui est avant I pour rcuprer juste l'Id\n            etiquettesIds.push(id) // On doit mettre l'id complte pour mathaleaWriteStudentPreviousAnswers()... qui devra grer le clonage  son tour\n            etiquettesTxts.push(etiquette.innerText.replace('\\nx', ''))\n          }\n          exercice.answers = Object.assign(\n            exercice.answers,\n            Object.fromEntries([\n              [\n                `rectangleDNDEx${numeroExercice}Q${question}R${k}`,\n                etiquettesIds.join(';'),\n              ],\n              [\n                `texteDNDEx${numeroExercice}Q${question}R${k}`,\n                etiquettesTxts.join(' '),\n              ],\n            ]),\n          )\n          const goodAnswer = reponses.find(([key]) => key === `rectangle${k}`)\n          if (etiquettesDedans.length === 0) {\n            // Faut peut-tre pas compter faux si l'absence d'tiquette est normal, mais faut voir comment on fait\n            // si le rectangle peut rester vide, il faut que goodAnswer[1].value soit ''\n            if (\n              goodAnswer &&\n              goodAnswer[1] != null &&\n              goodAnswer[1].value.length === 0\n            ) {\n              nbBonnesReponses++\n              points.push(1)\n            } else {\n              rectangle.classList.add('bg-coopmaths-action-200')\n              points.push(0)\n              etiquettesAbsentes++\n            }\n          } else {\n            if (goodAnswer && goodAnswer[1] != null) {\n              let isOk: boolean = true\n              const value = Array.isArray(goodAnswer[1].value)\n                ? goodAnswer[1].value\n                : [goodAnswer[1].value]\n              for (const val of value) {\n                isOk = true\n                etiquettesBienPlacees = 0 // on reinitialise car plusieurs rponses possibles, malheureusement on garde la dernire\n                etiquettesMalPlacees = 0 // on reinitialise car plusieurs rponses possibles, malheureusement on garde la dernire\n                const listeOfIds: string[] = val.split('|')\n                const ordered = goodAnswer[1].options.ordered ?? false\n                if (listeOfIds.length !== etiquettesDedans.length) {\n                  isOk = false\n                }\n                if (ordered) {\n                  for (\n                    let j = 0;\n                    j < listeOfIds.length && j < etiquettesDedans.length;\n                    j++\n                  ) {\n                    // compare mme si pas mme longueur\n                    const etiquette = etiquettesDedans[j]\n                    const id = listeOfIds[j]\n                    if (id === etiquette.id.split('I').pop()?.split('-')[0]) {\n                      etiquette.classList.add('bg-coopmaths-warn-100')\n                      etiquettesBienPlacees++\n                    } else {\n                      etiquette.classList.add('bg-coopmaths-action-200')\n                      etiquettesMalPlacees++\n                      isOk = false\n                    }\n                  }\n                  etiquettesAbsentes =\n                    listeOfIds.length -\n                    listeOfIds.filter((el: string) =>\n                      Array.from(etiquettesDedans).find(\n                        (etiquette) =>\n                          el === etiquette.id.split('I').pop()?.split('-')[0],\n                      ),\n                    ).length\n                  if (etiquettesAbsentes < 0) etiquettesAbsentes = 0\n                  if (isOk === true) break\n                } else {\n                  // @todo non ordered\n                  for (const etiquette of etiquettesDedans) {\n                    const id = etiquette.id.split('I')[1].split('-')[0]\n                    if (listeOfIds.includes(id)) {\n                      etiquette.classList.add('bg-coopmaths-warn-100')\n                    } else {\n                      etiquette.classList.add('bg-coopmaths-action-200')\n                      isOk = false\n                    }\n                  }\n                  etiquettesAbsentes =\n                    listeOfIds.length -\n                    listeOfIds.filter((el: string) =>\n                      Array.from(etiquettesDedans).find(\n                        (etiquette) =>\n                          el === etiquette.id.split('I').pop()?.split('-')[0],\n                      ),\n                    ).length\n                  if (isOk === true && etiquettesAbsentes === 0) break\n                }\n              }\n              if (isOk) {\n                nbBonnesReponses++\n                points.push(1)\n              } else {\n                points.push(0)\n              }\n            }\n          }\n        }\n      }\n    }\n    // gestion du feedback\n    const spanReponseLigne = document.querySelector(\n      `#resultatCheckEx${numeroExercice}Q${question}`,\n    )\n\n    let typeFeedback = 'positive'\n    let resultat: string\n    if (nbBonnesReponses === nbReponses) {\n      if (spanReponseLigne) {\n        spanReponseLigne.innerHTML = ''\n      }\n      resultat = 'OK'\n    } else {\n      if (spanReponseLigne) spanReponseLigne.innerHTML = ''\n      typeFeedback = 'error'\n      resultat = 'KO'\n    }\n    // Gestion du feedback global de la question\n    if (spanReponseLigne) {\n      ;(spanReponseLigne as HTMLSpanElement).style.fontSize = 'large'\n    }\n    const eltFeedback = get(`feedbackEx${numeroExercice}Q${question}`, false)\n    let message = ''\n    if (eltFeedback) {\n      eltFeedback.innerHTML = ''\n    }\n    if (resultat === 'KO') {\n      // Juste mais incomplet\n      if (nbBonnesReponses > 0) {\n        message = `${nbBonnesReponses} bonne${nbBonnesReponses > 1 ? 's' : ''} rponse${nbBonnesReponses > 1 ? 's' : ''}`\n      }\n      if (etiquettesBienPlacees > 0) {\n        message += ` ${etiquettesBienPlacees} rponse${etiquettesBienPlacees > 1 ? 's' : ''} bien place${etiquettesBienPlacees > 1 ? 's' : ''}`\n      }\n      if (etiquettesAbsentes > 0) {\n        message += ` ${etiquettesAbsentes} rponse${etiquettesAbsentes > 1 ? 's' : ''} manquante${etiquettesAbsentes > 1 ? 's' : ''}`\n      }\n      if (etiquettesMalPlacees > 0) {\n        message += ` ${etiquettesMalPlacees} rponse${etiquettesMalPlacees > 1 ? 's' : ''} mal place${etiquettesMalPlacees > 1 ? 's' : ''}`\n      }\n      messageFeedback({\n        id: `feedbackEx${numeroExercice}Q${question}`,\n        message,\n        type: typeFeedback,\n      })\n    } else {\n      message = ''\n    }\n\n    ;[nbBonnesReponses, nbReponses] = bareme(points)\n\n    return {\n      isOk: nbBonnesReponses === nbReponses,\n      feedback: '',\n      score: { nbBonnesReponses, nbReponses },\n    }\n  }\n  window.notify(\n    \"VerifDragAndDrop a un problme : il n'y a pas d'objet rponse fourni\",\n    {},\n  )\n  return {\n    isOk: false,\n    feedback: 'Un problme est survenu',\n    score: { nbBonnesReponses: 0, nbReponses: 0 },\n  }\n}\n\nclass DragAndDrop {\n  exercice: IExercice\n  question: number\n  consigne: string\n  etiquettes: Etiquette[][]\n  enonceATrous: string\n  listeners: [Element, string, DragHandler | TouchHandler][]\n  constructor({\n    exercice,\n    question,\n    consigne,\n    etiquettes,\n    enonceATrous,\n  }: {\n    exercice: IExercice\n    question: number\n    consigne: string\n    etiquettes: Etiquette[][]\n    enonceATrous: string\n  }) {\n    this.exercice = exercice\n    this.question = question\n    this.consigne = consigne\n    this.etiquettes = etiquettes\n    this.enonceATrous = enonceATrous\n    this.listeners = []\n  }\n\n  /** Une mthode pour ajouter un contenu interactif de type Drag and drop\n   *  enonceATrous est une chaine de caractres avec le format suivant: 'blabla..%{rectangle1}blabla%{rectangle2}blibli...'\n   *  Les diffrents % { rectanglen } sont remplacs par des div rectangulaires pouvant accueillir les tiquettes.\n   * @param param0\n   * @returns\n   */\n  ajouteDragAndDrop({\n    melange = false,\n    duplicable = false,\n  }: {\n    melange: boolean\n    duplicable: boolean\n  }) {\n    const numeroExercice = this.exercice.numeroExercice\n    if (context.isHtml) {\n      let html = ''\n      const rule = '<hr width=\"100%\" height=\"0px\" />'\n      html += `<div class=\"questionDND\" id=\"divDragAndDropEx${numeroExercice}Q${this.question}\">\\n\\t`\n      html += `<div class=\"consigneDND\">${this.consigne}</div>\\n\\t`\n      html += `<div  class=\"etiquettes\" id=\"etiquettesEx${numeroExercice}Q${this.question}\">\\n\\t` // voir si on laisse la bordure : ${this.exercice.interactif ? 'style=\"border: 1px dashed #AAA\" ' : ''}\n      for (const etiquetteRaw of this.etiquettes) {\n        const etiquettesEnDesordreOuPas = melange\n          ? shuffle(etiquetteRaw.slice())\n          : etiquetteRaw.slice()\n        for (const etiquette of etiquettesEnDesordreOuPas) {\n          html += `<div class=\"etiquette${this.exercice.interactif ? ' dragOk' : ' noDrag'}${duplicable ? ' duplicable' : ''}${this.exercice.interactif ? ' bg-gray-200' : ''}\" draggable=\"${this.exercice.interactif ? 'true' : 'false'}\" id=\"etiquetteEx${numeroExercice}Q${this.question}I${etiquette.id}\">${etiquette.contenu}</div>\\n\\t`\n        }\n\n        html += rule\n      }\n      html = html.substring(0, html.length - rule.length)\n      html += '</div>'\n\n      html += `<div class=\"rectangles\" id=\"rectanglesEx${numeroExercice}Q${this.question}\" >\\n\\t`\n      let resteEnonce = this.enonceATrous\n      let htmlEnonce = ''\n      while (resteEnonce) {\n        const chunks = /^(.*?)%\\{([^}]+)}(.*?)$/.exec(resteEnonce)\n        if (chunks) {\n          const [, start, n, end] = chunks\n          const name = n\n          if (name == null) throw Error(`Dfinition de ${name} manquante`)\n          htmlEnonce += `<span>${start}</span>`\n          if (this.exercice.interactif) {\n            htmlEnonce += `<div class=\"rectangleDND\" id=\"rectangleEx${numeroExercice}Q${this.question}R${name.substring(9)}\"></div>`\n          } else {\n            htmlEnonce +=\n              '<hr style=\"height: 30px; width: 60px; border: 1px dashed #555;\">'\n          }\n          resteEnonce = end ?? ''\n        } else {\n          htmlEnonce += resteEnonce\n          resteEnonce = ''\n        }\n      }\n      html += htmlEnonce\n      html += `<span id=\"resultatCheckEx${numeroExercice}Q${this.question}\"></span></div>`\n      if (this.exercice.interactif) {\n        // ajoutons le div#feedback\n        html += `<div class=\"ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest\" id=\"feedbackEx${numeroExercice}Q${this.question}\"></div>`\n        // Il faut mettre en place les listeners !\n        document.addEventListener('exercicesAffiches', () => {\n          const divEtiquettes = get(\n            `etiquettesEx${numeroExercice}Q${this.question}`,\n            false,\n          )\n          if (divEtiquettes) {\n            divEtiquettes.addEventListener('drop', dropHandler)\n            divEtiquettes.addEventListener('dragover', dragOverHandler)\n            divEtiquettes.addEventListener('touchmove', touchMoveHandler, {\n              capture: true,\n            })\n            divEtiquettes.addEventListener('touchend', touchEndHandler)\n            this.listeners.push(\n              [divEtiquettes, 'drop', dropHandler],\n              [divEtiquettes, 'dragover', dragOverHandler],\n              [divEtiquettes, 'touchmove', touchMoveHandler],\n              [divEtiquettes, 'touchend', touchEndHandler],\n            )\n            for (const etiquette of divEtiquettes.querySelectorAll(\n              '.etiquette',\n            )) {\n              ;(etiquette as HTMLDivElement).addEventListener(\n                'dragstart',\n                dragStartHandler,\n              )\n              ;(etiquette as HTMLDivElement).addEventListener(\n                'dragend',\n                dragEndHandler,\n              )\n              ;(etiquette as HTMLDivElement).addEventListener(\n                'touchstart',\n                touchStartHandler,\n                { capture: false },\n              )\n              this.listeners.push(\n                [etiquette, 'dragstart', dragStartHandler],\n                [etiquette, 'touchstart', touchStartHandler],\n                [etiquette, 'dragend', dragEndHandler],\n              )\n            }\n          }\n\n          const rectangles = get(\n            `rectanglesEx${numeroExercice}Q${this.question}`,\n            false,\n          )\n          if (rectangles) {\n            for (const rectangle of rectangles.querySelectorAll(\n              '.rectangleDND',\n            )) {\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'dragover',\n                dragOverHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'drop',\n                dropHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'touchmove',\n                touchMoveHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'touchend',\n                touchEndHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'dragenter',\n                dragEnterHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'dragleave',\n                dragLeaveHandler,\n              )\n              this.listeners.push(\n                [rectangle, 'dragover', dragOverHandler],\n                [rectangle, 'drop', dropHandler],\n                [rectangle, 'touchmove', touchMoveHandler],\n                [rectangle, 'touchend', touchEndHandler],\n                [rectangle, 'dragenter', dragEnterHandler],\n                [rectangle, 'dragleave', dragLeaveHandler],\n              )\n            }\n          }\n        })\n      } else {\n        const divEtiquettes = get(\n          `etiquettesEx${numeroExercice}Q${this.question}`,\n          false,\n        )\n        if (divEtiquettes) {\n          for (const etiquette of divEtiquettes.querySelectorAll(\n            '.etiquette',\n          )) {\n            etiquette.classList.add('noDrag')\n          }\n        }\n      }\n      return html\n    }\n    const latex = ''\n    return latex\n  }\n}\n\nexport default DragAndDrop\n","import type { IExercice, UneProposition } from '../../lib/types'\nimport { lettreDepuisChiffre } from '../outils/outilString'\n\nexport function shuffleJusquaWithIndexes(array: unknown[], lastChoice: number) {\n  // Crer une copie du tableau d'entre\n  const newArray = array.map((item) => JSON.parse(JSON.stringify(item)))\n  const indexes = Array.from({ length: array.length }, (_, i) => i)\n\n  // Mlanger les lments jusqu' l'index lastChoice\n  for (let i = lastChoice; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    ;[newArray[i], newArray[j]] = [newArray[j], newArray[i]]\n    ;[indexes[i], indexes[j]] = [indexes[j], indexes[i]]\n  }\n\n  // Retourner le tableau mlang et les index\n  return { shuffledArray: newArray, indexes }\n}\n\nexport function qcmCamExport(\n  exercice: IExercice,\n): { question: string; reponse: string }[] {\n  const questions: { question: string; reponse: string }[] = []\n  if (exercice.autoCorrection.length !== exercice.listeQuestions.length)\n    return []\n  for (let j = 0; j < exercice.autoCorrection.length; j++) {\n    const propositions = exercice.autoCorrection[j].propositions\n    if (propositions == null) continue\n    if (propositions.length > 4) continue\n    const laConsigne =\n      exercice.consigne.replaceAll(\n        /\\$([^$]*)\\$/g,\n        '<span class=\"math-tex\">$1</span>',\n      ) ?? ''\n    const introduction =\n      exercice.introduction.replaceAll(\n        /\\$([^$]*)\\$/g,\n        '<span class=\"math-tex\">$1</span>',\n      ) ?? ''\n    const laQuestion = exercice.listeQuestions[j]\n    const enonceBis = laQuestion\n      .split('<div class=\"my-3\">')[0]\n      .replaceAll(/\\$([^$]*)\\$/g, '<span class=\"math-tex\">$1</span>')\n    let enonce: string\n    if (\n      exercice.autoCorrection[j].enonce != null &&\n      exercice.autoCorrection[j].enonce !== ''\n    ) {\n      enonce = `${j === 0 || !laConsigne.startsWith('Parmi les') ? laConsigne : ''}${\n        j === 0 && laConsigne !== '' ? '<br>' : ''\n      }\n        ${introduction != null ? introduction : ''}\n          ${introduction != null && introduction !== '' ? '<br>' : ''}\n            ${\n              exercice.autoCorrection[j].enonce != null\n                ? exercice.autoCorrection[j].enonce\n                    ?.replaceAll(/&nbsp;/g, ' ')\n                    .replaceAll(\n                      /\\$([^$]*)\\$/g,\n                      '<span class=\"math-tex\">$1</span>',\n                    )\n                : ''\n            }`\n    } else {\n      enonce = `${j === 0 ? laConsigne : ''}${\n        j === 0 && laConsigne !== '' ? '<br>' : ''\n      }\n       ${introduction != null ? introduction : ''}\n         ${introduction != null && introduction !== '' ? '<br>' : ''}\n           ${enonceBis.replaceAll(/&nbsp;/g, ' ')}`\n    }\n\n    const props = propositions.map((prop: UneProposition) => prop.texte)\n    const statuts = propositions.map((prop: UneProposition) => prop.statut)\n    let question = `<h3 data-translate=\"{&quot;html&quot;:&quot;questions.defaultquestion&quot;}\">${enonce?.replaceAll(/\\$([^$]*)\\$/g, '<span class=\"math-tex\">$1</span>')}</h3><ol>`\n    let reponse = ''\n    for (let i = 0; i < props.length; i++) {\n      const proposition = props[i]\n      if (proposition == null) continue\n      const prop = proposition.replaceAll(\n        /\\$([^$]*)\\$/g,\n        '<span class=\"math-tex\">$1</span>',\n      )\n      const bonneReponse = statuts[i]\n      question += `<li${bonneReponse ? ' class=\"rondvert\"' : ''}>${prop}</li>`\n      if (bonneReponse) reponse = lettreDepuisChiffre(i + 1)\n    }\n    question += '</ol>'\n    questions.push({ question, reponse })\n  }\n  return questions\n}\n\nexport function qcmCamExportAll(exercices: IExercice[]): string {\n  const questionnaire = []\n  const listExercices = exercices.slice() // exercices.filter(exo => exo.interactifType === 'qcm')\n  let index = 0\n  for (const exo of listExercices) {\n    const materiel = qcmCamExport(exo)\n    for (const { question, reponse } of materiel) {\n      questionnaire.push([String(index++), { question, reponse }])\n    }\n  }\n  const questions = questionnaire.map(\n    ([index, exo]) => `\"${index}\":${JSON.stringify(exo)}`,\n  )\n  const leJson = `{${questions.join(',')}}`\n  return leJson\n}\n","import type { IExercice, UneProposition } from '../../lib/types'\nimport { context } from '../../modules/context'\nimport { messageFeedback } from '../../modules/messages'\nimport { shuffleJusquaWithIndexes } from '../amc/qcmCam'\nimport { get } from '../html/dom'\nimport {\n  barreTexte,\n  miseEnEvidence,\n  texteEnCouleurEtGras,\n  texteGras,\n} from '../outils/embellissements'\nimport { lettreDepuisChiffre } from '../outils/outilString'\nimport type { ButtonWithMathaleaListener } from '../types/can'\nimport { afficheScore } from './afficheScore'\n\nexport function verifQuestionQcm(exercice: IExercice, i: number) {\n  let resultat\n  // i est l'indice de la question\n  let nbBonnesReponses = 0\n  let nbMauvaisesReponses = 0\n  let nbBonnesReponsesAttendues = 0\n  if (exercice.answers == null) {\n    exercice.answers = {}\n  }\n  // Compte le nombre de rponses justes attendues\n  const nbReps = exercice.autoCorrection[i].propositions?.length ?? 0\n  for (let k = 0; k < nbReps; k++) {\n    if (exercice.autoCorrection[i]!.propositions![k].statut) {\n      nbBonnesReponsesAttendues++\n    }\n  }\n  const divReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  ) as HTMLDivElement\n  exercice.autoCorrection[i]!.propositions!.forEach((proposition, indice) => {\n    // La liste de question peut tre plus courte que autoCorrection si on n'a pas russi  gnrer suffisamment de questions diffrentes\n    // if (exercice.listeQuestions[i] !== undefined) {\n    // On a des exercices comme 6S10-1 o il y a 2 questions... mais 6 qcm !\n    const label = document.querySelector(\n      `#labelEx${exercice.numeroExercice}Q${i}R${indice}`,\n    ) as HTMLLabelElement\n    const check = document.querySelector(\n      `#checkEx${exercice.numeroExercice}Q${i}R${indice}`,\n    ) as HTMLInputElement\n    if (check != null) {\n      if (check.checked) {\n        // Sauvegarde pour les exports Moodle, Capytale...\n        exercice.answers![`Ex${exercice.numeroExercice}Q${i}R${indice}`] = '1'\n        // Gestion du feedback de toutes les cases coches\n        if (exercice.autoCorrection[i].propositions![indice].feedback) {\n          messageFeedback({\n            id: `feedbackEx${exercice.numeroExercice}Q${i}R${indice}`,\n            message: exercice.autoCorrection[i].propositions![indice].feedback,\n            type: proposition.statut ? 'positive' : 'error',\n          })\n        }\n      } else {\n        exercice.answers![`Ex${exercice.numeroExercice}Q${i}R${indice}`] = '0'\n      }\n      if (proposition.statut) {\n        if (check.checked === true) {\n          nbBonnesReponses++\n          label.classList.add('bg-coopmaths-warn-100', 'rounded-lg', 'p-1')\n        } else {\n          // Bonnes rponses non coches\n          label.classList.add('bg-coopmaths-warn-100', 'rounded-lg', 'p-1')\n        }\n      } else if (check.checked === true) {\n        label.classList.add('bg-coopmaths-action-200', 'rounded-lg', 'p-1')\n        nbMauvaisesReponses++\n      }\n      check.disabled = true\n    }\n  })\n  let typeFeedback = 'positive'\n  if (\n    nbMauvaisesReponses === 0 &&\n    nbBonnesReponses === nbBonnesReponsesAttendues\n  ) {\n    if (divReponseLigne) divReponseLigne.innerHTML = ''\n    resultat = 'OK'\n  } else {\n    if (divReponseLigne) divReponseLigne.innerHTML = ''\n    typeFeedback = 'error'\n    resultat = 'KO'\n  }\n  // Gestion du feedback global de la question\n  if (divReponseLigne) divReponseLigne.style.fontSize = 'large'\n  const eltFeedback = get(`feedbackEx${exercice.numeroExercice}Q${i}`, false)\n  let message = ''\n  if (eltFeedback) {\n    eltFeedback.innerHTML = ''\n  }\n  if (resultat === 'KO') {\n    // Juste mais incomplet\n    if (\n      nbBonnesReponses > 0 &&\n      nbMauvaisesReponses === 0 &&\n      nbBonnesReponses < nbBonnesReponsesAttendues\n    ) {\n      message = `${nbBonnesReponses} bonne${nbBonnesReponses > 1 ? 's' : ''} rponse${nbBonnesReponses > 1 ? 's' : ''}`\n    } else if (nbBonnesReponses > 0 && nbMauvaisesReponses > 0) {\n      // Du juste et du faux\n      message = `${nbMauvaisesReponses} erreur${nbMauvaisesReponses > 1 ? 's' : ''}`\n    } else if (nbBonnesReponses === 0 && nbMauvaisesReponses > 0) {\n      // Que du faux\n      message = `${nbMauvaisesReponses} erreur${nbMauvaisesReponses > 1 ? 's' : ''}`\n    }\n  } else {\n    message = ''\n  }\n  if (nbBonnesReponsesAttendues > nbBonnesReponses) {\n    message += ` ${nbBonnesReponsesAttendues - nbBonnesReponses} bonne${nbBonnesReponsesAttendues - nbBonnesReponses > 1 ? 's' : ''} rponse${nbBonnesReponsesAttendues - nbBonnesReponses > 1 ? 's' : ''} manquante${nbBonnesReponsesAttendues - nbBonnesReponses > 1 ? 's' : ''}`\n  }\n  if (message !== '') {\n    messageFeedback({\n      id: `resultatCheckEx${exercice.numeroExercice}Q${i}`,\n      message,\n      type: typeFeedback,\n    })\n  }\n  return resultat\n}\n\n/**\n * @param {exercice}\n * @param {number} i indice de la question\n * @param {{style: string, format: string}} [options]\n * @returns {{texte: string, texteCorr: string}} {texte, texteCorr} le texte  ajouter pour la question traite\n */\nexport function propositionsQcm(\n  exercice: IExercice,\n  i: number,\n  options: { style: string; format: string } = { style: '', format: 'case' },\n) {\n  /**\n   * Mlange les lments d'un tableau jusqu' un certain index et laisse les suivants inchangs.\n   * @param {Array} array - Le tableau  mlanger.\n   * @param {number} lastChoice - L'index jusqu'auquel mlanger les lments.\n   * @returns {{shuffledArray: Array, indexes: Array}} - Le tableau mlang et les index des anciens lments dans le nouvel ordre.\n   */\n  const indexes = []\n  let texte = ''\n  let texteCorr = ''\n  let espace = ''\n  let nbCols = 1\n  let vertical = false\n  const classCss =\n    options?.style != null && options.style !== ''\n      ? `class=\"ml-2\" style=\"${options.style};\" `\n      : 'class=\"ml-2\"'\n  if (context.isAmc) return { texte: '', texteCorr: '' }\n  if (exercice?.autoCorrection[i]?.propositions === undefined) {\n    window.notify(\n      'propositionsQcm a reu une liste de propositions undefined',\n      {\n        autoCrorrection: exercice?.autoCorrection[i],\n        propositions: exercice?.autoCorrection[i].propositions,\n        exercise: exercice,\n      },\n    )\n    return { texte: '', texteCorr: '' }\n  } else if (exercice.autoCorrection[i].propositions.length === 0) {\n    window.notify('propositionsQcm a reu une liste de propositions vide', {\n      autoCrorrection: exercice.autoCorrection[i],\n      propositions: exercice.autoCorrection[i].propositions,\n      exercise: exercice,\n    })\n    return { texte: '', texteCorr: '' }\n  } else if (exercice.autoCorrection[i].propositions.length === 1) {\n    window.notify(\n      'propositionsQcm a reu une liste de propositions de taille 1',\n      {\n        autoCrorrection: exercice.autoCorrection[i],\n        propositions: exercice.autoCorrection[i].propositions,\n        exercise: exercice,\n      },\n    )\n    return { texte: '', texteCorr: '' }\n  }\n\n  // On regarde si il n'y a pas de doublons dans les propositions de rponse. Si c'est le cas, on enlve les mauvaises rponses en double.\n  elimineDoublons(exercice.autoCorrection[i].propositions)\n  if (context.isHtml) {\n    espace = '&emsp;'\n    if (exercice?.autoCorrection[i].reponse == null) {\n      exercice.autoCorrection[i].reponse = {}\n    }\n    if (exercice.autoCorrection[i].reponse.param == null) {\n      exercice.autoCorrection[i].reponse.param = {}\n    }\n    exercice.autoCorrection[i].reponse.param.formatInteractif = 'qcm'\n  } else {\n    espace = '\\\\qquad '\n  }\n  // Mlange les propositions du QCM sauf celles  partir de lastchoice (inclus)\n  const lastChoice = Math.min(\n    exercice.autoCorrection[i].options?.lastChoice ??\n      exercice.autoCorrection[i].propositions.length,\n    exercice.autoCorrection[i].propositions.length - 1,\n  )\n  vertical = exercice.autoCorrection[i].options?.vertical ?? false // est-ce qu'on veut une prsentation en colonnes ?\n  nbCols = Math.min(exercice.autoCorrection[i].options?.nbCols ?? 1, 1)\n  const isTrueFalse =\n    exercice.autoCorrection[i].propositions.some(\n      (prop) => prop.texte === 'Vrai',\n    ) &&\n    exercice.autoCorrection[i].propositions.some(\n      (prop) => prop.texte === 'Faux',\n    )\n  if (isTrueFalse) {\n    // Si on a les rponses Vrai et Faux, on les met en premier\n    const vrai = exercice.autoCorrection[i].propositions.findIndex(\n      (prop) => prop.texte === 'Vrai',\n    )\n    const faux = exercice.autoCorrection[i].propositions.findIndex(\n      (prop) => prop.texte === 'Faux',\n    )\n    if (vrai !== -1 && faux !== -1) {\n      // On les met en premier\n      const vraiProp = exercice.autoCorrection[i].propositions[vrai]\n      const fauxProp = exercice.autoCorrection[i].propositions[faux]\n      exercice.autoCorrection[i].propositions.splice(vrai, 1)\n      exercice.autoCorrection[i].propositions.splice(faux - 1, 1)\n      exercice.autoCorrection[i].propositions.unshift(fauxProp)\n      exercice.autoCorrection[i].propositions.unshift(vraiProp)\n    }\n  }\n  if (!exercice.autoCorrection[i].options?.ordered && !isTrueFalse) {\n    const melange = shuffleJusquaWithIndexes(\n      exercice.autoCorrection[i].propositions,\n      lastChoice,\n    )\n    exercice.autoCorrection[i].propositions = melange.shuffledArray\n    indexes.push(...melange.indexes)\n  }\n  if (!context.isHtml) {\n    const formateQ = (format: string, rep: number) => {\n      if (format == null || format === 'case') return '$\\\\square\\\\;$'\n      if (format === 'lettre') {\n        return `${texteGras(lettreDepuisChiffre(rep + 1))}.`\n      }\n      return `${texteGras(lettreDepuisChiffre(rep + 1))}$\\\\square\\\\;$`\n    }\n    const formateRV = (format: string, rep: number) => {\n      if (format == null || format === 'case') return '$\\\\blacksquare\\\\;$'\n      if (format === 'lettre') {\n        return `${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}.`\n      }\n      return `${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}$\\\\blacksquare\\\\;$`\n    }\n    const formateRF = (format: string, rep: number) => {\n      if (format == null || format === 'case') return '$\\\\square\\\\;$'\n      if (format === 'lettre') {\n        return `$${miseEnEvidence(`\\\\cancel{\\\\text{${lettreDepuisChiffre(rep + 1)}}}`, 'black')}$.`\n      }\n      return `$${miseEnEvidence(`\\\\cancel{\\\\text{${lettreDepuisChiffre(rep + 1)}}}`, 'black')}\\\\square\\\\;$`\n    }\n    texte += nbCols === 1 ? '\\t' : `\\n\\n\\\\begin{multicols}{${nbCols}}\\n\\t`\n    texteCorr += nbCols === 1 ? '\\t' : `\\n\\n\\\\begin{multicols}{${nbCols}}\\n\\t`\n    for (\n      let rep = 0;\n      rep < exercice.autoCorrection[i].propositions.length;\n      rep++\n    ) {\n      texte += `${formateQ(options?.format, rep)} ${exercice.autoCorrection[i].propositions[rep].texte}`\n      if (exercice.autoCorrection[i].propositions[rep].statut) {\n        texteCorr += `${formateRV(options?.format, rep)} ${exercice.autoCorrection[i].propositions[rep].texte}`\n      } else {\n        texteCorr += `${formateRF(options?.format, rep)} ${exercice.autoCorrection[i].propositions[rep].texte}`\n      }\n      if (vertical) {\n        texte += '\\\\\\\\\\n\\t'\n        texteCorr += '\\\\\\\\\\n\\t'\n      } else {\n        texte += '\\\\qquad '\n        texteCorr += '\\\\qquad '\n      }\n    }\n    texte += nbCols === 1 ? '' : '\\\\end{multicols}'\n    texteCorr += nbCols === 1 ? '' : '\\\\end{multicols}'\n  }\n  if (context.isHtml) {\n    const isRadio = exercice.autoCorrection[i].options?.radio ?? false\n    const formateQ = (format: string, rep: number) => {\n      if (format == null || format === 'case') {\n        return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" id=\"checkEx${exercice.numeroExercice}Q${i}R${rep}\">`\n      }\n      if (format === 'lettre') {\n        return `<label ${classCss} >${texteGras(lettreDepuisChiffre(rep + 1))}.</label>`\n      }\n      return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" id=\"checkEx${exercice.numeroExercice}Q${i}R${rep}\"><label ${classCss} >${lettreDepuisChiffre(rep + 1)}.</label>`\n    }\n    const formateRV = (format: string, rep: number) => {\n      if (format == null || format === 'case') {\n        return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" checked>`\n      }\n      if (format === 'lettre') {\n        return `<label ${classCss} >${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}.</label>`\n      }\n      return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" checked><label ${classCss} >${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}.</label>`\n    }\n    const formateRF = (format: string, rep: number) => {\n      if (format == null || format === 'case') {\n        return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\">`\n      }\n      if (format === 'lettre') {\n        return `<label ${classCss} >${texteGras(`${barreTexte(lettreDepuisChiffre(rep + 1))}`)}.</label>`\n      }\n      return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\"><label ${classCss} >$${miseEnEvidence(`\\\\cancel{${lettreDepuisChiffre(rep + 1)}}`, 'black')}$.</label>`\n    }\n\n    texte = '<div class=\"my-3\">'\n    texteCorr = '<div class=\"my-3\">'\n    for (\n      let rep = 0;\n      rep < exercice.autoCorrection[i].propositions.length;\n      rep++\n    ) {\n      if (nbCols > 1 && rep % nbCols === 0) texte += '<br>'\n      texte += `<div class=\"ex${exercice.numeroExercice} ${vertical ? '' : 'inline-block'} my-2 align-center\">\n      ${formateQ(options?.format, rep)}\n      <label id=\"labelEx${exercice.numeroExercice}Q${i}R${rep}\" ${classCss} >${exercice.autoCorrection[i].propositions[rep].texte + espace}</label>\n      <div id=\"feedbackEx${exercice.numeroExercice}Q${i}R${rep}\" ${vertical ? '' : 'class=\"inline\"'}></div></div>`\n      texteCorr += `<div class=\"${vertical ? '' : 'inline-block'}\">\n    ${\n      exercice.autoCorrection[i].propositions[rep].statut\n        ? formateRV(options?.format, rep)\n        : formateRF(options?.format, rep)\n    }\n      <label id=\"labelEx${exercice.numeroExercice}Q${i}R${rep}\" ${classCss} >${exercice.autoCorrection[i].propositions[rep].texte + espace}</label>\n      </div>`\n    }\n    texte += `</div><div class=\"m-2\" id=\"resultatCheckEx${exercice.numeroExercice}Q${i}\"></div>`\n    texteCorr += '</div><div class=\"m-2\"></div>'\n  }\n  if (!context.isHtml) {\n    texte =\n      ` \n    \n    ` + texte\n    texteCorr =\n      ` \n    \n    ` + texteCorr\n  }\n  return { texte, texteCorr, indexes }\n}\n\n/**\n * Lorsque l'vnement 'exercicesAffiches' est lanc par mathalea.js\n * on vrifie la prsence du bouton de validation d'id btnValidationEx{i} cr par listeQuestionsToContenu\n * et on y ajoute un listenner pour vrifier les rponses coches\n * @param {object} exercice\n */\nexport function exerciceQcm(exercice: IExercice) {\n  document.addEventListener('exercicesAffiches', () => {\n    // On vrifie le type si jamais il a t chang aprs la cration du listenner (voir 5R20)\n    if (exercice.interactifType === 'qcm') {\n      const button = document.querySelector(\n        `#btnValidationEx${exercice.numeroExercice}-${exercice.id}`,\n      ) as ButtonWithMathaleaListener\n      if (button) {\n        if (!button.hasMathaleaListener) {\n          button.addEventListener('click', () => {\n            let nbQuestionsValidees = 0\n            let nbQuestionsNonValidees = 0\n            for (let i = 0; i < exercice.autoCorrection.length; i++) {\n              const resultat = verifQuestionQcm(exercice, i)\n              resultat === 'OK'\n                ? nbQuestionsValidees++\n                : nbQuestionsNonValidees++\n            }\n            const uichecks = document.querySelectorAll(\n              `.ui.checkbox.ex${exercice.numeroExercice}`,\n            )\n            for (const uicheck of uichecks) {\n              uicheck.classList.add('read-only')\n            }\n            button.classList.add('disabled')\n            afficheScore(exercice, nbQuestionsValidees, nbQuestionsNonValidees)\n          })\n          button.hasMathaleaListener = true\n        }\n      }\n    }\n  })\n}\n\n/**\n * prend un tableau de propositions [{texte: 'prop1', statut: true, feedback: 'Correct !'}, {texte: 'prop2', statut: false, ....}\n * limine en cas de doublon la proposition fausse ou la deuxime proposition si elle sont toutes les deux fausses.\n * @author Jean-Claude Lhote\n */\nexport function elimineDoublons(propositions: UneProposition[]) {\n  // fonction qui va liminer les doublons si il y en a\n  let doublonsTrouves = false\n  for (let i = 0; i < propositions.length - 1; i++) {\n    for (let j = i + 1; j < propositions.length; ) {\n      if (propositions[i].texte === propositions[j].texte) {\n        // les rponses i et j sont les mmes\n        doublonsTrouves = true\n        if (propositions[i].statut) {\n          // si la rponse i est bonne, on vire la j\n          propositions.splice(j, 1)\n        } else if (propositions[j].statut) {\n          // si la rponse i est mauvaise et la rponse j bonne,\n          // comme ce sont les mmes rponses, on vire la j mais on met la i bonne\n          propositions.splice(j, 1)\n          propositions[i].statut = true\n        } else {\n          // Les deux rponses sont mauvaises\n          propositions.splice(j, 1)\n        }\n      } else {\n        j++\n      }\n    }\n  }\n  return doublonsTrouves\n}\n","import { renderMathInElement } from 'mathlive'\n\ntype EventListener = (event?: Event) => void\ntype KeyboardEventListener = (event: KeyboardEvent) => void\n\ninterface CHoiceValue {\n  latex?: string\n  image?: string\n  label?: string\n  value: string\n  svg?: string\n}\n\n/**\n * Vide chaque Element (html ou svg) pass en paramtre de tout son contenu.\n * On peut passer autant de paramtres que l'on veut, les null|undefined seront ignors silencieusement\n * @param {...Element} elts\n */\nfunction empty(...elts: Element[]): void {\n  for (const elt of elts) {\n    if (elt == null) continue\n    while (elt?.lastChild != null) elt.removeChild(elt.lastChild)\n  }\n}\n\n// Trois types de choix : simple string, {label: string, value: string} ou {latex?: string, image?: string, text?: string, value: string}\n// C'est redondant : pour le type string, label et value prennent la valeur de la string, pour le type {label, value} c'est directement les valeurs utilises (parfois le label affich peut tre un peu long et on peut avoir envie de rsumer   un mot la value), pour le troisime latex permet de fournir du latex en math-inline sans dlimiteurs, image, c'est l'url d'une image (absolue ? ou relative au dossier courant donc src/lib/outils/listeDeroulante), text, c'est pareil que label, donc en fait, n'a pas beaucoup d'intrt, on peut fondre le deuxime dans le troisime...\n// On peut mixer les diffrentes formes :\n// choices: AllChoicesType = [{image: 'src/section/datasExemple/firefox.png', value: 'firefox'},\n//            {latex: '\\\\frac{\\\\sqrt{3}}{2}',value: 'sinusPiSur3'},\n//            {label: \"n'est pas dfinie en zro\", value: 'noF0'}\n//            'Je ne sais pas']\nexport type AllChoiceType = CHoiceValue\nexport type AllChoicesType = AllChoiceType[]\n\n// @todo faire voluer cette fonction vers un renderToString() directement dans le li lorsque mathlive sera en version 1.0 ou plus.\nfunction renderLatexToHTMLFragment(\n  li: HTMLLIElement | HTMLSpanElement,\n  latex: string,\n): void {\n  li.innerHTML = `$$${latex}$$`\n  renderMathInElement(li)\n  const spanToInvisible = li.querySelectorAll('span')\n  if (spanToInvisible.length > 2) {\n    spanToInvisible[2].style.display = 'none'\n  }\n}\n\n// Usage :\n\n/**\n * La fonction qui affiche l'un des choix, que ce soit du texte, du latex ou une image.\n * @param {HTMLLIElement} li l'lment de liste qui doit contenir le choix\n * @param {AllChoiceType} choice le choix en question\n */\nfunction afficheChoice(\n  li: HTMLLIElement | HTMLSpanElement,\n  choice: AllChoiceType | undefined,\n) {\n  // Les textes sont naturellement aligns avec li.textAlign, mais pas les images ou les math-field\n  if (choice == null) return\n  if (typeof choice === 'object') {\n    if ('latex' in choice) {\n      renderLatexToHTMLFragment(li, choice.latex ?? '')\n    } else if ('image' in choice) {\n      const image = document.createElement('img')\n      image.src = choice.image ?? choice.value\n      image.style.width = '30px'\n      image.style.height = '30px'\n      li.appendChild(image)\n    } else if ('label' in choice) {\n      const span = document.createElement('span')\n      span.innerHTML = choice.label ?? choice.value\n      li.appendChild(span)\n    } else if ('svg' in choice) {\n      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n      svg.setAttribute('viewBox', '-10 -10 20 20') // Valeur par dfaut, peut tre ajuste\n      svg.classList.add('svgChoice')\n      svg.style.display = 'block'\n      svg.style.width = '20px'\n      svg.style.height = '20px'\n      svg.style.verticalAlign = 'middle'\n      svg.innerHTML = choice.svg ?? ''\n      li.appendChild(svg)\n    }\n  } else {\n    throw Error(`Type de choix inconnu : ${choice}`)\n  }\n}\n\n/**\n * L'outil listeDeroulante cr un \"select\" like o on peut mettre dans chaque item du LaTex, une image, etc.\n * Il faut passer par ListeDeroulante.create() et pas new ListeDeroulante()\n * @class\n */\nclass ListeDeroulante {\n  disabled: boolean = false\n  choices: AllChoicesType // La liste des choix\n  givenChoices?: AllChoicesType // Je ne vois pas pourquoi on aurait a...\n  private _kbIndex: number = -1 // L'index du choix slectionn au clavier\n  changed: boolean = false // Passe  true ds qu'on a fait une slection (ou ds le dpart si le choix initial est slectionnable)\n  readonly _offset: number = 0 // Dcalage ventuel d'index entre le tableau de choix fourni et celui qu'on manipule (0 ou 1 suivant que le premier choix est slectionnable ou pas)\n  reponse: string = ''\n\n  private _elts: HTMLLIElement[] = [] // Liste des elts contenant les choix (les &lt;li&gt;)\n  private _clickListener?: EventListener\n  private _keydownListener?: KeyboardEventListener\n\n  container?: HTMLElement\n  spanSelected?: HTMLSpanElement\n  ulContainer?: HTMLUListElement\n  initialChoice?: AllChoiceType\n  width?: number\n\n  /**\n   * @constructor\n   * @param options\n   * @param choices\n   * @param options.choix0\n   */\n  constructor(\n    choices: AllChoicesType,\n    {\n      choix0,\n    }: {\n      choix0?: boolean\n    } = { choix0: false },\n  ) {\n    if (arguments.length > 2) throw Error('nombre darguments invalides')\n    if (!Array.isArray(choices))\n      throw Error('Il faut passer une liste de choix')\n    this.disabled = false // mettre  true pour dsactiver la liste\n    this.choices = [...choices] // La liste des choix\n    this.givenChoices = [...choices] // idem, mais celle-l restera complte avec l'entte de liste si le choix0 retire cet lment de choices lors de l'init.\n\n    this._kbIndex = -1 // L'index du choix slectionn au clavier\n    this.changed = false // Passe  true ds qu'on a fait une slection (ou ds le dpart si le choix initial est slectionnable)\n    this._offset = choix0 ? 0 : 1 // permet d'atteindre le 1er lment slectionnable de la liste\n    this.reponse = '' // Le choix courant\n    this._elts = [] // Liste des elts contenant les choix (les <li>)\n  }\n\n  /**\n   * Cre les lments dans le DOM (appel par create) et ajoute les listeners\n   * @private\n   */\n  _init(\n    {\n      conteneur,\n      sansFleche,\n      select,\n    }: { conteneur?: HTMLElement; sansFleche?: boolean; select?: number } = {\n      sansFleche: false,\n      select: 0,\n    },\n  ) {\n    /**\n     * Le span qui va contenir la liste (tous les lments que l'on cre, enfant de conteneur)\n     * @type {HTMLSpanElement}\n     */\n    if (!conteneur)\n      throw Error('Le conteneur est obligatoire pour la liste droulante !')\n    this.container = conteneur\n    this.container.classList.add('listeDeroulante')\n    const char = ''\n    this.spanSelected = document.createElement('span') // Le span de l'lment slectionn\n    this.container.appendChild(this.spanSelected)\n    this.spanSelected.className = 'currentChoice'\n    this.spanSelected.role = 'listbox'\n    this.spanSelected.tabIndex = 0\n\n    // les listeners sur container, faut les mettre en proprit pour pouvoir les retirer dans disable()\n    // click\n    this._clickListener = (event) => {\n      event?.stopPropagation()\n      this.toggle()\n    }\n    this.container.onclick = this._clickListener\n\n    /**\n     * listener de keydown sur spanSelected, pour slection au clavier\n     * @param {KeyboardEvent} event\n     */\n    this._keydownListener = (event: KeyboardEvent): void => {\n      const { code, key } = event\n      if (code === 'Tab' || key === 'Tab') {\n        // on sort du menu au clavier, faut le refermer\n        this.hide()\n      } else if (code === 'ArrowDown' || key === 'ArrowDown') {\n        event.preventDefault()\n        if (this._kbIndex < this.choices.length - 1) {\n          this._kbIndex++\n          if (!this.isVisible()) this.show()\n          this._kbSelect()\n        }\n      } else if (code === 'ArrowUp' || key === 'ArrowUp') {\n        event.preventDefault()\n        if (this._kbIndex === -1) this._kbIndex = this.choices.length // 1er clic sur arrowUp, on part de la fin\n        if (this._kbIndex > 0) {\n          this._kbIndex--\n          if (!this.isVisible()) this.show()\n          this._kbSelect()\n        }\n      } else if (\n        code === 'Space' ||\n        key === 'Space' ||\n        code === 'Enter' ||\n        key === 'Enter'\n      ) {\n        if (this.isVisible()) {\n          this.select(this._kbIndex, { withoutOffset: true })\n        } else {\n          this.show()\n        }\n      }\n    }\n    if (!sansFleche) {\n      const fleche = document.createElement('span')\n      fleche.className = 'trigger'\n      fleche.textContent = char\n      if (this._clickListener) fleche.onclick = this._clickListener\n      this.container.appendChild(fleche)\n    }\n    // la liste qui peut tre masque (il doit passer au-dessus du reste, les boutons sont  50, les modales  90)\n    this.ulContainer = document.createElement('ul')\n    this.container.appendChild(this.ulContainer)\n\n    // si le premier lment de la liste n'est pas slectionnable, on le sort de la liste\n    this.initialChoice = this._offset ? this.choices.shift() : this.choices[0]\n    // les choix\n    for (const [index, choice] of this.choices.entries()) {\n      const li = document.createElement('li')\n      li.role = 'option'\n      this.ulContainer?.appendChild(li)\n      afficheChoice(li, choice)\n      li.addEventListener('click', (event) => {\n        event.stopPropagation() // faut pas propager  container sinon il va rouvrir la liste aprs select()\n        this.select(index, { withoutOffset: true })\n      })\n      this._elts.push(li)\n    }\n    // Il faut faire a pour rcuprer this.width  l'init ce qui permet de fixer la largeur minimum du spanSelected et d'aligner la liste  droite du spanSelected\n    this.show() // fixe le this.width car il est undefined.\n    this.hide()\n\n    this.spanSelected.addEventListener('keydown', this._keydownListener)\n    // pour refermer le menu si on sort au clavier,\n    // on a essay de refermer le menu au focusout sur container (avec un timeout sinon a ferme avant de dclencher\n    // le clic sur un li et on se retrouve  cliquer dessous), mais a pose plus de pb que a n'en rsoud\n    // (le clic sur la flche referme parfois le menu aussitt)\n    // => on gre le tab sortant dans _keydownListener\n\n    // et un listener pour refermer la liste si on clique ailleurs\n    document.body.addEventListener('click', ({ target }) => {\n      // si on trouve un .listeDeroulante dans un parent on ne fait rien\n      /** @type {null|HTMLElement} */\n      let parent: EventTarget | null = target\n      while (parent && parent instanceof HTMLElement) {\n        if (parent.classList.contains('listeDeroulante')) return\n        parent = parent.parentElement\n      }\n      // sinon on cache\n      this.hide()\n    })\n    // et le choix initial, on passe par select/reset pour viter de dupliquer du code, mais ils ne doivent pas appeler le listener  l'init\n    // (y'a des sections qui nous filent en listener  un truc qui n'est pas encore prt, faut pas l'appeler tout de suite)\n    if (select) this.select(select)\n    // si choix0, on considre a comme une rponse dj mise\n    else if (this._offset === 0) this.select(0)\n    // sinon reset\n    else this.reset()\n    this._replace()\n  }\n\n  /**\n   * met le focus sur l'lment slectionn\n   */\n  focus() {\n    if (this.spanSelected) this.spanSelected.focus()\n  }\n\n  /**\n   * positionne le ul par rapport au spanSelected\n   * @private\n   */\n  _replace() {\n    if (this.container) {\n      const height = this.container.offsetHeight\n      const widthSpan = this.spanSelected?.offsetWidth ?? 0\n      if (this.ulContainer) {\n        this.ulContainer.style.top = `${height}px`\n        this.ulContainer.style.left = `${widthSpan - (this.width ?? 0)}px`\n      }\n    }\n  }\n\n  /**\n   * Remet la liste dans son tat initial\n   */\n  reset() {\n    this.hide()\n    if (this.spanSelected) {\n      empty(this.spanSelected)\n      afficheChoice(this.spanSelected, this.initialChoice)\n      this.spanSelected.style.fontStyle = 'italic'\n      this.spanSelected.style.color = 'Grey'\n      this._kbIndex = -1\n      this.reponse = ''\n      this.changed = false\n      this._replace() // au cas o la hauteur de spanSelected aurait chang\n    }\n  }\n\n  /**\n   * Slectionne le choix index (dans le tableau fourni initialement)\n   * @param {number} index index dans choices\n   * @param {Object} [options]\n   * @param {boolean} [options.withoutOffset] Passer true si l'index est celui du tableau aprs avoir ventuellement retir son 1er lment ( priori usage interne seulement)\n   */\n  select(\n    index: number,\n    {\n      withoutOffset,\n    }: {\n      withoutOffset?: boolean\n    } = {},\n  ) {\n    if (this.spanSelected != null) {\n      if (this.disabled) return\n      this.spanSelected.style.fontStyle = ''\n      this.spanSelected.style.color = ''\n      if (!Number.isInteger(index)) return Error(`index non entier : ${index}`)\n      // faut dcaler l'index si on a vir le 1er elt  l'init\n      const realIndex = withoutOffset ? index : index - this._offset\n      if (realIndex < 0 || realIndex >= this.choices.length) {\n        if (withoutOffset)\n          return console.error(\n            `index invalide : ${index} non compris entre 0 et ${this.choices.length - 1}`,\n          )\n        return console.error(\n          `index invalide : ${index} non compris entre ${this._offset} et ${this.choices.length - 1 + this._offset}`,\n        )\n      }\n      empty(this.spanSelected)\n      const choix = this.choices[realIndex]\n      afficheChoice(this.spanSelected, choix)\n      this.reponse = String(\n        typeof choix === 'string'\n          ? choix\n          : typeof choix === 'object'\n            ? choix?.value\n            : 'undefined',\n      )\n      if (this.reponse === 'undefined')\n        throw Error(`Un problme avec la valeur de ce choix : ${choix}`)\n      this.changed = true\n      this._kbIndex = index\n      for (const [i, li] of this._elts.entries()) {\n        if (i === index) li.classList.add('selected')\n        else li.classList.remove('selected')\n      }\n      this._replace() // la hauteur de spanSelected peut changer\n      this.focus()\n      this.hide()\n    }\n  }\n\n  /**\n   * Marque un lment comme tant slectionn au clavier (sera ensuite vraiment slectionn si on appuie ensuite sur entre)\n   */\n  _kbSelect() {\n    for (const [i, li] of this._elts.entries()) {\n      if (this._kbIndex === i) li.classList.add('selected')\n      else li.classList.remove('selected')\n    }\n  }\n\n  hide() {\n    if (this.ulContainer) this.ulContainer.classList.remove('visible')\n  }\n\n  show() {\n    if (this.disabled) return\n    // il faut d'abord masquer toutes les autres listes qui pourraient tre ouverte (pour viter des chevauchements)\n    for (const ul of document.querySelectorAll('.listeDeroulante ul.visible')) {\n      ul.classList.remove('visible')\n    }\n    if (this.ulContainer) this.ulContainer.classList.add('visible')\n    // Si this.width n'est pas dfini (a veut dire que c'est l'init qui l'appelle) on le renseigne et on replace la liste  droite et en dessous du spanSelected.\n    if (!this.width) {\n      this.width = this.ulContainer?.offsetWidth\n      this._replace()\n    }\n    this.focus() // pour usage au clavier\n  }\n\n  /**\n   * Pour changer l'tat 'visible' de la liste\n   */\n  toggle() {\n    if (this.disabled) return\n    if (this.isVisible()) this.hide()\n    else this.show()\n  }\n\n  /**\n   * Comme son nom l'indique, dit si la liste est visible\n   */\n  isVisible() {\n    if (this.ulContainer) return this.ulContainer.classList.contains('visible')\n    else return false\n  }\n\n  getSelectedIndex() {\n    return this._kbIndex\n  }\n\n  /**\n   * Ajoute la liste dans le dom et retourne l'objet ListeDeroulante qu'elle a cr\n   * @name ListeDeroulante\n   * @param {HTMLElement|string} conteneur\n   * @param {CHoiceValue[]} choices la liste des choix\n   * @param {Object} [parametres]  Les paramtres de cette liste\n   * @param {boolean} [parametres.sansFleche=false] passer true pour ne pas mettre la flche permettant le droulement\n   * @param {number} [parametres.select=0] index de choices  slectionner ds le dpart (ignor si choix est prcis)\n   * @return {ListeDeroulante}\n   */\n  static create(\n    conteneur: HTMLElement,\n    choices: AllChoicesType,\n    {\n      choix0,\n      sansFleche,\n      select,\n    }: {\n      choix0?: boolean\n      sansFleche?: boolean\n      select?: number\n    } = {\n      choix0: false,\n      sansFleche: false,\n      select: 0,\n    },\n  ): ListeDeroulante {\n    const ld = new ListeDeroulante(choices, {\n      choix0,\n    })\n    if (!conteneur)\n      throw Error('Impossible de crer la liste droulante, pas de conteneur')\n    ld._init({ conteneur, sansFleche, select })\n    return ld\n  }\n}\n\nexport default ListeDeroulante\n","import ListeDeroulante, { type AllChoicesType } from './ListeDeroulante'\n\nclass ListeDeroulanteElement extends HTMLElement {\n  private _listeDeroulante?: ListeDeroulante\n\n  constructor() {\n    super()\n    this.attachShadow({ mode: 'open' })\n  }\n\n  static get observedAttributes() {\n    return ['choices']\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (name === 'choices' && oldValue !== newValue) {\n      this.render()\n    }\n  }\n\n  connectedCallback() {\n    this.render()\n  }\n\n  set choices(val: AllChoicesType) {\n    this._choices = val\n    this.render()\n  }\n\n  get choices(): AllChoicesType {\n    return this._choices\n  }\n\n  private _choices: AllChoicesType = []\n\n  render() {\n    if (this.shadowRoot) this.shadowRoot.innerHTML = ''\n\n    // Ajoute le CSS compil directement ici (copie-colle le contenu du .css gnr)\n    const style = document.createElement('style')\n    style.textContent = `\nspan.listeDeroulante {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  background: #fff;\n  color: #333;\n  border: 1px solid #d1d5db; /* gris clair moderne */\n  border-radius: 0.5rem;\n  font-size: 0.95rem;\n  line-height: 1.5;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  padding: 2px 6px;\n}\n\nspan.listeDeroulante:hover {\n  border-color: #3b82f6; /* bleu Tailwind */\n  box-shadow: 0 2px 6px rgba(0,0,0,0.08);\n}\n\nspan.listeDeroulante span.currentChoice {\n  display: flex;\n  align-items: center;\n  padding: 6px 10px;\n  outline: none;\n}\n\nspan.listeDeroulante .trigger {\n  margin-left: auto;\n  padding: 6px 8px;\n  font-weight: bold;\n  font-size: 0.9em;\n  color: #6b7280; /* gris neutre */\n  border-left: 1px solid #e5e7eb;\n  transition: color 0.2s ease;\n}\n\nspan.listeDeroulante .trigger:hover {\n  color: #111827; /* noir doux */\n}\n\nspan.listeDeroulante .ok {\n  color: #10b981; /* vert moderne */\n}\n\nspan.listeDeroulante .ko {\n  color: #ef4444; /* rouge moderne */\n}\n\n/* Liste droulante */\nspan.listeDeroulante ul {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: max-content;\n  min-width: 100%;\n  background: #fff;\n  border: 1px solid #d1d5db;\n  border-radius: 0.5rem;\n  margin: 4px 0 0 0;\n  padding: 4px 0;\n  display: none;\n  z-index: 100;\n  box-shadow: 0 6px 16px rgba(0,0,0,0.12);\n  animation: fadeIn 0.15s ease-out;\n}\n\nspan.listeDeroulante ul.visible {\n  display: block;\n}\n\nspan.listeDeroulante ul li {\n  display: flex;\n  align-items: center;\n  list-style-type: none;\n  padding: 8px 12px;\n  cursor: pointer;\n  font-size: 0.95rem;\n  color: #111827;\n  background: #fff;\n  transition: background 0.2s ease, color 0.2s ease;\n  border: none;\n}\n\nspan.listeDeroulante ul li:hover {\n  background: #f3f4f6;\n  color: #1d4ed8; /* bleu accent */\n}\n\nspan.listeDeroulante ul li.selected {\n  background: #e0f2fe;\n  color: #0284c7;\n  font-weight: 500;\n}\n\nspan.listeDeroulante.disabled {\n  cursor: not-allowed;\n  background: #f9fafb;\n  border-color: #e5e7eb;\n  color: #9ca3af;\n}\n\nspan.listeDeroulante.disabled .trigger {\n  color: #d1d5db;\n}\n\nspan.listeDeroulante.disabled span.currentChoice {\n  pointer-events: none;\n}\n\nspan.listeDeroulante math-field {\n  pointer-events: none;\n  background: transparent !important;\n  border: none !important;\n  box-shadow: none !important;\n  outline: none !important;\n  padding: 0 !important;\n}\n\nspan.listeDeroulante ul li svg.svgChoice {\n  width: 1.2em;\n  height: 1.2em;\n  margin-right: 6px;\n  flex-shrink: 0;\n  fill: currentColor;\n}\n\n/* Animation d'apparition */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-5px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n`\n    this.shadowRoot!.appendChild(style)\n\n    // Cration du conteneur\n    const container = document.createElement('span')\n    this.shadowRoot!.appendChild(container)\n\n    // Rcupre les choix depuis l'attribut ou la proprit\n    let choices: AllChoicesType = this.choices\n    if (!choices.length && this.hasAttribute('choices')) {\n      try {\n        const attr = decodeURIComponent(this.getAttribute('choices')!)\n        choices = JSON.parse(attr)\n      } catch (e) {\n        choices = []\n      }\n    }\n    const choix0 = this.hasAttribute('choix0')\n      ? this.getAttribute('choix0') !== 'false'\n      : false\n\n    // Cration de la liste droulante\n    this._listeDeroulante = new ListeDeroulante(choices, { choix0 })\n    this._listeDeroulante._init({ conteneur: container })\n  }\n\n  // API JS pour rcuprer la valeur slectionne\n  get value() {\n    return this._listeDeroulante?.reponse ?? ''\n  }\n\n  set value(val) {\n    if (this._listeDeroulante) {\n      this._listeDeroulante.select(\n        this._listeDeroulante.choices.findIndex((el) => el.value === val) +\n          this._listeDeroulante._offset,\n      )\n    }\n  }\n}\n\ncustomElements.define('liste-deroulante', ListeDeroulanteElement)\nexport default ListeDeroulanteElement\n","// import { addElement, get, setStyles } from '../html/dom'\nimport type { IExercice } from '../../lib/types'\nimport { context } from '../../modules/context'\nimport type { AllChoicesType } from './listeDeroulante/ListeDeroulante'\nimport './listeDeroulante/ListeDeroulanteElement'\n\n/**\n * Vrifie la rponse  une question  liste droulante\n * @param {object} exercice l'exercice appelant pour pouvoir atteindre ses proprits.\n * @param {number} i le numro de la question\n * @returns {string} 'OK' si la rponse est correcte, 'KO' sinon\n */\nexport function verifQuestionListeDeroulante(exercice: IExercice, i: number) {\n  /* // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  const eltFeedback = document.querySelector(`resultatCheckEx${exercice.numeroExercice}Q${i}`)\n  // On ajoute le div pour le feedback\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n   */\n  const spanReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  )\n  if (spanReponseLigne == null) {\n    window.notify(\n      \"l'exercice ayant appel verifQuestionListeDeroulante() n'a pas correctement dfini le span pour le smiley\",\n      { exercice: JSON.stringify(exercice) },\n    )\n  }\n  const liste = document.querySelector(`#ex${exercice.numeroExercice}Q${i}`)\n  let value\n\n  if (liste) {\n    value = (liste as any).value\n  }\n  const reponse = exercice.autoCorrection[i]?.reponse?.valeur?.reponse?.value\n  // Sauvegarde pour les exports Moodle, Capytale...\n  if (exercice.answers === undefined) {\n    exercice.answers = {}\n  }\n  if (liste) {\n    exercice.answers[liste.id] = value\n  }\n  const resultat = value === reponse ? 'OK' : 'KO'\n  if (resultat === 'OK') {\n    if (spanReponseLigne) {\n      spanReponseLigne.innerHTML = ''\n    }\n  } else {\n    if (spanReponseLigne) {\n      spanReponseLigne.innerHTML = ''\n    }\n  }\n  if (spanReponseLigne)\n    (spanReponseLigne as HTMLElement).style.fontSize = 'large'\n  return resultat\n}\n\n/**\n *\n * Fonction pour crer une liste droulante dans un exercice interactif.\n * @param {Exercice} exercice l'exercice appelant pour pouvoir atteindre ses proprits.\n * @param {number} i le numro de la question\n * @param {AllChoicesType} choix les choix possibles dans la liste droulante\n * @param {boolean} [choix0] true si on veut un choix slectionnable en premier (pas d'entte) par dfaut false\n * @param {string} [style] le style  appliquer  la liste droulante (en plus ou en remplacement de celui par dfaut))\n * @returns {string} le code HTML de la liste droulante\n */\nexport function choixDeroulant(\n  exercice: IExercice,\n  i: number,\n  choix: AllChoicesType,\n  choix0?: boolean,\n  style?: string,\n) {\n  if (!exercice.interactif || !context.isHtml) return ''\n\n  choix0 = choix0 !== undefined ? Boolean(choix0) : false\n  style = style ? ` style=\"${style}\"` : ''\n  if (\n    context.isHtml &&\n    exercice?.autoCorrection[i]?.reponse?.param?.formatInteractif !==\n      'listeDeroulante'\n  ) {\n    if (exercice?.autoCorrection == null) exercice.autoCorrection = []\n    if (exercice?.autoCorrection[i] == null) exercice.autoCorrection[i] = {}\n    if (exercice?.autoCorrection[i].reponse == null)\n      exercice.autoCorrection[i].reponse = {}\n    if (exercice.autoCorrection[i].reponse.param == null)\n      exercice.autoCorrection[i].reponse.param = {}\n    exercice.autoCorrection[i].reponse.param.formatInteractif =\n      'listeDeroulante'\n  }\n  let result =\n    `<liste-deroulante class=\"mx-2 listeDeroulante\" id=\"ex${exercice.numeroExercice}Q${i}\"${style} choices=\"` +\n    encodeURIComponent(JSON.stringify(choix)) +\n    `\" choix0=\"${choix0}\"></liste-deroulante>`\n  /* let result = `<select class=\"mx-2 listeDeroulante\" id=\"Ex${exercice.numeroExercice}Q${i}\" ${style}>\n      <option> Choisir ${type === 'nombre' ? 'un nombre' : type} </option>`\n\n  for (const a of choix) {\n    result += `<option>${a}</option>`\n  }\n    */\n  result += `<span id=\"resultatCheckEx${exercice.numeroExercice}Q${i}\"></span>`\n  return result\n}\n\n/**\n * Fonction pour transformer une liste droulante en QCM (pour AMC, la version interactive n'a que peu d'intrt)\n * @param {Exercice} exercice\n * @param {number} question\n * @param {string[]} choix\n * @param {string} reponse\n * @param {object} options // options.vertical pour prsenter les rponses, options.ordered pour modifier l'ordre\n * passer toutes les options possibles pour AMC (lastChoice par exemple utile si pas ordonn pour dire o s'arrte le mlange voir le wiki concernant AMC).\n */\nexport function listeDeroulanteToQcm(\n  exercice: IExercice,\n  question: number,\n  choix: AllChoicesType,\n  reponse: string,\n  options: any,\n) {\n  if (exercice == null || choix == null || reponse == null) {\n    window.notify(\n      'Il manque des paramtres pour transformer la liste droulante en qcm',\n      { exercice, question, choix, reponse },\n    )\n    return\n  }\n  if (!choix.some((el) => el.value === reponse)) {\n    window.notify('La rponse doit faire partie de la liste !', {\n      choix,\n      reponse,\n    })\n    return\n  }\n  const vertical = options?.vertical ?? true // Par dfaut c'est vertical comme une liste droulante mais on peut passer vertical = false\n  const ordered = options?.ordered ?? true // Par dfaut ce sera le mme ordre que la liste droulante\n  if (\n    exercice.autoCorrection == null ||\n    !Array.isArray(exercice.autoCorrection)\n  ) {\n    exercice.autoCorrection = []\n  }\n  if (exercice.autoCorrection[question] == null)\n    exercice.autoCorrection[question] = {}\n  exercice.autoCorrection[question] = {}\n  exercice.autoCorrection[question].options = { vertical, ordered, ...options }\n  exercice.autoCorrection[question].propositions = []\n  for (let j = 0; j < choix.length; j++) {\n    if (choix[j].value === '') continue\n    if (choix[j].label != null) {\n      exercice.autoCorrection[question].propositions.push({\n        texte: choix[j].label,\n        statut: choix[j].value === reponse, // il n'y a qu'une bonne rponse, et elle doit correspondre  l'un des choix.\n      })\n    } else if (choix[j].latex != null) {\n      exercice.autoCorrection[question].propositions.push({\n        texte: `$${choix[j].latex}$`,\n        statut: choix[j].value === reponse, // il n'y a qu'une bonne rponse, et elle doit correspondre  l'un des choix.\n      })\n    } else if (choix[j].svg != null) {\n      const body = document.querySelector('body')\n      if (body == null) {\n        window.notify(\n          \"Impossible de crer le QCM  partir de la liste droulante car le body n'existe pas\",\n          {},\n        )\n        return\n      }\n      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n      body.appendChild(svg)\n      svg.setAttribute('viewBox', '-10 -10 20 20') // Valeur par dfaut, peut tre ajuste\n      svg.classList.add('svgChoice')\n      svg.style.display = 'inline-block'\n      svg.style.width = '20px'\n      svg.style.height = '20px'\n      svg.style.verticalAlign = 'middle'\n      svg.innerHTML = choix[j].svg ?? ''\n      exercice.autoCorrection[question].propositions.push({\n        texte: svg.outerHTML,\n        statut: choix[j].value === reponse,\n      })\n      setTimeout(() => {\n        if (svg) body.removeChild(svg)\n      }, 0)\n    } else if (choix[j].image != null) {\n      const image = document.createElement('img')\n      image.src = choix[j].image ?? choix[j].value\n      image.style.width = '30px'\n      image.style.height = '30px'\n      exercice.autoCorrection[question].propositions.push({\n        texte: image.outerHTML,\n        statut: choix[j].value === reponse,\n      })\n    } else {\n      console.warn(\n        'La liste droulante  convertir en qcm contient un choix de type inconnu',\n        JSON.stringify(choix[j]),\n      )\n    }\n  }\n}\n","import type Figure from 'apigeom/src/Figure'\nimport Decimal from 'decimal.js'\nimport type { MathfieldElement } from 'mathlive'\nimport type {\n  AnswerValueType,\n  AutoCorrection,\n  ClickFigures,\n  IExercice,\n  LegacyReponse,\n  LegacyReponses,\n  MathaleaSVG,\n  ReponseParams,\n  ResultOfExerciceInteractif,\n  Valeur,\n  ValeurNormalized,\n} from '../../lib/types'\nimport { context } from '../../modules/context'\nimport FractionEtendue from '../../modules/FractionEtendue'\nimport Grandeur from '../../modules/Grandeur'\nimport Hms from '../../modules/Hms'\nimport { addElement, get, setStyles } from '../html/dom'\nimport { verifQuestionTableur } from '../tableur/outilsTableur'\nimport { afficheScore } from './afficheScore'\nimport { fonctionComparaison } from './comparisonFunctions'\nimport { verifDragAndDrop } from './DragAndDrop'\nimport { toutPourUnPoint, verifQuestionMathLive } from './mathLive'\nimport { verifQuestionQcm } from './qcm'\nimport { verifQuestionListeDeroulante } from './questionListeDeroulante'\n\n/**\n * Puisque tous les attributs de Valeur sont facultatifs, on vrifie juste si c'est un objet (et ce type est assez inutile du coup car quasiment identique  un unknown)\n */\nexport function isValeur(value: unknown): value is Valeur {\n  return typeof value === 'object'\n}\n\nexport function isAnswerValueType(value: unknown): value is AnswerValueType {\n  return (\n    typeof value === 'string' ||\n    (Array.isArray(value) &&\n      value.every((value) => typeof value === 'string')) ||\n    typeof value === 'number' ||\n    (Array.isArray(value) &&\n      value.every((value) => typeof value === 'number')) ||\n    value instanceof FractionEtendue ||\n    (Array.isArray(value) &&\n      value.every((value) => value instanceof FractionEtendue)) ||\n    value instanceof Decimal ||\n    (Array.isArray(value) &&\n      value.every((value) => value instanceof Decimal)) ||\n    value instanceof Grandeur ||\n    (Array.isArray(value) &&\n      value.every((value) => value instanceof Grandeur)) ||\n    value instanceof Hms ||\n    (Array.isArray(value) && value.every((value) => value instanceof Hms))\n  )\n}\n\nexport type ReponseComplexe = AnswerValueType | Valeur\nexport function isReponseComplexe(value: unknown): value is ReponseComplexe {\n  return isAnswerValueType(value) || isValeur(value)\n}\n\nexport function isClickFiguresArray(\n  figures: Figure[] | ClickFigures[],\n): figures is ClickFigures[] {\n  return figures.length > 0 && Array.isArray(figures[0])\n}\n\n/**\n * Pour positionner le formatInteractif d'une question sur 'cliqueFigure'\n * On passe this.autoCorrection[i] c'est  dire l'objet rponse de la question.\n *  appeler aprs avoir rempli l'objet rponse qvec enonce et propositions\n * @param objetReponse\n */\nexport function setCliqueFigure(objetReponse: AutoCorrection) {\n  objetReponse.reponse = {\n    ...objetReponse.reponse,\n    param: { formatInteractif: 'cliqueFigure' },\n  }\n}\n/**\n * Pour positionner le formatInteractif d'une question sur 'qcm'\n * On passe this.autoCorrection[i] c'est  dire l'objet rponse de la question.\n *  appeler aprs avoir rempli l'objet rponse qvec enonce et propositions\n * @param objetReponse\n */\nexport function setQcm(objetReponse: AutoCorrection) {\n  objetReponse.reponse = {\n    ...objetReponse.reponse,\n    param: { formatInteractif: 'qcm' },\n  }\n}\n/**\n * Pour positionner le formatInteractif d'une question sur 'listeDeroulante'\n * On passe this.autoCorrection[i] c'est  dire l'objet rponse de la question.\n *  appeler aprs avoir rempli l'objet rponse qvec enonce et propositions\n * @param objetReponse\n */\nexport function setListeDeroulante(objetReponse: AutoCorrection) {\n  objetReponse.reponse = {\n    ...objetReponse.reponse,\n    param: { formatInteractif: 'listeDeroulante' },\n  }\n}\n// Garde structurel pour viter d'importer MetaExercice et crer un cycle\nconst isMetaExercice = (\n  x: unknown,\n): x is {\n  Exercices: unknown[]\n  correctionInteractives: Array<(i: number) => string | string[]>\n} =>\n  typeof x === 'object' &&\n  x !== null &&\n  Array.isArray((x as any).Exercices) &&\n  Array.isArray((x as any).correctionInteractives)\n/**\n * Cette fonction vrifie les rponses de chaque question en appelant la fonction associe  son formatInteractif ('mathlive', 'listeDeroulante', 'cliqueFigure', 'qcm')\n * @param {Exercice} exercice\n * @param {HTMLDivElement} divScore\n * @param {HTMLButtonElement} buttonScore\n * @returns {{numberOfPoints: number, numberOfQuestions: number}}\n */\nexport function exerciceInteractif(\n  exercice: IExercice,\n  divScore: HTMLDivElement,\n  buttonScore: HTMLButtonElement,\n): ResultOfExerciceInteractif {\n  let nbQuestionsValidees = 0\n  let nbQuestionsNonValidees = 0\n  exercice.answers = {}\n\n  if (exercice.interactifType === 'custom') {\n    return verifExerciceCustom(exercice, divScore, buttonScore)\n  }\n\n  for (let i = 0; i < exercice.autoCorrection.length; i++) {\n    const format = exercice.autoCorrection[i]?.reponse?.param?.formatInteractif\n    let resultat: string\n    switch (format) {\n      case 'MetaInteractif2d':\n        {\n          const result = verifQuestionMetaInteractif2d(exercice, i)\n          if (result == null) {\n            window.notify('erreur dans la correction de la question', {\n              exercice,\n              i,\n            })\n          } else {\n            nbQuestionsValidees += result.score.nbBonnesReponses\n            nbQuestionsNonValidees +=\n              result.score.nbReponses - result.score.nbBonnesReponses\n            if (result.feedback && result.feedback !== '') {\n              const divFeedback = document.querySelector(\n                `#feedbackEx${exercice.numeroExercice}Q${i}`,\n              )\n              if (divFeedback != null) {\n                divFeedback.innerHTML = ` ${result.feedback}`\n                divFeedback.classList.add(\n                  'py-2',\n                  'italic',\n                  'text-coopmaths-warn-darkest',\n                  'dark:text-coopmathsdark-warn-darkest',\n                )\n                ;(divFeedback as HTMLDivElement).style.display = 'block'\n              }\n            }\n          }\n        }\n        break\n\n      case 'tableur': {\n        const result = verifQuestionTableur(exercice, i)\n        if (result == null) {\n          window.notify('erreur dans la correction de la question', {\n            exercice,\n            i,\n          })\n        } else {\n          nbQuestionsValidees += result.score.nbBonnesReponses\n          nbQuestionsNonValidees +=\n            result.score.nbReponses - result.score.nbBonnesReponses\n          if (result.feedback && result.feedback !== '') {\n            const divFeedback = document.querySelector(\n              `#feedbackEx${exercice.numeroExercice}Q${i}`,\n            )\n            if (divFeedback != null) {\n              divFeedback.innerHTML = ` ${result.feedback}`\n              divFeedback.classList.add(\n                'py-2',\n                'italic',\n                'text-coopmaths-warn-darkest',\n                'dark:text-coopmathsdark-warn-darkest',\n              )\n              ;(divFeedback as HTMLDivElement).style.display = 'block'\n            }\n          }\n        }\n        break\n      }\n      case 'custom': {\n        if (isMetaExercice(exercice)) {\n          const result = exercice.correctionInteractives[i](i)\n          result === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        }\n        break\n      }\n      case 'dnd': {\n        const result = verifDragAndDrop(exercice, i)\n        nbQuestionsValidees += result.score.nbBonnesReponses\n        nbQuestionsNonValidees +=\n          result.score.nbReponses - result.score.nbBonnesReponses\n        if (result.feedback !== '') {\n          const spanFeedback = document.querySelector(\n            `#feedbackEx${exercice.numeroExercice}Q${i}`,\n          )\n          if (spanFeedback != null) {\n            spanFeedback.innerHTML = ` ${result.feedback}`\n            spanFeedback.classList.add(\n              'py-2',\n              'italic',\n              'text-coopmaths-warn-darkest',\n              'dark:text-coopmathsdark-warn-darkest',\n            )\n          }\n        }\n        break\n      }\n      case 'qcm':\n        resultat = verifQuestionQcm(exercice, i)\n        resultat === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        break\n      case 'listeDeroulante': {\n        resultat = verifQuestionListeDeroulante(exercice, i)\n        resultat === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        break\n      }\n      case 'cliqueFigure':\n        if ('callback' in exercice && typeof exercice.callback === 'function') {\n          resultat = verifQuestionCliqueFigure(\n            exercice,\n            i,\n            exercice.callback as (exercice: IExercice, i: number) => void,\n          )\n        } else {\n          resultat = verifQuestionCliqueFigure(exercice, i)\n        }\n        resultat === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        break\n      default:\n        {\n          const result = verifQuestionMathLive(exercice, i)\n          if (result == null) {\n            window.notify('erreur dans la correction de la question', {\n              exercice,\n              i,\n            })\n          } else {\n            nbQuestionsValidees += result.score.nbBonnesReponses\n            nbQuestionsNonValidees +=\n              result.score.nbReponses - result.score.nbBonnesReponses\n            if (result.feedback && result.feedback !== '') {\n              const divFeedback = document.querySelector(\n                `#feedbackEx${exercice.numeroExercice}Q${i}`,\n              )\n              if (divFeedback != null) {\n                divFeedback.innerHTML = ` ${result.feedback}`\n                divFeedback.classList.add(\n                  'py-2',\n                  'italic',\n                  'text-coopmaths-warn-darkest',\n                  'dark:text-coopmathsdark-warn-darkest',\n                )\n                ;(divFeedback as HTMLDivElement).style.display = 'block'\n              }\n            }\n          }\n        }\n        break\n    }\n  }\n  return afficheScore(\n    exercice,\n    nbQuestionsValidees,\n    nbQuestionsNonValidees,\n    divScore,\n    buttonScore,\n  )\n}\n\n/**\n * Le cas  part : un exercice custom fournit une fonction correctionInteractive qui doit corriger toutes les questions et s'occuper du feedback\n * @param exercice\n * @param divScore\n * @param buttonScore\n * @return {{numberOfPoints, numberOfQuestions: *}}\n */\nfunction verifExerciceCustom(\n  exercice: IExercice,\n  divScore: HTMLDivElement,\n  buttonScore: HTMLButtonElement,\n) {\n  let nbBonnesReponses = 0\n  let nbMauvaisesReponses = 0\n  // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  let eltFeedback = get(`feedbackEx${exercice.numeroExercice}`, false)\n  // On ajoute le div pour le feedback\n  if (!eltFeedback) {\n    const eltExercice = get(\n      `exercice${exercice.numeroExercice}`,\n    ) as HTMLDivElement\n    eltFeedback = addElement(\n      eltExercice,\n      'div',\n      {\n        id: `feedbackEx${exercice.numeroExercice}`,\n      },\n      '',\n    )\n  }\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n  // On utilise la correction dfinie dans l'exercice\n  if (exercice.exoCustomResultat) {\n    for (let i = 0; i < exercice.nbQuestions; i++) {\n      if (exercice.correctionInteractive != null) {\n        const correction = exercice.correctionInteractive(i)\n        if (Array.isArray(correction)) {\n          for (const result of correction) {\n            if (result === 'OK') nbBonnesReponses++\n            else nbMauvaisesReponses++\n          }\n        } else {\n          correction === 'OK' ? nbBonnesReponses++ : nbMauvaisesReponses++\n        }\n      }\n    }\n  } else {\n    for (let i = 0; i < exercice.nbQuestions; i++) {\n      if (exercice.correctionInteractive != null) {\n        exercice.correctionInteractive(i) === 'OK'\n          ? nbBonnesReponses++\n          : nbMauvaisesReponses++\n      }\n    }\n  }\n  return afficheScore(\n    exercice,\n    nbBonnesReponses,\n    nbMauvaisesReponses,\n    divScore,\n    buttonScore,\n  )\n}\n\nexport function prepareExerciceCliqueFigure(exercice: IExercice) {\n  // Ds que l'exercice est affich, on rajoute des listenners sur chaque lments de this.figures.\n  for (let i = 0; i < exercice.nbQuestions; i++) {\n    if (\n      exercice.figures != null &&\n      exercice.figures[i] != null &&\n      isClickFiguresArray(exercice.figures)\n    ) {\n      const figures = exercice.figures[i]\n      for (const objetFigure of figures) {\n        const figSvg: unknown = document.getElementById(objetFigure.id)\n        if (figSvg != null) {\n          const fig = figSvg as MathaleaSVG\n          if (!fig.hasMathaleaListener) {\n            fig.addEventListener('mouseover', mouseOverSvgEffect)\n            fig.addEventListener('mouseout', mouseOutSvgEffect)\n            fig.addEventListener('click', mouseSvgClick)\n            if (fig.etat === true) {\n              // MGu : si l'tat est true, c'est que ca a t coch par capytale\n              // il faudrait revoir le systme de figure cliquable avec un customelement\n            } else {\n              fig.etat = false\n            }\n            fig.style.margin = '10px'\n            fig.style.border = '3px solid transparent'\n            fig.hasMathaleaListener = true\n            // On enregistre que l'lment a dj un listenner pour ne pas lui remettre le mme  l'appui sur \"Nouvelles Donnes\"\n          }\n        }\n      }\n    }\n  }\n}\n\n// callback est une fonction facultative qui sera appele avant de vrifier la question\n// elle permet de faire des actions avant la vrification, comme par exemple mettre  jour la correction affiche (voir 6G45)\nfunction verifQuestionCliqueFigure(\n  exercice: IExercice,\n  i: number,\n  callback?: (exercice: IExercice, i: number) => void,\n): string {\n  // si il y a une callback, on l'appelle\n  if (callback != null) {\n    callback(exercice, i)\n  }\n  // suite du code habituel de verifQuestionCliqueFigure\n  // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  let eltFeedback = get(`resultatCheckEx${exercice.numeroExercice}Q${i}`, false)\n  // On ajoute le div pour le feedback\n  if (!eltFeedback) {\n    const eltExercice = get(\n      `exercice${exercice.numeroExercice}`,\n    ) as HTMLDivElement\n    eltFeedback = addElement(\n      eltExercice,\n      'div',\n      {\n        id: `resultatCheckEx${exercice.numeroExercice}Q${i}`,\n      },\n      '',\n    )\n  }\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n  const figures = []\n  let erreur = false // Aucune erreur dtecte\n  let nbFiguresCliquees = 0\n  if (\n    exercice.figures != null &&\n    exercice.figures[i] != null &&\n    Array.isArray(exercice.figures[i])\n  ) {\n    for (const objetFigure of exercice.figures[i]) {\n      const eltFigure: unknown = document.getElementById(objetFigure.id)\n      if (eltFigure != null) {\n        figures.push(eltFigure)\n        const fig = eltFigure as MathaleaSVG\n        fig.removeEventListener('mouseover', mouseOverSvgEffect)\n        fig.removeEventListener('mouseout', mouseOutSvgEffect)\n        fig.removeEventListener('click', mouseSvgClick)\n        fig.hasMathaleaListener = false\n        if (fig.etat) {\n          nbFiguresCliquees++\n          // Sauvegarde des reponses\n          if (exercice.answers) exercice.answers[objetFigure.id] = '1'\n        }\n        if (fig.etat !== objetFigure.solution) erreur = true\n      }\n    }\n  }\n\n  if (nbFiguresCliquees > 0 && !erreur) {\n    eltFeedback.innerHTML = ''\n    return 'OK'\n  }\n  eltFeedback.innerHTML = ''\n  return 'KO'\n}\n\nfunction mouseOverSvgEffect(event: MouseEvent) {\n  const elt = event.target as MathaleaSVG\n  elt.style.border = '3px solid #1DA962'\n}\n\nfunction mouseOutSvgEffect(event: MouseEvent) {\n  const elt = event.target as MathaleaSVG\n  elt.style.border = '3px solid transparent'\n}\n\nfunction mouseSvgClick(event: MouseEvent) {\n  const elt = event.target as MathaleaSVG\n  if (elt.etat) {\n    // Dja choisi, donc on le rinitialise\n    elt.style.border = '3px solid transparent'\n    elt.addEventListener('mouseover', mouseOverSvgEffect)\n    elt.addEventListener('mouseout', mouseOutSvgEffect)\n    elt.addEventListener('click', mouseSvgClick)\n    elt.etat = false\n  } else {\n    // Passe  l'tat choisi donc on dsactive les listenners pour over et pour out\n    elt.removeEventListener('mouseover', mouseOverSvgEffect)\n    elt.removeEventListener('mouseout', mouseOutSvgEffect)\n    elt.style.border = '3px solid #f15929'\n    elt.etat = true\n  }\n}\n\n/**\n * Prcise la rponse attendue\n * Cette fonction est dprcie : elle est remplace par la fonction handleAnswers qu'elle appelle pour les anciens exercices\n * C'est donc maintenant un wrapper de handleAnswers.\n * @param {Exercice} exercice = this\n * @param {number} i numro de la question\n * @param {any} valeurs Attention  ce que vous mettez ici : a doit tre en accord avec le formatInteractif ! pas de texNombre ou de stringNombre !\n * @param {ReponseParams} params\n * @deprecated Dans la mesure du possible, utiliser handleAnswers aprs avoir consulter la doc\n * @see https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Rendre-un-exercice-interactif\n */\nexport function setReponse(\n  exercice: IExercice,\n  i: number,\n  valeurs: LegacyReponses,\n  params: ReponseParams = {},\n) {\n  const url = new URL(window.location.href)\n  // if (Array.isArray(valeurs) && !url.searchParams.has('testCI')) window.notifyLocal('setReponse a reu un Array de reponses, il faut en finir avec a', { valeurs })\n  if (exercice.formatInteractif === 'qcm') return\n  let formatInteractif = params?.formatInteractif\n  let precision = params?.precision\n  let signe = params?.signe\n  if (formatInteractif === undefined) formatInteractif = 'calcul'\n  let reponses: Array<LegacyReponse>\n  if (url.hostname === 'localhost' && url.searchParams.has('triche')) {\n    console.info(\n      `Rponses de l'exercice ${(exercice.numeroExercice ?? 0) + 1} - question ${i + 1} : `,\n      valeurs,\n    )\n  }\n  if (\n    typeof valeurs === 'object' &&\n    (formatInteractif === 'tableauMathlive' ||\n      formatInteractif === 'fillInTheBlank')\n  ) {\n    throw Error(\n      'setReponse ne doit pas tre utilis pour tableauMathlive ni fillInTheBlank, il faut utiliser handleAnswers',\n    )\n  }\n  if (Array.isArray(valeurs)) {\n    // il peut y avoir une liste de valeurs de rponses  tester, on transfert dans reponses\n    reponses = [...valeurs] // reponses contient donc directement le tableau valeurs\n    // si valeur est un tableau on prend le signe de la premire valeur\n    if (valeurs[0] instanceof FractionEtendue) {\n      signe = (valeurs[0] as FractionEtendue).signe === -1 // si c'est une fraction, alors on regarde son signe (valeur -1, 0 ou 1)\n    } else {\n      if (typeof valeurs[0] === 'number') {\n        signe = valeurs[0] < 0 // on teste si elle est ngative, si oui, on force la case signe pour AMC\n      } else {\n        signe = Number(valeurs[0]) < 0\n      }\n    }\n  } else {\n    // Il n'y a qu'une valeur, on uniformise le format : reponses est une liste de une seule valeur\n    reponses = [valeurs] // ici, valeurs n'est pas un tableau mais on le met dans reponses sous forme de tableau\n    if (valeurs instanceof FractionEtendue) {\n      signe = valeurs.signe === -1 ? true : Boolean(signe) // si c'est une fraction, alors on regarde son signe (valeur -1, 0 ou 1)\n    } else {\n      signe = Number(valeurs) < 0 ? true : Boolean(signe) // on teste si elle est ngative, si oui, on force la case signe pour AMC\n    }\n  }\n  params.signe = signe\n\n  // @fixme reponses est un array ! toujours. Normalement, il ne devrait y avoir qu'une seule goodAnswer dedans, mais avant, on n'avait pas d'autres moyens pour verifier les saisies diverses\n  const reponse: LegacyReponse = (\n    reponses as Array<LegacyReponse>\n  )[0] as LegacyReponse // reponse est la premire d'entre elles (ou la seule)\n\n  // en contexte d'export AMC, on ne touche pas  l'existant\n  if (context.isAmc) {\n    let laReponseDemandee: LegacyReponse\n    switch (formatInteractif) {\n      case 'tableauMathlive':\n        //   if (reponses.filter((cellule) => Object.keys(cellule)[0].match(/L\\dC\\d/).length === 0).length !== 0) {\n        //    window.notify('setReponse : type \"tableauMathlive\" les objets proposs n\\'ont pas tous une cl de la forme L$C$', { reponses, exercice: exercice.uuid })\n        //  }\n        break\n      case 'fillInTheBlank':\n        break\n      case 'Num':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Num\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        } else if (Number.isNaN(reponse.num) || Number.isNaN(reponse.den)) {\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        break\n      case 'Den':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Den\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        break\n      case 'calcul':\n        laReponseDemandee = reponse\n        if (typeof laReponseDemandee === 'string') {\n          laReponseDemandee = laReponseDemandee.replaceAll('dfrac', 'frac')\n        }\n        if (\n          typeof laReponseDemandee === 'number' ||\n          typeof laReponseDemandee === 'string'\n        ) {\n          laReponseDemandee = laReponseDemandee\n            .toString()\n            .replace(/\\s/g, '')\n            .replace(',', '.')\n        }\n        break\n      /* case 'nombreDecimal':\n        if (!(reponse instanceof Decimal)) {\n          window.notify(\n            'setReponse : type \"nombreDecimal\" un nombre est attendu !',\n            { reponses, exercice: exercice.uuid }\n          )\n        }\n        break */\n      /* case 'ecritureScientifique':\n        if (!(typeof reponse === 'string')) {\n          window.notify(\n            'setReponse : type \"ecritureScientifique\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid }\n          )\n        }\n        // ToFix : vrifier que la chaine est au bon format\n        break */\n\n      case 'texte':\n        if (!(typeof reponse === 'string')) {\n          window.notify(\n            'setReponse : type \"texte\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        break\n\n      case 'ignorerCasse':\n        if (!(typeof reponse === 'string')) {\n          window.notify(\n            'setReponse : type \"ignorerCasse\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        break\n\n      case 'fractionEgale':\n        if (!(reponse instanceof FractionEtendue))\n          window.notify(\n            'setReponse : type \"fractionEgale\" une fraction est attendue !',\n            { reponses, exercice: exercice.uuid },\n          )\n        else if (isNaN(reponse.num) || isNaN(reponse.den))\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        break\n\n      case 'unites': // Pour les exercices o l'on attend une mesure avec une unit au choix\n        if (!(reponse instanceof Grandeur)) {\n          window.notify(\n            'setReponse : type \"longueur\" la rponse n\\'est pas une instance de Grandeur !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        break\n      case 'intervalleStrict': // Pour les exercice o la saisie doit tre dans un intervalle\n        // ToFix : vrifier que la rponse est bien un intervalle valide\n        break\n      case 'intervalle':\n        // ToFix : vrifier que la rponse est bien un intervalle valide\n        break\n      case 'puissance':\n        // ToFix : vrifier que la rponse est bien l'criture d'une puissance ou en tout cas une rponse acceptable pour ce format\n        break\n      case 'canonicalAdd':\n        //  priori ce format ne concerne pas AMC\n        break\n    }\n\n    if (exercice.autoCorrection[i] === undefined) {\n      exercice.autoCorrection[i] = {}\n    }\n    if (exercice.autoCorrection[i].reponse === undefined) {\n      exercice.autoCorrection[i].reponse = {}\n    }\n    const rep = exercice.autoCorrection[i].reponse\n    if (rep != null) {\n      rep.param = params\n      // @ts-expect-error Pour AMC on ne change pas le format de rponse\n      rep.valeur = reponses // On n'a rien chang pour AMC, on continue de passer un array dont seule la premire valeur est utile\n    }\n    return // La rponse est prte pour AMC\n  }\n  // Ici on est en context non Amc, donc s'il y a un setReponse, c'est pour html interactif.\n  // On va transformer le l'objetReponse pour handleAnswers(), il n'y\n  let laReponseDemandee: LegacyReponse\n  if (exercice != null) {\n    params.formatInteractif = 'mathlive'\n    switch (formatInteractif) {\n      case 'listeDeroulante': {\n        if (exercice.autoCorrection == null) exercice.autoCorrection = []\n        if (exercice.autoCorrection[i] == null) exercice.autoCorrection[i] = {}\n        if (exercice.autoCorrection[i].reponse == null) {\n          exercice.autoCorrection[i].reponse = {}\n        }\n        const rep = exercice.autoCorrection[i].reponse\n        if (rep != null) {\n          if (rep.valeur == null) rep.valeur = {}\n          if (rep.valeur.reponse == null) rep.valeur.reponse = { value: '' }\n          if (rep.param == null) rep.param = {}\n          rep.param.formatInteractif = 'listeDeroulante'\n          Object.assign(rep.valeur.reponse.value, reponses)\n        }\n        return\n      }\n      case 'Num':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Num\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        } else if (Number.isNaN(reponse.num) || Number.isNaN(reponse.den)) {\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: String((reponse as FractionEtendue).num),\n              //  compare: numberCompare\n              compare: fonctionComparaison,\n            },\n          },\n          params,\n        )\n\n      case 'Den':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Den\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: String((reponse as FractionEtendue).den),\n              //  compare: numberCompare\n              compare: fonctionComparaison,\n            },\n          },\n          params,\n        )\n\n      case 'calcul': {\n        if (reponses.length === 1) {\n          laReponseDemandee = reponse\n          if (typeof laReponseDemandee === 'string') {\n            laReponseDemandee = laReponseDemandee\n              .replaceAll('dfrac', 'frac')\n              .replace(/\\s/g, '')\n              .replace(',', '.')\n          }\n          // Ceci n'est plus ncessaire avec le wrapper de hanfleAnswer\n          /* else if (typeof laReponseDemandee === 'number') {\n            laReponseDemandee = String(laReponseDemandee)\n          } else if (laReponseDemandee instanceof FractionEtendue) {\n            laReponseDemandee = laReponseDemandee.texFraction.replaceAll(\n              'dfrac',\n              'frac'\n            )\n          } else if (laReponseDemandee instanceof Decimal) {\n            laReponseDemandee = laReponseDemandee.toString()\n          } */\n          return handleAnswers(\n            exercice,\n            i,\n            {\n              reponse: {\n                value: laReponseDemandee,\n                compare: fonctionComparaison,\n              },\n            },\n            params,\n          )\n        }\n        const value: string[] = []\n        for (let i = 0; i < reponses.length; i++) {\n          laReponseDemandee = reponses[i]\n          if (typeof laReponseDemandee === 'string') {\n            laReponseDemandee = laReponseDemandee\n              .replaceAll('dfrac', 'frac')\n              .replace(/\\s/g, '')\n              .replace(',', '.')\n          } else if (typeof laReponseDemandee === 'number') {\n            laReponseDemandee = String(laReponseDemandee)\n          } else if (laReponseDemandee instanceof FractionEtendue) {\n            laReponseDemandee = laReponseDemandee.texFraction.replaceAll(\n              'dfrac',\n              'frac',\n            )\n          } else if (laReponseDemandee instanceof Decimal) {\n            laReponseDemandee = laReponseDemandee.toString()\n          }\n          value.push(laReponseDemandee as string)\n        }\n\n        return handleAnswers(\n          exercice,\n          i,\n          { reponse: { value, compare: fonctionComparaison } },\n          params,\n        )\n      }\n\n      case 'texte':\n        if (typeof reponse !== 'string') {\n          window.notify(\n            'setReponse : type \"texte\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: Array.isArray(reponses)\n                ? reponses.map(String)\n                : String(reponses),\n              compare: fonctionComparaison,\n              options: { texteAvecCasse: true },\n            },\n          },\n          params,\n        )\n\n      case 'ignorerCasse':\n        if (typeof reponse !== 'string') {\n          window.notify(\n            'setReponse : type \"ignorerCasse\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: Array.isArray(reponses)\n                ? reponses.map((el) => String(el).toLowerCase())\n                : String(reponses).toLowerCase(),\n              // compare: texteSansCasseCompare\n              compare: fonctionComparaison,\n              options: { texteSansCasse: true },\n            },\n          },\n          params,\n        )\n\n      case 'fractionEgale':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify(\n            'setReponse : type \"fractionEgale\" une fraction est attendue !',\n            { reponses, exercice: exercice.uuid },\n          )\n        } else if (Number.isNaN(reponse.num) || Number.isNaN(reponse.den)) {\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        if (Array.isArray(reponse)) {\n          window.notify(\n            \"setReponse a reu une liste de rponse pour le format fractionEgale, c'est incohrent !\",\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        if (reponse instanceof FractionEtendue) {\n          return handleAnswers(\n            exercice,\n            i,\n            {\n              reponse: {\n                value: reponse, // reponse.texFraction.replace('dfrac', 'frac') plus ncessaire : le wrapper de handleAnswers s'en occupe\n                compare: fonctionComparaison,\n              },\n            },\n            params,\n          )\n        }\n        break\n\n      case 'unites': // Pour les exercices o l'on attend une mesure avec une unit au choix\n        if (precision == null) precision = 0 // Des exercices utilisent le format 'unites' mais ne dfinissent pas la prcision\n        if (!(reponse instanceof Grandeur)) {\n          window.notify(\n            'setReponse : type \"longueur\" la rponse n\\'est pas une instance de Grandeur !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        if (reponse instanceof Grandeur) {\n          return handleAnswers(\n            exercice,\n            i,\n            {\n              reponse: {\n                value: reponse, // .toString().replace('\\u202f', '') plus ncessaire grce au wrapper de handleAnswers\n                compare: fonctionComparaison,\n                options: {\n                  unite: true,\n                  precisionUnite:\n                    10 ** precision *\n                    10 ** (reponse.puissanceUnite * reponse.puissancePrefixe),\n                },\n              },\n            },\n            params,\n          )\n        }\n        break\n      case 'intervalleStrict': // Pour les exercice o la saisie doit tre dans un intervalle\n        if (\n          reponses.length !== 2 ||\n          reponses.filter((el) => typeof el !== 'number').length !== 0\n        ) {\n          window.notify(\n            'setReponse : type \"intervalle\" la rponse n\\'est pas un tupple [number,number] !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: `]${reponses[0]};${reponses[1]}[`,\n              compare: fonctionComparaison,\n              options: { estDansIntervalle: true },\n            },\n          },\n          params,\n        )\n      case 'intervalle':\n        if (\n          !Array.isArray(reponses) ||\n          reponses.length !== 2 ||\n          reponses.filter((el) => typeof el !== 'number').length !== 0\n        ) {\n          window.notify(\n            'setReponse : type \"intervalle\" la rponse n\\'est pas un tupple [number,number] !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: `[${reponses[0]};${reponses[1]}]`,\n              compare: fonctionComparaison,\n              options: { estDansIntervalle: true },\n            },\n          },\n          params,\n        )\n      case 'puissance':\n        if (typeof reponse !== 'string') {\n          window.notify(\n            'setReponse : type \"puissance\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: String(reponse),\n              // compare: powerCompare\n              compare: fonctionComparaison,\n              options: { puissance: true },\n            },\n          },\n          params,\n        )\n    }\n  }\n\n  if (exercice.autoCorrection[i] === undefined) {\n    exercice.autoCorrection[i] = {}\n  }\n  if (exercice.autoCorrection[i].reponse === undefined) {\n    exercice.autoCorrection[i].reponse = {}\n  }\n  const rep = exercice.autoCorrection[i].reponse\n  if (rep != null) {\n    rep.param = params\n    rep.valeur = reponses as unknown as ValeurNormalized\n  }\n}\n\n// La solution est-elle un nombre ? Si oui, on force l'option nombreDecimalSeulement.\nfunction isValidNumber(value: any): boolean {\n  // Convertir la valeur en chane et remplacer les sparateurs de milliers (par exemple, '{,}')\n  const cleanedValue = String(value)\n    .replace(/{,}/g, '') // Enlve les caractres '{,}' (sparateurs de milliers comme dans \"1{,}5\")\n    .replace(',', '.') // Remplace la virgule par un point pour les dcimales\n  // Vrifier que la chane ne contient que des chiffres et un seul sparateur dcimal (point ou virgule)\n  // Ou un nombre javascript crit dans tous les formats supports\n  // const validNumberPattern = /^[+-]?(\\d*(\\.\\d*)?([eE][+-]?\\d*)?|0[xX][0-9a-fA-F]*|0[bB][01]*)$/\n  const validNumberPattern = /^[+-]?\\d+(.\\d+)?$/\n\n  // Vrifier si la chane nettoye correspond  un nombre valide\n  return validNumberPattern.test(cleanedValue)\n}\n\nfunction handleDefaultValeur(reponse: Valeur): ValeurNormalized {\n  for (const [, val] of Object.entries(reponse)) {\n    if (val !== undefined) {\n      if (val?.value !== undefined) {\n        if (Array.isArray(val.value)) {\n          for (let i = 0; i < val.value.length; i++) {\n            if (typeof val.value[i] === 'string') continue\n            if (\n              val.value[i] instanceof Decimal ||\n              val.value[i] instanceof Grandeur ||\n              val.value[i] instanceof Hms ||\n              typeof val.value[i] === 'number'\n            ) {\n              val.value[i] = val.value[i].toString()\n            }\n            if (val.value[i] instanceof FractionEtendue)\n              val.value[i] = val.value[i].texFraction\n          }\n        } else {\n          if (typeof val.value === 'string') continue\n          if (\n            val.value instanceof Decimal ||\n            val.value instanceof Grandeur ||\n            val.value instanceof Hms ||\n            typeof val.value === 'number'\n          ) {\n            val.value = val.value.toString()\n          }\n          if (val.value instanceof FractionEtendue)\n            val.value = val.value.texFraction\n        }\n      }\n\n      if (val.compare === undefined) val.compare = fonctionComparaison\n      if (val.options === undefined || Object.keys(val.options).length === 0) {\n        let reponseAttendueEstUnNombre: boolean\n        if (Array.isArray(val.value)) {\n          reponseAttendueEstUnNombre = true\n          for (let ee = 0; ee < val.value.length; ee++) {\n            reponseAttendueEstUnNombre &&= isValidNumber(val.value[ee])\n          }\n        } else {\n          reponseAttendueEstUnNombre = isValidNumber(val.value)\n        }\n        const options = reponseAttendueEstUnNombre\n          ? { nombreDecimalSeulement: true }\n          : {}\n        val.options = options\n      }\n    }\n  }\n  return reponse as ValeurNormalized // La normalisation consiste  transformer toute value en string et c'est fait maintenant par cette fonction\n}\n\n/**\n * La fonction  privilgier  partir de maintenant.\n * @param {Exercice} exercice\n * @param {number} question\n * @param {AnswerType} reponses\n * @param {ReponseParams} params\n */\nexport function handleAnswers(\n  exercice: IExercice,\n  question: number,\n  reponses: Valeur,\n  params: ReponseParams | undefined = {},\n) {\n  if (context.isAmc) {\n    // handleAnswer ne s'occupe pas de l'export AMC\n    return\n  }\n  let formatInteractif =\n    params?.formatInteractif ??\n    exercice.autoCorrection[question]?.reponse?.param?.formatInteractif ??\n    'mathlive'\n  if (exercice.autoCorrection == null) exercice.autoCorrection = []\n  if (!(reponses instanceof Object)) {\n    window.notify(`handleAnswer() reponses doit tre un objet : ${reponses}`, {\n      reponses,\n      exercice: exercice.uuid,\n    })\n  }\n\n  if (exercice.autoCorrection[question] === undefined) {\n    exercice.autoCorrection[question] = {}\n  }\n  if (exercice.autoCorrection[question].reponse === undefined) {\n    exercice.autoCorrection[question].reponse = {}\n  }\n  const rep = exercice.autoCorrection[question].reponse\n  if (rep != null) {\n    rep.param = params ?? { formatInteractif }\n    if (formatInteractif === undefined) formatInteractif = 'mathlive'\n    rep.param.formatInteractif = formatInteractif\n    rep.valeur = handleDefaultValeur(reponses)\n  }\n  const url = new URL(window.location.href)\n\n  if (url.hostname === 'localhost' && url.searchParams.has('triche')) {\n    console.info(\n      `Rponses de l'exercice ${(exercice.numeroExercice ?? 0) + 1} - question ${question + 1} : `,\n      rep.valeur,\n    )\n  }\n}\n\nfunction verifQuestionMetaInteractif2d(\n  exercice: IExercice,\n  i: number,\n): {\n  isOk: boolean\n  feedback: string\n  score: { nbBonnesReponses: number; nbReponses: number }\n} {\n  const eltFeedback = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  ) as HTMLSpanElement\n  if (eltFeedback) {\n    setStyles(eltFeedback, 'marginBottom: 20px')\n    eltFeedback.innerHTML = ''\n  }\n  if (exercice.autoCorrection[i]?.reponse == null) {\n    throw Error(\n      `verifQuestionMetaInteractif2d appel sur une question sans rponse: ${JSON.stringify(\n        {\n          exercice,\n          question: i,\n          autoCorrection: exercice.autoCorrection[i],\n        },\n      )}`,\n    )\n  }\n  const reponses = exercice.autoCorrection[i].reponse.valeur\n  if (reponses == null) {\n    window.notify(\n      `verifQuestionMathlive: reponses est null pour la question ${i} de l'exercice ${exercice.id}`,\n      { exercice, i },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n  const bareme: (arg: number[]) => [number, number] =\n    reponses.bareme ?? toutPourUnPoint\n  const variables = Object.entries(reponses).filter(\n    ([key]) => key !== 'bareme' && key !== 'feedback',\n  )\n  const points = []\n  const saisies: Record<string, string> = {}\n  let feedback = ''\n  let compteurSaisiesVides = 0\n  let compteurBonnesReponses = 0\n  let noFeedback = false\n  for (const [field, reponse] of variables) {\n    const options = reponse.options\n    noFeedback = noFeedback || Boolean(options?.noFeedback)\n    const compareFunction = reponse.compare ?? fonctionComparaison\n    const index = parseInt(field.replace('field', ''), 10)\n    const mf = document.querySelector(\n      `#MetaInteractif2dEx${exercice.numeroExercice}Q${i}field${index}`,\n    ) as MathfieldElement\n    const saisie = mf.getPromptValue('champ1')\n    if (saisie === '') {\n      compteurSaisiesVides++\n      mf.classList.add('corrected')\n      points.push(0)\n      continue\n    }\n    saisies[`MetaInteractif2dEx${exercice.numeroExercice}Q${i}${field}`] =\n      saisie\n    let result\n    if (Array.isArray(reponse.value)) {\n      let ii = 0\n      while (!result?.isOk && ii < reponse.value.length) {\n        result = compareFunction(saisie, reponse.value[ii], options)\n        ii++\n      }\n    } else {\n      result = compareFunction(saisie, reponse.value, options)\n    }\n    if (result.isOk) {\n      compteurBonnesReponses++\n      points.push(1)\n      mf.setPromptState('champ1', 'correct', true)\n    } else {\n      points.push(0)\n      mf.setPromptState('champ1', 'incorrect', true)\n      if (result.feedback === 'saisieVide') result.feedback = null\n      else {\n        result = {\n          isOk: false,\n          feedback: '',\n        }\n      }\n    }\n    mf.classList.add('corrected')\n    if (result.feedback != null) feedback += result.feedback\n  }\n\n  if (compteurBonnesReponses === variables.length) {\n    feedback = ''\n  } else {\n    if (compteurSaisiesVides > 0) {\n      feedback = `Il manque ${compteurSaisiesVides} rponse(s).`\n    } else {\n      feedback = `Certaines rponses sont incorrectes.`\n    }\n  }\n\n  const [nbBonnesReponses, nbReponses] = bareme(points)\n  const spanReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  ) as HTMLSpanElement\n  if (spanReponseLigne != null) {\n    spanReponseLigne.innerHTML = nbBonnesReponses === nbReponses ? '' : ''\n  }\n  if (typeof exercice.answers === 'object' && exercice.answers !== null) {\n    exercice.answers[`MetaInteractif2dEx${exercice.numeroExercice}Q${i}`] =\n      JSON.stringify(saisies)\n  }\n\n  // le feedback est dj assur par la fonction feedback(), donc on le met  ''\n  return {\n    isOk: nbBonnesReponses === nbReponses,\n    feedback: noFeedback ? '' : feedback,\n    score: { nbBonnesReponses, nbReponses },\n  }\n}\n","/**\n * Afficher un cran (lment <dialog>) pendant un nombre de millisecondes\n * @param {string} dialogId id de l'lment <dialog>  activer\n * @param {number} nbOfMilliseconds dure de l'affichage en ms\n */\nexport async function showDialogForLimitedTime(\n  dialogId: string,\n  nbOfMilliseconds: number,\n  innerHTML = '',\n) {\n  const dialog = document.getElementById(dialogId) as HTMLDialogElement\n  if (dialog) {\n    if (innerHTML !== '') dialog.innerHTML = innerHTML\n    dialog.showModal()\n    await sleep(nbOfMilliseconds)\n    dialog.close()\n  }\n}\n\n/**\n * Faire une pause pendant l'excution d'un programme\n * {@link https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep?page=1&tab=scoredesc#tab-top | Source}\n * @param {number} ms nb de millisecondes de la pause\n * @author sylvain\n */\nconst sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms))\n\n/**\n * popup pour demander  l'utilisateur de rafrachir la page\n * car le serveur a t mis  jour.\n */\nexport function showPopupAndWait(): Promise<void> {\n  return new Promise((resolve) => {\n    const popup = document.createElement('div')\n    popup.style.position = 'fixed'\n    popup.style.top = '50%'\n    popup.style.left = '50%'\n    popup.style.transform = 'translate(-50%, -50%)'\n    popup.style.padding = '20px'\n    popup.style.backgroundColor = 'white'\n    popup.style.border = '1px solid black'\n    popup.style.zIndex = '10000'\n\n    const message = document.createElement('p')\n    message.textContent =\n      'Le serveur a t mis  jour. Veuillez actualiser la page.'\n    popup.appendChild(message)\n\n    const refreshButton = document.createElement('button')\n    refreshButton.textContent = 'Actualiser'\n    refreshButton.style.marginRight = '10px'\n    refreshButton.style.padding = '10px 20px'\n    refreshButton.style.backgroundColor = '#f0f0f0'\n    refreshButton.style.border = '1px solid #ccc'\n    refreshButton.style.borderRadius = '5px'\n    refreshButton.style.cursor = 'pointer'\n    refreshButton.onclick = () => {\n      window.location.reload()\n    }\n    popup.appendChild(refreshButton)\n\n    const closeButton = document.createElement('button')\n    closeButton.textContent = 'Fermer'\n    closeButton.style.marginRight = '10px'\n    closeButton.style.padding = '10px 20px'\n    closeButton.style.backgroundColor = '#f0f0f0'\n    closeButton.style.border = '1px solid #ccc'\n    closeButton.style.borderRadius = '5px'\n    closeButton.style.cursor = 'pointer'\n    closeButton.onclick = () => {\n      document.body.removeChild(popup)\n      resolve()\n    }\n    popup.appendChild(closeButton)\n    document.body.appendChild(popup)\n  })\n}\n","import type { InterfaceParams } from './types'\n\nexport function createURL(params: InterfaceParams[]) {\n  const url = new URL(\n    window.location.protocol +\n      '//' +\n      window.location.host +\n      window.location.pathname,\n  )\n  for (const ex of params) {\n    url.searchParams.append('uuid', ex.uuid)\n    if (ex.id != null) url.searchParams.append('id', ex.id)\n    if (ex.nbQuestions != null)\n      url.searchParams.append('n', ex.nbQuestions.toString())\n    if (ex.duration != null)\n      url.searchParams.append('d', ex.duration.toString())\n    if (ex.sup != null) url.searchParams.append('s', ex.sup)\n    if (ex.sup2 != null) url.searchParams.append('s2', ex.sup2)\n    if (ex.sup3 != null) url.searchParams.append('s3', ex.sup3)\n    if (ex.sup4 != null) url.searchParams.append('s4', ex.sup4)\n    if (ex.sup5 != null) url.searchParams.append('s5', ex.sup5)\n    if (ex.versionQcm != null) url.searchParams.append('qcm', ex.versionQcm)\n    if (ex.interactif === '1') url.searchParams.append('i', '1')\n    if (ex.cd != null) url.searchParams.append('cd', ex.cd)\n    if (ex.cols != null) url.searchParams.append('cols', ex.cols.toString())\n    if (ex.alea != null) url.searchParams.append('alea', ex.alea)\n  }\n  return url\n}\n","import { writable } from 'svelte/store'\nimport type { CanOptions } from '../types/can'\nexport const canOptions = writable<CanOptions>({\n  durationInMinutes: 4,\n  subTitle: new Date().getFullYear().toString(),\n  isChoosen: false,\n  solutionsAccess: false,\n  solutionsMode: 'gathered',\n  isInteractive: false,\n  remainingTimeInSeconds: 0,\n  questionGetAnswer: [],\n  state: 'start',\n})\n","import type TypeExercice from '../exercices/Exercice'\n\nwindow.logDebug = window.logDebug || 0\n\nconst url = new URL(window.location.href)\nconst debug =\n  url.searchParams.get('log') === '3' || window.logDebug !== 0 ? 1 : 0\n\nexport function log(message?: any, ...optionalParams: any[]) {\n  if (debug) {\n    console.info(message, ...optionalParams)\n  }\n}\n\nexport function logDebug(message?: any, ...optionalParams: any[]) {\n  if (debug > 1 || window.logDebug > 1)\n    log('DEBUG:', message, ...optionalParams)\n}\n\nexport function statsTracker(\n  exercise: TypeExercice,\n  recorder: string,\n  vue: string,\n  isreview: 'review' | '',\n) {\n  logDebug('Tracking stats...')\n  if (window._paq && isreview === '') {\n    window._paq.push([\n      'trackEvent',\n      'CheckExo',\n      vue + '-' + exercise.uuid + (recorder ? '-' + recorder : ''),\n    ])\n  }\n  log(\n    'CheckExo',\n    vue +\n      '-' +\n      exercise.uuid +\n      (recorder ? '-' + recorder : '') +\n      (isreview ? '-review' : ''),\n  )\n}\n\nlet oldUrl = ''\n\nexport function statsPageTracker() {\n  logDebug('Tracking pages...')\n  // Informer Matomo\n  if (window.location.href !== oldUrl) {\n    if (window._paq)\n      window._paq.push([\n        'trackEvent',\n        'PageTracking',\n        'VisitedURL',\n        window.location.href,\n      ])\n    oldUrl = window.location.href\n    log('statsPageTracker called with URL:', window.location.href)\n  }\n}\n\n/*\n// Exemple\nconst list1 = ['A', 'B', 'B', 'C', 'C', 'D']\nconst list2 = ['A', 'A', 'D', 'C', 'D', 'D', 'B']\n\nconsole.log(getIntrus(list1, list2))\n Rsultat :\njs\nCopier\nModifier\n[\n  { value: 'A', difference: -1 }, // 1 de trop dans list2\n  { value: 'B', difference: 0 },  // OK\n  { value: 'C', difference: 1 },  // 1 de trop dans list1\n  { value: 'D', difference: -2 }  // 2 de trop dans list2\n]\n  */\n\nexport function getIntrus(list1: string[], list2: string[]) {\n  interface CountMap {\n    [key: string]: number\n  }\n\n  const count = (arr: string[]): CountMap =>\n    arr.reduce((acc: CountMap, val: string) => {\n      acc[val] = (acc[val] || 0) + 1\n      return acc\n    }, {})\n\n  const count1 = count(list1)\n  const count2 = count(list2)\n\n  const allKeys = new Set([...Object.keys(count1), ...Object.keys(count2)])\n  const intrus = []\n\n  for (const key of allKeys) {\n    const diff = (count1[key] || 0) - (count2[key] || 0)\n    if (diff !== 0) {\n      intrus.push({ value: key, difference: diff })\n    }\n  }\n\n  return intrus\n}\n","import { writable } from 'svelte/store'\nimport type { InterfaceGlobalOptions } from '../types'\n\n/**\n * * `v`: vue\n * * `z`: zoom\n * * `title` : titre pour la vue lve uniquement\n * * `presMode` : type d'affichage pour la vue eleve uniquement (page, exos, liste, questions)\n * * `setInteractive` : uniquement pour la vue eleve (0 : pas d'interactivit, 1 : tout interactif, 2 : au choix exercice par exercice)\n * * `isSolutionAccessible` : uniquement pour la vue eleve, pour savoir si les corrections sont disponibles ou pas\n * * `isInteractiveFree` : uniquement pour la vue eleve, pour savoir si l'lve peut changer l'interactivit ou pas\n * * `oneShot` : uniquement pour la vue eleve, pour savoir si l'lve peut rpondre une ou plusieurs fois en interactif.\n * * `twoColumns` : dans les vues lves avec tous les exercices/questions sur une mme page, on adopte la prsentation du texte sur deux colonnes\n *\n * `globalOptions` est utilis dans `Mathalea.updateUrl()` et dans `Mathalea.loadExercicesFromUrl()`\n * Il permet de sauvegarder le type de vue (`v=...`)\n *\n * Le paramtre `es` est utilis pour renseigner les rglages de la vue lve :\n * une unique chane de caractres contient dans l'ordre : titre + mode prsentation + interactivit +  accs solutions + affichage deux colonnes\n */\n\nexport const globalOptions = writable<InterfaceGlobalOptions>({\n  v: undefined,\n  z: '1',\n  title: 'valuation',\n  presMode: 'liste_exos',\n  setInteractive: '2',\n  isSolutionAccessible: true,\n  isInteractiveFree: true,\n  isTitleDisplayed: true,\n  oneShot: false,\n  twoColumns: false,\n  beta: false,\n  lang: 'fr-FR',\n})\n","import { get } from 'svelte/store'\nimport { globalOptions } from '../stores/globalOptions'\n\nexport function buildDsParams(): string {\n  let ds = ''\n  const options = get(globalOptions)\n  ds += options.nbVues?.toString() ?? '1'\n  ds += options.flow?.toString() ?? '0'\n  ds += options.screenBetweenSlides ? '1' : '0'\n  ds += options.sound?.toString() ?? '0'\n  ds += options.shuffle ? '1' : '0'\n  ds += options.manualMode ? '1' : '0'\n  ds += options.pauseAfterEachQuestion ? '1' : '0'\n  ds += options.isImagesOnSides ? '1' : '0'\n  return ds\n}\n","import type { FrenchDateString } from './dates'\nimport codeList from '../../json/codeToLevelList.json'\nimport referentielsActivationList from '../../json/referentielsActivation.json'\n// ===========================================================================\n//\n//    Types des bouts de chanes des rfrentiels (les donnes des exercices)\n//\n// ===========================================================================\nexport const EXAMS = ['dnb', 'dnbpro', 'bac', 'crpe', 'e3c', 'evacom']\nexport type Level = keyof typeof codeList | 'alea'\nexport type ActivationName = keyof typeof referentielsActivationList\n/**\n * Paramtres d'une fonctionnalit\n * @interface FeatureParams\n * @property {string} type : mot cl dcrivant le type de l'interactivit\n * @property {boolean} isActive : flag pour savoir si la fonctionnalit est active ou pas\n */\nexport interface FeatureParams {\n  type: string\n  isActive: boolean\n}\n\n/**\n * Fonctionnalits supplmentaires d'un exercice.\n * @remark **Au 2024-11-03, ces fonctionnalits sont au nombre de trois seulement**\n * @interface Features\n * @property {FeatureParams} interactif : interactivit dans l'exercice\n * @property {FeatureParams} amc : possibilit d'exportation pour utilisation dans AMC\n * @property {FeatureParams} qcm : possibilit d'exportation pour utilisation dans AMC\n */\nexport interface Features {\n  interactif?: FeatureParams\n  amc?: FeatureParams\n  qcm?: FeatureParams\n  qcmcam?: FeatureParams\n}\n\n/**\n * Description d'une application tierce\n * @interface AppTierce\n * @property {string} uuid : identifiant unique gnr dfinitivement par le moteur  la cration de l'exercice\n * @property {tring} title : titre de l'application\n * @property {string} presentation : texte bref expliquant les intentions de l'application\n * @property {string} imgPath : chemin vers le fichier image dans l'arborescence\n */\nexport interface AppTierce {\n  uuid: string\n  title: string\n  presentation: string\n  imgPath: string\n}\n\n/**\n * Groupe d'applications tierces lies par une provenance\n * @interface AppTierceGroup\n * @property {string} rubrique : titre de la rubrique sous laquelle sont regroupes les applications\n * @property {AppTierce[]} liste : liste des applications dans le groupe\n */\nexport interface AppTierceGroup {\n  rubrique: string\n  liste: AppTierce[]\n}\n\n/**\n * Tous les type de ressources disponibles dans un rfrentiel\n */\nexport type ExerciseType =\n  | 'alea'\n  | 'dnb'\n  | 'dnbpro'\n  | 'crpe'\n  | 'bac'\n  | 'simple'\n  | 'html'\n  | 'svelte'\n  | 'e3c'\n  | 'evacom'\n  | 'outil'\n  | 'tierce'\n  | 'static'\n\n/**\n * Description d'un objet de base dans un reerentiel de ressources\n * @interface BaseItemInReferentiel\n * @property {string} uuid : identifiant unique gnr dfinitivement par le moteur  la cration de l'exercice\n * @property {string[]} tags : listes de toutes les tiquettes marquant les sujets couverts par la ressource\n * @property {ExerciseType} typeExercice : catgorie de la ressource\n */\nexport interface BaseItemInReferentiel {\n  uuid: string\n  tags: string[]\n  typeExercice: ExerciseType\n}\n\n/**\n * Description d'une ressource d'un exercice CRPE dans un rfrentiel\n * @interface crpeItemInreferentiel\n * @extends BaseItemInReferentiel\n * @property {string[]} png : liste des chemins vers les images des contenus de la ressource\n * @property {string[]} pngCor : liste des chemins vers les images des correction des contenus de la ressource\n * @property {string} tex: chemin vers le source LaTeX du contenu\n * @property {string} texCor: chemin vers le source LaTeX de la correction du contenu\n */\nexport interface crpeItemInreferentiel extends BaseItemInReferentiel {\n  png: string[]\n  pngCor: string[]\n  tex?: string\n  texCor?: string\n  annee: string\n  lieu: string\n  numeroInitial: string\n  typeExercice: 'crpe'\n}\n\n/**\n * Description d'une ressource statique dans un rfrentiel\n * @interface StaticItemInreferentiel\n * @extends BaseItemInReferentiel\n * @property {string[]} png : liste des chemins vers les images des contenus de la ressource\n * @property {string[]} pngCor : liste des chemins vers les images des correction des contenus de la ressource\n * @property {string} tex: chemin vers le source LaTeX du contenu\n * @property {string} texCor: chemin vers le source LaTeX de la correction du contenu\n */\nexport interface StaticItemInreferentiel extends BaseItemInReferentiel {\n  png: string\n  pngCor: string\n  tex: string\n  texCor: string\n  typeExercice: 'static' | 'dnb' | 'dnbpro' | 'bac' | 'e3c' | 'evacom'\n}\n\n/**\n * Description d'une ressource venant un examen dans un rfrentiel\n * @interface ExamItemInReferentiel\n * @extends StaticItemInreferentiel\n * @property {string|undefined} mois : mois de la publication de l'examen (optionnel)\n * @property {string} annee : anne de la publication de l'examen\n * @property {string} lieu : endroit o a t diffus l'examen\n * @property {string} numeroInitial : numrode positionnement de l'exercice dans le sujet initial de l'examen\n */\nexport interface ExamItemInReferentiel extends StaticItemInreferentiel {\n  mois?: string\n  annee: string\n  lieu: string\n  numeroInitial: string\n  jour?: 'J1' | 'J2'\n  typeExercice: 'dnb' | 'dnbpro' | 'bac'\n}\n\n/**\n * Description dans un rfrentiel d'un exercice MathALA typique\n * @interface ExerciceItemInReferentiel\n * @extends BaseItemInReferentiel\n * @property {string} url : chemin vers les sources javascript de l'exercice\n * @property {string} id : identifiant provenant du rfrentiel de classification des comptences (diffrent de `uuid`)\n * @property {Feature[]} features : liste des fonctionnalits supplmentaires de l'exercice (`interactif` et/ou `amc`)\n * @property {string} datePublication : date de la publication de l'exercice (optionnel)\n * @property {string} dateModification : date de la *dernire* modification de l'exercice (optionnel)\n */\nexport interface ExerciceItemInReferentiel extends BaseItemInReferentiel {\n  url: string\n  id: string\n  titre: string\n  features: Features\n  datePublication?: FrenchDateString\n  dateModification?: FrenchDateString\n  typeExercice: 'alea'\n}\n\nexport interface ToolItemInReferentiel extends BaseItemInReferentiel {\n  url: string\n  id: string\n  titre: string\n  typeExercice: 'outil' | 'html'\n}\n// ===========================================================================\n//\n//    Type pour les rfrentiels eux-mmes\n//\n// ===========================================================================\n\n/**\n * Type rcursif pour les rfrentiels eux-mmes : en rcuprant les JSON en import\n * on fabrique un objet dont le type est dfini ci-dessous. Les extrmits des imbrications\n * sont correspondent aux diffrents types de ressources dcrites ci-dessus.\n */\n// Type pour un objet situ en fin de rfrentiel\nexport type JSONReferentielEnding =\n  // | BaseItemInReferentiel  <-- pas de terminaison aussi basique\n  | StaticItemInreferentiel\n  | ExamItemInReferentiel\n  | ExerciceItemInReferentiel\n  | ToolItemInReferentiel\n// Type pour un rfrentiel complet\nexport interface JSONReferentielObject\n  extends Record<\n    string,\n    JSONReferentielEnding | JSONReferentielObject | string | string[] | Features\n  > {}\n// Type correspondant  une branche dstructure : chemin + terminaison (donnes de la ressource)\nexport type ResourceAndItsPath = {\n  resource: JSONReferentielEnding\n  pathToResource: string[]\n}\n// Type pour passer un rfrentiel au menu\nexport type ReferentielInMenu = {\n  title: string\n  name: ActivationName\n  searchable: boolean\n  referentiel: JSONReferentielObject\n}\n\n// ===========================================================================\n//\n//     Fonctions pour vrifier les types\n//\n// ===========================================================================\nexport const isExerciceItemInReferentiel = (\n  obj: any,\n): obj is ExerciceItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('uuid') &&\n  obj.uuid !== undefined &&\n  Object.keys(obj).includes('features') &&\n  obj.features !== undefined\n\nexport const isExamItemInReferentiel = (\n  obj: any,\n): obj is ExamItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('uuid') &&\n  obj.uuid !== undefined &&\n  Object.keys(obj).includes('annee') &&\n  obj.annee !== undefined\n\nexport const isJSONReferentielEnding = (\n  obj: any,\n): obj is JSONReferentielEnding =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('uuid') &&\n  obj.uuid !== undefined\n\nexport const isTool = (obj: any): obj is ToolItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('typeExercice') &&\n  (obj.typeExercice === 'outil' || obj.typeExercice === 'html')\n\nexport const resourceHasPlace = (\n  obj: any,\n): obj is ExamItemInReferentiel | crpeItemInreferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('lieu') &&\n  obj.lieu !== undefined\n\nexport const resourceHasMonth = (obj: any): obj is ExamItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('mois') &&\n  obj.mois !== undefined\n\nexport const isLevelType = (obj: any): obj is Level =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(codeList).includes(obj)\n\nexport const isFeatures = (obj: any): obj is Features => {\n  if (obj !== null && typeof obj !== 'undefined') {\n    return false\n  } else {\n    const keys = Object.keys(obj)\n    return keys.includes('interactif') || keys.includes('amc')\n  }\n}\n\n/**\n * Inspecte le type d'un objet et dtermine s'il c'est un tableau de chanes non vide ou pas\n * @see https://stackoverflow.com/a/50523378/6625987\n * @param value objet  examiner\n * @returns {boolean}\n */\nexport function isNonEmptyArrayOfStrings(value: unknown): value is string[] {\n  return (\n    Array.isArray(value) &&\n    value.length > 0 &&\n    value.every((item) => typeof item === 'string')\n  )\n}\n\nexport const isRealJSONReferentielObject = (obj: any): boolean => {\n  if (\n    typeof obj === 'string' ||\n    isNonEmptyArrayOfStrings(obj) ||\n    isFeatures(obj)\n  ) {\n    return false\n  } else {\n    return true\n  }\n}\n\nexport const isStaticType = (obj: any): obj is StaticItemInreferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('png') &&\n  obj.png !== undefined &&\n  !isNonEmptyArrayOfStrings(obj.png)\n\nexport const isCrpeType = (obj: any): obj is crpeItemInreferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('typeExercice') &&\n  obj.typeExercice !== undefined &&\n  obj.typeExercice === 'crpe'\n\nexport const isStaticWithoutPngUrl = (obj: any): obj is ExamItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  !Object.keys(obj).includes('png') &&\n  Object.keys(obj).includes('annee') &&\n  Object.keys(obj).includes('lieu') &&\n  Object.keys(obj).includes('typeExercice') &&\n  obj.annee !== undefined &&\n  obj.lieu !== undefined &&\n  (obj.typeExercice === 'sti2d' ||\n    obj.typeExercice === 'dnb' ||\n    obj.typeExercice === 'stl' ||\n    obj.typeExercice === 'dnbpro' ||\n    obj.typeExercice === 'eam' ||\n    obj.typeExercice === 'bac')\n\n/**\n * Dtecte si la terminaison d'un rfrentiel est un exercice de gomtrie dynamique ou pas.\n * On teste la prsence de la chaine `geodyn` en dbut d'url (si elle existe)\n * @param obj {JSONReferentielEnding} terminaison  tester\n * @returns `true` si la terminaison rfrence un exercice de gomtrie dynamique\n */\nexport const isGeoDynamic = (obj: JSONReferentielEnding): boolean => {\n  const geoDynRegExp = /^geodyn/\n  if (\n    obj !== null &&\n    typeof obj !== 'undefined' &&\n    Object.keys(obj).includes('url') &&\n    //  ce stade, on est sr que l'objet ne peu tpas tre de type StaticItemInreferentiel car il a la proprit `url`\n    (obj as Exclude<JSONReferentielEnding, StaticItemInreferentiel>).url !==\n      undefined &&\n    typeof (obj as Exclude<JSONReferentielEnding, StaticItemInreferentiel>)\n      .url === 'string' &&\n    (obj as Exclude<JSONReferentielEnding, StaticItemInreferentiel>).url.match(\n      geoDynRegExp,\n    ) !== null\n  ) {\n    return true\n  } else {\n    return false\n  }\n}\n","import { get, writable } from 'svelte/store'\nimport { statsPageTracker } from '../../modules/statsUtils'\nimport { buildDsParams } from '../components/buildDsParams'\nimport type {\n  InterfaceParams,\n  InterfaceResultExercice,\n  bibliothequeExercise,\n} from '../types'\nimport { type JSONReferentielEnding } from '../types/referentiels'\nimport type { VueType } from '../VueType'\nimport { canOptions } from './canStore'\nimport { globalOptions } from './globalOptions'\n\n/**\n * Pour bloquer la mise  jour de l'url\n */\nexport const freezeUrl = writable<boolean>(false)\n\n/**\n * Pour signaler que MathALA est dans une iframe\n */\nexport const isInIframe = writable<boolean>(false)\n\n/**\n * exercicesParams est un tableau d'objets dcrivant les exercices\n * {id, uuid, alea, interactif, cd, sup, sup2, sup3, sup4,sup5, n}\n */\nexport const exercicesParams = writable<InterfaceParams[]>([])\n\n// tenir le compte des changements dans la liste : ajout/retrait -> +1\nexport const changes = writable<number>(0)\n\n// pour indiquer qu'un rordonnancement est en cours (pour l'animation flip des exercices)\nexport const isReordering = writable<boolean>(false)\n\n// pour la gestion du mode sombre\nexport const darkMode = writable({ isActive: false })\n\nexport const capytaleMode = writable<\n  'none' | 'create' | 'assignment' | 'review' | 'view'\n>('none')\n\nexport const capytaleStudentAssignment = writable<InterfaceResultExercice[]>()\n\n// sauvegarde des rsultats des exercices\nexport const resultsByExercice = writable<InterfaceResultExercice[]>([])\n\n// vue lve : dtecter la ncessit d'un menu\nexport const isMenuNeededForExercises = writable<boolean>(false)\nexport const isMenuNeededForQuestions = writable<boolean>(false)\nexport const isSettingsMenuVisible = writable<boolean>(false)\nexport const isExportMenuVisible = writable<boolean>(false)\n\n// pour garder trace du statut d'ouverture du menu de choix\nexport const isSideMenuVisible = writable<boolean>(true)\n\n// pour garder trace de la page appelant l'export\nexport const previousView = writable<undefined | '' | VueType>(undefined)\n\n// pour sauvegarder l'objet correspondant  la rubrique choisie pour les exos statiques\nexport const bibliothequeSectionContent = writable<bibliothequeExercise[]>([])\nexport const bibliothequeDisplayedContent =\n  writable<Record<string, JSONReferentielEnding>>()\nexport const bibliothequePathToSection = writable<string[]>([])\n\n/**\n * Dplace un exercice dans exercicesParams\n */\nexport function moveExercice(\n  liste: InterfaceParams[],\n  iDepart: number,\n  iArrivee: number,\n): InterfaceParams[] {\n  liste.splice(iArrivee, 0, liste.splice(iDepart, 1)[0])\n  return liste\n}\n\nlet urlToWrite: URL\nlet timerId: ReturnType<typeof setTimeout> | undefined\n\n/**\n * Complte l'URL courante avec les lments relatifs au diaporama\n */\nexport function updateGlobalOptionsInURL(url: URL) {\n  const options = get(globalOptions)\n  const canStore = get(canOptions)\n  if (options.v) {\n    url.searchParams.append('v', options.v)\n  } else {\n    url.searchParams.delete('v')\n  }\n  if (options.z && options.z !== '1') {\n    url.searchParams.append('z', options.z)\n  } else {\n    url.searchParams.delete('z')\n  }\n  if (options.durationGlobal) {\n    url.searchParams.append('dGlobal', options.durationGlobal.toString())\n  } else {\n    url.searchParams.delete('dGlobal')\n  }\n  if (\n    options.v === 'eleve' ||\n    options.v === 'myriade' ||\n    options.v === 'indices'\n  ) {\n    if (options.title != null && options.title.length > 0) {\n      url.searchParams.append('title', options.title)\n    } else {\n      url.searchParams.delete('title')\n    }\n    if (options.iframe !== undefined && options.iframe.length > 0) {\n      url.searchParams.append('iframe', options.iframe)\n    } else {\n      url.searchParams.delete('iframe')\n    }\n    if (options.answers !== undefined && options.answers.length > 0) {\n      url.searchParams.append('answers', JSON.stringify(options.answers))\n    } else {\n      url.searchParams.delete('answers')\n    }\n    if (typeof options !== 'undefined') {\n      let es = ''\n      if (options.presMode != null) {\n        es = presModeId.indexOf(options.presMode).toString()\n      } else es = '1'\n      es += options.setInteractive ?? '2'\n      es += options.isSolutionAccessible ? '1' : '0'\n      es += options.isInteractiveFree ? '1' : '0'\n      es += options.oneShot ? '1' : '0'\n      es += options.twoColumns ? '1' : '0'\n      es += options.isTitleDisplayed ? '1' : '0'\n      url.searchParams.append('es', es)\n    }\n    if (options.done) {\n      url.searchParams.append('done', options.done)\n    } else {\n      url.searchParams.delete('done')\n    }\n  } else {\n    url.searchParams.delete('title')\n    url.searchParams.delete('es')\n    url.searchParams.delete('iframe')\n    url.searchParams.delete('answers')\n    url.searchParams.delete('recorder')\n    url.searchParams.delete('done')\n  }\n  if (options.v === 'can') {\n    if (canStore) {\n      url.searchParams.append('canD', canStore.durationInMinutes.toString())\n      url.searchParams.append('canT', canStore.subTitle)\n      url.searchParams.append('canSA', canStore.solutionsAccess ? '1' : '0')\n      url.searchParams.append('canSM', canStore.solutionsMode)\n      url.searchParams.append('canI', canStore.isInteractive ? '1' : '0')\n    }\n  }\n  if (options.recorder) {\n    url.searchParams.append('recorder', options.recorder)\n  } else {\n    url.searchParams.delete('recorder')\n  }\n  if (options.v === 'diaporama' || options.v === 'overview') {\n    url.searchParams.append('ds', buildDsParams())\n    if (\n      options.select !== undefined &&\n      options.select !== undefined &&\n      options.select.length > 0 &&\n      options.select.length < get(exercicesParams).length\n    ) {\n      url.searchParams.append('select', options.select.join('-'))\n    }\n    if (\n      options.order !== undefined &&\n      options.order.length > 0 &&\n      options.shuffle\n    ) {\n      url.searchParams.append('order', options.order.join('-'))\n    }\n  } else {\n    url.searchParams.delete('ds')\n    url.searchParams.delete('select')\n    url.searchParams.delete('order')\n  }\n  if (options.beta) {\n    url.searchParams.append('beta', '1')\n  }\n  const currentUrl = new URL(window.location.href)\n  if (currentUrl.searchParams.has('triche')) {\n    url.searchParams.append('triche', '1')\n  }\n  const logParam = currentUrl.searchParams.get('log')\n  if (logParam !== null && /^[0-9]$/.test(logParam)) {\n    url.searchParams.append('log', logParam)\n  }\n  const pdfParam = currentUrl.searchParams.get('pdfParam')\n  if (\n    (options.v === 'latex' || options.v === 'pdf') &&\n    pdfParam !== null &&\n    /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(\n      pdfParam,\n    )\n  ) {\n    url.searchParams.append('pdfParam', pdfParam)\n  }\n  urlToWrite = url\n  // On ne met  jour l'url qu'une fois toutes les 0,5 s\n  // pour viter l'erreur Attempt to use history.pushState() more than 100 times per 30 seconds\n  if (timerId === undefined) {\n    timerId = setTimeout(() => {\n      const currentUrl = new URL(window.location.href)\n      if (urlToWrite.href === currentUrl.href) {\n        timerId = undefined\n        return\n      }\n      window.history.pushState({}, '', urlToWrite)\n      statsPageTracker()\n      timerId = undefined\n    }, 500)\n  }\n}\n\nexport const presModeId: [\n  // sync with src/components/urls.ts presentationMode\n  'liste_exos',\n  'un_exo_par_page',\n  'liste_exos',\n  'une_question_par_page',\n  'recto',\n  'verso',\n  // 'cartes'\n] = [\n  'liste_exos',\n  'un_exo_par_page',\n  'liste_exos',\n  'une_question_par_page',\n  'recto',\n  'verso',\n  // 'cartes'\n]\n","import Bugsnag, { type NotifiableError } from '@bugsnag/js'\nimport bigInt from 'big-integer'\n\nimport { get } from 'svelte/store'\nimport { showDialogForLimitedTime } from './lib/components/dialogs'\nimport { createURL } from './lib/createURL'\nimport { canOptions } from './lib/stores/canStore'\nimport {\n  capytaleMode,\n  capytaleStudentAssignment,\n  exercicesParams,\n} from './lib/stores/generalStore'\nimport { globalOptions } from './lib/stores/globalOptions'\nimport { tropDeChiffres } from './modules/messages'\n\ntype Metadatas = Record<string, unknown>\n\n/* global BigInt */\nif (typeof BigInt === 'undefined') {\n  // @ts-expect-error\n  window.BigInt = bigInt\n}\n\nfunction handleBugsnag() {\n  // const fileName = '../_private/bugsnagApiKey'\n  // PROVISOIRE : MGU\n  const getBugsnagApiKey = '6f45f454e2366599256bddc91cd7000b' // await import(/* @vite-ignore */fileName)\n  const key = getBugsnagApiKey // .default() || ''\n  Bugsnag.start({\n    apiKey: key,\n    onError: function (event) {\n      event.addMetadata('Parametres Exos', get(exercicesParams))\n      event.addMetadata('Parametres: ', {\n        globalOptions: get(globalOptions),\n        canOptions: get(canOptions),\n        exercicesParams: get(exercicesParams),\n        capytaleMode: get(capytaleMode),\n        studentAssignment: get(capytaleStudentAssignment),\n      })\n      event.addMetadata('Url Exos', {\n        url: createURL(get(exercicesParams)).toString(),\n      })\n    },\n  })\n}\n\nif (document.location.hostname !== 'localhost') {\n  handleBugsnag()\n}\n\nfunction isDevMode() {\n  return window.location.href.startsWith('http://localhost')\n}\n\nexport function notifyLocal(error: string | Error, metadatas: Metadatas) {\n  if (!isDevMode()) return\n  if (typeof error === 'string') {\n    // @ts-expect-error\n    if (error.includes(tropDeChiffres) && !window.Bugsnag) {\n      console.error(\n        error +\n          \"\\nIl y a un risque d'erreur d'approximation (la limite est de 15 chiffres significatifs)\\nnb : \" +\n          metadatas.nb +\n          '\\nprecision (= nombre de dcimales demand) : ' +\n          metadatas.precision,\n      )\n    }\n    error = Error(error).message\n  }\n  const message =\n    'Ce message ne sera pas envoy  Bugsnag dans la version en ligne, mais il faut traiter le problme !'\n  showDialogForLimitedTime(\n    'notifDialog',\n    5000,\n    message + ' : <br>' + error.toString() + JSON.stringify(metadatas),\n  )\n  console.error(message, error)\n  if (metadatas) console.info('avec les metadatas', metadatas)\n  if (metadatas) console.info(JSON.stringify(metadatas))\n  console.info('Paramtres des exercices', get(exercicesParams))\n  console.trace()\n}\n/**\n * Une fonction  importer dans les fichiers typescript si on veut faire du window.notify() on utilise notify().\n * @param error\n * @param metadatas\n */\nexport function notify(error: string | NotifiableError, metadatas: Metadatas) {\n  if (typeof error === 'string') {\n    // @ts-expect-error\n    if (error.includes(tropDeChiffres) && !window.Bugsnag) {\n      console.error(\n        error +\n          \"\\nIl y a un risque d'erreur d'approximation (la limite est de 15 chiffres significatifs)\\nnb : \" +\n          metadatas.nb +\n          '\\nprecision (= nombre de dcimales demand) : ' +\n          metadatas.precision,\n      )\n    }\n    error = Error(error).message\n  }\n  // console.error(error)\n  // if (metadatas) console.info('Avec les metadatas:', metadatas)\n  // console.info('Paramtres des exercices:', get(exercicesParams))\n  // return\n\n  if (Bugsnag && !isDevMode()) {\n    if (metadatas) Bugsnag.addMetadata('ajouts', metadatas)\n    Bugsnag.addMetadata('Paramtres des exercices', get(exercicesParams))\n    Bugsnag.notify(error)\n    console.error(error)\n  } else {\n    const message =\n      \"message qui aurait t envoy  bugsnag s'il avait t configur\"\n    showDialogForLimitedTime(\n      'notifDialog',\n      5000,\n      message + ' : <br>' + error.toString(),\n    )\n    console.error(message, error)\n    if (metadatas) console.info('avec les metadatas', metadatas)\n    if (metadatas) console.info(JSON.stringify(metadatas))\n    console.info('Paramtres des exercices', get(exercicesParams))\n    if (metadatas) console.info(JSON.stringify(get(exercicesParams)))\n    console.info('URL:' + createURL(get(exercicesParams)).toString())\n  }\n}\n\n// @ts-expect-error\nwindow.notify = notify\n\n// @ts-expect-error\nwindow.notifyLocal = notifyLocal\n","import { notify } from '../../../bugsnag'\nimport { buildDataKeyboardFromStyle } from '../claviers/keyboard'\nimport './tableauMathlive.scss'\nexport interface Icell {\n  texte: string\n  latex: boolean\n  gras: boolean\n  color: string\n  style?: string\n  options?: {\n    texteApres?: string\n    texteAvant?: string\n    blocCenter?: boolean\n    espace?: boolean\n  }\n}\n\nexport type FlecheCote = false | string\nexport type FlecheSens = 'bas' | 'haut'\nexport type Fleche = [number, number, string, number] | [number, number, string]\nexport type Raws = Array<Icell[]>\ntype ObjetParams = Record<string, string>\n\n// Le TabPropMathlive ne gre pas les flches... alors, je ne sais pas pourquoi j'ai mis toutes ces proprits faculatives... Pour l'avenir ?\n// Si quelqu'un sait faire, qu'il ne se gne pas !\nexport interface Itableau {\n  nbColonnes: number\n  ligne1: Icell[]\n  ligne2: Icell[]\n  flecheHaut?: Fleche[] // [[1, 2, '\\\\times 6,4', 3], [2, 3, '\\\\div 6']]\n  flecheBas?: Fleche[]\n  flecheDroite?: FlecheCote //  remplacer par un string\n  flecheDroiteSens?: FlecheSens\n  flecheGauche?: FlecheCote\n  flecheGaucheSens?: FlecheSens\n}\n\nexport interface ItabDbleEntry {\n  raws: Array<Icell[]>\n  headingCols: Icell[]\n  headingLines: Icell[]\n}\n\n/**\n * Ajoute une cellule et ce qu'il faut dedans\n * @param {boolean} isInteractif\n * @param line\n * @param icell\n * @param indexCol\n * @param indexLine\n * @param tag\n * @param classes\n * @param NoEx\n * @param NoQ\n */\nfunction appendCell({\n  isInteractif,\n  line,\n  icell,\n  indexCol,\n  indexLine,\n  tag,\n  classes,\n  NoEx,\n  NoQ,\n  style,\n}: {\n  isInteractif: boolean\n  line: HTMLElement\n  icell: Icell\n  indexCol: number\n  indexLine: number\n  tag: 'th' | 'td'\n  classes: string\n  NoEx: number\n  NoQ: number\n  style: string\n}) {\n  const cell = document.createElement(tag)\n  let element: HTMLElement\n  const options = icell.options || {}\n  if (icell.texte === '') {\n    if (isInteractif) {\n      if (options.texteAvant != null && options.texteAvant !== '') {\n        const spanAvant = document.createElement('span')\n        spanAvant.classList.add('tableauMathlive')\n        spanAvant.textContent = options.texteAvant\n        cell.appendChild(spanAvant)\n      }\n      element = document.createElement('math-field')\n      if (options.espace) {\n        element.setAttribute('data-space', 'true')\n      }\n      element.classList.add('tableauMathlive')\n\n      const classeString = buildDataKeyboardFromStyle(classes).join(' ')\n      /*  for (const classe of classes.split(' ')) {\n        // if (classe === 'clavierDeBase') element.setAttribute('data-keyboard', 'numbersOperations')\n        // else if (classe === 'clavierDeBaseAvecFraction') element.setAttribute('data-keyboard', 'numbers basicOperations')\n        if (classe === 'angles') element.setAttribute('data-keyboard', 'angles')\n        else if (classe === 'clavierDeBaseAvecFraction')\n          element.setAttribute('data-keyboard', 'numbers basicOperations')\n        else if (classe === 'clavierDeBaseAvecVariable')\n          element.setAttribute(\n            'data-keyboard',\n            'numbers basicOperations variables',\n          )\n        else if (classe === 'clavierDeBaseAvecEgal')\n          element.setAttribute('data-keyboard', 'numbers2 basicOperations')\n        else element.setAttribute('data-keyboard', 'numbersOperations')\n      }\n        */\n      element.setAttribute('data-keyboard', classeString)\n      element.id = `champTexteEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}`\n      element.setAttribute('virtual-keyboard-mode', 'manual')\n      cell.appendChild(element)\n      if (options.texteApres != null && options.texteApres !== '') {\n        const spanApres = document.createElement('span')\n        spanApres.textContent = options.texteApres\n        cell.appendChild(spanApres)\n      }\n      const spanResultat = document.createElement('span')\n      spanResultat.id = `resultatCheckEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}`\n      cell.appendChild(spanResultat)\n    } else {\n      element = document.createElement('span')\n      element.classList.add('tableauMathlive')\n      for (const classe of classes.split(' ')) {\n        if (classe !== '') element.classList.add(classe)\n      }\n      element.id = `cell${NoEx}Q${NoQ}L${indexLine}C${indexCol}`\n      cell.appendChild(element)\n    }\n  } else {\n    if (icell.latex) {\n      // J'aimerais pouvoir utiliser mathlive mais a semble poser des soucis, je remplace par katex...\n      //  element = document.createElement('math-field')\n      // element.innerHTML = `<math-field read-only style=\"display:inline-block\" id=\"L${indexLine}C${i + 1}\">${icell.texte}</math-field>`\n      element = document.createElement('span')\n      cell.appendChild(element)\n      element.outerHTML = `<span id=\"spanEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}\">$${icell.texte}$</span>`\n    } else {\n      element = document.createElement('span')\n      cell.appendChild(element)\n      element.outerHTML = `<span id=\"spanEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}\">${icell.texte}</span>`\n    }\n  }\n  if (style != null) {\n    cell.style.backgroundColor = style.split(';')[0] || 'transparent'\n    cell.style.color = style.split(';')[1] || 'black'\n  }\n  line.appendChild(cell)\n}\n\n/**\n * @param {HTMLTableRowElement} line L'lment HTML <tr> qui reoit les cellules\n * @param {Icell[]} content la liste des cellules au format Icell\n * @param {number} index le numro de la ligne pour fabriquer l'identifiant de cellule\n * @param {'td'|'th'} tag le tag (td pour des cellules  l'intrieur th pour des cellules d'entte)\n * @param {string} classes une liste de className dans un string spars par des espaces\n */\nconst fillLine = function ({\n  isInteractif,\n  line,\n  content,\n  index,\n  tag,\n  classes,\n  NoEx,\n  NoQ,\n  style,\n}: {\n  isInteractif: boolean\n  line: HTMLElement\n  content: Icell[]\n  index: number\n  tag: 'td' | 'th'\n  classes: string\n  NoEx: number\n  NoQ: number\n  style: ObjetParams\n}): void {\n  for (let i = 0; i < content.length; i++) {\n    appendCell({\n      isInteractif,\n      line,\n      icell: content[i],\n      indexCol: i,\n      indexLine: index,\n      tag,\n      classes,\n      NoEx,\n      NoQ,\n      style: style[`L${index}C${i}`],\n    })\n  }\n}\n\nexport class AddTabPropMathlive {\n  styles: Record<string, string>\n  id!: string // ce sera ncessaire pour retrouver le tableau s'il y en a plusieurs dans la page.\n  numeroExercice: number\n  numeroQuestion: number\n  output!: string\n  nbColonnes: number\n  ligne1!: Icell[]\n  ligne2!: Icell[]\n  flecheHaut: Fleche[] // [[1, 2, '\\\\times 6,4', 3], [2, 3, '\\\\div 6']]\n  flecheBas: Fleche[]\n  flecheDroite: FlecheCote //  remplacer par un string\n  flecheDroiteSens: FlecheSens\n  flecheGauche: FlecheCote\n  flecheGaucheSens: FlecheSens\n  classes?: string\n  isInteractif: boolean\n\n  private constructor(\n    numeroExercice: number,\n    question: number,\n    tableau: Itableau,\n    classes: string,\n    isInteractif: boolean,\n  ) {\n    this.nbColonnes = tableau.nbColonnes ?? 1\n    this.flecheHaut = tableau.flecheHaut ?? []\n    this.flecheBas = tableau.flecheBas ?? []\n    this.flecheDroite = tableau.flecheDroite ?? false\n    this.flecheDroiteSens = tableau.flecheDroiteSens ?? 'bas'\n    this.flecheGauche = tableau.flecheGauche ?? false\n    this.flecheGaucheSens = tableau.flecheGaucheSens ?? 'haut'\n    this.numeroExercice = numeroExercice ?? 0\n    this.numeroQuestion = question\n    this.id = `tabMLEx${this.numeroExercice}Q${this.numeroQuestion}`\n    this.classes = classes\n    this.isInteractif = isInteractif\n    this.styles = {}\n  }\n\n  static create(\n    numeroExercice: number,\n    question: number,\n    tableau: Itableau,\n    classes: string,\n    isInteractif: boolean,\n    style: ObjetParams,\n  ) {\n    if (!Array.isArray(tableau.ligne1) || !Array.isArray(tableau.ligne1)) {\n      notify('ajouteTableauMathlive : vrifiez vos paramtres !', {\n        ligne1: tableau.ligne1,\n        ligne2: tableau.ligne2,\n        nbColonnes: tableau.nbColonnes,\n      })\n    }\n    if (style == null) style = {}\n    // a, c'est pour ne pas modifier les lignes du tableau pass en argument\n    const NoEx = numeroExercice ?? 0\n    const NoQ = question\n    const ligne1 = [...tableau.ligne1]\n    const ligne2 = [...tableau.ligne2]\n    const tableauMathlive: AddTabPropMathlive = new AddTabPropMathlive(\n      numeroExercice,\n      question,\n      tableau,\n      classes,\n      isInteractif,\n    )\n    tableauMathlive.ligne1 = ligne1.map((el) => JSON.parse(JSON.stringify(el))) // on clone les lignes pour ne pas modifier le tableau pass en argument\n    tableauMathlive.ligne2 = ligne2.map((el) => JSON.parse(JSON.stringify(el)))\n    tableauMathlive.styles = style\n    const table = document.createElement('table')\n    table.className = 'tableauMathlive'\n    table.id = `tabMathliveEx${NoEx}Q${question}`\n    const firstLine = document.createElement('tr')\n    const entete1 = ligne1.shift()\n    if (entete1)\n      appendCell({\n        isInteractif,\n        line: firstLine,\n        icell: entete1,\n        indexCol: 0,\n        indexLine: 0,\n        tag: 'th',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${0}C${0}`],\n      })\n    for (let i = 0; i < ligne1.length; i++) {\n      appendCell({\n        isInteractif,\n        line: firstLine,\n        icell: ligne1[i],\n        indexCol: i + 1,\n        indexLine: 0,\n        tag: 'td',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${0}C${i + 1}`] ?? ligne1[i].style,\n      })\n    }\n    table.appendChild(firstLine)\n    // tableau de proportionnalit conforme  ceux dfinis dans src/lib/2d/tableau\n    const secondLine = document.createElement('tr')\n    const entete2 = ligne2.shift()\n    if (entete2)\n      appendCell({\n        isInteractif,\n        line: secondLine,\n        icell: entete2,\n        indexCol: 0,\n        indexLine: 1,\n        tag: 'th',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${1}C${0}`],\n      })\n    for (let i = 0; i < ligne2.length; i++) {\n      appendCell({\n        isInteractif,\n        line: secondLine,\n        icell: ligne2[i],\n        indexCol: i + 1,\n        indexLine: 1,\n        tag: 'td',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${1}C${i + 1}`] ?? ligne2[i].style,\n      })\n    }\n    table.appendChild(secondLine)\n    const spanCheckOuterHTML = `<span id=\"resultatCheckEx${numeroExercice}Q${question}\"></span>`\n    // pour l'instant je retourne l'objet complet avec le HTML de la table dans sa proprit output,\n    // mais il sera peut-tre possible de ne retourner que le HTML comme pour ajouteChampTexteMathlive...\n    tableauMathlive.output = table.outerHTML + spanCheckOuterHTML\n    return tableauMathlive\n  }\n\n  /**\n   * Les listes de tableauColonneLigne sont des listes de strings.\n   * Celles des tableaux Mathlive, doivent tre des Icell[] (interface exporte par ce fichier).\n   * Cette fonction prends les diffrentes listes de tableauColonneLigne en argument et retourne un tableau pour AddTabDblEntry\n   * @param tabEntetesColonnes\n   * @param tabEntetesLignes\n   * @param tabLignes\n   */\n  static convertTableauToTableauMathlive(\n    lgn1: string[],\n    lgn2: string[],\n    gras: boolean = false,\n    color: string = 'black',\n  ): Itableau {\n    const nbColonnes = Math.max(lgn1.length, lgn2.length)\n    const ligne1: Icell[] = []\n    const ligne2: Icell[] = []\n    for (const str of lgn1) {\n      ligne1.push({ texte: str, latex: true, gras, color })\n    }\n    for (const str of lgn2) {\n      ligne2.push({ texte: str, latex: true, gras, color })\n    }\n    return { ligne1, ligne2, nbColonnes }\n  }\n\n  get latexOutput(): string {\n    // retourne le tableau au format latex\n    let output =\n      '\\\\begin{tabular}{|c|' + 'c|'.repeat(this.nbColonnes - 1) + '}\\n'\n    output += '\\\\hline\\n'\n    let content: string[] = []\n    for (let i = 0; i < this.ligne1.length; i++) {\n      const cellule = this.ligne1[i]\n      const style = this.styles[`L0C${i}`] ?? ''\n      content.push(\n        `${(style ?? ';').split(';')[0] !== '' ? `\\\\cellcolor{${(style ?? ';').split(';')[0]}}` : ''} ${`${cellule.latex ? '$' : ''}${cellule.texte}${cellule.latex ? '$' : ''}`}`.replace(\n          '$$',\n          '',\n        ),\n      )\n    }\n    output += content.join(' & ') + '\\\\\\\\\\n'\n\n    output += '\\\\hline\\n'\n    content = []\n    for (let i = 0; i < this.ligne2.length; i++) {\n      const cellule = this.ligne2[i]\n      const style = this.styles[`L1C${i}`] ?? ''\n      content.push(\n        `${(style ?? ';').split(';')[0] !== '' ? `\\\\cellcolor{${(style ?? ';').split(';')[0]}}` : ''} ${`${cellule.latex ? '$' : ''}${cellule.texte}${cellule.latex ? '$' : ''}`}`.replace(\n          '$$',\n          '',\n        ),\n      )\n    }\n    output += content.join(' & ') + '\\\\\\\\\\n'\n    output += '\\\\hline\\n'\n    output += '\\\\end{tabular}'\n    return output\n  }\n}\n\nexport class AddTabDbleEntryMathlive {\n  id!: string // ce sera ncessaire pour retrouver le tableau s'il y en a plusieurs dans la page.\n  numeroExercice: number\n  numeroQuestion: number\n  output!: string\n  raws!: Raws\n  headingCols: Icell[]\n  headingLines: Icell[]\n  classes: string\n  isInteractif: boolean\n  private constructor(\n    numeroExercice: number,\n    question: number,\n    tableau: ItabDbleEntry,\n    classes: string,\n    isInteractif: boolean,\n  ) {\n    if (numeroExercice == null) {\n      // @ts-expect-error\n      window.notify(\n        \"AddTabDbleEntryMathlive a besoin absolument d'un numero d'exercice\",\n      )\n    }\n    this.headingCols = tableau.headingCols\n    this.headingLines = tableau.headingLines\n    this.numeroExercice = numeroExercice ?? 0\n    this.numeroQuestion = question\n    this.id = `tabMLEx${this.numeroExercice}Q${this.numeroQuestion}`\n    this.raws = tableau.raws\n    this.classes = classes\n    this.isInteractif = isInteractif\n  }\n\n  static create(\n    numeroExercice: number,\n    question: number,\n    tableau: ItabDbleEntry,\n    classes: string,\n    isInteractif: boolean,\n    style: ObjetParams,\n  ) {\n    // tableau doit contenir headingCols et headingLines, qui peuvent tre vides, mais doivent tre fournis.\n    if (\n      !Array.isArray(tableau.headingCols) ||\n      !Array.isArray(tableau.headingLines)\n    ) {\n      notify('ajouteTableauMathlive : vrifiez vos paramtres !', {\n        headingCols: tableau.headingCols,\n        headingLines: tableau.headingLines,\n      })\n    }\n    if (style == null) style = {}\n    const tableauMathlive: AddTabDbleEntryMathlive =\n      new AddTabDbleEntryMathlive(\n        numeroExercice,\n        question,\n        tableau,\n        classes,\n        isInteractif,\n      )\n    const table = document.createElement('table')\n    const NoEx = numeroExercice ?? 0\n    const NoQ = question\n    table.className = 'tableauMathlive'\n    table.id = `tabMathliveEx${numeroExercice}Q${question}`\n    const firstLine = document.createElement('tr')\n    table.appendChild(firstLine)\n    tableauMathlive.headingCols = tableau.headingCols.map((el) =>\n      JSON.parse(JSON.stringify(el)),\n    ) // on clone les lignes pour ne pas modifier le tableau pass en argument\n    if (tableau.headingCols != null) {\n      fillLine({\n        isInteractif,\n        line: firstLine,\n        content: tableau.headingCols,\n        index: 0,\n        tag: 'th',\n        classes,\n        NoEx,\n        NoQ,\n        style,\n      })\n    }\n    // lignes suivantes\n    for (let j = 0; j < tableau.raws.length; j++) {\n      const newLine = document.createElement('tr')\n      table.appendChild(newLine)\n      if (tableau.headingLines != null) {\n        tableauMathlive.headingLines = tableau.headingLines.map((el) =>\n          JSON.parse(JSON.stringify(el)),\n        ) // on clone les lignes pour ne pas modifier le tableau pass en argument\n        const sty =\n          style[`L${tableau.headingCols != null ? 1 + j : j}C${0}`] ||\n          style[`LC${0}`]\n        appendCell({\n          isInteractif,\n          line: newLine,\n          icell: tableau.headingLines[j],\n          indexCol: 0,\n          indexLine: tableau.headingCols != null ? 1 + j : j,\n          tag: 'th',\n          classes,\n          NoEx,\n          NoQ,\n          style: sty,\n        })\n        /*\n        const head = document.createElement('th')\n        head.textContent = `$${tableau.headingLines[j]}$`\n        newLine.appendChild(head)\n        */\n      }\n      tableauMathlive.raws = tableau.raws.map((el) =>\n        JSON.parse(JSON.stringify(el)),\n      ) // on clone les raws pour ne pas modifier le tableau pass en argument\n      const raw = tableau.raws[j]\n      if (Array.isArray(raw) && raw.length > 0) {\n        for (let i = 0; i < raw.length; i++) {\n          appendCell({\n            isInteractif,\n            line: newLine,\n            icell: raw[i],\n            indexCol: tableau.headingLines != null ? i + 1 : i,\n            indexLine: tableau.headingCols != null ? 1 + j : j,\n            tag: 'td',\n            classes,\n            NoEx,\n            NoQ,\n            style:\n              style[\n                `L${tableau.headingCols != null ? 1 + j : j}C${tableau.headingLines != null ? i + 1 : i}`\n              ],\n          })\n        }\n      }\n    }\n    const spanCheckOuterHTML = `<span id=\"feedbackEx${numeroExercice}Q${question}\"></span>`\n    // pour l'instant je retourne l'objet complet avec le HTML de la table dans sa proprit output,\n    // mais il sera peut-tre possible de ne retourner que le HTML comme pour ajouteChampTexteMathlive...\n    tableauMathlive.output = table.outerHTML + spanCheckOuterHTML\n    return tableauMathlive\n  }\n\n  get latexOutput(): string {\n    if (this.headingCols.length === 0 && this.headingLines.length === 0) {\n      throw Error(\n        'Un tableau  double entre doit avoir des entte de colonne et des entte de ligne',\n      )\n    }\n    const nbCols =\n      this.headingCols.length > 0\n        ? this.headingCols.length\n        : this.raws[0].length + (this.headingLines.length > 0 ? 1 : 0)\n    const nbLines =\n      this.headingLines.length > 0 ? this.headingLines.length : this.raws.length\n\n    // retourne le tableau au format latex\n    let output = '\\\\begin{tabular}{|c|' + 'c|'.repeat(nbCols - 1) + '}\\n'\n    output += '\\\\hline\\n'\n    for (let i = 0; i < nbLines; i++) {\n      if (this.headingLines[i] != null) {\n        output += `$${this.headingLines[i].texte}$ & `\n      }\n      const raw = this.raws[i]\n      output +=\n        raw.map((cellule) => `$${cellule.texte}$`).join(' & ') + '\\\\\\\\\\n'\n      output += '\\\\hline\\n'\n    }\n    output += '\\\\end{tabular}'\n    return output\n  }\n\n  /**\n   * Les listes de tableauColonneLigne sont des listes de strings.\n   * Celles des tableaux Mathlive, doivent tre des Icell[] (interface exporte par ce fichier).\n   * Cette fonction prends les diffrentes listes de tableauColonneLigne en argument et retourne un tableau pour AddTabDblEntry\n   * @param tabEntetesColonnes\n   * @param tabEntetesLignes\n   * @param tabLignes\n   */\n  static convertTclToTableauMathlive(\n    tabEntetesColonnes: (string | number)[],\n    tabEntetesLignes: (string | number)[],\n    tabLignes: (string | number)[],\n    gras: boolean = true,\n    color: string = 'black',\n  ) {\n    const headingCols: Icell[] = []\n    for (const enTete of tabEntetesColonnes) {\n      headingCols.push({ texte: enTete.toString(), latex: true, gras, color })\n    }\n    const headingLines: Icell[] = []\n    for (const enTete of tabEntetesLignes) {\n      headingLines.push({\n        texte: enTete.toString(),\n        latex: !enTete.toString().includes('<pre class'),\n        gras,\n        color,\n      })\n    }\n    const raws: Array<Icell[]> = []\n    const haveHeadC = headingCols.length > 0\n    const haveHeadL = headingLines.length > 0\n    if (!haveHeadL && !haveHeadC)\n      throw Error(\n        'Un tableau  double entre doit avoir des entte de colonne et des entte de ligne',\n      )\n    // on boucle sur les lignes mais il peut ne pas y avoir de headingLines ! On doit alors diviser le nombre de cellules par le nombre de colonnes  remplir.\n    const nbCols =\n      haveHeadL && haveHeadC\n        ? headingCols.length - 1\n        : haveHeadC\n          ? headingCols.length\n          : tabLignes.length / headingLines.length\n    const nbLines = haveHeadL ? headingLines.length : tabLignes.length / nbCols\n    for (let i = 0; i < nbLines; i++) {\n      const raw: Icell[] = []\n      for (let j = 0; j < nbCols; j++) {\n        raw.push({\n          texte: tabLignes[i * nbCols + j].toString(),\n          latex: true,\n          gras,\n          color,\n        })\n      }\n      raws.push(raw)\n    }\n    return { headingLines, headingCols, raws }\n  }\n}\n","import type {\n  IExercice,\n  InteractivityType,\n  ReponseParams,\n  TableauMathliveType,\n  Valeur,\n} from '../../lib/types'\nimport { context } from '../../modules/context'\nimport { sp } from '../outils/outilString'\nimport './champTexte.scss'\nimport { buildDataKeyboardFromStyle } from './claviers/keyboard'\nimport { handleAnswers } from './gestionInteractif'\nimport {\n  AddTabDbleEntryMathlive,\n  AddTabPropMathlive,\n  type ItabDbleEntry,\n  type Itableau,\n} from './tableaux/AjouteTableauMathlive'\n\nconst buildDataKeyboardString = (style = '') => {\n  const blocks = buildDataKeyboardFromStyle(style)\n  return blocks.join(' ')\n}\n\n/**\n * Une question pour rassembler les ajouteChampTexte et Cie et les handleHanswers.\n * Il faudrait pouvoir fournir autre chose que objetReponse.\n * Un truc du style :\n * [{id: 'reponse', value: 'valeur', compare: fonctionComparaison, options: {}},\n * {id: 'reponse2', value: 'valeur2', compare: fonctionComparaison, options: {}},\n * {id: 'reponse3', value: 'valeur3', compare: fonctionComparaison, options: {}}]\n * qui alimentera objetReponse.\n * ou alors, on fait un type conditionnel sur objetReponse...\n * C'est balaize  faire, mais ce serait mieux : on ouvre l'accolade, et si on commence  taper rep... il ouvre l'accolade, demande value, demande compare, demande options... idem si on commence  taper champ1....\n * @author Jean-Claude Lhote\n * @param {Exercice} exercice\n * @param {number} question\n * @param {Valeur} objetReponse\n * @param {ReponseParams} reponseParams\n * @param {InteractivityType} typeInteractivite\n * @param {string} content\n * @param {string} classe\n * @param {ItabDbleEntry | Itableau} tableau\n * @param {TableauMathliveType} typeTableau\n * @param {string} texteAvant\n * @param {string} texteApres\n * @param {boolean} blocCenter\n * @param {boolean} espace\n * @returns string\n */\nexport function ajouteQuestionMathlive({\n  exercice,\n  question,\n  objetReponse,\n  reponseParams,\n  typeInteractivite,\n  content = '',\n  classe = '',\n  tableau,\n  typeTableau = 'doubleEntree',\n  texteAvant = '',\n  texteApres = '',\n  blocCenter = false,\n  espace = false,\n}: {\n  exercice: IExercice\n  question: number\n  objetReponse: Valeur\n  reponseParams?: ReponseParams\n  typeInteractivite: InteractivityType\n  content?: string\n  classe?: string\n  tableau?: ItabDbleEntry | Itableau\n  typeTableau?: TableauMathliveType\n  texteAvant?: string\n  texteApres?: string\n  blocCenter?: boolean\n  espace?: boolean\n}) {\n  if (context.isHtml && exercice.interactif) {\n    if (\n      !(\n        typeInteractivite === 'mathlive' ||\n        typeInteractivite === 'fillInTheBlank' ||\n        typeInteractivite === 'tableauMathlive' ||\n        typeInteractivite === 'texte'\n      )\n    ) {\n      window.notify(\n        `Type d'interactivit ${typeInteractivite} non reconnu. Exercice ${exercice.id} ${exercice.uuid}`,\n        { typeInteractivite },\n      )\n      return ''\n    }\n    if (reponseParams === undefined) {\n      reponseParams = { formatInteractif: 'mathlive' }\n    }\n    handleAnswers(exercice, question, objetReponse, reponseParams)\n    switch (typeInteractivite) {\n      case 'fillInTheBlank':\n        return remplisLesBlancs(exercice, question, content, classe, '\\\\ldots')\n      case 'tableauMathlive': {\n        if (!tableau) {\n          window.notify(\n            `Tableau non dfini pour l'interactivit tableauMathlive. Exercice ${exercice.id} ${exercice.uuid}`,\n            { typeInteractivite },\n          )\n          return ''\n        }\n        const leTableau =\n          typeTableau === 'doubleEntree'\n            ? AddTabDbleEntryMathlive.create(\n                exercice.numeroExercice ?? 0,\n                question,\n                tableau as ItabDbleEntry,\n                classe,\n                true,\n                {\n                  texteAvant,\n                  texteApres,\n                  blocCenter: blocCenter ? ' bloccenter' : '',\n                  espace: espace ? ' ' : '',\n                },\n              )\n            : AddTabPropMathlive.create(\n                exercice.numeroExercice ?? 0,\n                question,\n                tableau as Itableau,\n                classe,\n                true,\n                {\n                  texteAvant,\n                  texteApres,\n                  blocCenter: blocCenter ? ' bloccenter' : '',\n                  espace: espace ? ' ' : '',\n                },\n              )\n        return leTableau.output\n      }\n      case 'texte':\n        return ajouteChampTexte(exercice, question, classe, {\n          texteAvant,\n          texteApres,\n          blocCenter,\n          espace,\n        })\n      default:\n        return ajouteChampTexteMathLive(exercice, question, classe, {\n          texteAvant,\n          texteApres,\n          blocCenter,\n          espace,\n        })\n    }\n  }\n  return ''\n}\n\n/**\n * Retourne le code html d'un div prvu pour le feedback toute forme d'interactivit.\n * @param {Exercice} exercice\n * @param {number} question\n * @param {string} style\n * @deprecated si vous l'utilisez aprs ajouteChampTexteMathlive, ajouteChampTexte ou remplisLesBlancs, vous n'avez pas besoin de l'utiliser, il est ajout automatiquement.\n */\nexport function ajouteFeedback(\n  exercice: IExercice,\n  question: number,\n  style = 'style=\"display: none\"',\n) {\n  if (!context.isHtml) return ''\n  const exo = exercice.numeroExercice\n  if (\n    exercice == null ||\n    typeof exo !== 'number' ||\n    typeof question !== 'number'\n  )\n    return ''\n  return `<div class =\"ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest\" id=\"feedbackEx${exo}Q${question}\" ${style !== '' ? style : ''}></div>`\n}\n\ntype OptionsChamp = {\n  texteApres?: string\n  texteAvant?: string\n  blocCenter?: boolean\n  espace?: boolean\n  placeholder?: string\n}\n\nexport function ajouteChampTexte(\n  exercice: IExercice,\n  i: number,\n  style = '',\n  options: OptionsChamp = {},\n) {\n  return ajouteChamp({ type: 'texte', exercice, i, style }, options)\n}\n\nexport function ajouteChampTexteMathLive(\n  exercice: IExercice,\n  i: number,\n  style = '',\n  options: OptionsChamp = {},\n) {\n  return ajouteChamp({ type: 'mathlive', exercice, i, style }, options)\n}\n\ntype ParamsChamp = {\n  type: 'texte' | 'mathlive'\n  exercice: IExercice\n  i: number\n  style?: string\n}\n\nfunction ajouteChamp(params: ParamsChamp, options: OptionsChamp = {}) {\n  const { type, exercice, i, style = '' } = params\n  let {\n    texteAvant = '',\n    texteApres = '',\n    blocCenter = false,\n    espace = false,\n    placeholder = '',\n  } = options\n  if (texteApres !== '') texteApres = sp() + texteApres\n  if (!context.isHtml || !exercice.interactif || style === 'none') return ''\n  if (typeof style !== 'string') {\n    window.notify(\n      `style doit tre une chane de caractres. Exercice ${exercice.id} ${exercice.uuid}`,\n      { style },\n    )\n  }\n  if (style.includes('blocCenter')) blocCenter = true\n  const dataKeyboard = buildDataKeyboardString(\n    typeof style === 'string' ? style : '',\n  )\n  const balise = type === 'mathlive' ? 'math-field' : 'input'\n  let html = `<label>${texteAvant}</label><${balise} data-keyboard=\"${dataKeyboard}\" ${espace ? 'data-space=\"true\"' : ''} ${placeholder ? `placeholder=\"${placeholder}\"` : ''} virtual-keyboard-mode=manual class=\"${style}\" id=\"champTexteEx${exercice.numeroExercice}Q${i}\"></${balise}>${texteApres ? `<span>${texteApres}</span>` : ''} <span id=\"resultatCheckEx${exercice.numeroExercice}Q${i}\"></span>`\n  if (blocCenter) {\n    html = `<div style='display: flex;justify-content: center; margin:5px;'>${html}<div>`\n  }\n  html += ajouteFeedback(exercice, i)\n  return html\n}\n\nexport function remplisLesBlancs(\n  exercice: IExercice,\n  question: number,\n  content: string,\n  classes: string = '',\n  blanc = '\\\\ldots',\n) {\n  let mfeValue = ''\n  let resteContent = content\n  while (resteContent) {\n    const chunks = /^(.*?)%\\{([^}]+)}(.*?)$/.exec(resteContent)\n    if (chunks) {\n      const [, start, n, end] = chunks\n      const name = n\n      if (name == null) throw Error(`Dfinition de ${name} manquante`)\n      mfeValue += start\n      if (exercice.interactif) {\n        mfeValue += `\\\\placeholder[${name}]{}`\n      } else {\n        mfeValue += blanc\n      }\n      resteContent = end ?? ''\n    } else {\n      mfeValue += resteContent\n      resteContent = ''\n    }\n  }\n  if (exercice.interactif && context.isHtml) {\n    const dataKeyboard = buildDataKeyboardString(classes)\n    let classe = ''\n    if (classes !== '') {\n      if (classes === 'fillInTheBlank' || classes === 'fillInTheBlanks')\n        classe = 'fillInTheBlanks'\n      else\n        classe = [\n          'fillInTheBlanks',\n          ...classes\n            .split(' ')\n            .filter(\n              (el) => el !== 'fillInTheBlank' && el !== 'fillInTheBlanks',\n            ),\n        ].join(' ')\n    } else {\n      classe = 'fillInTheBlanks'\n    }\n    return `<math-field data-keyboard=\"${dataKeyboard}\" virtual-keyboard-mode=manual readonly class=\"${classe}\" id=\"champTexteEx${exercice.numeroExercice}Q${question}\">${mfeValue}</math-field><span id=\"resultatCheckEx${exercice.numeroExercice}Q${question}\"></span>${ajouteFeedback(exercice, question)}`\n  }\n  if (mfeValue === '') return ''\n  return `$${mfeValue}$`\n}\n","import type Figure from 'apigeom/src/Figure'\nimport type { PartialKbType } from '../lib/interactif/claviers/keyboard'\nimport type { CanOptions, CanSolutionsMode } from './types/can'\nimport type { Language } from './types/languages'\n\n// Types pour gestionInteractif\nimport type { IFractionEtendue } from '../modules/FractionEtendue.type'\n// import Grandeur from '../modules/Grandeur'\nimport type Decimal from 'decimal.js'\nimport type FractionEtendue from '../modules/FractionEtendue'\nimport Hms from '../modules/Hms'\nimport type { VueType } from './VueType'\n\n/**\n * setInteractive  0 on enlve tout,  1 on les met tous en interactif,  2 on ne change rien\n * iframe est un identifiant de l'iframe utilis par des recorders comme Moodle\n */\nexport interface InterfaceGlobalOptions {\n  v?: VueType\n  z?: string\n  durationGlobal?: number\n  ds?: string\n  nbVues?: 1 | 2 | 3 | 4\n  flow?: 0 | 1 | 2 // 0: Q->Q, 1: Q->R->Q, 2: Q->(Q+R)->Q\n  screenBetweenSlides?: boolean\n  pauseAfterEachQuestion?: boolean\n  sound?: 0 | 1 | 2 | 3 | 4\n  isImagesOnSides?: boolean\n  shuffle?: boolean\n  select?: number[]\n  order?: number[]\n  manualMode?: boolean\n  es?: string\n  title?: string\n  presMode?:\n    | 'liste_exos'\n    | 'un_exo_par_page'\n    | 'une_question_par_page'\n    | 'recto'\n    | 'verso'\n  // | 'cartes'\n  setInteractive?: string\n  isSolutionAccessible?: boolean\n  isTitleDisplayed?: boolean\n  isInteractiveFree?: boolean\n  oneShot?: boolean\n  recorder?: 'capytale' | 'labomep' | 'moodle' | 'anki' | 'flowmath'\n  done?: '1' | '0' // pourquoi n'y a-t-il qu'une valeur possible ?  vrifier JC\n  answers?: string\n  iframe?: string\n  twoColumns?: boolean\n  beta?: boolean\n  isDataRandom?: boolean\n  canD?: string\n  canT?: string\n  canSA?: boolean\n  canSM?: CanSolutionsMode\n  canI?: boolean\n  lang?: Language\n}\n\nexport interface InterfaceParams extends Partial<\n  Record<string, string | number>\n> {\n  uuid: string\n  id?: string\n  alea?: string\n  interactif?: '0' | '1'\n  cd?: '0' | '1'\n  sup?: string\n  sup2?: string\n  sup3?: string\n  sup4?: string\n  sup5?: string\n  versionQcm?: '0' | '1' // pour la version QCM des exercices de type simple\n  nbQuestions?: number\n  duration?: number\n  cols?: number\n  type?: 'mathalea' | 'static' | 'app'\n  bestScore?: number\n}\n\nexport interface InterfaceReferentiel {\n  uuid: string\n  id: string\n  url: string\n  titre: string\n  tags: { interactif: boolean; interactifType: string; amc: boolean }\n  datePublication?: string\n  dateModification?: string\n  annee?: string\n}\n\nexport interface InterfaceResultExercice {\n  numberOfPoints: number\n  numberOfQuestions: number\n  uuid?: string\n  title?: string\n  alea?: string\n  answers?: { [key: string]: string }\n  indice?: number\n  state?: 'done'\n  type?: 'mathalea' | 'static' | 'app'\n  bestScore?: number\n  duration?: number\n  checkSum?: string\n  resultsByQuestion?: boolean[]\n}\n\n// Pour Capytale\nexport interface Activity {\n  globalOptions: InterfaceGlobalOptions\n  exercicesParams: InterfaceParams[]\n  canOptions: CanOptions\n}\n\nexport interface StudentAssignment {\n  resultsByExercice: InterfaceResultExercice[]\n}\n\n// Pour les listes d'entres de rfrentiel dans le side menu\n// * `title` : titre affich dans le menu\n// * `content` : le rfrentiel lui-mme\n// * `type` : type du rfrentiel pour grer l'affichage (exploration rcursive ou pas par exemple)\n// * `activated`: flag pour afficher ou pas le rfrentiel\nexport type ReferentielTypes =\n  | 'outils'\n  | 'exercices'\n  | 'ressources'\n  | 'bibliotheque'\n  | 'apps'\n  | 'examens'\nexport type ReferentielNames =\n  | 'outils'\n  | 'aleatoires'\n  | 'statiques'\n  | 'ressources'\n  | 'bibliotheque'\n  | 'apps'\n  | 'examens'\n  | 'geometrieDynamique'\nexport type ReferentielForList = {\n  name: ReferentielNames\n  title: string\n  content: InterfaceReferentiel[]\n  type: ReferentielTypes\n  activated: boolean\n}\n\n// Pour les exercices statiques de la bibliotheque\nexport interface bibliothequeExercise {\n  uuid: string\n  url: string\n  png: string\n  pngCor: string\n}\n\n// Pour les couleurs utilises dans le site\n// chanes de caractres possible  ajouter aprs <text|fill|bg|border|...>-coopmaths- ou <text|fill|bg|border|...>-coopmathsdark-\nexport type CoopmathsColor =\n  | 'canvas'\n  | 'canvas-light'\n  | 'canvas`lightest'\n  | 'canvas-dark'\n  | 'canvas-darkest'\n  | 'warn'\n  | 'warn-light'\n  | 'warn-lightest'\n  | 'warn-dark'\n  | 'warn-darkest'\n  | 'corpus'\n  | 'corpus-light'\n  | 'corpus-lightest'\n  | 'corpus-dark'\n  | 'corpus-darkest'\n  | 'struct'\n  | 'struct-ligh'\n  | 'struct-lightest'\n  | 'struct-dark'\n  | 'struct-darkest'\n\n// type pour une fonction qui n'admet pas d'argument et de retourne rien\nexport type Action = () => void\n\n// type pour un intervalle de nombres\n// usage : const myNumber: NumericRange<0, 100> = 3 (par de valeur possible infrieure  0 et suprieure  100)\n// source: https://github.com/microsoft/TypeScript/issues/43505#issuecomment-1686128430\nexport type NumericRange<\n  start extends number,\n  end extends number,\n  arr extends unknown[] = [],\n  acc extends number = never,\n> = arr['length'] extends end\n  ? acc | start | end\n  : NumericRange<\n      start,\n      end,\n      [...arr, 1],\n      arr[start] extends undefined ? acc : acc | arr['length']\n    >\n// autre type pour intervalle de nombre\n// source : https://github.com/type-challenges/type-challenges/issues/9230\nexport type NumberRange<\n  L extends number,\n  H extends number,\n  Out extends number[] = [],\n  Flag extends boolean = false,\n> = Out['length'] extends L\n  ? NumberRange<L, H, [...Out, L], true>\n  : Flag extends true\n    ? Out['length'] extends H\n      ? [...Out, Out['length']][number]\n      : NumberRange<L, H, [...Out, Out['length']], Flag>\n    : NumberRange<L, H, [...Out, never], Flag>\n// type pour les chips des exercices\nexport type ChipContentType = { ref: string; title: string; key: string }\n\n// type pour les filtres affichs\nexport type DisplayedFilterContent<T> = {\n  title: string\n  values: T[]\n  isSelected: boolean\n  clicked: number\n}\nexport type DisplayedFilter<T> = Record<string, DisplayedFilterContent<T>>\nexport type FilterType = 'levels' | 'specs' | 'types'\nexport type FilterObject<T> = {\n  type: FilterType\n  key: string\n  content: DisplayedFilterContent<T>\n}\n\nexport type FilterSectionNameType = { [key in FilterType]: string }\nexport const FILTER_SECTIONS_TITLES: FilterSectionNameType = {\n  levels: 'Niveaux',\n  specs: 'Fonctionnalits',\n  types: 'Types',\n}\n\nexport type ResultType = { isOk: boolean; feedback?: string }\nexport type OptionsComparaisonType = {\n  noFeedback?: boolean\n  expressionsForcementReduites?: boolean\n  avecSigneMultiplier?: boolean\n  avecFractions?: boolean\n  sansTrigo?: boolean\n  fractionIrreductible?: boolean\n  fractionSimplifiee?: boolean\n  fractionReduite?: boolean\n  fractionDecimale?: boolean\n  fractionEgale?: boolean\n  fractionIdentique?: boolean\n  nombreDecimalSeulement?: boolean\n  expressionNumerique?: boolean\n  additionSeulementEtNonResultat?: boolean\n  soustractionSeulementEtNonResultat?: boolean\n  multiplicationSeulementEtNonResultat?: boolean\n  divisionSeulementEtNonResultat?: boolean\n  ensembleDeNombres?: boolean\n  fonction?: boolean\n  kUplet?: boolean\n  seulementCertainesPuissances?: boolean\n  sansExposantUn?: boolean\n  suiteDeNombres?: boolean\n  suiteRangeeDeNombres?: boolean\n  factorisation?: boolean\n  exclusifFactorisation?: boolean\n  nbFacteursIdentiquesFactorisation?: boolean\n  unSeulFacteurLitteral?: boolean\n  HMS?: boolean\n  intervalle?: boolean\n  estDansIntervalle?: boolean\n  ecritureScientifique?: boolean\n  unite?: boolean\n  precisionUnite?: number\n  puissance?: boolean\n  texteAvecCasse?: boolean\n  texteSansCasse?: boolean\n  nombreAvecEspace?: boolean\n  developpementEgal?: boolean\n  egaliteExpression?: boolean\n  calculFormel?: boolean\n  noUselessParen?: boolean\n  nonReponseAcceptee?: boolean\n  pluriels?: boolean\n  multi?: boolean // options pour le drag and drop\n  ordered?: boolean // options pour le drag and drop\n  tolerance?: number\n  variable?: string\n  entier?: boolean\n  domaine?: [number, number]\n}\nexport type CompareFunction = (\n  input: string,\n  goodAnswer: string,\n  options?: OptionsComparaisonType,\n) => ResultType\n\nexport type CleaningOperation =\n  | 'fractions'\n  | 'fractionsMemesNegatives'\n  | 'virgules'\n  | 'espaces'\n  | 'parentheses'\n  | 'puissances'\n  | 'divisions'\n  | 'latex'\n  | 'foisUn'\n  | 'unites'\n  | 'doubleEspaces'\n  | 'espaceNormal'\n  | 'mathrm'\n  | 'operatorName'\n  | 'imaginaires'\n\nexport type InteractivityType =\n  | 'qcm'\n  | 'mathlive'\n  | 'fillInTheBlank'\n  | 'tableauMathlive'\n  | 'texte'\n  | 'cliqueFigure'\n  | 'dnd'\n  | 'listeDeroulante'\n  | 'custom'\n  | 'tableur'\n  | 'MetaInteractif2d'\nexport function isInteractivityType(\n  value: unknown,\n): value is InteractivityType {\n  return (\n    value === 'qcm' ||\n    value === 'mathlive' ||\n    value === 'fillInTheBlank' ||\n    value === 'tableauMathlive' ||\n    value === 'texte' ||\n    value === 'cliqueFigure' ||\n    value === 'dnd' ||\n    value === 'listeDeroulante' ||\n    value === 'custom' ||\n    value === 'tableur' ||\n    value === 'MetaInteractif2d'\n  )\n}\n\nexport type TableauMathliveType = 'doubleEntree' | 'proportionnalite'\n\n/**\n * Type pour les figures cliquables\n */\nexport type ClickFigures = Array<{ id: string; solution: boolean }>\n\n/**\n * Type pour les donnes de test et de correction des exercices tableur\n */\nexport type CellDatas = {\n  ref: string\n  formula?: string\n  value?: string | number\n}\nexport type TestCellDatas = {\n  ref: string // Cellule  modifier alatoirement\n  rangeValues: [number, number] // Plage de valeurs possibles\n}\nexport type GoodAnswersFormulas = CellDatas[]\nexport type SheetTestDatas = TestCellDatas[]\n\nexport type AnswerType = {\n  value: AnswerValueType\n  compare?: CompareFunction\n  options?: OptionsComparaisonType\n}\n\nexport type SheetAnswerType = {\n  goodAnswerFormulas: GoodAnswersFormulas\n  sheetTestDatas: SheetTestDatas\n}\n\nexport type AnswerNormalizedType = {\n  value: string | string[]\n  compare?: CompareFunction\n  options?: OptionsComparaisonType\n}\n\n/**\n * Type pour une valeur de rponse avec ses options\n */\nexport interface Valeur {\n  bareme?: (listePoints: number[]) => [number, number]\n  feedback?: (saisies: Record<string, string>) => string\n  reponse?: AnswerType\n  champ1?: AnswerType\n  champ2?: AnswerType\n  champ3?: AnswerType\n  champ4?: AnswerType\n  champ5?: AnswerType\n  champ6?: AnswerType\n  rectangle1?: AnswerType\n  rectangle2?: AnswerType\n  rectangle3?: AnswerType\n  rectangle4?: AnswerType\n  rectangle5?: AnswerType\n  rectangle6?: AnswerType\n  rectangle7?: AnswerType\n  rectangle8?: AnswerType\n  field0?: AnswerType\n  field1?: AnswerType\n  field2?: AnswerType\n  field3?: AnswerType\n  field4?: AnswerType\n  field5?: AnswerType\n  field6?: AnswerType\n  field7?: AnswerType\n  field8?: AnswerType\n\n  // on va aller jusque 8 pour l'instant, si besoin on en ajoutera\n  L1C1?: AnswerType\n  L1C2?: AnswerType\n  L1C3?: AnswerType\n  L1C4?: AnswerType\n  L1C5?: AnswerType\n  L2C1?: AnswerType\n  L2C2?: AnswerType\n  L2C3?: AnswerType\n  L2C4?: AnswerType\n  L2C5?: AnswerType\n  L3C1?: AnswerType\n  L3C2?: AnswerType\n  L3C3?: AnswerType\n  L3C4?: AnswerType\n  L3C5?: AnswerType\n  sheetAnswer?: SheetAnswerType\n\n  // idem on en ajoutera si besoin\n  callback?: (\n    exercice: IExercice,\n    question: number,\n    variables: [string, AnswerType][],\n    bareme: (listePoints: number[]) => [number, number],\n  ) => {\n    isOk: boolean\n    feedback: string\n    score: { nbBonnesReponses: number; nbReponses: number }\n  }\n}\n\nexport interface ValeurNormalized {\n  bareme?: (listePoints: number[]) => [number, number]\n  feedback?: (saisies: Record<string, string>) => string\n  reponse?: AnswerNormalizedType\n  champ1?: AnswerNormalizedType\n  champ2?: AnswerNormalizedType\n  champ3?: AnswerNormalizedType\n  champ4?: AnswerNormalizedType\n  champ5?: AnswerNormalizedType\n  champ6?: AnswerNormalizedType\n  rectangle1?: AnswerNormalizedType\n  rectangle2?: AnswerNormalizedType\n  rectangle3?: AnswerNormalizedType\n  rectangle4?: AnswerNormalizedType\n  rectangle5?: AnswerNormalizedType\n  rectangle6?: AnswerNormalizedType\n  rectangle7?: AnswerNormalizedType\n  rectangle8?: AnswerNormalizedType\n  field0?: AnswerNormalizedType\n  field1?: AnswerNormalizedType\n  field2?: AnswerNormalizedType\n  field3?: AnswerNormalizedType\n  field4?: AnswerNormalizedType\n  field5?: AnswerNormalizedType\n  field6?: AnswerNormalizedType\n  field7?: AnswerNormalizedType\n  field8?: AnswerNormalizedType\n\n  L1C1?: AnswerNormalizedType\n  L1C2?: AnswerNormalizedType\n  L1C3?: AnswerNormalizedType\n  L1C4?: AnswerNormalizedType\n  L1C5?: AnswerNormalizedType\n  L2C1?: AnswerNormalizedType\n  L2C2?: AnswerNormalizedType\n  L2C3?: AnswerNormalizedType\n  L2C4?: AnswerNormalizedType\n  L2C5?: AnswerNormalizedType\n  L3C1?: AnswerNormalizedType\n  L3C2?: AnswerNormalizedType\n  L3C3?: AnswerNormalizedType\n  L3C4?: AnswerNormalizedType\n  L3C5?: AnswerNormalizedType\n  sheetAnswer?: SheetAnswerType\n  callback?: (\n    exercice: IExercice,\n    question: number,\n    variables: [string, AnswerNormalizedType][],\n    bareme: (listePoints: number[]) => [number, number],\n  ) => {\n    isOk: boolean\n    feedback: string\n    score: { nbBonnesReponses: number; nbReponses: number }\n  }\n}\n\n/**\n * Type pour une valeur normalise (aprs traitement)\n */\n\n/**\n * Type guard pour vrifier si une valeur est de type Valeur\n */\nexport function isValeur(value: unknown): value is Valeur {\n  return typeof value === 'object' && value !== null\n}\n\n/**\n * Dtecte structurellement une FractionEtendue sans dpendance runtime.\n * On considre qu'un objet avec une mthode sommeFraction est une FractionEtendue.\n */\nexport function isFractionEtendue(x: unknown): x is IFractionEtendue {\n  return (\n    typeof x === 'object' &&\n    x !== null &&\n    typeof (x as any).sommeFraction === 'function'\n  )\n}\n\n/**\n * Dtecte structurellement une Grandeur sans dpendance runtime.\n * On considre qu'un objet avec une proprit uniteDeReference est une Grandeur.\n */\nexport function isGrandeur(x: unknown): x is IGrandeur {\n  return (\n    typeof x === 'object' &&\n    x !== null &&\n    typeof (x as any).uniteDeReference === 'string'\n  )\n}\n\n/**\n * Dtecte structurellement un Decimal sans utiliser instanceof.\n * On vrifie la prsence de quelques mthodes caractristiques des instances Decimal.\n */\nexport function isDecimal(x: unknown): x is Decimal {\n  return (\n    typeof x === 'object' &&\n    x !== null &&\n    typeof (x as any).toDP === 'function' &&\n    typeof (x as any).toFixed === 'function' &&\n    typeof (x as any).plus === 'function'\n  )\n}\n\nexport interface IGrandeur {\n  readonly mesure: number\n  readonly mesureDecimal: Decimal\n  readonly unite: string\n  readonly puissanceUnite: number\n  readonly uniteDeReference: string\n  readonly prefixe: string\n  readonly puissancePrefixe: number\n  readonly latexUnit: string\n\n  convertirEn(uniteConversion: string): IGrandeur\n  estEgal(unite2: IGrandeur): boolean\n  estUneApproximation(unite2: IGrandeur, precision: number): boolean\n  toString(precision?: number): string\n  toTex(precision?: number): string\n  toHHMMSS(): string\n}\n\nexport interface ReponseParams {\n  digits?: number\n  decimals?: number\n  signe?: boolean\n  exposantNbChiffres?: number\n  exposantSigne?: boolean\n  approx?: number | 'intervalleStrict'\n  aussiCorrect?: number | IFractionEtendue\n  digitsNum?: number\n  digitsDen?: number\n  basePuissance?: number\n  exposantPuissance?: number\n  baseNbChiffres?: number\n  milieuIntervalle?: number\n  formatInteractif?: InteractivityType | OldFormatInteractifType\n  precision?: number\n  scoreapprox?: number\n  vertical?: boolean\n  strict?: boolean\n  vhead?: boolean\n  tpoint?: string\n}\n\nexport type AnswerValueType =\n  | string\n  | string[]\n  | number\n  | number[]\n  | IFractionEtendue\n  | Decimal\n  | IGrandeur\n  | Hms\n  | IGrandeur[]\n  | Hms[]\n  | Decimal[]\n  | IFractionEtendue[]\n\nexport function isAnswerValueType(value: unknown): value is AnswerValueType {\n  return (\n    typeof value === 'string' ||\n    (Array.isArray(value) &&\n      value.every((value) => typeof value === 'string')) ||\n    typeof value === 'number' ||\n    (Array.isArray(value) &&\n      value.every((value) => typeof value === 'number')) ||\n    isFractionEtendue(value) ||\n    (Array.isArray(value) && value.every((v) => isFractionEtendue(v))) ||\n    isDecimal(value) ||\n    (Array.isArray(value) && value.every((v) => isDecimal(v))) ||\n    isGrandeur(value) ||\n    (Array.isArray(value) && value.every((v) => isGrandeur(v))) ||\n    value instanceof Hms ||\n    (Array.isArray(value) && value.every((value) => value instanceof Hms))\n  )\n}\n\nexport type ReponseComplexe = Valeur\n\nexport function isReponseComplexe(value: unknown): value is ReponseComplexe {\n  return isValeur(value)\n}\n\n// Ajout d'un type ddi pour les choix de QCM\nexport type ChoixQcm = {\n  texte: string // obligatoire pour les QCM interactif mais facultatif pour les QCM AMC (le forcer  vide si besoin)\n  statut?: boolean | string | number // boolean pour les QCM interacif et string | number pour les QCM AMC\n  // Ci-dessous, utile que pour AMC\n  sanscadre?: boolean\n  enonce?: string\n  feedback?: string\n  multicolsBegin?: boolean\n  multicolsEnd?: boolean\n  numQuestionVisible?: boolean\n  pointilles?: boolean\n  reponse?: {\n    texte?: string\n    valeur?: number | number[] | FractionEtendue\n    alignement?: string\n    param?: {\n      digits?: number\n      decimals?: number\n      signe?: boolean\n      digitsNum?: number\n      digitsDen?: number\n      approx?: number\n      aussiCorrect?: number\n      exposantNbChiffres?: number\n      exposantSigne?: boolean\n    }\n  }\n}\n\nexport type UneProposition = {\n  texte?: string\n  statut?: number | boolean | string\n  sanscadre?: boolean | number\n  multicolsBegin?: boolean\n  multicolsEnd?: boolean\n  numQuestionVisible?: boolean\n  type?: string\n  feedback?: string\n  pointilles?: boolean | number\n  enonce?: string\n  propositions?: ChoixQcm[]\n  options?: {\n    ordered?: boolean\n    vertical?: boolean\n    lastChoice?: number\n    barreseparation?: boolean\n    multicols?: boolean\n    nbCols?: number\n    digits?: number\n    decimals?: number\n    signe?: boolean\n    exposantNbChiffres?: number\n    exposantSigne?: boolean\n    approx?: number\n    multicolsAll?: boolean\n    numerotationEnonce?: boolean\n    avecSymboleMult?: boolean\n  }\n  reponse?: {\n    valeur?:\n      | ValeurNormalized\n      | ValeurNormalized[]\n      | number\n      | number[]\n      | IFractionEtendue\n      | Decimal\n      | IFractionEtendue[]\n      | Decimal[]\n      | string\n      | string[]\n    param?: ReponseParams\n    textePosition?: string\n    texte?: string\n    alignement?: string\n  }\n}\n\nexport type LegacyReponse =\n  | string\n  | IFractionEtendue\n  | Decimal\n  | number\n  | IGrandeur\nexport type LegacyReponses = LegacyReponse[] | LegacyReponse\n\nexport interface AutoCorrection {\n  enonce?: string\n  enonceAvant?: boolean\n  melange?: boolean\n  enonceAGauche?: boolean | [number, number]\n  enonceAvantUneFois?: boolean\n  enonceCentre?: boolean\n  enonceApresNumQuestion?: boolean\n  propositions?: UneProposition[]\n  reponse?: {\n    valeur?: ValeurNormalized\n    param?: ReponseParams\n    textePosition?: string\n    texte?: string\n  }\n  options?: {\n    radio?: boolean\n    ordered?: boolean\n    vertical?: boolean\n    lastChoice?: number\n    barreseparation?: boolean\n    multicols?: boolean\n    nbCols?: number\n    digits?: number\n    decimals?: number\n    signe?: boolean\n    exposantNbChiffres?: number\n    exposantSigne?: boolean\n    approx?: number\n    multicolsAll?: boolean\n    numerotationEnonce?: boolean\n    avecSymboleMult?: boolean\n  }\n}\n\nexport interface MathaleaSVG extends SVGSVGElement {\n  etat: boolean\n  hasMathaleaListener: boolean\n}\n\nexport type ResultOfExerciceInteractif = {\n  numberOfPoints: number\n  numberOfQuestions: number\n}\n\n// Pour retro compatibilit avec setReponse\nexport type OldFormatInteractifType =\n  | 'calcul'\n  | 'texte'\n  | 'tableauMathlive'\n  | 'Num'\n  | 'Den'\n  | 'fractionEgale'\n  | 'unites'\n  | 'intervalleStrict'\n  | 'intervalle'\n  | 'puissance'\n  | 'canonicalAdd'\n  | 'ignorerCasse'\nexport function isOldFormatInteractifType(\n  value: unknown,\n): value is OldFormatInteractifType {\n  return (\n    value === 'calcul' ||\n    value === 'texte' ||\n    value === 'tableauMathlive' ||\n    value === 'Num' ||\n    value === 'Den' ||\n    value === 'fractionEgale' ||\n    value === 'unites' ||\n    value === 'intervalleStrict' ||\n    value === 'intervalle' ||\n    value === 'puissance' ||\n    value === 'canonicalAdd' ||\n    value === 'ignorerCasse'\n  )\n}\n\nexport interface IExercice {\n  titre: string\n  id?: string\n  uuid: string\n  sup: any\n  sup2: any\n  sup3: any\n  sup4: any\n  sup5: any\n  exoCustomResultat?: boolean\n  duree?: number\n  seed?: string\n  numeroExercice?: number\n  typeExercice?: string\n  duration?: number\n  consigne: string\n  consigneCorrection: string\n  introduction: string\n  listeQuestions: string[]\n  listeCorrections: string[]\n  listeCanReponsesACompleter: string[]\n  listeCanEnonces: string[]\n  listeCanLiees: number[][]\n  listeCanNumerosLies: number[]\n  question?: string\n  reponse?: AnswerValueType | Valeur\n  correction?: string\n  canOfficielle?: boolean\n  canEnonce?: string\n  canReponseACompleter: string\n  canNumeroLie: number\n  canLiee: number[]\n  formatChampTexte: string | PartialKbType | undefined\n  optionsChampTexte?: object\n  compare?:\n    | ((\n        input: string,\n        goodAnswer: string,\n      ) => { isOk: boolean; feedback?: string })\n    | ((\n        input: string,\n        goodAnswer: IGrandeur,\n      ) => { isOk: boolean; feedback?: string })\n  optionsDeComparaison?: Partial<OptionsComparaisonType>\n  formatInteractif?: InteractivityType | OldFormatInteractifType\n  contenu?: string\n  contenuCorrection?: string\n  autoCorrection: AutoCorrection[]\n  figures?: Figure[] | ClickFigures[]\n  amcReady?: boolean\n  amcType?: string\n  tableauSolutionsDuQcm?: object[]\n  spacing: number\n  spacingCorr: number\n  pasDeVersionLatex: boolean\n  listePackages?: string[]\n  consigneModifiable: boolean\n  nbQuestionsModifiable: boolean\n  nbCols: number\n  nbColsCorr: number\n  nbColsModifiable: boolean\n  nbColsCorrModifiable: boolean\n  spacingModifiable: boolean\n  spacingCorrModifiable: boolean\n  listeAvecNumerotation?: boolean\n  beamer: boolean\n  nbQuestions: number\n  pointsParQuestions: number\n  correctionDetailleeDisponible: boolean\n  correctionDetaillee: boolean\n  correctionIsCachee: boolean\n  video: string\n  interactif: boolean\n  interactifObligatoire: boolean\n  interactifReady: boolean\n  interactifType?: string\n  besoinFormulaireNumerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n  besoinFormulaireTexte: boolean | [string, string]\n  besoinFormulaireCaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire2Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n  besoinFormulaire2Texte: boolean | [string, string]\n  besoinFormulaire2CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire3Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n  besoinFormulaire3Texte: boolean | [string, string]\n  besoinFormulaire3CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire4Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n  besoinFormulaire4Texte: boolean | [string, string]\n  besoinFormulaire4CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire5Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n  besoinFormulaire5Texte: boolean | [string, string]\n  besoinFormulaire5CaseACocher: boolean | [string] | [string, boolean]\n  listeArguments: string[]\n  lastCallback: string\n  checkSum?: string\n  examen?: string\n  mois?: string\n  annee?: string\n  lieu?: string\n  content?: string\n  contentCorr?: string\n  comment?: string\n  answers?: { [key: string]: string }\n  dragAndDrops?: IDragAndDrop[]\n  isDone?: boolean\n  html: HTMLElement\n  key: string\n  score?: number\n  vspace?: number\n\n  destroy(): void\n  nouvelleVersionWrapper: (...args: any[]) => void\n  correctionInteractive?(i: number): string | string[]\n  nouvelleVersion(numeroExercice?: number, numeroQuestion?: number): void\n  reinit: (...args: any[]) => void\n  applyNewSeed: (...args: any[]) => void\n  questionJamaisPosee: (...args: any[]) => boolean\n}\n\nexport interface IExerciceSimple extends IExercice {\n  typeExercice: 'simple'\n  distracteurs: (string | number)[]\n  versionQcmDisponible?: boolean\n  versionQcm?: boolean\n}\n\nexport interface IExerciceStatique {\n  typeExercice: 'statique'\n  uuid: string\n  content: string\n  contentCorr: string\n  annee: any\n  lieu: any\n  mois: any\n  numeroInitial: any\n  examen: string\n}\n\nexport interface IEtiquette {\n  id: string\n  contenu: string\n  duplicable?: boolean\n  callback?: (e: Event) => void\n}\n\nexport type DragHandler = (event: DragEvent) => void\nexport type TouchHandler = (event: TouchEvent) => void\n\nexport interface IDragAndDrop {\n  exercice: IExercice\n  question: number\n  consigne: string\n  etiquettes: IEtiquette[][]\n  enonceATrous: string\n  listeners: [Element, string, DragHandler | TouchHandler][]\n\n  ajouteDragAndDrop(options: { melange: boolean; duplicable: boolean }): string\n}\n\nexport interface IExerciceBrevet extends IExercice {\n  enonce: string\n  checksum: string\n  versionAleatoire?: (i: number) => void\n  versionOriginale: () => void\n}\n\nexport interface IExerciceBrevetA extends IExerciceBrevet {\n  versionAleatoire: (i: number) => void\n}\n\nexport interface IExerciceCan extends IExerciceSimple {\n  canOfficielle?: boolean\n}\n\nexport interface IExerciceQcmOptions {\n  ordered?: boolean\n  vertical?: boolean\n  lastChoice?: number\n}\n\nexport interface IExerciceQcm extends IExercice {\n  versionQcm?: boolean\n  versionQcmDisponible: boolean\n  enonce: string\n  reponses: string[]\n  bonnesReponses?: boolean[]\n  corrections?: string[]\n  options: IExerciceQcmOptions\n  ajouteQcmCorr: boolean\n  versionAleatoire?: () => void\n  versionOriginale?: () => void\n  qcmCamExport(): { question: string; reponse: string }[]\n}\n\nexport interface IExerciceQcmA extends IExerciceQcm {\n  versionAleatoire: () => void\n  aleatoire: () => void\n}\n","import uuidToUrl from '../../json/uuidsToUrlFR.json'\n\n/**\n * Dtermine si l'uuid a un prfixe d'exercice statique\n * @param uuid\n * @returns boolean\n */\n\nexport function isStatic(uuid: string | undefined) {\n  if (uuid === undefined) {\n    return false\n  }\n  return (\n    uuid.startsWith('crpe') ||\n    uuid.startsWith('dnb_') ||\n    uuid.startsWith('dnbpro_') ||\n    uuid.startsWith('e3c_') ||\n    uuid.startsWith('bac_') ||\n    uuid.startsWith('sti2d_') ||\n    uuid.startsWith('evacom_') ||\n    uuid.startsWith('eam_') ||\n    uuid.startsWith('stl_') ||\n    uuid.startsWith('sti2d_') ||\n    uuid.startsWith('2nd_')\n  )\n}\n\nexport function isSvelte(uuid: string) {\n  const urlExercice = uuidToUrl[uuid as keyof typeof uuidToUrl]\n  return urlExercice && urlExercice.includes('.svelte')\n}\n","/**\n * Calcule et attribue la taille (largeur et hauteur) des SVGs et adapte la position des `divLatex`  l'intrieur\n * du SVG. Le principe est le suivant : on rcupre la largeur du container parent (passe en paramtre)\n * et on calcule la largeur du SVG en multipliant la largeur du parent par le coefficient pass en paramtre.\n * Les ratioi sont calculs en fonction de ces deux largeurs pour la hauteur et les positions des divLatex.\n * @param parent container contenant la question CAN et des figures SVG ventuelles\n * @param coef coefficient de rduction par rapport  la larguer du parent (sert dans le calcul de la largeur)\n */\nexport const setSizeWithinSvgContainer = (parent: HTMLDivElement) => {\n  if (parent.classList.contains('hidden')) {\n    // si la question est cache, on ne fait rien\n    return\n  }\n\n  if (parent.firstElementChild === null) {\n    return\n  }\n\n  const originalClientWidth = parent.clientWidth\n  const originalClientHeight = parent.clientHeight\n\n  let zoom = 3 // parseFloat(fontSize) / 16\n  parent.style.fontSize = `${zoom}rem` // on remet zoom  3... au dpart\n\n  const svgContainers = parent.getElementsByClassName('svgContainer')\n\n  do {\n    if (svgContainers.length > 0) {\n      for (const svgContainer of svgContainers) {\n        svgContainer.classList.add('flex')\n        svgContainer.classList.add('justify-center')\n        updateFigures(svgContainer, zoom)\n      }\n    }\n    if (\n      parent.firstElementChild.scrollHeight > originalClientHeight ||\n      parent.firstElementChild.scrollWidth > originalClientWidth\n    ) {\n      zoom -= 0.2\n      if (zoom >= 1) parent.style.fontSize = `${zoom}rem`\n    }\n  } while (\n    zoom > 0.6 &&\n    (parent.firstElementChild.scrollHeight > originalClientHeight ||\n      parent.firstElementChild.scrollWidth > originalClientWidth)\n  )\n}\n// Pour les schmas en boite\n\nfunction resizeSchemaContainer(schemaContainer: HTMLElement, zoom: number) {\n  const originalWidth =\n    schemaContainer.dataset.originalWidth || schemaContainer.scrollWidth\n  const originalHeight =\n    schemaContainer.dataset.originalHeight || schemaContainer.scrollHeight\n\n  // Store the original dimensions if not already stored\n  if (!schemaContainer.dataset.originalWidth) {\n    schemaContainer.dataset.originalWidth = originalWidth.toString()\n  }\n  if (!schemaContainer.dataset.originalHeight) {\n    schemaContainer.dataset.originalHeight = originalHeight.toString()\n  }\n\n  // Apply the zoom\n  // schemaContainer.style.transform = `scale(${zoom})`\n  // schemaContainer.style.transformOrigin = 'top left'\n\n  schemaContainer.style.height = `${Math.round(parseFloat(String(originalHeight)) * zoom)}px`\n  schemaContainer.style.width = `${Math.round(parseFloat(String(originalWidth)) * zoom)}px`\n}\n\nexport function resizeContent(container: HTMLElement | null, zoom: number) {\n  const ZOOM_MIN = 0.2\n  if (!container) return\n  // mathalea2d\n  const svgContainers = container.getElementsByClassName('svgContainer') ?? []\n  for (const svgContainer of svgContainers) {\n    updateFigures(svgContainer, Math.max(zoom, ZOOM_MIN))\n  }\n  // Scratch\n  const scratchDivs = container.getElementsByClassName('scratchblocks')\n  for (const scratchDiv of scratchDivs) {\n    const svgDivs = scratchDiv.getElementsByTagName('svg')\n    resizeTags([...svgDivs], Math.max(zoom, ZOOM_MIN))\n  }\n  // Checkboxes des QCM\n  const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]')\n  for (const checkbox of checkboxes) {\n    if (checkbox instanceof HTMLInputElement) {\n      resizeTags([checkbox], Math.max(zoom, ZOOM_MIN))\n    }\n  }\n  // Schmas en boite\n  const schemaContainers =\n    container.getElementsByClassName('SchemaContainer') ?? []\n  for (const schemaContainer of schemaContainers) {\n    resizeSchemaContainer(\n      schemaContainer as HTMLElement,\n      Math.max(zoom, ZOOM_MIN),\n    )\n  }\n  // Texte\n  container.style.fontSize = `${Math.max(zoom, ZOOM_MIN)}rem`\n}\n\nexport function updateFigures(svgContainer: Element, zoom: number) {\n  const svgDivs = svgContainer.querySelectorAll<SVGElement>('.mathalea2d')\n  for (const svgDiv of svgDivs) {\n    if (svgDiv instanceof SVGElement) {\n      const figure = svgDiv\n      const width = figure.getAttribute('width')\n      const height = figure.getAttribute('height')\n      if (!figure.dataset.widthInitiale && width != null)\n        figure.dataset.widthInitiale = width\n      if (!figure.dataset.heightInitiale && height != null)\n        figure.dataset.heightInitiale = height\n      const newHeight = (\n        Number(figure.dataset.heightInitiale) * zoom\n      ).toString()\n      const newWidth = (Number(figure.dataset.widthInitiale) * zoom).toString()\n      if (newHeight !== height) {\n        figure.setAttribute(\n          'height',\n          (Number(figure.dataset.heightInitiale) * zoom).toString(),\n        )\n      }\n      if (newWidth !== width) {\n        figure.setAttribute(\n          'width',\n          (Number(figure.dataset.widthInitiale) * zoom).toString(),\n        )\n      }\n\n      // accorder la position des lments dans la figure SVG\n      const eltsInVariationTables =\n        svgContainer.getElementsByClassName('divLatex') ?? []\n      for (const elt of eltsInVariationTables) {\n        const e = elt as HTMLDivElement\n        if (!e.dataset.top) e.dataset.top = e.style.top.replace('px', '')\n        if (!e.dataset.left) e.dataset.left = e.style.left.replace('px', '')\n        const initialTop = Number(e.dataset.top)\n        const initialLeft = Number(e.dataset.left)\n        e.style.setProperty('top', (initialTop * zoom).toString() + 'px')\n        e.style.setProperty('left', (initialLeft * zoom).toString() + 'px')\n      }\n    }\n  }\n}\n\n/**\n * Change la taille de tous les divs passs en paramtres.\n *\n * On teste l'existence des attributs directs `width` et`height`.\n *\n * - S'ils existent, on sauvegarde leurs valeurs initiales dans le data-set (si besoin)\n *  et on applique le facteur d'chelle\n * - S'ils n'existent pas, on travaillent avec le style directement\n * (`width` et `height` peuvent avoir des units diffrentes).\n * @param {HTMLOrSVGElement[]} tags Liste des divs  inspecter et changer\n * @param {number} factor facteur d'agrandissement par rapport  la taille initiale\n */\nexport const resizeTags = (\n  tags: HTMLElement[] | SVGElement[],\n  factor: number = 1,\n) => {\n  let widthUnit, heightUnit: string\n  for (const tag of tags) {\n    const widthAttributeExists: boolean = tag.hasAttribute('width')\n    const heightAttributeExists: boolean = tag.hasAttribute('height')\n    if (tag.hasAttribute('data-width') === false) {\n      let originalWidth: string | null\n      if (widthAttributeExists) {\n        originalWidth = tag.getAttribute('width')\n      } else {\n        const width = tag.style.width\n        const units = width.match(/\\D/g) ?? []\n        widthUnit = units.join('')\n        originalWidth = String(\n          parseFloat(tag.style.width.replace(widthUnit, '')),\n        )\n      }\n      tag.dataset.width = originalWidth ?? '50'\n    }\n    if (\n      !widthAttributeExists &&\n      tag.hasAttribute('data-width-unit') === false\n    ) {\n      tag.dataset.widthUnit = widthUnit\n    }\n    if (tag.hasAttribute('data-height') === false) {\n      let originalHeight: string | null\n      if (heightAttributeExists) {\n        originalHeight = tag.getAttribute('height')\n        heightUnit = 'px'\n      } else {\n        const height = tag.style.height\n        const units = height.match(/\\D/g) ?? []\n        heightUnit = units.join('')\n        originalHeight = String(\n          parseFloat(tag.style.height.replace(heightUnit, '')),\n        )\n      }\n      tag.dataset.height = originalHeight ?? '30'\n    } else {\n      heightUnit = 'px'\n    }\n\n    if (\n      !heightAttributeExists &&\n      tag.hasAttribute('data-height-unit') === false\n    ) {\n      tag.dataset.heightUnit = heightUnit\n    }\n    const w = Number(tag.getAttribute('data-width')) * factor\n    const h = Number(tag.getAttribute('data-height')) * factor\n    if (widthAttributeExists && heightAttributeExists) {\n      tag.setAttribute('width', String(w))\n      tag.setAttribute('height', String(h))\n    } else {\n      tag.setAttribute(\n        'style',\n        'width:' +\n          String(w) +\n          tag.dataset.widthUnit +\n          '; height:' +\n          String(h) +\n          tag.dataset.heightUnit +\n          ';',\n      )\n    }\n  }\n}\n\nexport const updateIframeSize = (\n  container: HTMLDivElement,\n  iframe: HTMLIFrameElement,\n) => {\n  if (container.offsetWidth !== 0) {\n    iframe.setAttribute('width', '100%')\n    iframe.setAttribute('height', iframe.offsetWidth * 0.75 + '')\n  }\n}\n","/**\n * Retourne une chane formatte pour afficher une dure en (XXh XXmin XXs)\n * @param {number} nbOfSeconds dure en secondes\n * @return {string} dure en h min s\n */\nexport function formattedTimeStamp(nbOfSeconds: number): string {\n  const nbOfHours = Math.floor(nbOfSeconds / 3600)\n  const nbOfMinutes = Math.floor((nbOfSeconds - nbOfHours * 3600) / 60)\n  const nbOfSecondsLeft = nbOfSeconds - nbOfHours * 3600 - nbOfMinutes * 60\n  if (nbOfHours > 0) {\n    return `${nbOfHours}h ${nbOfMinutes}min ${nbOfSecondsLeft}s`\n  } else {\n    if (nbOfMinutes > 0) {\n      if (nbOfSecondsLeft === 0) {\n        return `${nbOfMinutes}min`\n      } else {\n        return `${nbOfMinutes}min ${nbOfSecondsLeft}s`\n      }\n    } else {\n      return `${nbOfSecondsLeft}s`\n    }\n  }\n}\n\n/**\n * Gestion du message dans le modal de rglage de la dure de projection\n * @param duree valeur de la dure en secondes retourne par le curseur\n */\nexport function setPhraseDuree(duree: number) {\n  if (duree >= 2) return duree + ' secondes'\n  else if (duree === 0) return 'Dfilement manuel'\n  else return duree + ' seconde'\n}\n\n/**\n * Fabriquer une chane de caractres unique base sur un time stamp.\n * @param {string} prefix Prfixe  ajouter devant la chane de caractres unique (vide par dfaut)\n * @returns {string} La chane de caractre unique\n * @author sylvain\n */\nexport function getUniqueStringBasedOnTimeStamp(prefix: string = '') {\n  // /!\\ ATTENTION new Date().getTime() est en ms et n'est pas assez prcis pour donner des chanes uniques\n  // Mais utiliser Math.random peut interfrer avec d'autres usages de Math.random dans l'application et gner la gnration de valeurs alatoires reproductibles\n  const timeStamp = String(new Date().getTime())\n  // const timeStamp = String(\n  //   performance.now().toString().replace('.', '') + Math.random(),\n  // ).replace('.', '')\n  return `${prefix}${timeStamp}`\n}\n\n/**\n * Permet de retarder l'appel d'une fonction. Utiliser pour les frappes au clavier par exemple\n * pour ne pas activer la recherche immdiatement aprs qu'un caractre ait t saisi.\n * @see https://stackoverflow.com/a/72207078/6625987\n * @param callback fonction  appeler lorsque le dlai est pass\n * @param delay dlais (en millisecondes)\n * @param immediate flag pour court-circuiter le dlai\n * @returns {void}\n */\nexport function debounce<T extends (...args: any[]) => void>(\n  callback: T,\n  delay: number = 20,\n  immediate: boolean = false,\n) {\n  let timeout: ReturnType<typeof setTimeout> | null\n\n  return function <U>(this: U, ...args: Parameters<typeof callback>) {\n    const later = () => {\n      timeout = null\n\n      if (!immediate) {\n        callback.apply(this, args)\n      }\n    }\n    const callNow = immediate && !timeout\n\n    if (typeof timeout === 'number') {\n      clearTimeout(timeout)\n    }\n\n    timeout = setTimeout(later, delay)\n\n    if (callNow) {\n      callback.apply(this, args)\n    }\n  }\n}\n\n/**\n * Compte  rebours\n * @param time {number} le temps  dcompter en ms\n * @returns promise\n */\nexport function delay(time: number) {\n  return new Promise((resolve) => setTimeout(resolve, time))\n}\n\n/**\n * Calcule le nombre de minnutes et de secondes dans une dure donne en millisecondes\n * et renvoie ces deux nombres dans un objet.\n * @param milliseconds dure en millisecondes\n * @returns un objet constitu du nombre de minutes et du nombre de secondes\n */\nexport function millisecondToMinSec(milliseconds: number): {\n  minutes: number\n  seconds: number\n} {\n  const seconds = Math.floor((milliseconds / 1000) % 60)\n  const minutes = Math.floor((milliseconds / 1000 / 60) % 60)\n  return { minutes, seconds }\n}\n","/*\nCode inspir de Sylvain, merci!\nhttps://stackoverflow.com/questions/55020193/is-it-possible-to-create-a-typescript-type-from-an-array\n*/\nconst VueTypeArray = <const>[\n  'alacarte',\n  'diaporama',\n  'can',\n  'eleve',\n  'latex',\n  'pdf',\n  'raw',\n  'confeleve',\n  'amc',\n  'anki',\n  'moodle',\n  'l',\n  'l2',\n  'overview',\n  'myriade',\n  'indices',\n  '',\n]\ntype VueTypeArrayType = typeof VueTypeArray\nexport type VueType = VueTypeArrayType[number] // equiv to diaporama' | 'can' | 'eleve' | 'latex' | 'confeleve' | 'amc' | 'anki' | 'moodle' | 'l' | 'l2' | 'overview'\n\n// export type VueType = 'diaporama' | 'can' | 'eleve' | 'latex' | 'confeleve' | 'amc' | 'anki' | 'moodle' | 'l' | 'l2' | 'overview'\n\nexport const convertVueType = (type: string): VueType | undefined => {\n  return VueTypeArray.indexOf(type as VueType) < 0\n    ? undefined\n    : VueTypeArray[VueTypeArray.indexOf(type as VueType)]\n}\n","import { get } from 'svelte/store'\nimport { type InterfaceGlobalOptions } from '../../lib/types'\nimport { type VueType } from '../VueType'\nimport { canOptions } from '../stores/canStore'\nimport { exercicesParams } from '../stores/generalStore'\nimport { globalOptions } from '../stores/globalOptions'\nimport { buildDsParams } from './buildDsParams'\n\nexport class MathAleaURL extends URL {\n  /**\n   * Utilise l'URL courante pour fabriquer l'URL lors de l' appel new MathAleaURL()\n   */\n  constructor(url?: string) {\n    if (url === undefined) {\n      url = document.URL\n    }\n    super(url)\n  }\n\n  /**\n   * Utilise le store exercicesParams pour fabriquer l'URL (utile pour les recorders qui freezent l'url)\n   */\n  static fromExercisesParams(): MathAleaURL {\n    const url = new URL(\n      window.location.protocol +\n        '//' +\n        window.location.host +\n        window.location.pathname,\n    )\n    const params = get(exercicesParams)\n    for (const ex of params) {\n      url.searchParams.append('uuid', ex.uuid)\n      if (ex.id != null) url.searchParams.append('id', ex.id)\n      if (ex.nbQuestions !== undefined)\n        url.searchParams.append('n', ex.nbQuestions.toString())\n      if (ex.duration != null)\n        url.searchParams.append('d', ex.duration.toString())\n      if (ex.sup != null) url.searchParams.append('s', ex.sup)\n      if (ex.sup2 != null) url.searchParams.append('s2', ex.sup2)\n      if (ex.sup3 != null) url.searchParams.append('s3', ex.sup3)\n      if (ex.sup4 != null) url.searchParams.append('s4', ex.sup4)\n      if (ex.sup5 != null) url.searchParams.append('s5', ex.sup5)\n      if (ex.versionQcm != null) url.searchParams.append('qcm', ex.versionQcm)\n      if (ex.alea != null) url.searchParams.append('alea', ex.alea)\n      if (ex.interactif === '1') url.searchParams.append('i', '1')\n      if (ex.cd != null) url.searchParams.append('cd', ex.cd)\n      if (ex.cols != null) url.searchParams.append('cols', ex.cols.toString())\n    }\n    return new MathAleaURL(url.toString())\n  }\n\n  /**\n   * Retire de l'URL le paramtre fourni et retourne l'URL modifie\n   * @param paramToBeRemoved paramtre  supprimer dans l'URL (seulement les proprits de InterfaceGlobalOptions sont permises )\n   * @returns l'URL\n   */\n  removeParam(paramToBeRemoved: keyof InterfaceGlobalOptions): MathAleaURL {\n    this.searchParams.delete(paramToBeRemoved)\n    return this\n  }\n\n  /**\n   * Ajoute un paramtre avec sa valeur  l'URL et retourne l'URL modifie\n   * @param param paramtre  ajouter (seulement les proprits de InterfaceGlobalOptions sont permises)\n   * @param value valeur du paramtre\n   * @returns l'URL\n   */\n  addParam(param: keyof InterfaceGlobalOptions, value: string): MathAleaURL {\n    this.searchParams.append(param, value)\n    return this\n  }\n\n  /**\n   * Supprime la graine de l'alatoire de l'URL et retourne l'URL modifie\n   */\n  removeSeed(): MathAleaURL {\n    this.searchParams.delete('alea')\n    return this\n  }\n\n  /**\n   * Ajoute (ou remplace) un paramtre avec sa valeur  l'URL et retourne l'URL modifie\n   * @param param paramtre  ajouter (seulement les proprits de InterfaceGlobalOptions sont permises)\n   * @param value valeur du paramtre\n   * @returns l'URL\n   */\n  setParam(param: keyof InterfaceGlobalOptions, value: string): MathAleaURL {\n    this.searchParams.set(param, value)\n    return this\n  }\n\n  /**\n   * Ajoute/remplace une vue cible  l'URL et retourne cette URL\n   * @param value la vue cible\n   * @returns l'URL\n   */\n  setVue(value: VueType): MathAleaURL {\n    this.setParam('v', value)\n    return this\n  }\n}\n\n/**\n * Construit l'URL pour la feuille lve en mettant tous les paramtres existants et ceux des rglages de la page de configuration\n * @param view la vue dans laquelle va s'afficher la srie d'exercice\n * @param mode le mode de prsentation des exercices\n * @returns l'URL correspondant  la feuille d'exercices avec tous les paramtres\n */\nexport function buildMathAleaURL(options: {\n  view?: VueType\n  mode?: InterfaceGlobalOptions['presMode']\n  isEncrypted?: boolean\n  isShort?: boolean\n  removeSeed?: boolean\n  /** S'il y a un recorder l'url est cache et doit tre construite  partir du store exercicesParams */\n  recorder?: 'Moodle'\n}): URL {\n  const url = options.recorder\n    ? MathAleaURL.fromExercisesParams()\n    : new MathAleaURL()\n  if (options.removeSeed) {\n    url.removeSeed()\n  }\n  const global = get(globalOptions)\n  const can = get(canOptions)\n  if (options.view)\n    url.setVue(options.view).addParam('es', buildEsParams(options.mode))\n  if (options.view === 'can') {\n    // paramtres spcifiques  la can dans l'URL\n    url\n      .addParam('canD', (can.durationInMinutes ?? 1).toString())\n      .addParam('canT', can.subTitle.toString())\n      .addParam('canSA', can.solutionsAccess ? '1' : '0')\n      .addParam('canSM', can.solutionsMode)\n      .addParam('canI', can.isInteractive ? '1' : '0')\n  } else if (options.view === 'diaporama') {\n    url.addParam('ds', buildDsParams())\n    if (\n      global.select !== undefined &&\n      global.select !== undefined &&\n      global.select.length > 0 &&\n      global.select.length < get(exercicesParams).length\n    ) {\n      url.addParam('select', global.select.join('-'))\n    }\n    if (\n      global.order !== undefined &&\n      global.order.length > 0 &&\n      global.shuffle\n    ) {\n      url.addParam('order', global.order.join('-'))\n    }\n  } else {\n    const title = global.title ?? 'valuation'\n    if (title !== '') {\n      url.addParam('title', encodeURIComponent(title))\n    }\n  }\n  if (global.beta) {\n    url.addParam('beta', '1')\n  }\n  const cryptedUrl = options.isEncrypted\n    ? encrypt(url.toString())\n    : url.toString()\n  return new URL(cryptedUrl)\n}\n\n/**\n * Construit la chane reprsentant les rglages de la vue lve/can\n * @param mode mode de prsentation\n * @returns la chane de 6 chiffres reprsentant le setup\n */\nexport function buildEsParams(\n  mode?: InterfaceGlobalOptions['presMode'],\n): string {\n  const options = get(globalOptions)\n  const presentationMode = new Map([\n    // sync with src/lib/stores/generalStore.ts presModeId\n    ['liste_exos', 0],\n    ['un_exo_par_page', 1],\n    ['liste_exos', 2],\n    ['une_question_par_page', 3],\n    ['recto', 4],\n    ['verso', 5],\n  ])\n  let es = ''\n  // Paramtre 'es' : presMode|setInteractive|isSolutionAccessible|isInteractiveFree|oneShot|twoColumns|isTitleDisplayed\n  es += presentationMode.get(\n    mode !== undefined ? mode : (options.presMode ?? 'liste_exos'),\n  )\n  es += options.setInteractive ?? '2'\n  es += options.isSolutionAccessible ? '1' : '0'\n  es += options.isInteractiveFree ? '1' : '0'\n  es += options.oneShot ? '1' : '0'\n  es += options.twoColumns ? '1' : '0'\n  es += options.isTitleDisplayed ? '1' : '0'\n  return es\n}\n\nexport async function getShortenedCurrentUrl(\n  addendum: string = '',\n): Promise<string> {\n  const urlObj = new URL(window.location.href)\n  const port = urlObj.port\n  const baseUrl = port ? 'https://coopmaths.fr/alea' : document.URL\n  const url = `${baseUrl}${addendum}`\n\n  try {\n    const response = await fetch(\n      `https://api.shrtco.de/v2/shorten?url=${encodeURIComponent(url)}`,\n    )\n    if (!response.ok) {\n      throw new Error('Network response was not ok.')\n    }\n    const jsonResponse = await response.json()\n    return jsonResponse.result.full_short_link\n  } catch (error) {\n    window.notify(\"Impossible de raccourcir l'url\", { error })\n    return url\n  }\n}\n\n/**\n * Encrypte la partie de l'URL aprs le point d'interrogation '?'\n * Principe : on ajoute 'EEEE' aprs le '?' pour reconnatre une URL encrypte\n * par la suite et on encode le reste de l'URL en suivant l'algorithme montr\n * [ici](https://stackoverflow.com/questions/67855828/encrypt-and-decrypt-a-string-using-simple-javascript-without-using-any-external)...\n * @param {string} url URL a encrypter\n * @returns {URL} URL encrypte\n * @author sylvain\n */\nexport function encrypt(url: string): string {\n  const urlParts = url.split('?')\n  let newUrl = urlParts[0] + '?EEEE'\n  let char, nextChar, combinedCharCode\n  let partEncrypted = ''\n  const partToEncrypt = encodeURI(urlParts[1])\n  for (let i = 0; i < partToEncrypt.length; i += 2) {\n    char = partToEncrypt.charCodeAt(i)\n    if (i + 1 < partToEncrypt.length) {\n      nextChar = partToEncrypt.charCodeAt(i + 1) - 31\n      combinedCharCode =\n        char +\n        '' +\n        nextChar.toLocaleString('fr-FR', { minimumIntegerDigits: 2 })\n      partEncrypted += String.fromCharCode(parseInt(combinedCharCode, 10))\n    } else {\n      partEncrypted += partToEncrypt.charAt(i)\n    }\n  }\n  const hexPartEncrypted = partEncrypted.split('').reduce((hex, c) => {\n    hex += c.charCodeAt(0).toString(16).padStart(4, '0')\n    return hex\n  }, '')\n  newUrl += hexPartEncrypted\n  return newUrl\n}\n\n/**\n * Dcrypte _si besoin_ une URL sur la base du cryptage prcdent\n * @param {URL} url URL  dcrypter\n * @returns {URL} URL dcrypte\n * @author sylvain\n */\nexport function decrypt(url: URL): URL {\n  const oldUrl = url.href\n  const part1 = oldUrl.slice(0, oldUrl.indexOf('?'))\n  const part2withEEEE = oldUrl.replace(part1 + '?', '')\n  let newUrl = ''\n  if (part2withEEEE.substring(0, 4) !== 'EEEE') {\n    newUrl = url.toString()\n  } else {\n    let char, codeStr, firstCharCode, lastCharCode\n    let decryptedPart = ''\n    newUrl = part1 + '?'\n    let part2 = part2withEEEE.slice(4, part2withEEEE.length) // on enlve les `EEEE`\n    const matches = part2.match(/.{1,4}/g)\n    if (matches !== null) {\n      part2 = matches.reduce(\n        (acc, char) => acc + String.fromCharCode(parseInt(char, 16)),\n        '',\n      )\n    }\n\n    for (let i = 0; i < part2.length; i++) {\n      char = part2.charCodeAt(i)\n      if (char > 132) {\n        codeStr = char.toString(10)\n        firstCharCode = parseInt(codeStr.substring(0, codeStr.length - 2), 10)\n        lastCharCode =\n          parseInt(codeStr.substring(codeStr.length - 2, codeStr.length), 10) +\n          31\n        decryptedPart +=\n          String.fromCharCode(firstCharCode) + String.fromCharCode(lastCharCode)\n      } else {\n        decryptedPart += part2.charAt(i)\n      }\n    }\n    newUrl += decryptedPart\n  }\n  return new URL(newUrl)\n}\n\n/**\n * Dtecte si une URL a t encrypte par `encrypt`\n * @param {URL} url Chane representant l'URL  analyser\n * @returns {boolean} `true` si l'URL est crypt avec la fonction `encrypt`\n */\nexport function isCrypted(url: URL): boolean {\n  return url.href.includes('?EEEE')\n}\n\n/**\n * Tlcharger un fichier connaissant l'URL\n *\n * __Exemple__\n * ```tsx\n * downloadFileFromURL(url, 'image.jpg');\n * ```\n *\n * __Paramtres__\n * @param {string} url URL du fichier  tlcharger\n * @param {string} filename nom don au fichier tlcharg\n * @see {@link https://blog.gitnux.com/code/javascript-download-file-from-url/}\n */\nexport async function downloadFileFromURL(url: string, filename: string) {\n  try {\n    // Fetch the file\n    const response = await fetch(url)\n    // Check if the request was successful\n    if (response.status !== 200) {\n      throw new Error(\n        `Unable to download file. HTTP status: ${response.status}`,\n      )\n    }\n\n    // Get the Blob data\n    const blob = await response.blob()\n\n    // Create a download link\n    const downloadLink = document.createElement('a')\n    downloadLink.href = URL.createObjectURL(blob)\n    downloadLink.download = filename\n\n    // Trigger the download\n    document.body.appendChild(downloadLink)\n    downloadLink.click()\n\n    // Clean up\n    setTimeout(() => {\n      URL.revokeObjectURL(downloadLink.href)\n      document.body.removeChild(downloadLink)\n    }, 100)\n  } catch (error: unknown) {\n    if (error instanceof Error) {\n      console.error('Error downloading the file:', error.message)\n    }\n  }\n}\n","import type LabyrintheElement from 'labyrinthe/src/LabyrintheElement'\nimport type { MathfieldElement } from 'mathlive'\nimport { get } from 'svelte/store'\nimport { type MathaleaSVG } from '../lib/types'\nimport type ListeDeroulanteElement from './interactif/listeDeroulante/ListeDeroulanteElement'\nimport { previousView } from './stores/generalStore'\nimport { globalOptions } from './stores/globalOptions'\nimport type { MySpreadsheetElement } from './tableur/MySpreadSheet'\nimport type { VueType } from './VueType'\n\nexport function mathaleaGoToView(destinationView: '' | VueType) {\n  const originView = get(globalOptions).v ?? ''\n  previousView.set(originView)\n  if (destinationView !== get(globalOptions).v) {\n    // on met  jour que si nccessaire\n    globalOptions.update((l) => {\n      l.v = destinationView\n      return l\n    })\n  }\n}\n\nfunction log(message: string) {\n  // console.log(message)\n}\n\n/**\n * Attend qu'un lment du DOM remplisse une condition, ou time out\n * @param {() => boolean} conditionFn - fonction qui retourne true quand l'lment est prt\n * @param {number} timeout - dure max en ms\n * @param {number} interval - frquence de vrification en ms\n */\nfunction waitFor(\n  conditionFn: () => boolean,\n  timeout = 2000,\n  interval = 50,\n  trace: string = '',\n) {\n  return new Promise((resolve, reject) => {\n    const start = Date.now()\n\n    function check() {\n      if (conditionFn()) {\n        resolve(true)\n      } else if (Date.now() - start > timeout) {\n        reject(new Error('Timeout waiting for condition:' + trace))\n      } else {\n        setTimeout(check, interval)\n      }\n    }\n\n    check()\n  })\n}\n\n/**\n * On attend un lment ou des lments du DOM en fonction d'un selecteur\n * @param elementId selecteur\n * @param timeWait temps en secondes\n * @returns une promise sur l'lment ou les lments en question\n */\nconst waitForElement = async (\n  elementId: string,\n  timeWait = 4,\n): Promise<NodeListOf<HTMLElement>> => {\n  return new Promise((resolve, reject) => {\n    const ele = document.querySelectorAll<HTMLElement>(elementId)\n    if (ele.length) {\n      // pas besoin d'attendre\n      resolve(ele)\n      return\n    }\n\n    let tempTime = 0\n    const timeWait1000 = timeWait * 10\n    const checkExist = setInterval(function () {\n      const ele = document.querySelectorAll<HTMLElement>(elementId)\n      if (ele.length) {\n        // console.log(`Exists ${elementId}`)\n        clearInterval(checkExist)\n        resolve(ele)\n      } else if (ele.length === 0 && tempTime > timeWait1000) {\n        // console.log('Doesn\\'t exist...')\n        clearInterval(checkExist)\n        const domSnapshot = document.body.outerHTML\n        window.notify(`Timeout waiting for element ${elementId}`, {\n          timeWait,\n          domSnapshot,\n        })\n        reject(new Error(`Element not found ${elementId}`))\n      } else {\n        tempTime++\n        // console.log(`Waiting for ${elementId}`, tempTime)\n      }\n    }, 100) // check every 100ms\n  })\n}\n\nexport function mathaleaWriteStudentPreviousAnswers(answers?: {\n  [key: string]: string\n}): Promise<Boolean>[] {\n  const promiseAnswers: Promise<Boolean>[] = []\n  const starttime = window.performance.now()\n  for (const answer in answers) {\n    if (answer.includes('MetaInteractif2d')) {\n      const p = new Promise<Boolean>((resolve) => {\n        const saisies = JSON.parse(answers[answer])\n        const selectors = Object.keys(saisies).map((field) => `#${field}`)\n\n        Promise.all(selectors.map((selector) => waitForElement(selector)))\n          .then(() => {\n            for (const field in saisies) {\n              const mf = document.getElementById(field) as MathfieldElement\n              if (\n                mf &&\n                'setPromptValue' in mf &&\n                typeof mf.setPromptValue === 'function'\n              ) {\n                mf.setPromptValue('champ1', saisies[field], { mode: 'auto' })\n              }\n            }\n            const time = window.performance.now()\n            log(`duration ${answer}: ${time - starttime}`)\n            resolve(true)\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('sheet')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une feuille de calcul jspreadsheet\n            const sheetElement = document.getElementById(\n              answer,\n            ) as MySpreadsheetElement\n            if (sheetElement != null) {\n              sheetElement.setData(JSON.parse(answers[answer]))\n            }\n            const time = window.performance.now()\n            log(`duration ${answer}: ${time - starttime}`)\n            resolve(true)\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (\n      answer.includes('apigeom') ||\n      answers[answer].includes('apiGeomVersion')\n    ) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une figure apigeom\n            const event = new CustomEvent(answer, { detail: answers[answer] })\n            document.dispatchEvent(event)\n            const time = window.performance.now()\n            log(`duration ${answer}: ${time - starttime}`)\n            // ne pas resolve ici si tu veux attendre waitFor\n            return waitFor(\n              () => {\n                const el = document.querySelector('#' + answer)\n                if (!el) return false // l'lment n'existe pas encore\n                return el?.children.length >= 1\n              },\n              5000,\n              100,\n              '#' + answer,\n            )\n          })\n          .then(() => resolve(true))\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('cliquefigure')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une figure cliquefigures\n            const ele = document.querySelector(`#${answer}`) as MathaleaSVG\n            if (ele) {\n              ele.etat = true\n              ele.style.border = '3px solid #f15929'\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('cliquePoint')) {\n      // \"answers\": {\"cliquePointfigEx7Q0P60\" : \"svg[id$='Ex7Q0'] g:nth-of-type(61)\"}\n      // On active le point 60 (61me enfant) par exemple ici...\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement(answers[answer])\n          .then(() => {\n            // La rponse correspond  un cliquePoint\n            const ele = document.querySelector(answers[answer]) as MathaleaSVG\n            if (ele) {\n              const evt = new MouseEvent('click', {\n                bubbles: true,\n                cancelable: true,\n                view: window,\n              })\n              ele.dispatchEvent(evt)\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('rectangleDND')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement(`div#${answer.replace('DND', '')}`)\n          .then(() => {\n            const rectangle = document.querySelector(\n              `div#${answer.replace('DND', '')}`,\n            )\n            if (rectangle !== null) {\n              const listeOfIds = answers[answer].split(';')\n              for (const id of listeOfIds) {\n                // attention ! on a peut-tre  faire  des clones ! qu'il faut recrer !\n                if (!id.includes('-clone-')) {\n                  // Non, c'est un original\n                  const etiquette = document.querySelector(`div#${id}`)\n                  if (etiquette !== null) {\n                    // Remet l'tiquette  la bonne rponse\n                    rectangle.appendChild(etiquette)\n                  }\n                } else {\n                  // L, on doit recloner l'original !\n                  const idOriginalAndDate = id.split('-clone-')\n                  const etiquetteOriginale = document.querySelector(\n                    `div#${idOriginalAndDate[0]}`,\n                  )\n                  if (etiquetteOriginale != null) {\n                    const clonedEtiquette = etiquetteOriginale.cloneNode(\n                      true,\n                    ) as HTMLDivElement\n                    clonedEtiquette.id = `${idOriginalAndDate[0]}-clone-${idOriginalAndDate[1]}`\n                    rectangle.appendChild(clonedEtiquette)\n                  }\n                }\n              }\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('clockEx')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une horloge\n            const clock = document.querySelector(`#${answer}`)\n            if (clock !== null) {\n              const [hour, minute] = answers[answer].split('h')\n              clock.setAttribute('hour', hour)\n              clock.setAttribute('minute', minute)\n              if (\n                'updateHandHour' in clock &&\n                typeof clock.updateHandHour === 'function'\n              ) {\n                clock.updateHandHour()\n              }\n              if (\n                'updateHandMinute' in clock &&\n                typeof clock.updateHandMinute === 'function'\n              ) {\n                clock.updateHandMinute()\n              }\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('sheet-')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une feuille de calcul univer\n            const ele = document.querySelector(\n              `#${answer}`,\n            ) as MySpreadsheetElement\n            if (ele) {\n              const actions = answers[answer].split('&')\n              for (const action of actions) {\n                const [cell, formula] = action.split('->')\n                console.info(cell, formula)\n              }\n              ele.style.pointerEvents = 'none' // Plus possible de modifier la feuille\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.startsWith('labyrintheEx')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            const labyrinthe = document.querySelector(\n              `#${answer}`,\n            ) as LabyrintheElement\n            if (labyrinthe !== null) {\n              labyrinthe.state = answers[answer]\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement(`[id$='${answer}']`)\n          .then((eles) => {\n            eles.forEach((ele) => {\n              if (ele.tagName === 'LISTE-DEROULANTE') {\n                // La rponse correspond  un select\n                ;(ele as ListeDeroulanteElement).value = answers[answer]\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              } else if (ele.id.includes('check')) {\n                // La rponse correspond  une case  cocher qui doit tre coche\n                if (answers[answer] === '1') {\n                  ;(ele as HTMLInputElement).checked = true\n                }\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              } else if (\n                ele.tagName === 'MATH-FIELD' &&\n                'setValue' in ele &&\n                typeof (ele as any).setValue === 'function'\n              ) {\n                // La rponse correspond  un champs texte\n                ;(ele as any).setValue(answers[answer])\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              } else if (ele.tagName === 'INPUT') {\n                ;(ele as HTMLInputElement).value = answers[answer]\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              }\n            })\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    }\n  }\n  return promiseAnswers\n}\n","import { RPC } from '@mixer/postmessage-rpc'\n// eslint-disable-next-line import-x/no-duplicates\nimport { tick } from 'svelte'\n// eslint-disable-next-line import-x/no-duplicates\nimport { get } from 'svelte/store'\n\nimport type { Activity, InterfaceResultExercice } from '../lib/types'\nimport {\n  mathaleaGoToView,\n  mathaleaWriteStudentPreviousAnswers,\n} from './mathaleaUtils'\n\nimport { canOptions as canOptionsStore } from './stores/canStore'\nimport {\n  capytaleMode,\n  capytaleStudentAssignment,\n  exercicesParams,\n  resultsByExercice,\n} from './stores/generalStore'\nimport { globalOptions } from './stores/globalOptions'\nimport type { CanState } from './types/can'\n\ninterface AssignmentData {\n  duration?: number\n  resultsByQuestion?: boolean[]\n}\n\ninterface ActivityParams {\n  mode: 'create' | 'assignment' | 'review' | 'view'\n  activity: Activity\n  workflow: 'current' | 'finished' | 'corrected'\n  studentAssignment: InterfaceResultExercice[]\n  assignmentData: AssignmentData\n}\n\nconst serviceId = 'capytale-player'\n\n// Gestion des postMessage avec Capytale\nexport const rpc = new RPC({\n  target: window.parent,\n  serviceId,\n  origin: '*',\n})\n\n// On copie les rponses pour que la vue CAN puisse les utiliser\nexport let answersFromCapytale: InterfaceResultExercice[] = []\nexport let assignmentDataFromCapytale: AssignmentData = {}\n\n// timer pour ne pas lancer hasChanged trop souvent\nlet timerId: ReturnType<typeof setTimeout> | undefined\nlet firstTime = true\n\nlet currentMode: 'create' | 'assignment' | 'review' | 'view'\n\n/**\n * Fonction pour recevoir les paramtres des exercices depuis Capytale\n */\nasync function toolSetActivityParams({\n  mode,\n  activity,\n  workflow,\n  studentAssignment,\n  assignmentData,\n}: ActivityParams) {\n  assignmentDataFromCapytale = assignmentData\n  // On garde dans le store ce qui tait en base de donnes chez Capytale pour pouvoir le renvoyer avec la modification d'un seul exercice\n  capytaleStudentAssignment.set(studentAssignment)\n  // mode : create (le prof cr sa sance), assignment (l'lve voit sa copie), review (le prof voit la copie d'un lve), view (le prof voit la sance d'un collgue dans la bibliothque et pourra la cloner)\n  // workflow : current (la copie n'a pas encore t rendue), finished (la copie a t rendue), corrected (la copie a t anote par l'enseignant)\n  // On rcupre les paramtres de l'activit\n  currentMode = mode\n  capytaleMode.set(mode)\n  const canOptions = get(canOptionsStore)\n  if (activity === null || activity === undefined) return\n  const [newExercicesParams, newGlobalOptions, newCanOptions] = [\n    activity.exercicesParams,\n    activity.globalOptions,\n    activity.canOptions,\n  ]\n\n  // il faut mettre  jour au plus la vue CAN ou lve avant de mettre  jour les storers\n  if (newCanOptions?.isChoosen && mode !== 'create') {\n    newGlobalOptions.v = 'can'\n  } else if (mode !== 'create') {\n    newGlobalOptions.v = 'eleve'\n  }\n\n  // On met  jour les paramtres globaux\n  // MGu il vaut mieux commencer par ce storer car il fixe la vue (CAN ou lve)\n  // Puis mettre  jour la liste des exercices exercicesParams\n  globalOptions.update((l) => {\n    Object.assign(l, newGlobalOptions)\n    l.presMode = 'un_exo_par_page'\n    l.isDataRandom = true\n    l.isTitleDisplayed = true\n    if (l.v === 'eleve') {\n      l.isInteractiveFree = false\n    }\n    return l\n  })\n\n  // On met  jour les paramtres des exercices\n  exercicesParams.update((l) => {\n    Object.assign(l, newExercicesParams)\n    return l\n  })\n\n  if (newCanOptions === null || newCanOptions === undefined) {\n    window.notify('Aucun paramtre CAN trouv', {\n      mode,\n      activity,\n      workflow,\n      studentAssignment,\n      assignmentData,\n    })\n  }\n  canOptionsStore.update((l) => {\n    if (newCanOptions) newCanOptions.state = 'canHomeScreen'\n    Object.assign(l, newCanOptions)\n    l.state = 'canHomeScreen'\n    l.isInteractive = newGlobalOptions.setInteractive === '1'\n    return l\n  })\n  // On charge l'ala qui a pu tre modifi par l'lve\n  if (studentAssignment !== null && studentAssignment !== undefined) {\n    for (const exercice of studentAssignment) {\n      if (\n        exercice != null &&\n        exercice.alea != null &&\n        exercice.indice != null\n      ) {\n        exercicesParams.update((l) => {\n          if (Array.isArray(l)) {\n            l[exercice.indice as number].alea = exercice.alea\n            l[exercice.indice as number].bestScore = exercice.bestScore\n          }\n          return l\n        })\n      }\n    }\n  }\n  if (mode !== 'create') {\n    // Vue lve\n    if (newCanOptions?.isChoosen) {\n      mathaleaGoToView('can')\n      globalOptions.update((l) => {\n        l.v = 'can'\n        return l\n      })\n    } else {\n      // MGU mathaleaGoToView met  jour aussi globalOptions.v\n      mathaleaGoToView('eleve')\n    }\n  }\n  if (mode === 'assignment') {\n    // Si la copie a dj t rendue, on ne peut plus modifier les rponses\n    if (workflow !== 'current') {\n      globalOptions.update((l) => {\n        l.done = '1'\n        return l\n      })\n    }\n    // En vue CAN, on efface la graine pour que l'lve ne recommence pas le mme exercice\n    if (\n      newCanOptions?.isChoosen &&\n      (newGlobalOptions.isDataRandom === undefined ||\n        newGlobalOptions.isDataRandom === true)\n    ) {\n      exercicesParams.update((l) => {\n        for (const param of l) {\n          if (param.alea !== undefined) {\n            param.alea = undefined\n          }\n        }\n        return l\n      })\n    }\n  } else if (mode === 'review') {\n    // Mettre le done  true pour que l'on ne puisse plus modifier les rponses\n    globalOptions.update((l) => {\n      l.done = '1'\n      return l\n    })\n  }\n  await new Promise((resolve) => setTimeout(resolve, 500))\n  if (studentAssignment != null) {\n    answersFromCapytale = studentAssignment\n    console.info('Rponses  charger', studentAssignment)\n    if (!newCanOptions?.isChoosen) {\n      // On charge les rponses de l'lve (si ce n'est pas la CAN)\n      await waitForSvelteToBeStable() // on attend que les composants soient stables sinon AE!!!\n      console.info('Prt  charger', studentAssignment)\n      for (const exercice of studentAssignment) {\n        if (exercice == null) continue\n        if (exercice != null && exercice.answers != null) {\n          if (exercice.type === 'app') {\n            // On prvient les apps avec un message\n            if (exercice != null) {\n              const message = {\n                type: 'mathaleaHasScore',\n                score: exercice?.numberOfPoints,\n                numeroExercice: exercice?.indice,\n                numberOfQuestions: exercice?.numberOfQuestions,\n                finalState: exercice?.answers,\n              }\n              window.postMessage(message, '*')\n            }\n          } else {\n            const starttime = window.performance.now()\n            await Promise.all(\n              mathaleaWriteStudentPreviousAnswers(exercice.answers),\n            )\n            const time = window.performance.now() - starttime //  quoi a sert ? @todo supprimer\n          }\n        }\n      }\n    }\n    await new Promise((resolve) => setTimeout(resolve, 500))\n    // On attend 500 ms pour que les champs texte soient bien remplis\n    if (!canOptions.isChoosen) {\n      console.info(\n        'Maintenant que les rponses sont charges, clic sur les boutons score',\n        studentAssignment,\n      )\n      for (const exercice of studentAssignment) {\n        if (exercice == null) continue\n        // Pour les exercices MathALEA, on clique sur le bouton pour recalculer le score\n        const buttonScore = document.querySelector(\n          `#buttonScoreEx${exercice?.indice}`,\n        ) as HTMLButtonElement\n        if (buttonScore !== null) {\n          // On note dans le bouton que ce sont les rponses sauvegardes et pas de nouvelles rponses de l'lve\n          // Cela vite, en cas de problme de chargement, d'effacer les rponses de l'lve\n          buttonScore.dataset.capytaleLoadAnswers = '1'\n          buttonScore.click()\n        } else {\n          console.info(\n            `Bouton score #buttonScoreEx${exercice.indice} non trouv`,\n          )\n        }\n      }\n    }\n  }\n\n  // Gestion du state de la CAN\n  if (canOptions.isChoosen) {\n    if (canOptions.state !== 'canHomeScreen') return\n    let newState: CanState = 'start'\n    if (mode === 'review') {\n      // Un prof regarde une copie\n      newState = 'solutions'\n    }\n    if (mode === 'assignment' && studentAssignment != null) {\n      // Un lve fait une copie mais a dj t valu\n      if (workflow === 'current') {\n        newState = get(globalOptions).oneShot ? 'canHomeScreen' : 'start'\n      } else {\n        newState = canOptions.solutionsAccess ? 'solutions' : 'canHomeScreen'\n      }\n    }\n    if (newState !== 'canHomeScreen') {\n      canOptionsStore.update((l) => {\n        l.state = newState\n        l.solutionsMode = 'gathered' // Faut-il en faire une option par dfaut ?\n        return l\n      })\n    }\n  }\n}\n\nexport async function sendToCapytaleMathaleaHasChanged() {\n  if (firstTime) {\n    // attendre 1 seconde\n    await new Promise((resolve) => setTimeout(resolve, 1000))\n    firstTime = false\n    return\n  }\n  // On ne prvient Capytale qu'une fois toutes les demi-secondes\n  if (timerId === undefined) {\n    timerId = setTimeout(() => {\n      rpc.call('hasChanged', {})\n      timerId = undefined\n    }, 500)\n  }\n}\n\nexport async function waitForSvelteToBeStable(delay = 500) {\n  // Attend la prochaine frame de mise  jour\n  await tick()\n  // Optionnel : petit dlai pour que tous les rendus batchs se terminent\n  await new Promise((resolve) => setTimeout(resolve, delay))\n}\n\nexport function sendToCapytaleSaveStudentAssignment({\n  indiceExercice,\n  assignmentData,\n}: {\n  indiceExercice?: number | 'all'\n  assignmentData?: AssignmentData\n}) {\n  if (indiceExercice === undefined) return\n  const results = get(resultsByExercice) || []\n  // On rcupre les rsultats prcdents de l'lve en provenance de Capytale\n  let newStudentAssignement = get(capytaleStudentAssignment) || []\n  let evaluation = 0\n  for (const resultExercice of results) {\n    if (Number.isFinite(resultExercice?.numberOfPoints)) {\n      evaluation += resultExercice.numberOfPoints\n    }\n  }\n  if (currentMode === 'assignment') {\n    // exerciceGraded est l'indice du dernier exercice valu\n    // L'information est envoye  Capytale pour qu'ils sachent quel exercice ajouter en base de donnes\n    // Dans le cas d'une vue Course aux Nombre on envoie all pour forcer de mettre  jour en base de donnes tous les scores\n    if (indiceExercice !== 'all') {\n      // On n'est donc pas en vue CAN\n      const bestScore = results[indiceExercice]?.bestScore ?? 0\n      const newScore = results[indiceExercice]?.numberOfPoints ?? -1\n      if (newScore < bestScore) {\n        console.info(\n          'Exercice non sauvegard car le score est infrieur au meilleur score',\n        )\n        return\n      }\n      // On ne sauvegarde que les donnes de l'exercice qui vient d'tre soumis\n      newStudentAssignement[indiceExercice] = results[indiceExercice]\n      capytaleStudentAssignment.set(newStudentAssignement)\n    } else {\n      // Pour la CAN, on ne garde rien des enregistrements prcdents\n      newStudentAssignement = results\n      capytaleStudentAssignment.set(newStudentAssignement)\n    }\n    const data = {\n      // Les rponses de l'lve\n      // Le tableau fourni remplace compltement les rponses prcdemment sauvegardes.\n      studentAssignment: newStudentAssignement,\n      // L'valuation totale\n      evaluation: evaluation.toString(),\n      // L'index dans le tableau `studentAssignment` de l'exercice qui vient d'tre soumis\n      // 'all' pour indiquer que tous les exercices sont soumis\n      exerciceGraded: indiceExercice,\n      // Des donnes globales concernant le travail de l'lve : temps pass, etc... Format  dfinir.\n      // Les donnes fournies remplacent compltement les donnes prcdemment sauvegardes.\n      assignmentData,\n      // Indique que l'activit est termine et doit tre verrouille pour l'lve : workflow = 'finished'\n      final: get(canOptionsStore).isChoosen && get(globalOptions).oneShot,\n    }\n    console.info('Message envoy  Capytale', data)\n    const promiseSaveStudentAssignment = rpc.call('saveStudentAssignment', data)\n    promiseSaveStudentAssignment\n      .then(() => {\n        console.info('Sauvegarde effectue')\n        // Afficher sauvegarde russie\n      })\n      .catch((err) => {\n        console.error('Problme avec la sauvegarde', err)\n        // Indiquer  l'lve qu'il y a un soucis rseau\n\n        console.error('typeof err =', typeof err)\n\n        if (err instanceof Error) {\n          console.error('message =', err.message)\n          console.error('stack =', err.stack)\n        }\n\n        if (err?.response) {\n          console.error('response =', err.response)\n        }\n\n        if (err?.data) {\n          console.error('data =', err.data)\n        }\n\n        const message = [\n          err.code && `code: ${err.code}`,\n          err.status && `status: ${err.status}`,\n          err.message && `message: ${err.message}`,\n          err.stack && `stack: ${err.stack}`,\n          err?.data?.message && `data.message: ${err?.data?.message}`,\n          err?.error?.message && `error.message: ${err?.error?.message}`,\n        ]\n          .filter(Boolean)\n          .join('\\n')\n\n        window.notify('Problme avec la sauvegarde Capytale', {\n          error: err,\n          message,\n          mode: currentMode,\n          indiceExercice,\n          data,\n          globalOptions: get(globalOptions),\n          exercicesParams: get(exercicesParams),\n          resultsByExercice: get(resultsByExercice),\n          canOptions: get(canOptionsStore),\n        })\n      })\n  }\n}\n\nfunction sendToCapytaleActivityParams() {\n  const params = get(exercicesParams)\n  const options = get(globalOptions)\n  const canOptions = get(canOptionsStore)\n  for (const param of params) {\n    if (param.alea !== undefined && get(globalOptions).isDataRandom) {\n      param.alea = undefined\n    }\n  }\n  return { exercicesParams: params, globalOptions: options, canOptions }\n}\n\nexport default async function handleCapytale() {\n  rpc.expose('platformGetActivityParams', sendToCapytaleActivityParams)\n  try {\n    const activityParams = await rpc.call<ActivityParams>(\n      'toolGetActivityParams',\n      {},\n    )\n    toolSetActivityParams(activityParams)\n  } catch (error) {\n    console.error('Problme de communication avec Capytale', error)\n  }\n}\n","import { lcm } from 'mathjs'\nimport { listeDesDiviseurs } from '../lib/outils/primalite'\n\nfunction ppcm([...n]) {\n  return parseInt(lcm(...n))\n}\n\n/**\n * Trie la liste pour la retourner dans l'ordre croissant\n * @private\n * @param {Fraction[]} liste\n * @return {Fraction[]}\n */\nconst sortFractions = (liste) =>\n  liste.slice().sort((f1, f2) => f1.valeurDecimale - f2.valeurDecimale)\n\n/**\n * Classe ListeFraction qui propose des mthodes utiles sur les collections de fractions\n * @author Jean-Claude Lhote sur une ide de Sbastien Lozano\n */\nclass ListeFraction {\n  constructor(...fractions) {\n    /**\n     * La liste des fractions passes au constructeur (une par argument)\n     * @type {Fraction[]}\n     */\n    this.liste = fractions\n    /**\n     * @typedef listeNombres\n     * @type {number[]}\n     */\n    /**\n     * Les tableaux contenant les diviseurs diffrents de 1 de chaque dnominateur\n     * @type {listeNombres[]}\n     */\n    this.denominateurs_amis = []\n    let listetemp = []\n    const dens = []\n    this.liste.forEach((f) => {\n      dens.push(f.d)\n      listetemp = listeDesDiviseurs(f.d)\n      listetemp.splice(0, 1)\n      this.denominateurs_amis.push(listetemp)\n    })\n    const den = ppcm(dens)\n    /**\n     * La liste des fractions mises au mme dnominateur dans le mme ordre que this.liste\n     * @type {listeNombres[]}\n     */\n    this.listeMemeDenominateur = []\n    this.liste.forEach((f) => {\n      this.listeMemeDenominateur.push(f.reduire(Math.round(den / f.d)))\n    })\n\n    /**\n     * La liste de fraction range dans l'ordre croissant.\n     * @type {Fraction[]}\n     */\n    this.listeRangee = sortFractions(this.liste)\n    /**\n     * La liste des fractions mises au mme dnominateur par ordre croissant\n     * @type {Fraction[]}\n     */\n    this.listeRangeeMemeDenominateur = sortFractions(this.listeMemeDenominateur)\n    /**\n     * la liste des fractions simplifies (dans le mme ordre que celles fournies)\n     * @type {Fraction[]}\n     */\n    this.listeSimplifiee = this.liste.map((f) => f.simplifie())\n    /**\n     * la liste des fractions simplifies par ordre croissant\n     * @type {Fraction[]}\n     */\n    this.listeRangeeSimplifiee = sortFractions(this.listeSimplifiee)\n    /**\n     * La liste des fractions au format LaTeX, spares par ;\n     * @type {string}\n     */\n    this.texListe = this.liste.map((f) => f.texFraction).join(' ; ')\n  }\n\n  /**\n   * @todo virer cette mthode jamais utilise\n   * @param {...Fraction}\n   */\n  completeListe(...frac) {\n    const dens = [this.listeMemeDenominateur[0].d]\n    for (let i = 0; i < frac.length; i++) {\n      this.liste.push(frac[i])\n      dens.push(frac[i].d)\n      const listetemp = listeDesDiviseurs(frac[i].d)\n      listetemp.splice(0, 1)\n      this.denominateurs_amis.push(listetemp)\n    }\n    const den = ppcm(dens)\n    this.listeMemeDenominateur = []\n    for (let i = 0; i < this.liste.length; i++) {\n      this.listeMemeDenominateur.push(\n        this.liste[i].reduire(Math.round(den / this.liste[i].d)),\n      )\n    }\n    this.listeSimplifiee = []\n    for (let i = 0; i < this.liste.length; i++) {\n      this.listeSimplifiee.push(this.liste[i].simplifie())\n    }\n    this.texListe = ''\n    for (let i = 0; i < this.liste.length - 1; i++) {\n      this.texListe += this.liste[i].texFraction + ' ; '\n    }\n    this.texListe += this.liste[this.liste.length - 1].texFraction\n    this.listeRangee = sortFractions(this.liste) // La liste de fraction range dans l'ordre croissant.\n    this.listeRangeeMmeDenominateur = sortFractions(this.listeMemeDenominateur)\n    this.listeRangeeSimplifiee = sortFractions(this.listeSimplifiee)\n  }\n}\n\nexport default ListeFraction\n","import Decimal from 'decimal.js'\nimport { nombreDeChiffresDansLaPartieEntiere } from '../lib/outils/nombres'\nimport { estentier } from './outils'\n\nexport function nombreEnLettres(nb: number, type = 1) {\n  let partieEntiere, partieDecimale, nbstring, nbDec, decstring\n  if (estentier(nb)) return partieEntiereEnLettres(nb)\n  else {\n    partieEntiere = Math.floor(nb)\n    partieDecimale = new Decimal(nb).sub(partieEntiere).toDP(3)\n    nbDec = partieDecimale.toString().replace(/\\d*\\./, '').length\n    partieDecimale = partieDecimale.mul(10 ** nbDec).toNumber()\n\n    switch (nbDec) {\n      case 1:\n        if (partieDecimale > 1) decstring = ' diximes'\n        else decstring = ' dixime'\n        break\n      case 2:\n        if (partieDecimale > 1) decstring = ' centimes'\n        else decstring = ' centime'\n        break\n      case 3:\n        if (partieDecimale > 1) decstring = ' millimes'\n        else decstring = ' millime'\n        break\n    }\n\n    if (type === 1) {\n      nbstring =\n        partieEntiereEnLettres(partieEntiere) +\n        ' units et ' +\n        partieEntiereEnLettres(partieDecimale) +\n        decstring\n    } else if (nbDec === nombreDeChiffresDansLaPartieEntiere(partieDecimale)) {\n      nbstring =\n        partieEntiereEnLettres(partieEntiere) +\n        ' virgule ' +\n        partieEntiereEnLettres(partieDecimale)\n    } else {\n      nbstring = partieEntiereEnLettres(partieEntiere) + ' virgule '\n      for (\n        let n = 0;\n        n < nbDec - nombreDeChiffresDansLaPartieEntiere(partieDecimale);\n        n++\n      ) {\n        nbstring += 'zro-'\n      }\n      nbstring += partieEntiereEnLettres(partieDecimale)\n    }\n  }\n  return nbstring\n}\n\n/**\n *\n *\n * @param {int} nb\n\n *\n */\nexport function partieEntiereEnLettres(nb: number) {\n  if (nb === 0) return 'zro'\n  const dictionnaire = {\n    0: 'zro',\n    '000': '',\n    1: 'un',\n    2: 'deux',\n    3: 'trois',\n    4: 'quatre',\n    5: 'cinq',\n    6: 'six',\n    7: 'sept',\n    8: 'huit',\n    9: 'neuf',\n    10: 'dix',\n    11: 'onze',\n    12: 'douze',\n    13: 'treize',\n    14: 'quatorze',\n    15: 'quinze',\n    16: 'seize',\n    17: 'dix-sept',\n    18: 'dix-huit',\n    19: 'dix-neuf',\n    20: 'vingt',\n    21: 'vingt et un',\n    22: 'vingt-deux',\n    23: 'vingt-trois',\n    24: 'vingt-quatre',\n    25: 'vingt-cinq',\n    26: 'vingt-six',\n    27: 'vingt-sept',\n    28: 'vingt-huit',\n    29: 'vingt-neuf',\n    30: 'trente',\n    31: 'trente et un',\n    32: 'trente-deux',\n    33: 'trente-trois',\n    34: 'trente-quatre',\n    35: 'trente-cinq',\n    36: 'trente-six',\n    37: 'trente-sept',\n    38: 'trente-huit',\n    39: 'trente-neuf',\n    40: 'quarante',\n    41: 'quarante et un',\n    42: 'quarante-deux',\n    43: 'quarante-trois',\n    44: 'quarante-quatre',\n    45: 'quarante-cinq',\n    46: 'quarante-six',\n    47: 'quarante-sept',\n    48: 'quarante-huit',\n    49: 'quarante-neuf',\n    50: 'cinquante',\n    51: 'cinquante et un',\n    52: 'cinquante-deux',\n    53: 'cinquante-trois',\n    54: 'cinquante-quatre',\n    55: 'cinquante-cinq',\n    56: 'cinquante-six',\n    57: 'cinquante-sept',\n    58: 'cinquante-huit',\n    59: 'cinquante-neuf',\n    60: 'soixante',\n    61: 'soixante et un',\n    62: 'soixante-deux',\n    63: 'soixante-trois',\n    64: 'soixante-quatre',\n    65: 'soixante-cinq',\n    66: 'soixante-six',\n    67: 'soixante-sept',\n    68: 'soixante-huit',\n    69: 'soixante-neuf',\n    70: 'soixante-dix',\n    71: 'soixante et onze',\n    72: 'soixante-douze',\n    73: 'soixante-treize',\n    74: 'soixante-quatorze',\n    75: 'soixante-quinze',\n    76: 'soixante-seize',\n    77: 'soixante-dix-sept',\n    78: 'soixante-dix-huit',\n    79: 'soixante-dix-neuf',\n    80: 'quatre-vingts',\n    81: 'quatre-vingt-un',\n    82: 'quatre-vingt-deux',\n    83: 'quatre-vingt-trois',\n    84: 'quatre-vingt-quatre',\n    85: 'quatre-vingt-cinq',\n    86: 'quatre-vingt-six',\n    87: 'quatre-vingt-sept',\n    88: 'quatre-vingt-huit',\n    89: 'quatre-vingt-neuf',\n    90: 'quatre-vingt-dix',\n    91: 'quatre-vingt-onze',\n    92: 'quatre-vingt-douze',\n    93: 'quatre-vingt-treize',\n    94: 'quatre-vingt-quatorze',\n    95: 'quatre-vingt-quinze',\n    96: 'quatre-vingt-seize',\n    97: 'quatre-vingt-dix-sept',\n    98: 'quatre-vingt-dix-huit',\n    99: 'quatre-vingt-dix-neuf',\n    100: 'cent',\n    101: 'cent un',\n    102: 'cent deux',\n    103: 'cent trois',\n    104: 'cent quatre',\n    105: 'cent cinq',\n    106: 'cent six',\n    107: 'cent sept',\n    108: 'cent huit',\n    109: 'cent neuf',\n    110: 'cent dix',\n    111: 'cent onze',\n    112: 'cent douze',\n    113: 'cent treize',\n    114: 'cent quatorze',\n    115: 'cent quinze',\n    116: 'cent seize',\n    117: 'cent dix-sept',\n    118: 'cent dix-huit',\n    119: 'cent dix-neuf',\n    120: 'cent vingt',\n    121: 'cent vingt et un',\n    122: 'cent vingt-deux',\n    123: 'cent vingt-trois',\n    124: 'cent vingt-quatre',\n    125: 'cent vingt-cinq',\n    126: 'cent vingt-six',\n    127: 'cent vingt-sept',\n    128: 'cent vingt-huit',\n    129: 'cent vingt-neuf',\n    130: 'cent trente',\n    131: 'cent trente et un',\n    132: 'cent trente-deux',\n    133: 'cent trente-trois',\n    134: 'cent trente-quatre',\n    135: 'cent trente-cinq',\n    136: 'cent trente-six',\n    137: 'cent trente-sept',\n    138: 'cent trente-huit',\n    139: 'cent trente-neuf',\n    140: 'cent quarante',\n    141: 'cent quarante et un',\n    142: 'cent quarante-deux',\n    143: 'cent quarante-trois',\n    144: 'cent quarante-quatre',\n    145: 'cent quarante-cinq',\n    146: 'cent quarante-six',\n    147: 'cent quarante-sept',\n    148: 'cent quarante-huit',\n    149: 'cent quarante-neuf',\n    150: 'cent cinquante',\n    151: 'cent cinquante et un',\n    152: 'cent cinquante-deux',\n    153: 'cent cinquante-trois',\n    154: 'cent cinquante-quatre',\n    155: 'cent cinquante-cinq',\n    156: 'cent cinquante-six',\n    157: 'cent cinquante-sept',\n    158: 'cent cinquante-huit',\n    159: 'cent cinquante-neuf',\n    160: 'cent soixante',\n    161: 'cent soixante et un',\n    162: 'cent soixante-deux',\n    163: 'cent soixante-trois',\n    164: 'cent soixante-quatre',\n    165: 'cent soixante-cinq',\n    166: 'cent soixante-six',\n    167: 'cent soixante-sept',\n    168: 'cent soixante-huit',\n    169: 'cent soixante-neuf',\n    170: 'cent soixante-dix',\n    171: 'cent soixante et onze',\n    172: 'cent soixante-douze',\n    173: 'cent soixante-treize',\n    174: 'cent soixante-quatorze',\n    175: 'cent soixante-quinze',\n    176: 'cent soixante-seize',\n    177: 'cent soixante-dix-sept',\n    178: 'cent soixante-dix-huit',\n    179: 'cent soixante-dix-neuf',\n    180: 'cent quatre-vingts',\n    181: 'cent quatre-vingt-un',\n    182: 'cent quatre-vingt-deux',\n    183: 'cent quatre-vingt-trois',\n    184: 'cent quatre-vingt-quatre',\n    185: 'cent quatre-vingt-cinq',\n    186: 'cent quatre-vingt-six',\n    187: 'cent quatre-vingt-sept',\n    188: 'cent quatre-vingt-huit',\n    189: 'cent quatre-vingt-neuf',\n    190: 'cent quatre-vingt-dix',\n    191: 'cent quatre-vingt-onze',\n    192: 'cent quatre-vingt-douze',\n    193: 'cent quatre-vingt-treize',\n    194: 'cent quatre-vingt-quatorze',\n    195: 'cent quatre-vingt-quinze',\n    196: 'cent quatre-vingt-seize',\n    197: 'cent quatre-vingt-dix-sept',\n    198: 'cent quatre-vingt-dix-huit',\n    199: 'cent quatre-vingt-dix-neuf',\n    200: 'deux cents',\n    201: 'deux cent un',\n    202: 'deux cent deux',\n    203: 'deux cent trois',\n    204: 'deux cent quatre',\n    205: 'deux cent cinq',\n    206: 'deux cent six',\n    207: 'deux cent sept',\n    208: 'deux cent huit',\n    209: 'deux cent neuf',\n    210: 'deux cent dix',\n    211: 'deux cent onze',\n    212: 'deux cent douze',\n    213: 'deux cent treize',\n    214: 'deux cent quatorze',\n    215: 'deux cent quinze',\n    216: 'deux cent seize',\n    217: 'deux cent dix-sept',\n    218: 'deux cent dix-huit',\n    219: 'deux cent dix-neuf',\n    220: 'deux cent vingt',\n    221: 'deux cent vingt et un',\n    222: 'deux cent vingt-deux',\n    223: 'deux cent vingt-trois',\n    224: 'deux cent vingt-quatre',\n    225: 'deux cent vingt-cinq',\n    226: 'deux cent vingt-six',\n    227: 'deux cent vingt-sept',\n    228: 'deux cent vingt-huit',\n    229: 'deux cent vingt-neuf',\n    230: 'deux cent trente',\n    231: 'deux cent trente et un',\n    232: 'deux cent trente-deux',\n    233: 'deux cent trente-trois',\n    234: 'deux cent trente-quatre',\n    235: 'deux cent trente-cinq',\n    236: 'deux cent trente-six',\n    237: 'deux cent trente-sept',\n    238: 'deux cent trente-huit',\n    239: 'deux cent trente-neuf',\n    240: 'deux cent quarante',\n    241: 'deux cent quarante et un',\n    242: 'deux cent quarante-deux',\n    243: 'deux cent quarante-trois',\n    244: 'deux cent quarante-quatre',\n    245: 'deux cent quarante-cinq',\n    246: 'deux cent quarante-six',\n    247: 'deux cent quarante-sept',\n    248: 'deux cent quarante-huit',\n    249: 'deux cent quarante-neuf',\n    250: 'deux cent cinquante',\n    251: 'deux cent cinquante et un',\n    252: 'deux cent cinquante-deux',\n    253: 'deux cent cinquante-trois',\n    254: 'deux cent cinquante-quatre',\n    255: 'deux cent cinquante-cinq',\n    256: 'deux cent cinquante-six',\n    257: 'deux cent cinquante-sept',\n    258: 'deux cent cinquante-huit',\n    259: 'deux cent cinquante-neuf',\n    260: 'deux cent soixante',\n    261: 'deux cent soixante et un',\n    262: 'deux cent soixante-deux',\n    263: 'deux cent soixante-trois',\n    264: 'deux cent soixante-quatre',\n    265: 'deux cent soixante-cinq',\n    266: 'deux cent soixante-six',\n    267: 'deux cent soixante-sept',\n    268: 'deux cent soixante-huit',\n    269: 'deux cent soixante-neuf',\n    270: 'deux cent soixante-dix',\n    271: 'deux cent soixante et onze',\n    272: 'deux cent soixante-douze',\n    273: 'deux cent soixante-treize',\n    274: 'deux cent soixante-quatorze',\n    275: 'deux cent soixante-quinze',\n    276: 'deux cent soixante-seize',\n    277: 'deux cent soixante-dix-sept',\n    278: 'deux cent soixante-dix-huit',\n    279: 'deux cent soixante-dix-neuf',\n    280: 'deux cent quatre-vingts',\n    281: 'deux cent quatre-vingt-un',\n    282: 'deux cent quatre-vingt-deux',\n    283: 'deux cent quatre-vingt-trois',\n    284: 'deux cent quatre-vingt-quatre',\n    285: 'deux cent quatre-vingt-cinq',\n    286: 'deux cent quatre-vingt-six',\n    287: 'deux cent quatre-vingt-sept',\n    288: 'deux cent quatre-vingt-huit',\n    289: 'deux cent quatre-vingt-neuf',\n    290: 'deux cent quatre-vingt-dix',\n    291: 'deux cent quatre-vingt-onze',\n    292: 'deux cent quatre-vingt-douze',\n    293: 'deux cent quatre-vingt-treize',\n    294: 'deux cent quatre-vingt-quatorze',\n    295: 'deux cent quatre-vingt-quinze',\n    296: 'deux cent quatre-vingt-seize',\n    297: 'deux cent quatre-vingt-dix-sept',\n    298: 'deux cent quatre-vingt-dix-huit',\n    299: 'deux cent quatre-vingt-dix-neuf',\n    300: 'trois cents',\n    301: 'trois cent un',\n    302: 'trois cent deux',\n    303: 'trois cent trois',\n    304: 'trois cent quatre',\n    305: 'trois cent cinq',\n    306: 'trois cent six',\n    307: 'trois cent sept',\n    308: 'trois cent huit',\n    309: 'trois cent neuf',\n    310: 'trois cent dix',\n    311: 'trois cent onze',\n    312: 'trois cent douze',\n    313: 'trois cent treize',\n    314: 'trois cent quatorze',\n    315: 'trois cent quinze',\n    316: 'trois cent seize',\n    317: 'trois cent dix-sept',\n    318: 'trois cent dix-huit',\n    319: 'trois cent dix-neuf',\n    320: 'trois cent vingt',\n    321: 'trois cent vingt et un',\n    322: 'trois cent vingt-deux',\n    323: 'trois cent vingt-trois',\n    324: 'trois cent vingt-quatre',\n    325: 'trois cent vingt-cinq',\n    326: 'trois cent vingt-six',\n    327: 'trois cent vingt-sept',\n    328: 'trois cent vingt-huit',\n    329: 'trois cent vingt-neuf',\n    330: 'trois cent trente',\n    331: 'trois cent trente et un',\n    332: 'trois cent trente-deux',\n    333: 'trois cent trente-trois',\n    334: 'trois cent trente-quatre',\n    335: 'trois cent trente-cinq',\n    336: 'trois cent trente-six',\n    337: 'trois cent trente-sept',\n    338: 'trois cent trente-huit',\n    339: 'trois cent trente-neuf',\n    340: 'trois cent quarante',\n    341: 'trois cent quarante et un',\n    342: 'trois cent quarante-deux',\n    343: 'trois cent quarante-trois',\n    344: 'trois cent quarante-quatre',\n    345: 'trois cent quarante-cinq',\n    346: 'trois cent quarante-six',\n    347: 'trois cent quarante-sept',\n    348: 'trois cent quarante-huit',\n    349: 'trois cent quarante-neuf',\n    350: 'trois cent cinquante',\n    351: 'trois cent cinquante et un',\n    352: 'trois cent cinquante-deux',\n    353: 'trois cent cinquante-trois',\n    354: 'trois cent cinquante-quatre',\n    355: 'trois cent cinquante-cinq',\n    356: 'trois cent cinquante-six',\n    357: 'trois cent cinquante-sept',\n    358: 'trois cent cinquante-huit',\n    359: 'trois cent cinquante-neuf',\n    360: 'trois cent soixante',\n    361: 'trois cent soixante et un',\n    362: 'trois cent soixante-deux',\n    363: 'trois cent soixante-trois',\n    364: 'trois cent soixante-quatre',\n    365: 'trois cent soixante-cinq',\n    366: 'trois cent soixante-six',\n    367: 'trois cent soixante-sept',\n    368: 'trois cent soixante-huit',\n    369: 'trois cent soixante-neuf',\n    370: 'trois cent soixante-dix',\n    371: 'trois cent soixante et onze',\n    372: 'trois cent soixante-douze',\n    373: 'trois cent soixante-treize',\n    374: 'trois cent soixante-quatorze',\n    375: 'trois cent soixante-quinze',\n    376: 'trois cent soixante-seize',\n    377: 'trois cent soixante-dix-sept',\n    378: 'trois cent soixante-dix-huit',\n    379: 'trois cent soixante-dix-neuf',\n    380: 'trois cent quatre-vingts',\n    381: 'trois cent quatre-vingt-un',\n    382: 'trois cent quatre-vingt-deux',\n    383: 'trois cent quatre-vingt-trois',\n    384: 'trois cent quatre-vingt-quatre',\n    385: 'trois cent quatre-vingt-cinq',\n    386: 'trois cent quatre-vingt-six',\n    387: 'trois cent quatre-vingt-sept',\n    388: 'trois cent quatre-vingt-huit',\n    389: 'trois cent quatre-vingt-neuf',\n    390: 'trois cent quatre-vingt-dix',\n    391: 'trois cent quatre-vingt-onze',\n    392: 'trois cent quatre-vingt-douze',\n    393: 'trois cent quatre-vingt-treize',\n    394: 'trois cent quatre-vingt-quatorze',\n    395: 'trois cent quatre-vingt-quinze',\n    396: 'trois cent quatre-vingt-seize',\n    397: 'trois cent quatre-vingt-dix-sept',\n    398: 'trois cent quatre-vingt-dix-huit',\n    399: 'trois cent quatre-vingt-dix-neuf',\n    400: 'quatre cents',\n    401: 'quatre cent un',\n    402: 'quatre cent deux',\n    403: 'quatre cent trois',\n    404: 'quatre cent quatre',\n    405: 'quatre cent cinq',\n    406: 'quatre cent six',\n    407: 'quatre cent sept',\n    408: 'quatre cent huit',\n    409: 'quatre cent neuf',\n    410: 'quatre cent dix',\n    411: 'quatre cent onze',\n    412: 'quatre cent douze',\n    413: 'quatre cent treize',\n    414: 'quatre cent quatorze',\n    415: 'quatre cent quinze',\n    416: 'quatre cent seize',\n    417: 'quatre cent dix-sept',\n    418: 'quatre cent dix-huit',\n    419: 'quatre cent dix-neuf',\n    420: 'quatre cent vingt',\n    421: 'quatre cent vingt et un',\n    422: 'quatre cent vingt-deux',\n    423: 'quatre cent vingt-trois',\n    424: 'quatre cent vingt-quatre',\n    425: 'quatre cent vingt-cinq',\n    426: 'quatre cent vingt-six',\n    427: 'quatre cent vingt-sept',\n    428: 'quatre cent vingt-huit',\n    429: 'quatre cent vingt-neuf',\n    430: 'quatre cent trente',\n    431: 'quatre cent trente et un',\n    432: 'quatre cent trente-deux',\n    433: 'quatre cent trente-trois',\n    434: 'quatre cent trente-quatre',\n    435: 'quatre cent trente-cinq',\n    436: 'quatre cent trente-six',\n    437: 'quatre cent trente-sept',\n    438: 'quatre cent trente-huit',\n    439: 'quatre cent trente-neuf',\n    440: 'quatre cent quarante',\n    441: 'quatre cent quarante et un',\n    442: 'quatre cent quarante-deux',\n    443: 'quatre cent quarante-trois',\n    444: 'quatre cent quarante-quatre',\n    445: 'quatre cent quarante-cinq',\n    446: 'quatre cent quarante-six',\n    447: 'quatre cent quarante-sept',\n    448: 'quatre cent quarante-huit',\n    449: 'quatre cent quarante-neuf',\n    450: 'quatre cent cinquante',\n    451: 'quatre cent cinquante et un',\n    452: 'quatre cent cinquante-deux',\n    453: 'quatre cent cinquante-trois',\n    454: 'quatre cent cinquante-quatre',\n    455: 'quatre cent cinquante-cinq',\n    456: 'quatre cent cinquante-six',\n    457: 'quatre cent cinquante-sept',\n    458: 'quatre cent cinquante-huit',\n    459: 'quatre cent cinquante-neuf',\n    460: 'quatre cent soixante',\n    461: 'quatre cent soixante et un',\n    462: 'quatre cent soixante-deux',\n    463: 'quatre cent soixante-trois',\n    464: 'quatre cent soixante-quatre',\n    465: 'quatre cent soixante-cinq',\n    466: 'quatre cent soixante-six',\n    467: 'quatre cent soixante-sept',\n    468: 'quatre cent soixante-huit',\n    469: 'quatre cent soixante-neuf',\n    470: 'quatre cent soixante-dix',\n    471: 'quatre cent soixante et onze',\n    472: 'quatre cent soixante-douze',\n    473: 'quatre cent soixante-treize',\n    474: 'quatre cent soixante-quatorze',\n    475: 'quatre cent soixante-quinze',\n    476: 'quatre cent soixante-seize',\n    477: 'quatre cent soixante-dix-sept',\n    478: 'quatre cent soixante-dix-huit',\n    479: 'quatre cent soixante-dix-neuf',\n    480: 'quatre cent quatre-vingts',\n    481: 'quatre cent quatre-vingt-un',\n    482: 'quatre cent quatre-vingt-deux',\n    483: 'quatre cent quatre-vingt-trois',\n    484: 'quatre cent quatre-vingt-quatre',\n    485: 'quatre cent quatre-vingt-cinq',\n    486: 'quatre cent quatre-vingt-six',\n    487: 'quatre cent quatre-vingt-sept',\n    488: 'quatre cent quatre-vingt-huit',\n    489: 'quatre cent quatre-vingt-neuf',\n    490: 'quatre cent quatre-vingt-dix',\n    491: 'quatre cent quatre-vingt-onze',\n    492: 'quatre cent quatre-vingt-douze',\n    493: 'quatre cent quatre-vingt-treize',\n    494: 'quatre cent quatre-vingt-quatorze',\n    495: 'quatre cent quatre-vingt-quinze',\n    496: 'quatre cent quatre-vingt-seize',\n    497: 'quatre cent quatre-vingt-dix-sept',\n    498: 'quatre cent quatre-vingt-dix-huit',\n    499: 'quatre cent quatre-vingt-dix-neuf',\n    500: 'cinq cents',\n    501: 'cinq cent un',\n    502: 'cinq cent deux',\n    503: 'cinq cent trois',\n    504: 'cinq cent quatre',\n    505: 'cinq cent cinq',\n    506: 'cinq cent six',\n    507: 'cinq cent sept',\n    508: 'cinq cent huit',\n    509: 'cinq cent neuf',\n    510: 'cinq cent dix',\n    511: 'cinq cent onze',\n    512: 'cinq cent douze',\n    513: 'cinq cent treize',\n    514: 'cinq cent quatorze',\n    515: 'cinq cent quinze',\n    516: 'cinq cent seize',\n    517: 'cinq cent dix-sept',\n    518: 'cinq cent dix-huit',\n    519: 'cinq cent dix-neuf',\n    520: 'cinq cent vingt',\n    521: 'cinq cent vingt et un',\n    522: 'cinq cent vingt-deux',\n    523: 'cinq cent vingt-trois',\n    524: 'cinq cent vingt-quatre',\n    525: 'cinq cent vingt-cinq',\n    526: 'cinq cent vingt-six',\n    527: 'cinq cent vingt-sept',\n    528: 'cinq cent vingt-huit',\n    529: 'cinq cent vingt-neuf',\n    530: 'cinq cent trente',\n    531: 'cinq cent trente et un',\n    532: 'cinq cent trente-deux',\n    533: 'cinq cent trente-trois',\n    534: 'cinq cent trente-quatre',\n    535: 'cinq cent trente-cinq',\n    536: 'cinq cent trente-six',\n    537: 'cinq cent trente-sept',\n    538: 'cinq cent trente-huit',\n    539: 'cinq cent trente-neuf',\n    540: 'cinq cent quarante',\n    541: 'cinq cent quarante et un',\n    542: 'cinq cent quarante-deux',\n    543: 'cinq cent quarante-trois',\n    544: 'cinq cent quarante-quatre',\n    545: 'cinq cent quarante-cinq',\n    546: 'cinq cent quarante-six',\n    547: 'cinq cent quarante-sept',\n    548: 'cinq cent quarante-huit',\n    549: 'cinq cent quarante-neuf',\n    550: 'cinq cent cinquante',\n    551: 'cinq cent cinquante et un',\n    552: 'cinq cent cinquante-deux',\n    553: 'cinq cent cinquante-trois',\n    554: 'cinq cent cinquante-quatre',\n    555: 'cinq cent cinquante-cinq',\n    556: 'cinq cent cinquante-six',\n    557: 'cinq cent cinquante-sept',\n    558: 'cinq cent cinquante-huit',\n    559: 'cinq cent cinquante-neuf',\n    560: 'cinq cent soixante',\n    561: 'cinq cent soixante et un',\n    562: 'cinq cent soixante-deux',\n    563: 'cinq cent soixante-trois',\n    564: 'cinq cent soixante-quatre',\n    565: 'cinq cent soixante-cinq',\n    566: 'cinq cent soixante-six',\n    567: 'cinq cent soixante-sept',\n    568: 'cinq cent soixante-huit',\n    569: 'cinq cent soixante-neuf',\n    570: 'cinq cent soixante-dix',\n    571: 'cinq cent soixante et onze',\n    572: 'cinq cent soixante-douze',\n    573: 'cinq cent soixante-treize',\n    574: 'cinq cent soixante-quatorze',\n    575: 'cinq cent soixante-quinze',\n    576: 'cinq cent soixante-seize',\n    577: 'cinq cent soixante-dix-sept',\n    578: 'cinq cent soixante-dix-huit',\n    579: 'cinq cent soixante-dix-neuf',\n    580: 'cinq cent quatre-vingts',\n    581: 'cinq cent quatre-vingt-un',\n    582: 'cinq cent quatre-vingt-deux',\n    583: 'cinq cent quatre-vingt-trois',\n    584: 'cinq cent quatre-vingt-quatre',\n    585: 'cinq cent quatre-vingt-cinq',\n    586: 'cinq cent quatre-vingt-six',\n    587: 'cinq cent quatre-vingt-sept',\n    588: 'cinq cent quatre-vingt-huit',\n    589: 'cinq cent quatre-vingt-neuf',\n    590: 'cinq cent quatre-vingt-dix',\n    591: 'cinq cent quatre-vingt-onze',\n    592: 'cinq cent quatre-vingt-douze',\n    593: 'cinq cent quatre-vingt-treize',\n    594: 'cinq cent quatre-vingt-quatorze',\n    595: 'cinq cent quatre-vingt-quinze',\n    596: 'cinq cent quatre-vingt-seize',\n    597: 'cinq cent quatre-vingt-dix-sept',\n    598: 'cinq cent quatre-vingt-dix-huit',\n    599: 'cinq cent quatre-vingt-dix-neuf',\n    600: 'six cents',\n    601: 'six cent un',\n    602: 'six cent deux',\n    603: 'six cent trois',\n    604: 'six cent quatre',\n    605: 'six cent cinq',\n    606: 'six cent six',\n    607: 'six cent sept',\n    608: 'six cent huit',\n    609: 'six cent neuf',\n    610: 'six cent dix',\n    611: 'six cent onze',\n    612: 'six cent douze',\n    613: 'six cent treize',\n    614: 'six cent quatorze',\n    615: 'six cent quinze',\n    616: 'six cent seize',\n    617: 'six cent dix-sept',\n    618: 'six cent dix-huit',\n    619: 'six cent dix-neuf',\n    620: 'six cent vingt',\n    621: 'six cent vingt et un',\n    622: 'six cent vingt-deux',\n    623: 'six cent vingt-trois',\n    624: 'six cent vingt-quatre',\n    625: 'six cent vingt-cinq',\n    626: 'six cent vingt-six',\n    627: 'six cent vingt-sept',\n    628: 'six cent vingt-huit',\n    629: 'six cent vingt-neuf',\n    630: 'six cent trente',\n    631: 'six cent trente et un',\n    632: 'six cent trente-deux',\n    633: 'six cent trente-trois',\n    634: 'six cent trente-quatre',\n    635: 'six cent trente-cinq',\n    636: 'six cent trente-six',\n    637: 'six cent trente-sept',\n    638: 'six cent trente-huit',\n    639: 'six cent trente-neuf',\n    640: 'six cent quarante',\n    641: 'six cent quarante et un',\n    642: 'six cent quarante-deux',\n    643: 'six cent quarante-trois',\n    644: 'six cent quarante-quatre',\n    645: 'six cent quarante-cinq',\n    646: 'six cent quarante-six',\n    647: 'six cent quarante-sept',\n    648: 'six cent quarante-huit',\n    649: 'six cent quarante-neuf',\n    650: 'six cent cinquante',\n    651: 'six cent cinquante et un',\n    652: 'six cent cinquante-deux',\n    653: 'six cent cinquante-trois',\n    654: 'six cent cinquante-quatre',\n    655: 'six cent cinquante-cinq',\n    656: 'six cent cinquante-six',\n    657: 'six cent cinquante-sept',\n    658: 'six cent cinquante-huit',\n    659: 'six cent cinquante-neuf',\n    660: 'six cent soixante',\n    661: 'six cent soixante et un',\n    662: 'six cent soixante-deux',\n    663: 'six cent soixante-trois',\n    664: 'six cent soixante-quatre',\n    665: 'six cent soixante-cinq',\n    666: 'six cent soixante-six',\n    667: 'six cent soixante-sept',\n    668: 'six cent soixante-huit',\n    669: 'six cent soixante-neuf',\n    670: 'six cent soixante-dix',\n    671: 'six cent soixante et onze',\n    672: 'six cent soixante-douze',\n    673: 'six cent soixante-treize',\n    674: 'six cent soixante-quatorze',\n    675: 'six cent soixante-quinze',\n    676: 'six cent soixante-seize',\n    677: 'six cent soixante-dix-sept',\n    678: 'six cent soixante-dix-huit',\n    679: 'six cent soixante-dix-neuf',\n    680: 'six cent quatre-vingts',\n    681: 'six cent quatre-vingt-un',\n    682: 'six cent quatre-vingt-deux',\n    683: 'six cent quatre-vingt-trois',\n    684: 'six cent quatre-vingt-quatre',\n    685: 'six cent quatre-vingt-cinq',\n    686: 'six cent quatre-vingt-six',\n    687: 'six cent quatre-vingt-sept',\n    688: 'six cent quatre-vingt-huit',\n    689: 'six cent quatre-vingt-neuf',\n    690: 'six cent quatre-vingt-dix',\n    691: 'six cent quatre-vingt-onze',\n    692: 'six cent quatre-vingt-douze',\n    693: 'six cent quatre-vingt-treize',\n    694: 'six cent quatre-vingt-quatorze',\n    695: 'six cent quatre-vingt-quinze',\n    696: 'six cent quatre-vingt-seize',\n    697: 'six cent quatre-vingt-dix-sept',\n    698: 'six cent quatre-vingt-dix-huit',\n    699: 'six cent quatre-vingt-dix-neuf',\n    700: 'sept cents',\n    701: 'sept cent un',\n    702: 'sept cent deux',\n    703: 'sept cent trois',\n    704: 'sept cent quatre',\n    705: 'sept cent cinq',\n    706: 'sept cent six',\n    707: 'sept cent sept',\n    708: 'sept cent huit',\n    709: 'sept cent neuf',\n    710: 'sept cent dix',\n    711: 'sept cent onze',\n    712: 'sept cent douze',\n    713: 'sept cent treize',\n    714: 'sept cent quatorze',\n    715: 'sept cent quinze',\n    716: 'sept cent seize',\n    717: 'sept cent dix-sept',\n    718: 'sept cent dix-huit',\n    719: 'sept cent dix-neuf',\n    720: 'sept cent vingt',\n    721: 'sept cent vingt et un',\n    722: 'sept cent vingt-deux',\n    723: 'sept cent vingt-trois',\n    724: 'sept cent vingt-quatre',\n    725: 'sept cent vingt-cinq',\n    726: 'sept cent vingt-six',\n    727: 'sept cent vingt-sept',\n    728: 'sept cent vingt-huit',\n    729: 'sept cent vingt-neuf',\n    730: 'sept cent trente',\n    731: 'sept cent trente et un',\n    732: 'sept cent trente-deux',\n    733: 'sept cent trente-trois',\n    734: 'sept cent trente-quatre',\n    735: 'sept cent trente-cinq',\n    736: 'sept cent trente-six',\n    737: 'sept cent trente-sept',\n    738: 'sept cent trente-huit',\n    739: 'sept cent trente-neuf',\n    740: 'sept cent quarante',\n    741: 'sept cent quarante et un',\n    742: 'sept cent quarante-deux',\n    743: 'sept cent quarante-trois',\n    744: 'sept cent quarante-quatre',\n    745: 'sept cent quarante-cinq',\n    746: 'sept cent quarante-six',\n    747: 'sept cent quarante-sept',\n    748: 'sept cent quarante-huit',\n    749: 'sept cent quarante-neuf',\n    750: 'sept cent cinquante',\n    751: 'sept cent cinquante et un',\n    752: 'sept cent cinquante-deux',\n    753: 'sept cent cinquante-trois',\n    754: 'sept cent cinquante-quatre',\n    755: 'sept cent cinquante-cinq',\n    756: 'sept cent cinquante-six',\n    757: 'sept cent cinquante-sept',\n    758: 'sept cent cinquante-huit',\n    759: 'sept cent cinquante-neuf',\n    760: 'sept cent soixante',\n    761: 'sept cent soixante et un',\n    762: 'sept cent soixante-deux',\n    763: 'sept cent soixante-trois',\n    764: 'sept cent soixante-quatre',\n    765: 'sept cent soixante-cinq',\n    766: 'sept cent soixante-six',\n    767: 'sept cent soixante-sept',\n    768: 'sept cent soixante-huit',\n    769: 'sept cent soixante-neuf',\n    770: 'sept cent soixante-dix',\n    771: 'sept cent soixante et onze',\n    772: 'sept cent soixante-douze',\n    773: 'sept cent soixante-treize',\n    774: 'sept cent soixante-quatorze',\n    775: 'sept cent soixante-quinze',\n    776: 'sept cent soixante-seize',\n    777: 'sept cent soixante-dix-sept',\n    778: 'sept cent soixante-dix-huit',\n    779: 'sept cent soixante-dix-neuf',\n    780: 'sept cent quatre-vingts',\n    781: 'sept cent quatre-vingt-un',\n    782: 'sept cent quatre-vingt-deux',\n    783: 'sept cent quatre-vingt-trois',\n    784: 'sept cent quatre-vingt-quatre',\n    785: 'sept cent quatre-vingt-cinq',\n    786: 'sept cent quatre-vingt-six',\n    787: 'sept cent quatre-vingt-sept',\n    788: 'sept cent quatre-vingt-huit',\n    789: 'sept cent quatre-vingt-neuf',\n    790: 'sept cent quatre-vingt-dix',\n    791: 'sept cent quatre-vingt-onze',\n    792: 'sept cent quatre-vingt-douze',\n    793: 'sept cent quatre-vingt-treize',\n    794: 'sept cent quatre-vingt-quatorze',\n    795: 'sept cent quatre-vingt-quinze',\n    796: 'sept cent quatre-vingt-seize',\n    797: 'sept cent quatre-vingt-dix-sept',\n    798: 'sept cent quatre-vingt-dix-huit',\n    799: 'sept cent quatre-vingt-dix-neuf',\n    800: 'huit cents',\n    801: 'huit cent un',\n    802: 'huit cent deux',\n    803: 'huit cent trois',\n    804: 'huit cent quatre',\n    805: 'huit cent cinq',\n    806: 'huit cent six',\n    807: 'huit cent sept',\n    808: 'huit cent huit',\n    809: 'huit cent neuf',\n    810: 'huit cent dix',\n    811: 'huit cent onze',\n    812: 'huit cent douze',\n    813: 'huit cent treize',\n    814: 'huit cent quatorze',\n    815: 'huit cent quinze',\n    816: 'huit cent seize',\n    817: 'huit cent dix-sept',\n    818: 'huit cent dix-huit',\n    819: 'huit cent dix-neuf',\n    820: 'huit cent vingt',\n    821: 'huit cent vingt et un',\n    822: 'huit cent vingt-deux',\n    823: 'huit cent vingt-trois',\n    824: 'huit cent vingt-quatre',\n    825: 'huit cent vingt-cinq',\n    826: 'huit cent vingt-six',\n    827: 'huit cent vingt-sept',\n    828: 'huit cent vingt-huit',\n    829: 'huit cent vingt-neuf',\n    830: 'huit cent trente',\n    831: 'huit cent trente et un',\n    832: 'huit cent trente-deux',\n    833: 'huit cent trente-trois',\n    834: 'huit cent trente-quatre',\n    835: 'huit cent trente-cinq',\n    836: 'huit cent trente-six',\n    837: 'huit cent trente-sept',\n    838: 'huit cent trente-huit',\n    839: 'huit cent trente-neuf',\n    840: 'huit cent quarante',\n    841: 'huit cent quarante et un',\n    842: 'huit cent quarante-deux',\n    843: 'huit cent quarante-trois',\n    844: 'huit cent quarante-quatre',\n    845: 'huit cent quarante-cinq',\n    846: 'huit cent quarante-six',\n    847: 'huit cent quarante-sept',\n    848: 'huit cent quarante-huit',\n    849: 'huit cent quarante-neuf',\n    850: 'huit cent cinquante',\n    851: 'huit cent cinquante et un',\n    852: 'huit cent cinquante-deux',\n    853: 'huit cent cinquante-trois',\n    854: 'huit cent cinquante-quatre',\n    855: 'huit cent cinquante-cinq',\n    856: 'huit cent cinquante-six',\n    857: 'huit cent cinquante-sept',\n    858: 'huit cent cinquante-huit',\n    859: 'huit cent cinquante-neuf',\n    860: 'huit cent soixante',\n    861: 'huit cent soixante et un',\n    862: 'huit cent soixante-deux',\n    863: 'huit cent soixante-trois',\n    864: 'huit cent soixante-quatre',\n    865: 'huit cent soixante-cinq',\n    866: 'huit cent soixante-six',\n    867: 'huit cent soixante-sept',\n    868: 'huit cent soixante-huit',\n    869: 'huit cent soixante-neuf',\n    870: 'huit cent soixante-dix',\n    871: 'huit cent soixante et onze',\n    872: 'huit cent soixante-douze',\n    873: 'huit cent soixante-treize',\n    874: 'huit cent soixante-quatorze',\n    875: 'huit cent soixante-quinze',\n    876: 'huit cent soixante-seize',\n    877: 'huit cent soixante-dix-sept',\n    878: 'huit cent soixante-dix-huit',\n    879: 'huit cent soixante-dix-neuf',\n    880: 'huit cent quatre-vingts',\n    881: 'huit cent quatre-vingt-un',\n    882: 'huit cent quatre-vingt-deux',\n    883: 'huit cent quatre-vingt-trois',\n    884: 'huit cent quatre-vingt-quatre',\n    885: 'huit cent quatre-vingt-cinq',\n    886: 'huit cent quatre-vingt-six',\n    887: 'huit cent quatre-vingt-sept',\n    888: 'huit cent quatre-vingt-huit',\n    889: 'huit cent quatre-vingt-neuf',\n    890: 'huit cent quatre-vingt-dix',\n    891: 'huit cent quatre-vingt-onze',\n    892: 'huit cent quatre-vingt-douze',\n    893: 'huit cent quatre-vingt-treize',\n    894: 'huit cent quatre-vingt-quatorze',\n    895: 'huit cent quatre-vingt-quinze',\n    896: 'huit cent quatre-vingt-seize',\n    897: 'huit cent quatre-vingt-dix-sept',\n    898: 'huit cent quatre-vingt-dix-huit',\n    899: 'huit cent quatre-vingt-dix-neuf',\n    900: 'neuf cents',\n    901: 'neuf cent un',\n    902: 'neuf cent deux',\n    903: 'neuf cent trois',\n    904: 'neuf cent quatre',\n    905: 'neuf cent cinq',\n    906: 'neuf cent six',\n    907: 'neuf cent sept',\n    908: 'neuf cent huit',\n    909: 'neuf cent neuf',\n    910: 'neuf cent dix',\n    911: 'neuf cent onze',\n    912: 'neuf cent douze',\n    913: 'neuf cent treize',\n    914: 'neuf cent quatorze',\n    915: 'neuf cent quinze',\n    916: 'neuf cent seize',\n    917: 'neuf cent dix-sept',\n    918: 'neuf cent dix-huit',\n    919: 'neuf cent dix-neuf',\n    920: 'neuf cent vingt',\n    921: 'neuf cent vingt et un',\n    922: 'neuf cent vingt-deux',\n    923: 'neuf cent vingt-trois',\n    924: 'neuf cent vingt-quatre',\n    925: 'neuf cent vingt-cinq',\n    926: 'neuf cent vingt-six',\n    927: 'neuf cent vingt-sept',\n    928: 'neuf cent vingt-huit',\n    929: 'neuf cent vingt-neuf',\n    930: 'neuf cent trente',\n    931: 'neuf cent trente et un',\n    932: 'neuf cent trente-deux',\n    933: 'neuf cent trente-trois',\n    934: 'neuf cent trente-quatre',\n    935: 'neuf cent trente-cinq',\n    936: 'neuf cent trente-six',\n    937: 'neuf cent trente-sept',\n    938: 'neuf cent trente-huit',\n    939: 'neuf cent trente-neuf',\n    940: 'neuf cent quarante',\n    941: 'neuf cent quarante et un',\n    942: 'neuf cent quarante-deux',\n    943: 'neuf cent quarante-trois',\n    944: 'neuf cent quarante-quatre',\n    945: 'neuf cent quarante-cinq',\n    946: 'neuf cent quarante-six',\n    947: 'neuf cent quarante-sept',\n    948: 'neuf cent quarante-huit',\n    949: 'neuf cent quarante-neuf',\n    950: 'neuf cent cinquante',\n    951: 'neuf cent cinquante et un',\n    952: 'neuf cent cinquante-deux',\n    953: 'neuf cent cinquante-trois',\n    954: 'neuf cent cinquante-quatre',\n    955: 'neuf cent cinquante-cinq',\n    956: 'neuf cent cinquante-six',\n    957: 'neuf cent cinquante-sept',\n    958: 'neuf cent cinquante-huit',\n    959: 'neuf cent cinquante-neuf',\n    960: 'neuf cent soixante',\n    961: 'neuf cent soixante et un',\n    962: 'neuf cent soixante-deux',\n    963: 'neuf cent soixante-trois',\n    964: 'neuf cent soixante-quatre',\n    965: 'neuf cent soixante-cinq',\n    966: 'neuf cent soixante-six',\n    967: 'neuf cent soixante-sept',\n    968: 'neuf cent soixante-huit',\n    969: 'neuf cent soixante-neuf',\n    970: 'neuf cent soixante-dix',\n    971: 'neuf cent soixante et onze',\n    972: 'neuf cent soixante-douze',\n    973: 'neuf cent soixante-treize',\n    974: 'neuf cent soixante-quatorze',\n    975: 'neuf cent soixante-quinze',\n    976: 'neuf cent soixante-seize',\n    977: 'neuf cent soixante-dix-sept',\n    978: 'neuf cent soixante-dix-huit',\n    979: 'neuf cent soixante-dix-neuf',\n    980: 'neuf cent quatre-vingts',\n    981: 'neuf cent quatre-vingt-un',\n    982: 'neuf cent quatre-vingt-deux',\n    983: 'neuf cent quatre-vingt-trois',\n    984: 'neuf cent quatre-vingt-quatre',\n    985: 'neuf cent quatre-vingt-cinq',\n    986: 'neuf cent quatre-vingt-six',\n    987: 'neuf cent quatre-vingt-sept',\n    988: 'neuf cent quatre-vingt-huit',\n    989: 'neuf cent quatre-vingt-neuf',\n    990: 'neuf cent quatre-vingt-dix',\n    991: 'neuf cent quatre-vingt-onze',\n    992: 'neuf cent quatre-vingt-douze',\n    993: 'neuf cent quatre-vingt-treize',\n    994: 'neuf cent quatre-vingt-quatorze',\n    995: 'neuf cent quatre-vingt-quinze',\n    996: 'neuf cent quatre-vingt-seize',\n    997: 'neuf cent quatre-vingt-dix-sept',\n    998: 'neuf cent quatre-vingt-dix-huit',\n    999: 'neuf cent quatre-vingt-dix-neuf',\n  }\n  type IndexNb = keyof typeof dictionnaire\n\n  const nbString = nb.toString()\n  let classeDesMilliards = ''\n\n  if (\n    nbString.substring(nbString.length - 12, nbString.length - 9).length > 0\n  ) {\n    classeDesMilliards = dictionnaire[\n      nbString\n        .substring(nbString.length - 12, nbString.length - 9)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let classeDesMillions = ''\n  if (nbString.substring(nbString.length - 9, nbString.length - 6).length > 0) {\n    classeDesMillions = dictionnaire[\n      nbString\n        .substring(nbString.length - 9, nbString.length - 6)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let classeDesMilliers = ''\n  if (\n    nbString.substring(nbString.length - 6, nbString.length - 3) === '080' ||\n    nbString.substring(nbString.length - 6, nbString.length - 3) === '80'\n  ) {\n    classeDesMilliers = 'quatre-vingt'\n  } else if (\n    nbString.substring(nbString.length - 5, nbString.length - 3) === '00' &&\n    nbString.substring(nbString.length - 6, nbString.length - 5) !== '1'\n  ) {\n    classeDesMilliers = dictionnaire[\n      nbString\n        .substring(nbString.length - 6, nbString.length - 3)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ]\n      .replaceAll(' ', '-')\n      .replace('cents', 'cent')\n  } else if (\n    nbString.substring(nbString.length - 6, nbString.length - 3).length > 0\n  ) {\n    classeDesMilliers = dictionnaire[\n      nbString\n        .substring(nbString.length - 6, nbString.length - 3)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let classeDesUnites = ''\n  if (nbString.substring(nbString.length - 3, nbString.length).length > 0) {\n    classeDesUnites = dictionnaire[\n      nbString\n        .substring(nbString.length - 3, nbString.length)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let result = ''\n  if (classeDesMilliards.length > 1) {\n    classeDesMilliards === 'un'\n      ? (result += classeDesMilliards + '-milliard')\n      : (result += classeDesMilliards + '-milliards')\n    if (\n      classeDesMillions !== 'zro' ||\n      classeDesMilliers !== 'zro' ||\n      classeDesUnites !== 'zro'\n    ) {\n      result += '-'\n    }\n  }\n  if (classeDesMillions.length > 1 && classeDesMillions !== 'zro') {\n    classeDesMillions === 'un'\n      ? (result += classeDesMillions + '-million')\n      : (result += classeDesMillions + '-millions')\n    if (classeDesMilliers !== 'zro' || classeDesUnites !== 'zro') {\n      result += '-'\n    }\n  }\n  if (classeDesMilliers.length > 1 && classeDesMilliers !== 'zro') {\n    classeDesMilliers === 'un'\n      ? (result += 'mille')\n      : (result += classeDesMilliers + '-mille')\n    if (classeDesUnites !== 'zro') {\n      result += '-'\n    }\n  }\n  if (classeDesUnites.length > 1 && classeDesUnites !== 'zro') {\n    result += classeDesUnites\n  }\n  result = result.replace('deux-cents-mille', 'deux-cent-mille')\n  result = result.replace('trois-cents-mille', 'trois-cent-mille')\n  result = result.replace('quatre-cents-mille', 'quatre-cent-mille')\n  result = result.replace('cinq-cents-mille', 'cinq-cent-mille')\n  result = result.replace('six-cents-mille', 'six-cent-mille')\n  result = result.replace('sept-cents-mille', 'sept-cent-mille')\n  result = result.replace('huit-cents-mille', 'huit-cent-mille')\n  result = result.replace('neuf-cents-mille', 'neuf-cent-mille')\n  return result\n}\n","import FractionEtendue, { rationnalise } from './FractionEtendue'\nimport ListeFraction from './ListeFraction'\nimport { nombreEnLettres } from './nombreEnLettres'\n\n/**\n * Des fonctions pour manipuler des objets Fraction ou ListeFraction\n * @module\n */\n\n/**\n * Retourne une liste de fractions irrducibles\n * @return {FractionEtendue[]}\n */\nexport function obtenirListeFractionsIrreductibles() {\n  // sous forme de fractions\n  return [\n    new FractionEtendue(1, 2),\n    new FractionEtendue(1, 3),\n    new FractionEtendue(2, 3),\n    new FractionEtendue(1, 4),\n    new FractionEtendue(3, 4),\n    new FractionEtendue(1, 5),\n    new FractionEtendue(2, 5),\n    new FractionEtendue(3, 5),\n    new FractionEtendue(4, 5),\n    new FractionEtendue(1, 6),\n    new FractionEtendue(5, 6),\n    new FractionEtendue(1, 7),\n    new FractionEtendue(2, 7),\n    new FractionEtendue(3, 7),\n    new FractionEtendue(4, 7),\n    new FractionEtendue(5, 7),\n    new FractionEtendue(6, 7),\n    new FractionEtendue(1, 8),\n    new FractionEtendue(3, 8),\n    new FractionEtendue(5, 8),\n    new FractionEtendue(7, 8),\n    new FractionEtendue(1, 9),\n    new FractionEtendue(2, 9),\n    new FractionEtendue(4, 9),\n    new FractionEtendue(5, 9),\n    new FractionEtendue(7, 9),\n    new FractionEtendue(8, 9),\n    new FractionEtendue(1, 10),\n    new FractionEtendue(3, 10),\n    new FractionEtendue(7, 10),\n    new FractionEtendue(9, 10),\n  ]\n}\n\n/**\n * Retourne une liste de fractions irrducibles simples (1/2, 1/3, 2/3, 1/5  4/5, 1/7  6/7)\n * @return {FractionEtendue[]}\n */\nexport function obtenirListeFractionsIrreductiblesFaciles() {\n  // sous forme de fractions\n  return [\n    new FractionEtendue(1, 2),\n    new FractionEtendue(1, 3),\n    new FractionEtendue(2, 3),\n    new FractionEtendue(1, 5),\n    new FractionEtendue(2, 5),\n    new FractionEtendue(3, 5),\n    new FractionEtendue(4, 5),\n    new FractionEtendue(1, 7),\n    new FractionEtendue(2, 7),\n    new FractionEtendue(3, 7),\n    new FractionEtendue(4, 7),\n    new FractionEtendue(5, 7),\n    new FractionEtendue(6, 7),\n  ]\n}\n\nexport function listeFractions(...fractions: FractionEtendue[]): ListeFraction {\n  return new ListeFraction(...fractions)\n}\n\n/**\n * Construit et Retourne un objet FractionEtendue(a, b)\n * @param {number} a\n * @param {number|undefined} b\n * @return {FractionEtendue}\n */\nexport function fraction(a: number, b: number | undefined): FractionEtendue {\n  if (b === undefined) {\n    // pas d'argument b\n    if (a === undefined) {\n      window.notify(\"fraction de fractions : aucun argument n'est dfini \", {\n        a,\n        b,\n      })\n      throw new Error(\"fraction de fractions : aucun argument n'est dfini \")\n    } else {\n      if (typeof a === 'number') {\n        const frac = rationnalise(a)\n        return frac\n      } else if (!isNaN(a)) {\n        const frac = rationnalise(Number(a))\n        return frac\n      }\n      window.notify(\n        \"fraction de fractions : l'argument est de type inconvenant \",\n        { a },\n      )\n      throw new Error(\n        \"fraction de fractions : l'argument est de type inconvenant \",\n      )\n    }\n  } else {\n    // on a un argument b\n    if (a === undefined) {\n      window.notify(\n        \"fraction de fractions : le premier argument n'est pas dfini \",\n        { a, b },\n      )\n      throw new Error(\n        \"fraction de fractions : le premier argument n'est pas dfini \",\n      )\n    } else {\n      if (typeof a === 'number' && typeof b === 'number') {\n        return new FractionEtendue(a, b)\n      } else if (!isNaN(b) && !isNaN(a)) {\n        return new FractionEtendue(Number(a), Number(b))\n      }\n      window.notify(\n        'fraction de fractions : les arguments sont de type inconvenant ',\n        { a, b },\n      )\n      throw new Error(\n        'fraction de fractions : les arguments sont de type inconvenant ',\n      )\n    }\n  }\n}\n\nexport function denominateurEnLettre(den: number, pluriel: boolean): string {\n  let denEnLettre\n  switch (den) {\n    case 2:\n      return pluriel ? 'demis' : 'demi'\n    case 3:\n      return 'tiers'\n    case 4:\n      return pluriel ? 'quarts' : 'quart'\n    case 9:\n      return pluriel ? 'neuvimes' : 'neuvime'\n    default:\n      denEnLettre = nombreEnLettres(den)\n      if (den === 5) return pluriel ? 'cinquimes' : 'cinquime'\n      if (!denEnLettre.endsWith('e')) {\n        return `${denEnLettre}ime${pluriel ? 's' : ''}`\n      }\n      return `${denEnLettre.substring(0, denEnLettre.length - 1)}ime${pluriel ? 's' : ''}`\n  }\n}\n","import { orangeMathalea } from 'apigeom/src/elements/defaultValues'\nimport Decimal from 'decimal.js'\nimport { equal, round } from 'mathjs'\nimport type { IFractionEtendue } from '../../modules/FractionEtendue.type'\nimport { fraction } from '../../modules/fractions'\nimport Grandeur from '../../modules/Grandeur'\nimport Hms from '../../modules/Hms'\nimport { egal } from '../../modules/outils'\nimport type { AnswerValueType } from '../types'\nimport { miseEnEvidence } from './embellissements'\nimport { arrondi } from './nombres'\nimport { lettreDepuisChiffre } from './outilString'\nimport { stringNombre, texNombre } from './texNombre'\n\n// Garde de type structurel pour dtecter une FractionEtendue sans import runtime\nconst isFractionEtendue = (x: unknown): x is IFractionEtendue =>\n  typeof x === 'object' &&\n  x !== null &&\n  // signature minimale et stable de FractionEtendue\n  typeof (x as any).sommeFraction === 'function'\n\n/**\n * crit le nombre, mais pas un nombre s'il est gal  1\n * @Example\n * //rienSi1(1)+'x' -> x\n * //rienSi1(-1)+'x' -> -x\n * @author Rmi Angot et Jean-Claude Lhote pour le support des fractions\n */\nexport function rienSi1(a: number | IFractionEtendue | Decimal) {\n  if (typeof a === 'number') {\n    if (a === 1) return ''\n    if (a === -1) return '-'\n    return texNombre(a)\n  }\n  if (a instanceof Decimal) {\n    if (a.eq(1)) return ''\n    if (a.eq(-1)) return '-'\n    return texNombre(a)\n  }\n  if (\n    isFractionEtendue(a) &&\n    !(a.isEqual(fraction(1, 1)) || a.isEqual(fraction(-1, 1)))\n  ) {\n    return a.toLatex()\n  }\n  if (isFractionEtendue(a) && a.isEqual(fraction(1, 1))) return ''\n  if (isFractionEtendue(a) && a.isEqual(fraction(-1, 1))) return '-'\n  if (!isFractionEtendue(a)) {\n    if (egal(a, 1)) return ''\n    if (egal(a, -1)) return '-'\n  }\n  if (typeof a === 'string') {\n    window.notify(\"rienSi1() n'accepte pas les string.\", { argument: a })\n    return texNombre(Number(a), 7)\n  }\n  window.notify('rienSi1 : type de valeur non prise en compte : ', { a })\n  return String(a)\n}\n\n/**\n * @param a Un nombre, une fraction ou une chane de caractres\n * @example\n * // rienSi0(0) -> ''\n * // rienSi0(2) -> '2'\n * @author Guillaume Valmont\n */\nexport function rienSi0(a: number | IFractionEtendue | Decimal) {\n  if (typeof a === 'number') {\n    if (a === 0) return ''\n    return texNombre(a)\n  }\n  if (a instanceof Decimal) {\n    if (a.isZero()) return ''\n    return texNombre(a)\n  }\n  if (isFractionEtendue(a) && !a.isEqual(fraction(0, 1))) {\n    return a.toLatex()\n  }\n  if (isFractionEtendue(a) && a.isEqual(fraction(0, 1))) return ''\n  if (!isFractionEtendue(a)) {\n    if (egal(a, 0)) return ''\n  }\n  if (typeof a === 'string') {\n    window.notify(\"rienSi0() n'accepte pas les string.\", { argument: a })\n    return texNombre(Number(a), 7)\n  }\n  window.notify('rienSi0 : type de valeur non prise en compte : ', { a })\n  return String(a)\n}\n\n/**\n * @deprecated\n * Gre l'criture de l'exposant en mode text (ne doit pas s'utiliser entre $ $)\n * Pour le mode maths (entre $ $) on utilisera tout simplement ^3 pour mettre au cube ou ^{42} pour la puissance 42.\n * @Example\n * // 'dm'+texteExposant(3) -> Privilgier maintenant '$\\\\text{dm}^3$'\n * @author Rmi Angot\n */\n/* export function texteExposant(texte: string | number) {\n  if (typeof texte === 'number') texte = String(texte)\n  if (context.isHtml) {\n    return `<sup>${texte}</sup>`\n  } else {\n    return `\\\\up{${texte}}`\n  }\n} */\n\n/**\n * Ajoute les parenthses et le signe\n * @Example\n * //(+3) ou (-3)\n * @author Rmi Angot\n */\nexport function ecritureNombreRelatif(a: number) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureNombreRelatif() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  if (a > 0) {\n    return '(+' + texNombre(a) + ')'\n  } else if (a < 0) {\n    return '(' + texNombre(a) + ')'\n  }\n  // ne pas mettre de parenthses pour le nombre 0.\n  return '0'\n}\n\n/**\n * Idem ecritureNombreRelatif avec le code couleur : vert si positif, rouge si ngatif, noir si nul\n * @param {number} a\n */\nexport function ecritureNombreRelatifc(\n  a: string | number,\n  { color = null }: { color?: string | null } = {},\n) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureNombreRelatifc() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  let result = ''\n  if (a > 0) {\n    result = miseEnEvidence('(+' + texNombre(a, 7) + ')', color ?? 'blue')\n  } else if (a < 0) {\n    result = miseEnEvidence('(' + texNombre(a, 7) + ')', color ?? 'green') // EE : Je change cette couleur pour ne pas avoir le orange de la correction.\n  } else {\n    // ne pas mettre de parenthses pour le nnombre 0.\n    result = miseEnEvidence('0', color ?? 'black')\n  }\n  return result\n}\n\n/**\n * Ajoute le + devant les nombres positifs\n * @Example\n * //+3 ou -3\n * @author Rmi Angot et Jean-claude Lhote pour le support des fractions\n */\nexport function ecritureAlgebrique(a: number | IFractionEtendue | Decimal) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebrique() n'accepte pas les string.\", {\n      argument: a,\n    })\n    return a\n  } else if (isFractionEtendue(a)) {\n    return a.texFractionSignee\n  } else if (typeof a === 'number') {\n    if (a >= 0) {\n      return '+' + texNombre(a, 7)\n    } else {\n      return texNombre(a, 7)\n    }\n  } else if (a instanceof Decimal) {\n    if (a.isPos()) {\n      return '+' + texNombre(a, 7)\n    } else {\n      return texNombre(a, 7)\n    }\n  } else {\n    window.notify('ecritureAlgebrique() : type de valeur non prise en compte', {\n      argument: a,\n    })\n    return ''\n  }\n}\n\n/**\n * Ajoute le + devant les nombres positifs, n'crit rien si 1\n * @Example\n * //+3 ou -3\n * @author Rmi Angot et Jean-Claude Lhote pour le support des fractions\n */\nexport function ecritureAlgebriqueSauf1(\n  a: IFractionEtendue | number | Decimal,\n) {\n  if (isFractionEtendue(a)) {\n    if (a.num === 1 && a.den === 1) return '+'\n    else if (a.num === -1 && a.den === 1) return '-'\n    else return a.texFractionSignee\n  }\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebriqueSauf1() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  if (equal(a, 1)) return '+'\n  else if (equal(a, -1)) return '-'\n  else if (typeof a === 'number' || a instanceof Decimal) {\n    return ecritureAlgebrique(a)\n  } else {\n    window.notify(\n      'ecritureAlgebriqueSauf1 : type de valeur non prise en compte',\n      {},\n    )\n    return 'erreur type de valeur non prise en compte'\n  }\n}\n\n/**\n * Ajoute le + devant les nombres positifs, n'crit rien si 1\n * @Example\n * //+3 ou -3\n * @author Nathan Scheinmann en copiant la fonction ecritureAlgebriqueSauf1\n */\nexport function ecritureAlgebriqueSauf0(\n  a: IFractionEtendue | number | Decimal,\n) {\n  if (isFractionEtendue(a)) {\n    if (a.num === 0 ) return ''\n  }\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebriqueSauf1() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  if (equal(a,0)) return ''\n  else if (typeof a === 'number' || a instanceof Decimal) {\n    return ecritureAlgebrique(a)\n  } else {\n    window.notify(\n      'ecritureAlgebriqueSauf1 : type de valeur non prise en compte',\n      {},\n    )\n    return 'erreur type de valeur non prise en compte'\n  }\n}\n\n/**\n * Idem ecritureAlgebrique mais retourne le nombre en couleur (vert si positif, rouge si ngatif et noir si nul).\n * @param {number} a\n */\nexport function ecritureAlgebriquec(a: number | string, color?: string) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebriquec() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  let result = ''\n  if (a > 0) {\n    result = miseEnEvidence('+' + texNombre(a, 7), color ?? 'blue')\n  } else if (a < 0) {\n    result = miseEnEvidence(texNombre(a, 7), color ?? orangeMathalea)\n  } else result = miseEnEvidence(texNombre(a, 7), color ?? 'black')\n  return result\n}\n\n/**\n * @param {number} r Un nombre relatif\n * @param {number} precision nombre de chiffres maximum aprs la virgule pour texNombre.\n * @returns {string} met en vidence le signe - si r < 0\n */\n\nexport function signeMoinsEnEvidence(r: number, precision = 0) {\n  if (typeof r !== 'number') {\n    window.notify(\n      \"signeMoinsEnEvidence() appel avec autre chose qu'un nombre.\",\n      { argument: r },\n    )\n  } else if (r < 0) {\n    return miseEnEvidence('-') + texNombre(Math.abs(r), precision)\n  } else return texNombre(Math.abs(r), precision)\n}\n\n/**\n * Ajoute des parenthses aux nombres ngatifs\n * @Example\n * // 3 ou (-3)\n * @author Rmi Angot\n * @return {string}\n */\nexport function ecritureParentheseSiNegatif(\n  a: Decimal | number | IFractionEtendue,\n): string {\n  let result = ''\n  if (a instanceof Decimal) {\n    if (a.gte(0)) {\n      return texNombre(a, 8)\n      // On met 8 dcimales, mais cette fonctions s'utilise presque exclusivement avec des entiers donc a ne sert  rien\n    } else return `(${texNombre(a, 8)})`\n  } else if (typeof a === 'number') {\n    if (a >= 0) {\n      result = texNombre(a, 8) // j'ai pass le nombre dans texNombre, car la fonction ne prenait pas en compte l'criture dcimale !\n    } else {\n      result = `(${texNombre(a, 8)})`\n    }\n    return result\n  } else if (isFractionEtendue(a)) {\n    return a.ecritureParentheseSiNegatif\n  } else {\n    window.notify(\n      \"ecritureParentheseSiNegatif() appele avec autre chose qu'un nombre\",\n      { argument: a },\n    )\n    return 'undefined'\n  }\n}\n\n/**\n * Ajoute des parenthses si une expression commence par un moins\n * @Example\n * // (-3x)\n * @author Rmi Angot\n */\nexport function ecritureParentheseSiMoins(\n  expr: string | number | IFractionEtendue,\n) {\n  if (typeof expr === 'string' && expr[0] === '-') return `(${expr})`\n  else if (typeof expr === 'string') {\n    return expr\n    // Il faut sortir si c'est un string, il n'y a rien  faire de plus !\n  } else if (typeof expr === 'number' && expr < 0) {\n    return `(${stringNombre(expr, 7)})`\n  } else if (typeof expr === 'number') return stringNombre(expr, 7)\n  else if (isFractionEtendue(expr) && expr.s === -1) {\n    return `(${expr.texFSD})`\n  } else {\n    // avant on passait ici quand c'tait un string sans signe - devant... c'tait une mauvaise ide !\n    window.notify(\n      \"ecritureParentheseSiMoins() n'accepte pas ce type d'argument.\",\n      { argument: expr },\n    )\n    return String(expr)\n  }\n}\n\n/**\n *\n * @author Jean-claude Lhote\n * @param {numero} 1=A, 2=B ...\n * @param {etapes} tableau de chaines comportant les expressions  afficher dans le membre de droite.\n */\n\nexport function calculAligne(numero: number, etapes: number[]) {\n  let script = `$\\\\begin{aligned}${miseEnEvidence(lettreDepuisChiffre(numero))}&=${etapes[0]}`\n  for (let i = 1; i < etapes.length - 1; i++) {\n    script += `\\\\\\\\&=${etapes[i]}`\n  }\n  script += `\\\\\\\\${miseEnEvidence(lettreDepuisChiffre(numero) + '&=' + etapes[etapes.length - 1])}$`\n  return script\n}\n\n/**\n * Retourne gal si la valeur est gale  l'arrondi souhait ou environ gal si ce n'est pas le cas\n * Le nombre a est compar  son arrondi  prcision prs. Si la diffrence est infrieure  epsilon, alors on retourne '=' sinon '\\\\approx'\n * fonctionne aussi si a est une fraction : permet de finir un calcul par la valeur dcimale si on veut.\n * @author Jean-Claude Lhote\n */\nexport function egalOuApprox(\n  a: number | IFractionEtendue | Decimal,\n  precision: number,\n) {\n  if (isFractionEtendue(a)) {\n    // @ ts-expect-errors\n    return egal(a.num / a.den, arrondi(a.num / a.den, precision))\n      ? '='\n      : '\\\\approx'\n  } else if (a instanceof Decimal) {\n    return a.eq(a.toDP(precision)) ? '=' : '\\\\approx'\n  } else if (!isNaN(a) && !isNaN(precision)) {\n    return egal(a, round(a, precision), 10 ** (-precision - 2))\n      ? '='\n      : '\\\\approx'\n  } else {\n    window.notify(\"egalOuApprox : l'argument n'est pas un nombre\", {\n      a,\n      precision,\n    })\n    return 'Mauvais argument (nombres attendus).'\n  }\n}\n\n/**\n * renvoie une chaine correspondant  l'criture rduite d'ax+b selon les valeurs de a et b\n * La lettre par dfaut utilise est 'x' mais peut tre tout autre chose.\n * @author Eric Elter\n * @param {number | Decimal | FractionEtendue} a\n * @param {number | Decimal | FractionEtendue} b\n * @param {string} [inconnue = 'x'] 'x' par dfaut, mais on peut prciser autre chose.\n */\nexport function reduireAxPlusB(\n  a: number | Decimal | IFractionEtendue,\n  b: number | Decimal | IFractionEtendue,\n  inconnue: string = 'x',\n  options: OptionsReduireAxPlusByPlusC = {},\n) {\n  return reduireAxPlusByPlusC(a, 0, b, inconnue, undefined, options)\n}\n\n/* Ancienne version de Jean-Claude Lhote\n\nif (!(a instanceof Decimal)) a = new Decimal(a)\n  if (!(b instanceof Decimal)) b = new Decimal(b)\n  let result = ''\n  if (!a.isZero()) {\n    if (a.eq(1)) result = inconnue\n    else if (a.eq(-1)) result = '-' + inconnue\n    else result = `${texNombre(a, 7)}${inconnue}`\n  }\n  if (!b.isZero()) {\n    if (a.isZero()) result = texNombre(b, 7)\n    else result += ecritureAlgebrique(b)\n  } else if (a.isZero()) result = '0'\n  return result\n} */\n\ntype OptionsReduireAxPlusByPlusC = {\n  ordreInverse?: boolean // Si true, on inverse l'ordre des termes dans la chane de caractres retourne\n}\n\n/**\n * renvoie une chaine correspondant  l'criture rduite d'ax+by+c selon les valeurs de a, b et c\n * Les lettres par dfaut utilises sont 'x' et y mais peut tre tout autre chose.\n * @author Eric Elter\n * @param {number | Decimal | FractionEtendue} a\n * @param {number | Decimal | FractionEtendue} b\n * @param {number | Decimal | FractionEtendue} c\n * @param {string} [inconnueX = 'x'] 'x' par dfaut, mais on peut prciser autre chose.\n * @param {string} [inconnueY = 'y'] 'y' par dfaut, mais on peut prciser autre chose.\n * @example reduireAxPlusByPlusC(3,-4,5) // renvoie 3x-4y+5\n * @example reduireAxPlusByPlusC(1,-1,0) // renvoie x-y\n * @example reduireAxPlusByPlusC(0,2,-7) // renvoie 2y-7\n * @example reduireAxPlusByPlusC(3,0,6) // renvoie 3x+6\n * @example reduireAxPlusByPlusC(0,0,0) // renvoie 0\n * @example reduireAxPlusByPlusC(3,-4,5,'a','b') // renvoie 3a-4b+5\n * @return {string}\n */\nexport function reduireAxPlusByPlusC(\n  a: number | Decimal | IFractionEtendue,\n  b: number | Decimal | IFractionEtendue,\n  c: number | Decimal | IFractionEtendue,\n  inconnueX = 'x',\n  inconnueY = 'y',\n  options: OptionsReduireAxPlusByPlusC = {},\n) {\n  if (!(a instanceof Decimal) && !isFractionEtendue(a)) {\n    a = new Decimal(a)\n  }\n  if (!(b instanceof Decimal) && !isFractionEtendue(b)) {\n    b = new Decimal(b)\n  }\n  if (!(c instanceof Decimal) && !isFractionEtendue(c)) {\n    c = new Decimal(c)\n  }\n  let valeurDecimaleFraction: number\n  let aEgalZero: boolean\n  let bEgalZero: boolean\n  let cEgalZero: boolean\n  let termeA: string\n  let termeB: string\n  let termeC: string\n  if (a instanceof Decimal) {\n    aEgalZero = a.isZero()\n    termeA = aEgalZero\n      ? ''\n      : (a.eq(1)\n          ? options.ordreInverse\n            ? '+'\n            : ''\n          : a.eq(-1)\n            ? '-'\n            : options.ordreInverse\n              ? ecritureAlgebriqueSauf1(a)\n              : texNombre(a)) + inconnueX\n  } else {\n    valeurDecimaleFraction = a.valeurDecimale\n    aEgalZero = valeurDecimaleFraction === 0\n    termeA = aEgalZero\n      ? ''\n      : (valeurDecimaleFraction === 1\n          ? options.ordreInverse\n            ? '+'\n            : ''\n          : valeurDecimaleFraction === -1\n            ? '-'\n            : options.ordreInverse\n              ? a.texFractionSignee\n              : a.texFSD) + inconnueX\n  }\n  if (b instanceof Decimal) {\n    bEgalZero = b.isZero()\n    termeB = bEgalZero\n      ? ''\n      : (b.eq(-1)\n          ? '-'\n          : b.eq(1) && aEgalZero\n            ? ''\n            : b.eq(1) && !aEgalZero\n              ? '+'\n              : aEgalZero\n                ? texNombre(b)\n                : ecritureAlgebrique(b)) + inconnueY\n  } else {\n    valeurDecimaleFraction = b.valeurDecimale\n    bEgalZero = valeurDecimaleFraction === 0\n    termeB = bEgalZero\n      ? ''\n      : (valeurDecimaleFraction === -1\n          ? '-'\n          : valeurDecimaleFraction === 1 && aEgalZero\n            ? ''\n            : valeurDecimaleFraction === 1 && !aEgalZero\n              ? '+'\n              : bEgalZero\n                ? `${b.texFSD}`\n                : `${b.texFractionSignee}`) + inconnueY\n  }\n  if (c instanceof Decimal) {\n    cEgalZero = c.isZero()\n    termeC =\n      aEgalZero && bEgalZero && cEgalZero\n        ? '0'\n        : cEgalZero\n          ? ''\n          : (aEgalZero && bEgalZero) || options.ordreInverse\n            ? texNombre(c)\n            : ecritureAlgebrique(c)\n  } else {\n    valeurDecimaleFraction = c.valeurDecimale\n    cEgalZero = valeurDecimaleFraction === 0\n    termeC =\n      aEgalZero && bEgalZero && cEgalZero\n        ? '0'\n        : cEgalZero\n          ? ''\n          : (aEgalZero && bEgalZero) || options.ordreInverse\n            ? `${c.texFSD}`\n            : `${c.texFractionSignee}`\n  }\n  const result = options.ordreInverse\n    ? `${termeC}${termeB}${termeA}`\n    : `${termeA}${termeB}${termeC}`\n  return result\n}\n\n/**\n * renvoie une chaine correspondant  l'criture rduite d'ax^3+bx^2+cx+d selon les valeurs de a, b, c et d\n * @author Jean-Claude Lhote\n */\nexport function reduirePolynomeDegre3(\n  a: number | string,\n  b: number | string,\n  c: number | string,\n  d: number | string,\n  x = 'x',\n) {\n  ;[a, b, c, d].forEach((el) => (typeof el === 'number' ? el : Number(el)))\n  let result = ''\n  if (a !== 0) {\n    switch (a) {\n      case 1:\n        result += `${x}^3`\n        break\n      case -1:\n        result += `-${x}^3`\n        break\n      default:\n        result += `${a}${x}^3`\n        break\n    }\n    if (b !== 0) {\n      switch (b) {\n        case 1:\n          result += `+${x}^2`\n          break\n        case -1:\n          result += `-${x}^2`\n          break\n        default:\n          result += `${typeof b === 'number' ? ecritureAlgebrique(b) : b}${x}^2`\n          break\n      }\n    }\n    if (c !== 0) {\n      switch (c) {\n        case 1:\n          result += `+${x}`\n          break\n        case -1:\n          result += `-${x}`\n          break\n        default:\n          result += `${typeof c === 'number' ? ecritureAlgebrique(c) : c}${x}`\n          break\n      }\n    }\n    if (d !== 0) {\n      result += `${typeof d === 'number' ? ecritureAlgebrique(d) : d}`\n    }\n  } else {\n    // degr 2 pas de degr 3\n    if (b !== 0) {\n      switch (b) {\n        case 1:\n          result += `${x}^2`\n          break\n        case -1:\n          result += `-${x}^2`\n          break\n        default:\n          result += `${b}${x}^2`\n          break\n      }\n      if (c !== 0) {\n        switch (c) {\n          case 1:\n            result += `+${x}`\n            break\n          case -1:\n            result += `-${x}`\n            break\n          default:\n            result += `${typeof c === 'number' ? ecritureAlgebrique(c) : c}${x}`\n            break\n        }\n      }\n      if (d !== 0) {\n        result += `${typeof d === 'number' ? ecritureAlgebrique(d) : d}`\n      }\n    } else if (c !== 0) {\n      // degr 1 pas de degr 2 ni de degr 3\n      switch (c) {\n        case 1:\n          result += `${x}`\n          break\n        case -1:\n          result += `-${x}`\n          break\n        default:\n          result += `${c}${x}`\n          break\n      }\n      if (d !== 0) {\n        result += `${typeof d === 'number' ? ecritureAlgebrique(d) : d}`\n      }\n    } else {\n      // degr 0 a=0, b=0 et c=0\n      result += `${d}`\n    }\n  }\n  return result\n}\n\nexport function ordreAlphabetique(str: string): string {\n  const chars = Array.from(str)\n  const orderedChars = chars.sort((a, b) => a.charCodeAt(0) - b.charCodeAt(0))\n  return orderedChars.join('')\n}\n\n/**\n * Liste les diffrents lments d'un array spars par une virgule et un \"et\" avant le dernier lment\n * @param array\n * @returns une chane  afficher\n */\nexport function lister(array: unknown[]): string {\n  let str = ''\n  for (let i = 0; i < array.length - 1; i++) {\n    if (i !== 0) str += ', '\n    str += array[i]\n  }\n  if (array.length > 1) str += ' et '\n  str += array[array.length - 1]\n  return str\n}\n\n/**\n * Retourne le double dveloppement de (ax+b)(cx+d) sous forme d'un tableau.\n * La premier lment est le dveloppement terme par terme.\n * Le second lment est ce dveloppement rduit terme par terme.\n * Si reduire est vrai, et qu'il y a des parenthses encadrant les termes ngatifs, on renvoie aussi le dveloppement rduit en somme algbrique.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [a=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [b=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [c=1] Un entier actuellement uniquement(par dfaut, c'est 1)\n * @param {string} [x='x'] Le nom de la variable (par dfaut, c'est 'x')\n * @param {boolean} [reduire=false] Vrai si on veut rduire le dveloppement en somme algbrique\n * @return {string[]}\n * @author Eric Elter\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4})[0] renvoie 5x*(-x)+5x*4+(-2)*(-x)+(-2)*4\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4})[1] renvoie -5x^2+20x+2x+(-8)\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4, variable:'y})[0] renvoie 5y*(-y)+5y*4+(-2)*(-y)+(-2)*4\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4, variable:'y})[1] renvoie -5y^2+20y+2y+(-8)\n */\nexport function doubleDeveloppement({\n  a = 1,\n  b = 1,\n  c = 1,\n  d = 1,\n  x = 'x',\n  reduire = false,\n} = {}) {\n  if (a === 0) {\n    return [\n      ...simpleDeveloppement({ a: c, b: d, c: b, x, sommeAGauche: false }),\n    ]\n  }\n  if (b === 0) {\n    return [\n      ...simpleDeveloppementAvecDoubleX({\n        a: c,\n        b: d,\n        c: a,\n        x,\n        sommeAGauche: false,\n      }),\n    ]\n  }\n  if (c === 0) return [...simpleDeveloppement({ a, b, c: d, x })]\n  if (d === 0) return [...simpleDeveloppementAvecDoubleX({ a, b, c, x })]\n  const expression1 = `${rienSi1(a)}${x}\\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)} + \n  ${ecritureParentheseSiMoins(rienSi1(a) + x)}\\\\times ${ecritureParentheseSiNegatif(d)} +\n  ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)}  +\n  ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiNegatif(d)}`\n  const expression2 = `${rienSi1(a * c)}${x}^2 + \n  ${ecritureParentheseSiMoins(rienSi1(a * d) + x)} +\n  ${ecritureParentheseSiMoins(rienSi1(b * c) + x)} +\n  ${ecritureParentheseSiNegatif(b * d)}`\n  const expression3 = `${rienSi1(a * c)}${x}^2\n  ${ecritureAlgebriqueSauf1(a * d)}${x}\n  ${ecritureAlgebriqueSauf1(b * c)}${x}\n  ${ecritureAlgebrique(b * d)}`\n  return reduire && expression2 !== expression3\n    ? [expression1, expression2, expression3]\n    : [expression1, expression2]\n}\n\n/**\n * Retourne le simple dveloppement de (ax+b)c ou c(ax+b) sous forme d'un tableau.\n * La premier lment est le dveloppement terme par terme.\n * Le second lment est ce dveloppement rduit terme par terme.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [a=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [b=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [c=1] Un entier actuellement uniquement(par dfaut, c'est 1)\n * @param {string} [x='x'] Le nom de la variable (par dfaut, c'est 'x')\n * @param {boolean} [sommeAGauche=true] Vrai si (ax+b)c, Faux si c(ax+b)\n * @return {string[]}\n * @author Eric Elter\n * @example simpleDeveloppement({ a:5, b:-2, c:3})[0] renvoie 5x*3+(-2)*3\n * @example simpleDeveloppement({ a:5, b:-2, c:3})[1] renvoie 15x+(-6)\n * @example simpleDeveloppement({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[0] renvoie 3*5y+3*(-2)\n * @example simpleDeveloppement({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[1] renvoie 15y+(-6)\n */\nexport function simpleDeveloppement({\n  a = 1,\n  b = 1,\n  c = 1,\n  x = 'x',\n  sommeAGauche = true,\n} = {}) {\n  if (a === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(b)} \\\\times ${ecritureParentheseSiNegatif(c)}`\n        : `${rienSi1(c)} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n      `${rienSi1(b * c)}`,\n    ]\n  }\n  if (b === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(a)}${x}} \\\\times ${ecritureParentheseSiNegatif(c)}`\n        : `${rienSi1(c)} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)}`,\n      `${rienSi1(a * c)}${x}`,\n    ]\n  }\n  if (c === 0) {\n    return [0, 0]\n  }\n  return [\n    sommeAGauche\n      ? `${rienSi1(a)}${x}\\\\times ${ecritureParentheseSiNegatif(c)} +\n    ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiNegatif(c)}`\n      : `${rienSi1(c)} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)} +\n      ${ecritureParentheseSiNegatif(c)} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n    `${rienSi1(a * c)}${x} + \n    ${ecritureParentheseSiMoins(rienSi1(b * c) ?? '')}`,\n  ]\n}\n\n/**\n * Retourne le simple dveloppement de (ax+b)cx ou cx(ax+b) sous forme d'un tableau.\n * La premier lment est le dveloppement terme par terme.\n * Le second lment est ce dveloppement rduit terme par terme.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [a=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [b=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [c=1] Un entier actuellement uniquement(par dfaut, c'est 1)\n * @param {string} [x='x'] Le nom de la variable (par dfaut, c'est 'x')\n * @param {boolean} [sommeAGauche=true] Vrai si (ax+b)c, Faux si c(ax+b) (par dfaut, c'est vrai)\n * @return {string[]}\n * @author Eric Elter\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3})[0] renvoie 5x*3x+(-2)*3x\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3})[1] renvoie 15x^2+(-6x)\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[0] renvoie 3y*5y+3y*(-2)\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[1] renvoie 15y^2+(-6y)\n */\nexport function simpleDeveloppementAvecDoubleX({\n  a = 1,\n  b = 1,\n  c = 1,\n  x = 'x',\n  sommeAGauche = true,\n  doubleX = true,\n} = {}) {\n  const xCarre = doubleX ? x + '^2' : x\n  const xSeul = doubleX ? x : ''\n  if (a === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(b)} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)}`\n        : `${rienSi1(c)}${x} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n      `${rienSi1(b * c)}${x}`,\n    ]\n  }\n  if (b === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(a)}${x}} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)}`\n        : `${rienSi1(c)}${x} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)}`,\n      `${rienSi1(a * c)}${x}`,\n    ]\n  }\n  if (c === 0) {\n    return [0, 0]\n  }\n  return [\n    sommeAGauche\n      ? `${rienSi1(a)}${x}\\\\times ${ecritureParentheseSiMoins(rienSi1(c) + xSeul)} +\n    ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + xSeul)}`\n      : `${rienSi1(c)}${xSeul} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)} +\n      ${ecritureParentheseSiMoins(rienSi1(c) + xSeul)} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n    `${rienSi1(a * c)}${xCarre} + \n      ${ecritureParentheseSiMoins(rienSi1(b * c) + xSeul)}`,\n  ]\n}\n\n/**\n * Formate une rponse pour son affichage, par exemple pour formater les diffrents distracteurs de la version qcm d'un exercice de type simple.\n * Si la rponse est un tableau, elle formate le premier lment.\n * @param a La valeur  formater\n * @returns {string} La valeur formate pour l'affichage\n */\nexport function formaterReponse(a: AnswerValueType): string {\n  if (Array.isArray(a)) {\n    return formaterReponse(a[0])\n  }\n  if (typeof a === 'number' || a instanceof Decimal) {\n    return `$${texNombre(a, 7)}$`\n  }\n  if (isFractionEtendue(a)) {\n    return `$${a.texFraction}$`\n  }\n  if (typeof a === 'string') {\n    return a\n  }\n  if (a instanceof Grandeur) {\n    return `$${a.toTex()}$`\n  }\n  if (a instanceof Hms) {\n    return a.toString()\n  }\n  window.notify('formaterReponse : type de valeur non prise en compte : ', {\n    a,\n  })\n  return String(a)\n}\n","import scratchblocks from 'scratchblocks'\nimport scratchFr from '../json/scratchFr.json'\n\nexport default function renderScratch(selector = '') {\n  // Excuter 2 fois le rendu sur un mme lment <pre> semble buguer\n  // Donc le slectionneur css ne cible que l'exercice en cours\n  // pour ne pas altrer les rendus des autres exercices\n  if (selector !== '') selector = selector + ' '\n  scratchblocks.loadLanguages({ fr: scratchFr })\n  if (document.querySelector(`${selector}pre.blocks`)) {\n    scratchblocks.renderMatching(`${selector}pre.blocks`, {\n      style: 'scratch3',\n      languages: ['fr'],\n      scale: 0.7,\n    })\n    // Le code est rendu dans un svg enfant de pre.blocks\n    // Quand le render passe une 2e fois, il essaie de rendre le code svg d'o le bug\n    // Donc une fois le code rendu, on enlve la classe blocks pour ne plus le slectionner\n    document\n      .querySelectorAll(`${selector}pre.blocks`)\n      .forEach((el) => el.classList.remove('blocks'))\n  }\n  if (document.querySelector(`${selector}code.b`)) {\n    scratchblocks.renderMatching(`${selector}code.b`, {\n      inline: true,\n      style: 'scratch3',\n      languages: ['fr'],\n      scale: 0.7,\n    })\n  }\n\n  // POUR GERER LE ZOOM\n  const elts = document.querySelectorAll(`${selector}pre.blocks2`)\n  const scales = new Set()\n  elts.forEach((ele) => {\n    const scale = Number(ele.getAttribute('scale'))\n    scales.add(scale)\n  })\n  scales.forEach((scale) => {\n    scratchblocks.renderMatching(`${selector}pre.blocks2[scale=\"${scale}\"]`, {\n      style: 'scratch3',\n      languages: ['fr'],\n      scale,\n    })\n    document\n      .querySelectorAll(`${selector}pre.blocks2[scale=\"${scale}\"]`)\n      .forEach((el) => el.classList.remove('blocks2'))\n  })\n}\n\n/**\n *\n * @param {HTMLElement} root\n */\nexport function renderScratchDiv(root = document.body) {\n  scratchblocks.loadLanguages({ fr: scratchFr })\n\n  // === RENDU DES BLOCS MULTILIGNES ===\n  const preBlocks = root.querySelectorAll('pre.blocks')\n  if (preBlocks.length > 0) {\n    preBlocks.forEach((el) => el.setAttribute('data-sb', ''))\n    scratchblocks.renderMatching('pre.blocks[data-sb] ', {\n      style: 'scratch3',\n      languages: ['fr'],\n      scale: 0.7,\n    })\n    preBlocks.forEach((el) => el.removeAttribute('data-sb'))\n\n    // Empcher un second rendu\n    preBlocks.forEach((el) => el.classList.remove('blocks'))\n  }\n\n  // === RENDU INLINE ===\n  const inlineBlocks = root.querySelectorAll('code.b')\n  if (inlineBlocks.length > 0) {\n    inlineBlocks.forEach((el) => el.setAttribute('data-si', ''))\n    scratchblocks.renderMatching('code.b[data-si]', {\n      inline: true,\n      style: 'scratch3',\n      languages: ['fr'],\n      scale: 0.7,\n    })\n    inlineBlocks.forEach((el) => el.removeAttribute('data-si'))\n  }\n\n  // === GESTION DU ZOOM (blocks2 avec scale variable) ===\n  const elts = root.querySelectorAll('pre.blocks2')\n  if (elts.length > 0) {\n    elts.forEach((el) => el.setAttribute('data-sb2', ''))\n    const scales = new Set()\n\n    elts.forEach((el) => {\n      const scaleAttr = el.getAttribute('scale')\n      if (scaleAttr) {\n        const scale = Number(scaleAttr)\n        if (!Number.isNaN(scale)) scales.add(scale)\n      }\n    })\n\n    scales.forEach((scale) => {\n      const targets = root.querySelectorAll(\n        `pre.blocks2[data-sb2][scale=\"${scale}\"]`,\n      )\n\n      scratchblocks.renderMatching(`pre.blocks2[data-sb2][scale=\"${scale}\"]`, {\n        style: 'scratch3',\n        languages: ['fr'],\n        scale,\n      })\n      targets.forEach((el) => el.removeAttribute('data-sb2'))\n      targets.forEach((el) => el.classList.remove('blocks2'))\n    })\n  }\n}\n","import type { VueType } from '../VueType'\n\nexport const ALLOWED_LANGUAGES = ['fr-FR', 'fr-CH'] as const\nexport type Language = (typeof ALLOWED_LANGUAGES)[number]\nexport type LanguageDisplay = Record<\n  Language,\n  { short: string; long: string; country: string }\n>\nexport const isLanguage = (obj: unknown): obj is Language =>\n  obj !== null &&\n  typeof obj === 'string' &&\n  ALLOWED_LANGUAGES.includes(obj as Language)\nexport const VUES_WITH_LANG_STATUS_ONLY: VueType[] = [\n  'confeleve',\n  'amc',\n  'anki',\n  'can',\n  'diaporama',\n  'eleve',\n  'latex',\n  'moodle',\n]\n","import { get, writable } from 'svelte/store'\nimport { isLanguage, type Language } from '../types/languages'\nimport { decrypt } from '../components/urls'\nimport refToUuidFR from '../../json/refToUuidFR.json'\nimport refToUuidCH from '../../json/refToUuidCH.json'\n\nexport const localisedIDToUuid: Record<Language, Record<string, string>> = {\n  'fr-CH': { ...refToUuidCH },\n  'fr-FR': { ...refToUuidFR },\n}\n\nexport const referentielLocale = writable<Language>('fr-FR')\n\nexport const updateReferentielLocaleFromURL = (\n  urlString = window.location.href,\n) => {\n  let url: URL\n  try {\n    url = new URL(urlString)\n  } catch {\n    return {}\n  }\n  url = decrypt(url)\n  const params = url.searchParams\n  const lang = params.get('lang')\n  if (lang) {\n    if (isLanguage(lang) && lang !== get(referentielLocale)) {\n      referentielLocale.set(lang)\n    }\n  } else if (get(referentielLocale) !== 'fr-FR') {\n    referentielLocale.set('fr-FR')\n  }\n}\n\nexport const updateURLFromReferentielLocale = (url: URL) => {\n  const locale = get(referentielLocale)\n  const params = url.searchParams\n  if (locale === 'fr-FR') {\n    params.delete('lang')\n  } else {\n    params.set('lang', locale)\n  }\n}\n\nexport function getLang() {\n  return get(referentielLocale)\n}\n","/**\n * Le type NumberRange<T, U> qu'on peut trouver dans src/lib/types.ts est trs bien pour dfinir un intervalle de nombres,\n * mais il n'est pas \"type guardable\". C'est--dire qu'on ne peut pas crer de fonction qui permet dire  typescript\n * que la valeur passe en argument est bien un NumberRange<T, U>.\n * Il est mme probable que ce soit impossible  faire avec la version de typescript actuelle.\n * En attendant, je propose d'utiliser ce fichier pour crer les intervalles de nombres dont on a besoin au fur et  mesure avec les type guards qui vont avec.\n */\n\nexport type IntegerInRange0to2 = 0 | 1 | 2\nexport function isIntegerInRange0to2(obj: unknown): obj is IntegerInRange0to2 {\n  return obj === 0 || obj === 1 || obj === 2\n}\n\nexport type IntegerInRange0to3 = 0 | 1 | 2 | 3\nexport function isIntegerInRange0to3(obj: unknown): obj is IntegerInRange0to3 {\n  return obj === 0 || obj === 1 || obj === 2 || obj === 3\n}\n\nexport type IntegerInRange0to4 = 0 | 1 | 2 | 3 | 4\nexport function isIntegerInRange0to4(obj: unknown): obj is IntegerInRange0to4 {\n  return obj === 0 || obj === 1 || obj === 2 || obj === 3 || obj === 4\n}\n\nexport type IntegerInRange1to4 = 1 | 2 | 3 | 4\nexport function isIntegerInRange1to4(obj: unknown): obj is IntegerInRange1to4 {\n  return obj === 1 || obj === 2 || obj === 3 || obj === 4\n}\n","import Decimal from 'decimal.js'\nimport renderMathInElement from 'katex/contrib/auto-render'\nimport 'katex/dist/katex.min.css'\nimport seedrandom from 'seedrandom'\nimport { get } from 'svelte/store'\nimport Exercice from '../exercices/Exercice'\nimport ExerciceSimple from '../exercices/ExerciceSimple'\nimport referentielStaticCH from '../json/referentielStaticCH.json'\nimport referentielStaticFR from '../json/referentielStaticFR.json'\nimport uuidToUrl from '../json/uuidsToUrlFR.json'\nimport {\n  ajouteChampTexteMathLive,\n  remplisLesBlancs,\n} from '../lib/interactif/questionMathLive'\nimport {\n  type AnswerValueType,\n  type IExercice,\n  type IExerciceStatique,\n  type InterfaceGlobalOptions,\n  type InterfaceParams,\n  type Valeur,\n  isAnswerValueType,\n  isValeur,\n} from '../lib/types'\nimport FractionEtendue from '../modules/FractionEtendue'\nimport Grandeur from '../modules/Grandeur'\nimport Hms from '../modules/Hms'\nimport { contraindreValeur } from '../modules/outils'\nimport { isStatic, isSvelte } from './components/componentsUtils'\nimport {\n  showDialogForLimitedTime,\n  showPopupAndWait,\n} from './components/dialogs'\nimport { resizeContent } from './components/sizeTools'\nimport { delay } from './components/time'\nimport { decrypt, isCrypted } from './components/urls'\nimport { checkForServerUpdate } from './components/version'\nimport { createURL } from './createURL'\nimport { sendToCapytaleMathaleaHasChanged } from './handleCapytale'\nimport { fonctionComparaison } from './interactif/comparisonFunctions'\nimport { handleAnswers, setReponse } from './interactif/gestionInteractif'\nimport { propositionsQcm } from './interactif/qcm'\nimport { shuffle } from './outils/arrayOutils'\nimport { formaterReponse } from './outils/ecritures'\nimport { renderScratchDiv } from './renderScratch'\nimport { canOptions } from './stores/canStore'\nimport {\n  exercicesParams,\n  freezeUrl,\n  presModeId,\n  updateGlobalOptionsInURL,\n} from './stores/generalStore'\nimport { globalOptions } from './stores/globalOptions'\nimport {\n  getLang,\n  localisedIDToUuid,\n  referentielLocale,\n  updateURLFromReferentielLocale,\n} from './stores/languagesStore'\nimport {\n  isIntegerInRange0to2,\n  isIntegerInRange0to4,\n  isIntegerInRange1to4,\n} from './types/integerInRange'\nimport { type VueType, convertVueType } from './VueType'\n\nconst ERROR_MESSAGE =\n  'Erreur - Veuillez actualiser la page et nous contacter si le problme persiste.'\n\nfunction getExerciceByUuid(\n  root: { [key: string]: any },\n  targetUUID: string,\n): object | null {\n  if ('uuid' in root) {\n    if (root.uuid === targetUUID) {\n      return root\n    }\n  }\n  for (const child in root) {\n    if (typeof root[child] !== 'object') continue\n    const foundObject = getExerciceByUuid(root[child], targetUUID)\n    if (foundObject) {\n      return foundObject\n    }\n  }\n\n  return null\n}\n\n/*\n Chargement d'un composant SVELTE\n ATTENTION : oliger d'tre daans ce rpertoire, sinon diffrence entre le serveur de test et de production\n*/\nexport async function getSvelteComponent(paramsExercice: InterfaceParams) {\n  const urlExercice = uuidToUrl[paramsExercice.uuid as keyof typeof uuidToUrl]\n\n  let filename, directory\n  if (urlExercice) {\n    ;[filename, directory] = urlExercice\n      .replaceAll('\\\\', '/')\n      .split('/')\n      .reverse()\n  }\n  try {\n    if (filename && filename.includes('.svelte')) {\n      return (\n        await import(\n          `../exercicesInteractifs/${directory === undefined ? '' : `${directory}/`}${filename.replace('.svelte', '')}.svelte`\n        )\n      ).default\n    }\n  } catch (err) {\n    console.error(\n      `Chargement de l'exercice ${paramsExercice.uuid} impossible. Vrifier  ${directory === undefined ? '' : `${directory}/`}${filename}`,\n    )\n  }\n  throw new Error(\n    `Chargement de l'exercice ${paramsExercice.uuid} impossible. Vrifier ${directory === undefined ? '' : `${directory}/`}${filename}`,\n  )\n}\n\n// Vrification serveur relle\nasync function checkHEAD(\n  url: string,\n): Promise<{ reachable: boolean; status: number | null }> {\n  // 1. Tentative CORS (pour obtenir status si possible)\n  try {\n    const res = await fetch(url, {\n      method: 'HEAD',\n      cache: 'no-cache',\n      mode: 'cors',\n    })\n\n    // Ici, CORS autorise  on a un vrai statut\n    console.log(' CORS OK  vrai statut :', res.status)\n\n    return {\n      reachable: true,\n      status: res.status,\n    }\n  } catch (err) {\n    console.warn(' CORS a bloqu ou autre erreur :', err)\n  }\n\n  // 2. Fallback NO-CORS : dtecter si le serveur rpond (statut inaccessible)\n  try {\n    await fetch(url, {\n      method: 'HEAD',\n      cache: 'no-cache',\n      mode: 'no-cors',\n    })\n\n    // Si on arrive ici  le serveur a rpondu, mais sans CORS\n    console.log(' Serveur rpond (no-cors), statut inaccessible')\n\n    return {\n      reachable: true,\n      status: null, // on ne peut pas savoir\n    }\n  } catch (err) {\n    console.error(' Serveur totalement injoignable :', err)\n\n    return {\n      reachable: false,\n      status: null,\n    }\n  }\n}\n\n/**\n * Charge un exercice depuis son uuid\n * Exemple : const exercice = loadExercice('3cvng')\n * @param {string} url\n * @returns {Promise<Exercice>} exercice\n */\nexport async function mathaleaLoadExerciceFromUuid(uuid: string) {\n  const url = uuidToUrl[uuid as keyof typeof uuidToUrl]\n  let filename, directory, isCan\n  if (url) {\n    ;[filename, directory, isCan] = url\n      .replaceAll('\\\\', '/')\n      .split('/')\n      .reverse()\n  } else {\n    console.error(`UUID introuvable dans uuidToUrl: ${uuid}`)\n    window.notify(`L'exercice n'existe pas avec la rfrence uuid:${uuid}`, {\n      exercicesParams: get(exercicesParams),\n    })\n\n    const exercice = new Exercice()\n    exercice.titre = `L'exercice n'existe pas ou plus avec la rfrence uuid:${uuid}`\n    exercice.nouvelleVersion = () => {}\n    return exercice as IExercice\n  }\n  let attempts = 0\n  const maxAttempts = 3\n  while (attempts < maxAttempts) {\n    let pathToCheck: string = ''\n    try {\n      // Type explicite pour le module import\n      type ExerciceModule = {\n        default: new () => IExercice\n        titre?: string\n        amcReady?: boolean\n        amcType?: string\n        interactifType?: string\n        interactifReady?: boolean\n      }\n\n      let module: ExerciceModule | undefined\n      if (isCan === 'can') {\n        const modules = import.meta.glob('../exercices/can/**/*.{ts,js}')\n        if (filename != null && filename.includes('.ts')) {\n          const path = `../exercices/can/${directory}/${filename.replace('.ts', '')}.ts`\n          pathToCheck = path\n          const loader = modules[path]\n          if (!loader) throw new Error(`Module \"${path}\" introuvable`)\n          module = (await loader()) as ExerciceModule\n        } else if (filename != null) {\n          const path = `../exercices/can/${directory}/${filename.replace('.js', '')}.js`\n          pathToCheck = path\n          const loader = modules[path]\n          if (!loader) throw new Error(`Module \"${path}\" introuvable`)\n          module = (await loader()) as ExerciceModule\n        }\n      } else if (isCan === 'QCMBrevet') {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/QCMBrevet/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/QCMBrevet/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      } else if (isCan === 'QCMBac') {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/QCMBac/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/QCMBac/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      } else {\n        if (filename != null && filename.includes('.ts')) {\n          pathToCheck = `../exercices/${directory}/${filename.replace('.ts', '')}.ts`\n          module = (await import(\n            `../exercices/${directory}/${filename.replace('.ts', '')}.ts`\n          )) as ExerciceModule\n        } else if (filename != null) {\n          pathToCheck = `../exercices/${directory}/${filename.replace('.js', '')}.js`\n          module = (await import(\n            `../exercices/${directory}/${filename.replace('.js', '')}.js`\n          )) as ExerciceModule\n        }\n      }\n\n      if (module === undefined) {\n        throw new Error(`Module not loaded for uuid: ${uuid}`)\n      }\n\n      const ClasseExercice = module.default\n      const exercice = new ClasseExercice()\n\n      // Dfinir explicitement les proprits  copier\n      type OptionalExerciceProps =\n        | 'titre'\n        | 'amcReady'\n        | 'amcType'\n        | 'interactifType'\n        | 'interactifReady'\n\n      const propsToClone: OptionalExerciceProps[] = [\n        'titre',\n        'amcReady',\n        'amcType',\n        'interactifType',\n        'interactifReady',\n      ]\n\n      propsToClone.forEach((prop) => {\n        if (module[prop as keyof ExerciceModule] !== undefined) {\n          // Assertion sre aprs vrification\n          ;(exercice as Record<string, any>)[prop] =\n            module[prop as keyof ExerciceModule]\n        }\n      })\n\n      exercice.id = filename\n      return exercice as IExercice\n    } catch (error) {\n      attempts++\n      const serverUpdated = await checkForServerUpdate()\n      if (serverUpdated) {\n        await showPopupAndWait()\n      }\n      if (pathToCheck !== '') {\n        // ---- Extraction du vrai chemin dans l'erreur ----\n        let url: string = ''\n        if (error instanceof Error && error.message) {\n          // on recupre la vraie requete pour trouver le chunk qui pose problme\n          const match = error.message.match(/https?:\\/\\/[^\\s)]+/)\n          if (match) url = match[0]\n        }\n\n        if (url !== '') {\n          const exists = await checkHEAD(url)\n          // Si exists = false  bingo, cest un problme de disponibilit du chunk.\n          // si exists = true MAIS l'import choue  problme HTTP/2 / compression / LSCache.\n          // Dans les deux cas  infrastructure, pas ton code.\n          window.notify(\n            `Load failed: ${url} (exists on server: ${exists.reachable} status: ${exists.status})`,\n            { error, exists },\n          )\n        }\n      }\n      window.notify(\n        `Un exercice ne s'est pas affich ${attempts} fois: uuid:${uuid} ,filename: ${directory}/${filename}, serverUpdated: ${serverUpdated}`,\n        { error },\n      )\n      if (attempts === maxAttempts) {\n        console.error(\n          `Chargement de l'exercice ${uuid} impossible. Vrifier ${directory}/${filename}`,\n        )\n        console.error(error)\n        const exercice = new Exercice()\n        exercice.titre = ERROR_MESSAGE\n        exercice.nouvelleVersion = () => {}\n        return exercice as IExercice\n      } else {\n        await delay(1000)\n      }\n    }\n  }\n  const exercice = new Exercice()\n  exercice.titre = ERROR_MESSAGE\n  exercice.nouvelleVersion = () => {}\n  return exercice as IExercice\n}\n\n/**\n * Charge tous les exercices et les paramtres\n * en fonction du store exercicesParams.\n */\nexport async function mathaleaGetExercicesFromParams(\n  params: InterfaceParams[],\n): Promise<(IExercice | IExerciceStatique)[]> {\n  const exercices = []\n  for (const param of params) {\n    if (\n      param.uuid.substring(0, 4) === 'crpe' ||\n      param.uuid.substring(0, 4) === 'dnb_' ||\n      param.uuid.startsWith('dnbpro_') ||\n      param.uuid.substring(0, 4) === 'e3c_' ||\n      param.uuid.startsWith('eam_') ||\n      param.uuid.substring(0, 4) === 'bac_' ||\n      param.uuid.startsWith('sti2d_') ||\n      param.uuid.substring(0, 7) === 'evacom_' ||\n      param.uuid.startsWith('2nd_')\n    ) {\n      const infosExerciceStatique =\n        param.uuid.substring(0, 7) === 'evacom_'\n          ? getExerciceByUuid(referentielStaticCH, param.uuid)\n          : getExerciceByUuid(referentielStaticFR, param.uuid)\n\n      // Vrifier que infosExerciceStatique n'est pas null\n      if (!infosExerciceStatique) {\n        throw new Error(\n          `Informations introuvables pour l'exercice statique avec l'UUID : ${param.uuid}`,\n        )\n      }\n\n      let content = ''\n      let contentCorr = ''\n      const sujet = param.uuid.split('_')[0]\n      if (\n        sujet === 'dnb' ||\n        sujet === 'dnbpro' ||\n        sujet === 'bac' ||\n        sujet === 'eam' ||\n        sujet === 'sti2d' ||\n        sujet === 'stl'\n      ) {\n        if ('annee' in infosExerciceStatique) {\n          let response = await window.fetch(\n            `static/${sujet}/${infosExerciceStatique.annee}/tex/${param.uuid}.tex`,\n          )\n          if (response.status === 200) {\n            const text = await response.clone().text()\n            if (!text.trim().startsWith('<!DOCTYPE html>')) {\n              content = text\n            } else {\n              content = '\\n\\n\\t%Exercice non disponible\\n\\n'\n            }\n          }\n          response = await window.fetch(\n            `static/${sujet}/${infosExerciceStatique.annee}/tex/${param.uuid}_cor.tex`,\n          )\n          if (response.status === 200) {\n            const text = await response.clone().text()\n            if (!text.trim().startsWith('<!DOCTYPE html>')) {\n              contentCorr = text\n            } else {\n              contentCorr = '\\n\\n\\t%Pas de correction disponible\\n\\n'\n            }\n          }\n        }\n      } else {\n        if (infosExerciceStatique && 'url' in infosExerciceStatique) {\n          const response = await window.fetch(\n            infosExerciceStatique.url as string,\n          )\n          if (response.status === 200) {\n            const text = await response.clone().text()\n            if (!text.trim().startsWith('<!DOCTYPE html>')) {\n              content = text\n            } else {\n              content = '\\n\\n\\t%Exercice non disponible\\n\\n'\n            }\n          }\n        }\n        if (infosExerciceStatique && 'urlcor' in infosExerciceStatique) {\n          const response = await window.fetch(\n            infosExerciceStatique.urlcor as string,\n          )\n          if (response.status === 200) {\n            const text = await response.clone().text()\n            if (!text.trim().startsWith('<!DOCTYPE html>')) {\n              contentCorr = text\n            } else {\n              contentCorr = '\\n\\n\\t%Pas de correction disponible\\n\\n'\n            }\n          }\n        }\n      }\n      const annee =\n        'annee' in infosExerciceStatique\n          ? infosExerciceStatique.annee\n          : undefined\n      const lieu =\n        'lieu' in infosExerciceStatique ? infosExerciceStatique.lieu : undefined\n      const mois =\n        'mois' in infosExerciceStatique ? infosExerciceStatique.mois : undefined\n      const numeroInitial =\n        'numeroInitial' in infosExerciceStatique\n          ? infosExerciceStatique.numeroInitial\n          : undefined\n      let examen: string = ''\n      if (param.uuid.substring(0, 4) === 'crpe') examen = 'CRPE'\n      if (param.uuid.substring(0, 4) === 'dnb_') examen = 'DNB'\n      if (param.uuid.startsWith('dnbpro_')) examen = 'DNBPRO'\n      if (param.uuid.substring(0, 4) === 'e3c_') examen = 'E3C'\n      if (param.uuid.substring(0, 4) === 'bac_') examen = 'BAC'\n      if (param.uuid.startsWith('sti2d_')) examen = 'STI2D'\n      if (param.uuid.startsWith('stl_')) examen = 'STL'\n      if (param.uuid.substring(0, 7) === 'evacom_') examen = 'EVACOM'\n      exercices.push({\n        typeExercice: 'statique',\n        uuid: param.uuid,\n        content,\n        contentCorr,\n        annee,\n        lieu,\n        mois,\n        numeroInitial,\n        examen,\n      } as IExerciceStatique)\n    } else {\n      const exercice = await mathaleaLoadExerciceFromUuid(param.uuid)\n      if (typeof exercice === 'undefined') continue\n      mathaleaHandleParamOfOneExercice(exercice, param)\n      exercices.push(exercice)\n    }\n  }\n  return exercices\n}\n\n/**\n * Applique les paramtres sauvegards dans un lment de exercicesParams  un exercice.\n */\nexport function mathaleaHandleParamOfOneExercice(\n  exercice: IExercice,\n  param: InterfaceParams,\n) {\n  exercice.uuid = param.uuid\n  if (param.nbQuestions) exercice.nbQuestions = param.nbQuestions\n  exercice.duration = param.duration ?? 10\n  if (param.id) exercice.id = param.id\n  if (param.sup) exercice.sup = mathaleaHandleStringFromUrl(param.sup)\n  if (param.sup2) exercice.sup2 = mathaleaHandleStringFromUrl(param.sup2)\n  if (param.sup3) exercice.sup3 = mathaleaHandleStringFromUrl(param.sup3)\n  if (param.sup4) exercice.sup4 = mathaleaHandleStringFromUrl(param.sup4)\n  if (param.sup5) exercice.sup5 = mathaleaHandleStringFromUrl(param.sup5)\n  if (param.versionQcm !== undefined && exercice instanceof ExerciceSimple)\n    exercice.versionQcm = param.versionQcm === '1'\n  if (param.interactif) exercice.interactif = param.interactif === '1'\n  if (param.alea) exercice.seed = param.alea\n  if (param.cols !== undefined && param.cols > 1) exercice.nbCols = param.cols\n  if (param.cd !== undefined) exercice.correctionDetaillee = param.cd === '1'\n  if (exercice.seed === undefined) {\n    exercice.seed = mathaleaGenerateSeed()\n  }\n}\n\n/**\n * sup, sup2, sup3 et sup4 permettent de sauvegarder les formulaires modifies par\n * les enseignants pour pparamtrer les exercices.\n * Ces paramtres peuvent tre des strings, des boolens ou des number mais que ce soit dans l'url\n * ou dans le store exercicesParams, ils sont sauvegards sous forme de string d'o cette fonction de conversion\n * d'un des trois types vers string.\n */\nexport function mathaleaHandleSup(param: boolean | string | number): string {\n  if (typeof param === 'string') {\n    return param\n  } else if (typeof param === 'number') {\n    return param.toString()\n  } else {\n    // if (typeof param === 'boolean')\n    return param ? 'true' : 'false'\n  }\n}\n\n/**\n * sup, sup2, sup3 et sup4 permettent de sauvegarder les formulaires modifies par\n * les enseignants pour paramtrer les exercices.\n * Ces paramtres peuvent tre des strings, des boolens ou des numbers mais que ce soit dans l'url\n * ou dans le store exercicesParams, ils sont sauvegards sous forme de string d'o cette fonction de conversion\n * du string vers boolen ou number.\n */\nexport function mathaleaHandleStringFromUrl(\n  text: string,\n): boolean | number | string {\n  if (text === 'true' || text === 'false') {\n    // \"true\"=>true\n    return text === 'true'\n  } else if (/^\\d+$/.test(text)) {\n    // \"17\"=>17\n    return parseInt(text)\n  } else {\n    return text\n  }\n}\n\nexport function mathaleaRenderDiv(\n  div: HTMLElement | null,\n  zoom?: number,\n): void {\n  if (!div) return\n  const params = get(globalOptions)\n  zoom = zoom ?? Number(params.z)\n\n  renderKatex(div)\n  renderScratchDiv(div ?? document.body)\n  if (zoom !== -1) {\n    resizeContent(div, zoom)\n  }\n}\n\nexport function renderDiv(HtmlElement: HTMLElement, _content: string) {\n  mathaleaRenderDiv(HtmlElement, -1)\n}\n\nexport function renderKatex(element: HTMLElement) {\n  const options = {\n    delimiters: [\n      { left: '\\\\[', right: '\\\\]', display: true },\n      { left: '$', right: '$', display: false },\n    ],\n    throwOnError: true,\n    errorColor: '#CC0000',\n    strict: 'warn',\n    trust: false,\n  }\n\n  // Ajouter preProcess sans typage strict\n  Object.assign(options, {\n    preProcess: (chaine: string) =>\n      '{' + chaine.replaceAll(String.fromCharCode(160), '\\\\,') + '}',\n  })\n\n  renderMathInElement(element, options as any)\n  document.dispatchEvent(new window.Event('katexRendered'))\n}\n\n/**\n * Modifie l'url courante avec le store exercicesParams ou un tableau similaire\n * sauf si le store freezeUrl est  true (utile sur un site externe)\n */\nexport function mathaleaUpdateUrlFromExercicesParams(\n  params?: InterfaceParams[],\n) {\n  if (get(globalOptions).recorder === 'capytale') {\n    sendToCapytaleMathaleaHasChanged()\n  }\n  if (get(freezeUrl) === true) return\n  if (params === undefined) {\n    params = get(exercicesParams)\n  }\n  const url = createURL(params)\n  updateURLFromReferentielLocale(url)\n  updateGlobalOptionsInURL(url)\n}\n\n/**\n * Analyse l'url courante de la fentre\n * pour mettre  jour exercicesParams\n * avec tous les exercices et les options\n * @returns vue\n */\nexport function mathaleaUpdateExercicesParamsFromUrl(\n  urlString = window.location.href,\n): InterfaceGlobalOptions {\n  const currentRefToUuid = localisedIDToUuid[get(referentielLocale)]\n  let urlNeedToBeFreezed = false\n  let v: VueType | undefined\n  let z = '1'\n  let durationGlobal = 0\n  let ds\n  let nbVues: 1 | 2 | 3 | 4 = 1\n  let flow: 0 | 1 | 2 = 0\n  let screenBetweenSlides\n  let pauseAfterEachQuestion\n  let isImagesOnSides = false\n  let sound: 0 | 1 | 2 | 3 | 4 = 0\n  let shuffle = false\n  let manualMode\n  let select: number[] = []\n  let order: number[] = []\n  let title = ''\n  let iframe = ''\n  let answers = ''\n  let recorder:\n    | 'capytale'\n    | 'moodle'\n    | 'labomep'\n    | 'anki'\n    | 'flowmath'\n    | undefined\n  let done: '1' | undefined\n  let es\n  let presMode:\n    | 'liste_exos'\n    | 'un_exo_par_page'\n    | 'une_question_par_page'\n    | 'recto'\n    | 'verso' = 'liste_exos'\n  let setInteractive = '2'\n  let isSolutionAccessible = true\n  let isInteractiveFree = true\n  let oneShot = false\n  let twoColumns = false\n  let isTitleDisplayed = true\n  let beta = false\n  let url: URL\n  let canDuration = 540\n  let canTitle = ''\n  let canSolAccess = true\n  let canSolMode = 'gathered'\n  let canIsInteractive = true\n  try {\n    url = new URL(urlString)\n  } catch (error) {\n    return {}\n  }\n  // let url = new URL(urlString)\n  if (isCrypted(url)) {\n    urlNeedToBeFreezed = true\n    url = decrypt(url)\n  }\n  const entries = url.searchParams.entries()\n  let indiceExercice = -1\n  const newExercisesParams: InterfaceParams[] = []\n  let previousEntryWasUuid = false\n  try {\n    for (const entry of entries) {\n      if (entry[0] === 'uuid') {\n        indiceExercice++\n        const uuid = entry[1]\n        const id = (\n          Object.keys(currentRefToUuid) as (keyof typeof currentRefToUuid)[]\n        ).find((key) => {\n          return currentRefToUuid[key] === uuid\n        })\n        if (!newExercisesParams[indiceExercice])\n          newExercisesParams[indiceExercice] = { uuid, id }\n        newExercisesParams[indiceExercice].uuid = uuid // string\n        newExercisesParams[indiceExercice].id = id // string\n        newExercisesParams[indiceExercice].interactif = '0' // par dfaut\n      } else if (entry[0] === 'id' && !previousEntryWasUuid) {\n        // En cas de prsence d'un uuid juste avant, on ne tient pas compte de l'id\n        indiceExercice++\n        const id = entry[1]\n        const uuid = currentRefToUuid[id as keyof typeof currentRefToUuid]\n        if (!newExercisesParams[indiceExercice])\n          newExercisesParams[indiceExercice] = { id, uuid }\n      } else if (entry[0] === 'n') {\n        newExercisesParams[indiceExercice].nbQuestions = parseInt(entry[1]) // int\n      } else if (entry[0] === 'd') {\n        newExercisesParams[indiceExercice].duration = parseInt(entry[1]) // int\n      } else if (entry[0] === 's') {\n        newExercisesParams[indiceExercice].sup = entry[1]\n      } else if (entry[0] === 's2') {\n        newExercisesParams[indiceExercice].sup2 = entry[1]\n      } else if (entry[0] === 's3') {\n        newExercisesParams[indiceExercice].sup3 = entry[1]\n      } else if (entry[0] === 's4') {\n        newExercisesParams[indiceExercice].sup4 = entry[1]\n      } else if (entry[0] === 's5') {\n        newExercisesParams[indiceExercice].sup5 = entry[1]\n      } else if (entry[0] === 'qcm' && (entry[1] === '0' || entry[1] === '1')) {\n        newExercisesParams[indiceExercice].versionQcm = entry[1]\n      } else if (entry[0] === 'alea') {\n        newExercisesParams[indiceExercice].alea = entry[1]\n      } else if (entry[0] === 'cols') {\n        newExercisesParams[indiceExercice].cols = parseInt(entry[1])\n      } else if (entry[0] === 'i' && (entry[1] === '0' || entry[1] === '1')) {\n        newExercisesParams[indiceExercice].interactif = entry[1]\n      } else if (entry[0] === 'cd' && (entry[1] === '0' || entry[1] === '1')) {\n        newExercisesParams[indiceExercice].cd = entry[1]\n      } else if (entry[0] === 'v') {\n        v = convertVueType(entry[1])\n      } else if (entry[0] === 'recorder') {\n        if (\n          entry[1] === 'capytale' ||\n          entry[1] === 'moodle' ||\n          entry[1] === 'labomep' ||\n          entry[1] === 'anki' ||\n          entry[1] === 'flowmath'\n        ) {\n          recorder = entry[1]\n        }\n      } else if (entry[0] === 'done' && entry[1] === '1') {\n        done = '1'\n      } else if (entry[0] === 'z') {\n        z = entry[1]\n      } else if (entry[0] === 'dGlobal') {\n        durationGlobal = parseInt(entry[1])\n      } else if (entry[0] === 'shuffle') {\n        shuffle = true\n      } else if (entry[0] === 'select') {\n        select = entry[1].split('-').map((e) => parseInt(e))\n      } else if (entry[0] === 'order') {\n        order = entry[1].split('-').map((e) => parseInt(e))\n      } else if (entry[0] === 'ds') {\n        ds = entry[1]\n      } else if (entry[0] === 'es') {\n        es = entry[1]\n      } else if (entry[0] === 'title') {\n        title = decodeURIComponent(entry[1])\n      } else if (entry[0] === 'iframe') {\n        iframe = entry[1]\n      } else if (entry[0] === 'answers') {\n        answers = entry[1]\n      } else if (entry[0] === 'beta') {\n        beta = true\n      } else if (entry[0] === 'canD') {\n        canDuration = parseInt(entry[1])\n      } else if (entry[0] === 'canT') {\n        canTitle = entry[1]\n      } else if (entry[0] === 'canSA') {\n        canSolAccess = entry[1] === '1'\n      } else if (entry[0] === 'canSM') {\n        canSolMode = entry[1]\n      } else if (entry[0] === 'canI') {\n        canIsInteractive = entry[1] === '1'\n      }\n\n      if (entry[0] === 'uuid') previousEntryWasUuid = true\n      else previousEntryWasUuid = false\n    }\n  } catch (error) {\n    // MOUCHARD SUR LES URLS FANTAISISTES\n    window.notify(`Erreur d'URL : ${error} `, {\n      err: error,\n      urlString,\n      url: window.location.href.toString(),\n      referrer: document.referrer,\n    })\n    console.error(error)\n    showDialogForLimitedTime(\n      'notifUrlIncorrecte',\n      5000,\n      \"L'URL prsente une erreur. Veuillez ressayer et nous contacter si le problme persiste.\",\n    )\n    return {}\n  }\n\n  const newExercisesParamsFiltered = newExercisesParams.filter(\n    (e) => e.uuid || e.id,\n  )\n\n  if (\n    JSON.stringify(get(exercicesParams)) !==\n    JSON.stringify(newExercisesParamsFiltered)\n  ) {\n    exercicesParams.set(newExercisesParamsFiltered)\n  }\n\n  if (urlNeedToBeFreezed) {\n    freezeUrl.set(true)\n  }\n\n  if (v === 'can' || get(globalOptions).recorder === 'capytale') {\n    canOptions.update((e) => {\n      e.durationInMinutes = canDuration\n      e.isInteractive = canIsInteractive\n      e.solutionsAccess = canSolAccess\n      if (canSolMode === 'gathered') e.solutionsMode = 'gathered'\n      else e.solutionsMode = 'split'\n      e.subTitle = canTitle\n      return e\n    })\n  }\n\n  if (ds) {\n    const nbVuesCandidate = contraindreValeur(1, 4, ds.charAt(0), 1)\n    const flowCandidate = contraindreValeur(0, 2, ds.charAt(1), 0)\n    const soundCandidate = contraindreValeur(0, 4, ds.charAt(3), 0)\n    if (isIntegerInRange1to4(nbVuesCandidate)) nbVues = nbVuesCandidate\n    if (isIntegerInRange0to2(flowCandidate)) flow = flowCandidate\n    if (isIntegerInRange0to4(soundCandidate)) sound = soundCandidate\n    screenBetweenSlides = ds.charAt(2) === '1'\n    shuffle = ds.charAt(4) === '1'\n    manualMode = ds.charAt(5) === '1'\n    pauseAfterEachQuestion = ds.charAt(6) === '1'\n    isImagesOnSides = ds.charAt(7) === '1'\n  }\n\n  /**\n   * es permet de rsumer les rglages de la vue lve\n   * Il est de la forme 210110\n   * Avec un caractre par rglage presMode|setInteractive|isSolutionAccessible|isInteractiveFree|oneShot|twoColumns|isTitleDisplayed\n   */\n  if (es && es.length === 6) {\n    presMode = presModeId[parseInt(es.charAt(0))]\n    setInteractive = es.charAt(1)\n    isSolutionAccessible = es.charAt(2) === '1'\n    isInteractiveFree = es.charAt(3) === '1'\n    oneShot = es.charAt(4) === '1'\n    twoColumns = es.charAt(5) === '1'\n  } else if (es && es.length === 7) {\n    presMode = presModeId[parseInt(es.charAt(0))]\n    setInteractive = es.charAt(1)\n    isSolutionAccessible = es.charAt(2) === '1'\n    isInteractiveFree = es.charAt(3) === '1'\n    oneShot = es.charAt(4) === '1'\n    twoColumns = es.charAt(5) === '1'\n    isTitleDisplayed = es.charAt(6) === '1'\n  }\n  v = v ?? ''\n  return {\n    v,\n    z,\n    durationGlobal,\n    ds,\n    nbVues,\n    flow,\n    screenBetweenSlides,\n    pauseAfterEachQuestion,\n    isImagesOnSides,\n    sound,\n    shuffle,\n    manualMode,\n    select,\n    order,\n    title,\n    presMode,\n    setInteractive,\n    isSolutionAccessible,\n    isInteractiveFree,\n    oneShot,\n    twoColumns,\n    isTitleDisplayed,\n    recorder,\n    done,\n    beta,\n    iframe,\n    answers,\n  }\n}\n\n/**\n * Les exercice qui ont le paramtre typeExercice gale  'simple'\n * ne dfinissent qu'une seule question.\n * Avec cette fonction, on permet la cration de plusieurs questions.\n */\nexport function mathaleaHandleExerciceSimple(\n  exercice: IExercice,\n  isInteractif: boolean,\n  numeroExercice?: number,\n) {\n  if (numeroExercice !== undefined) exercice.numeroExercice = numeroExercice\n  exercice.reinit()\n  exercice.interactif = isInteractif\n  for (\n    let i = 0, cptSecours = 0;\n    i < exercice.nbQuestions && cptSecours < 50;\n  ) {\n    seedrandom(String(exercice.seed) + i + cptSecours, { global: true })\n    if (\n      exercice.nouvelleVersion &&\n      typeof exercice.nouvelleVersion === 'function'\n    )\n      exercice.nouvelleVersion(numeroExercice)\n    const compare =\n      exercice.compare == null ? fonctionComparaison : exercice.compare\n    const options =\n      exercice.optionsDeComparaison == null ? {} : exercice.optionsDeComparaison\n\n    if (exercice.questionJamaisPosee(i, String(exercice.correction))) {\n      if (exercice.reponse != null) {\n        if (compare != null) {\n          /// DE LA AU PROCHAIN LA, ce sera  supprimer quand il n'y aura plus de this.compare\n          let reponse = {}\n          if (\n            typeof exercice.reponse !== 'string' &&\n            typeof exercice.reponse !== 'number'\n          ) {\n            if (exercice.reponse instanceof FractionEtendue) {\n              reponse = {\n                reponse: {\n                  value: exercice.reponse.texFraction,\n                  compare,\n                  options,\n                },\n              }\n            } else if (exercice.reponse instanceof Decimal) {\n              reponse = {\n                reponse: {\n                  value: exercice.reponse.toString(),\n                  compare,\n                  options,\n                },\n              }\n            } else if (\n              exercice.reponse instanceof Grandeur ||\n              exercice.reponse instanceof Hms\n            ) {\n              reponse = {\n                reponse: { value: exercice.reponse, compare, options },\n              }\n            } else if (\n              typeof exercice.reponse === 'object' &&\n              !Array.isArray(exercice.reponse)\n            ) {\n              // Si c'est handleAnswer qu'on veut utiliser directement avec un fillInTheBlank par exemple, on met l'objet reponse complet dans this.reponse\n              reponse = exercice.reponse\n            } else if (Array.isArray(exercice.reponse)) {\n              reponse = {\n                reponse: { value: exercice.reponse, compare, options },\n              }\n            } else {\n              window.notify(\n                `MathaleaHandleExerciceSimple n'a pas russi  dterminer le type de exercice.reponse, dans ${(exercice?.numeroExercice ?? 0) + 1} - ${exercice.titre} ${JSON.stringify(exercice.reponse)}, on Stingifie, mais c'est sans doute une erreur  rectifier`,\n                { exercice: JSON.stringify(exercice) },\n              )\n              reponse = {\n                reponse: { value: String(exercice.reponse), compare, options },\n              }\n            }\n          } else {\n            reponse = {\n              reponse: {\n                value:\n                  typeof exercice.reponse === 'number'\n                    ? String(exercice.reponse)\n                    : exercice.reponse,\n                compare,\n                options,\n              },\n            }\n          }\n          handleAnswers(exercice, i, reponse, {\n            formatInteractif: exercice.formatInteractif ?? 'mathlive',\n          }) /// // PROCHAIN LA : La partie ci-dessus sera  supprimer quand il n'y aura plus de this.compare\n        } else if (\n          isValeur(exercice.reponse) &&\n          exercice.reponse.reponse != null &&\n          exercice.reponse.reponse.value != null &&\n          typeof exercice.reponse.reponse.value === 'string'\n        ) {\n          handleAnswers(exercice, i, exercice.reponse)\n        } else {\n          setReponse(exercice, i, String(exercice.reponse), {\n            formatInteractif: exercice.formatInteractif ?? 'calcul',\n          })\n        }\n      } else {\n        if (exercice.formatInteractif !== 'qcm')\n          window.notify(\n            \"Un exercice simple doit avoir un this.reponse sauf si c'est un qcm\",\n            { exercice: JSON.stringify(exercice) },\n          )\n      }\n      if (exercice.formatInteractif !== 'fillInTheBlank') {\n        if (\n          exercice.formatInteractif === 'qcm' ||\n          (exercice instanceof ExerciceSimple &&\n            exercice.distracteurs.length > 0 &&\n            exercice.versionQcm)\n        ) {\n          if (\n            exercice instanceof ExerciceSimple &&\n            exercice.distracteurs.length > 0\n          ) {\n            exercice.distracteurs = getDistracteurs(exercice)\n            if (\n              typeof exercice.reponse === 'string' ||\n              typeof exercice.reponse === 'number' ||\n              exercice.reponse instanceof FractionEtendue ||\n              exercice.reponse instanceof Grandeur ||\n              exercice.reponse instanceof Hms ||\n              (Array.isArray(exercice.reponse) &&\n                exercice.reponse.every(\n                  (r) =>\n                    typeof r === 'string' ||\n                    typeof r === 'number' ||\n                    r instanceof FractionEtendue ||\n                    r instanceof Grandeur ||\n                    r instanceof Hms,\n                ))\n            ) {\n              exercice.autoCorrection[i] = {\n                options: exercice.versionQcmOptions ?? { radio: true },\n                enonce: exercice.question,\n                propositions: [\n                  {\n                    texte: formaterReponse(exercice.reponse ?? ''),\n                    statut: true,\n                  },\n                  ...exercice.distracteurs.map((distracteur) => ({\n                    texte: formaterReponse(distracteur),\n                    statut: false,\n                  })),\n                ],\n              }\n            }\n            const qcm = propositionsQcm(exercice, i, {\n              style: 'margin:0 3px 0 3px;',\n              format: exercice.interactif ? 'case' : 'lettre',\n            })\n            exercice.question += qcm.texte\n          }\n          exercice.listeQuestions.push(exercice.question || '')\n        } else if (exercice.formatInteractif === 'listeDeroulante') {\n          const n = exercice.numeroExercice\n          exercice.question = exercice.question?.replace(\n            `id=\"ex${n}Q0\"`,\n            `id=\"ex${n}Q${i}\"`,\n          )\n          exercice.question = exercice.question?.replace(\n            `checkEx${n}Q0\"`,\n            `checkEx${n}Q${i}\"`,\n          )\n          exercice.listeQuestions.push(exercice.question ?? '')\n        } else if (exercice.formatInteractif === 'MetaInteractif2d') {\n          const n = exercice.numeroExercice\n          if (exercice.question != null) {\n            const inputsIds = exercice.question.matchAll(\n              /id=\"MetaInteractif2dEx\\d+Q\\d+field(\\d+)\"/g,\n            )\n            for (const match of inputsIds) {\n              exercice.question = exercice.question.replace(\n                `id=\"MetaInteractif2dEx${n}Q0field${match[1]}\"`,\n                `id=\"MetaInteractif2dEx${n}Q${i}field${match[1]}\"`,\n              )\n            }\n            exercice.question = exercice.question.replace(\n              `id=\"resultatCheckEx${n}Q0\"`,\n              `id=\"resultatCheckEx${n}Q${i}\"`,\n            )\n            exercice.question = exercice.question.replace(\n              `id=\"feedbackEx${n}Q0\"`,\n              `id=\"feedbackEx${n}Q${i}\"`,\n            )\n            exercice.listeQuestions.push(exercice.question ?? '')\n          }\n        } else {\n          exercice.listeQuestions.push(\n            exercice.question +\n              ajouteChampTexteMathLive(\n                exercice,\n                i,\n                String(exercice.formatChampTexte),\n                exercice.optionsChampTexte || {},\n              ),\n          )\n        }\n      } else {\n        // La question doit contenir une unique variable %{champ1} On est en fillInTheBlank\n        // Ou bien, on fait appel  un callback\n        exercice.listeQuestions.push(\n          remplisLesBlancs(\n            exercice,\n            i,\n            String(exercice.question),\n            'fillInTheBlank ' + exercice.formatChampTexte,\n            '\\\\ldots',\n          ),\n        )\n        if (\n          typeof exercice.reponse === 'object' &&\n          'callback' in exercice.reponse\n        ) {\n          // Cas d'un callback dans un exercice simple\n          handleAnswers(exercice, i, exercice.reponse)\n        } else if (\n          typeof exercice.reponse === 'object' &&\n          'champ1' in exercice.reponse\n        ) {\n          handleAnswers(exercice, i, exercice.reponse as Valeur, {\n            formatInteractif: 'fillInTheBlank',\n          })\n        } else {\n          if (\n            typeof exercice.reponse === 'string' ||\n            typeof exercice.reponse === 'number'\n          ) {\n            handleAnswers(\n              exercice,\n              i,\n              { champ1: { value: exercice.reponse ?? '' } },\n              { formatInteractif: 'fillInTheBlank' },\n            )\n          }\n        }\n      }\n      exercice.listeCorrections.push(exercice.correction ?? '')\n      exercice.listeCanEnonces?.push(exercice.canEnonce ?? '')\n      exercice.listeCanReponsesACompleter?.push(\n        exercice.canReponseACompleter ?? '',\n      )\n      exercice.listeCanLiees?.push(exercice.canLiee ?? '')\n      exercice.listeCanNumerosLies?.push(exercice.canNumeroLie ?? '')\n\n      cptSecours = 0\n      i++\n    } else {\n      cptSecours++\n    }\n  }\n}\n\nexport function getDistracteurs(\n  exerciceSimple: ExerciceSimple,\n): (string | number)[] {\n  const distracteursUniques = [...new Set(exerciceSimple.distracteurs)]\n  const distracteursNonSolutions = distracteursUniques.filter((distracteur) => {\n    const reponse: AnswerValueType | Valeur | undefined = exerciceSimple.reponse\n    if (reponse == null) {\n      return true // Si pas de rponse, on garde tous les distracteurs\n    }\n    let value: AnswerValueType | undefined\n    if (isAnswerValueType(reponse)) {\n      value = reponse\n    } else {\n      // Si reponse n'est pas un AnswerValueType, alors c'est un Valeur dont on va rcuprer le AnswerValueType\n      const reponseReponse = reponse.reponse\n      if (reponseReponse !== undefined) value = reponseReponse.value\n    }\n    if (value === undefined) {\n      // Si pas de valeur, on garde tous les distracteurs\n      return true\n    }\n    if (Array.isArray(value)) {\n      return !value.some((v) => {\n        if (v instanceof FractionEtendue) {\n          return v.texFraction !== distracteur.toString()\n        }\n        return distracteur.toString() !== v.toString()\n      })\n    }\n    if (value instanceof FractionEtendue) {\n      return value.texFraction !== distracteur.toString()\n    }\n    return distracteur.toString() !== value.toString()\n  })\n  return shuffle(distracteursNonSolutions).slice(0, 3)\n}\n\n/**\n * Gnre un string de 4 caractres qui sera utilis comme seed pour l'alatoire\n */\nexport function mathaleaGenerateSeed({\n  includeUpperCase = true,\n  includeNumbers = true,\n  length = 4,\n  startsWithLowerCase = false,\n}: {\n  includeUpperCase?: boolean\n  includeNumbers?: boolean\n  length?: number\n  startsWithLowerCase?: boolean\n} = {}) {\n  let a = 10\n  const b = 'abcdefghijklmnopqrstuvwxyz'\n  let c = ''\n  let d = 0\n  let e = '' + b\n  if (startsWithLowerCase) {\n    c = b[Math.floor(Math.random() * b.length)]\n    d = 1\n  }\n  if (length) {\n    a = length\n  }\n  if (includeUpperCase) {\n    e += b.toUpperCase()\n  }\n  if (includeNumbers) {\n    e += '1234567890'\n  }\n\n  for (; d < a; d++) {\n    c += e[Math.floor(Math.random() * e.length)]\n  }\n  return c\n}\n\n/**\n * Pour la sortie HTML, il faut modifier certains codages LaTeX non pris en charge par KaTeX\n * @param {string} texte\n * @returns string\n */\n// Define the function with the condition check\nexport function mathaleaFormatExercice(texte = ' ') {\n  const lang = getLang()\n  // Replace symbols based on general rules\n  let formattedText = texte\n    .replace(/\\\\dotfill/g, '..............................')\n    .replace(/\\\\not=/g, '')\n    .replace(/\\\\ldots/g, '....')\n    .replaceAll(' ?', '&nbsp;?')\n    .replaceAll(' !', '&nbsp;!')\n    .replaceAll(' ;', '&nbsp;;')\n    .replaceAll(' :', '&nbsp;:')\n\n  // Check if the language is 'fr-CH' and replace \\times with \\cdot if true\n  if (lang === 'fr-CH') {\n    formattedText = formattedText.replace(/\\\\times/g, '\\\\cdot')\n    formattedText = formattedText.replace(/un antcdent/g, 'une primage')\n    formattedText = formattedText.replace(/l'antcdent/g, 'la primage')\n    formattedText = formattedText.replace(/des antcdents/g, 'des primages')\n    formattedText = formattedText.replace(/les antcdents/g, 'les primages')\n    formattedText = formattedText.replace(/pour antcdents/g, 'pour primages')\n    formattedText = formattedText.replace(/pour antcdent/g, 'pour primage')\n    formattedText = formattedText.replace(/d'antcdent/g, 'de primage')\n    formattedText = formattedText.replace(/antcdent/g, 'primage')\n    formattedText = formattedText.replace(\n      /s'il existe et en l'expliquant, le coefficient directeur/g,\n      'si elle existe, la pente',\n    )\n    formattedText = formattedText.replace(\n      /le coefficient directeur/g,\n      'la pente',\n    )\n    formattedText = formattedText.replace(\n      /coefficients directeurs/g,\n      'les pentes',\n    )\n    formattedText = formattedText.replace(\n      /coefficient directeur respectif/g,\n      'pente respective',\n    )\n    formattedText = formattedText.replace(\n      /le mme coefficient directeur/g,\n      'la mme pente',\n    )\n    formattedText = formattedText.replace(\n      /aucun coefficient directeur/g,\n      'aucune pente',\n    )\n    formattedText = formattedText.replace(/coefficient directeur/g, 'pente')\n  }\n\n  return formattedText\n}\n\nexport async function getExercisesFromExercicesParams() {\n  const exercises = []\n  for (const paramsExercice of get(exercicesParams)) {\n    if (isStatic(paramsExercice.uuid) || isSvelte(paramsExercice.uuid)) {\n      continue\n    }\n    const exercise = await mathaleaLoadExerciceFromUuid(paramsExercice.uuid)\n    if (!exercise) continue\n    mathaleaHandleParamOfOneExercice(exercise, paramsExercice)\n    exercise.duration = paramsExercice.duration ?? 10\n    exercises.push(exercise)\n  }\n  return exercises\n}\n","import { writable } from 'svelte/store'\n\nexport type VendorEntity = {\n  name: string\n  logoPath: string\n}\nexport type Vendor = {\n  brand: VendorEntity\n  product: VendorEntity\n}\n\nexport const vendor = writable<Vendor>({\n  brand: {\n    name: 'bordas',\n    logoPath: '',\n  },\n  product: {\n    name: 'indices',\n    logoPath: 'assets/images/vendors/bordas/indicesbordas-logo.png',\n  },\n})\n","import Decimal from 'decimal.js'\nimport { fonctionComparaison } from '../lib/interactif/comparisonFunctions'\nimport { handleAnswers } from '../lib/interactif/gestionInteractif'\nimport { propositionsQcm } from '../lib/interactif/qcm'\nimport {\n  ajouteChampTexteMathLive,\n  remplisLesBlancs,\n} from '../lib/interactif/questionMathLive'\nimport { combinaisonListes, shuffle } from '../lib/outils/arrayOutils'\nimport { range1 } from '../lib/outils/nombres'\nimport type { OptionsComparaisonType, Valeur } from '../lib/types'\nimport FractionEtendue from '../modules/FractionEtendue'\nimport Grandeur from '../modules/Grandeur'\nimport { gestionnaireFormulaireTexte } from '../modules/outils'\nimport Exercice from './Exercice'\n\nexport const interactifType = 'mathLive'\nexport const interactifReady = true\n\nexport default class MetaExercice extends Exercice {\n  Exercices: (typeof Exercice)[]\n  correctionInteractives: ((i: number) => string | string[])[]\n  constructor(ExercicesCAN: (typeof Exercice)[]) {\n    super()\n    this.Exercices = ExercicesCAN\n    this.correctionInteractives = []\n    this.besoinFormulaireCaseACocher = ['Sujet officiel']\n    this.nbQuestions = this.Exercices.length\n    this.sup = false\n    this.sup2 = Array.from({ length: this.nbQuestions }, (_, i) => i + 1).join(\n      '-',\n    ) // Toutes les questions de 1  30 (ou 20 pour les CE)\n    this.sup3 = false\n  }\n\n  nouvelleVersion(): void {\n    this.correctionInteractives = []\n    this.listeCanEnonces = []\n    this.listeCanReponsesACompleter = []\n    this.listeCanLiees = []\n    this.listeCanNumerosLies = []\n    this.answers = {}\n    this.nbQuestionsModifiable = this.sup3\n    this.besoinFormulaire2Texte = false\n    let listeTypeDeQuestions: (string | number)[]\n    const listeDeQuestions = this.sup2\n    let exercicesRef = this.Exercices\n    const nbTotalQuestions = exercicesRef.length\n    if (this.sup3) {\n      this.sup2 = false\n    } else {\n      exercicesRef = this.Exercices\n      this.nbQuestions = String(this.sup2).includes('-')\n        ? this.sup2.split('-').length\n        : 1\n    }\n\n    if (this.sup2) {\n      listeTypeDeQuestions = gestionnaireFormulaireTexte({\n        saisie: listeDeQuestions,\n        min: 1,\n        max: 30,\n        defaut: 1,\n        melange: 31,\n        shuffle: false,\n        nbQuestions: String(this.sup2).includes('-')\n          ? this.sup2.split('-').length\n          : 1,\n      })\n    } else {\n      listeTypeDeQuestions = range1(this.nbQuestions)\n      exercicesRef = this.Exercices\n\n      const base = Math.floor(this.nbQuestions / 3)\n      const reste = this.nbQuestions % 3\n      let repartition = [base, base, base]\n      for (let i = 0; i < reste; i++) {\n        repartition[i]++\n      }\n      repartition = combinaisonListes(repartition, 3)\n\n      let exercices1 = exercicesRef.slice(\n        0,\n        Math.floor(Math.max(nbTotalQuestions / 3, repartition[0])),\n      )\n      exercices1 = shuffle(exercices1)\n      exercices1 = exercices1.slice(0, repartition[0])\n\n      let exercices2 = exercicesRef.slice(\n        Math.max(nbTotalQuestions / 3, repartition[0]),\n        Math.max((2 * nbTotalQuestions) / 3, repartition[0] + repartition[1]),\n      )\n      exercices2 = shuffle(exercices2)\n      exercices2 = exercices2.slice(0, repartition[1])\n\n      let exercices3 = exercicesRef.slice(\n        Math.max((2 * nbTotalQuestions) / 3, repartition[0] + repartition[1]),\n        nbTotalQuestions,\n      )\n      exercices3 = shuffle(exercices3)\n      exercices3 = exercices3.slice(0, repartition[2])\n\n      exercicesRef = [...exercices1, ...exercices2, ...exercices3]\n    }\n    let indexQuestion = 0\n    this.reinit() // On rinitialise les listes de questions parce qu'on a eu des soucis (est-ce que MetaExercice passe par le nouvelleVersionWrapper ?)\n\n    for (const item of listeTypeDeQuestions) {\n      // Pour les questions soient dans l'ordre choisi par l'utilisateur\n      let numExo = 1\n      for (const UnExercice of exercicesRef) {\n        if (item === numExo) {\n          // Permet de ne choisir que certaines questions\n          const Question = new UnExercice()\n          Question.numeroExercice = this.numeroExercice\n          Question.canOfficielle = !!this.sup\n          Question.interactif = this.interactif\n          Question.seed = this.seed\n          Question.nouvelleVersionWrapper()\n          //* ************ Question Exo simple *************//\n          if (Question.listeQuestions.length === 0) {\n            // On est en prsence d'un exo simple\n            const consigne =\n              Question.consigne === '' ? '' : `${Question.consigne}<br>`\n            this.listeCorrections[indexQuestion] = Question.correction ?? ''\n            const formatChampTexte = String(Question.formatChampTexte ?? '')\n            const optionsChampTexte = Question.optionsChampTexte ?? {}\n            if (Question.canEnonce != null)\n              this.listeCanEnonces[indexQuestion] = Question.canEnonce\n            if (Question.canReponseACompleter != null)\n              this.listeCanReponsesACompleter[indexQuestion] =\n                Question.canReponseACompleter\n            this.listeCanLiees[indexQuestion] = Question.canLiee\n            this.listeCanNumerosLies[indexQuestion] = Question.canNumeroLie\n\n            if (\n              Question.formatInteractif === 'fillInTheBlank' ||\n              (typeof Question.reponse === 'object' &&\n                'champ1' in Question.reponse)\n            ) {\n              this.listeQuestions[indexQuestion] =\n                consigne +\n                remplisLesBlancs(\n                  this,\n                  indexQuestion,\n                  String(Question.question),\n                  formatChampTexte,\n                  '\\\\ldots',\n                )\n              if (typeof Question.reponse === 'string') {\n                handleAnswers(this, indexQuestion, {\n                  champ1: {\n                    value: Question.reponse,\n                    compare: Question.compare ?? fonctionComparaison,\n                    options: optionsChampTexte,\n                  },\n                })\n              } else if (typeof Question.reponse !== 'object') {\n                throw new Error(\n                  `Erreur avec cette question de type fillInTheBlank qui contient une reponse au format inconnu: ${JSON.stringify(Question.reponse)}`,\n                )\n              } else {\n                handleAnswers(this, indexQuestion, Question.reponse as Valeur)\n              }\n            } else if (Question.formatInteractif === 'qcm') {\n              Question?.question?.replaceAll(\n                'labelEx0Q0',\n                `labelEx0Q${indexQuestion}`,\n              )\n              Question?.question?.replaceAll(\n                'resultatCheckEx0',\n                `resultatCheckEx${indexQuestion}`,\n              )\n              this.listeQuestions[indexQuestion] = consigne + Question.question\n              this.autoCorrection[indexQuestion] = Question.autoCorrection[0]\n            } else if (Question.formatInteractif === 'MetaInteractif2d') {\n              const n = Question.numeroExercice\n              if (Question.question != null) {\n                const inputsIds = Question.question.matchAll(\n                  /id=\"MetaInteractif2dEx\\d+Q\\d+field(\\d+)\"/g,\n                )\n                for (const match of inputsIds) {\n                  Question.question = Question.question.replace(\n                    `id=\"MetaInteractif2dEx${n}Q0field${match[1]}\"`,\n                    `id=\"MetaInteractif2dEx${n}Q${indexQuestion}field${match[1]}\"`,\n                  )\n                }\n                Question.question = Question.question.replace(\n                  `id=\"resultatCheckEx${n}Q0\"`,\n                  `id=\"resultatCheckEx${n}Q${indexQuestion}\"`,\n                )\n                Question.question = Question.question.replace(\n                  `id=\"feedbackEx${n}Q0\"`,\n                  `id=\"feedbackEx${n}Q${indexQuestion}\"`,\n                )\n                Question.listeQuestions.push(Question.question ?? '')\n              }\n              handleAnswers(this, indexQuestion, Question.reponse as Valeur, {\n                formatInteractif: 'MetaInteractif2d',\n              })\n              this.listeQuestions[indexQuestion] = consigne + Question.question\n            } else {\n              // * ***************** Question MathLive *****************//\n              if (Question.compare == null) {\n                const reponse = Question.reponse as Valeur\n                const options =\n                  Question.optionsDeComparaison == null\n                    ? {}\n                    : (Question.optionsDeComparaison as OptionsComparaisonType)\n                if (reponse instanceof FractionEtendue) {\n                  handleAnswers(this, indexQuestion, {\n                    reponse: {\n                      value: reponse.texFraction,\n                      options,\n                    },\n                  })\n                } else if (reponse instanceof Decimal) {\n                  handleAnswers(this, indexQuestion, {\n                    reponse: { value: reponse.toString(), options },\n                  })\n                } else if (reponse instanceof Grandeur) {\n                  handleAnswers(this, indexQuestion, {\n                    reponse: { value: reponse.toString(), options },\n                  })\n                } else if (Array.isArray(reponse)) {\n                  handleAnswers(this, indexQuestion, {\n                    reponse: { value: reponse, options },\n                  })\n                } else if (\n                  reponse != null &&\n                  reponse.reponse instanceof Object &&\n                  reponse.reponse.value != null &&\n                  typeof reponse.reponse.value === 'string'\n                ) {\n                  handleAnswers(\n                    this,\n                    indexQuestion,\n                    Object.assign(reponse, { options }),\n                  )\n                } else {\n                  handleAnswers(this, indexQuestion, {\n                    reponse: { value: String(Question.reponse), options },\n                  })\n                }\n              } else {\n                const compare = Question.compare\n                const options =\n                  Question.optionsDeComparaison == null\n                    ? {}\n                    : Question.optionsDeComparaison\n                if (\n                  typeof Question.reponse === 'string' ||\n                  typeof Question.reponse === 'number'\n                ) {\n                  const reponse = String(Question.reponse)\n                  handleAnswers(this, indexQuestion, {\n                    reponse: {\n                      value: reponse,\n                      compare,\n                      options,\n                    },\n                  })\n                } else if (typeof Question.reponse === 'object') {\n                  const reponse = Question.reponse\n                  if (reponse instanceof FractionEtendue) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: {\n                        value: reponse.texFraction,\n                        compare,\n                        options,\n                      },\n                    })\n                  } else if (reponse instanceof Decimal) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: {\n                        value: reponse.toString(),\n                        compare,\n                        options,\n                      },\n                    })\n                  } else if (reponse instanceof Grandeur) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: { value: reponse.toString(), compare, options },\n                    })\n                  } else if (Array.isArray(reponse)) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: { value: reponse, compare, options },\n                    })\n                  } else {\n                    handleAnswers(\n                      this,\n                      indexQuestion,\n                      Object.assign(reponse as Valeur, { compare, options }),\n                    )\n                  }\n                } else {\n                  window.notify(\n                    'Erreur avec cette question qui contient une reponse au format inconnu',\n                    { reponse: Question.reponse },\n                  )\n                }\n              }\n              this.listeQuestions[indexQuestion] =\n                consigne +\n                Question.question +\n                ajouteChampTexteMathLive(\n                  this,\n                  indexQuestion,\n                  formatChampTexte,\n                  optionsChampTexte,\n                )\n            }\n          } else {\n            //* ***************** Question Exo classique *****************//\n            this.listeQuestions[indexQuestion] = Question.listeQuestions[0]\n            this.listeCorrections[indexQuestion] = Question.listeCorrections[0]\n            this.autoCorrection[indexQuestion] = Question.autoCorrection[0]\n\n            this.listeQuestions[indexQuestion] = this.listeQuestions[\n              indexQuestion\n            ].replaceAll('champTexteEx0Q0', `champTexteEx0Q${indexQuestion}`)\n            this.listeQuestions[indexQuestion] = this.listeQuestions[\n              indexQuestion\n            ].replaceAll(\n              'resultatCheckEx0Q0',\n              `resultatCheckEx0Q${indexQuestion}`,\n            )\n            this.listeQuestions[indexQuestion] = this.listeQuestions[\n              indexQuestion\n            ].replaceAll('clockEx0Q0', `clockEx0Q${indexQuestion}`)\n\n            // fin d'alimentation des listes de question et de correction pour cette question\n            const formatInteractif =\n              Question.autoCorrection[0]?.reponse?.param?.formatInteractif\n            if (formatInteractif === 'custom') {\n              Question.reinit()\n              Question.nouvelleVersionWrapper(\n                this.numeroExercice,\n                indexQuestion,\n              )\n              const that = this\n              this.correctionInteractives[indexQuestion] = function (\n                i: number,\n              ) {\n                const result = Question.correctionInteractive!(i)\n                if (Question.answers) {\n                  that.answers = { ...that.answers, ...Question.answers }\n                }\n                return result\n              }\n              this.autoCorrection[indexQuestion] =\n                Question.autoCorrection[indexQuestion]\n              this.listeQuestions[indexQuestion] =\n                Question.listeQuestions[indexQuestion]\n              this.listeCorrections[indexQuestion] =\n                Question.listeCorrections[indexQuestion]\n            } else if (formatInteractif === 'qcm') {\n              this.autoCorrection[indexQuestion] = Question.autoCorrection[0]\n            } else {\n              const reponse = Question.autoCorrection[0]?.reponse\n              if (reponse != null)\n                handleAnswers(this, indexQuestion, reponse as Valeur)\n            }\n          }\n          if (Question?.autoCorrection[0]?.propositions != null) {\n            // qcm\n            const monQcm = propositionsQcm(this, indexQuestion) // update les rfrences HTML\n            this.listeCanReponsesACompleter[indexQuestion] =\n              Question.canReponseACompleter != null\n                ? Question.canReponseACompleter\n                : monQcm.texte\n            const consigne =\n              Question.consigne === null || Question.consigne === ''\n                ? ''\n                : `${Question.consigne}<br>`\n            const objetReponse = this.autoCorrection[indexQuestion]\n            const enonce = 'enonce' in objetReponse ? objetReponse.enonce : ''\n            this.listeQuestions[indexQuestion] =\n              consigne + enonce + monQcm.texte\n            if (this.listeCorrections[indexQuestion] == null)\n              this.listeCorrections[indexQuestion] = monQcm.texteCorr\n          }\n\n          indexQuestion++\n          break\n        }\n        numExo++\n      }\n    }\n    // Une deuxime scurit pour virer les questions en trop\n    if (indexQuestion > 30) {\n      indexQuestion = 30\n      window.notify(\n        'malgr des prcautions prises, on a fabriqu plus de 30 questions dans MetaExercice',\n        { nbQuestions: indexQuestion },\n      )\n      this.listeQuestions = this.listeQuestions.slice(0, indexQuestion)\n      this.listeCorrections = this.listeCorrections.slice(0, indexQuestion)\n      this.autoCorrection = this.autoCorrection.slice(0, indexQuestion)\n    }\n\n    this.besoinFormulaire2Texte = this.sup3\n      ? false\n      : ['Choix des questions', 'Nombres spars par des tirets :']\n    this.besoinFormulaire3CaseACocher = ['Choix du nombre de questions']\n    this.comment = `Cet exercice fait partie des annales des Courses Aux Nombres (CAN).<br>\n  Il est plus souvent compos de 30 questions (parfois 20 pour les CE1/CE2) rparties de la faon suivante. \n  Les 10 premires questions, parfois communes  plusieurs niveaux, font appel  des questions lmentaires et les 20 suivantes (qui ne sont pas ranges dans un ordre de difficult) sont un peu plus  coteuses  cognitivement.<br>\n  Par dfaut, les questions sont ranges dans le mme ordre que le sujet officiel avec des donnes alatoires. Ainsi, en cliquant sur  Nouvelles donnes , on obtient une nouvelle Course Aux Nombres avec des donnes diffrentes.<br>\n  Dans les CAN depuis 2024, le choix des questions permet de choisir certaines questions parmi les 30. <br>\n  Dans les CAN d'avant 2024, on pouvait seulement choisir le nombre de questions comme dcrit ci-aprs. <br>\n  En choisissant un nombre de questions infrieur  30, on fabrique une  mini  Course Aux Nombres qui respecte la proportion de nombre de questions lmentaires par rapport aux autres.\n  Par exemple, en choisissant 20 questions, la course aux nombres sera compose de 7 ou 8 questions lmentaires choisies alatoirement dans les 10 premires questions du sujet officiel puis de 12 ou 13 autres questions choisies alatoirement parmi les 20 autres questions du sujet officiel.`\n  }\n}\n","// =========================================================================\n//\n//    Dclaration des types pour les dates dclares en chane de caractres\n//    source: https://gist.github.com/aperkaz/580e72b98eba5afac30549387562655d\n//\n// =========================================================================\ntype oneToNine = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\ntype zeroToNine = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\n/**\n * Years\n */\nexport const YEARS = [...Array(199).keys()].map((x) => (x + 1900).toString())\nexport const MONTHS = [\n  'janvier',\n  'fvrier',\n  'mars',\n  'avril',\n  'mai',\n  'juin',\n  'juillet',\n  'aot',\n  'septembre',\n  'octobre',\n  'novembre',\n  'dcembre',\n]\ntype YYYY = `19${zeroToNine}${zeroToNine}` | `20${zeroToNine}${zeroToNine}`\nexport const isYYYYType = (obj: any): obj is YYYY =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  typeof obj === 'string' &&\n  YEARS.includes(obj)\n/**\n * Months\n */\ntype MM = `0${oneToNine}` | `1${0 | 1 | 2}`\n/**\n * Days\n */\ntype DD = `${0}${oneToNine}` | `${1 | 2}${zeroToNine}` | `3${0 | 1}`\n/**\n * YYYYMMDD ou DD/MM/YYYY\n */\nexport type RawDateString = `${YYYY}${MM}${DD}`\nexport type FrenchDateString = `${DD}/${MM}/${YYYY}`\n/**\n * Indique s'il s'est coul strictement moins d'un mois depuis\n * une date passe en paramtre\n * @param {FrenchDateString} dateString date au format franais (par exemple : `23/02/2011`)\n * @remark La date passe entre paramtre doit tre comprise entre `01/01/1900` et `31/12/2099`\n * @returns {boolean} `true` si moins d'un mois s'est coul depuis la date jusqu' l'appel de la fonction\n */\nexport function isLessThan1Month(\n  dateString: FrenchDateString | undefined,\n): boolean {\n  if (dateString === undefined) return false\n  const [jour, mois, annee] = dateString.split('/')\n  const date = new Date(parseInt(annee), parseInt(mois) - 1, parseInt(jour))\n  const elapsedTime = Date.now() - date.getTime()\n  const unMois = 3600 * 24 * 30 * 1000\n  return elapsedTime < unMois\n}\n","/**\n * Transforme un objet en arbre bas sur un type Map.\n * Chaque proprit devient une cl et la valeur correspondante devient :\n * - soit une valeur si la valeur de la proprit est un tableau\n * - soit une autre map dans le cas contraire\n * @param {any} obj\n * @return {Map} l'arbre correspondant  l'objet\n * @author sylvain Chambon\n */\nexport function toMap(obj) {\n  const dico = new Map()\n  for (const cle of Object.keys(obj)) {\n    if (obj[cle] instanceof Object) {\n      if (obj[cle] instanceof Array) {\n        dico.set(cle, obj[cle])\n      } else {\n        dico.set(cle, toMap(obj[cle]))\n      }\n    } else {\n      dico.set(cle, obj[cle])\n    }\n  }\n  return dico\n}\n","import codeListForLevels from '../../json/codeToLevelList.json'\nimport codeListForThemes from '../../json/codeToThemeList.json'\nimport referentielsActivation from '../../json/referentielsActivation.json'\nimport { isLessThan1Month } from '../types/dates'\nimport {\n    type JSONReferentielEnding,\n    type JSONReferentielObject,\n    type ResourceAndItsPath,\n    isExerciceItemInReferentiel,\n    isJSONReferentielEnding,\n} from '../types/referentiels'\nimport { toMap } from './toMap'\n\n/**\n * Rcuprer la liste des exercices rcents !\n * @param {JSONReferentielObject} refObj le rfrentiel  inspecter\n * @returns {ResourceAndItsPath[]} un tableau de tous les exercices ayant une date de modification/publication infrieure  un mois\n * @author sylvain\n */\nexport function getRecentExercices(\n  refObj: JSONReferentielObject,\n): ResourceAndItsPath[] {\n  return findResourcesAndPaths(refObj, (e: JSONReferentielEnding) => {\n    if (isExerciceItemInReferentiel(e)) {\n      if (\n        (e.datePublication && isLessThan1Month(e.datePublication)) ||\n        (e.dateModification && isLessThan1Month(e.dateModification))\n      ) {\n        return true\n      } else {\n        return false\n      }\n    } else {\n      return false\n    }\n  })\n}\n\n/**\n * Rcuprer la liste de TOUS exercices.\n * @param {JSONReferentielObject} refObj le rfrentiel  rcuprer\n * @returns {ResourceAndItsPath[]} un tableau de tous les exercices (terminaisons) avec leur chemin\n * @author sylvain\n */\nexport function getAllEndings(\n  refObj: JSONReferentielObject,\n): ResourceAndItsPath[] {\n  return findResourcesAndPaths(refObj, () => true)\n}\n\n/**\n * Retrouve le titre d'un niveau bas sur son code\n *\n * #### Exemple de code\n * `levelCode` : \"6e\" --> Traduction: \"Sixime\"\n * @param {string} levelCode code du niveau\n * @author sylvain\n */\nexport function codeToLevelTitle(levelCode: string): string {\n  const listeNiveaux: { [key: string]: string } = codeListForLevels\n  const listeThemes: { [key: string]: string } = codeListForThemes\n  if (listeNiveaux[levelCode]) {\n    // une traduction du code est trouve dans la liste des niveaux\n    return listeNiveaux[levelCode]\n  } else if (listeThemes[levelCode]) {\n    // une traduction du code est trouve dans la liste des niveaux\n    return listeThemes[levelCode]\n  } else {\n    // pas d'entre trouve : on retourne le code\n    return levelCode\n  }\n}\n\n/**\n * Parcourt toutes les branches d'un rfrentiel pass en paramtre\n * et remplit une liste (passe en paramtre) avec les extrmits\n * qui passent le test d'une fonction passe en paramtre\n * @param {JSONReferentielObject} referentiel le rfrentiel  parcourir\n * @param {JSONReferentielEnding[]} harvest la liste stockant la rcolte\n * @param {function(e: JSONReferentielEnding):boolean} goalReachedWith fonction de triage\n * @author sylvain\n * @example\n * ```ts\n * fetchThrough(ref, results, (e: JSONReferentielEnding) => {\n    if (isExerciceItemInReferentiel(e)) {\n      return true\n    } else {\n      return false\n    }\n * ```\n */\nexport function fetchThrough(\n  referentiel: JSONReferentielObject,\n  harvest: JSONReferentielEnding[],\n  goalReachedWith: (e: JSONReferentielEnding) => boolean,\n): void {\n  Object.values(referentiel).forEach((value) => {\n    if (isJSONReferentielEnding(value)) {\n      if (goalReachedWith(value)) {\n        harvest.push(value)\n      }\n    } else {\n      fetchThrough(value as JSONReferentielObject, harvest, goalReachedWith)\n    }\n  })\n}\n\n/**\n * Parcourt un rfrentiel jusqu' ses extrmits et en garde la trace\n * avec son chemin lorsque cette extrmit remplie les conditions fixes\n * par la fonction passe en paramtre\n * @param {JSONReferentielObject} referentiel Le rfrentiel  chercher\n * @param {(e: JSONReferentielEnding) => boolean} goalReachedWith la fonction de filtrage\n * @returns {ResourceAndItsPath[]} Une liste d'objets du type\n * `{resource: JSONReferentielEnding,  pathToResource: string[]}`\n * @author sylvain\n */\nexport function findResourcesAndPaths(\n  referentiel: JSONReferentielObject,\n  goalReachedWith: (e: JSONReferentielEnding) => boolean,\n): ResourceAndItsPath[] {\n  const harvest: ResourceAndItsPath[] = []\n  const path: string[] = []\n  function find(ref: JSONReferentielObject) {\n    Object.entries(ref).forEach(([key, value]) => {\n      if (isJSONReferentielEnding(value)) {\n        if (goalReachedWith(value)) {\n          path.push(key)\n          harvest.push({ resource: value, pathToResource: [...path] })\n          path.pop()\n        }\n      } else {\n        path.push(key)\n        find(value as JSONReferentielObject)\n        path.pop()\n      }\n    })\n  }\n  find(referentiel)\n  return harvest\n}\n\n/**\n * Recherche une ressource dans un rfrentiel donn correspondant  une uuid\n * passe en paramtre\n * @param referentiel le rfrentiel dans lequel on cherche l'uuid\n * @param targetUuid l'uuid  rechercher\n * @returns la terminaison si une seule uuid matche, `null` si pas de match\n * @throws erreur si l'uuid est retrouve plus d'une fois\n * @author sylvain\n */\nexport function retrieveResourceFromUuid(\n  referentiel: JSONReferentielObject,\n  targetUuid: string,\n): JSONReferentielEnding | null {\n  const harvest: JSONReferentielEnding[] = []\n  fetchThrough(\n    referentiel,\n    harvest,\n    (resource: JSONReferentielEnding) => resource.uuid === targetUuid,\n  )\n  switch (harvest.length) {\n    case 0:\n      return null\n    case 1:\n      return harvest[0]\n    default:\n      return harvest[0]\n    // throw new Error(\n    //   `${targetUuid} est prsente ${harvest.length} fois dans le rfrentiel !!!`\n    // )\n  }\n}\n\n/**\n *  partir d'un objet de type `ResourceAndItsPath`, construit l'objet imbriqu correspondant\n * @param item Un objet constitu de la liste des nuds et de la terminaison\n * @returns un objet aux entres imbriques correspondant  une branche + une terminaison\n * @author sylvain\n */\nfunction pathToObject(item: ResourceAndItsPath): JSONReferentielObject {\n  return item.pathToResource.reduceRight(\n    (value, key) => ({ [key]: value }),\n    (<unknown>item.resource) as JSONReferentielObject,\n  )\n}\n\n/**\n * Construit  partir d'une liste d'objet de type `ResourceAndItsPath`\n * la liste des objets imbriqus (branche+terminaison) correspondants\n * @param {ResourceAndItsPath[]} items la liste des objets  transformer\n * @returns {JSONReferentielObject[]} la liste des objets transforms\n * @author sylvain\n */\nfunction pathsToObjectsArray(\n  items: ResourceAndItsPath[],\n): JSONReferentielObject[] {\n  const result: JSONReferentielObject[] = []\n  for (const item of items) {\n    result.push(pathToObject(item))\n  }\n  return result\n}\n\n/**\n * Fabrique de zro un rfrentiels sur la base d'entres constitues d'un chemin d'accs\n * et d'une terminaison `{resource: JSONReferentielEnding,  pathToResource: string[]}`\n * @param {ResourceAndItsPath[]} refList la liste des entres pour constituer le rfrentiel\n * @returns {JSONReferentielObject} un rfrentiel sous forme d'objet\n * @author sylvain\n */\nexport function buildReferentiel(\n  refList: ResourceAndItsPath[],\n): JSONReferentielObject {\n  return pathsToObjectsArray(refList).reduce((prev, current) => {\n    return mergeReferentielObjects(prev, current)\n  }, {})\n}\n\n/**\n * Fusionne des objets rfrentiels sans craser les entres prcdentes\n * @param {JSONReferentielObject[]} objects les objets  fusionner\n * @returns {JSONReferentielObject} un rfrentiel\n * @see https://tutorial.eyehunts.com/js/javascript-merge-objects-without-overwriting-example-code/\n * @author sylvain\n */\nexport function mergeReferentielObjects(\n  ...objects: JSONReferentielObject[]\n): JSONReferentielObject {\n  const isObject = (obj: unknown) => obj && typeof obj === 'object'\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj).forEach((key) => {\n      const pVal = prev[key]\n      const oVal = obj[key]\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = pVal.concat(...oVal)\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = mergeReferentielObjects(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n\n/**\n * Consulte le fichier `src/json/referentielsActivation.json`\n * et retourne la valeur d'activation `true`/`false` indiqu pour un nom de rfrentiel donn.\n * @param refName nom du rfrentiel (conformment au type `ReferentielNames` dans `src/lib/types.ts`)\n * @returns la valeur mentionne dans `src/json/referentielsActivation.json` <br/> `false` si le nom du rfrentiel n'exoiste pas.\n * @author sylvain\n */\nexport function isReferentielActivated(refName: string): boolean {\n  const referentielList = toMap({ ...referentielsActivation })\n  if (referentielList.has(refName)) {\n    return referentielList.get(refName) === 'true'\n  } else {\n    console.warn(refName + ' is not a valid referentiel name !')\n    return false\n  }\n}\n","import seedrandom from 'seedrandom'\nimport { get } from 'svelte/store'\nimport Exercice from '../../exercices/Exercice'\nimport referentielStaticCH from '../../json/referentielStaticCH.json'\nimport referentielStaticFR from '../../json/referentielStaticFR.json'\nimport { retrieveResourceFromUuid } from '../../lib/components/refUtils'\nimport {\n  isStaticType,\n  type JSONReferentielObject,\n} from '../../lib/types/referentiels'\nimport {\n  mathaleaFormatExercice,\n  mathaleaHandleExerciceSimple,\n  mathaleaHandleParamOfOneExercice,\n  mathaleaLoadExerciceFromUuid,\n} from '../mathalea'\nimport { exercicesParams } from '../stores/generalStore'\nimport { globalOptions } from '../stores/globalOptions'\nimport type { IExercice } from '../types'\nimport { isStatic } from './componentsUtils'\n\nconst allStaticReferentiels: JSONReferentielObject = {\n  ...referentielStaticFR,\n  ...referentielStaticCH,\n}\n\n// on supprime les entres par thme qui entrane des doublons\ndelete allStaticReferentiels['BrevetTags']\ndelete allStaticReferentiels['EVACOMTags']\ndelete allStaticReferentiels['E3CTags']\ndelete allStaticReferentiels['crpeTags']\n\n/**\n * Construit la liste des exercices base sur le contenu du store exercicesParams\n * @returns liste des exercices EN PROMESSE\n */\nexport const buildExercisesList = (\n  filter: string[] = [],\n): Promise<IExercice>[] => {\n  const promiseExos: Promise<IExercice>[] = []\n  const options = get(globalOptions)\n  const exosParams = get(exercicesParams)\n  for (const paramsExercice of exosParams) {\n    if (filter.length > 0 && !filter.includes(paramsExercice.uuid)) {\n      continue\n    }\n    if (isStatic(paramsExercice.uuid)) {\n      const p = new Promise<IExercice>((resolve) => {\n        // console.log('id' + paramsExercice.id)\n        const exo = new Exercice()\n        exo.titre = `Uuid ${paramsExercice.uuid}`\n        exo.listeQuestions[0] = `Uuid ${paramsExercice.uuid}<br>`\n        exo.listeCorrections[0] = `Uuid ${paramsExercice.uuid}<br>`\n        exo.nbQuestions = 1\n        const foundResource = retrieveResourceFromUuid(\n          allStaticReferentiels,\n          paramsExercice.uuid,\n        )\n        if (isStaticType(foundResource)) {\n          exo.listeQuestions[0] =\n            exo.listeQuestions[0] +\n            `<br>\n          <img src=\"${foundResource.png || ''}\" style=\"width: calc(100% * {zoomFactor}\" alt=\"nonc\" />`\n          exo.listeCorrections[0] =\n            exo.listeCorrections[0] +\n            `<br>\n          <img src=\"${foundResource.pngCor || ''}\" style=\"width: calc(100% * {zoomFactor}\" alt=\"correction\" />`\n        }\n        mathaleaHandleParamOfOneExercice(exo, paramsExercice)\n        if (options.setInteractive === '1' && exo?.interactifReady) {\n          exo.interactif = true\n        }\n        resolve(exo)\n        // console.log('id resolu' + paramsExercice.id)\n      })\n      promiseExos.push(p)\n    } else {\n      const p = new Promise<IExercice>((resolve) => {\n        // console.log('id' + paramsExercice.id)\n        mathaleaLoadExerciceFromUuid(paramsExercice.uuid).then((exo) => {\n          if (typeof exo === 'undefined') {\n            throw new Error(\n              \"L'exercice correspondant  l'uuid \" +\n                paramsExercice.uuid +\n                \" n'est pas dfini...\",\n            )\n          }\n          mathaleaHandleParamOfOneExercice(exo, paramsExercice)\n          if (options.setInteractive === '1' && exo?.interactifReady) {\n            exo.interactif = true\n          }\n          resolve(exo)\n        })\n        // console.log('id resolu' + paramsExercice.id)\n      })\n      promiseExos.push(p)\n    }\n  }\n  return promiseExos\n}\n\nexport const splitExercisesIntoQuestions = (\n  exercices: IExercice[],\n): {\n  questions: (string | IExercice)[]\n  consignes: string[]\n  corrections: string[]\n  consignesCorrections: string[]\n  isCorrectionVisible: boolean[]\n  indiceExercice: number[]\n  indiceQuestionInExercice: number[]\n} => {\n  let questions: (string | IExercice)[] = []\n  let consignes: string[] = []\n  let corrections: string[] = []\n  let consignesCorrections: string[] = []\n\n  const isCorrectionVisible: boolean[] = []\n  const indiceExercice: number[] = []\n  const indiceQuestionInExercice: number[] = []\n\n  for (const [k, exercice] of exercices.entries()) {\n    exercice.score = 0\n    exercice.numeroExercice = k\n    if (exercice.typeExercice === 'simple') {\n      mathaleaHandleExerciceSimple(exercice, exercice.interactif, k)\n    } else {\n      if (exercice.nouvelleVersionWrapper !== undefined) {\n        if (exercice.seed !== undefined) {\n          seedrandom(exercice.seed, { global: true })\n        }\n        exercice.nouvelleVersionWrapper(k)\n      }\n    }\n    isCorrectionVisible[k] = false\n    const cumulConsignesCorrections = []\n    if (exercice.listeQuestions === undefined) {\n      exercice.listeQuestions = []\n    }\n    if (exercice.listeCorrections === undefined) {\n      exercice.listeCorrections = []\n    }\n    for (let i = 0; i < exercice.listeQuestions.length; i++) {\n      consignes.push(\n        `${exercice?.consigne} ${exercice?.consigne && exercice?.introduction ? '<br>\\n' : ''} ${exercice?.introduction}`,\n      )\n      indiceExercice.push(k)\n      indiceQuestionInExercice.push(i)\n      if (exercice.consigneCorrection !== undefined) {\n        cumulConsignesCorrections.push(exercice.consigneCorrection)\n      }\n    }\n    let newQuestions: (string | IExercice)[] = exercice.listeQuestions.map(\n      mathaleaFormatExercice,\n    )\n    let newCorrections: string[] = exercice.listeCorrections.map(\n      mathaleaFormatExercice,\n    )\n    if (exercice.typeExercice === 'html') {\n      newQuestions = [exercice]\n      newCorrections = ['']\n      cumulConsignesCorrections.push('')\n      consignes.push('')\n      indiceExercice.push(k)\n      indiceQuestionInExercice.push(0)\n    }\n    questions = [...questions, ...newQuestions]\n    corrections = [...corrections, ...newCorrections]\n    consignesCorrections = [\n      ...consignesCorrections,\n      ...cumulConsignesCorrections,\n    ].map(mathaleaFormatExercice)\n    consignes = consignes.map(mathaleaFormatExercice)\n  }\n\n  return {\n    questions,\n    consignes,\n    corrections,\n    consignesCorrections,\n    isCorrectionVisible,\n    indiceExercice,\n    indiceQuestionInExercice,\n  }\n}\n","import { addElement, get, setStyles } from '../html/dom'\nimport { afficheScore } from './afficheScore'\n\nexport function mouseOverSvgEffect() {\n  this.style.border = '1px solid #1DA962'\n}\n\nexport function mouseOutSvgEffect() {\n  this.style.border = 'none'\n}\n\nexport function mouseSvgClick() {\n  if (this.etat) {\n    // Dja choisi, donc on le rinitialise\n    this.style.border = 'none'\n    this.addEventListener('mouseover', mouseOverSvgEffect)\n    this.addEventListener('mouseout', mouseOutSvgEffect)\n    this.addEventListener('click', mouseSvgClick)\n    this.etat = false\n  } else {\n    // Passe  l'tat choisi donc on dsactive les listenners pour over et pour out\n    this.removeEventListener('mouseover', mouseOverSvgEffect)\n    this.removeEventListener('mouseout', mouseOutSvgEffect)\n    this.style.border = '3px solid #f15929'\n    this.etat = true\n  }\n}\n\n/**\n * Retrouve les numros des figures cliques dans une question de type \"cliqueFigure\"\n */\nexport function indexQuestionCliqueFigure(exercice, i) {\n  const elementArray = []\n  for (let j = 0; j < exercice.figures[i].length; j++) {\n    const eltFigure = document.getElementById(exercice.figures[i][j].id)\n    elementArray.push(eltFigure)\n  }\n\n  function documentPositionComparator(a, b) {\n    if (a === b) {\n      return 0\n    }\n    const position = a.compareDocumentPosition(b)\n\n    if (\n      position & Node.DOCUMENT_POSITION_FOLLOWING ||\n      position & Node.DOCUMENT_POSITION_CONTAINED_BY\n    ) {\n      return -1\n    } else if (\n      position & Node.DOCUMENT_POSITION_PRECEDING ||\n      position & Node.DOCUMENT_POSITION_CONTAINS\n    ) {\n      return 1\n    } else {\n      return 0\n    }\n  }\n  const figs = elementArray.sort(documentPositionComparator)\n  const numbs = []\n  for (let j = 0; j < figs.length; j++) {\n    if (figs[j].etat) numbs.push((j + 1).toString())\n  }\n  return numbs.join(';')\n}\n\nexport function verifQuestionCliqueFigure(exercice, i) {\n  // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  let eltFeedback = get(`resultatCheckEx${exercice.numeroExercice}Q${i}`, false)\n  // On ajoute le div pour le feedback\n  if (!eltFeedback) {\n    const eltExercice = get(`exercice${exercice.numeroExercice}`)\n    eltFeedback = addElement(eltExercice, 'div', {\n      id: `resultatCheckEx${exercice.numeroExercice}Q${i}`,\n    })\n  }\n  if (exercice.answers === undefined) {\n    exercice.answers = {}\n  }\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n  let erreur = false // Aucune erreur dtecte\n  let nbFiguresCliquees = 0\n  for (const objetFigure of exercice.figures[i]) {\n    const eltFigure = document.getElementById(objetFigure.id)\n    eltFigure.removeEventListener('mouseover', mouseOverSvgEffect)\n    eltFigure.removeEventListener('mouseout', mouseOutSvgEffect)\n    eltFigure.removeEventListener('click', mouseSvgClick)\n    eltFigure.hasMathaleaListener = false\n    if (eltFigure.etat) nbFiguresCliquees++\n    if (eltFigure.etat) exercice.answers[objetFigure.id] = '1'\n    if (eltFigure.etat !== objetFigure.solution) erreur = true\n  }\n  if (nbFiguresCliquees > 0 && !erreur) {\n    eltFeedback.innerHTML = ''\n    return 'OK'\n  } else {\n    eltFeedback.innerHTML = ''\n    return 'KO'\n  }\n}\n\nexport function questionCliqueFigure(figSvg) {\n  if (figSvg) {\n    if (!figSvg.hasMathaleaListener) {\n      figSvg.addEventListener('mouseover', mouseOverSvgEffect)\n      figSvg.addEventListener('mouseout', mouseOutSvgEffect)\n      figSvg.addEventListener('click', mouseSvgClick)\n      figSvg.etat = false\n      figSvg.style.margin = '10px'\n      figSvg.hasMathaleaListener = true\n      // On enregistre que l'lment a dj un listenner pour ne pas lui remettre le mme  l'appui sur \"Nouvelles Donnes\"\n    }\n  }\n}\n\nexport function exerciceCliqueFigure(exercice) {\n  document.addEventListener('exercicesAffiches', () => {\n    // Ds que l'exercice est affich, on rajoute des listenners sur chaque lments de this.figures.\n    for (let i = 0; i < exercice.nbQuestions; i++) {\n      for (const objetFigure of exercice.figures[i]) {\n        const figSvg = document.getElementById(objetFigure.id)\n        questionCliqueFigure(figSvg)\n      }\n    }\n    // Gestion de la correction\n    const button = document.querySelector(\n      `#btnValidationEx${exercice.numeroExercice}-${exercice.id}`,\n    )\n    if (button) {\n      if (!button.hasMathaleaListener) {\n        button.addEventListener('click', (event) => {\n          let nbBonnesReponses = 0\n          let nbMauvaisesReponses = 0\n          for (let i = 0; i < exercice.nbQuestions; i++) {\n            verifQuestionCliqueFigure(exercice, i) === 'OK'\n              ? nbBonnesReponses++\n              : nbMauvaisesReponses++\n          }\n          afficheScore(exercice, nbBonnesReponses, nbMauvaisesReponses)\n        })\n        button.hasMathaleaListener = true\n      }\n    }\n  })\n}\n","import { get } from 'svelte/store'\nimport { capytaleMode, exercicesParams } from '../lib/stores/generalStore'\nimport { globalOptions } from '../lib/stores/globalOptions'\nimport type { InterfaceParams } from '../lib/types'\nimport { getIntrus, log, logDebug } from './statsUtils'\n\ndeclare global {\n  interface Window {\n    _paq: any[]\n    logDebug: number\n  }\n}\n\n// pour pour pouvoir le dactiver en mode debug...\n// eslint-disable-next-line prefer-const\nlet activeStats = document.location.hostname !== 'localhost'\n\nif (activeStats) {\n  const _paq = (window._paq = window._paq || [])\n  _paq.push(['trackPageView'])\n  _paq.push(['disableCookies'])\n  ;(function () {\n    const u = '//ynh.coopmaths.fr/matomo/'\n    _paq.push(['setTrackerUrl', u + 'matomo.php'])\n    _paq.push(['setSiteId', '1'])\n    const d = document\n    const g = d.createElement('script')\n    const s = d.getElementsByTagName('script')[0]\n    g.async = true\n    g.src = u + 'matomo.js'\n    if (s.parentNode) {\n      s.parentNode.insertBefore(g, s)\n    }\n  })()\n}\n\nlogDebug('Matomo loaded')\n\nconst paramExos: string[] = []\nconst uuids: string[] = []\nconst vueUuids: string[] = []\nconst vue: string[] = ['']\nconst recorder: string[] = ['']\n\nfunction paraConvert(param: InterfaceParams) {\n  const par: {\n    nb?: number\n    uuid: string\n    t?: string\n    e?: string | number\n    c?: string\n    et?: string | number\n    s1?: string\n    s2?: string\n    s3?: string\n    s4?: string\n    s5?: string\n    a?: string\n    i?: string\n    s?: number\n  } = { uuid: param.uuid }\n  if (param.nbQuestions) par.nb = param.nbQuestions\n  if (param.type) par.t = param.type\n  if (param.exo) par.e = param.exo\n  if (param.exoType) par.et = param.exoType\n  if (param.cd) par.c = param.cd\n  if (param.sup) par.s1 = param.sup.replace('true', 't').replace('false', 'f')\n  if (param.sup2) par.s2 = param.sup2.replace('true', 't').replace('false', 'f')\n  if (param.sup3) par.s3 = param.sup3.replace('true', 't').replace('false', 'f')\n  if (param.sup4) par.s4 = param.sup4.replace('true', 't').replace('false', 'f')\n  if (param.sup5) par.s5 = param.sup5.replace('true', 't').replace('false', 'f')\n  if (param.alea) par.a = param.alea\n  if (param.interactif) par.i = param.interactif\n  if (param.bestScore) par.s = param.bestScore\n  return par\n}\n\nglobalOptions.subscribe((options) => {\n  logDebug('globalOptions', options)\n\n  if (options) {\n    if (options.v === undefined) return // chargement du site\n    if (options.recorder === 'capytale' && get(capytaleMode) === 'none') return // capytale pas encore charg\n    if (vue[0] === (options.v || 'prof')) {\n      logDebug('Pas de changement de vue')\n      return\n    }\n    // nouvelle vue\n    vue[0] = options.v || 'prof'\n    log('vue', vue[0])\n    if (window._paq) window._paq.push(['trackEvent', 'Vue', vue[0]])\n    // if (window._paq) window._paq.push(['setCustomDimension', 1, vue[0]])\n    if (options.recorder) recorder[0] = options.recorder\n    log('recorder', recorder[0])\n    // if (window._paq) window._paq.push(['setCustomDimension', 2, recorder[0]])\n    if (window._paq && options.recorder)\n      window._paq.push(['setCustomDimension', 1, options.recorder])\n\n    // changement de vue\n    const vueUuids1: string[] = []\n    for (let i = 0; i < paramExos.length; i++) {\n      const parsedExo = JSON.parse(paramExos[i])\n      // if (window._paq) window._paq.push(['trackEvent', 'VueExo', vue[0] + '-' + parsedExo.uuid, paramExos[i]])\n      log(vue[0] + '-' + parsedExo.uuid, 'par:', paramExos[i])\n      if (vue[0] !== '')\n        vueUuids1.push(\n          vue[0] +\n            '-' +\n            parsedExo.uuid +\n            (recorder[0] ? '-' + recorder[0] : ''),\n        )\n    }\n\n    // changement de vue pour les exercices\n    getIntrus(vueUuids1, vueUuids).forEach((intrus) => {\n      if (intrus.difference > 0) {\n        for (let j = 0; j < intrus.difference; j++) {\n          vueUuids.push(intrus.value)\n          log('Ajout de', intrus.value, 'dans vueUuids')\n          if (window._paq)\n            window._paq.push(['trackEvent', 'VueUuid', intrus.value])\n        }\n      } else if (intrus.difference < 0) {\n        for (let j = 0; j < Math.abs(intrus.difference); j++) {\n          const index = vueUuids.lastIndexOf(intrus.value)\n          if (index > -1) {\n            vueUuids.splice(index, 1)\n            log('Suppression de', intrus.value, 'de vueUuids')\n          }\n        }\n      }\n    })\n    logDebug('vueUuids:', vueUuids)\n  }\n})\n\nexercicesParams.subscribe((params) => {\n  logDebug('exercicesParams', params)\n  if (params) {\n    const vueUuids1: string[] = []\n    params.forEach((param) => {\n      // on met  jour la liste des exercices\n      if (uuids.includes(param.uuid)) {\n        logDebug('Uuid dj charg:', param.uuid)\n      } else {\n        uuids.push(param.uuid)\n        if (window._paq) window._paq.push(['trackEvent', 'Uuid', param.uuid])\n        log('Uuids-' + param.uuid)\n      }\n      // on met  jour la liste des paramtres avec la vue et le recorder:\n      if (vue[0] !== '')\n        vueUuids1.push(\n          vue[0] + '-' + param.uuid + (recorder[0] ? '-' + recorder[0] : ''),\n        )\n      const par = paraConvert(param)\n      if (paramExos.includes(JSON.stringify(par))) {\n        logDebug('dj charg:', param.uuid)\n      } else {\n        paramExos.push(JSON.stringify(par))\n        // if (window._paq && vue[0] !== '') window._paq.push(['trackEvent', 'VueExo', vue[0] + '-' + par.uuid, JSON.stringify(par)])\n        if (vue[0] !== '')\n          log(vue[0] + '-' + par.uuid, 'par:', JSON.stringify(par))\n      }\n    })\n    // Supprimer les lments qui ne sont pas dans la rfrence\n    for (let i = paramExos.length - 1; i >= 0; i--) {\n      if (\n        !params.some(\n          (param) => JSON.stringify(paraConvert(param)) === paramExos[i],\n        )\n      ) {\n        const ele = paramExos.splice(i, 1)\n        log('exercice supprim', ele)\n      }\n    }\n    logDebug('paramExos:', paramExos)\n    for (let i = uuids.length - 1; i >= 0; i--) {\n      if (!params.some((param) => param.uuid === uuids[i])) {\n        const ele = uuids.splice(i, 1)\n        log('uuid supprim', ele)\n      }\n    }\n    logDebug('uuids:', uuids)\n    getIntrus(vueUuids1, vueUuids).forEach((intrus) => {\n      if (intrus.difference > 0) {\n        for (let j = 0; j < intrus.difference; j++) {\n          vueUuids.push(intrus.value)\n          log('Ajout de', intrus.value, 'dans vueUuids')\n          if (window._paq)\n            window._paq.push(['trackEvent', 'VueUuid', intrus.value])\n        }\n      } else if (intrus.difference < 0) {\n        for (let j = 0; j < Math.abs(intrus.difference); j++) {\n          const index = vueUuids.lastIndexOf(intrus.value)\n          if (index > -1) {\n            vueUuids.splice(index, 1)\n            log('Suppression de', intrus.value, 'de vueUuids')\n          }\n        }\n      }\n    })\n    logDebug('vueUuids:', vueUuids)\n  }\n})\n\nexport function statsCanTracker(recorder: string, vue: string) {\n  logDebug('Tracking can stats...')\n  for (let i = 0; i < vueUuids.length; i++) {\n    const uuid = vueUuids[i].split('-')[1]\n    if (window._paq) {\n      window._paq.push([\n        'trackEvent',\n        'CheckCan',\n        vue + '-' + uuid + (recorder ? '-' + recorder : ''),\n      ])\n    }\n    log(vue + '-' + uuid, 'CheckCan', recorder ? '-' + recorder : '')\n  }\n}\n","import { writable } from 'svelte/store'\nimport type {\n  AlphanumericPages,\n  BlockForKeyboard,\n} from '../types/keyboardContent'\n\nexport const keyboardState = writable<{\n  isVisible: boolean\n  isInLine: boolean\n  idMathField: string\n  alphanumericLayout: AlphanumericPages\n  blocks: BlockForKeyboard[]\n}>({\n  isVisible: false,\n  isInLine: !('ontouchstart' in window),\n  idMathField: '',\n  alphanumericLayout: 'AlphaLow',\n  blocks: ['numbers', 'fullOperations'],\n})\n","<script lang=\"ts\">\n  import { darkMode } from '../../../lib/stores/generalStore'\n</script>\n\n<button\n  type=\"button\"\n  class=\"text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n  on:click={() => ($darkMode.isActive = !$darkMode.isActive)}\n>\n  {#if $darkMode.isActive}\n    <i class=\"bx bx-sm bx-sun\"></i>\n  {:else}\n    <i class=\"bx bx-sm bx-moon\"></i>\n  {/if}\n</button>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import type { CanState } from '../../../../lib/types/can'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  export let state: CanState\n  export let count: number = 6\n  onMount(() => {\n    const counter = document.getElementById('counter')\n    if (counter) {\n      const interval = window.setInterval(() => {\n        const nextcount = --count\n        if (nextcount === 0) {\n          window.clearInterval(interval)\n          canOptions.update((options) => {\n            options.state = 'race'\n            return options\n          })\n          state = 'race'\n        }\n        requestAnimationFrame(() => {\n          counter.textContent = nextcount.toString()\n          counter.classList.remove('big')\n          requestAnimationFrame(() => {\n            counter.classList.add('big')\n          })\n        })\n      }, 1000)\n    }\n  })\n</script>\n\n<div\n  class=\"h-full w-full flex flex-col items-center justify-center bg-coopmaths-struct dark:bg-coopmathsdark-canvas text-coopmaths-canvas dark:text-coopmathsdark-corpus\"\n>\n  <div id=\"counter\" class=\"big font-black\">3</div>\n</div>\n\n<style>\n  #counter.big {\n    font-size: 2000%;\n    opacity: 0;\n    transition: all linear 1s;\n  }\n</style>\n","<script lang=\"ts\">\n  export let text: string\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let icon: string = ''\n  export let iconFirst: boolean = true\n</script>\n\n<button\n  type=\"button\"\n  {title}\n  id={$$props.id}\n  class={$$props.class || 'rounded-lg py-1 px-2'}\n  {disabled}\n  on:click\n>\n  {#if iconFirst}\n    {#if icon !== ''}\n      <i class=\"bx {icon} pr-1\"></i>\n    {/if}\n    {text}\n  {:else}\n    {text}\n    {#if icon !== ''}\n      <i class=\"bx {icon} pl-1\"></i>\n    {/if}\n  {/if}\n</button>\n","<script lang=\"ts\">\n  import ButtonText from './ButtonText.svelte'\n  export let text: string\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let icon: string = ''\n  export let inverted: boolean = false\n  export let iconFirst = true\n</script>\n\n<ButtonText\n  id={$$props.id}\n  class=\"{$$props.class || 'rounded-lg py-1 px-2'}\n    {disabled\n    ? 'dark:bg-coopmathsdark-action/10'\n    : ''}\n    {inverted\n    ? `border border-coopmaths-action\n        text-coopmaths-action dark:text-coopmathsdark-action\n        bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n        hover:bg-coopmaths-action dark:hover:bg-coopmathsdark-action\n        hover:text-coopmaths-canvas dark:hover:text-coopmathsdark-canvas`\n    : `text-coopmaths-canvas dark:text-coopmathsdark-canvas\n        bg-coopmaths-action dark:bg-coopmathsdark-action\n        hover:bg-coopmaths-action-lightest dark:hover:bg-coopmathsdark-action-lightest`}\"\n  {text}\n  {title}\n  {disabled}\n  {icon}\n  {inverted}\n  {iconFirst}\n  on:click\n/>\n","<script lang=\"ts\">\n  import ButtonTextAction from '../../../shared/forms/ButtonTextAction.svelte'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n  export let state: CanState\n  export let score: string\n  export let time: string\n</script>\n\n<div\n  class=\"h-full w-full flex flex-col items-center justify-center bg-coopmaths-struct dark:bg-coopmathsdark-canvas\"\n>\n  <div\n    id=\"counter\"\n    class=\"text-[130px] text-coopmaths-canvas dark:text-coopmathsdark-corpus font-black\"\n  >\n    Fin !\n  </div>\n  <div\n    class=\"flex flex-col md:flex-row space-x-0 md:space-x-4 space-y-2 md:space-y-0 py-4 md:py-10 items-center\"\n  >\n    {#if $canOptions.isInteractive}\n      <div\n        id=\"score\"\n        class=\"text-3xl md:text-7xl text-coopmaths-canvas dark:text-coopmathsdark-corpus font-light\"\n      >\n        Score : <span\n          class=\"text-coopmaths-warn-800 dark:text-coopmathsdark-warn font-bold\"\n          >{score}</span\n        >\n      </div>\n      <div\n        class=\"hidden md:flex text-coopmaths-canvas dark:text-coopmathsdark-corpus text-3xl md:text-7xl\"\n      >\n        &nbsp;&nbsp;\n      </div>\n    {/if}\n    <div\n      id=\"score\"\n      class=\"text-3xl md:text-7xl text-coopmaths-canvas dark:text-coopmathsdark-corpus font-light\"\n    >\n      Temps : <span\n        class=\"text-coopmaths-warn-800 dark:text-coopmathsdark-warn font-bold\"\n        >{time}</span\n      >\n    </div>\n  </div>\n  {#if $canOptions.solutionsAccess}\n    <ButtonTextAction\n      text=\"Accder aux solutions\"\n      class=\"p-2 md:p-4 font-bold rounded-lg text-sm md:text-xl mt-6 md:mt-10\"\n      on:click={() => {\n        state = 'solutions'\n      }}\n    />\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { assignmentDataFromCapytale } from '../../../../lib/handleCapytale'\n  import type { CanState } from '../../../../lib/types/can'\n  import ButtonTextAction from '../../../shared/forms/ButtonTextAction.svelte'\n  export let state: CanState\n  export let title = 'Course aux Nombres'\n  export let subTitle = '2023'\n\n  /**\n   * Construit la chane qui sera affiche pour le score\n   * nombre de points obtenu / nombre de questions\n   */\n  function buildStringScore(): string {\n    const score = getScore()\n    if (assignmentDataFromCapytale?.resultsByQuestion !== undefined) {\n      return `Meilleur score : ${score} / ${assignmentDataFromCapytale?.resultsByQuestion.length} en ${assignmentDataFromCapytale?.duration} s`\n    } else {\n      return ''\n    }\n  }\n\n  function getScore(): number {\n    let score = 0\n    if (assignmentDataFromCapytale?.resultsByQuestion !== undefined) {\n      for (const result of assignmentDataFromCapytale?.resultsByQuestion) {\n        if (result === true) {\n          score++\n        }\n      }\n    }\n    return score\n  }\n</script>\n\n<div\n  class=\"h-full w-full flex flex-col items-center justify-center bg-coopmaths-struct dark:bg-coopmathsdark-canvas text-coopmaths-canvas dark:text-coopmathsdark-corpus\"\n>\n  <div class=\"font-black text-center uppercase text-6xl md:text-[130px]\">\n    {title}\n  </div>\n  <div class=\"pt-2 md:pt-6 font-extralight text-5xl md:text-[100px]\">\n    {subTitle}\n  </div>\n  <div class=\"pt-2 md:pt-6 font-extralight text-3xl\">\n    {buildStringScore()}\n  </div>\n  <div class=\"pt-10\">\n    {#if state === 'start'}\n      <ButtonTextAction\n        class=\"py-3 px-6 text-3xl rounded-xl flex flex-row-reverse items-center space-x-6 font-bold animate-pulse\"\n        text=\"Dmarrer\"\n        icon=\"bx-play bx-lg pl-1\"\n        on:click={() => {\n          state = 'countdown'\n        }}\n      />\n    {/if}\n  </div>\n  <slot />\n</div>\n","import type { UnitCategory } from '../types/units'\n\n/**\n * Type pour les puissances de 10 utilises comme cls dans prefixes\n */\ntype PrefixPower =\n  | '24'\n  | '21'\n  | '18'\n  | '15'\n  | '12'\n  | '9'\n  | '6'\n  | '3'\n  | '2'\n  | '1'\n  | '0'\n  | '-1'\n  | '-2'\n  | '-3'\n  | '-6'\n  | '-9'\n  | '-12'\n  | '-15'\n  | '-18'\n  | '-21'\n  | '-24'\n\n/**\n * Interface pour un prfixe d'unit\n */\ninterface PrefixInfo {\n  symbol: string\n  name: string\n}\n\nexport const prefixes: Record<PrefixPower, PrefixInfo> = {\n  '24': {\n    symbol: 'Y',\n    name: 'yotta',\n  },\n  '21': {\n    symbol: 'Z',\n    name: 'zetta',\n  },\n  '18': {\n    symbol: 'E',\n    name: 'exa',\n  },\n  '15': {\n    symbol: 'P',\n    name: 'peta',\n  },\n  '12': {\n    symbol: 'T',\n    name: 'tera',\n  },\n  '9': {\n    symbol: 'G',\n    name: 'giga',\n  },\n  '6': {\n    symbol: 'M',\n    name: 'mga',\n  },\n  '3': {\n    symbol: 'k',\n    name: 'kilo',\n  },\n  '2': {\n    symbol: 'h',\n    name: 'hecto',\n  },\n  '1': {\n    symbol: 'da',\n    name: 'dca',\n  },\n  '0': {\n    symbol: '',\n    name: '',\n  },\n  '-1': {\n    symbol: 'd',\n    name: 'dci',\n  },\n  '-2': {\n    symbol: 'c',\n    name: 'centi',\n  },\n  '-3': {\n    symbol: 'm',\n    name: 'milli',\n  },\n  '-6': {\n    symbol: '',\n    name: 'micro',\n  },\n  '-9': {\n    symbol: 'n',\n    name: 'nano',\n  },\n  '-12': {\n    symbol: 'p',\n    name: 'pico',\n  },\n  '-15': {\n    symbol: 'f',\n    name: 'femto',\n  },\n  '-18': {\n    symbol: 'a',\n    name: 'atto',\n  },\n  '-21': {\n    symbol: 'z',\n    name: 'zepto',\n  },\n  '-24': {\n    symbol: 'y',\n    name: 'yocto',\n  },\n} as const\n\n/**\n * Interface pour une unit de base\n */\ninterface UnitInfo {\n  symbol: string\n  name: string\n}\n\nexport const units: Record<UnitCategory, UnitInfo> = {\n  length: {\n    symbol: 'm',\n    name: 'mtre',\n  },\n  volume: {\n    // chang de 'content' vers 'volume' pour correspondre au type UnitCategory\n    symbol: 'L',\n    name: 'litre',\n  },\n  mass: {\n    symbol: 'g',\n    name: 'gramme',\n  },\n  power: {\n    symbol: 'W',\n    name: 'watt',\n  },\n  electric: {\n    // chang de 'current' vers 'electric' pour correspondre au type UnitCategory\n    symbol: 'A',\n    name: 'ampre',\n  },\n  frequency: {\n    symbol: 'Hz',\n    name: 'hertz',\n  },\n  energy: {\n    symbol: 'J',\n    name: 'joule',\n  },\n  // Ajout des catgories manquantes pour correspondre au type UnitCategory\n  time: {\n    symbol: 's',\n    name: 'seconde',\n  },\n  area: {\n    symbol: 'a',\n    name: 'are',\n  },\n  temperature: {\n    symbol: 'C',\n    name: 'degr Celsius',\n  },\n  pressure: {\n    symbol: 'Pa',\n    name: 'pascal',\n  },\n  speed: {\n    symbol: 'm/s',\n    name: 'mtre par seconde',\n  },\n  force: {\n    symbol: 'N',\n    name: 'newton',\n  },\n  angle: {\n    symbol: 'rad',\n    name: 'radian',\n  },\n} as const\n\nexport class Unit {\n  prefix: PrefixPower\n  category: UnitCategory\n  exp: 1 | 2 | 3\n  name: string\n  symbol: string\n  insert: string\n  private superscript = [\n    {\n      name: '',\n      symbol: '',\n      latexInsert: '',\n    },\n    {\n      name: ' carr',\n      symbol: '',\n      latexInsert: '^2',\n    },\n    {\n      name: ' cube',\n      symbol: '',\n      latexInsert: '^3',\n    },\n  ]\n\n  constructor(pre: PrefixPower, cat: UnitCategory, e: 1 | 2 | 3 = 1) {\n    this.prefix = pre\n    this.category = cat\n    this.exp = e\n    this.name = [\n      prefixes[this.prefix].name,\n      units[this.category].name,\n      this.superscript[this.exp - 1].name,\n    ].join('')\n    this.symbol = [\n      prefixes[this.prefix].symbol,\n      units[this.category].symbol,\n      this.superscript[this.exp - 1].symbol,\n    ].join('')\n    const symbol = [\n      prefixes[this.prefix].symbol,\n      units[this.category].symbol,\n    ].join('')\n    const pow = this.superscript[this.exp - 1].latexInsert\n    this.insert = `$$\\\\operatorname{ ${symbol}}${pow}$$`\n  }\n}\n\nexport class UnitSystem {\n  units: Unit[]\n  private exp: number\n\n  constructor(prefixList: PrefixPower[], cat: UnitCategory, e: 1 | 2 | 3 = 1) {\n    this.units = prefixList.map((p) => new Unit(p, cat, e))\n    this.exp = e\n  }\n}\n\nexport const lengthUnits: UnitSystem = new UnitSystem(\n  ['3', '2', '1', '0', '-1', '-2', '-3'],\n  'length',\n)\nexport const areaMetricUnits: UnitSystem = new UnitSystem(\n  ['3', '2', '1', '0', '-1', '-2', '-3'],\n  'length',\n  2,\n)\nexport const areaOtherUnits: UnitSystem = new UnitSystem(\n  ['2', '0', '-2'],\n  'area',\n)\nexport const volumeMetricUnits: UnitSystem = new UnitSystem(\n  ['3', '2', '1', '0', '-1', '-2', '-3'],\n  'length',\n  3,\n)\nexport const volumeOtherUnits: UnitSystem = new UnitSystem(\n  ['2', '1', '0', '-1', '-2', '-3'],\n  'volume', // chang de 'content' vers 'volume'\n)\nexport const massUnits: UnitSystem = new UnitSystem(\n  ['3', '2', '1', '0', '-1', '-2', '-3'],\n  'mass',\n)\n","import {\n  areaMetricUnits,\n  areaOtherUnits,\n  lengthUnits,\n  massUnits,\n  volumeMetricUnits,\n  volumeOtherUnits,\n} from './unitsSystem'\n\nconst basicKeys = {\n  // ================== numbers\n  0: { display: '0' },\n  1: { display: '1' },\n  2: { display: '2' },\n  3: { display: '3' },\n  4: { display: '4' },\n  5: { display: '5' },\n  6: { display: '6' },\n  7: { display: '7' },\n  8: { display: '8' },\n  9: { display: '9' },\n  // ================== operations\n  ADD: {\n    display: '+',\n    insert: '+',\n  },\n  SUB: {\n    display: '',\n    insert: '-',\n  },\n  MULT: {\n    display: '$\\\\times$',\n    insert: '\\\\times',\n  },\n  DIV: {\n    display: '$\\\\div$',\n    insert: '\\\\div',\n  },\n  FRAC: {\n    display: '$\\\\frac{\\\\square}{\\\\square}$',\n    insert: '\\\\frac{#@}{#1}',\n  },\n  SQRT: {\n    display: '$\\\\sqrt{\\\\square}$',\n    insert: '\\\\sqrt{#1}',\n  },\n  NORM: {\n    display: '$\\\\vert\\\\square\\\\vert$',\n    insert: '\\\\vert#0\\\\vert',\n  },\n  SQRTN: {\n    display: '$\\\\sqrt[\\\\square]{\\\\square}$',\n    insert: '\\\\sqrt[#1]{#2}',\n  },\n  SQ: {\n    display: '$\\\\square^2$',\n    insert: '^2',\n  },\n  CUBE: {\n    display: '$x^3$',\n    insert: '^3',\n  },\n  POW: {\n    display: '$\\\\square^\\\\square$',\n    insert: '#@^{#0}',\n  },\n  'e^': {\n    display: '$\\\\mathrm{e}^{\\\\square}$',\n    insert: '\\\\mathrm{e}^{#0}',\n  },\n  LOG: {\n    display: '$\\\\log(\\\\square)$',\n    insert: '\\\\log(#0)',\n  },\n  LN: {\n    display: '$\\\\ln(\\\\square)$',\n    insert: '\\\\ln(#0)',\n  },\n  POW10: {\n    display: '$\\\\times10^\\\\square$',\n    insert: '$$\\\\times10^#0$$',\n  },\n  // ================== suites\n\n  INDICE: {\n    display: '$\\\\square_\\\\square$',\n    insert: '#@_{#0}',\n  },\n  INDICE_N: {\n    display: '$\\\\square_{n}$',\n    insert: '#@_{n}',\n  },\n  U_INDICE_N: {\n    display: '$u_{n}$',\n    insert: 'u_{n}',\n  },\n  V_INDICE_N: {\n    display: '$v_{n}$',\n    insert: 'v_{n}',\n  },\n  W_INDICE_N: {\n    display: '$w_{n}$',\n    insert: 'w_{n}',\n  },\n  C_INDICE_N: {\n    display: '$c_{n}$',\n    insert: 'c_{n}',\n  },\n\n  // ================== functions\n  COS: {\n    display: 'cos',\n    insert: '\\\\cos(#0)',\n  },\n  SIN: {\n    display: 'sin',\n    insert: '\\\\sin(#0)',\n  },\n  TAN: {\n    display: 'tan',\n    insert: '\\\\tan(#0)',\n  },\n  // ================== symbols\n  COMMA: {\n    display: ',',\n    insert: '{,}',\n  },\n  POINT: {\n    display: '.',\n  },\n  SPACE: {\n    display: '$\\\\tiny\\\\text{espace}$',\n    insert: '\\\\,',\n  },\n  '(': {\n    display: '(',\n    insert: '\\\\lparen',\n  },\n  ')': {\n    display: ')',\n    insert: '\\\\rparen',\n  },\n  PARENTHESES: {\n    display: '$(\\\\square)$',\n    insert: '\\\\lparen#0\\\\rparen',\n  },\n  '{': {\n    display: '{',\n    insert: '$$\\\\{$$',\n  },\n  '}': {\n    display: '}',\n    insert: '$$\\\\}$$',\n  },\n  '[': {\n    display: '[',\n    insert: '$[$',\n  },\n  ']': {\n    display: ']',\n    insert: '$]$',\n  },\n  '=': {\n    display: '=',\n  },\n  DEG: {\n    display: '',\n  },\n  DEGCELSIUS: {\n    display: 'C',\n    insert: 'C',\n  },\n  ANG: {\n    display: '$\\\\widehat{\\\\square}$',\n    insert: '$$\\\\widehat{#0}$$',\n  },\n  PERCENT: {\n    display: '%',\n    insert: '\\\\%',\n  },\n  COLON: {\n    display: ':',\n  },\n  SEMICOLON: {\n    display: ';',\n  },\n  LESS: {\n    display: '<',\n  },\n  GREAT: {\n    display: '>',\n  },\n  LESSEQ: {\n    display: '$\\\\leqslant$',\n    insert: '$$\\\\leqslant$$',\n  },\n  GREATEQ: {\n    display: '$\\\\geqslant$',\n    insert: '$$\\\\geqslant$$',\n  },\n  IN: {\n    display: '$\\\\in$',\n    insert: '$$\\\\in$$',\n  },\n  AST: {\n    display: '*',\n    insert: '$$\\\\ast$$',\n  },\n  SLASH: {\n    display: '/',\n    insert: '\\\\slash',\n  },\n  BACKSLASH: {\n    display: '\\\\',\n    insert: '\\\\backslash',\n  },\n  QUOTE: {\n    display: \"'\",\n    insert: \"{\\\\:\\\\text{'}\\\\:}\",\n  },\n  DBLQUOTE: {\n    display: '\"',\n    insert: '{\\\\:\\\\text{\"}\\\\:}',\n  },\n  INTPOINT: {\n    display: '?',\n    insert: '{\\\\:\\\\text{?}\\\\:}',\n  },\n  EXCPOINT: {\n    display: '!',\n    insert: '{\\\\:\\\\text{!}\\\\:}',\n  },\n  AROBASE: {\n    display: '@',\n    insert: '{\\\\:\\\\text{@}\\\\:}',\n  },\n  HASH: {\n    display: '#',\n    insert: '{\\\\:\\\\text{#}\\\\:}',\n  },\n  DOLLAR: {\n    display: '$',\n    insert: '{\\\\:\\\\text{\\\\$}\\\\:}',\n  },\n  AND: {\n    display: '&',\n    insert: '{\\\\:\\\\text{\\\\&}\\\\:}',\n  },\n  OR: {\n    display: '|',\n    insert: '{\\\\:\\\\text{|}\\\\:}',\n  },\n  TILDE: {\n    display: '~',\n    insert: '$$\\\\sim$$',\n  },\n  BRACKETS: {\n    display: '$[\\\\square]$',\n    insert: '$$[#0]$$',\n  },\n  BRACES: {\n    display: '$\\\\{\\\\square\\\\}$',\n    insert: '$$\\\\{#0\\\\}$$',\n  },\n  VECT: {\n    display: '$\\\\overrightarrow{\\\\square}$',\n    insert: '$$\\\\overrightarrow#0$$',\n  },\n  INFTY: {\n    display: '$\\\\infty$',\n    insert: '\\\\infty',\n  },\n  // ================== letters\n  a: { display: 'a' },\n  b: { display: 'b' },\n  c: { display: 'c' },\n  d: { display: 'd' },\n  e: { display: 'e' },\n  f: { display: 'f' },\n  g: { display: 'g' },\n  h: { display: 'h' },\n  i: { display: 'i' },\n  iComplex: { display: 'i', insert: '\\\\mathrm{i}' },\n  j: { display: 'j' },\n  k: { display: 'k' },\n  l: { display: 'l' },\n  m: { display: 'm' },\n  n: { display: 'n' },\n  o: { display: 'o' },\n  p: { display: 'p' },\n  q: { display: 'q' },\n  r: { display: 'r' },\n  s: { display: 's' },\n  t: { display: 't' },\n  u: { display: 'u' },\n  v: { display: 'v' },\n  w: { display: 'w' },\n  x: { display: 'x' },\n  y: { display: 'y' },\n  z: { display: 'z' },\n  A: { display: 'A' },\n  B: { display: 'B' },\n  C: { display: 'C' },\n  D: { display: 'D' },\n  E: { display: 'E' },\n  F: { display: 'F' },\n  G: { display: 'G' },\n  H: { display: 'H' },\n  I: { display: 'I' },\n  J: { display: 'J' },\n  K: { display: 'K' },\n  L: { display: 'L' },\n  M: { display: 'M' },\n  N: { display: 'N' },\n  O: { display: 'O' },\n  P: { display: 'P' },\n  Q: { display: 'Q' },\n  R: { display: 'R' },\n  S: { display: 'S' },\n  T: { display: 'T' },\n  U: { display: 'U' },\n  V: { display: 'V' },\n  W: { display: 'W' },\n  X: { display: 'X' },\n  Y: { display: 'Y' },\n  Z: { display: 'Z' },\n  // ================== maths letters\n  xMath: { display: '$x$', insert: 'x' },\n  yMath: { display: '$y$', insert: 'y' },\n  zMath: { display: '$z$', insert: 'z' },\n  aMath: { display: '$a$', insert: 'a' },\n  bMath: { display: '$b$', insert: 'b' },\n  cMath: { display: '$c$', insert: 'c' },\n  iMath: { display: '$i$', insert: 'i' },\n  kMath: { display: '$k$', insert: 'k' },\n  nMath: { display: '$n$', insert: 'n' },\n  hMath: { display: '$h$', insert: 'h' },\n  // ================== greek letters\n  PI: {\n    display: '$\\\\pi$',\n    insert: '\\\\pi',\n  },\n  ALPHA: {\n    display: '',\n    insert: '\\\\alpha',\n  },\n  BETA: {\n    display: '',\n    insert: '\\\\beta',\n  },\n  GAMMA: {\n    display: '',\n    insert: '\\\\gamma',\n  },\n  DELTA: {\n    display: '',\n    insert: '\\\\delta',\n  },\n  EPSILON: {\n    display: '',\n    insert: '\\\\epsilon',\n  },\n  THETA: {\n    display: '',\n    insert: '\\\\theta',\n  },\n  LAMBDA: {\n    display: '',\n    insert: '\\\\lambda',\n  },\n  OMEGA: {\n    display: '',\n    insert: '\\\\omega',\n  },\n  // ================== hours, minutes, secondes\n  WEEK: {\n    display: '$\\\\tiny\\\\text{semaines}$',\n    insert: '{\\\\:\\\\text{semaines}\\\\:}',\n  },\n  DAY: { display: 'j', insert: '{\\\\:\\\\text{j}\\\\:}' },\n  HOUR: { display: 'h', insert: '{\\\\:\\\\text{h}\\\\:}' },\n  MIN: { display: 'min', insert: '{\\\\:\\\\text{min}\\\\:}' },\n  SEC: { display: 's', insert: '{\\\\:\\\\text{s}\\\\:}' },\n  // ================== special keys\n  BACK: {\n    display: '<i class=\"bx bx-arrow-back\"/>',\n    command: ['performWithFeedback', 'moveToPreviousChar'],\n  },\n  FWD: {\n    display: '<i class=\"bx bx-arrow-back bx-rotate-180\"/>',\n    command: ['performWithFeedback', 'moveToNextChar'],\n  },\n  CLOSE: {\n    display: '<i class=\"bx bx-window-close\"/>',\n    command: 'closeKeyboard',\n  },\n  DEL: {\n    display: '',\n    command: ['performWithFeedback', 'deleteBackward'],\n  },\n  ABC: {\n    display: 'ABC',\n  },\n  abc: {\n    display: 'abc',\n  },\n  NUM: {\n    display: '?123',\n  },\n  // =================== sets\n  COMP: {\n    display: '$\\\\mathbb{C}$',\n    insert: '\\\\mathbb{C}',\n  },\n  REAL: {\n    display: '$\\\\mathbb{R}$',\n    insert: '\\\\mathbb{R}',\n  },\n  RATIO: {\n    display: '$\\\\mathbb{Q}$',\n    insert: '\\\\mathbb{Q}',\n  },\n  DECIMAL: {\n    display: '$\\\\mathbb{D}$',\n    insert: '\\\\mathbb{D}',\n  },\n  REL: {\n    display: '$\\\\mathbb{Z}$',\n    insert: '\\\\mathbb{Z}',\n  },\n  INTEG: {\n    display: '$\\\\mathbb{N}$',\n    insert: '\\\\mathbb{N}',\n  },\n  EMPTY: {\n    display: '$\\\\emptyset$',\n    insert: '\\\\emptyset',\n  },\n  UNION: {\n    display: '$\\\\cup$',\n    insert: '\\\\cup',\n  },\n  INTER: {\n    display: '$\\\\cap$',\n    insert: '\\\\cap',\n  },\n  // =================== functions\n  LIM: {\n    display: '$\\\\lim\\\\limits_{\\\\square\\\\to\\\\square}$',\n    insert: '$$\\\\lim_{#0\\\\to\\\\ #1}}$$',\n  },\n  FCT: {\n    display: '$f(\\\\square)$',\n    insert: '$$f(#0)$$',\n  },\n  SIGMA: {\n    display: '$\\\\sum\\\\limits_{\\\\square}^{\\\\square}$',\n    insert: '$$\\\\sum_#0^#1$$',\n  },\n  INT: {\n    display: '$\\\\int_{\\\\square}^{\\\\square}$',\n    insert: '$$\\\\int_#0^#1$$',\n  },\n  // =================== probabilities\n  BINOM: {\n    display: '$\\\\tbinom{\\\\square}{\\\\square}$',\n    insert: '$$\\\\tbinom{#0}{#1}$$',\n  },\n  PROB: {\n    display: '$P_{\\\\square}({\\\\square})$',\n    insert: '$$P_{#0}({#1})$$',\n  },\n  OVERLINE: {\n    display: '$\\\\overline{\\\\square}$',\n    insert: '$$\\\\overline{#0}$$',\n  },\n  Vrai: {\n    display: '$\\\\text{Vrai}$',\n    insert: '\\\\text{Vrai}',\n  },\n  Faux: {\n    display: '$\\\\text{Faux}$',\n    insert: '\\\\text{Faux}',\n  },\n  // =================== numration\n  MILLION: {\n    display: '$\\\\tiny\\\\text{million}$',\n    insert: '\\\\text{million}',\n  },\n  MILLIARD: {\n    display: '$\\\\tiny\\\\text{milliard}$',\n    insert: '\\\\text{milliard}',\n  },\n  MILLE: {\n    display: '$\\\\tiny\\\\text{mille}$',\n    insert: '\\\\text{mille}',\n  },\n  CENTAINE: {\n    display: '$\\\\tiny\\\\text{centaine}$',\n    insert: '\\\\text{centaine}',\n  },\n  DIZAINE: {\n    display: '$\\\\tiny\\\\text{dizaine}$',\n    insert: '\\\\text{dizaine}',\n  },\n  UNITE: {\n    display: '$\\\\tiny\\\\text{unit}$',\n    insert: '\\\\text{unit}',\n  },\n  DE: {\n    display: '$\\\\tiny\\\\text{ de }$',\n    insert: '\\\\text{ de }',\n  },\n  DIXIEME: {\n    display: '$\\\\tiny\\\\text{dixime}$',\n    insert: '\\\\text{dixime}',\n  },\n  CENTIEME: {\n    display: '$\\\\tiny\\\\text{centime}$',\n    insert: '\\\\text{centime}',\n  },\n  MILLIEME: {\n    display: '$\\\\tiny\\\\text{millime}$',\n    insert: '\\\\text{millime}',\n  },\n  DIX_MILLIEME: {\n    display: '$\\\\tiny\\\\text{dix-millime}$',\n    insert: '\\\\text{dix-millime}',\n  },\n  CENT_MILLIEME: {\n    display: '$\\\\tiny\\\\text{cent-millime}$',\n    insert: '\\\\text{cent-millime}',\n  },\n  MILLIONIEME: {\n    display: '$\\\\tiny\\\\text{millionime}$',\n    insert: '\\\\text{millionime}',\n  },\n  HYPHEN: {\n    display: '$\\\\tiny\\\\text{-}$',\n    insert: '\\\\text{-}',\n  },\n  DIX: {\n    display: '$\\\\tiny\\\\text{dix}$',\n    insert: '\\\\text{dix}',\n  },\n  VINGT: {\n    display: '$\\\\tiny\\\\text{vingt}$',\n    insert: '\\\\text{vingt}',\n  },\n  TRENTE: {\n    display: '$\\\\tiny\\\\text{trente}$',\n    insert: '\\\\text{trente}',\n  },\n  QUARANTE: {\n    display: '$\\\\tiny\\\\text{quarante}$',\n    insert: '\\\\text{quarante}',\n  },\n  CINQUANTE: {\n    display: '$\\\\tiny\\\\text{cinquante}$',\n    insert: '\\\\text{cinquante}',\n  },\n  SOIXANTE: {\n    display: '$\\\\tiny\\\\text{soixante}$',\n    insert: '\\\\text{soixante}',\n  },\n  SOIXANTE_DIX: {\n    display: '$\\\\tiny\\\\text{soixante-dix}$',\n    insert: '\\\\text{soixante-dix}',\n  },\n  QUATRE_VINGT: {\n    display: '$\\\\tiny\\\\text{quatre-vingt}$',\n    insert: '\\\\text{quatre-vingt}',\n  },\n  QUATRE_VINGT_DIX: {\n    display: '$\\\\tiny\\\\text{quatre-vingt-dix}$',\n    insert: '\\\\text{quatre-vingt-dix}',\n  },\n  CENT: {\n    display: '$\\\\tiny\\\\text{cent}$',\n    insert: '\\\\text{cent}',\n  },\n}\n\nconst massUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of massUnits.units) {\n  const k = `MASS ${unit.symbol}`\n  massUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst lengthUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of lengthUnits.units) {\n  const k = `LENGTH ${unit.symbol}`\n  lengthUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst areaUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of [...areaMetricUnits.units, ...areaOtherUnits.units]) {\n  const k = `AREA ${unit.symbol}`\n  areaUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst volumeUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of volumeMetricUnits.units) {\n  const k = `VOLUME' ${unit.symbol}`\n  volumeUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst capacityUnitsKeys: Record<string, { display: string; insert: string }> =\n  {}\nfor (const unit of volumeOtherUnits.units) {\n  const k = `CAPACITY ${unit.symbol}`\n  capacityUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nexport const keys = {\n  ...basicKeys,\n  ...lengthUnitsKeys,\n  ...massUnitsKeys,\n  ...areaUnitsKeys,\n  ...volumeUnitsKeys,\n  ...capacityUnitsKeys,\n}\n","import { keys } from '../lib/keycaps'\nimport type {\n  BlockForKeyboard,\n  CompleteKeysList,\n  KeyboardBlock,\n  KeysList,\n} from '../types/keyboardContent'\n\n// Keycaps lists\nexport const specialKeysCaps: CompleteKeysList = {\n  inline: ['BACK', 'FWD', 'DEL', 'CLOSE'],\n  block: ['BACK', 'FWD', 'DEL', 'CLOSE'],\n}\nconst numbersCaps: CompleteKeysList = {\n  inline: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'COMMA', 'PI'],\n  block: [7, 8, 9, 4, 5, 6, 1, 2, 3, 0, 'COMMA', 'PI'],\n}\nconst complexesCap: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'iComplex',\n    'ADD',\n    'SUB',\n    'FRAC',\n    'POW',\n    'PI',\n    'COMMA',\n    'PARENTHESES',\n    'SQRT',\n    'e^',\n    'COS',\n    'SIN',\n    'THETA',\n    'NORM',\n  ],\n  block: [\n    7,\n    8,\n    9,\n    'iComplex',\n    'FRAC',\n    'COS',\n    4,\n    5,\n    6,\n    'ADD',\n    'POW',\n    'SIN',\n    1,\n    2,\n    3,\n    'SUB',\n    'PI',\n    'THETA',\n    0,\n    'COMMA',\n    'PARENTHESES',\n    'SQRT',\n    'e^',\n    'NORM',\n  ],\n}\nconst numbersCaps2: CompleteKeysList = {\n  inline: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'COMMA', '='],\n  block: [7, 8, 9, 4, 5, 6, 1, 2, 3, 0, 'COMMA', '='],\n}\nconst numbersCapsX: CompleteKeysList = {\n  inline: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'COMMA', 'xMath'],\n  block: [7, 8, 9, 4, 5, 6, 1, 2, 3, 0, 'COMMA', 'xMath'],\n}\nconst numbersOperationsCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'PI',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    7,\n    8,\n    9,\n    'DIV',\n    4,\n    5,\n    6,\n    'MULT',\n    1,\n    2,\n    3,\n    'SUB',\n    0,\n    'COMMA',\n    'PI',\n    'ADD',\n  ],\n}\nconst limitesCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'INFTY',\n    'FRAC',\n    'SQRT',\n    'e^',\n    'LN',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    'FRAC',\n    'ADD',\n    7,\n    8,\n    9,\n    'SQRT',\n    'SUB',\n    4,\n    5,\n    6,\n    'e^',\n    'MULT',\n    1,\n    2,\n    3,\n    'LN',\n    'DIV',\n    'INFTY',\n    0,\n    'COMMA',\n  ],\n}\nconst numbersOperationsXCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'xMath',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    7,\n    8,\n    9,\n    'DIV',\n    4,\n    5,\n    6,\n    'MULT',\n    1,\n    2,\n    3,\n    'SUB',\n    0,\n    'COMMA',\n    'xMath',\n    'ADD',\n  ],\n}\nconst numbersSpaceCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'SPACE',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    1,\n    2,\n    3,\n    'DIV',\n    4,\n    5,\n    6,\n    'MULT',\n    7,\n    8,\n    9,\n    'SUB',\n    0,\n    'COMMA',\n    'SPACE',\n    'ADD',\n  ],\n}\nconst variableCaps: CompleteKeysList = {\n  inline: [\n    'aMath',\n    'bMath',\n    'cMath',\n    'xMath',\n    'yMath',\n    'zMath',\n    'kMath',\n    'nMath',\n    'iMath',\n    'hMath',\n    'V',\n    'F',\n  ],\n  block: [\n    'aMath',\n    'xMath',\n    'kMath',\n    'bMath',\n    'yMath',\n    'nMath',\n    'cMath',\n    'zMath',\n    'iMath',\n    'hMath',\n    'V',\n    'F',\n  ],\n}\nconst basicOperationCaps: CompleteKeysList = {\n  inline: ['ADD', 'SUB', 'MULT', 'DIV', 'SQ', 'FRAC', '(', ')'],\n  block: ['ADD', 'SUB', 'MULT', 'DIV', 'SQ', 'FRAC', '(', ')'],\n}\nconst basicOperationPlusCaps: CompleteKeysList = {\n  inline: [\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    'xMath',\n    'SQ',\n    'POW',\n    'FRAC',\n    '(',\n    ')',\n    'BRACKETS',\n    'SEMICOLON',\n  ],\n  block: [\n    'xMath',\n    'ADD',\n    'SUB',\n    'SQ',\n    'MULT',\n    'DIV',\n    'POW',\n    'BRACKETS',\n    'FRAC',\n    'SEMICOLON',\n    '(',\n    ')',\n  ],\n}\nconst basicOperationCaps2: CompleteKeysList = {\n  inline: ['ADD', 'SUB', 'MULT', 'DIV', '=', 'FRAC', '(', ')'],\n  block: ['ADD', 'SUB', 'MULT', 'DIV', '=', 'FRAC', '(', ')'],\n}\nconst fullOperationCaps: CompleteKeysList = {\n  inline: [\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    'FRAC',\n    '=',\n    '(',\n    ')',\n    'xMath',\n    'SQRT',\n    'SQ',\n    'POW',\n    'POW10',\n    'DEG',\n    'PERCENT',\n    'SEMICOLON',\n  ],\n  block: [\n    'ADD',\n    'SUB',\n    'xMath',\n    'DEG',\n    'MULT',\n    'DIV',\n    'SQ',\n    'SQRT',\n    '(',\n    ')',\n    'POW',\n    'PERCENT',\n    '=',\n    'FRAC',\n    'POW10',\n    'SEMICOLON',\n  ],\n}\nconst terminaleCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'LOG',\n    'LN',\n    'POW',\n    'FRAC',\n    'SEMICOLON',\n    'COMMA',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n    'SQRT',\n    'SQRTN',\n    'e^',\n    'INFTY',\n    'PARENTHESES',\n    'POW10',\n    'BRACES',\n    'BRACKETS',\n  ],\n  block: [\n    'SQRT',\n    'SQRTN',\n    'LN',\n    'LOG',\n    7,\n    8,\n    9,\n    'POW',\n    'e^',\n    'FRAC',\n    'INFTY',\n    4,\n    5,\n    6,\n    'POW10',\n    'PARENTHESES',\n    'BRACES',\n    'xMath',\n    1,\n    2,\n    3,\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    0,\n    'COMMA',\n    'SEMICOLON',\n  ],\n}\n\nconst numerationCaps: CompleteKeysList = {\n  inline: [\n    'MILLIARD',\n    'MILLION',\n    'MILLE',\n    'CENTAINE',\n    'DIZAINE',\n    'UNITE',\n    'DE',\n    'DIXIEME',\n    'CENTIEME',\n    'MILLIEME',\n    'DIX_MILLIEME',\n    'CENT_MILLIEME',\n    'MILLIONIEME',\n    'HYPHEN',\n    'DIX',\n    'VINGT',\n    'TRENTE',\n    'QUARANTE',\n    'CINQUANTE',\n    'SOIXANTE',\n    'SOIXANTE_DIX',\n    'QUATRE_VINGT',\n    'QUATRE_VINGT_DIX',\n    'CENT',\n  ],\n  block: [\n    'MILLIARD',\n    'MILLION',\n    'MILLE',\n    'CENTAINE',\n    'DIZAINE',\n    'UNITE',\n    'DE',\n    'DIXIEME',\n    'CENTIEME',\n    'MILLIEME',\n    'DIX_MILLIEME',\n    'CENT_MILLIEME',\n    'MILLIONIEME',\n    'HYPHEN',\n    'DIX',\n    'VINGT',\n    'TRENTE',\n    'QUARANTE',\n    'CINQUANTE',\n    'SOIXANTE',\n    'SOIXANTE_DIX',\n    'QUATRE_VINGT',\n    'QUATRE_VINGT_DIX',\n    'CENT',\n  ],\n}\n\nconst probabiliteCaps: CompleteKeysList = {\n  inline: [\n    'PROB',\n    'BINOM',\n    'OVERLINE',\n    'UNION',\n    'INTER',\n    'EMPTY',\n    'SEMICOLON',\n    'PARENTHESES',\n    'POW',\n    'INDICE',\n    'QUOTE',\n    '=',\n  ],\n  block: [\n    'PROB',\n    'BINOM',\n    'OVERLINE',\n    'UNION',\n    'INTER',\n    'EMPTY',\n    'SEMICOLON',\n    'PARENTHESES',\n    'POW',\n    'INDICE',\n    'QUOTE',\n    '=',\n  ],\n}\n\nconst ensembleCaps: CompleteKeysList = {\n  inline: [\n    'ADD',\n    'SUB',\n    'INFTY',\n    'BRACES',\n    '[',\n    ']',\n    'IN',\n    'SEMICOLON',\n    'FRAC',\n    'SQRT',\n    'POW',\n    'POW10',\n  ],\n  block: [\n    'ADD',\n    'SUB',\n    'INFTY',\n    'BRACES',\n    '[',\n    ']',\n    'IN',\n    'SEMICOLON',\n    'FRAC',\n    'SQRT',\n    'POW',\n    'POW10',\n  ],\n}\n\nconst ensembleDefiniCaps: CompleteKeysList = {\n  inline: [\n    'COMP',\n    'REAL',\n    'RATIO',\n    'DECIMAL',\n    'REL',\n    'INTEG',\n    'EMPTY',\n    'UNION',\n    'INTER',\n    'BACKSLASH',\n  ],\n  block: [\n    'COMP',\n    'REAL',\n    'RATIO',\n    'DECIMAL',\n    'REL',\n    'INTEG',\n    'EMPTY',\n    'UNION',\n    'INTER',\n    'BACKSLASH',\n  ],\n}\n\nconst suiteCaps: CompleteKeysList = {\n  inline: [\n    'U_INDICE_N',\n    'V_INDICE_N',\n    'W_INDICE_N',\n    'C_INDICE_N',\n    'nMath',\n    'kMath',\n    'INDICE_N',\n    'INDICE',\n  ],\n  block: [\n    'U_INDICE_N',\n    'V_INDICE_N',\n    'W_INDICE_N',\n    'C_INDICE_N',\n    'nMath',\n    'kMath',\n    'INDICE_N',\n    'INDICE',\n  ],\n}\n\nconst hmsCaps: CompleteKeysList = {\n  inline: ['WEEK', 'DAY', 'HOUR', 'MIN', 'SEC'],\n  block: ['WEEK', 'DAY', 'HOUR', 'MIN', 'SEC'],\n}\n\nconst greekCaps: CompleteKeysList = {\n  inline: [\n    'ALPHA',\n    'BETA',\n    'GAMMA',\n    'DELTA',\n    'EPSILON',\n    'THETA',\n    'LAMBDA',\n    'OMEGA',\n  ],\n  block: [\n    'ALPHA',\n    'BETA',\n    'GAMMA',\n    'DELTA',\n    'EPSILON',\n    'THETA',\n    'LAMBDA',\n    'OMEGA',\n  ],\n}\n\nconst compareCaps: CompleteKeysList = {\n  inline: ['LESS', 'GREAT', '=', 'LESSEQ', 'GREATEQ'],\n  block: ['LESS', 'GREAT', '=', 'LESSEQ', 'GREATEQ'],\n}\n\nconst degreCaps: CompleteKeysList = {\n  inline: ['DEG'],\n  block: ['DEG'],\n}\n\nconst degreCelsiusCaps: CompleteKeysList = {\n  inline: ['DEGCELSIUS'],\n  block: ['DEGCELSIUS'],\n}\n\nconst trigoCaps: CompleteKeysList = {\n  inline: ['COS', 'SIN', 'TAN', 'ANG'],\n  block: ['COS', 'SIN', 'TAN', 'ANG'],\n}\n\nconst advancedCaps: CompleteKeysList = {\n  inline: [\n    'FCT',\n    'LIM',\n    'INT',\n    'SIGMA',\n    'BINOM', //\n    'UNION',\n    'INTER',\n    'INFTY',\n    'EMPTY',\n    'PROB', //\n    'VECT',\n    'BRACKETS',\n    'BRACES',\n    'LESSEQ',\n    'GREATEQ', //\n    'COMP',\n    'REAL',\n    'RATIO',\n    'REL',\n    'INTEG',\n  ],\n  block: [\n    'FCT',\n    'LIM',\n    'INT',\n    'SIGMA',\n    'BINOM', //\n    'UNION',\n    'INTER',\n    'INFTY',\n    'EMPTY',\n    'PROB', //\n    'VECT',\n    'BRACKETS',\n    'BRACES',\n    'LESSEQ',\n    'GREATEQ', //\n    'COMP',\n    'REAL',\n    'RATIO',\n    'REL',\n    'INTEG',\n  ],\n}\n\nconst anglesCaps: CompleteKeysList = {\n  inline: ['ANG', 'DEG', 'QUOTE', '='],\n  block: ['ANG', 'DEG', 'QUOTE', '='],\n}\n\nconst aToHCaps: CompleteKeysList = {\n  inline: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],\n  block: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],\n}\n\nconst iToPCaps: CompleteKeysList = {\n  inline: ['I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'],\n  block: ['I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'],\n}\n\nconst qToWCaps: CompleteKeysList = {\n  inline: ['Q', 'R', 'S', 'T', 'U', 'V', 'W'],\n  block: ['Q', 'R', 'S', 'T', 'U', 'V', 'W'],\n}\n\nconst xToZCaps: CompleteKeysList = {\n  inline: ['X', 'Y', 'Z'],\n  block: ['X', 'Y', 'Z'],\n}\n\nconst vFONCaps: CompleteKeysList = {\n  inline: ['V', 'F', 'O', 'N'],\n  block: ['V', 'F', 'O', 'N'],\n}\n\nconst eosnCaps: CompleteKeysList = {\n  inline: ['O', 'E', 'S', 'N', 'DEG', 'SEMICOLON'],\n  block: ['O', 'E', 'S', 'N', 'DEG', 'SEMICOLON'],\n}\n\nconst lengthUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('LENGTH'))\n  .reduce(\n    (prev, k) => Object.assign(prev, { [k]: keys[k as keyof typeof keys] }),\n    {} as Partial<typeof keys>,\n  )\n\nconst lengthsCaps: CompleteKeysList = {\n  inline: Object.keys(lengthUnitsKeys) as KeysList,\n  block: Object.keys(lengthUnitsKeys) as KeysList,\n}\n\nconst areasUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('AREA'))\n  .reduce(\n    (prev, k) => Object.assign(prev, { [k]: keys[k as keyof typeof keys] }),\n    {},\n  )\nconst areasCaps: CompleteKeysList = {\n  inline: Object.keys(areasUnitsKeys) as KeysList,\n  block: Object.keys(areasUnitsKeys) as KeysList,\n}\n\nconst volumesUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('VOLUME'))\n  .reduce(\n    (prev, k) => Object.assign(prev, { [k]: keys[k as keyof typeof keys] }),\n    {},\n  )\nconst volumesCaps: CompleteKeysList = {\n  inline: Object.keys(volumesUnitsKeys) as KeysList,\n  block: Object.keys(volumesUnitsKeys) as KeysList,\n}\n\nconst capacitiesUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('CAPACITY'))\n  .reduce(\n    (prev, k) => Object.assign(prev, { [k]: keys[k as keyof typeof keys] }),\n    {},\n  )\nconst capacitiesCaps: CompleteKeysList = {\n  inline: Object.keys(capacitiesUnitsKeys) as KeysList,\n  block: Object.keys(capacitiesUnitsKeys) as KeysList,\n}\n\nconst massesUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('MASS'))\n  .reduce(\n    (prev, k) => Object.assign(prev, { [k]: keys[k as keyof typeof keys] }),\n    {},\n  )\nconst massesCaps: CompleteKeysList = {\n  inline: Object.keys(massesUnitsKeys) as KeysList,\n  block: Object.keys(massesUnitsKeys) as KeysList,\n}\n\nexport const specialKeys: KeyboardBlock = {\n  keycaps: specialKeysCaps,\n  cols: 1,\n  title: 'Touches spciales',\n  isUnits: false,\n}\n\nexport const complexes: KeyboardBlock = {\n  keycaps: complexesCap,\n  cols: 6,\n  title: 'Nombres complexes',\n  isUnits: false,\n}\n\nexport const numbers: KeyboardBlock = {\n  keycaps: numbersCaps,\n  cols: 3,\n  title: 'Nombres',\n  isUnits: false,\n}\nexport const numbersX: KeyboardBlock = {\n  keycaps: numbersCapsX,\n  cols: 3,\n  title: 'Nombres',\n  isUnits: false,\n}\nexport const numbers2: KeyboardBlock = {\n  keycaps: numbersCaps2,\n  cols: 3,\n  title: 'Nombres',\n  isUnits: false,\n}\nexport const numbersOperations: KeyboardBlock = {\n  keycaps: numbersOperationsCaps,\n  cols: 4,\n  title: 'Nombres+Oprations',\n  isUnits: false,\n}\n\nexport const numbersOperationsX: KeyboardBlock = {\n  keycaps: numbersOperationsXCaps,\n  cols: 4,\n  title: 'Nombres+Oprations',\n  isUnits: false,\n}\n\nexport const limites: KeyboardBlock = {\n  keycaps: limitesCaps,\n  cols: 5,\n  title: 'Clavier pour les Limites',\n  isUnits: false,\n}\n\nexport const numbersSpace: KeyboardBlock = {\n  keycaps: numbersSpaceCaps,\n  cols: 4,\n  title: 'Nombres',\n  isUnits: false,\n}\n\nexport const variables: KeyboardBlock = {\n  keycaps: variableCaps,\n  cols: 3,\n  title: 'Variables',\n  isUnits: false,\n}\n\nexport const vFON: KeyboardBlock = {\n  keycaps: vFONCaps,\n  cols: 1,\n  title: 'Vrai/Faux/Impossible',\n  isUnits: false,\n}\n\nexport const basicOperations: KeyboardBlock = {\n  keycaps: basicOperationCaps,\n  cols: 2,\n  title: 'Oprations de base',\n  isUnits: false,\n}\n\nexport const basicOperations2: KeyboardBlock = {\n  keycaps: basicOperationCaps2,\n  cols: 2,\n  title: 'Oprations de base',\n  isUnits: false,\n}\n\nexport const basicOperationsPlus: KeyboardBlock = {\n  keycaps: basicOperationPlusCaps,\n  cols: 3,\n  title: 'Oprations de base',\n  isUnits: false,\n}\n\nexport const fullOperations: KeyboardBlock = {\n  keycaps: fullOperationCaps,\n  cols: 4,\n  title: 'Oprations complexes',\n  isUnits: false,\n}\n\nexport const clavierFonctionsTerminales: KeyboardBlock = {\n  keycaps: terminaleCaps,\n  cols: 7,\n  title: 'Fonctions de Terminales',\n  isUnits: false,\n}\n\nexport const numeration: KeyboardBlock = {\n  keycaps: numerationCaps,\n  cols: 6,\n  title: 'Logarithme et puissance',\n  isUnits: false,\n}\n\nexport const probabilite: KeyboardBlock = {\n  keycaps: probabiliteCaps,\n  cols: 3,\n  title: 'Probabilits',\n  isUnits: false,\n}\n\nexport const hms: KeyboardBlock = {\n  keycaps: hmsCaps,\n  cols: 1,\n  title: 'Temps',\n  isUnits: true,\n}\n\nexport const greek: KeyboardBlock = {\n  keycaps: greekCaps,\n  cols: 2,\n  title: 'Lettres grecques',\n  isUnits: false,\n}\n\nexport const compare: KeyboardBlock = {\n  keycaps: compareCaps,\n  cols: 3,\n  title: 'Comparaison',\n  isUnits: false,\n}\n\nexport const degre: KeyboardBlock = {\n  keycaps: degreCaps,\n  cols: 1,\n  title: 'Degr',\n  isUnits: true,\n}\n\nexport const degreCelsius: KeyboardBlock = {\n  keycaps: degreCelsiusCaps,\n  cols: 1,\n  title: 'Degr Celsius',\n  isUnits: true,\n}\n\nexport const trigo: KeyboardBlock = {\n  keycaps: trigoCaps,\n  cols: 1,\n  title: 'Trigonomtrie',\n  isUnits: false,\n}\nexport const advanced: KeyboardBlock = {\n  keycaps: advancedCaps,\n  cols: 5,\n  title: 'Fonctions avances',\n  isUnits: false,\n}\n\nexport const lengths: KeyboardBlock = {\n  keycaps: lengthsCaps,\n  cols: 2,\n  title: 'Longueurs',\n  isUnits: true,\n}\n\nexport const areas: KeyboardBlock = {\n  keycaps: areasCaps,\n  cols: 3,\n  title: 'Aires',\n  isUnits: true,\n}\n\nexport const ensemble: KeyboardBlock = {\n  keycaps: ensembleCaps,\n  cols: 3,\n  title: 'Ensembles',\n  isUnits: false,\n}\n\nexport const ensembleDefini: KeyboardBlock = {\n  keycaps: ensembleDefiniCaps,\n  cols: 3,\n  title: 'EnsemblesDefinis',\n  isUnits: false,\n}\n\nexport const suite: KeyboardBlock = {\n  keycaps: suiteCaps,\n  cols: 2,\n  title: 'Suites',\n  isUnits: false,\n}\n\nexport const volumes: KeyboardBlock = {\n  keycaps: volumesCaps,\n  cols: 2,\n  title: 'Volumes',\n  isUnits: true,\n}\n\nexport const capacities: KeyboardBlock = {\n  keycaps: capacitiesCaps,\n  cols: 2,\n  title: 'Capacits',\n  isUnits: true,\n}\n\nexport const masses: KeyboardBlock = {\n  keycaps: massesCaps,\n  cols: 2,\n  title: 'Masses',\n  isUnits: true,\n}\n\nexport const angles: KeyboardBlock = {\n  keycaps: anglesCaps,\n  cols: 1,\n  title: 'Angles',\n  isUnits: false,\n}\n\nexport const uppercaseAToH: KeyboardBlock = {\n  keycaps: aToHCaps,\n  cols: 2,\n  title: 'Majuscules: A  H',\n  isUnits: false,\n}\n\nexport const uppercaseIToP: KeyboardBlock = {\n  keycaps: iToPCaps,\n  cols: 2,\n  title: 'Majuscules: I  P',\n  isUnits: false,\n}\n\nexport const uppercaseQToW: KeyboardBlock = {\n  keycaps: qToWCaps,\n  cols: 2,\n  title: 'Majuscules: Q  W',\n  isUnits: false,\n}\n\nexport const uppercaseXToZ: KeyboardBlock = {\n  keycaps: xToZCaps,\n  cols: 1,\n  title: 'Majuscules: X  Z',\n  isUnits: false,\n}\n\nexport const estOuestSudNord: KeyboardBlock = {\n  keycaps: eosnCaps,\n  cols: 2,\n  title: 'Points cardinaux',\n  isUnits: false,\n}\n\nexport const keyboardBlocks: {\n  [key in Exclude<BlockForKeyboard, 'alphanumeric'>]: KeyboardBlock\n} = {\n  advanced,\n  angles,\n  areas,\n  basicOperations,\n  basicOperations2,\n  basicOperationsPlus,\n  capacities,\n  compare,\n  complexes,\n  degre,\n  degreCelsius,\n  ensemble,\n  ensembleDefini,\n  suite,\n  greek,\n  fullOperations,\n  hms,\n  lengths,\n  clavierFonctionsTerminales,\n  masses,\n  numbers,\n  numbersSpace,\n  numbersX,\n  numbers2,\n  numbersOperations,\n  numbersOperationsX,\n  limites,\n  numeration,\n  probabilite,\n  trigo,\n  variables,\n  volumes,\n  vFON,\n  uppercaseAToH,\n  uppercaseIToP,\n  uppercaseQToW,\n  uppercaseXToZ,\n  estOuestSudNord,\n}\n","export const KEYCAP_WIDTH = {\n  sm: 30,\n  md: 40,\n  lg: 60,\n  xl: 80,\n}\nexport const KEYCAP_HEIGHT = {\n  sm: 40,\n  md: 40,\n}\nexport const GAP_BETWEEN_BLOCKS = {\n  sm: 10,\n  md: 15,\n  lg: 15,\n  xl: 15,\n}\nexport const GAP_BETWEEN_KEYS = {\n  sm: 4,\n  md: 8,\n  lg: 8,\n  xl: 8,\n}\n\nexport const SM_BREAKPOINT = 640\nexport const MD_BREAKPOINT = 768\nexport const LG_BREAKPOINT = 1024\nexport const XL_BREAKPOINT = 1280\n\nexport const getMode = function (\n  innerWidth: number,\n  isInLine: boolean,\n): 'sm' | 'md' | 'lg' | 'xl' {\n  if (isInLine) {\n    return innerWidth <= SM_BREAKPOINT ? 'sm' : 'md'\n  }\n  return innerWidth <= SM_BREAKPOINT\n    ? 'sm'\n    : innerWidth <= MD_BREAKPOINT\n      ? 'md'\n      : innerWidth <= LG_BREAKPOINT\n        ? 'lg'\n        : 'xl'\n}\n","import type { KeysList, AlphanumericPages } from '../types/keyboardContent'\n\nconst rowsAlphaLow: KeysList[] = [\n  ['a', 'z', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],\n  ['q', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm'],\n  ['ABC', 'w', 'x', 'c', 'v', 'b', 'n', 'DEL'],\n  ['NUM', 'COMMA', 'SPACE', 'POINT', 'BACK', 'FWD', 'CLOSE'],\n]\nconst rowsAlphaUp: KeysList[] = [\n  ['A', 'Z', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],\n  ['Q', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M'],\n  ['abc', 'W', 'X', 'C', 'V', 'B', 'N', 'DEL'],\n  ['NUM', 'COMMA', 'SPACE', 'POINT', 'BACK', 'FWD', 'CLOSE'],\n]\nconst rowsNum: KeysList[] = [\n  [1, 2, 3, 4, 5, 6, 7, 8, 9, 0],\n  [\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    'FRAC',\n    '=',\n    'COLON',\n    'SEMICOLON',\n    'QUOTE',\n    'DBLQUOTE',\n  ],\n  ['SQ', 'CUBE', 'POW', 'POW10', 'SQRT', 'LESS', 'GREAT', 'AND', 'OR', 'AST'],\n  ['abc', '(', ')', '[', ']', '{', '}', 'INTPOINT', 'EXCPOINT', 'PERCENT'],\n]\n\nexport const alphanumericLayouts: { [key in AlphanumericPages]: KeysList[] } = {\n  AlphaLow: rowsAlphaLow,\n  AlphaUp: rowsAlphaUp,\n  Numeric: rowsNum,\n}\n","import type { Keys } from './keyboardContent'\n\nexport type KeyCap = {\n  display: string\n  insert?: string\n  command?: string | string[]\n}\n\nexport const isSpecialKey = (key: Keys): boolean =>\n  ['DEL', 'CLOSE', 'BACK', 'FWD', 'abc', 'ABC', 'NUM'].includes(key.toString())\nexport const isPageKey = (key: Keys): boolean =>\n  ['abc', 'ABC', 'NUM'].includes(key.toString())\n","<script lang=\"ts\">\n  import { alphanumericLayouts } from '../../layouts/alphanumericRows'\n  import { isSpecialKey } from '../../types/keycap'\n  import { keys } from '../../lib/keycaps'\n  import type { AlphanumericPages, Keys } from '../../types/keyboardContent'\n  import type { KeyCap } from '../../types/keycap'\n  // import type { KeyCap } from '../../types/keycap'\n  export let pageType: AlphanumericPages\n  $: rows = alphanumericLayouts[pageType]\n  export let clickKeycap: (\n    data: KeyCap,\n    event: MouseEvent,\n    value?: Keys,\n  ) => void\n</script>\n\n<div class=\"flex justify-center\">\n  <div\n    class=\"flex flex-col w-2/3 space-y-1 md:space-y-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark\"\n  >\n    {#each rows as row, rowIndex (rowIndex)}\n      <div\n        class=\"flex flex-row w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark justify-evenly space-x-1 md:space-x-4\"\n      >\n        {#each row as key (key)}\n          <button\n            type=\"button\"\n            class=\"key--{key} flex justify-center items-center grow h-10 text-mormal md:text-xl border-b-2 border-r border-r-slate-400 dark:border-r-gray-500 border-b-slate-300 dark:border-b-gray-600 active:border-b-0 active:border-r-0 text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light active:text-coopmaths-canvas active:translate-y-[1.5px] dark:active:text-coopmathsdark-canvas active:bg-coopmaths-action active:shadow-none dark:active:bg-coopmathsdark-action dark:active:shadow-none transition-transform ease-in-out shadow-[2px_2px_4px_rgba(180,180,180,0.5)]\n            {isSpecialKey(key)\n              ? 'bg-coopmaths-canvas-moredark dark:bg-coopmathsdark-canvas-moredark'\n              : 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest'}  py-1.5 px-2 md:py-2 md:px-4 text-center rounded-md font-mono\"\n            on:click={(e) => {\n              clickKeycap(keys[key], e, key)\n            }}\n          >\n            <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n            {@html keys[key].display}\n          </button>\n        {/each}\n      </div>\n    {/each}\n  </div>\n</div>\n\n<style>\n  button.key--SPACE {\n    flex: var(--special-flex, 3);\n  }\n</style>\n","<script lang=\"ts\">\n  import type { KeyCap } from '../../../../types/keycap'\n  import {\n    KEYCAP_HEIGHT,\n    KEYCAP_WIDTH,\n    SM_BREAKPOINT,\n    MD_BREAKPOINT,\n    LG_BREAKPOINT,\n    getMode,\n  } from '../../../../lib/sizes'\n  import type { Keys } from '../../../../types/keyboardContent'\n  export let innerWidth: number\n  export let keyName: Keys\n  export let key: KeyCap\n  export let isInLine: boolean\n  export let isSpecial: boolean = false\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n  let button: HTMLButtonElement\n  $: keycapwidth = KEYCAP_WIDTH[getMode(innerWidth, isInLine)]\n\n  $: keycapheight =\n    innerWidth <= SM_BREAKPOINT ? KEYCAP_HEIGHT.sm : KEYCAP_HEIGHT.md\n</script>\n\n<button\n  bind:this={button}\n  class=\"key--{keyName} customdimensions h-full flex justify-center items-center text-sm md:text-xl border-b-2 border-r border-r-slate-400 dark:border-r-gray-500 border-b-slate-300 dark:border-b-gray-600 active:border-b-0 active:border-r-0 text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light active:text-coopmaths-canvas active:translate-y-[1.5px] dark:active:text-coopmathsdark-canvas active:bg-coopmaths-action active:shadow-none dark:active:bg-coopmathsdark-action dark:active:shadow-none transition-transform ease-in-out shadow-[2px_2px_4px_rgba(180,180,180,0.5)] {isSpecial\n    ? 'bg-coopmaths-canvas-moredark dark:bg-coopmathsdark-canvas-moredark'\n    : 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas'}  py-1 px-1 md:py-2 md:px-4 text-center rounded-md font-mono touch-none\"\n  style=\"--keycapwidth:{keycapwidth}; --keycapheight:{keycapheight};\"\n  on:mousedown={(e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }}\n  on:click={(e) => {\n    clickKeycap(key, e)\n  }}\n>\n  <div id=\"key-{key.display}\" class=\"relative\">\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    <span>{@html key.display}</span>\n  </div>\n</button>\n\n<style>\n  .customdimensions {\n    width: calc(var(--keycapwidth) * 1px);\n    height: calc(var(--keycapheight) * 1px);\n  }\n  @media (min-width: 768px) {\n    button.key--FCT,\n    button.key--LIM,\n    button.key--BRACKETS,\n    button.key--BRACES,\n    button.key--VECT,\n    button.key--INT,\n    button.key--BINOM,\n    button.key--SIGMA,\n    button.key--COS,\n    button.key--SIN,\n    button.key--TAN,\n    button[class^='key--MASS'],\n    button[class^='key--LENGTH'],\n    button[class^='key--AREA'],\n    button[class^='key--CAPACITY'],\n    button[class^='key--VOLUME'] {\n      font-size: 1rem /* 16px */;\n      line-height: 1.5rem /* 24px */;\n    }\n    button.key--PROB {\n      font-size: 0.75rem /* 12px */;\n      line-height: 1rem /* 16px */;\n    }\n  }\n  @media only screen and (max-width: 768px) {\n    button.key--FCT,\n    button.key--INT,\n    button.key--BINOM,\n    button.key--BRACKETS,\n    button.key--BRACES,\n    button.key--VECT,\n    button.key--LIM,\n    button.key--SIGMA,\n    button.key--COS,\n    button.key--SIN,\n    button.key--TAN,\n    button.key--SQRT,\n    button[class^='key--MASS'],\n    button[class^='key--LENGTH'],\n    button[class^='key--AREA'],\n    button[class^='key--CAPACITY'],\n    button[class^='key--VOLUME'] {\n      font-size: 0.5rem /* 16px */;\n      line-height: 1.5rem /* 24px */;\n    }\n    button.key--PROB {\n      font-size: 0.4rem /* 12px */;\n      line-height: 1rem /* 16px */;\n    }\n  }\n\n  button.key--DEL,\n  button.key--FWD {\n    touch-action: none;\n  }\n</style>\n","<script lang=\"ts\">\n  import { keys } from '../../../lib/keycaps'\n  import { GAP_BETWEEN_KEYS, getMode } from '../../../lib/sizes'\n  import type { KeyboardBlock } from '../../../types/keyboardContent'\n  import { type KeyCap, isSpecialKey } from '../../../types/keycap'\n  import Key from './keycap/Keycap.svelte'\n  export let innerWidth: number\n  export let block: KeyboardBlock\n  export let isInLine: boolean = false\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n\n  $: gapsize = GAP_BETWEEN_KEYS[getMode(innerWidth, isInLine)]\n</script>\n\n{#if block !== undefined}\n  <div\n    id=\"kb-block-{block.title\n      .toLowerCase()\n      .normalize('NFD')\n      .replace(/\\p{Diacritic}/gu, '')\n      .replace(' ', '-')}\"\n  >\n    {#if isInLine}\n      <div\n        class=\"grid customgap h-full\"\n        style=\"grid-template-columns: repeat({block.keycaps.inline\n          .length}, minmax(0, 1fr)); --gapsize:{gapsize};\"\n      >\n        {#each block.keycaps.inline as key, index (key + '_' + index)}\n          <Key\n            keyName={key}\n            key={keys[key]}\n            isSpecial={isSpecialKey(key)}\n            {isInLine}\n            {innerWidth}\n            {clickKeycap}\n          />\n        {/each}\n      </div>\n    {:else}\n      <div\n        class=\"grid customgap h-full\"\n        style=\"grid-template-columns: repeat({block.cols}, minmax(0, 1fr)); --gapsize:{gapsize};\"\n      >\n        {#each block.keycaps.block as key, index (key + '_' + index)}\n          <Key\n            keyName={key}\n            key={keys[key]}\n            isSpecial={isSpecialKey(key)}\n            {isInLine}\n            {innerWidth}\n            {clickKeycap}\n          />\n        {/each}\n      </div>\n    {/if}\n  </div>\n{/if}\n\n<style>\n  .customgap {\n    gap: calc(var(--gapsize) * 1px);\n  }\n</style>\n","<script lang=\"ts\">\n  import { getUniqueStringBasedOnTimeStamp } from '../../../../../lib/components/time'\n  import { keyboardBlocks } from '../../../layouts/keysBlocks'\n  import { GAP_BETWEEN_BLOCKS, SM_BREAKPOINT } from '../../../lib/sizes'\n  import type { KeyboardBlock } from '../../../types/keyboardContent'\n  import type { KeyCap } from '../../../types/keycap'\n  import BlockOfKeycaps from './BlockOfKeycaps.svelte'\n  export let blocksList: KeyboardBlock[] = [\n    keyboardBlocks.lengths,\n    keyboardBlocks.areas,\n    keyboardBlocks.volumes,\n    keyboardBlocks.capacities,\n  ]\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n  export let isInLine: boolean\n  export let innerWidth: number\n  $: blockgapsize =\n    innerWidth <= SM_BREAKPOINT ? GAP_BETWEEN_BLOCKS.sm : GAP_BETWEEN_BLOCKS.md\n  /**\n   * Pour retirer les accents et autres bizarrerie dans les chanes\n   * @see https://stackoverflow.com/a/37511463\n   * @param s chane  transformer\n   */\n  const toRegularCharacters = (s: string): string =>\n    s.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '')\n  const possibleBlocks = [\n    ...blocksList.map((b) => toRegularCharacters(b.title)),\n  ] as const\n  $: currentBlock = possibleBlocks[0]\n\n  const switchToBlock = (newBlock: (typeof possibleBlocks)[number]) => {\n    currentBlock = newBlock\n  }\n</script>\n\n{#if blocksList && blocksList.length > 0}\n  <div class=\"flex flex-col\">\n    <ul\n      class=\"mb-1 flex list-none flex-row flex-wrap border-b-0 pl-0\"\n      style=\"--blockgapsize:{blockgapsize}\"\n      id=\"keysblocknav-{getUniqueStringBasedOnTimeStamp()}\"\n      role=\"tablist\"\n    >\n      {#each blocksList as block}\n        <li role=\"presentation\">\n          <button\n            type=\"button\"\n            class=\"mb-1 block border-x-0 border-b-2 border-t-0 px-2 pb-1 text-[0.7rem] font-light leading-tight {currentBlock ===\n            toRegularCharacters(block.title)\n              ? 'text-coopmaths-struct border-coopmaths-struct dark:text-coopmathsdark-struct dark:border-coopmathsdark-struct'\n              : 'text-coopmaths-action dark:text-coopmathsdark-action border-transparent'}   hover:text-coopmaths-action-lightest active:border-coopmaths-struct active:text-coopmaths-struct dark:hover:bg-transparent dark:active:border-coopmathsdark-struct dark:active:text-coopmathsdark-struct\"\n            id=\"tabs-{toRegularCharacters(block.title)}-tab\"\n            role=\"tab\"\n            aria-controls=\"tabs-{toRegularCharacters(block.title)}\"\n            on:click={(e) => {\n              e.preventDefault()\n              e.stopPropagation()\n              switchToBlock(toRegularCharacters(block.title))\n            }}\n            on:mousedown={(e) => {\n              e.preventDefault()\n              e.stopPropagation()\n            }}\n          >\n            {block.title}\n          </button>\n        </li>\n      {/each}\n    </ul>\n    <!--Blocks content-->\n    <div class=\"flex justify-center\">\n      {#each blocksList as block}\n        <div\n          class=\"{currentBlock === toRegularCharacters(block.title)\n            ? 'flex opacity-100'\n            : 'hidden opacity-0'} transition-opacity duration-150 ease-linear\"\n          id=\"tabs-{toRegularCharacters(block.title)}\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-{toRegularCharacters(block.title)}-tab\"\n        >\n          <BlockOfKeycaps {block} {isInLine} {innerWidth} {clickKeycap} />\n        </div>\n      {/each}\n    </div>\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate } from 'svelte'\n  import { GAP_BETWEEN_BLOCKS, getMode } from '../../lib/sizes'\n  import type { KeyboardBlock } from '../../types/keyboardContent'\n  import type { KeyCap } from '../../types/keycap'\n  import BlockOfKeyCaps from './keyboardblock/BlockOfKeycaps.svelte'\n  import BlockOfKeycapsWithPagination from './keyboardblock/BlockOfKeycapsWithPagination.svelte'\n\n  export let innerWidth: number\n  export let unitsBlocks: KeyboardBlock[]\n  export let usualBlocks: KeyboardBlock[]\n  export let page: KeyboardBlock[]\n  let blocks: KeyboardBlock[] =\n    unitsBlocks.length > 1 ? [...usualBlocks] : [...unitsBlocks, ...usualBlocks]\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n  export let isInLine: boolean\n  // // $: blocksToBeDisplayed = isInLine ? [...page] : [...blocks]\n  $: blockgapsize = GAP_BETWEEN_BLOCKS[getMode(innerWidth, isInLine)]\n  beforeUpdate(() => {\n    // if (debug) console.log('beforeUpdate KeyboardPage)\n    blocks =\n      unitsBlocks.length > 1\n        ? [...usualBlocks]\n        : [...unitsBlocks, ...usualBlocks]\n  })\n\n  afterUpdate(() => {\n    // if (debug) console.log('afterUpdate KeyboardPage)\n  })\n</script>\n\n<div\n  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark flex flex-row blockgap items-center justify-center w-full\"\n  style=\"--blockgapsize:{blockgapsize}\"\n>\n  {#if isInLine}\n    <div id=\"kb-page\" class=\"flex flex-row blockgap items-start justify-center\">\n      {#each page as block}\n        <BlockOfKeyCaps {block} {isInLine} {innerWidth} {clickKeycap} />\n      {/each}\n    </div>\n  {:else}\n    <div class={unitsBlocks.length > 1 && !isInLine ? 'flex' : 'hidden'}>\n      <BlockOfKeycapsWithPagination\n        blocksList={unitsBlocks}\n        {isInLine}\n        {innerWidth}\n        {clickKeycap}\n      />\n    </div>\n    <div\n      id=\"kb-block\"\n      class=\"flex flex-row blockgap items-start justify-center\"\n    >\n      {#each blocks as block}\n        <BlockOfKeyCaps {block} {isInLine} {innerWidth} {clickKeycap} />\n      {/each}\n    </div>\n  {/if}\n</div>\n\n<style>\n  .blockgap {\n    column-gap: calc(var(--blockgapsize) * 1px);\n  }\n</style>\n","import { specialKeys } from '../layouts/keysBlocks'\nimport type { keys } from '../lib/keycaps'\nimport { GAP_BETWEEN_KEYS, KEYCAP_WIDTH } from '../lib/sizes'\nexport type Keys = keyof typeof keys\nexport type KeysList = Keys[]\nexport type AlphanumericPages = 'AlphaUp' | 'AlphaLow' | 'Numeric'\nexport type BlockForKeyboard =\n  | 'alphanumeric'\n  | 'advanced'\n  | 'angles'\n  | 'areas'\n  | 'basicOperations'\n  | 'basicOperations2'\n  | 'basicOperationsPlus'\n  | 'capacities'\n  | 'compare'\n  | 'complexes'\n  | 'degre'\n  | 'degreCelsius'\n  | 'ensemble'\n  | 'ensembleDefini'\n  | 'fullOperations'\n  | 'greek'\n  | 'hms'\n  | 'lengths'\n  | 'clavierFonctionsTerminales'\n  | 'masses'\n  | 'numbers'\n  | 'numbersX'\n  | 'numbers2'\n  | 'numbersOperations'\n  | 'numbersOperationsX'\n  | 'limites'\n  | 'numbersSpace'\n  | 'numeration'\n  | 'probabilite'\n  | 'suite'\n  | 'trigo'\n  | 'variables'\n  | 'volumes'\n  | 'vFON'\n  | 'uppercaseAToH'\n  | 'uppercaseIToP'\n  | 'uppercaseQToW'\n  | 'uppercaseXToZ'\n  | 'estOuestSudNord'\n\nexport interface CompleteKeysList {\n  inline: KeysList\n  block: KeysList\n}\n\nexport interface KeyboardBlock {\n  keycaps: CompleteKeysList\n  cols: number\n  title: string\n  isUnits: boolean\n}\n\nexport class Keyboard {\n  blocks: KeyboardBlock[] = [specialKeys]\n\n  constructor(kb?: KeyboardBlock) {\n    if (kb) {\n      this.blocks.push(kb)\n    }\n  }\n\n  /**\n   * Ajoute un bloc de touche au clavier\n   * @param kb {KeyboardBlock} bloc de touches  ajouter\n   * @returns le clavier lui-mme (on peut donc chaner cette fonction)\n   */\n  add = (kb: KeyboardBlock): Keyboard => {\n    this.blocks.push(kb)\n    return this\n  }\n\n  empty = (): void => {\n    this.blocks.length = 0\n    this.blocks.push(specialKeys)\n  }\n\n  /**\n   * Retrouve le nombre de blocs dans le clavier\n   * @returns nombre de blocs dans le clavier\n   */\n  numberOfBlocks = (): number => this.blocks.length\n\n  /**\n   * Construit un tableau dont les lments sont le nombre de touche par bloc\n   * @returns nombre de touches par bloc (liste de nombres)\n   */\n  numberOfKeysPerBlock = (): number[] => {\n    const result: number[] = []\n    for (const block of this.blocks) {\n      result.push(block.keycaps.inline.length)\n    }\n    return result\n  }\n\n  /**\n   * Calcule le nombre total de touches dans le clavier\n   * @returns nombre total de touches\n   */\n  numberOfKeys = (): number =>\n    this.numberOfKeysPerBlock().reduce((prev, current) => prev + current)\n\n  /**\n   * Dcide si on passe le bloc des touches spciales sur deux colonnes\n   * lorsqu'on a que deux touches par bloc\n   * (utile dans la cas de clavier cotenant trs peu de touches)\n   */\n  checkSmallLayoutAllowed = (): void => {\n    const maximumNbKeysPerBlock = this.numberOfKeysPerBlock()\n      .slice(1)\n      .reduce((prev, current) => (prev < current ? current : prev), 0)\n    if (maximumNbKeysPerBlock <= 2) {\n      // le premier bloc est celui des touches spciales, on le passe en deux colonnes.\n      this.blocks[0].cols = 2\n    }\n  }\n}\n\nexport const inLineBlockWidth = (\n  block: KeyboardBlock,\n  mode: 'sm' | 'md' | 'lg' | 'xl',\n): number => {\n  // 3G30-1 renvoie un keycaps undefined, pourquoi ?\n  const numberOfKeys = block?.keycaps?.inline?.length || 0\n  // console.log('nb of keys: ' + numberOfKeys + ' / key width: ' + KEYCAP_WIDTH[mode]s + ' / gap between keys: ' + GAP_BETWEEN_KEYS[mode])\n  return (\n    numberOfKeys * KEYCAP_WIDTH[mode] +\n    (numberOfKeys - 1) * GAP_BETWEEN_KEYS[mode]\n  )\n}\nexport const usualBlockWidth = (\n  block: KeyboardBlock,\n  mode: 'sm' | 'md' | 'lg' | 'xl',\n): number => {\n  const numberOfCols = block.cols\n  return (\n    numberOfCols * KEYCAP_WIDTH[mode] +\n    (numberOfCols - 1) * GAP_BETWEEN_KEYS[mode]\n  )\n}\n","<script lang=\"ts\">\n  import { MathfieldElement } from 'mathlive'\n  import { tick } from 'svelte'\n  import { fly } from 'svelte/transition'\n  import { mathaleaRenderDiv } from '../../lib/mathalea'\n  import { keyboardBlocks } from './layouts/keysBlocks'\n  import { GAP_BETWEEN_BLOCKS, getMode } from './lib/sizes'\n  import Alphanumeric from './presentationalComponents/alphanumeric/Alphanumeric.svelte'\n  import KeyboardPage from './presentationalComponents/keyboardpage/KeyboardPage.svelte'\n  import { keyboardState } from './stores/keyboardStore'\n  import {\n    Keyboard,\n    inLineBlockWidth,\n    type AlphanumericPages,\n    type KeyboardBlock,\n    type Keys,\n  } from './types/keyboardContent'\n  import type { KeyCap } from './types/keycap'\n  import { isPageKey } from './types/keycap'\n\n  let innerWidth: number = 0\n  let pages: KeyboardBlock[][] = []\n  let usualBlocks: KeyboardBlock[] = []\n  let unitsBlocks: KeyboardBlock[] = []\n  let currentPageIndex = 0\n  let divKeyboard: HTMLDivElement\n  let alphanumericDisplayed: boolean = false\n  let isVisible = false\n  let isInLine = false\n  let pageType: AlphanumericPages = 'AlphaLow'\n  const myKeyboard: Keyboard = new Keyboard()\n\n  const computePages = () => {\n    pages.length = 0\n    let pageWidth: number = 0\n    let page: KeyboardBlock[] = []\n    const mode = getMode(innerWidth, true)\n    const blockList = [...usualBlocks, ...unitsBlocks].reverse()\n    while (blockList.length > 0) {\n      const block = blockList.pop()\n      const blockWidth =\n        inLineBlockWidth(block!, mode) + GAP_BETWEEN_BLOCKS[mode]\n      if (pageWidth + blockWidth > 0.8 * innerWidth) {\n        // plus de places\n        pages.push(page.reverse())\n        page = []\n        pageWidth = 0\n      }\n      page.push(block!)\n      pageWidth = +blockWidth\n    }\n    if (page.length !== 0) {\n      pages.push(page.reverse())\n    }\n  }\n\n  keyboardState.subscribe(async (value) => {\n    isVisible = value.isVisible\n    isInLine = value.isInLine\n    pageType = value.alphanumericLayout\n    myKeyboard.empty()\n    for (const block of value.blocks) {\n      if (block !== 'alphanumeric') myKeyboard.add(keyboardBlocks[block])\n    }\n    myKeyboard.checkSmallLayoutAllowed()\n    unitsBlocks.length = 0\n    usualBlocks.length = 0\n    for (const block of myKeyboard.blocks) {\n      if (\n        block &&\n        Object.prototype.hasOwnProperty.call(block, 'isUnits') &&\n        block.isUnits\n      ) {\n        unitsBlocks.push(block)\n      } else {\n        usualBlocks.push(block)\n      }\n    }\n    unitsBlocks = unitsBlocks\n    usualBlocks = usualBlocks\n    computePages()\n    pages = pages\n    if (currentPageIndex >= pages.length) currentPageIndex = 0\n    alphanumericDisplayed = value.blocks.includes('alphanumeric')\n    await tick()\n    mathaleaRenderDiv(divKeyboard)\n    // document.dispatchEvent(new window.Event('KeyboardUpdated', { bubbles: true }))\n    // console.log('message envoy: ' + 'KeyboardUpdated')\n  })\n\n  async function navRight(e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n    if (currentPageIndex !== 0) {\n      currentPageIndex--\n    }\n    // console.log('page  afficher n' + currentPageIndex)\n    // console.log(pages[currentPageIndex])\n    await tick()\n    mathaleaRenderDiv(divKeyboard)\n  }\n\n  async function navLeft(e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n    if (currentPageIndex !== pages.length - 1) {\n      currentPageIndex++\n    }\n    // console.log('page  afficher n' + currentPageIndex)\n    // console.log(pages[currentPageIndex])\n    await tick()\n    mathaleaRenderDiv(divKeyboard)\n  }\n\n  const clickKeycap = (key: KeyCap, event: MouseEvent, value?: Keys) => {\n    if (value && isPageKey(value)) {\n      // la touche est une touche du clavier alphanumeric pour changer de page\n      switch (value) {\n        case 'abc':\n          $keyboardState.alphanumericLayout = 'AlphaLow'\n          break\n        case 'ABC':\n          $keyboardState.alphanumericLayout = 'AlphaUp'\n          break\n        case 'NUM':\n          $keyboardState.alphanumericLayout = 'Numeric'\n          break\n        default:\n          $keyboardState.alphanumericLayout = 'AlphaLow'\n          break\n      }\n    } else {\n      if (event.currentTarget instanceof HTMLButtonElement) {\n        const idMathField = $keyboardState.idMathField\n        const mf = document.querySelector(\n          ('#' + idMathField).replace('-button', ''),\n        ) as MathfieldElement\n        // console.log({\n        //   mf,\n        //   idMathField,\n        //   command: `${key.command}`,\n        //   insert: `${key.insert}`\n        // })\n        if (mf != null) {\n          mf.focus()\n          if (key.command && key.command === 'closeKeyboard') {\n            keyboardState.update((value) => {\n              value.isVisible = false\n              value.idMathField = ''\n              return value\n            })\n          } else if (key.command && key.command[0] !== '') {\n            // @ts-expect-error : command doit tre compatible avec MathLive\n            mf.executeCommand(key.command)\n          } else {\n            mf.executeCommand(['insert', key.insert || key.display])\n          }\n        }\n      }\n    }\n  }\n</script>\n\n<svelte:window bind:innerWidth />\n{''}\n{#if isVisible}\n  <div\n    on:mousedown={(e) => {\n      e.preventDefault()\n      e.stopPropagation()\n    }}\n    role=\"none\"\n    transition:fly|global={{ y: '100%', opacity: 1 }}\n    bind:this={divKeyboard}\n    class=\" bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark p-2 md:p-4 w-full fixed bottom-0 left-0 right-0 z-[9999] drop-shadow-[0_-3px_5px_rgba(130,130,130,0.25)] dark:drop-shadow-[0_-3px_5px_rgba(250,250,250,0.25)]\"\n  >\n    {#if alphanumericDisplayed}\n      <Alphanumeric {clickKeycap} {pageType} />\n    {:else}\n      <div class={isInLine ? 'relative px-10' : 'py-2 md:py-0'}>\n        <KeyboardPage\n          unitsBlocks={[...unitsBlocks].reverse()}\n          usualBlocks={[...usualBlocks].reverse()}\n          page={pages[currentPageIndex]}\n          {isInLine}\n          {innerWidth}\n          {clickKeycap}\n        />\n        <!-- Boutons de navigation entre les pages : vers la DROITE -->\n        <button\n          id=\"kb-nav-right\"\n          aria-label=\"Page suivante\"\n          class=\"absolute right-2 md:right-0 top-0 bottom-0 m-auto flex justify-center items-center h-8 w-8 text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest disabled:text-transparent dark:disabled:text-transparent\"\n          on:click={navRight}\n          on:mousedown={(e) => {\n            e.preventDefault()\n            e.stopPropagation()\n          }}\n          disabled={pages.length === 1 || currentPageIndex === 0 || !isInLine}\n        >\n          <i class=\"bx bx-chevron-right bx-lg\"></i>\n        </button>\n        <!-- Boutons de navigation entre les pages : vers la GAUCHE -->\n        <button\n          id=\"kb-nav-left\"\n          aria-label=\"Page prcdente\"\n          class=\"absolute left-2 md:left-0 top-0 bottom-0 m-auto flex justify-center items-center h-8 w-8 text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest disabled:text-transparent dark:disabled:text-transparent\"\n          on:click={navLeft}\n          on:mousedown={(e) => {\n            e.preventDefault()\n            e.stopPropagation()\n          }}\n          disabled={pages.length === 1 ||\n            currentPageIndex === pages.length - 1 ||\n            !isInLine}\n        >\n          <i class=\"bx bx-chevron-left bx-lg\"></i>\n        </button>\n      </div>\n    {/if}\n    <!-- Bouton de rduction du clavier -->\n    <button\n      id=\"kb-nav-reduced\"\n      type=\"button\"\n      aria-label={isInLine ? 'Agrandir le clavier' : 'Rduire le clavier'}\n      class=\"z-[10000] absolute right-0 top-0 h-5 w-5 rounded-sm bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action-light dark:hover:bg-coopmathsdark-action-lightest text-coopmaths-canvas dark:text-coopmaths-canvas\"\n      on:click={async (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        computePages()\n        $keyboardState.isInLine = !$keyboardState.isInLine\n        await tick()\n        mathaleaRenderDiv(divKeyboard)\n      }}\n      on:mousedown={(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n      }}\n    >\n      <i class=\"bx {isInLine ? 'bx-plus' : 'bx-minus'}\"></i>\n    </button>\n    <!-- bouton de passage du clavier alphanumrique au clavier maths-->\n    <button\n      id=\"kb-nav-alpha\"\n      type=\"button\"\n      aria-label={alphanumericDisplayed\n        ? 'Clavier mathmatique'\n        : 'Clavier alphanumrique'}\n      class=\"z-[10000] {$keyboardState.blocks.includes('alphanumeric')\n        ? 'flex justify-center items-center'\n        : 'hidden'} absolute right-0 top-6 h-5 w-5 rounded-sm bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action-light dark:hover:bg-coopmathsdark-action-lightest text-coopmaths-canvas dark:text-coopmaths-canvas\"\n      on:click={async (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        alphanumericDisplayed = !alphanumericDisplayed\n        await tick()\n        mathaleaRenderDiv(divKeyboard)\n      }}\n      on:mousedown={(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n      }}\n    >\n      <i class=\"bx {alphanumericDisplayed ? 'bx-math' : 'bx-font-family'}\"></i>\n    </button>\n  </div>\n{/if}\n","<script lang=\"ts\">\n  export let icon: string\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let floatUnderText: string = ''\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n</script>\n\n<button\n  type=\"button\"\n  {title}\n  class=\"{$$props.class ||\n    ''} {disabled\n    ? 'text-coopmaths-action/10 dark:text-coopmathsdark-action/10'\n    : 'text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n  {disabled}\n  on:click\n>\n  <i class=\"relative bx {icon}\">\n    {#if floatUnderText !== ''}\n      <div\n        class=\"absolute left-1/2 -translate-x-1/2 -translate-y-2 text-sm font-extrabold font-sans\"\n      >\n        {floatUnderText}\n      </div>\n    {/if}\n    {#if cornerIcon !== ''}\n      <i\n        class=\"absolute -bottom-1 bx {cornerIcon} text-sm -translate-x-3\n        {cornerIconClass || 'text-coopmaths-warn dark:text-coopmathsdark-warn'}\"\n      ></i>\n    {/if}\n  </i>\n</button>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import ButtonIcon from '../forms/ButtonIcon.svelte'\n\n  export let isDisplayed: boolean //  bind avec le parent\n  export let icon: string = ''\n  export let isWithCloseButton: boolean = true\n\n  const dispatch = createEventDispatcher()\n\n  let dialog: HTMLDialogElement\n\n  $: if (dialog && isDisplayed) dialog.showModal()\n  $: if (dialog && !isDisplayed) dialog.close()\n</script>\n\n<div class=\"flex justify-center\">\n  <!-- pour que la modale ne soit pas affecte par les modifications de marge de ses parents -->\n\n  <!-- Ceux qui n'ont pas de souris ont le focus sur le bouton de la croix pour fermer donc ce n'est pas grave s'ils ne peuvent pas fermer en interagissant avec le fond de la modale -->\n  <!-- svelte-ignore a11y-click-events-have-key-events -->\n  <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n  <dialog\n    bind:this={dialog}\n    on:click|self={() => dialog.close()}\n    on:close={() => {\n      isDisplayed = false\n      dispatch('close')\n    }}\n    class=\"m-auto rounded-xl\n      w-full md:w-2/3 xl:w-1/2\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <div class=\"relative p-6 text-center\">\n      {#if isWithCloseButton}\n        <ButtonIcon\n          icon=\"bx-x text-2xl\"\n          class=\"absolute top-3 right-3\"\n          on:click={() => dialog.close()}\n        />\n      {/if}\n      {#if icon !== ''}\n        <div\n          class=\"flex items-center justify-center h-12 w-12 mx-auto mt-2 mb-6 rounded-full\n          bg-coopmaths-warn-100 text-coopmaths-warn-darkest\"\n        >\n          <i class=\"bx bx-sm {icon}\"></i>\n        </div>\n      {/if}\n      <div\n        class=\"w-full mb-4\n        text-2xl font-bold\n        text-coopmaths-struct dark:text-coopmathsdark-struct\"\n      >\n        <slot name=\"header\" />\n      </div>\n      <div class=\"w-full\">\n        <slot name=\"content\" />\n      </div>\n      <div class=\"w-full mt-6 mb-3\">\n        <slot name=\"footer\" />\n      </div>\n    </div>\n  </dialog>\n</div>\n","<script lang=\"ts\">\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n\n  export let current: number\n  export let state: CanState\n  export let resultsByQuestion: boolean[]\n</script>\n\n<div\n  aria-label=\"course pagination\"\n  class=\"w-full md:hidden flex flex-row justify-center items-centers py-4\"\n>\n  <div class=\"relative block\">\n    <div\n      class=\"rounded-full px-3 py-1.5 text-sm md:text-base font-black transition-all duration-300 text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-struct dark:bg-coopmathsdark-struct\"\n    >\n      {current + 1}\n    </div>\n    {#if state === 'race'}\n      <div\n        class=\"absolute -bottom-1 left-1/2 -translate-x-1/2 h-3 w-3 rounded-full bg-coopmaths-struct\n        {$canOptions.isInteractive && $canOptions.questionGetAnswer[current]\n          ? 'flex'\n          : 'hidden'}\"\n      ></div>\n    {/if}\n    {#if state === 'solutions'}\n      <div class=\"absolute -bottom-4 left-1/2 -translate-x-1/2 flex\">\n        <i\n          class=\"bx {resultsByQuestion[current]\n            ? 'bxs-check-square text-coopmaths-warn-800 dark:text-green-500'\n            : 'bxs-x-square text-red-500 dark:text-coopmathsdark-warn'}\"\n        ></i>\n      </div>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import type { CanState } from '../../../../lib/types/can'\n  import BasicClassicModal from '../../../shared/modal/BasicClassicModal.svelte'\n  import ShortPagination from './ShortPagination.svelte'\n\n  export let current: number\n  export let numberOfQuestions: number\n  export let handleEndOfRace: () => void\n  export let state: CanState\n  export let resultsByQuestion: boolean[]\n\n  let isModalOpen = false\n\n  function swipe(node: HTMLElement) {\n    let touchStartX = 0\n    let touchStartY = 0\n    let touchStartTime = 0\n\n    const minSwipeDistance = 60\n    const maxSwipeTime = 300\n\n    function handleTouchStart(event: TouchEvent) {\n      touchStartX = event.touches[0].clientX\n      touchStartY = event.touches[0].clientY\n      touchStartTime = Date.now()\n    }\n\n    function handleTouchEnd(event: TouchEvent) {\n      const touchEndX = event.changedTouches[0].clientX\n      const touchEndY = event.changedTouches[0].clientY\n      const touchEndTime = Date.now()\n\n      const deltaX = touchEndX - touchStartX\n      const deltaY = touchEndY - touchStartY\n      const deltaTime = touchEndTime - touchStartTime\n\n      // Check if swipe is horizontal enough and fast enough\n      if (Math.abs(deltaX) > Math.abs(deltaY) && deltaTime <= maxSwipeTime) {\n        if (Math.abs(deltaX) >= minSwipeDistance) {\n          if (deltaX > 0 && current > 0) {\n            // Swipe right - go to previous\n            current -= 1\n          } else if (deltaX < 0 && current < numberOfQuestions - 1) {\n            // Swipe left - go to next\n            current += 1\n          }\n        }\n      }\n    }\n\n    node.addEventListener('touchstart', handleTouchStart, { passive: true })\n    node.addEventListener('touchend', handleTouchEnd, { passive: true })\n\n    return {\n      destroy() {\n        node.removeEventListener('touchstart', handleTouchStart)\n        node.removeEventListener('touchend', handleTouchEnd)\n      },\n    }\n  }\n\n  onMount(() => {\n    setTimeout(() => {\n      const endButtonDiv = document.getElementById('race-ended-by-user-btn')\n      if (endButtonDiv) {\n        endButtonDiv.removeAttribute('disabled')\n      }\n    }, 5 * 1000)\n  })\n</script>\n\n<div\n  use:swipe\n  class=\"w-full pb-8 md:pb-10 px-10 space-y-4 flex flex-col md:flex-row justify-start md:justify-between items-center\"\n>\n  <div class=\"w-50\"></div>\n  <div class=\"flex flex-row space-x-10\">\n    <button\n      class=\"md:hidden flex justify-center items-center\"\n      type=\"button\"\n      aria-label=\"Reculer de 10 questions\"\n      on:click={() => {\n        if (current >= 10) {\n          current -= 10\n        }\n      }}\n    >\n      <i\n        class=\"bx bxs-chevrons-left text-3xl md:text-7xl\n            {current < 10\n          ? 'text-coopmaths-action/10 dark:text-coopmathsdark-action/10'\n          : 'text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n    <button\n      type=\"button\"\n      aria-label=\"Question prcdente\"\n      on:click={() => {\n        if (current > 0) {\n          current -= 1\n        }\n      }}\n    >\n      <i\n        class=\"bx bxs-chevron-left md:bxs-left-arrow text-3xl md:text-7xl\n            {current === 0\n          ? 'text-coopmaths-action/10 dark:text-coopmathsdark-action/10'\n          : 'text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n    <ShortPagination {current} {state} {resultsByQuestion} />\n    <button\n      type=\"button\"\n      aria-label=\"Question suivante\"\n      on:click={() => {\n        if (current < numberOfQuestions - 1) {\n          current += 1\n        }\n      }}\n    >\n      <i\n        class=\"bx bxs-chevron-right md:bxs-right-arrow text-3xl md:text-7xl\n            {current === numberOfQuestions - 1\n          ? 'text-coopmaths-action/10 dark:text-coopmathsdark-action/10'\n          : 'text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n    <button\n      class=\"md:hidden flex justify-center items-center\"\n      type=\"button\"\n      aria-label=\"Avancer de 10 questions\"\n      on:click={() => {\n        if (current + 10 <= numberOfQuestions - 1) {\n          current += 10\n        }\n      }}\n    >\n      <i\n        class=\"bx bxs-chevrons-right text-3xl md:text-7xl\n            {current > numberOfQuestions - 11\n          ? 'text-coopmaths-action/10 dark:text-coopmathsdark-action/10'\n          : 'text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n  </div>\n  <div>\n    {#if state === 'race'}\n      <button\n        id=\"race-ended-by-user-btn\"\n        type=\"button\"\n        class=\"inline-block p-2 md:p-4 font-bold rounded-lg text-sm md:text-xl leading-normal text-coopmaths-canvas dark:text-coopmathsdark-canvas transition duration-150 ease-in-out bg-coopmaths-action hover:bg-coopmaths-action-lightest focus:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest dark:focus:bg-coopmathsdark-action-lightest focus:outline-none focus:ring-0 active:bg-coopmaths-action-light dark:active:bg-coopmathsdark-action-light disabled:bg-coopmaths-action/10\"\n        on:click={() => (isModalOpen = true)}\n        disabled\n      >\n        Rendre la copie\n      </button>\n    {/if}\n  </div>\n</div>\n<BasicClassicModal bind:isDisplayed={isModalOpen} icon=\"bxs-error\">\n  <span slot=\"header\">Attention !</span>\n  <div\n    slot=\"content\"\n    class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n  >\n    <div>\n      Si vous cliquez sur le bouton\n      <span class=\"font-bold\">Terminer</span>\n      alors vous ne pourrez plus revenir en arrire.\n    </div>\n    <div class=\"mt-4\">Que souhaitez-vous faire ?</div>\n  </div>\n  <div slot=\"footer\" class=\"flex flex-wrap items-center justify-center gap-2\">\n    <button\n      type=\"button\"\n      class=\"inline-block rounded bg-coopmaths-action-200 dark:bg-coopmathsdark-action-lightest px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-coopmaths-action dark:text-coopmathsdark-action-dark transition duration-150 ease-in-out hover:bg-coopmaths-action-400 focus:bg-coopmaths-action-400\"\n      on:click={() => (isModalOpen = false)}\n    >\n      Annuler\n    </button>\n    <button\n      type=\"button\"\n      class=\"inline-block rounded bg-coopmaths-action dark:bg-coopmathsdark-action px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-coopmaths-canvas dark:text-coopmathsdark-canvas transition duration-150 ease-in-out hover:bg-coopmaths-action-dark focus:bg-coopmaths-action-dark\"\n      on:click={() => {\n        handleEndOfRace()\n        isModalOpen = false\n      }}\n    >\n      Terminer\n    </button>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n\n  export let current: number\n  export let numberOfQuestions: number\n  export let state: CanState\n  export let resultsByQuestion: boolean[]\n</script>\n\n<nav\n  aria-label=\"course pagination\"\n  class=\"w-full hidden md:flex flex-row justify-center items-centers py-4\"\n>\n  <u\n    class=\"list-none w-full flex flex-row flex-wrap justify-around items-center\"\n  >\n    {#each [...Array(numberOfQuestions).keys()] as i}\n      <li class=\"relative block\">\n        <button\n          role=\"tab\"\n          aria-controls=\"tab-{i + 1}\"\n          aria-selected={current === i ? 'true' : 'false'}\n          type=\"button\"\n          class=\"rounded-full px-3 py-1.5 text-sm md:text-base font-black transition-all duration-300\n        {i === current\n            ? 'text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-struct dark:bg-coopmathsdark-struct'\n            : 'bg-transparent text-coopmaths-action hover:bg-coopmaths-action-lightest/20 dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest/20'}\"\n          on:click={() => {\n            current = i\n          }}\n        >\n          {i + 1}\n        </button>\n        {#if state === 'race'}\n          <div\n            class=\"absolute -bottom-1 left-1/2 -translate-x-1/2 h-3 w-3 rounded-full bg-coopmaths-struct\n        {$canOptions.isInteractive && $canOptions.questionGetAnswer[i]\n              ? 'flex'\n              : 'hidden'}\"\n          ></div>\n        {/if}\n        {#if state === 'solutions'}\n          <div class=\"absolute -bottom-1 left-1/2 -translate-x-1/2 flex\">\n            <i\n              class=\"bx {resultsByQuestion[i]\n                ? 'bxs-check-square text-coopmaths-warn-800 dark:text-green-500'\n                : 'bxs-x-square text-red-500 dark:text-coopmathsdark-warn'}\"\n            ></i>\n          </div>\n        {/if}\n      </li>\n    {/each}\n  </u>\n</nav>\n","import loadjs from 'loadjs'\nimport { MathfieldElement } from 'mathlive'\nimport { get } from 'svelte/store'\nimport { keyboardState } from '../components/keyboard/stores/keyboardStore'\nimport { getKeyboardShortcusts } from '../lib/interactif/claviers/keyboard'\nimport { globalOptions } from '../lib/stores/globalOptions'\nimport { context } from './context'\nimport { UserFriendlyError } from './messages'\n/**\n * Nos applis prdtermines avec la liste des fichiers  charger\n * @type {Object}\n */\nconst apps = {\n  scratchblocks: 'assets/externalJs/scratchblocks-v3.5-min',\n  slick: [\n    '/assets/externalJs/semantic-ui/semantic.min.css',\n    '/assets/externalJs/semantic-ui/semantic.min',\n    '/assets/externalJs/semantic-ui/components/state.min',\n  ],\n}\n\n/**\n * Charge une appli liste dans apps (pour mutualiser l'appel de loadjs)\n * @private\n * @param {string} name\n * @return {Promise<undefined, Error>} promesse de chargement\n */\nasync function load(name) {\n  // on est dans une fct async, si l'une de ces deux lignes plantent a va retourner une promesse rejete avec l'erreur\n  if (!apps[name]) throw UserFriendlyError(`application ${name} inconnue`)\n  // cf https://github.com/muicss/loadjs\n  try {\n    if (!loadjs.isDefined(name)) {\n      await loadjs(apps[name], name, { returnPromise: true })\n    }\n  } catch (error) {\n    console.error(error)\n    throw new UserFriendlyError(`Le chargement de ${name} a chou`)\n  }\n  // loadjs.ready veut une callback, on emballe a dans une promesse\n  return new Promise((resolve, reject) => {\n    loadjs.ready(name, {\n      success: resolve,\n      // si le chargement prcdent a russi on voit pas trop comment on pourrait arriver l, mais a reste plus prudent de grer l'erreur ventuelle\n      error: () =>\n        reject(new UserFriendlyError(`Le chargement de ${name} a chou`)),\n    })\n  })\n}\n\n/**\n * Charge prism\n * @return {Promise<undefined>}\n */\nexport function loadPrism() {\n  return load('prism')\n}\n\n/**\n * Charge scratchblocks\n * @return {Promise} qui peut chouer\n */\nexport function loadScratchblocks() {\n  return load('scratchblocks')\n}\n\n/**\n * Charge MathLive et personnalise les rglages\n * MathLive est charg ds qu'un tag math-field est cr\n */\nexport async function loadMathLive(divExercice) {\n  await import('mathlive')\n  let champs\n  if (divExercice) {\n    champs = divExercice.getElementsByTagName('math-field')\n  } else {\n    champs = document.getElementsByTagName('math-field')\n  }\n  if (champs != null) {\n    for (const mf of champs) {\n      if (mf instanceof MathfieldElement) {\n        if (mf.classList.contains('fillInTheBlanks')) {\n          mf.classList.remove('invisible')\n        }\n        mf.classList.add('ml-1')\n        mf.addEventListener('focus', handleFocusMathField)\n        mf.addEventListener('focusout', handleFocusOutMathField)\n        mf.addEventListener('input', () => {\n          const content = mf.getValue()\n          // Remplace les espaces conscutifs par un seul espace\n          const filteredContent = content.replaceAll('\\\\,\\\\,', '\\\\,')\n          mf.setValue(filteredContent)\n        })\n        if (mf.getAttribute('data-space') === 'true') {\n          mf.mathModeSpace = '\\\\,'\n        }\n\n        if (mf.isConnected) {\n          // mf is already in the DOM. You can check if it's ready by accessing a property.\n          setMathfield(mf)\n        } else {\n          // Add a listener for the `mount` event in case it's not mounted yet.\n          mf.addEventListener('mount', setMathfield, { once: true })\n        }\n      }\n    }\n    // On envoie la hauteur de l'iFrame aprs le chargement des champs MathLive\n    if (context.vue === 'exMoodle') {\n      const hauteurExercice =\n        window.document.querySelector('section').scrollHeight\n      window.parent.postMessage(\n        {\n          hauteurExercice,\n          iMoodle: parseInt(\n            new URLSearchParams(window.location.search).get('iMoodle'),\n          ),\n        },\n        '*',\n      )\n      const domExerciceInteractifReady = new window.Event(\n        'domExerciceInteractifReady',\n        { bubbles: true },\n      )\n      document.dispatchEvent(domExerciceInteractifReady)\n    }\n  }\n}\n\nfunction handleFocusMathField(event) {\n  const mf = event.target\n  const isFillInTheBlanks = mf.classList.contains('fillInTheBlanks')\n  const isNotFillInTheBlanksAndReadOnly = !isFillInTheBlanks && mf.readOnly\n  const isCorrected =\n    isNotFillInTheBlanksAndReadOnly || mf.classList.contains('corrected')\n  getKeyboardShortcusts(mf)\n  keyboardState.update((value) => {\n    return {\n      isVisible: true && !isCorrected, // Les fiilInTheBlanks sont toujours readOnly\n      isInLine: value.isInLine,\n      idMathField: event.target.id,\n      alphanumericLayout: value.alphanumericLayout,\n      blocks:\n        'keyboard' in mf.dataset\n          ? mf.dataset.keyboard.split(' ')\n          : ['numbers', 'fullOperations', 'variables'],\n    }\n  })\n}\n\nfunction handleFocusOutMathField() {\n  // Si le focus est sur un autre lment que mathfield, on cache le clavier\n  // On utilise setTimeout pour tre sr que le focus soit bien sur le nouvel lment\n  // car au focusout, le focus est sur body\n  if (get(globalOptions).v === 'can') return\n  setTimeout(() => {\n    if (document.activeElement.tagName !== 'MATH-FIELD') {\n      keyboardState.update((value) => {\n        const newValue = value\n        newValue.isVisible = false\n        return newValue\n      })\n    }\n  }, 200)\n}\n\nfunction setMathfield(mf) {\n  if ('mathVirtualKeyboardPolicy' in mf) mf.mathVirtualKeyboardPolicy = 'manual'\n  if ('menuItems' in mf) mf.menuItems = []\n  if ('virtualKeyboardMode' in mf) mf.virtualKeyboardMode = 'manual'\n  mf.removeEventListener('mount', setMathfield)\n}\n","<script lang=\"ts\">\n  import { afterUpdate, onMount } from 'svelte'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { setSizeWithinSvgContainer } from '../../../../lib/components/sizeTools'\n  import { loadMathLive } from '../../../../modules/loaders'\n  import { keyboardState } from '../../../keyboard/stores/keyboardStore'\n  import type { MathfieldElement } from 'mathlive'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import { questionCliqueFigure } from '../../../../lib/interactif/cliqueFigure'\n\n  export let question: string\n  export let consigne: string\n  export let correction: string\n  export let consigneCorrection: string\n  export let mode: 'display' | 'correction' = 'display'\n  export let visible: boolean\n  export let index: number\n  export let nextQuestion: () => void\n\n  let questionContainer: HTMLDivElement\n  import { onDestroy } from 'svelte'\n\n  onDestroy(() => {\n    const mf = questionContainer?.querySelector(\n      'math-field',\n    ) as MathfieldElement\n    if (mf) {\n      mf.removeEventListener('keyup', handleKeyUp)\n      mf.removeEventListener('input', handleMathfieldElement)\n    }\n  })\n  onMount(() => {\n    const questionContent = document.getElementById(\n      `question-content-${index}`,\n    ) as HTMLDivElement\n    if (questionContent) {\n      mathaleaRenderDiv(questionContent)\n      setSizeWithinSvgContainer(questionContent)\n    }\n    loadMathLive()\n  })\n\n  afterUpdate(() => {\n    if (visible) {\n      updateInteractivity()\n      const questionContent = document.getElementById(\n        `question-content-${index}`,\n      ) as HTMLDivElement\n      setSizeWithinSvgContainer(questionContent)\n    }\n  })\n\n  function handleKeyUp(e: KeyboardEvent) {\n    /* MGu obliger de mettre l'event quand on relache la touche, car sinon events multiples pour la mme touche */\n    if (e.key === 'Enter') {\n      nextQuestion()\n    }\n  }\n\n  function handleMathfieldElement(this: HTMLElement, ev: Event) {\n    /* ca peut venir du clavier vituel ou du clavier physique */\n    if ((this as MathfieldElement).value !== '') {\n      if ($canOptions.questionGetAnswer[index] !== true) {\n        $canOptions.questionGetAnswer[index] = true\n      }\n    } else {\n      if ($canOptions.questionGetAnswer[index] !== false) {\n        $canOptions.questionGetAnswer[index] = false\n      }\n    }\n  }\n\n  function updateInteractivity() {\n    if (questionContainer) {\n      const mf = questionContainer?.querySelector(\n        'math-field',\n      ) as MathfieldElement\n      if (mf) {\n        if (!mf.dataset.listenerAdded) {\n          mf.dataset.listenerAdded = 'true' // Marquer comme ajout\n          mf.addEventListener('keyup', handleKeyUp)\n          mf.addEventListener('input', handleMathfieldElement)\n        }\n        $keyboardState.idMathField = mf.id\n        window.setTimeout(() => {\n          mf.focus()\n          // @ToFix Je remets le clavier visible pour les fillInTheBlanks mais en fait je ne sais pas ce qui les rend invisibles\n          // Mgu je n'ai pas reproduit le problme ...\n          // $keyboardState.isVisible = true\n        }, 0)\n        return\n      }\n\n      const figureCliquables =\n        questionContainer?.querySelectorAll<HTMLInputElement>(\n          '[id^=\"cliquefigure\"]',\n        )\n      if (figureCliquables.length > 0) {\n        $keyboardState.isVisible = false\n        for (const figureCliquable of figureCliquables) {\n          questionCliqueFigure(figureCliquable)\n          if (!figureCliquable.dataset.listenerAdded) {\n            figureCliquable.dataset.listenerAdded = 'true' // Marquer comme ajout\n            figureCliquable.addEventListener('click', () => {\n              const val = Array.from(figureCliquables).reduce((acc, b) => {\n                if ((b as any).etat) {\n                  acc = true\n                }\n                return acc\n              }, false)\n              // au moins une figure coche\n              if ($canOptions.questionGetAnswer[index] !== val) {\n                $canOptions.questionGetAnswer[index] = val\n              }\n            })\n          }\n        }\n        return\n      }\n\n      const clocks =\n        questionContainer?.querySelectorAll<HTMLInputElement>('[id^=\"clockEx\"]')\n      if (clocks.length > 0) {\n        $keyboardState.isVisible = false\n        if (!clocks[0].dataset.listenerAdded) {\n          clocks[0].dataset.listenerAdded = 'true' // Marquer comme ajout\n          clocks[0].addEventListener('click', () => {\n            if ($canOptions.questionGetAnswer[index] !== true) {\n              $canOptions.questionGetAnswer[index] = true\n            }\n          })\n        }\n        return\n      }\n\n      const qcm = questionContainer?.querySelectorAll<HTMLInputElement>(\n        'input[id^=\"checkEx\"]',\n      )\n      if (qcm.length > 0) {\n        $keyboardState.isVisible = false\n        for (const box of qcm) {\n          if (!box.dataset.listenerAdded) {\n            box.dataset.listenerAdded = 'true' // Marquer comme ajout\n            box.addEventListener('click', () => {\n              const val = Array.from(qcm).reduce((acc, b) => {\n                if (b.checked) {\n                  acc = true\n                }\n                return acc\n              }, false)\n              // au moins 1 coch\n              if ($canOptions.questionGetAnswer[index] !== val) {\n                $canOptions.questionGetAnswer[index] = val\n              }\n            })\n          }\n        }\n        return\n      }\n\n      const apigeoms =\n        questionContainer?.querySelectorAll<HTMLElement>('[id^=\"apigeom\"]')\n      if (apigeoms.length > 0) {\n        $keyboardState.isVisible = false\n        if (!apigeoms[0].dataset.listenerAdded) {\n          apigeoms[0].dataset.listenerAdded = 'true' // Marquer comme ajout\n\n          function handleApigeomClick(this: HTMLElement, ev: Event) {\n            // MGu: il faudrait faire mieux mais bon...\n            // Un click sur la figure ne fonctionne pas car dans apigeom, il ne se propage pas...\n            // donc on surveille mouseleave ou touchend est suffisant pour valider la question\n            if ($canOptions.questionGetAnswer[index] !== true) {\n              $canOptions.questionGetAnswer[index] = true\n            }\n          }\n          apigeoms[0]\n            .querySelector('#divFigure > svg')\n            ?.addEventListener('pointerleave', handleApigeomClick)\n        }\n        return\n      }\n\n      const selects =\n        questionContainer?.querySelectorAll<HTMLSelectElement>(\n          'select[id^=\"ex\"]',\n        )\n      if (selects.length > 0) {\n        $keyboardState.isVisible = false\n        for (const select of selects) {\n          if (!select.dataset.listenerAdded) {\n            select.dataset.listenerAdded = 'true' // Marquer comme ajout\n            select.addEventListener('change', function () {\n              if (select.selectedIndex > 0) {\n                if ($canOptions.questionGetAnswer[index] !== true) {\n                  $canOptions.questionGetAnswer[index] = true\n                }\n              } else {\n                if ($canOptions.questionGetAnswer[index] !== false) {\n                  $canOptions.questionGetAnswer[index] = false\n                }\n              }\n            })\n          }\n        }\n        return\n      }\n\n      const rectangles = questionContainer?.querySelectorAll<HTMLInputElement>(\n        '[id^=\"rectangle\"].rectangleDND',\n      )\n      if (rectangles.length > 0) {\n        $keyboardState.isVisible = false\n        for (const rectangle of rectangles) {\n          if (!rectangle.dataset.listenerAdded) {\n            rectangle.dataset.listenerAdded = 'true' // Marquer comme ajout\n            const onHoverEnd = function () {\n              const divCount = rectangle.querySelectorAll(':scope > div').length\n              if (divCount > 0) {\n                if ($canOptions.questionGetAnswer[index] !== true) {\n                  $canOptions.questionGetAnswer[index] = true\n                }\n              } else {\n                if ($canOptions.questionGetAnswer[index] !== false) {\n                  $canOptions.questionGetAnswer[index] = false\n                }\n              }\n            }\n            rectangle.addEventListener('mouseleave', onHoverEnd)\n            rectangle.addEventListener('touchend', onHoverEnd)\n          }\n        }\n        return\n      }\n    }\n  }\n</script>\n\n<div\n  id=\"question-content-{index}\"\n  class={visible\n    ? 'px-4 md:px-20 lg:px-32 flex flex-col justify-center items-center font-normal leading-relaxed h-[100%]  w-[100%] text-center'\n    : 'hidden'}\n  bind:this={questionContainer}\n>\n  {#if mode === 'display' || mode === 'correction'}\n    <div\n      style=\"padding:15px;\"\n      class=\"flex flex-col overflow-x-auto overflow-y-auto\"\n    >\n      <div class=\"text-pretty\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html consigne}\n      </div>\n      <div class=\"text-pretty\" style=\"\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html question}\n      </div>\n    </div>\n  {/if}\n\n  {#if mode === 'correction'}\n    <div\n      class=\"relative flex p-4 mt-10 bg-coopmaths-warn-200 dark:bg-coopmathsdark-warn-lightest text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      <div class=\"text-pretty\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html consigneCorrection}\n      </div>\n      <div class=\"text-pretty\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html correction}\n      </div>\n      <div\n        class=\"flex absolute top-8 -left-12 font-bold text-xl text-coopmaths-warn-1000 dark:text-coopmathsdark-warn-dark -rotate-90\"\n      >\n        Solution\n      </div>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  export let widthFactor: number\n  export let displayedTime: string\n</script>\n\n<div\n  class=\"w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas flex flex-row\"\n>\n  <div\n    class=\"relative h-5 bg-coopmaths-warn-500 dark:bg-coopmathsdark-struct-dark\"\n    style=\"width: calc( 100% * {widthFactor} );\"\n  >\n    <div\n      id=\"time-display-1\"\n      class=\"{widthFactor <= 0.2\n        ? 'hidden'\n        : ''} absolute right-2 top-1/2 -translate-y-1/2 text-coopmaths-corpus dark:text-coopmaths-corpus font-extralight dark:font-light text-lg\"\n    >\n      {displayedTime}\n    </div>\n  </div>\n  <div\n    class=\"relative h-5 bg-coopmaths-action/70 dark:bg-coopmathsdark-warn-light/70\"\n    style=\"width: calc( 100% * ( 1 - {widthFactor} ) );\"\n  >\n    <div\n      id=\"time-display-2\"\n      class=\"{widthFactor > 0.2\n        ? 'hidden'\n        : ''} absolute left-2 top-1/2 -translate-y-1/2 text-coopmaths-corpus dark:text-coopmaths-corpus font-extralight dark:font-light text-lg\"\n    >\n      {displayedTime}\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { onDestroy, createEventDispatcher } from 'svelte'\n  import ElapsedTime from './ElapsedTime.svelte'\n  import { millisecondToMinSec } from '../../../../lib/components/time'\n\n  export let durationInMilliSeconds\n  const dispatch = createEventDispatcher()\n\n  let elapsed = 0\n  const duration = durationInMilliSeconds // 1min\n  let displayedTime = ''\n  let widthFactor = 1\n\n  let lastTime = window.performance.now()\n  let frame: number | undefined\n  ;(function update() {\n    const time = window.performance.now()\n    elapsed += time - lastTime\n\n    if (elapsed > duration) {\n      terminateTimer()\n    } else {\n      frame = requestAnimationFrame(update)\n      const timeD = millisecondToMinSec(duration - elapsed)\n      const formattedtime = [\n        timeD.minutes.toString().padStart(2, '0'),\n        timeD.seconds.toString().padStart(2, '0'),\n      ].join(':')\n\n      displayedTime = formattedtime\n      widthFactor = (duration - elapsed) / duration\n      lastTime = time\n    }\n  })()\n\n  export const terminateTimer = (): void => {\n    if (frame) cancelAnimationFrame(frame)\n    frame = undefined\n    dispatch('message', {\n      state: 'endTimer',\n      elapsed,\n      duration,\n    })\n  }\n  onDestroy(() => {\n    if (frame) cancelAnimationFrame(frame)\n    frame = undefined\n  })\n</script>\n\n<ElapsedTime {widthFactor} {displayedTime} />\n","<script lang=\"ts\">\n  import { afterUpdate } from 'svelte'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n  import Keyboard from '../../../keyboard/Keyboard.svelte'\n  import { keyboardState } from '../../../keyboard/stores/keyboardStore'\n  import NavigationButtons from './NavigationButtons.svelte'\n  import Pagination from './Pagination.svelte'\n  import Question from './Question.svelte'\n  import Timer from './Timer.svelte'\n\n  export let state: CanState\n  export let numberOfSeconds: number = 20\n  export let checkAnswers: () => void\n  let current: number = 0\n  export let questions: string[]\n  export let consignes: string[]\n  const numberOfQuestions: number = questions.length\n  let timerComponent: Timer\n\n  afterUpdate(() => {\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n  })\n\n  function endTimer(e: CustomEvent) {\n    const du = parseInt(e.detail.duration)\n    const el = parseInt(e.detail.elapsed)\n    $canOptions.remainingTimeInSeconds =\n      el >= du ? 0 : Math.floor((du - el) / 1000)\n    handleEndOfRace()\n  }\n  /**\n   * Gestion de la fin de la course : on annule le dcompte,\n   * si le mode interactif est prsent, on vrifie les questions\n   * et on bascule sur l'tat `end`\n   */\n  function handleEndOfRace() {\n    if ($canOptions.isInteractive) {\n      checkAnswers()\n    }\n    state = 'end'\n  }\n\n  function nextQuestion() {\n    if (current < numberOfQuestions - 1) {\n      current += 1\n    }\n  }\n</script>\n\n<div\n  class=\"w-full h-full flex flex-col justify-between items-center overflow-y-auto bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  <div class=\"w-full flex flex-col\">\n    <Timer\n      bind:this={timerComponent}\n      durationInMilliSeconds={numberOfSeconds * 1000}\n      on:message={endTimer}\n    />\n    <Pagination\n      bind:current\n      {numberOfQuestions}\n      state={'race'}\n      resultsByQuestion={[]}\n    />\n  </div>\n  <div\n    id=\"questions-container\"\n    class=\"flex flex-col justify-center items-center font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus text-3xl md:text-5xl\n     {$keyboardState.isVisible && !$keyboardState.isInLine\n      ? 'h-[calc(100%-30rem)]'\n      : ''}\n     {$keyboardState.isVisible && $keyboardState.isInLine\n      ? 'h-[calc(100%-20rem)]'\n      : ''}\n     {!$keyboardState.isVisible ? 'h-full' : ''} w-full\"\n  >\n    {#each [...Array(numberOfQuestions).keys()] as i}\n      <Question\n        consigne={consignes[i]}\n        question={questions[i]}\n        consigneCorrection={''}\n        correction={''}\n        mode={'display'}\n        visible={current === i}\n        index={i}\n        {nextQuestion}\n      />\n    {/each}\n  </div>\n  <div\n    class=\"flex justify-center w-full {$keyboardState.isVisible &&\n    $keyboardState.isInLine\n      ? 'mb-20'\n      : ''} {$keyboardState.isVisible && !$keyboardState.isInLine\n      ? 'mb-52'\n      : ''}\"\n  >\n    <NavigationButtons\n      bind:current\n      {numberOfQuestions}\n      handleEndOfRace={() => {\n        timerComponent.terminateTimer()\n      }}\n      {state}\n      resultsByQuestion={[]}\n    />\n  </div>\n  <Keyboard />\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../lib/components/time'\n\n  export let titles: string[] = ['', '']\n  export let value: boolean = true\n  export let isDisabled: boolean = false\n  export let classAddenda: string = ''\n  export let textSize: string = 'sm'\n  export let buttonSize: string = 'sm'\n  export let id: string = 'toggle-' + getUniqueStringBasedOnTimeStamp()\n\n  const dispatch = createEventDispatcher()\n\n  function toggle() {\n    value = !value\n    dispatch('toggle')\n  }\n</script>\n\n<!--\n  @component\n  Bouton toogle avec deux tats\n\n  __Paramtres__ :\n\n  * `titles` : tableau pour le titre du boutons (un pour `true`, un pour `false`)\n  * `value`: boolen li au bouton\n  * `isDisabled`: boolen servant  dsactiver le bouton\n  * `classAddenda`: chane correspondant  des _ajouts_ pour le style\n\n  Usage:\n    ```tsx\n  <ButtonToggle\n      titles={['Titre pour true', 'Titre pour false']}\n      bind:value={maVariable}\n      isDisabled={variable2 === 0}\n      on:click={maFonction}\n  />\n  ```\n -->\n<div class=\"flex flex-row justify-start items-center {classAddenda}\">\n  <button\n    type=\"button\"\n    {id}\n    class=\"flex justify-center items-center\"\n    on:click={toggle}\n    disabled={isDisabled}\n    aria-label={value ? titles[0] : titles[1]}\n  >\n    <i\n      class=\"bx bx-{buttonSize} translate-y-[0.15rem] {value\n        ? 'bx-toggle-right'\n        : 'bx-toggle-left'}\n        {isDisabled ? 'text-coopmaths-action/10 dark:text-coopmathsdark-action/10' : 'text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest'}\"\n      aria-describedby={value ? titles[0] : titles[1]}\n    ></i>\n  </button>\n  <div\n    class=\"{textSize === 'xs'\n      ? 'pl-1'\n      : 'pl-2'} inline-block text-{textSize} font-light {isDisabled\n      ? 'text-coopmaths-corpus/10 dark:text-coopmathsdark-corpus/10'\n      : 'text-coopmaths-corpus/70 dark:text-coopmathsdark-corpus/70'}\"\n  >\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html `${value ? titles[0] : titles[1]}`}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { afterUpdate, onMount } from 'svelte'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import ButtonToggle from '../../../shared/forms/ButtonToggle.svelte'\n  import NavigationButtons from './NavigationButtons.svelte'\n  import Pagination from './Pagination.svelte'\n  import Question from './Question.svelte'\n\n  let current: number = 0\n  export let questions: string[]\n  export let consignes: string[]\n  export let corrections: string[]\n  export let consignesCorrections: string[]\n  export let answers: string[]\n  export let resultsByQuestion: boolean[]\n  export let time: string\n  export let score: string\n  const numberOfQuestions: number = questions.length\n  const solutionDisplayed: boolean[] = new Array(numberOfQuestions).fill(false)\n\n  let displayCorrection = true\n\n  onMount(() => {\n    const questionContent = document.getElementById(\n      'can-solutions',\n    ) as HTMLDivElement\n    if (questionContent) {\n      mathaleaRenderDiv(questionContent)\n    }\n  })\n\n  afterUpdate(() => {\n    const answersContents = document.querySelectorAll(\n      '[id^=\"answer-container\"]',\n    )\n    for (let i = 0; i < answersContents.length; i++) {\n      const content = answersContents[i] as HTMLDivElement\n      mathaleaRenderDiv(content)\n    }\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n  })\n\n  function formatAnswer(question: string, answer: string) {\n    if (!answer) return 'aucune'\n    if (question.includes('checkbox')) return answer // Pour les QCM\n    if (question.includes('<liste-deroulante')) return answer // Pour les listeDeroulante\n    if (question.includes('interactive-clock'))\n      return `$${answer.split('h')[0]}$ h $${answer.split('h')[1]}$` // Pour les horloges interactives\n    if (question.includes('<input') && question.includes('champTexteEx'))\n      return answer // Pour les champTexte\n    if (question.includes('apigeomEx')) return answer // Pour le \"Voir figure\" des figures apigeom\n    if (question.includes('divDragAndDropEx')) return answer // Pour les drag and drop\n    return '$' + cleanFillInTheBlanks(answer, false) + '$'\n  }\n\n  function removeMathField(text: string, removeDollar: boolean = true) {\n    if (typeof text !== 'string') return ''\n    if (text.includes('placeholder'))\n      return cleanFillInTheBlanks(text, removeDollar) // Pour les fillInTheBlanks\n    if (text.includes('interactive-clock')) return removeInteractiveClock(text) // Pour les horloges interactives\n    if (text.includes('<select')) return cleanSelect(text) // Pour les listeDeroulante\n    const regex = /<math-field[^>]*>[^]*?<\\/math-field>/g\n    return text.replace(regex, ' ... ')\n  }\n\n  function cleanSelect(text: string) {\n    const regex = /<select[^>]*>[^]*?<\\/select>/g\n    return text.replace(regex, '')\n  }\n\n  function cleanFillInTheBlanks(text: string, removeDollar: boolean = true) {\n    if (typeof text !== 'string') return ''\n    if (removeDollar) text = text.replace(/\\$/g, '')\n    return text\n      .replace(/\\\\placeholder(\\[[^\\]]*\\])+/g, '')\n      .replace(/\\{\\}/g, '{...}')\n  }\n\n  function removeInteractiveClock(text: string) {\n    if (typeof text !== 'string') return ''\n    const regex = /<interactive-clock[^>]*\\/>/g\n    return text.replace(regex, '')\n  }\n</script>\n\n<div\n  class=\"w-full h-full flex flex-col items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n   {$canOptions.solutionsMode === 'split'\n    ? 'justify-between'\n    : 'justify-start'}\"\n>\n  {#if $canOptions.solutionsMode === 'split'}\n    <div class=\"w-full flex flex-col\">\n      <Pagination\n        bind:current\n        {numberOfQuestions}\n        {resultsByQuestion}\n        state={'solutions'}\n      />\n    </div>\n    <div\n      class=\"flex flex-col justify-center items-center font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus text-3xl md:text-5xl\"\n    >\n      {#key current}\n        <Question\n          consigne={consignes[current]}\n          question={questions[current]}\n          consigneCorrection={consignesCorrections[current]}\n          correction={corrections[current]}\n          mode={'correction'}\n          visible={true}\n          index={current}\n          nextQuestion={() => {}}\n        />\n        {#if $canOptions.isInteractive}\n          <div\n            id=\"answer-container-{current}\"\n            class=\"text-2xl text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light py-2 md:py-4\"\n          >\n            Rponse donne&nbsp;:&nbsp;\n            <span\n              id=\"answer-{current}\"\n              class=\"text-coopmaths-warn-800 dark:text-coopmathsdark-warn font-medium\"\n            >\n              {@html formatAnswer(questions[current], answers[current])}\n            </span>\n          </div>\n        {/if}\n      {/key}\n    </div>\n    <NavigationButtons\n      bind:current\n      {numberOfQuestions}\n      state={'solutions'}\n      {resultsByQuestion}\n      handleEndOfRace={() => {}}\n    />\n  {/if}\n  {#if $canOptions.solutionsMode === 'gathered'}\n    <div\n      class=\"w-full flex justify-center items-center p-6 bg-coopmaths-struct text-coopmaths-canvas dark:bg-coopmathsdark-struct dark:text-coopmathsdark-canvas text-5xl md:text-7xl font-black\"\n    >\n      Corrections\n    </div>\n    <div\n      class=\"w-full grid grid-rows-3 md:grid-cols-3 py-4 px-4 md:px-10 mb-10\"\n    >\n      {#if $canOptions.isInteractive}\n        <div\n          id=\"score\"\n          class=\"text-normal text-center text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light\"\n        >\n          Score : <span\n            class=\"text-coopmaths-warn-1000 dark:text-coopmathsdark-warn font-bold\"\n            >{score}</span\n          >\n        </div>\n      {/if}\n      <div\n        id=\"score\"\n        class=\"text-normal text-center text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light\"\n      >\n        Temps : <span\n          class=\"text-coopmaths-warn-1000 dark:text-coopmathsdark-warn font-bold\"\n          >{time}</span\n        >\n      </div>\n      <div class=\"flex justify-center text-center\">\n        <ButtonToggle\n          bind:value={displayCorrection}\n          titles={[\n            'Correction uniquement des mauvaises rponses',\n            'Correction de toutes les questions',\n          ]}\n        />\n      </div>\n    </div>\n    <ol\n      class=\"w-full list-none list-inside text-base flex flex-row flex-wrap p-4 md:p-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      id=\"can-solutions\"\n    >\n      {#each [...Array(numberOfQuestions).keys()] as i}\n        <li class=\"break-inside-avoid-column mx-2 min-w-[32%]\">\n          <div class=\"flex flex-row items-center justify-start\">\n            <div\n              class=\"text-lg text-coopmaths-struct dark:text-coopmathsdark-struct font-bold\"\n            >\n              Question {i + 1}\n            </div>\n            <div class={$canOptions.isInteractive ? 'flex text-xl' : 'hidden'}>\n              {#if resultsByQuestion[i]}\n                <button\n                  type=\"button\"\n                  aria-label=\"Afficher la correction\"\n                  on:click={() => {\n                    solutionDisplayed[i] = !solutionDisplayed[i]\n                  }}\n                >\n                  <i\n                    class=\"pl-2 bx bxs-check-square text-coopmaths-warn-800 dark:text-green-500\"\n                  ></i>\n                </button>\n              {:else}\n                <i\n                  class=\"pl-2 bx bxs-x-square text-red-500 dark:text-coopmathsdark-warn\"\n                ></i>\n              {/if}\n            </div>\n          </div>\n          <div class=\"flex flex-col\">\n            <div\n              class=\"p-2 text-pretty text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n              hidden={!solutionDisplayed[i] &&\n                resultsByQuestion[i] &&\n                displayCorrection}\n            >\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html removeMathField(questions[i], false)}\n            </div>\n            <div\n              class=\"p-2 text-pretty bg-coopmaths-warn-200 dark:bg-coopmathsdark-warn-lightest text-coopmaths-corpus dark:text-coopmathsdark-corpus-darkest\"\n              hidden={!solutionDisplayed[i] &&\n                resultsByQuestion[i] &&\n                displayCorrection}\n            >\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html consignesCorrections[i]}\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html corrections[i]}\n            </div>\n            <div\n              id=\"answer-container-{i}\"\n              class=\"{$canOptions.isInteractive &&\n              (!resultsByQuestion[i] || !displayCorrection)\n                ? 'flex text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light py-2 md:py-4'\n                : 'hidden'} \"\n            >\n              Rponse donne&nbsp;:&nbsp;\n              <span\n                id=\"answer-{i}\"\n                class=\"text-coopmaths-warn-1000 dark:text-coopmathsdark-warn font-medium\"\n              >\n                {@html formatAnswer(questions[i], answers[i])}\n              </span>\n            </div>\n          </div>\n        </li>\n      {/each}\n    </ol>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import MetaExercice from '../../../exercices/MetaExerciceCan'\n  import {\n    buildExercisesList,\n    splitExercisesIntoQuestions,\n  } from '../../../lib/components/exercisesUtils'\n  import { millisecondToMinSec } from '../../../lib/components/time'\n  import {\n    answersFromCapytale,\n    assignmentDataFromCapytale,\n    sendToCapytaleSaveStudentAssignment,\n  } from '../../../lib/handleCapytale'\n  import {\n    indexQuestionCliqueFigure,\n    verifQuestionCliqueFigure,\n  } from '../../../lib/interactif/cliqueFigure'\n  import { verifDragAndDrop } from '../../../lib/interactif/DragAndDrop'\n  import { verifQuestionMathLive } from '../../../lib/interactif/mathLive'\n  import { verifQuestionQcm } from '../../../lib/interactif/qcm'\n  import { verifQuestionListeDeroulante } from '../../../lib/interactif/questionListeDeroulante'\n  import { mathaleaUpdateUrlFromExercicesParams } from '../../../lib/mathalea'\n  import { canOptions } from '../../../lib/stores/canStore'\n  import {\n    darkMode,\n    exercicesParams,\n    resultsByExercice,\n  } from '../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import type { InterfaceResultExercice } from '../../../lib/types'\n  import type { CanState } from '../../../lib/types/can'\n  import { context } from '../../../modules/context'\n  import { statsCanTracker } from '../../../modules/stats'\n  import { keyboardState } from '../../keyboard/stores/keyboardStore'\n  import ButtonToggleDarkMode from '../../shared/forms/ButtonToggleDarkMode.svelte'\n  import CountDown from './presentationalComponents/CountDown.svelte'\n  import End from './presentationalComponents/End.svelte'\n  import KickOff from './presentationalComponents/KickOff.svelte'\n  import Race from './presentationalComponents/Race.svelte'\n  import Solutions from './presentationalComponents/Solutions.svelte'\n\n  let state: CanState = 'canHomeScreen'\n  let exercises: TypeExercice[] = []\n  let questions: string[] = []\n  let consignes: string[] = []\n  let corrections: string[] = []\n  let consignesCorrections: string[] = []\n  let indiceExercice: number[] = []\n  let indiceQuestionInExercice: number[] = []\n  let resultsByQuestion: boolean[] = []\n  let answers: string[] = []\n  let recordedTimeFromCapytale: number\n  onMount(async () => {\n    // handleCapytale peut changer la valeur du store pour que le\n    // professeur aille directement aux solutions de l'lve ou pour l'empcher de recommencer\n    canOptions.subscribe((value) => {\n      state = value.state\n      if (value.state !== 'solutions' && value.state !== 'canHomeScreen') return\n      if (answersFromCapytale.length === 0) {\n        return\n      }\n      for (const param of exercises) {\n        param.interactif = false\n      }\n\n      for (const exercice of answersFromCapytale) {\n        if (exercice.answers === undefined) {\n          answers.push('')\n          continue\n        }\n        const keys = Object.keys(exercice.answers)\n        if (keys.length > 1) {\n          const regex = /^Ex\\d+Q\\d+$/\n          const key = keys.find((k) => regex.test(k))\n          answers.push(key ? exercice.answers[key] : '')\n        } else if (keys.length === 1) {\n          const value = exercice.answers[keys[0]]\n          if (value?.includes('apiGeomVersion')) {\n            answers.push('Voir figure')\n            const event = new CustomEvent(keys[0], { detail: value })\n            document.dispatchEvent(event)\n          } else {\n            answers.push(value ? exercice.answers[keys[0]] : '')\n          }\n        } else {\n          answers.push('')\n        }\n      }\n      console.info('answers', answers)\n\n      if (assignmentDataFromCapytale?.resultsByQuestion !== undefined)\n        resultsByQuestion = assignmentDataFromCapytale.resultsByQuestion\n      if (assignmentDataFromCapytale?.duration !== undefined)\n        recordedTimeFromCapytale = assignmentDataFromCapytale.duration\n    })\n    context.isDiaporama = true\n    // force le mode interactif\n    globalOptions.update((gOpt) => {\n      gOpt.setInteractive = '1'\n      return gOpt\n    })\n    // reconstitution des exercices\n    exercises = await Promise.all(buildExercisesList())\n    // met  jour la url avec la graine...\n    mathaleaUpdateUrlFromExercicesParams(get(exercicesParams))\n    // interactivit\n    if ($canOptions.isInteractive) {\n      $keyboardState.isVisible = true\n      for (const param of exercises) {\n        param.interactif = true\n      }\n    }\n    // dcoupage des exerices en questions\n    const splitResults = splitExercisesIntoQuestions(exercises)\n    questions = [...splitResults.questions]\n    consignes = [...splitResults.consignes]\n    corrections = [...splitResults.corrections]\n    consignesCorrections = [...splitResults.consignesCorrections]\n    indiceExercice = [...splitResults.indiceExercice]\n    indiceQuestionInExercice = [...splitResults.indiceQuestionInExercice]\n    for (let i = 0; i < questions.length; i++) {\n      $canOptions.questionGetAnswer.push(false)\n    }\n  })\n\n  type answerType = {\n    type:\n      | 'mathlive'\n      | 'fillInTheBlank'\n      | 'dnd'\n      | 'qcm'\n      | 'listeDeroulante'\n      | 'custom'\n      | 'cliqueFigure'\n      | 'unknown'\n    index: number\n    answers?: { [key: string]: string }\n    answerTxt: string\n  }\n\n  function checkAnswers() {\n    statsCanTracker($globalOptions.recorder ?? '', $globalOptions.v ?? '')\n    const answersType: answerType[] = []\n    for (let i = 0; i < questions.length; i++) {\n      const exercice = exercises[indiceExercice[i]]\n      const type =\n        exercice.autoCorrection?.[indiceQuestionInExercice[i]]?.reponse?.param\n          ?.formatInteractif ?? exercice.interactifType\n      if (type === 'mathlive' || type === 'fillInTheBlank') {\n        resultsByQuestion[i] = Boolean(\n          verifQuestionMathLive(exercice, indiceQuestionInExercice[i])?.isOk,\n        )\n        // rcupration de la rponse\n        answersType[i] = {\n          type,\n          index: i,\n          answers: {\n            [`Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`]:\n              exercice.answers![\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n              ],\n          },\n          answerTxt:\n            exercice.answers![\n              `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n            ],\n        }\n        answers[i] = answersType[i].answerTxt\n      } else if (type === 'dnd') {\n        resultsByQuestion[i] = verifDragAndDrop(\n          exercice,\n          indiceQuestionInExercice[i],\n        ).isOk\n        // rcupration de la rponse\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter(\n              (key: string) =>\n                key.startsWith(\n                  `rectangleDNDEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ) ||\n                key.startsWith(\n                  `texteDNDEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.startsWith(\n                `texteDNDEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: string, k) => {\n              result = exercice.answers![k]\n              return result\n            }, ''),\n        }\n        answers[i] = answersType[i].answerTxt\n        answersType[i].answers![\n          `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n        ] = answersType[i].answerTxt\n      } else if (type === 'qcm') {\n        resultsByQuestion[i] =\n          verifQuestionQcm(exercice, indiceQuestionInExercice[i]) === 'OK'\n        // rcupration de la rponse\n        const propositions =\n          exercice.autoCorrection[indiceQuestionInExercice[i]].propositions\n        const qcmAnswers: string[] = []\n        propositions!.forEach((proposition, indice: number) => {\n          if (\n            exercice.answers![\n              `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}R${indice}`\n            ] === '1'\n          ) {\n            if (proposition.texte !== undefined) {\n              qcmAnswers.push(proposition.texte)\n            }\n          }\n        })\n        answers[i] = qcmAnswers.join(' ; ')\n        exercice.answers![\n          `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n        ] = answers[i]\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.startsWith(\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: answers[i],\n        }\n      } else if (type === 'listeDeroulante') {\n        resultsByQuestion[i] =\n          verifQuestionListeDeroulante(\n            exercice,\n            indiceQuestionInExercice[i],\n          ) === 'OK'\n        answers[i] =\n          exercice.answers?.[\n            `ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n          ] ??\n          exercice.answers?.[\n            `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n          ] ??\n          ''\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter(\n              (key: string) =>\n                key.startsWith(\n                  `ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ) ||\n                key.startsWith(\n                  `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: answers[i],\n        }\n      } else if (type === 'cliqueFigure') {\n        resultsByQuestion[i] =\n          verifQuestionCliqueFigure(exercice, indiceQuestionInExercice[i]) ===\n          'OK'\n        answers[i] = indexQuestionCliqueFigure(\n          exercice,\n          indiceQuestionInExercice[i],\n        )\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.endsWith(\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: answers[i],\n        }\n      } else if (type === 'custom') {\n        // si le type est `custom` on est sr que `correctionInteractive` existe\n        // d'o le ! aprs `correctionInteractive`\n        if (exercice instanceof MetaExercice) {\n          const result = exercice.correctionInteractives[\n            indiceQuestionInExercice[i]\n          ](indiceQuestionInExercice[i])\n          Array.isArray(result)\n            ? (resultsByQuestion[i] = result.includes('OK'))\n            : (resultsByQuestion[i] = result === 'OK')\n        } else {\n          const result = exercice.correctionInteractive!(\n            indiceQuestionInExercice[i],\n          )\n          Array.isArray(result)\n            ? (resultsByQuestion[i] = result.includes('OK'))\n            : (resultsByQuestion[i] = result === 'OK')\n        }\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter(\n              (key: string) =>\n                key.endsWith(\n                  `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ) ||\n                key.startsWith(\n                  `apigeomEx${indiceExercice[i]}F${indiceQuestionInExercice[i]}`,\n                ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: '',\n        }\n        answersType[i].answerTxt = Object.keys(answersType[i].answers ?? {})\n          .filter((key: string, index: number) => index === 0)\n          .reduce((result: string, k) => {\n            result = answersType[i].answers![k]\n            return result\n          }, '')\n        answers[i] = answersType[i].answerTxt.includes('apiGeomVersion')\n          ? 'Voir figure'\n          : answersType[i].answerTxt\n      } else {\n        answersType[i] = {\n          type: 'unknown',\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.endsWith(\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: '',\n        }\n      }\n      // Pour Capytale, on a besoin du score de l'exercice et non de la question\n      // donc on sauvegarde le score dans l'exercice\n      if (resultsByQuestion[i] && exercice.score !== undefined) {\n        exercice.score++\n      }\n    }\n\n    // Dsactiver l'interactivit avant l'affichage des solutions\n    for (const param of exercises) {\n      param.interactif = false\n    }\n    const resultsByExerciceArray: InterfaceResultExercice[] = []\n    for (let i = 0, ind = 0; i < exercises.length; i++) {\n      const exercise = exercises[i]\n      for (let q = 0; q < exercise.nbQuestions; q++) {\n        const quest: InterfaceResultExercice = {\n          uuid: exercise.uuid,\n          title: exercise.titre,\n          indice: exercise.numeroExercice as number,\n          state: 'done',\n          alea: exercise.seed,\n          answers: answersType[ind].answers,\n          numberOfPoints: resultsByQuestion[ind] ? 1 : 0,\n          numberOfQuestions: 1,\n          bestScore: resultsByQuestion[ind] ? 1 : 0,\n          resultsByQuestion: [resultsByQuestion[ind]],\n          duration: Math.floor(\n            $canOptions.durationInMinutes * 60 -\n              $canOptions.remainingTimeInSeconds,\n          ),\n        }\n        ind++\n        resultsByExerciceArray.push(quest)\n      }\n    }\n    resultsByExercice.update((l) => {\n      l = resultsByExerciceArray\n      return l\n    })\n    if ($globalOptions.recorder === 'moodle') {\n      const url = new URL(window.location.href)\n      const iframe = url.searchParams.get('iframe')\n      console.info({\n        resultsByExercice: $resultsByExercice,\n        duration: getDuration(),\n        action: 'mathalea:score',\n        iframe,\n      })\n      window.parent.postMessage(\n        {\n          resultsByExercice: $resultsByExercice,\n          duration: getDuration(),\n          action: 'mathalea:score',\n          iframe,\n        },\n        '*',\n      )\n    } else if ($globalOptions.recorder === 'capytale') {\n      if (\n        getRecordedScore() > getScoreTotal() ||\n        (getRecordedScore() === getScoreTotal() &&\n          assignmentDataFromCapytale?.duration &&\n          assignmentDataFromCapytale?.duration < getDuration())\n      ) {\n        return\n      }\n      sendToCapytaleSaveStudentAssignment({\n        indiceExercice: 'all',\n        assignmentData: {\n          duration: getDuration(),\n          resultsByQuestion,\n        },\n      })\n    }\n  }\n\n  function getDuration(): number {\n    return Math.floor(\n      $canOptions.durationInMinutes * 60 - $canOptions.remainingTimeInSeconds,\n    )\n  }\n\n  /**\n   * Construit la chane qui sera affiche pour le score\n   * nombre de points obtenu / nombre de questions\n   */\n  function buildStringScore(): string {\n    const score = getScoreTotal()\n    return score + '/' + resultsByQuestion.length\n  }\n\n  function getScoreTotal(): number {\n    let score = 0\n    for (const result of resultsByQuestion) {\n      if (result === true) {\n        score++\n      }\n    }\n    return score\n  }\n\n  function getRecordedScore(): number {\n    let score = 0\n    if (assignmentDataFromCapytale?.resultsByQuestion !== undefined) {\n      for (const result of assignmentDataFromCapytale.resultsByQuestion) {\n        if (result === true) {\n          score++\n        }\n      }\n    }\n    return score\n  }\n\n  /**\n   * Construit la chane MM:SS qui sera affiche pour le temps mis  faire la course\n   */\n  function buildTime(): string {\n    const nbOfSeconds =\n      recordedTimeFromCapytale ||\n      $canOptions.durationInMinutes * 60 - $canOptions.remainingTimeInSeconds\n    const time = millisecondToMinSec(nbOfSeconds * 1000)\n    return [\n      time.minutes.toString().padStart(2, '0'),\n      time.seconds.toString().padStart(2, '0'),\n    ].join(':')\n  }\n</script>\n\n<div\n  class=\"{$darkMode.isActive\n    ? 'dark'\n    : ''} relative w-full h-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  {#if state === 'start' || state === 'canHomeScreen'}\n    <KickOff subTitle={$canOptions.subTitle} bind:state />\n  {/if}\n  {#if state === 'countdown'}\n    <CountDown bind:state />\n  {/if}\n  {#if state === 'race'}\n    <Race\n      numberOfSeconds={$canOptions.durationInMinutes * 60}\n      bind:state\n      {questions}\n      {consignes}\n      {checkAnswers}\n    />\n  {/if}\n  {#if state === 'end'}\n    <End bind:state score={buildStringScore()} time={buildTime()} />\n  {/if}\n  {#if state === 'solutions'}\n    <Solutions\n      {questions}\n      {consignes}\n      {corrections}\n      {consignesCorrections}\n      {answers}\n      {resultsByQuestion}\n      score={buildStringScore()}\n      time={buildTime()}\n    />\n  {/if}\n  <div class=\"fixed flex bottom-2 right-2\">\n    <ButtonToggleDarkMode />\n  </div>\n</div>\n","let canvas: HTMLCanvasElement\n\nexport function remToPixels(rem: number) {\n  return rem * parseFloat(getComputedStyle(document.documentElement).fontSize)\n}\n\n/**\n * Uses canvas.measureText to compute and return the width of the given text of given font in pixels.\n *\n * @param {String} text The text to be rendered.\n * @param {String} font The css font descriptor that text is to be rendered with (e.g. \"bold 14px verdana\").\n *\n * @see https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript/21015393#21015393\n */\nexport function getTextWidth(\n  text: string,\n  font: string,\n  factor: number = 1,\n): number {\n  // re-use canvas object for better performance\n  if (canvas == null) {\n    canvas = document.createElement('canvas')\n  }\n  const context: CanvasRenderingContext2D | null = canvas.getContext('2d')\n  if (!context) {\n    throw new Error('Canvas context is null')\n  }\n  context.font = font\n  const metrics: TextMetrics = context.measureText(text)\n  return metrics.width * factor\n}\nexport function getCssStyle(element: HTMLElement, prop: string) {\n  return window.getComputedStyle(element, null).getPropertyValue(prop)\n}\nexport function getCanvasFontDetails(el = document.body) {\n  const fontWeight = getCssStyle(el, 'font-weight') || 'normal'\n  const fontSize = getCssStyle(el, 'font-size') || '16px'\n  const fontFamily = getCssStyle(el, 'font-family') || 'Times New Roman'\n\n  return {\n    weigth: `${fontWeight}`,\n    size: `${fontSize}`,\n    family: `${fontFamily}`,\n  }\n}\nexport function getCanvasFont(el = document.body) {\n  const fontWeight = getCssStyle(el, 'font-weight') || 'normal'\n  const fontSize = getCssStyle(el, 'font-size') || '16px'\n  const fontFamily = getCssStyle(el, 'font-family') || 'Times New Roman'\n\n  return `${fontWeight} ${fontSize} ${fontFamily}`\n}\n/**\n * Dtecter le type de machine sur lequel le site est utilis\n * ([Source](https://attacomsian.com/blog/javascript-detect-mobile-device))\n * @return {('mobile'|'tablet'|'desktop')} nom du type de machine\n * @author sylvain\n */\nexport const deviceType = () => {\n  const ua = navigator.userAgent\n  if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) {\n    return 'tablet'\n  } else if (\n    /Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(\n      ua,\n    )\n  ) {\n    return 'mobile'\n  }\n  return 'desktop'\n}\n","import type { InterfaceResultExercice } from './types'\n\ntype FlowmathRpcMessage =\n  | { type: 'READY' }\n  | { type: 'RESIZE'; payload: { height: number } }\n  | { type: 'ATTEMPT_STARTED'; payload: { attemptId: string | null } }\n  | { type: 'REPLAY_COMPLETED' }\n  | { type: 'ATTEMPT_FINISHED'; payload: FlowmathAttemptFinishedPayload }\n  | { type: 'ERROR'; payload: { message: string } }\n\nexport interface FlowmathAttemptFinishedPayload {\n  score: number\n  exercicesData: InterfaceResultExercice[]\n  totalQuestions: number\n  correctAnswers: number\n}\n\nlet readySent = false\nlet attemptStartedSentFor: string | null | undefined\n\nfunction postFlowmathRpc(message: FlowmathRpcMessage) {\n  if (typeof window === 'undefined') return\n  if (window.parent == null || window.parent === window) return\n  window.parent.postMessage(message, '*')\n}\n\nexport function sendFlowmathReady() {\n  if (readySent) return\n  readySent = true\n  postFlowmathRpc({ type: 'READY' })\n}\n\nexport function sendFlowmathResize(height: number | undefined | null) {\n  if (height == null || Number.isNaN(height)) return\n  postFlowmathRpc({\n    type: 'RESIZE',\n    payload: { height },\n  })\n}\n\nexport function sendFlowmathAttemptStarted(attemptId?: string | null) {\n  const normalized = attemptId ?? null\n  if (attemptStartedSentFor === normalized) return\n  attemptStartedSentFor = normalized\n  postFlowmathRpc({\n    type: 'ATTEMPT_STARTED',\n    payload: { attemptId: normalized },\n  })\n}\n\nexport function sendFlowmathAttemptFinished(\n  payload: FlowmathAttemptFinishedPayload,\n) {\n  postFlowmathRpc({\n    type: 'ATTEMPT_FINISHED',\n    payload,\n  })\n}\n\nexport function sendFlowmathReplayCompleted() {\n  postFlowmathRpc({ type: 'REPLAY_COMPLETED' })\n}\n\nexport function sendFlowmathError(message: string) {\n  const text = message?.toString().trim()\n  if (!text) return\n  postFlowmathRpc({\n    type: 'ERROR',\n    payload: { message: text },\n  })\n}\n\nexport function getFlowmathAttemptIdFromUrl(): string | null {\n  if (typeof window === 'undefined') return null\n  try {\n    const params = new URLSearchParams(window.location.search)\n    return (\n      params.get('attemptId') ||\n      params.get('flowmathAttemptId') ||\n      params.get('attemptID')\n    )\n  } catch {\n    return null\n  }\n}\n","import type { Writable } from 'svelte/store'\nimport { get } from 'svelte/store'\nimport {\n  getFlowmathAttemptIdFromUrl,\n  sendFlowmathAttemptFinished,\n  sendFlowmathAttemptStarted,\n  sendFlowmathError,\n  sendFlowmathReady,\n  sendFlowmathReplayCompleted,\n} from './flowmathRpc'\nimport { globalOptions } from './stores/globalOptions'\n\n/**\n * Interface pour les paramtres d'activit envoys par FlowMath\n */\ninterface FlowmathActivityParams {\n  mode: 'assignment' | 'review' | 'training'\n  exercicesParams: any[]\n  globalOptions?: {\n    v?: string\n    presMode?: string\n    isInteractiveFree?: boolean\n    done?: string\n    [key: string]: any\n  }\n}\n\n/**\n * Handler pour la communication RPC avec FlowMath\n * Ne s'active que si globalOptions.recorder === 'flowmath'\n */\nexport function handleFlowmath(\n  exercicesParams: Writable<any[]>,\n  resultsByExercice: Writable<any[]>,\n) {\n  if (typeof window === 'undefined') return\n\n  // Listen for messages from parent window\n  const onMessage = async (event: MessageEvent<any>) => {\n    if (!event.data || typeof event.data !== 'object') return\n\n    // Handle SET_ACTIVITY_PARAMS - load exercises from FlowMath\n    if (event.data.type === 'SET_ACTIVITY_PARAMS') {\n      console.info(\n        '[MathALEA-FlowMath] Received SET_ACTIVITY_PARAMS:',\n        event.data.payload,\n      )\n      const payload = event.data.payload as FlowmathActivityParams\n\n      if (\n        !payload?.exercicesParams ||\n        !Array.isArray(payload.exercicesParams)\n      ) {\n        console.error(\n          '[MathALEA-FlowMath] Invalid exercicesParams in SET_ACTIVITY_PARAMS',\n        )\n        sendFlowmathError('Invalid exercicesParams received')\n        return\n      }\n\n      // Update exercicesParams store with the received exercises\n      exercicesParams.set(payload.exercicesParams)\n      console.info(\n        '[MathALEA-FlowMath] Loaded exercises:',\n        payload.exercicesParams.length,\n        'with alea values:',\n        payload.exercicesParams\n          .map((e, i) => `[${i}]=${e?.alea ?? 'none'}`)\n          .join(', '),\n      )\n\n      // Update global options if provided\n      if (payload.globalOptions) {\n        globalOptions.update((opts) => {\n          const newOpts = { ...opts, ...payload.globalOptions }\n          // Ensure we stay in eleve view\n          if (!newOpts.v) newOpts.v = 'eleve'\n          newOpts.presMode = newOpts.presMode || 'un_exo_par_page'\n          newOpts.isInteractiveFree = false\n          return newOpts\n        })\n      }\n\n      // NOTE: We do NOT set done='1' in review mode anymore\n      // The validation buttons need to exist for programmatic validation\n      // After REPLAY_ATTEMPT fills answers and FINISH_ATTEMPT validates,\n      // the correction will be shown properly\n\n      // Signal that exercises are loaded and ready\n      window.parent.postMessage({ type: 'ACTIVITY_PARAMS_LOADED' }, '*')\n      return\n    }\n\n    if (event.data.type === 'FINISH_ATTEMPT') {\n      // Get exercices params to know how many exercises we have\n      const params = get(exercicesParams)\n\n      // Click validation button for each exercise\n      for (let i = 0; i < params.length; i++) {\n        const buttonScore = document.querySelector(\n          `#buttonScoreEx${i}`,\n        ) as HTMLButtonElement\n        if (buttonScore !== null) {\n          buttonScore.click()\n          await new Promise((resolve) => setTimeout(resolve, 500))\n        } else {\n          console.warn(\n            '[MathALEA-FlowMath] Validation button #buttonScoreEx' +\n              i +\n              ' not found',\n          )\n        }\n      }\n\n      await new Promise((resolve) => setTimeout(resolve, 1000))\n\n      // Collect complete results\n      const results = get(resultsByExercice)\n      let totalQuestions = 0\n      let correctAnswers = 0\n      for (const result of results) {\n        if (\n          result?.resultsByQuestion &&\n          Array.isArray(result.resultsByQuestion)\n        ) {\n          totalQuestions += result.resultsByQuestion.length\n          correctAnswers += result.resultsByQuestion.filter(\n            (r: boolean) => r === true,\n          ).length\n        } else if (result?.numberOfQuestions) {\n          totalQuestions += result.numberOfQuestions\n          if (result?.numberOfPoints !== undefined) {\n            correctAnswers += result.numberOfPoints\n          }\n        }\n      }\n\n      const score = totalQuestions > 0 ? correctAnswers / totalQuestions : 0\n\n      // Send complete results back to parent\n      sendFlowmathAttemptFinished({\n        score,\n        exercicesData: results,\n        totalQuestions,\n        correctAnswers,\n      })\n    }\n\n    if (event.data.type === 'REPLAY_ATTEMPT') {\n      const exercicesData = event.data.payload.exercicesData\n      if (!exercicesData || !Array.isArray(exercicesData)) {\n        console.error('[MathALEA-FlowMath] Invalid exercicesData')\n        sendFlowmathError('[MathALEA] Invalid exercicesData received')\n        return\n      }\n\n      // Get expected exercise count\n      const params = get(exercicesParams)\n      const expectedButtonCount = params.length\n\n      // Helper to wait for validation buttons to exist\n      const waitForValidationButtons = (): Promise<void> => {\n        return new Promise((resolve) => {\n          let attempts = 0\n          const maxAttempts = 50 // 5 seconds max (50 * 100ms)\n\n          const checkButtons = () => {\n            let foundCount = 0\n            for (let i = 0; i < expectedButtonCount; i++) {\n              if (document.querySelector(`#buttonScoreEx${i}`)) {\n                foundCount++\n              }\n            }\n\n            if (foundCount === expectedButtonCount) {\n              console.info(`[MathALEA-FlowMath] All ${expectedButtonCount} validation buttons found`)\n              resolve()\n            } else if (attempts >= maxAttempts) {\n              console.warn(`[MathALEA-FlowMath] Timeout waiting for validation buttons (found ${foundCount}/${expectedButtonCount})`)\n              resolve() // Resolve anyway to not block forever\n            } else {\n              attempts++\n              setTimeout(checkButtons, 100)\n            }\n          }\n\n          checkButtons()\n        })\n      }\n\n      // Wait for initial render\n      await new Promise((resolve) => setTimeout(resolve, 500))\n\n      // Import the necessary functions\n      const { mathaleaWriteStudentPreviousAnswers } =\n        await import('./mathaleaUtils')\n\n      // Reinject answers for each exercise\n      for (const exercice of exercicesData) {\n        if (exercice == null || !exercice.answers) continue\n\n        await Promise.all(mathaleaWriteStudentPreviousAnswers(exercice.answers))\n        await new Promise((resolve) => setTimeout(resolve, 100))\n      }\n\n      // Wait for validation buttons to be rendered before signaling completion\n      await waitForValidationButtons()\n\n      // Signal that replay is complete - parent can now send FINISH_ATTEMPT\n      console.info('[MathALEA-FlowMath] Replay complete, sending REPLAY_COMPLETED')\n      sendFlowmathReplayCompleted()\n    }\n  }\n\n  window.addEventListener('message', onMessage)\n\n  const onWindowError = (event: ErrorEvent) => {\n    if (!event?.message) return\n    sendFlowmathError(event.message)\n  }\n\n  const onUnhandledRejection = (event: PromiseRejectionEvent) => {\n    if (event?.reason == null) return\n    if (typeof event.reason === 'string') {\n      sendFlowmathError(event.reason)\n    } else if (event.reason instanceof Error) {\n      sendFlowmathError(event.reason.message)\n    } else {\n      sendFlowmathError(String(event.reason))\n    }\n  }\n\n  window.addEventListener('error', onWindowError)\n  window.addEventListener('unhandledrejection', onUnhandledRejection)\n\n  sendFlowmathReady()\n  sendFlowmathAttemptStarted(getFlowmathAttemptIdFromUrl())\n\n  return () => {\n    window.removeEventListener('message', onMessage)\n    window.removeEventListener('error', onWindowError)\n    window.removeEventListener('unhandledrejection', onUnhandledRejection)\n  }\n}\n","export function isLocalStorageAvailable() {\n  try {\n    window.localStorage.setItem('__test__', '__test__')\n    window.localStorage.removeItem('__test__')\n    return true\n  } catch (e) {\n    return false\n  }\n}\n","import type { IExercice } from '../../../lib/types'\n\nexport function countMathField(exercise: IExercice): number {\n  if (exercise == null) return 0\n  let numbOfAnswerFields: number = 0\n  if (exercise.interactif) {\n    if (!exercise.autoCorrection || !Array.isArray(exercise.autoCorrection)) {\n      return 0\n    }\n    for (const autoCorr of exercise.autoCorrection) {\n      if (\n        autoCorr != null &&\n        autoCorr.reponse != null &&\n        autoCorr.reponse.param != null &&\n        autoCorr.reponse.param.formatInteractif != null\n      ) {\n        if (\n          autoCorr.reponse?.param?.formatInteractif === 'mathlive' ||\n          autoCorr.reponse?.param?.formatInteractif === 'qcm'\n        ) {\n          numbOfAnswerFields++\n        }\n      }\n    }\n    if (\n      exercise.interactifType === 'custom' &&\n      'goodAnswers' in exercise &&\n      Array.isArray(exercise.goodAnswers)\n    ) {\n      for (const goodAnswer of exercise.goodAnswers) {\n        if (Array.isArray(goodAnswer)) {\n          numbOfAnswerFields += goodAnswer.length\n        } else {\n          numbOfAnswerFields++\n        }\n      }\n    }\n    return numbOfAnswerFields\n  }\n  return 0\n}\n","// Ajout le 15/07/2025 par JC-Lhote pour peermettre  des listeners de savoir que la correction est affiche\n\nimport { tick } from 'svelte'\n\n// Peut-tre est  dplacer dans un fichier de fonctions utilitaires ?\nexport function handleCorrectionAffichee() {\n  tick().then(() => {\n    if (document.querySelector('[id^=\"correction-exo\"]')) {\n      document.dispatchEvent(\n        new window.Event('correctionsAffichees', { bubbles: true }),\n      )\n      return\n    }\n    // Sinon, observe le DOM jusqu' ce que l'lment apparaisse\n    const observer = new MutationObserver(() => {\n      if (document.querySelector('[id^=\"correction-exo\"]')) {\n        document.dispatchEvent(\n          new window.Event('correctionsAffichees', { bubbles: true }),\n        )\n        observer.disconnect()\n      }\n    })\n    observer.observe(document.body, { childList: true, subtree: true })\n  })\n}\n","<script lang=\"ts\">\n  export let isMenuNeededForExercises: boolean\n  export let presMode: string | undefined\n  export let title: string\n  export let indiceExercice: number\n  export let showNumber = true\n  export let seed: string | undefined\n</script>\n\n<!--\n  @component\n  Barre de titre et d'actions au-dessus d'un exercice\n\n  __Utilisation__ :\n\n  ```tsx\n  const headerExerciceProps = {\n    title: exercice.titre,\n    indiceExercice: 2\n  }\n  <HeaderExerciceVueEleve {...headerExerciceProps}/>\n  ```\n -->\n\n<div class=\"z-0 flex-1\">\n  <h1\n    id=\"headerExoVueEleve-{indiceExercice}\"\n    class=\" text-coopmaths-struct dark:text-coopmathsdark-struct pb-2 flex {isMenuNeededForExercises\n      ? 'flex-col items-start'\n      : 'flex-row items-center'}\"\n  >\n    <!-- titre -->\n    <div\n      class=\"flex flex-row justify-start items-start\"\n      id=\"exerciceHeader{indiceExercice}\"\n    >\n      <div class={showNumber ? 'flex' : 'hidden'}>\n        <div\n          class=\"{isMenuNeededForExercises && presMode !== 'liste_exos'\n            ? 'hidden'\n            : 'inline-flex'} items-center justify-center h-6 w-6 bg-coopmaths-struct text-coopmaths-canvas font-light text-lg lg:text-normal translate-y-1\"\n        >\n          {indiceExercice + 1}\n        </div>\n      </div>\n      <div\n        class=\"font-light {isMenuNeededForExercises && presMode !== 'liste_exos'\n          ? 'text-xl'\n          : 'text-lg'} ml-2\"\n      >\n        {title}\n\n        <span class=\"text-[#FEFEFE] select-none pointer-events-none touch-none\"\n          >{seed}</span\n        >\n      </div>\n    </div>\n  </h1>\n</div>\n","<script lang=\"ts\">\n  export let isOnStateActive: boolean = false\n  export let size: number = 5\n</script>\n\n<!--\n  @component\n  Icne avec deux tats\n\n   ### Paramtres :\n\n  * `isOnStateActive` : boolen pour basculer entre les deux icnes\n  * `size`: nombre pour rgler la taille de l'icne (`5` par dfault)\n\n  ### Exemple :\n\n  ```tsx\n  <InteractivityIcon isOnStateActive={<monBoolean>}>\n    <i slot=\"icon_to_switch_on\" class=\"bx bxs-phone\" />\n    <i slot=\"icon_to_switch_off\" class=\"bx bxs-phone-off\" />\n  </InteractivityIcon>\n  ```\n -->\n<div class={isOnStateActive ? 'hidden' : 'block'}>\n  <slot name=\"icon_to_switch_on\">\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 8.467 8.467\"\n      class=\"fill-coopmaths-action dark:fill-coopmathsdark-action stroke-coopmaths-action dark:stroke-coopmathsdark-action\"\n      style=\"width: {size * 0.25}rem; height: {size * 0.25}rem;\"\n    >\n      <defs>\n        <marker\n          id=\"a\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n        <marker\n          id=\"b\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n      </defs>\n      <g transform=\"matrix(.87062 0 0 .87062 .723 1.111)\">\n        <path\n          d=\"M6.117 4.022a2.086 2.086 0 0 0-2.084 2.083c0 1.15.935 2.084 2.084 2.084A2.086 2.086 0 0 0 8.2 6.105a2.086 2.086 0 0 0-2.083-2.083zm0 3.75a1.669 1.669 0 0 1-1.52-2.35l.096.058c.082.052.164.104.268.143.103.04.226.065.391.065s.289-.026.392-.065c.103-.039.186-.09.268-.143.083-.052.165-.104.268-.143.103-.04.227-.065.392-.065s.289.026.392.065c.103.039.185.091.268.143.082.052.165.104.268.143.037.014.078.026.121.036.04.142.063.291.063.446 0 .92-.748 1.667-1.667 1.667z\"\n          style=\"stroke-width:.208363\"\n        ></path>\n        <circle cx=\"5.388\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n        <circle cx=\"6.846\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n      </g>\n      <path\n        d=\"M1.062.56h3.08a.474.474 0 0 1 .474.474v2.37a.474.474 0 0 1-.474.473h-3.08a.474.474 0 0 1-.474-.474v-2.37A.474.474 0 0 1 1.062.56Z\"\n        style=\"fill:none;stroke-width:.236966;stroke-linecap:round;stroke-linejoin:round\"\n      ></path>\n      <path\n        d=\"M.773.536.536.752v.432h4.029V.752L4.327.536Zm1.948.141h1.421a.118.118 0 0 1 .12.12.118.118 0 0 1-.12.12H2.721a.118.118 0 0 1-.12-.12.118.118 0 0 1 .12-.12ZM1.019.68a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .01 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.119.118.118.118 0 0 1-.118-.118.118.118 0 0 1 .11-.118z\"\n        style=\"stroke:none;stroke-width:.226291px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n      ></path>\n      <path\n        d=\"M7.062 3.945V1.536h-1.21\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#a)\"\n      ></path><path\n        d=\"M1.589 4.668v2.41h1.208\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#b)\"\n      ></path>\n    </svg>\n  </slot>\n</div>\n<div class=\" {isOnStateActive ? 'block' : 'hidden'}\">\n  <slot name=\"icon_to_switch_off\">\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 8.467 8.467\"\n      class=\"text-coopmaths-action dark:text-coopmathsdark-action fill-coopmaths-action dark:fill-coopmathsdark-action stroke-coopmaths-action dark:stroke-coopmathsdark-action\"\n      style=\"width: {size * 0.25}rem; height: {size * 0.25}rem;\"\n    >\n      <defs>\n        <marker\n          id=\"a\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n        <marker\n          id=\"b\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n      </defs>\n      <g transform=\"matrix(.87062 0 0 .87062 .723 1.111)\">\n        <path\n          d=\"M6.117 4.022a2.086 2.086 0 0 0-2.084 2.083c0 1.15.935 2.084 2.084 2.084A2.086 2.086 0 0 0 8.2 6.105a2.086 2.086 0 0 0-2.083-2.083zm0 3.75a1.669 1.669 0 0 1-1.52-2.35l.096.058c.082.052.164.104.268.143.103.04.226.065.391.065s.289-.026.392-.065c.103-.039.186-.09.268-.143.083-.052.165-.104.268-.143.103-.04.227-.065.392-.065s.289.026.392.065c.103.039.185.091.268.143.082.052.165.104.268.143.037.014.078.026.121.036.04.142.063.291.063.446 0 .92-.748 1.667-1.667 1.667z\"\n          style=\"stroke-width:.208363\"\n        ></path>\n        <circle cx=\"5.388\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n        <circle cx=\"6.846\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n      </g>\n      <path\n        d=\"M1.062.56h3.08a.474.474 0 0 1 .474.474v2.37a.474.474 0 0 1-.474.473h-3.08a.474.474 0 0 1-.474-.474v-2.37A.474.474 0 0 1 1.062.56Z\"\n        style=\"fill:none;stroke-width:.236966;stroke-linecap:round;stroke-linejoin:round\"\n      ></path>\n      <path\n        d=\"M.773.536.536.752v.432h4.029V.752L4.327.536Zm1.948.141h1.421a.118.118 0 0 1 .12.12.118.118 0 0 1-.12.12H2.721a.118.118 0 0 1-.12-.12.118.118 0 0 1 .12-.12ZM1.019.68a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .01 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.119.118.118.118 0 0 1-.118-.118.118.118 0 0 1 .11-.118z\"\n        style=\"stroke:none;stroke-width:.226291px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n      ></path>\n      <path\n        d=\"M7.062 3.945V1.536h-1.21\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#a)\"\n      ></path>\n      <path\n        d=\"M1.589 4.668v2.41h1.208\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#b)\"\n      ></path>\n      <path\n        d=\"m.53.53 7.407 7.407\"\n        style=\"fill:none;stroke-width:.79375;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1\"\n      ></path>\n    </svg>\n  </slot>\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../../lib/types'\n  import type TypeExercice from '../../../../../../exercices/Exercice'\n  import ButtonTextAction from '../../../../forms/ButtonTextAction.svelte'\n  import InteractivityIcon from '../../../../icons/TwoStatesIcon.svelte'\n  export let exercise: TypeExercice\n  export let indiceLastExercice: number\n  export let globalOptions: InterfaceGlobalOptions\n  export let newData: () => void\n  export let isCorrectionVisible: boolean\n  export let switchCorrectionVisible: () => void\n  export let isInteractif: boolean\n  export let switchInteractif: () => void\n  export let columnsCount: number\n  export let columnsCountUpdate: (plusMinus: '+' | '-') => void\n  export let showCorrectionButton: boolean = true\n  export let showInteractivityButton: boolean = true\n</script>\n\n<div\n  class=\"flex flex-row justify-start items-center {indiceLastExercice > 1 &&\n  globalOptions.presMode !== 'un_exo_par_page'\n    ? 'ml-2 lg:ml-6'\n    : 'ml-2'} mb-2 lg:mb-6 {globalOptions.presMode === 'recto' ||\n  globalOptions.presMode === 'verso'\n    ? 'hidden'\n    : 'flex'}\"\n>\n  <div\n    class={!globalOptions.oneShot && globalOptions.done !== '1'\n      ? 'flex'\n      : 'hidden'}\n  >\n    <ButtonTextAction\n      text=\"Nouvel nonc\"\n      icon=\"bx-refresh\"\n      class=\"py-[2px] px-2 text-[0.7rem]\"\n      inverted={true}\n      on:click={() => {\n        newData()\n      }}\n    />\n  </div>\n  {#if showCorrectionButton}\n    <div\n      class={globalOptions.isSolutionAccessible &&\n      !exercise.isDone &&\n      ((exercise.interactif && exercise.isDone) || !exercise.interactif)\n        ? 'flex ml-2'\n        : 'hidden'}\n    >\n      <ButtonTextAction\n        text={isCorrectionVisible\n          ? 'Masquer la correction'\n          : 'Voir la correction'}\n        icon={isCorrectionVisible ? 'bx-hide' : 'bx-show'}\n        class=\"py-[2px] px-2 text-[0.7rem] w-36\"\n        inverted={true}\n        on:click={switchCorrectionVisible}\n      />\n    </div>\n  {/if}\n  {#if showInteractivityButton}\n    <button\n      class={globalOptions.isInteractiveFree && exercise?.interactifReady\n        ? 'w-5 ml-2 tooltip tooltip-right tooltip-neutral '\n        : 'hidden'}\n      data-tip={isInteractif\n        ? \"Dsactiver l'interactivit\"\n        : 'Rendre interactif'}\n      type=\"button\"\n      on:click={switchInteractif}\n    >\n      <InteractivityIcon isOnStateActive={isInteractif} size={4} />\n    </button>\n  {/if}\n  {#if globalOptions.recorder === undefined}\n    <div\n      class=\"hidden md:flex flex-row justify-start items-center text-coopmaths-struct dark:text-coopmathsdark-struct text-xs\"\n    >\n      <button\n        class={columnsCount > 1 && window.innerWidth > 1000\n          ? 'visible'\n          : 'invisible'}\n        type=\"button\"\n        aria-label=\"Rduire le nombre de colonnes\"\n        on:click={() => columnsCountUpdate('-')}\n      >\n        <i\n          class=\"text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-2 bx-xs bx-minus\"\n        ></i>\n      </button>\n      <i class=\"bx ml-1 bx-xs bx-columns\"></i>\n      <button type=\"button\" aria-label=\"Augmenter le nombre de colonnes\" on:click={() => columnsCountUpdate('+')}>\n        <i\n          class=\"text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-1 bx-xs bx-plus\"\n        ></i>\n      </button>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../../../../exercices/Exercice'\n  import { mathaleaFormatExercice } from '../../../../../../lib/mathalea'\n\n  export let exercise: TypeExercice\n  export let exerciseIndex: number\n  export let questionIndex: number\n  export let isCorrectionVisible: boolean\n</script>\n\n<div\n  style=\"break-inside:avoid\"\n  id=\"consigne{exerciseIndex}-{questionIndex}\"\n  class=\"container max-w-full text-justify grid grid-cols-1 auto-cols-min gap-4 mb-3 lg:mb-4\"\n>\n  <li\n    id=\"exercice{exerciseIndex}Q{questionIndex}\"\n    style=\"line-height: {exercise.spacing || 1}\"\n  >\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html mathaleaFormatExercice(exercise.listeQuestions[questionIndex])}\n  </li>\n  {#if isCorrectionVisible}\n    <div\n      class=\"relative self-start border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-6 mb-4 lg:mb-0 ml-0 lg:ml-0 py-2 pl-4 lg:pl-6\"\n      id=\"correction-exo{exerciseIndex}Q{questionIndex}\"\n    >\n      <div\n        class={exercise.consigneCorrection.length !== 0\n          ? 'container max-w-full text-justify bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark px-4 py-2 mr-2 ml-6 mb-2 font-light relative w-2/3'\n          : 'hidden'}\n      >\n        <div\n          class=\"{exercise.consigneCorrection.length !== 0\n            ? 'container max-w-full text-justify absolute top-4 -left-4'\n            : 'hidden'} \"\n        >\n          <i\n            class=\"bx bx-bulb scale-200 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n          ></i>\n        </div>\n        <div class=\"\">\n          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n          {@html exercise.consigneCorrection}\n        </div>\n      </div>\n      <div\n        class=\"container overflow-x-auto overflow-y-hidden md:overflow-x-auto py-1\"\n        style=\"line-height: {exercise.spacingCorr || 1}; break-inside:avoid\"\n      >\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html mathaleaFormatExercice(exercise.listeCorrections[questionIndex])}\n      </div>\n      <div\n        class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n      >\n        Correction\n      </div>\n      <div\n        class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n      ></div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  li {\n    break-inside: avoid;\n  }\n</style>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { afterUpdate, beforeUpdate, onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import type TypeExercice from '../../../../../exercices/Exercice'\n  import { sendToCapytaleSaveStudentAssignment } from '../../../../../lib/handleCapytale'\n  import {\n    exerciceInteractif,\n    prepareExerciceCliqueFigure,\n  } from '../../../../../lib/interactif/gestionInteractif'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaHandleExerciceSimple,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../../../lib/mathalea'\n  import { mathaleaWriteStudentPreviousAnswers } from '../../../../../lib/mathaleaUtils'\n  import {\n    capytaleStudentAssignment,\n    exercicesParams,\n    isMenuNeededForExercises,\n    resultsByExercice,\n  } from '../../../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../../../lib/stores/globalOptions'\n  import { isLocalStorageAvailable } from '../../../../../lib/stores/storage'\n  import type {\n    InterfaceParams,\n    InterfaceResultExercice,\n  } from '../../../../../lib/types'\n  import { loadMathLive } from '../../../../../modules/loaders'\n  import { statsTracker } from '../../../../../modules/statsUtils'\n  import { countMathField } from '../../countMathField'\n  import { handleCorrectionAffichee } from '../../handleCorrection'\n  import HeaderExerciceVueEleve from '../../presentationalComponents/shared/HeaderExerciceVueEleve.svelte'\n  import ExerciceVueEleveButtons from './presentationalComponents/ExerciceVueEleveButtons.svelte'\n  import Question from './presentationalComponents/Question.svelte'\n  export let exercise: TypeExercice\n  export let exerciseIndex: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible: boolean = false\n\n  let divExercice: HTMLDivElement\n  let divScore: HTMLDivElement\n  let buttonScore: HTMLButtonElement\n  let isInteractif = exercise.interactif && exercise?.interactifReady\n\n  /*\n   * MGu Attention interfaceParams est un objet qui est une copie du store,\n   * donc le mettre  jour directement met  jour le store sans le signaler au subscriber\n   * DE PLUS, si on change l'ordre des exercices OU si on supprime un exercice, exerciseIndex\n   * va devenir faux mais cela n'est pas gnant car l'exercice va tre destroy...\n   * Cependant, avant un DESTROY, il y aura un beforeupdate et un afterupdate, donc cette variable\n   * peut devenir UNDEFINED ou ERRONEE\n   */\n  let interfaceParams: InterfaceParams | undefined =\n    get(exercicesParams)[exerciseIndex]\n  let columnsCount = interfaceParams?.cols || 1\n\n  let debug = false\n  function log(str: string, level: number = 3) {\n    if (debug || window.logDebug >= level) {\n      console.info(str)\n    }\n  }\n\n  const subscribeExercicesParamsStore = exercicesParams.subscribe((value) => {\n    log('new interface:' + JSON.stringify(interfaceParams))\n    if (value[exerciseIndex] !== interfaceParams) {\n      // MGu c'est une comparaison par rfrence\n      log('new interfaceParams subscribe:' + JSON.stringify(interfaceParams))\n      interfaceParams = value[exerciseIndex]\n    }\n  })\n\n  // une variable locale car si on modifie isCorrectionVisible, parfois elle devient undefined\n  let isCorrectVisible = isCorrectionVisible\n\n  // URL-driven display toggles (only used for FlowMath recorder)\n  let boutonValidationUrlFlag = true\n  let boutonCorrectionUrlFlag = true\n  let boutonInteractiviteUrlFlag = true\n\n  let title: string\n  if ($globalOptions.isTitleDisplayed) {\n    title = exercise.id\n      ? `${exercise.id.replace('.js', '').replace('.ts', '')} - ${exercise.titre}`\n      : exercise.titre\n  } else {\n    title = exercise.id || ''\n  }\n  // Evnement indispensable pour pointCliquable par exemple\n  const exercicesAffiches = new window.Event('exercicesAffiches', {\n    bubbles: true,\n  })\n\n  let headerExerciceProps: { title: string } = { title }\n\n  let numberOfAnswerFields: number = 0\n\n  async function forceUpdate() {\n    if (exercise == null) return\n    exercise.numeroExercice = exerciseIndex\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function updateAnswers() {\n    if ($globalOptions.done === '1' && $globalOptions.recorder !== 'capytale') {\n      const q1 = document.querySelector<HTMLElement>(\n        '#exercice' + exercise.numeroExercice + 'Q0',\n      )\n      if (q1?.innerText === 'chargement...') return // en attente du chargement de l'exercice\n      const fields = document.querySelectorAll('math-field')\n      fields.forEach((field) => {\n        field.setAttribute('disabled', 'true')\n      })\n      const url = new URL(window.location.href)\n      // Pour Moodle, les rponses sont dans l'URL\n      const answers = url.searchParams.get('answers')\n      const objAnswers = answers ? JSON.parse(answers) : undefined\n      if (\n        JSON.stringify($globalOptions.answers) === JSON.stringify(objAnswers)\n      ) {\n        $globalOptions.answers = objAnswers\n      }\n      mathaleaUpdateUrlFromExercicesParams()\n      Promise.all(mathaleaWriteStudentPreviousAnswers(objAnswers)).then(() => {\n        // une fois que les rponses sont charges et on en est sr, on clique...\n        if (buttonScore) {\n          exercise.isDone = true\n          buttonScore.click()\n        }\n      })\n    }\n  }\n\n  onDestroy(() => {\n    log('ondestroy' + exercise.id)\n    // Dtruit l'objet exercice pour librer la mmoire\n    exercise.reinit() // MGu ncessaire pour supprimer les listeners\n    subscribeExercicesParamsStore()\n  })\n\n  onMount(async () => {\n    log('onMount:' + exercise.id + ', v:' + $globalOptions.v)\n    // Check boutonValidation mode after component is mounted\n    if ($globalOptions.recorder === 'flowmath') {\n      try {\n        const urlParams = new URLSearchParams(window.location.search)\n        boutonValidationUrlFlag = urlParams.get('boutonValidation') !== 'false'\n        boutonCorrectionUrlFlag = urlParams.get('boutonCorrection') !== 'false'\n        boutonInteractiviteUrlFlag =\n          urlParams.get('boutonInteractivite') !== 'false'\n      } catch (e) {\n        console.warn('Could not check FlowMath button flags:', e)\n      }\n    }\n\n    document.addEventListener('newDataForAll', newData)\n    document.addEventListener('setAllInteractif', setAllInteractif)\n    document.addEventListener('removeAllInteractif', removeAllInteractif)\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    updateDisplay()\n    if ($globalOptions.setInteractive === '1') {\n      setAllInteractif()\n    } else if ($globalOptions.setInteractive === '0') {\n      removeAllInteractif()\n    }\n    log('End onMount:' + exercise.id + ', v:' + $globalOptions.v)\n  })\n\n  beforeUpdate(async () => {\n    log('beforeUpdate:' + exercise.id + ', v:' + $globalOptions.v)\n    const count = countMathField(exercise)\n    if (count !== numberOfAnswerFields) {\n      numberOfAnswerFields = count\n      log('numberOfAnswerFields:' + numberOfAnswerFields)\n    }\n  })\n\n  afterUpdate(async () => {\n    log('afterUpdate:' + exercise.id + ', v:' + $globalOptions.v)\n    const starttime = window.performance.now()\n    if (exercise && divExercice) {\n      mathaleaRenderDiv(divExercice)\n      let time = window.performance.now()\n      log('duration mathaleaRenderDiv:' + (time - starttime))\n      adjustMathalea2dFiguresWidth()\n      time = window.performance.now()\n      log('duration adjustMathalea2dFiguresWidth:' + (time - starttime))\n      if (exercise.interactif) {\n        log('loadMathLive')\n        loadMathLive(divExercice)\n        log('end loadMathLive')\n        time = window.performance.now()\n        log('duration loadMathLive:' + (time - starttime))\n        if (exercise.interactifType === 'cliqueFigure' && !isCorrectVisible) {\n          prepareExerciceCliqueFigure(exercise)\n        }\n\n        // Ne pas tre not sur un exercice dont on a dj vu la correction\n        try {\n          if (\n            isLocalStorageAvailable() &&\n            exercise.id !== undefined &&\n            exercise.seed !== undefined &&\n            window.localStorage.getItem(`${exercise.id}|${exercise.seed}`) !=\n              null\n          ) {\n            newData()\n          }\n        } catch (e) {\n          console.error(e)\n        }\n        time = window.performance.now()\n        log('localStorage:' + exerciseIndex + ':' + (time - starttime))\n      }\n      updateAnswers()\n      time = window.performance.now()\n      log('duration updateAnswers:' + (time - starttime))\n    }\n    // affectation du zoom pour les figures scratch\n    const scratchDivs = divExercice.getElementsByClassName('scratchblocks')\n    for (const scratchDiv of scratchDivs) {\n      const svgDivs = scratchDiv.getElementsByTagName('svg')\n      for (const svg of svgDivs) {\n        if (svg.hasAttribute('data-width') === false) {\n          const originalWidth = svg.getAttribute('width')\n          svg.dataset.width = originalWidth ?? ''\n        }\n        if (svg.hasAttribute('data-height') === false) {\n          const originalHeight = svg.getAttribute('height')\n          svg.dataset.height = originalHeight ?? ''\n        }\n        const w =\n          Number(svg.getAttribute('data-width')) * Number($globalOptions.z)\n        const h =\n          Number(svg.getAttribute('data-height')) * Number($globalOptions.z)\n        svg.setAttribute('width', w.toString())\n        svg.setAttribute('height', h.toString())\n      }\n    }\n    document.dispatchEvent(exercicesAffiches)\n    if (isCorrectVisible) {\n      handleCorrectionAffichee()\n    }\n    log(\n      'afterUpdate:n ' +\n        exerciseIndex +\n        ', id: ' +\n        exercise.id +\n        ', v:' +\n        $globalOptions.v +\n        ', d:' +\n        (window.performance.now() - starttime),\n      2,\n    )\n  })\n\n  async function newData() {\n    exercise.isDone = false\n    if (isCorrectVisible) switchCorrectionVisible(false)\n    const seed = mathaleaGenerateSeed()\n    exercise.seed = seed\n    if (buttonScore?.dataset?.capytaleLoadAnswers === '1') {\n      // si les donnes ont t charges par Capytale, on remet  0\n      buttonScore.dataset.capytaleLoadAnswers = '0'\n    }\n    if (divScore) {\n      divScore.innerHTML = ''\n    }\n    if (buttonScore) {\n      buttonScore.classList.remove(\n        'cursor-not-allowed',\n        'opacity-50',\n        'pointer-events-none',\n      )\n    }\n    updateDisplay()\n  }\n\n  async function setAllInteractif() {\n    if (exercise?.interactifReady && !isInteractif) {\n      isInteractif = true\n      updateDisplay()\n    }\n  }\n  async function removeAllInteractif() {\n    if (exercise?.interactifReady && isInteractif) {\n      isInteractif = false\n      updateDisplay()\n    }\n  }\n\n  async function updateDisplay() {\n    log('updateDisplay:' + exercise.id + ', v:' + $globalOptions.v)\n    if (exercise.typeExercice === 'simple') {\n      if (exercise.seed === undefined) exercise.seed = mathaleaGenerateSeed()\n      seedrandom(exercise.seed, { global: true })\n      mathaleaHandleExerciceSimple(exercise, !!isInteractif, exerciseIndex)\n    }\n    exercise.interactif = isInteractif\n    if (interfaceParams) {\n      let changed = false\n\n      if (interfaceParams.alea !== exercise.seed) {\n        interfaceParams.alea = exercise.seed\n        changed = true\n      }\n\n      const interactifValue = isInteractif ? '1' : '0'\n      if (interfaceParams.interactif !== interactifValue) {\n        interfaceParams.interactif = interactifValue\n        changed = true\n      }\n\n      if (columnsCount > 1) {\n        if (interfaceParams.cols !== columnsCount) {\n          interfaceParams.cols = columnsCount\n          changed = true\n        }\n      } else if (columnsCount <= 1) {\n        if (interfaceParams.cols !== undefined) {\n          interfaceParams.cols = undefined\n          changed = true\n        }\n      }\n      if (changed) {\n        log(\n          'updateDisplay: updating exercicesParams for index ' +\n            exerciseIndex +\n            ': ' +\n            JSON.stringify(interfaceParams),\n          2,\n        )\n        exercicesParams.update((l: InterfaceParams[]) => {\n          if (interfaceParams) {\n            l[exerciseIndex] = interfaceParams\n          }\n          return l\n        })\n      }\n    }\n\n    exercise.numeroExercice = exerciseIndex\n    if (\n      exercise !== undefined &&\n      exercise.typeExercice !== 'simple' &&\n      typeof exercise.nouvelleVersionWrapper === 'function'\n    ) {\n      if (exercise.seed === undefined) exercise.seed = mathaleaGenerateSeed()\n      log('nouvelleVersionWrapper:' + exercise.id + ', v:' + $globalOptions.v)\n      seedrandom(exercise.seed, { global: true })\n      exercise.nouvelleVersionWrapper(exerciseIndex)\n    }\n    numberOfAnswerFields = countMathField(exercise)\n    log('numberOfAnswerFields:' + numberOfAnswerFields)\n    mathaleaUpdateUrlFromExercicesParams()\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  async function verifExerciceVueEleve() {\n    log('verifExerciceVueEleve')\n    if (exercise.numeroExercice != null && !(exercise.isDone === true))\n      statsTracker(\n        exercise,\n        $globalOptions.recorder ?? '',\n        $globalOptions.v ?? '',\n        buttonScore?.dataset?.capytaleLoadAnswers === '1' ? 'review' : '',\n      )\n    exercise.isDone = true\n\n    if (exercise.numeroExercice != null) {\n      const previousBestScore = interfaceParams?.bestScore ?? 0\n      const { numberOfPoints, numberOfQuestions } = exerciceInteractif(\n        exercise,\n        divScore,\n        buttonScore,\n      )\n      const isThisTryBetter = numberOfPoints >= previousBestScore\n      if (\n        buttonScore.dataset.capytaleLoadAnswers === '1' &&\n        previousBestScore !== numberOfPoints\n      ) {\n        // ICI les rponses ont t charges par Capytale et\n        //  le score ne peut pas tre inferieur  best score,\n        //  car c'est de la restitution de la meilleure copie\n        // donc si on est ici dans ce IF, c'est un bug du moteur  faire vite remonter\n        const newStudentAssignement = get(capytaleStudentAssignment) || []\n        const previousResultatByExercice =\n          newStudentAssignement[exercise.numeroExercice as number]\n        if (exercise?.checkSum !== previousResultatByExercice?.checkSum) {\n          window.notify(\n            `Exercice ${exercise.numeroExercice} a chang, pass de ${previousBestScore}  ${numberOfPoints}. Checksum diffrent avant ${previousResultatByExercice?.checkSum} et maintenant ${exercise?.checkSum}.`,\n            {\n              exo: exercise,\n              globalOptions: get(globalOptions),\n              exercicesParams: get(exercicesParams),\n              resultsByExercice: get(resultsByExercice),\n            },\n          )\n        }\n\n        window.notify(\n          `Le score de l'exercice ${exercise.numeroExercice} est incorrect, checksum(${exercise?.checkSum === previousResultatByExercice?.checkSum}), pass de ${previousBestScore}  ${numberOfPoints}. Merci de le signaler au support.`,\n          {\n            exo: exercise,\n            globalOptions: get(globalOptions),\n            exercicesParams: get(exercicesParams),\n            resultsByExercice: get(resultsByExercice),\n          },\n        )\n      }\n\n      let bestScore = previousBestScore\n      // On ne met  jour resultsByExercice que si le score est meilleur\n      if (isThisTryBetter) {\n        bestScore = numberOfPoints\n        exercicesParams.update((l: InterfaceParams[]) => {\n          l[exercise.numeroExercice as number].bestScore = bestScore\n          return l\n        })\n        resultsByExercice.update((l: InterfaceResultExercice[]) => {\n          l[exercise.numeroExercice as number] = {\n            uuid: exercise.uuid,\n            title: exercise.titre,\n            indice: exercise.numeroExercice as number,\n            state: 'done',\n            alea: exercise.seed,\n            answers: exercise.answers,\n            numberOfPoints,\n            numberOfQuestions,\n            bestScore,\n            checkSum: exercise.checkSum,\n          }\n          return l\n        })\n      }\n\n      if ($globalOptions.isSolutionAccessible) {\n        isCorrectVisible = true\n      }\n\n      if ($globalOptions.recorder === 'moodle') {\n        const url = new URL(window.location.href)\n        const iframe = url.searchParams.get('iframe')\n        console.info({\n          resultsByExercice: $resultsByExercice,\n          action: 'mathalea:score',\n          iframe,\n        })\n        window.parent.postMessage(\n          {\n            resultsByExercice: $resultsByExercice,\n            action: 'mathalea:score',\n            iframe,\n          },\n          '*',\n        )\n      } else if ($globalOptions.recorder === 'capytale') {\n        if (buttonScore.dataset.capytaleLoadAnswers === '1') {\n          console.info(\n            'Les rponses ont t charges par Capytale donc on ne les renvoie pas  nouveau',\n          )\n          return\n        }\n        if (isThisTryBetter) {\n          sendToCapytaleSaveStudentAssignment({\n            indiceExercice: exerciseIndex,\n          })\n        }\n      }\n    }\n  }\n\n  /**\n   * Recherche toutes les figures ayant la classe `mathalea2d` et rduit leur largeur  95% de la valeur\n   * maximale du div reper par l'ID `consigne<X>-0` o `X` est l'indice de l'exercice\n   * @param {boolean} initialDimensionsAreNeeded si `true`, les valeurs initiales sont recharges ()`false` par dfaut)\n   * @author sylvain\n   */\n  async function adjustMathalea2dFiguresWidth(\n    initialDimensionsAreNeeded: boolean = false,\n  ) {\n    const mathalea2dFigures: NodeListOf<SVGElement> | undefined =\n      divExercice?.querySelectorAll<SVGElement>('.mathalea2d')\n    if (!mathalea2dFigures || mathalea2dFigures.length === 0) return\n\n    const zoom = Number($globalOptions.z ?? 1)\n    log('zoom:' + zoom)\n    if (mathalea2dFigures.length !== 0) {\n      for (let k = 0; k < mathalea2dFigures.length; k++) {\n        if (initialDimensionsAreNeeded) {\n          // rinitialisation\n          const initialWidth = mathalea2dFigures[k].getAttribute(\n            'data-width-initiale',\n          )\n          const initialHeight = mathalea2dFigures[k].getAttribute(\n            'data-height-initiale',\n          )\n          mathalea2dFigures[k].setAttribute(\n            'width',\n            (Number(initialWidth) * zoom).toString(),\n          )\n          mathalea2dFigures[k].setAttribute(\n            'height',\n            (Number(initialHeight) * zoom).toString(),\n          )\n          // les lments Katex des figures SVG\n          if (\n            mathalea2dFigures[k] != null &&\n            mathalea2dFigures[k].parentElement != null\n          ) {\n            const eltsInFigures =\n              mathalea2dFigures[k].parentElement?.querySelectorAll<HTMLElement>(\n                'div.divLatex',\n              ) || []\n            for (const elt of eltsInFigures) {\n              const e = elt\n              e.style.setProperty(\n                'top',\n                (Number(e.dataset.top) * zoom).toString() + 'px',\n              )\n              e.style.setProperty(\n                'left',\n                (Number(e.dataset.left) * zoom).toString() + 'px',\n              )\n            }\n          }\n        }\n        /* Mickael:\n          Ne surtout pas mettre la rfrence de l'exercice dans la requte suivante,\n          car dans svelte, la rfrence est lie au dernier exercice charg, ce qui bug!\n          */\n        const consigneDiv = divExercice\n          ?.querySelector('article')\n          ?.querySelector('[id^=\"consigne\"]')\n        if (\n          consigneDiv &&\n          mathalea2dFigures[k].clientWidth > consigneDiv.clientWidth\n        ) {\n          const coef =\n            (consigneDiv.clientWidth * 0.95) / mathalea2dFigures[k].clientWidth\n          // console.log('coef:' + coef )\n          const width = mathalea2dFigures[k].getAttribute('width')\n          const height = mathalea2dFigures[k].getAttribute('height')\n          if (!mathalea2dFigures[k].dataset.widthInitiale && width != null)\n            mathalea2dFigures[k].dataset.widthInitiale = width\n          if (!mathalea2dFigures[k].dataset.heightInitiale && height != null)\n            mathalea2dFigures[k].dataset.heightInitiale = height\n          const newHeight = (\n            Number(mathalea2dFigures[k].dataset.heightInitiale) *\n            zoom *\n            coef\n          ).toString()\n          const newWidth = (\n            Number(mathalea2dFigures[k].dataset.widthInitiale) *\n            zoom *\n            coef\n          ).toString()\n          if (width !== newWidth) {\n            mathalea2dFigures[k].setAttribute('width', newWidth)\n          }\n          if (height !== newHeight) {\n            mathalea2dFigures[k].setAttribute('height', newHeight)\n          }\n\n          if (\n            mathalea2dFigures[k] != null &&\n            mathalea2dFigures[k].parentElement !== null\n          ) {\n            const eltsInFigures =\n              mathalea2dFigures[k].parentElement?.querySelectorAll<HTMLElement>(\n                'div.divLatex',\n              ) || []\n            for (const elt of eltsInFigures) {\n              const e = elt\n              const initialTop = Number(e.dataset.top) ?? 0\n              const initialLeft = Number(e.dataset.left) ?? 0\n              e.style.setProperty(\n                'top',\n                (initialTop * coef * zoom).toString() + 'px',\n              )\n              e.style.setProperty(\n                'left',\n                (initialLeft * coef * zoom).toString() + 'px',\n              )\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // pour recalculer les tailles lors d'un changement de dimension de la fentre\n  window.onresize = () => {\n    adjustMathalea2dFiguresWidth(true)\n  }\n\n  function switchCorrectionVisible(newdata: boolean = true) {\n    isCorrectVisible = !isCorrectVisible\n    if (\n      isCorrectVisible &&\n      isLocalStorageAvailable() &&\n      exercise.id !== undefined\n    ) {\n      window.localStorage.setItem(`${exercise.id}|${exercise.seed}`, 'true')\n    }\n    if (\n      newdata &&\n      !$globalOptions.oneShot &&\n      exercise.interactif &&\n      !isCorrectVisible &&\n      !exercise.isDone\n    ) {\n      newData()\n    }\n    if (newdata) adjustMathalea2dFiguresWidth()\n  }\n\n  function switchInteractif() {\n    if (isCorrectVisible) switchCorrectionVisible()\n    isInteractif = !isInteractif\n    exercise.interactif = isInteractif\n    updateDisplay()\n  }\n\n  function columnsCountUpdate(plusMinus: '+' | '-') {\n    if (plusMinus === '+') columnsCount++\n    if (plusMinus === '-') columnsCount--\n    updateDisplay()\n  }\n</script>\n\n<div class=\"z-0 flex-1 w-full mb-10 lg:mb-20\" bind:this={divExercice}>\n  {#if $globalOptions.presMode !== 'recto' && $globalOptions.presMode !== 'verso'}\n    <HeaderExerciceVueEleve\n      {...headerExerciceProps}\n      indiceExercice={exerciseIndex}\n      showNumber={indiceLastExercice > 0 &&\n        $globalOptions.presMode !== 'un_exo_par_page'}\n      isMenuNeededForExercises={$isMenuNeededForExercises}\n      presMode={$globalOptions.presMode}\n      seed={exercise.seed}\n    />\n  {/if}\n\n  <div class=\"flex flex-col-reverse lg:flex-row\">\n    <div\n      class=\"flex flex-col justify-start items-start\"\n      id=\"exercice{exerciseIndex}\"\n    >\n      <ExerciceVueEleveButtons\n        globalOptions={$globalOptions}\n        {indiceLastExercice}\n        {exercise}\n        isCorrectionVisible={isCorrectVisible}\n        {newData}\n        {switchCorrectionVisible}\n        {isInteractif}\n        {switchInteractif}\n        {columnsCount}\n        {columnsCountUpdate}\n        showCorrectionButton={$globalOptions.recorder === 'flowmath'\n          ? boutonCorrectionUrlFlag\n          : true}\n        showInteractivityButton={$globalOptions.recorder === 'flowmath'\n          ? boutonInteractiviteUrlFlag\n          : true}\n      />\n      <article\n        class=\" {$isMenuNeededForExercises\n          ? 'text-2xl'\n          : 'text-base'} relative w-full\"\n        style=\"font-size: {(\n          $globalOptions.z || 1\n        ).toString()}rem;  line-height: calc({$globalOptions.z || 1});\"\n      >\n        <div class=\"flex flex-col w-full mt-2 lg:mt-0 mb-2\">\n          {#key exercise.key}\n            {#if typeof exercise.consigne !== 'undefined' && exercise.consigne.length !== 0}\n              <div>\n                <p\n                  class=\"mt-2 mb-2 ml-2 lg:mx-6 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                >\n                  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                  {@html exercise.consigne}\n                </p>\n              </div>\n            {/if}\n            {#if exercise.introduction}\n              <div>\n                <p\n                  class=\"mt-2 mb-2 ml-2 lg:mx-6 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                >\n                  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                  {@html exercise.introduction}\n                </p>\n              </div>\n            {/if}\n          {/key}\n        </div>\n        <div\n          style=\"columns: {window.innerWidth > 1000\n            ? columnsCount.toString()\n            : '1'}\"\n        >\n          <ul\n            class=\"{exercise.listeQuestions.length === 1 ||\n            !exercise.listeAvecNumerotation\n              ? 'list-none'\n              : 'list-decimal'} list-inside mx-2 lg:mx-6 marker:text-coopmaths-struct dark:marker:text-coopmathsdark-struct marker:font-bold\"\n          >\n            <!-- eslint-disable-next-line @typescript-eslint/no-unused-vars -->\n            {#each exercise.listeQuestions as question, questionIndex (exercise.key + '_' + exerciseIndex + '_' + questionIndex)}\n              <Question\n                {exercise}\n                {questionIndex}\n                {exerciseIndex}\n                isCorrectionVisible={isCorrectVisible}\n              />\n            {/each}\n            <div bind:this={divScore} id=\"divScoreEx{exerciseIndex}\"></div>\n          </ul>\n        </div>\n      </article>\n      {#if isInteractif && !isCorrectVisible}\n        <button\n          type=\"submit\"\n          bind:this={buttonScore}\n          on:click={verifExerciceVueEleve}\n          id=\"buttonScoreEx{exerciseIndex}\"\n          class={`inline-block px-6 py-2.5 mr-10 my-5 ml-6\n                  bg-coopmaths-action dark:bg-coopmathsdark-action\n                  text-coopmaths-canvas dark:text-coopmathsdark-canvas\n                  font-medium text-xs leading-tight uppercase rounded shadow-md\n                  transform hover:bg-coopmaths-action-lightest dark:hover:bg-coopmathsdark-action-lightest\n                  hover:shadow-lg focus:bg-coopmaths-action-lightest dark:focus:bg-coopmathsdark-action-lightest\n                  focus:shadow-lg focus:outline-none focus:ring-0\n                  active:bg-coopmaths-action-lightest dark:active:bg-coopmathsdark-action-lightest\n                  active:shadow-lg transition duration-150 ease-in-out checkReponses`}\n          class:hidden={$globalOptions.recorder === 'flowmath' &&\n            !boutonValidationUrlFlag}\n          hidden={$globalOptions.recorder === 'flowmath' &&\n            !boutonValidationUrlFlag}\n        >\n          Vrifier {numberOfAnswerFields > 1 ? 'les rponses' : 'la rponse'}\n        </button>\n      {/if}\n    </div>\n  </div>\n</div>\n","import type { InterfaceParams } from '../types'\n\n/**\n * Compte le nombre d'apparitions de chaque UUIDs dans un tableau d'exercices (`InterfaceParams`)\n * @param {InterfaceParams[]} exosParams Un tableau des exercices\n * @returns Objet contenant toutes les UUIDs avec le nombres d'apparition\n */\nexport function uuidCount(\n  exosParams: InterfaceParams[],\n): Record<string, number> {\n  const counts: Record<string, number> = {}\n  for (const ex of exosParams) {\n    counts[ex.uuid] = counts[ex.uuid] ? counts[ex.uuid] + 1 : 1\n  }\n  return counts\n}\n\nexport function exercisesUuidRanking(exosParams: InterfaceParams[]): number[] {\n  const codesList: string[] = exosParams.map((p) => p.uuid)\n  const ranks: number[] = []\n  for (const [i, ex] of exosParams.entries()) {\n    const rank: number = codesList.slice(0, i + 1).filter((c) => {\n      return c === ex.uuid\n    }).length\n    ranks.push(rank)\n  }\n  return ranks\n}\n","export default \"%%% COULEURS %%%\\n\\\\usepackage[table,svgnames]{xcolor}\\n\\\\definecolor{nombres}{cmyk}{0,.8,.95,0}\\n\\\\definecolor{gestion}{cmyk}{.75,1,.11,.12}\\n\\\\definecolor{gestionbis}{cmyk}{.75,1,.11,.12}\\n\\\\definecolor{grandeurs}{cmyk}{.02,.44,1,0}\\n\\\\definecolor{geo}{cmyk}{.62,.1,0,0}\\n\\\\definecolor{algo}{cmyk}{.69,.02,.36,0}\\n\\\\definecolor{correction}{cmyk}{.63,.23,.93,.06}\\n\\\\arrayrulecolor{couleur_theme} % Couleur des filets des tableaux\\n\\n\\\\usepackage[most]{tcolorbox} % Supprim  cause de conflits avec ProfCollege\\n\\\\tcbuselibrary{documentation}\\n\\n%%%%%%%% Modification paramtrage pour footnotes\\n% Le paquet semble dj appel en amont, curieux qu'il n'y ait pas eu de clash\\n% avec l'appel ci-dessous mais seulement quand j'ai essay de l'inclure avec l'option lualatex\\n\\n% \\\\usepackage{hyperref}\\n% Parametrages\\n\\\\hypersetup{\\n    colorlinks=true,% On active la couleur pour les liens. Couleur par dfaut rouge\\n    linkcolor=black,% On dfinit la couleur pour les liens internes\\n    % filecolor=magenta,% On dfinit la couleur pour les liens vers les fichiers locaux      \\n    urlcolor=black,% On dfinit la couleur pour les liens vers des sites web\\n    % pdftitle={Puissance Quatre},% On dfinit un titre pour le document pdf\\n    % pdfpagemode=FullScreen,% On fixe l'affichage par dfaut  plein cran\\n    }\\n% Pour avoir les numrotations arabic y compris dans les environnements tcolorbox\\n\\\\renewcommand{\\\\thempfootnote}{\\\\arabic{mpfootnote}}\\n%%%%%%%%\\n\\n\\\\usepackage{multicol} \\n\\\\usepackage{calc}\\n\\\\usepackage{enumitem}\\n\\\\usepackage{graphicx}\\n\\\\usepackage{tabularx}\\n\\n\\\\setlength{\\\\parindent}{0mm}\\n\\\\renewcommand{\\\\arraystretch}{1.5}\\n\\\\renewcommand{\\\\labelenumi}{\\\\textbf{\\\\theenumi{}.}}\\n\\\\renewcommand{\\\\labelenumii}{\\\\textbf{\\\\theenumii{}.}}\\n\\\\setlength{\\\\fboxsep}{3mm}\\n\\n\\\\setlength{\\\\headheight}{14.5pt}\\n\\n\\\\setlength{\\\\premulticols}{0pt}\\n\\n\\\\newcounter{ExoMA}\\n\\n\\\\newlength{\\\\parindentMA}%\\n\\\\setlength{\\\\parindentMA}{\\\\parindent}\\n\\\\addtolength{\\\\parindentMA}{30pt}\\n\\n\\\\usepackage{simplekv}\\n\\n\\\\setKVdefault[Theme]{Coopmath,Classiques=false,CANs=false}\\n\\\\defKV[Theme]{Classique=\\\\setKV[Theme]{Coopmath=false}\\\\setKV[Theme]{Classiques}}\\n\\\\defKV[Theme]{CAN=\\\\setKV[Theme]{Coopmath=false}\\\\setKV[Theme]{CANs}}\\n\\n\\\\usepackage{fancyhdr}\\n\\\\fancyhead[C]{}\\n\\\\fancyfoot{}\\n\\n\\\\def\\\\bla{}\\n\\n\\\\NewDocumentCommand\\\\Theme{o m m m m}{%\\n  \\\\useKVdefault[Theme]%\\n  \\\\setKV[Theme]{#1}%\\n  \\\\ifboolKV[Theme]{CANs}{%\\n    \\\\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}%\\n    \\\\fancypagestyle{premierePage}{%\\n      \\\\fancyhead[C]{\\\\textsc{\\\\ifx\\\\bla#2\\\\bla Course aux nombres\\\\else#2\\\\fi}}%\\n      \\\\fancyfoot[R]{\\\\scriptsize Coopmaths.fr -- CC-BY-SA}%\\n      \\\\setlength{\\\\headheight}{14.5pt}%\\n      \\\\NewDocumentCommand\\\\dureeCan{}{\\\\ifx\\\\bla#4\\\\bla 9 minutes\\\\else #4\\\\fi}\\n      \\\\NewDocumentCommand\\\\titreSujetCan{}{\\\\ifx\\\\bla#3\\\\bla\\\\else\\\\textbf{#3}\\\\fi}\\n    }%\\n    \\\\pagestyle{premierePage}\\n    \\\\colorlet{couleur_theme}{black}%\\n    \\\\colorlet{couleur_numerotation}{couleur_theme}%\\n    \\\\let\\\\EXO\\\\EXOCan\\\\let\\\\endEXO\\\\endEXOCan%\\n  }{%\\n    \\\\renewcommand{\\\\headrulewidth}{0pt}\\n    \\\\renewcommand{\\\\footrulewidth}{0pt}\\n    \\\\pagestyle{fancy}\\n    \\\\ifboolKV[Theme]{Classiques}{%\\n      \\\\usepackage[left=0.65cm,right=0.65cm,top=2cm,bottom=1.5cm]{geometry}\\n      \\\\let\\\\EXO\\\\EXOlibre\\\\let\\\\endEXO\\\\endEXOlibre%\\n      \\\\colorlet{couleur_theme}{black}%\\n      \\\\colorlet{couleur_numerotation}{couleur_theme}%\\n      \\\\fancyhead[C]{\\\\bfseries #3}\\n      \\\\fancyhead[L]{\\\\bfseries #4}\\n      \\\\fancyfoot[R]{#5}\\n    }{%\\n      \\\\usepackage[left=1.5cm,right=1.5cm,top=4cm,bottom=2cm]{geometry}\\n      \\\\theme{#2}{#3}{#4}{#5}%\\n      \\\\let\\\\EXO\\\\EXOcoop\\\\let\\\\endEXO\\\\endEXOcoop%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{EXOCan}{m m +b}{%\\n  #3\\n}\\n\\n\\\\NewDocumentEnvironment{EXOcoop}{m m +b}{%\\n  \\\\begin{tcolorbox}[%\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=white,\\n    coltitle=black,\\n    title=\\\\IfNoValueTF{#1}{}{\\\\textmd{#1}},%\\n    overlay unbroken and first={%\\n      \\\\IfNoValueTF{#2}{}{%\\n        \\\\node[%\\n        fill=white,\\n        anchor=east,\\n        xshift=10pt,\\n        text=black\\n        ]\\n        at (frame.north east)\\n        {\\\\scriptsize #2};\\n      }\\n      \\\\node[anchor=west,xshift=-20pt,yshift=-15pt] at (frame.north west) {\\\\stepcounter{ExoMA}\\\\numb{\\\\arabic{ExoMA}}};\\n    }\\n    ]\\n    #3\\n  \\\\end{tcolorbox}\\n}\\n\\n\\\\NewDocumentEnvironment{EXOlibre}{m m +b}{%\\n  \\\\begin{tcolorbox}[%\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=white,%couleur_theme,\\n    coltitle=black,\\n    title=\\\\stepcounter{ExoMA}\\\\textbf{Exercice \\\\arabic{ExoMA}},%\\n    ]\\n    \\\\IfNoValueTF{#1}{}{#1\\\\par}%\\n    #3\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\n%%% MISE EN PAGE %%%\\n\\\\usepackage{setspace}\\n\\\\usepackage{pgf}%\\n\\\\usepackage{pgfplots}\\n\\\\pgfplotsset{compat=1.18}\\n\\\\usetikzlibrary{babel,arrows, arrows.meta,calc,fit,patterns,plotmarks,shapes.geometric,shapes.misc,shapes.symbols,shapes.arrows,shapes.callouts, shapes.multipart, shapes.gates.logic.US,shapes.gates.logic.IEC, er, automata,backgrounds,chains,topaths,trees,petri,mindmap,matrix, calendar, folding,fadings,through,positioning,scopes,decorations.fractals,decorations.shapes,decorations.text,decorations.pathmorphing,decorations.pathreplacing,decorations.footprints,decorations.markings,shadows}\\n\\n\\\\spaceskip=2\\\\fontdimen2\\\\font plus 3\\\\fontdimen3\\\\font minus3\\\\fontdimen4\\\\font\\\\relax %Pour doubler l'espace entre les mots\\n\\\\newcommand\\\\numb[1]{ % Dessin autour du numro d'exercice\\n  \\\\begin{tikzpicture}[overlay,scale=.8]%,yshift=-.3cm\\n    \\\\draw[fill=couleur_numerotation,couleur_numerotation](-.4,-0.1)rectangle($(-0.4,.8)+(2em,0)$);\\n    \\\\draw (-.4,.8) node[white,anchor=north west,inner sep=0.5pt]{\\\\bfseries EX}; \\n    \\\\draw[line width=.05cm,couleur_numerotation,fill=white] (0,0)--(.5,.5)--(1,0)--(.5,-.5)--cycle;\\n    \\\\draw (0.5,0) node[anchor=center,couleur_numerotation]{\\\\large\\\\bfseries#1};\\n  \\\\end{tikzpicture}\\n}\\n\\n% echelle pour le d\\n\\\\def\\\\globalscale {0.04}\\n% abscisse initiale pour les chevrons\\n\\\\def\\\\xini {3}\\n\\n\\\\newcommand\\\\theme[4]{%\\n  \\\\fancyhead[C]{%\\n    % Trac du d\\n    \\\\begin{tikzpicture}[y=0.80pt, x=0.80pt, yscale=-\\\\globalscale, xscale=\\\\globalscale,remember picture, overlay,transform canvas={xshift=-0.5\\\\linewidth,yshift=2.7cm},fill=couleur_theme]%,xshift=17cm,yshift=9.5cm\\n      %%%% Arc suprieur gauche%%%%\\n      \\\\path[fill](523,1424)..controls(474,1413)and(404,1372)..(362,1333)..controls(322,1295)and(313,1272)..(331,1254)..controls(348,1236)and(369,1245)..(410,1283)..controls(458,1328)and(517,1356)..(575,1362)..controls(635,1368)and(646,1375)..(643,1404)..controls(641,1428)and(641,1428)..(596,1430)..controls(571,1431)and(538,1428)..(523,1424)--cycle;\\n      %%%% D face suprieur%%%%\\n      \\\\path[fill](512,1272)..controls(490,1260)and(195,878)..(195,861)..controls(195,854)and(198,846)..(202,843)..controls(210,838)and(677,772)..(707,772)..controls(720,772)and(737,781)..(753,796)..controls(792,833)and(1057,1179)..(1057,1193)..controls(1057,1200)and(1053,1209)..(1048,1212)..controls(1038,1220)and(590,1283)..(551,1282)..controls(539,1282)and(521,1278)..(512,1272)--cycle;\\n      %%%% D faces gauche et droite%%%%\\n      \\\\path[fill](1061,1167)..controls(1050,1158)and(978,1068)..(900,967)..controls(792,829)and(756,777)..(753,756)--(748,729)--(724,745)..controls(704,759)and(660,767)..(456,794)..controls(322,813)and(207,825)..(200,822)..controls(193,820)and(187,812)..(187,804)..controls(188,797)and(229,688)..(279,563)..controls(349,390)and(376,331)..(391,320)..controls(406,309)and(462,299)..(649,273)..controls(780,254)and(897,240)..(907,241)..controls(918,243)and(927,249)..(928,256)..controls(930,264)and(912,315)..(889,372)..controls(866,429)and(848,476)..(849,477)..controls(851,479)and(872,432)..(897,373)..controls(936,276)and(942,266)..(960,266)..controls(975,266)and(999,292)..(1089,408)..controls(1281,654)and(1290,666)..(1290,691)..controls(1290,720)and(1104,1175)..(1090,1180)..controls(1085,1182)and (1071,1176)..(1061,1167)--cycle;\\n      %%%% Arc infrieur bas%%%%\\n      \\\\path[fill](1329,861)..controls(1316,848)and(1317,844)..(1339,788)..controls(1364,726)and(1367,654)..(1347,591)..controls(1330,539)and(1338,522)..(1375,526)..controls(1395,528)and(1400,533)..(1412,566)..controls(1432,624)and(1426,760)..(1401,821)..controls(1386,861)and(1380,866)..(1361,868)..controls(1348,870)and(1334,866)..(1329,861)--cycle;\\n      %%%% Arc infrieur gauche%%%%\\n      \\\\path[fill](196,373)..controls(181,358)and(186,335)..(213,294)..controls(252,237)and(304,190)..(363,161)..controls(435,124)and(472,127)..(472,170)..controls(472,183)and(462,192)..(414,213)..controls(350,243)and(303,283)..(264,343)..controls(239,383)and(216,393)..(196,373)--cycle;\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[line cap=round,line join=round,remember picture, overlay, shift={(current page.north west)},yshift=-8.5cm]\\n      \\\\fill[fill=couleur_theme] (0,5) rectangle (21,6);\\n      \\\\fill[fill=couleur_theme] (\\\\xini,6)--(\\\\xini+1.5,6)--(\\\\xini+2.5,7)--(\\\\xini+1.5,8)--(\\\\xini,8)--(\\\\xini+1,7)-- cycle;\\n      \\\\fill[fill=couleur_theme] (\\\\xini+2,6)--(\\\\xini+2.5,6)--(\\\\xini+3.5,7)--(\\\\xini+2.5,8)--(\\\\xini+2,8)--(\\\\xini+3,7)-- cycle;  \\n      \\\\fill[fill=couleur_theme] (\\\\xini+3,6)--(\\\\xini+3.5,6)--(\\\\xini+4.5,7)--(\\\\xini+3.5,8)--(\\\\xini+3,8)--(\\\\xini+4,7)-- cycle;   \\n      \\\\node[color=white] at (10.5,5.5) {\\\\LARGE \\\\bfseries{ \\\\MakeUppercase{#4}}};\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      \\\\node[anchor=north east,inner sep=0pt] at ($(current page.north east)+(0,-.8cm)$) {};\\n      \\\\node[anchor=west, fill=white, inner sep = 0pt] at ($(current page.north west)+(0.2,-2.3cm)$) {\\\\footnotesize \\\\bfseries{MathALA}};\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      \\\\node[anchor=north east,inner sep=0pt] at ($(current page.north east)+(0,-.8cm)$) {};\\n      \\\\node[anchor=east, fill=white] at ($(current page.north east)+(-2,-1.5cm)$) {\\\\Huge \\\\textcolor{couleur_theme}{\\\\bfseries{\\\\#}} \\\\bfseries{#2} \\\\textcolor{couleur_theme}{\\\\bfseries \\\\MakeUppercase{#3}}};\\n    \\\\end{tikzpicture}\\n  }%\\n  \\\\fancyfoot[R]{%\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      \\\\node[anchor=south east] at ($(current page.south east)+(-2,0.25cm)$) {\\\\scriptsize {\\\\bfseries \\\\href{https://coopmaths.fr/}{Coopmaths.fr} -- \\\\href{http://creativecommons.fr/licences/}{CC-BY-SA}}};\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[line cap=round,line join=round,remember picture, overlay,xscale=0.5,yscale=0.5, shift={(current page.south west)},xshift=35.7cm,yshift=-6cm]\\n      \\\\fill[fill=couleur_theme] (\\\\xini,6)--(\\\\xini+1.5,6)--(\\\\xini+2.5,7)--(\\\\xini+1.5,8)--(\\\\xini,8)--(\\\\xini+1,7)-- cycle;\\n      \\\\fill[fill=couleur_theme] (\\\\xini+2,6)--(\\\\xini+2.5,6)--(\\\\xini+3.5,7)--(\\\\xini+2.5,8)--(\\\\xini+2,8)--(\\\\xini+3,7)-- cycle;  \\n      \\\\fill[fill=couleur_theme] (\\\\xini+3,6)--(\\\\xini+3.5,6)--(\\\\xini+4.5,7)--(\\\\xini+3.5,8)--(\\\\xini+3,8)--(\\\\xini+4,7)-- cycle;  \\n    \\\\end{tikzpicture}\\n  }\\n  \\\\fancyfoot[C]{}\\n  \\\\colorlet{couleur_theme}{#1}\\n  \\\\colorlet{couleur_numerotation}{couleur_theme}\\n  \\\\def\\\\iconeobjectif{icone-objectif-#1}\\n  \\\\def\\\\urliconeomethode{icone-methode-#1}\\n}%\\n\\n\\\\newcommand*\\\\tikzfootMA{%\\n  \\\\ifboolKV[Theme]{CANs}{\\n    \\\\begin{tikzpicture}[remember picture,overlay,shift=(current page.north west)]\\n      \\\\begin{scope}[x=\\\\textwidth-\\\\oddsidemargin,y=\\\\textheight+5pt]\\n        \\\\draw[correction,line width=4pt,dashed,dash pattern= on 10pt off 10pt,shift={(-\\\\oddsidemargin,\\\\topmargin)}] (0,0) rectangle (1,-1);\\n      \\\\end{scope}\\n    \\\\end{tikzpicture} \\n  }{%\\n  \\\\ifboolKV[Theme]{Classiques}{%\\n  \\\\begin{tikzpicture}[remember picture,overlay,shift=(current page.south west)]\\n    \\\\begin{scope}[x={(current page.south east)},y={(current page.north west)}]\\n      \\\\draw[correction,line width=4pt,dashed,dash pattern= on 10pt off 10pt] ($(0,0)+(5mm,1cm)$) rectangle ($(1,1)+(-5mm,-1.75cm)$);\\n    \\\\end{scope}\\n  \\\\end{tikzpicture} \\n  }{%\\n  \\\\begin{tikzpicture}[remember picture,overlay,shift=(current page.south west)]\\n    \\\\begin{scope}[x={(current page.south east)},y={(current page.north west)}]\\n      \\\\draw[correction,line width=4pt,dashed,dash pattern= on 10pt off 10pt] ($(0,0)+(5mm,1.5cm)$) rectangle ($(1,1)+(-5mm,-3.75cm)$);\\n    \\\\end{scope}\\n  \\\\end{tikzpicture} \\n  }%\\n  }\\n}\\n\\n\\\\newenvironment{Correction}{%\\n  \\\\setcounter{ExoMA}{0}%\\n  \\\\cfoot{\\\\tikzfootMA}\\n}{}%\\n\\n\\\\newcommand\\\\version[1]{\\n  \\\\fancyhead[R]{\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n    \\\\node[anchor=north east,inner sep=0pt] at ($(current page.north east)+(-.5,-.5cm)$) {\\\\large \\\\textcolor{couleur_theme}{\\\\bfseries V#1}};\\n    \\\\end{tikzpicture}\\n  }\\n}\\n\\n\\\\usepackage[french]{babel}\"","import type { LatexFileInfos, contentsType } from '../LatexTypes'\n\nexport function loadFonts(latexFileInfos: LatexFileInfos) {\n  return `\\n\\\\usepackage{etoolbox}\n\\\\newbool{dys}\n\\\\setbool{dys}{${latexFileInfos.fontOption === 'DysFont' ? 'true' : 'false'}}          \n\\\\ifbool{dys}{\n% POLICE DYS\n% ===== VARIABLE =====\n\\\\def\\\\FontChoisie{Fira} % valeurs possibles : Fira, lmodern, tgheros\n\\\\newcommand{\\\\choiceFontsDys}[1]{\n\\\\ifstrequal{#1}{Fira}{%\n  % Fira Sans + Fira Math\n  % Description : Fira Sans est une police moderne, et Fira Math est une version mathmatique compatible qui maintient le style sans-serif.\n  % Utilisation : Fonctionne bien avec XeLaTeX et LuaLaTeX.\n  \\\\usepackage{fontspec}\n  \\\\setmainfont{Fira Sans}\n  \\\\setsansfont{Fira Sans}\n  \\\\usepackage{unicode-math}\n  \\\\setmathfont{Fira Math}\n}{}\n\\\\ifstrequal{#1}{lmodern}{%\n  % Latin Modern Sans\n  % Description : Une version sans-serif de la clbre police Latin Modern, qui est compatible avec mathastext.\n  % Utilisation : Fonctionne avec pdfLaTeX, XeLaTeX et LuaLaTeX.\n  \\\\usepackage{lmodern}\n  \\\\renewcommand{\\\\familydefault}{\\\\sfdefault}\n  \\\\usepackage{mathastext}\n}{}\n\\\\ifstrequal{#1}{tgheros}{%\n  % TeX Gyre Heros + mathastext\n  % Description : TeX Gyre Heros est une alternative  Helvetica, et le package mathastext permet d'utiliser la mme police pour les mathmatiques.\n  % Utilisation : Fonctionne avec pdfLaTeX, XeLaTeX, ou LuaLaTeX.\n  \\\\usepackage{tgheros}\n  \\\\renewcommand{\\\\familydefault}{\\\\sfdefault}\n  \\\\usepackage{mathastext}\n}{}\n}\n% Fira ou lmodern ou tgheros\n\\\\choiceFontsDys{\\\\FontChoisie}\n\n%\\\\usepackage{unicode-math}\n%\\\\usepackage{fontspec}\n%\\\\setmainfont{TeX Gyre Schola}\n%\\\\setsansfont{TeX Gyre Schola}\n%\\\\setmathfont{TeX Gyre Schola Math}\n%\\\\setmainfont{OpenDyslexic}[Scale=1.0]\n%\\\\setsansfont{OpenDyslexic}[Scale=1.0]\n%\\\\setmathfont{OpenDyslexic}[Scale=1.0,range=up/{Latin,latin,num}]\n\\\\usepackage[fontsize=${latexFileInfos.dysTailleFontOption}]{scrextend}\n\\\\usepackage{setspace}\n\\\\setstretch{1.7}\n% Une valeur d'environ 1.2  1.7 est souvent recommande. Cela permet d'augmenter l'espace entre les lignes tout en offrant un lger espacement entre les mots.\n\\\\setlength{\\\\spaceskip}{1.2em}  \n% Une valeur d'environ 1.2em  1.5em est couramment conseille. Cela cre un espace plus ample entre les mots, ce qui peut aider  rduire la fatigue visuelle et  amliorer la fluidit de la lecture.\n}{\n% POLICE STANDARD\n\\\\usepackage[T1]{fontenc} \n\\\\usepackage[scaled=1]{helvet}\n\\\\usepackage[fontsize=${latexFileInfos.tailleFontOption}]{scrextend}\n}`\n}\n\nfunction loadNoteBasExercices(contents: contentsType) {\n  const noteBas = `\n\\\\newcounter{customfootnote}\n\\\\newcounter{tempreset}%\n\\\\newcounter{temp}\n\n\\\\makeatletter\n\\\\newcommand{\\\\anote}[1]{%\n  \\\\refstepcounter{customfootnote}%\n  \\\\textsuperscript{\\\\thecustomfootnote}%\n  \\\\expandafter\\\\gdef\\\\csname custom@footnote@\\\\thecustomfootnote\\\\endcsname{#1}%\n}\n\n\\\\newcommand{\\\\printcustomnotes}{%\n  \\\\par\\\\noindent\\\\rule{\\\\linewidth}{0.4pt}\\\\par\n  \\\\setcounter{temp}{1}%\n  \\\\whileboolexpr{\n    test {\\\\ifcsdef{custom@footnote@\\\\thetemp}}\n  }{%\n    \\\\noindent\\\\textsuperscript{\\\\thetemp}~\\\\csname custom@footnote@\\\\thetemp\\\\endcsname\\\\par\n    \\\\stepcounter{temp}%\n  }%\n}\n\n\\\\newcommand{\\\\resetcustomnotes}{%\n  \\\\setcounter{customfootnote}{0}%\n  \\\\setcounter{tempreset}{1}%\n  \\\\whileboolexpr{\n    test {\\\\ifcsdef{custom@footnote@\\\\thetempreset}}\n  }{%\n    \\\\global\\\\expandafter\\\\let\\\\csname custom@footnote@\\\\thetempreset\\\\endcsname\\\\@undefined\n    \\\\stepcounter{tempreset}%\n  }%\n}\n\\\\makeatother`\n  testIfLoaded(['\\\\anote{'], noteBas, contents)\n}\n\nexport function loadPreambule(\n  latexFileInfos: LatexFileInfos,\n  contents: contentsType,\n) {\n  if (latexFileInfos.style === 'Can') {\n    contents.preamble += loadPreambuleCan()\n  }\n  loadPackagesFromContent(contents)\n}\n\nfunction loadPreambuleCan() {\n  return `\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% SPCIFIQUE SUJETS CAN                  %\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\\\\usepackage{tabularray} % EE : Pour pouvoir utiliser tableauCAN\n\\\\usepackage{longtable}\n\n\\\\tikzset{\n  mybox/.style={\n    rectangle,\n    drop shadow, \n    inner sep=17pt,\n    draw=gray,\n    shade,\n    top color=gray,\n    every shadow/.append style={fill=gray!40}, \n    bottom color=gray!20\n    }\n  }\n  \n  \\\\newcommand\\\\MyBox[2][]{%\n    \\\\tikz\\\\node[mybox,#1] {#2}; \n  }\n  % Un compteur pour les questions CAN\n  \\\\newcounter{nbEx}\n  % Pour travailler avec les compteurs\n  \\\\usepackage{totcount}\n  \\\\regtotcounter{nbEx}  \n\n  % Une checkmark !\n  \\\\def\\\\myCheckmark{\\\\tikz\\\\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}  \n  % Repiqu sans vergogne dans lemanuel TikZ pour l'impatient\n  \\\\def\\\\arete{3}   \\\\def\\\\epaisseur{5}   \\\\def\\\\rayon{2}\n\n  \\\\newcommand{\\\\ruban}{(0,0)\n    ++(0:0.57735*\\\\arete-0.57735*\\\\epaisseur+2*\\\\rayon)\n    ++(-30:\\\\epaisseur-1.73205*\\\\rayon)\n    arc (60:0:\\\\rayon)   -- ++(90:\\\\epaisseur)\n    arc (0:60:\\\\rayon)   -- ++(150:\\\\arete)\n    arc (60:120:\\\\rayon) -- ++(210:\\\\epaisseur)\n    arc (120:60:\\\\rayon) -- cycle}\n\n  \\\\newcommand{\\\\mobiusCan}{\n    % Repiqu sans vergogne dans lemanuel TikZ pour l'impatient\n    \\\\begin{tikzpicture}[very thick,top color=white,bottom color=gray,scale=1.2]\n      \\\\shadedraw \\\\ruban;\n      \\\\shadedraw [rotate=120] \\\\ruban;\n      \\\\shadedraw [rotate=-120] \\\\ruban;\n      \\\\draw (-60:4) node[scale=5,rotate=30]{CAN};\n      \\\\draw (180:4) node[scale=3,rotate=-90]{MathALA};\n      \\\\clip (0,-6) rectangle (6,6); % pour croiser\n      \\\\shadedraw  \\\\ruban;\n      \\\\draw (60:4) node [gray,xscale=2.5,yscale=2.5,rotate=-30]{CoopMaths};\n    \\\\end{tikzpicture} \n  }\n  \n  \\\\newcommand{\\\\pageDeGardeCan}[1]{\n    % #1 --> nom du compteur pour le nombre de questions\n\n    %\\\\vspace*{10mm}\n    \\\\textsc{Nom} : \\\\makebox[.35\\\\linewidth]{\\\\dotfill} \\\\hfill \\\\textsc{Prnom} : \\\\makebox[.35\\\\linewidth]{\\\\dotfill}\n\n    \\\\vspace{10mm}\n    \\\\textsc{Classe} : \\\\makebox[.33\\\\linewidth]{\\\\dotfill} \\\\hfill\n    \\\\MyBox{\\\\Large\\\\textsc{Score} : \\\\makebox[.15\\\\linewidth]{\\\\dotfill} / \\\\total{#1}}      \n    \\\\par\\\\medskip \\\\hrulefill \\\\par\n    \\\\myCheckmark \\\\textit{\\\\textbf{Dure :  \\\\dureeCan}}\n\n    \\\\smallskip\n    \\\\myCheckmark \\\\textit{L'preuve comporte \\\\total{#1} questions.}\n\n    \\\\smallskip  \n    \\\\myCheckmark \\\\textit{L'usage de la calculatrice et du brouillon est interdit.}\n\n    \\\\smallskip\n    \\\\myCheckmark \\\\textit{Il n'est pas permis d'crire des calculs intermdiaires.}\n    \\\\par \\\\hrulefill \\\\par\\\\vspace{5mm}\n    \\\\begin{center}\n      \\\\textsc{\\\\titreSujetCan}\n      \\\\par\\\\vspace{5mm}\n      \\\\mobiusCan\n    \\\\end{center}\n  }\n\n  \\\\newlength{\\\\Largeurcp}\n  \n  % Nouveau TableauCan\n  % Supprimer les headers et footer du longtblr\n  \\\\DefTblrTemplate{contfoot-text}{default}{}\n  \\\\DefTblrTemplate{conthead-text}{default}{}\n  \\\\DefTblrTemplate{caption}{default}{}\n  \\\\DefTblrTemplate{conthead}{default}{}\n  \\\\DefTblrTemplate{capcont}{default}{}\n  \\\\UseTblrLibrary{counter,varwidth}\n  % Compteur des questions\n  \\\\newcounter{CompteurTableauCan}\n  \\\\newcommand{\\\\CompteurTC}{\\\\stepcounter{CompteurTableauCan}\\\\arabic{CompteurTableauCan}}\n  % ENvironnement proprement dit\n  \\\\NewDocumentEnvironment{TableauCan}{+b}{%\n  % #1 --> corps de tableau\n  \\\\begin{longtblr}{%\n    width=\\\\textwidth,%\n    colspec={X[c,0.075]X[c,0.55]X[c,0.28]X[c,0.1]},%\n    vlines,hlines,,measure=vbox,%\n    vspan=even,%\n    stretch=2.5,%\n    column{1}={bg={gray!20},font={\\\\bfseries}},%\n    row{1}={bg={gray!20},font={\\\\bfseries},halign={c}},%\n    rows={valign={m}}%\n  }\n  \\\\#&nonc&Rponse&Jury\\\\\\\\\n  #1\n  \\\\end{longtblr}\n  }{}\n  `\n}\n\nconst debug = false\nexport const logPDF = (str: string) => {\n  if (debug) console.log('PACKAGETEST:' + str)\n}\n\nexport function loadProfCollegeIfNeed(contents: contentsType) {\n  testIfLoaded(\n    [\n      '\\\\Engrenages[',\n      '\\\\Proba[',\n      '\\\\Propor[',\n      '\\\\Fraction[',\n      '\\\\Reperage[',\n      '\\\\Pythagore',\n      '\\\\Prix',\n      '\\\\SquarO[',\n      'begin{Scratch}',\n      'begin{Tableur}',\n      '\\\\pointilles',\n    ],\n    '\\\\usepackage{ProfCollege}',\n    contents,\n  )\n}\n\nfunction testIfLoaded(\n  values: string[],\n  valueToPut: string,\n  contents: contentsType,\n  display?: string,\n) {\n  for (const value of values) {\n    if (\n      contents.content.includes(value) ||\n      contents.contentCorr.includes(value)\n    ) {\n      if (!contents.preamble.includes(valueToPut))\n        contents.preamble += `\\n${valueToPut}`\n      logPDF(\n        `${display === undefined ? valueToPut : display}: ${window.location.href}`,\n      )\n    }\n  }\n}\n\nexport function loadPackagesFromContent(contents: contentsType) {\n  contents.preamble += '\\n% loadPackagesFromContent'\n  loadProfCollegeIfNeed(contents)\n  loadNoteBasExercices(contents)\n  testIfLoaded(['\\\\twemoji'], '\\\\usepackage{twemojis}', contents)\n  testIfLoaded(['ifthenelse'], '\\\\usepackage{ifthen}', contents)\n  testIfLoaded(\n    ['pspicture', '\\\\rput', '\\\\pscurve', '\\\\psset', '\\\\psframe'],\n    '\\\\usepackage{pstricks}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\PstPolygon', '\\\\PstStarFive'],\n    '\\\\usepackage{pst-poly}',\n    contents,\n  )\n  testIfLoaded(['\\\\pstext'], '\\\\usepackage{pst-text}', contents)\n  testIfLoaded(\n    ['\\\\pstGeonode', '\\\\pstLine', '\\\\pstLabelAB', '\\\\PstTriangle'],\n    '\\\\usepackage{pst-eucl}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\psaxes', '\\\\psline', '\\\\pspolygon', '\\\\psplot'],\n    '\\\\usepackage{pst-plot}',\n    contents,\n  )\n  testIfLoaded(['\\\\psbcurve'], '\\\\usepackage{pst-bezier}', contents)\n  testIfLoaded(['\\\\psBspline'], '\\\\usepackage{pst-bspline}', contents)\n  testIfLoaded(\n    ['\\\\pstThreeDLine', 'pstThreeDCoor'],\n    '\\\\usepackage{pst-3dplot}',\n    contents,\n  )\n  testIfLoaded(['\\\\multido'], '\\\\usepackage{multido}', contents)\n  testIfLoaded(\n    ['\\\\gradangle{', 'fillstyle=gradient'],\n    '\\\\usepackage{pst-grad}',\n    contents,\n  )\n  testIfLoaded(['\\\\pstree{', '\\\\pstree['], '\\\\usepackage{pst-tree}', contents)\n  testIfLoaded(\n    ['\\\\pnode', '\\\\ncline', '\\\\nccurve', '\\\\ncarc'],\n    '\\\\usepackage{pst-node}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\red', '\\\\blue', '\\\\white'],\n    '\\\\usepackage{pst-fun}',\n    contents,\n  )\n  testIfLoaded(['\\\\euro'], '\\\\usepackage[gen]{eurosym}', contents)\n  testIfLoaded(['\\\\tkzTabInit', '\\\\tkzTab'], '\\\\usepackage{tkz-tab}', contents)\n  testIfLoaded(['{tabularx}', '{tabular}'], '\\\\usepackage{tabularx}', contents)\n  testIfLoaded(['\\\\ang', '\\\\num{'], '\\\\usepackage{siunitx}', contents)\n  testIfLoaded(['\\\\begin{multicols}'], '\\\\usepackage{multicol}', contents)\n  testIfLoaded(\n    ['\\\\opadd', '\\\\opsub', '\\\\opmul', '\\\\opdiv', '\\\\opidiv', '\\\\opmanyadd'],\n    '\\\\usepackage{xlop}',\n    contents,\n  )\n  testIfLoaded(['\\\\cancel'], '\\\\usepackage{cancel}', contents)\n  testIfLoaded(\n    ['\\\\draw[color={'],\n    '\\\\usepackage[table,svgnames]{xcolor}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\np{', '\\\\np[', '\\\\numprint{'],\n    '\\\\usepackage[autolanguage,np]{numprint}',\n    contents,\n  )\n  testIfLoaded(['\\\\mathscr'], '\\\\usepackage{mathrsfs}', contents)\n  testIfLoaded(\n    ['\\\\fcolorbox{nombres}'],\n    '\\\\definecolor{nombres}{cmyk}{0,.8,.95,0}',\n    contents,\n  )\n  testIfLoaded(['\\\\begin{tikzpicture}'], '\\\\usepackage{tikz}', contents)\n  testIfLoaded(['\\\\begin{bclogo}'], '\\\\usepackage[tikz]{bclogo}', contents)\n  if (contents.content.includes('\\\\begin{bclogo}')) {\n    logPDF(`definecolor{nombres} : ${window.location.href}`)\n    if (!contents.preamble.includes('definecolor{nombres}'))\n      contents.preamble += '\\n\\\\definecolor{nombres}{cmyk}{0,.8,.95,0}'\n  }\n  testIfLoaded(['\\\\begin{axis}'], '\\\\usepackage{pgfplots}', contents)\n  testIfLoaded(\n    ['pgfmathsetmacro'],\n    '\\\\usetikzlibrary{decorations,decorations.text}',\n    contents,\n  )\n  testIfLoaded(\n    ['decorate,decoration=', 'decorate, decoration='],\n    '\\\\usetikzlibrary{decorations.pathmorphing}',\n    contents,\n  )\n  testIfLoaded(\n    ['decoration=brace', 'decoration={brace}', 'decoration={brace,'],\n    '\\\\usetikzlibrary {decorations.pathreplacing}',\n    contents,\n  )\n  testIfLoaded(['\\\\tkzText'], '\\\\usepackage{tkz-fct}', contents)\n  testIfLoaded(['pic['], '\\\\usetikzlibrary{quotes}', contents)\n  testIfLoaded(['angle eccentricity'], '\\\\usetikzlibrary{angles}', contents)\n  testIfLoaded(\n    ['name intersections'],\n    '\\\\usetikzlibrary{intersections}',\n    contents,\n  )\n  testIfLoaded(['\\\\begin{wrapfigure}'], '\\\\usepackage{wrapfig}', contents)\n  testIfLoaded(['needspace'], '\\\\usepackage{needspace}', contents)\n  testIfLoaded(['\\\\ovaloperator{'], '\\\\usepackage{scratch3}', contents)\n  testIfLoaded(['\\\\begin{scratch}'], '\\\\usepackage{scratch3}', contents)\n  testIfLoaded(\n    ['\\\\begin{Scratch}'],\n    '\\\\usepackage{unicode-math}\\n\\\\newfontfamily\\\\myfontScratch[]{FreeSans}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\degre', '\\\\og', '\\\\up{', '\\\\ieme{', '\\\\no'],\n    '\\\\usepackage[french]{babel}',\n    contents,\n  )\n  testIfLoaded(['\\\\degree'], '\\\\usepackage{gensymb}', contents)\n  testIfLoaded(['\\\\tblr', '{tblr}'], '\\\\usepackage{tabularray}', contents)\n  testIfLoaded(['\\\\multirow{'], '\\\\usepackage{multirow}', contents)\n  testIfLoaded(\n    ['\\\\dotfills'],\n    '\\\\newcommand\\\\dotfills[1][4cm]{\\\\makebox[#1]{\\\\dotfill}}',\n    contents,\n  )\n  testIfLoaded(['boxplot'], '\\\\usepgfplotslibrary{statistics}', contents)\n  testIfLoaded(\n    ['\\\\blocrep{', '\\\\blocrep['],\n    `\n\\\\usepackage{setspace}\n% ligne pointille\n\\\\newcommand{\\\\dotline}{\\\\noindent\\\\makebox[\\\\linewidth]{\\\\dotfill}}\n\n\n\n% bloc de rponses\n\\\\newcommand{\\\\blocrep}[3][1.5]{% #1 = nb lignes, #2 = nb colonnes\n  \\\\begin{spacing}{#1} % interligne\n  \\\\newcount\\\\foo\n  \\\\ifstrequal{#3}{1}{%\n  % --- Cas 1 colonne ---\n    \n  \\\\foo=#2\n\t\\\\loop\n\t\t\\\\dotline\n\n\t\t\\\\advance \\\\foo -1\n\t\\\\ifnum \\\\foo>0\n\t\\\\repeat\n  }{%\n    % --- Cas multi-colonnes ---\n    \\\\begin{multicols}{#3}\n    \\\\foo=\\\\numexpr#2 * #3\\\\relax\n\t  \\\\loop\n\t\t  \\\\dotline \n\t\t\n      \\\\advance \\\\foo -1\n    \\\\ifnum \\\\foo>0\n    \\\\repeat\n    \\\\end{multicols}\n  }%\n  \\\\end{spacing}\n  \\\\vspace{-0cm}\n}\n`,\n    contents,\n  )\n\n  if (\n    contents.content.includes('\\\\ovalbox{') ||\n    contents.content.includes('\\\\txtbox{')\n  ) {\n    // gestion pour les sujets DNB : 2021\n    contents.preamble += '\\n\\\\usepackage{fancybox}'\n    logPDF(`usepackage{fancybox}: ${window.location.href}`)\n    if (contents.content.includes('\\\\txtbox{')) {\n      logPDF(`\\\\newcommand{\\\\txtbox}{\\\\ovalnum}: ${window.location.href}`)\n      contents.preamble += '\\n\\\\newcommand{\\\\txtbox}{\\\\ovalnum}'\n    }\n  }\n  testIfLoaded(\n    ['\\\\begin{figure}'],\n    `\\n% supprime les figures flottantes du DNB\n\\\\makeatletter\n\\\\def\\\\provideenvironment{\\\\@star@or@long\\\\provide@environment}\n\\\\def\\\\provide@environment#1{%\n\\\\@ifundefined{#1}%\n  {\\\\def\\\\reserved@a{\\\\newenvironment{#1}}}%\n  {\\\\def\\\\reserved@a{\\\\renewenvironment{dummy@environ}}}%\n\\\\reserved@a\n}\n\\\\def\\\\dummy@environ{}\n\\\\makeatother\n\\\\provideenvironment{figure}{}{}\\\\renewenvironment{figure}{}{}`,\n    contents,\n    'begin{figure}',\n  )\n  if (contents.content.includes('\\\\selectarrownum')) {\n    logPDF(`\\\\selectarrownum : ${window.location.href}`)\n    // gestion des commandes pour les sujets DNB : dnb_2018_06_ameriquenord_4\n    contents.preamble +=\n      \"\\n\\\\newcommand*\\\\selectarrownum{% le petit triangle vers le bas  ct d'un _nombre_\"\n    contents.preamble +=\n      '\\n  \\\\unskip\\\\hskip0.125em \\\\tikz[baseline=-1.25ex,x=1ex,y=1ex,rounded corners=0pt]\\\\draw[fill=black!70,draw=none](0,0)--(1,0)--(0.5,-0.6)--cycle;'\n    contents.preamble += '\\n}'\n  }\n  testIfLoaded(\n    [\n      '\\\\R ',\n      '\\\\R{',\n      '\\\\R)',\n      '\\\\R.',\n      '\\\\R^',\n      '\\\\R\\\\',\n      '\\\\R$',\n      '\\\\R_+',\n      '\\\\in \\\\R',\n      '\\\\N ',\n      '\\\\N*',\n      '\\\\N^*',\n      '\\\\N,',\n      '\\\\N{',\n      '\\\\N^{',\n      '\\\\N$',\n      '\\\\N}',\n    ],\n    '\\\\usepackage{amsfonts}',\n    contents,\n  )\n  testIfLoaded(\n    [\n      '\\\\R ',\n      '\\\\R{',\n      '\\\\R.',\n      '\\\\R)',\n      '\\\\R_+',\n      '\\\\R$',\n      '\\\\R^',\n      '\\\\R\\\\',\n      '\\\\in \\\\R',\n    ],\n    '\\\\newcommand\\\\R{\\\\mathbb{R}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\N ', '\\\\N,', '\\\\N^*', '\\\\N{', '\\\\N^{', '\\\\N$', '\\\\N*', '\\\\N}'],\n    '\\\\newcommand\\\\N{\\\\mathbb{N}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vect', '\\\\Oij', '\\\\Oijk', '\\\\Ouv'],\n    '\\\\newcommand{\\\\vect}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut#1\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vectt'],\n    '\\\\newcommand{\\\\vectt}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut\\\\text{#1}\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vv'],\n    '\\\\newcommand{\\\\vv}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut#1\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vvt'],\n    '\\\\newcommand{\\\\vvt}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut\\\\text{#1}\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Oij'],\n    '\\\\def\\\\Oij{$\\\\left(\\\\text{O}~;~\\\\vect{\\\\imath},~\\\\vect{\\\\jmath}\\\\right)$}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Oijk'],\n    '\\\\def\\\\Oijk{$\\\\left(\\\\text{O}~;~\\\\vect{\\\\imath},~\\\\vect{\\\\jmath},~\\\\vect{k}\\\\right)$}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Ouv'],\n    '\\\\def\\\\Ouv{$\\\\left(\\\\text{O}~;~\\\\vect{u},~\\\\vect{v}\\\\right)$}',\n    contents,\n  )\n  testIfLoaded(['\\\\e'], '\\\\newcommand{\\\\e}{\\\\mathrm{e}}', contents)\n  testIfLoaded(\n    [\n      '\\\\ldots',\n      '\\\\cdots',\n      '\\\\dots',\n      '\\\\makebox',\n      '\\\\framebox',\n      '\\\\parbox',\n      '\\\\mbox',\n      '\\\\fbox',\n      '\\\\sbox',\n      '\\\\pbox',\n    ],\n    '\\\\usepackage{amsmath}',\n    contents,\n  )\n  testIfLoaded(\n    [\n      '\\\\leadsto',\n      '\\\\square',\n      '\\\\blacktriangleright',\n      '\\\\blacktriangleleft',\n      '\\\\mathbb',\n      '\\\\geqslant',\n      '\\\\leqslant',\n      '\\\\curvearrowleft',\n      '\\\\Box',\n      '\\\\checkmark',\n      '\\\\fbox',\n    ],\n    '\\\\usepackage{amssymb}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\columncolor{', '\\\\cellcolor', '\\\\rowcolor'],\n    '\\\\usepackage{colortbl}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\ovalnum{\\\\ovalnum'],\n    '\\\\definecolor{scrmovedddd}    {HTML}{3373cc}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\ding{', '\\\\textding', '\\\\decoone'],\n    '\\\\usepackage{pifont}',\n    contents,\n  )\n  testIfLoaded(['\\\\decoone'], '\\\\newcommand{\\\\decoone}{\\\\ding{87}}', contents)\n  testIfLoaded(\n    ['\\\\textding'],\n    '\\\\newcommand{\\\\textding}[1]{\\\\text{\\\\Large \\\\ding{#1}}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\starredbullet'],\n    '\\\\usepackage{MnSymbol}\\n\\\\newcommand\\\\starredbullet{\\\\medstar}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\decosix'],\n    '\\\\providecommand\\\\decosix{}\\n\\\\renewcommand\\\\decosix{$\\\\bullet$}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\toprule', '\\\\midrule', '\\\\bottomrule'],\n    '\\\\usepackage{booktabs}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\backslashbox', '\\\\diagbox{'],\n    '\\\\usepackage{diagbox}',\n    contents,\n  )\n  testIfLoaded(['\\\\ds'], '\\\\newcommand{\\\\ds}{\\\\displaystyle}', contents)\n  testIfLoaded(['\\\\EUR{'], '\\\\usepackage{marvosym}', contents)\n  testIfLoaded(\n    ['\\\\hautab'],\n    '\\\\newcommand\\\\hautab[1]{\\\\renewcommand{\\\\arraystretch}{#1}}',\n    contents,\n  )\n  testIfLoaded(\n    ['|C{', '{C{'],\n    '\\\\newcolumntype{C}[1]{>{\\\\centering\\\\arraybackslash}p{#1cm}}',\n    contents,\n  )\n  testIfLoaded(\n    ['pattern'],\n    '\\\\usetikzlibrary{patterns,patterns.meta}',\n    contents,\n  )\n  testIfLoaded(['framed'], '\\\\usetikzlibrary{backgrounds}', contents)\n  testIfLoaded(\n    ['single arrow', 'ellipse,'],\n    '\\\\usetikzlibrary{shapes}',\n    contents,\n  )\n  testIfLoaded(['>=triangle 45'], '\\\\usetikzlibrary{arrows}', contents)\n  testIfLoaded(\n    ['-{Latex', '-{Stealth', '-{Triangle', '-{Bar', '{Bar['],\n    '\\\\usetikzlibrary{arrows.meta}',\n    contents,\n  )\n  testIfLoaded(['below=2mm of'], '\\\\usetikzlibrary{positioning}', contents)\n  testIfLoaded(\n    ['\\\\llbracket', '\\\\rrbracket'],\n    '\\\\usepackage{stmaryrd}',\n    contents,\n  )\n  testIfLoaded(['\\\\newcommandtwoopt{'], '\\\\usepackage{twoopt}', contents)\n  testIfLoaded(\n    ['\\\\interval'],\n    '\\\\usepackage{interval}\\n \\\\intervalconfig{separator symbol=;}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\getprime{', '\\\\primedecomp{'],\n    decompDNB(),\n    contents,\n    'decompNombresPremiersDNB',\n  )\n  testIfLoaded(['\\\\SquarO['], squareO(), contents)\n  testIfLoaded(\n    ['\\\\con{'],\n    '\\\\newcommand{\\\\con}[1]{\\\\textcolor{violet}{#1}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Coord'],\n    `\\\\newcommand*{\\\\Coord}[4]{% \n\\\\ensuremath{\\\\vect{#1}\\\\, \n      \\\\begin{pmatrix} \n        #2\\\\\\\\ \n        #3\\\\\\\\\n        #4\n\\\\end{pmatrix}}}`,\n    contents,\n    '\\\\Coord',\n  )\n  testIfLoaded(['\\\\widearc{', '\\\\eurologo'], '\\\\usepackage{fourier}', contents)\n  testIfLoaded(['\\\\tkzAxeXY'], '\\\\usepackage{tkz-base}', contents)\n  testIfLoaded(['\\\\tkz', '\\\\pic['], '\\\\usepackage{tkz-euclide}', contents)\n  testIfLoaded(\n    ['\\\\pstEllipse[linewidth='],\n    '\\\\providecommand\\\\pstEllipse{}\\n\\\\renewcommand{\\\\pstEllipse}[5][]{%\\n\\\\psset{#1}\\n\\\\parametricplot{#4}{#5}{#2\\\\space t cos mul #3\\\\space t sin mul}\\n}',\n    contents,\n    '\\\\pstEllipse',\n  )\n  testIfLoaded(['\\\\makecell'], '\\\\usepackage{makecell}', contents)\n  testIfLoaded(['\\\\polylongdiv'], '\\\\usepackage{polynom}', contents)\n  testIfLoaded(\n    ['\\\\includegraphicsembedded'],\n    '\\\\usepackage{luaimageembed}',\n    contents,\n  )\n\n  if (\n    contents.content.includes('\\\\begin{forest}') ||\n    contents.contentCorr.includes('\\\\begin{forest}')\n  ) {\n    logPDF(`usepackage{forest} : ${window.location.href}`)\n    // gestion des commandes pour les sujets DNB : 2023\n    contents.preamble += `\\n\\\\usetikzlibrary{trees} % arbre en proba\n\\\\usepackage{forest} % arbre en proba\n\\\\usetikzlibrary{positioning}\n% Structure servant  avoir l'vnement et la probabilit.\n\\\\def\\\\getEvene#1/#2\\\\endget{$#1$}\n\\\\def\\\\getProba#1/#2\\\\endget{$#2$}`\n  }\n}\n\nfunction decompDNB() {\n  return `%%% Table des nombres premiers  %%%%\n\\\\usepackage{xlop}\n\\\\newcount\\\\primeindex\n\\\\newcount\\\\tryindex\n\\\\newif\\\\ifprime\n\\\\newif\\\\ifagain\n\\\\newcommand\\\\getprime[1]{%\n\\\\opcopy{2}{P0}%\n\\\\opcopy{3}{P1}%\n\\\\opcopy{5}{try}\n\\\\primeindex=2\n\\\\loop\n\\\\ifnum\\\\primeindex<#1\\\\relax\n\\\\testprimality\n\\\\ifprime\n\\\\opcopy{try}{P\\\\the\\\\primeindex}%\n\\\\advance\\\\primeindex by1\n\\\\fi\n\\\\opadd*{try}{2}{try}%\n\\\\ifnum\\\\primeindex<#1\\\\relax\n\\\\testprimality\n\\\\ifprime\n\\\\opcopy{try}{P\\\\the\\\\primeindex}%\n\\\\advance\\\\primeindex by1\n\\\\fi\n\\\\opadd*{try}{4}{try}%\n\\\\fi\n\\\\repeat\n}\n\n\\\\newcommand\\\\testprimality{%\n\\\\begingroup\n\\\\againtrue\n\\\\global\\\\primetrue\n\\\\tryindex=0\n\\\\loop\n\\\\opidiv*{try}{P\\\\the\\\\tryindex}{q}{r}%\n\\\\opcmp{r}{0}%\n\\\\ifopeq \\\\global\\\\primefalse \\\\againfalse \\\\fi\n\\\\opcmp{q}{P\\\\the\\\\tryindex}%\n\\\\ifoplt \\\\againfalse \\\\fi\n\\\\advance\\\\tryindex by1\n\\\\ifagain\n\\\\repeat\n\\\\endgroup\n}\n\n%%% Dcomposition en nombres premiers %%%\n\n\\\\newcommand\\\\primedecomp[2][nil]{%\n\\\\begingroup\n\\\\opset{#1}%\n\\\\opcopy{#2}{NbtoDecompose}%\n\\\\opabs{NbtoDecompose}{NbtoDecompose}%\n\\\\opinteger{NbtoDecompose}{NbtoDecompose}%\n\\\\opcmp{NbtoDecompose}{0}%\n\\\\ifopeq\nJe refuse de dcomposer zro.\n\\\\else\n\\\\setbox1=\\\\hbox{\\\\opdisplay{operandstyle.1}%\n{NbtoDecompose}}%\n{\\\\setbox2=\\\\box2{}}%\n\\\\count255=1\n\\\\primeindex=0\n\\\\loop\n\\\\opcmp{NbtoDecompose}{1}\\\\ifopneq\n\\\\opidiv*{NbtoDecompose}{P\\\\the\\\\primeindex}{q}{r}%\n\\\\opcmp{0}{r}\\\\ifopeq\n\\\\ifvoid2\n\\\\setbox2=\\\\hbox{%\n\\\\opdisplay{intermediarystyle.\\\\the\\\\count255}%\n{P\\\\the\\\\primeindex}}%\n\\\\else\n\\\\setbox2=\\\\vtop{%\n\\\\hbox{\\\\box2}\n\\\\hbox{%\n\\\\opdisplay{intermediarystyle.\\\\the\\\\count255}%\n{P\\\\the\\\\primeindex}}}\n\\\\fi\n\\\\opcopy{q}{NbtoDecompose}%\n\\\\advance\\\\count255 by1\n\\\\setbox1=\\\\vtop{%\n\\\\hbox{\\\\box1}\n\\\\hbox{%\n\\\\opdisplay{operandstyle.\\\\the\\\\count255}%\n{NbtoDecompose}}\n}%\n\\\\else\n\\\\advance\\\\primeindex by1\n\\\\fi\n\\\\repeat\n\\\\hbox{\\\\box1\n\\\\kern0.5\\\\opcolumnwidth\n\\\\opvline(0,0.75){\\\\the\\\\count255.25}\n\\\\kern0.5\\\\opcolumnwidth\n\\\\box2}%\n\\\\fi\n\\\\endgroup\n}`\n}\n\nfunction squareO() {\n  return `%%%\n  % Squaro\n  %%% \n  \n  \\\\setKVdefault[Squaro]{Solution=false,Longueur=8,Largeur=8,Echelle=8mm,Graines=false,Perso=false} \n  \\\\defKV[Squaro]{Graine=\\\\setKV[Squaro]{Graines}}%\n  \n  \n  \\\\RenewDocumentCommand\\\\SquarO{o m}{%\n    \\\\useKVdefault[Squaro]%\n    \\\\setKV[Squaro]{#1}%\n    \\\\BuildSquaro[#2]%\n  }%\n  \n  \\\\def\\\\BuildSquarobase{%\n    numeric Longueur,Largeur;\n    Longueur=\\\\useKV[Squaro]{Longueur};\n    Largeur=\\\\useKV[Squaro]{Largeur};\n    boolean Solution,Graines,Perso;\n    Solution=\\\\useKV[Squaro]{Solution};\n    Graines=\\\\useKV[Squaro]{Graines};\n    Perso=\\\\useKV[Squaro]{Perso};\n    if Graines:\n      randomseed:=\\\\useKV[Squaro]{Graine};\n    fi;\n    u:=\\\\useKV[Squaro]{Echelle};\n    p:=0;\n    pair A[];%centre des carrs.\n    boolean Allume[][];\n  }\n  \n  \\\\RenewDocumentCommand\\\\BuildSquaro{o}{%\n    \\\\mplibforcehmode\n    \\\\begin{mplibcode}  \n      \\\\BuildSquarobase\n      \n    % Construction de la grille    \n      for k=0 upto Longueur-1:\n        for l=0 upto Largeur-1:\n          p:=p+1;\n          A[p]=u*(k,-l);\n          trace (unitsquare scaled u) shifted A[p];\n        endfor;\n      endfor;\n  \n      % Trac des cercles vides (ou pleins si Solution)\n      if Perso :\n      string GrillePers;  \n        GrillePers := \"#1\";\n        string valeur;\n        numeric indice;\n        indice=0;\n      for k=0 upto Largeur:\n          for l=0 upto Longueur:\n            valeur := substring(indice,indice+1) of GrillePers;\n            if valeur=\"1\":\n              Allume[k][l]=false;\n              fill cercles(u*(l,-k+1),1mm) withcolor white;\n            else :\n              Allume[k][l]=true;\n              fill cercles(u*(l,-k+1),1mm) if Solution=false:withcolor white fi;\n            fi;\n            trace cercles(u*(l,-k+1),1mm);\n            indice := indice + 2; % A cause de la virgule\n        endfor;\n      endfor;\n    else :\n      for k=0 upto Largeur:\n          for l=0 upto Longueur:\n             m:=uniformdeviate(1);\n            if m<0.5:\n              Allume[k][l]=true;\n              fill cercles(u*(l,-k+1),1mm) if Solution=false:withcolor white fi;\n            else:\n              Allume[k][l]=false;\n              fill cercles(u*(l,-k+1),1mm) withcolor white;\n            fi;\n            trace cercles(u*(l,-k+1),1mm);\n          endfor;\n        endfor;\n      fi;\n      \n    % Placement des chiffres dans les cases\n      for k=0 upto Largeur-1:\n      for l=0 upto Longueur-1:\n      Retiens:=0;\n      if Allume[k][l]:Retiens:=Retiens+1 fi;\n      if Allume[k][l+1]:Retiens:=Retiens+1 fi;\n      if Allume[k+1][l]:Retiens:=Retiens+1 fi;\n      if Allume[k+1][l+1]:Retiens:=Retiens+1 fi;\n      label(TEX(decimal(Retiens)),u*(l+0.5,-k+0.5));\n      endfor;\n      endfor;\n    \\\\end{mplibcode}\n  }%`\n}\n","import seedrandom from 'seedrandom'\nimport genericPreamble from '../lib/latex/preambule.tex?raw'\nimport {\n  loadFonts,\n  loadPackagesFromContent,\n  loadPreambule,\n  loadProfCollegeIfNeed,\n  logPDF,\n} from '../lib/latex/preambuleTex'\nimport type { IExercice } from '../lib/types'\nimport type {\n  ExoContent,\n  LatexFileInfos,\n  contentsType,\n  latexFileType,\n  picFile,\n} from './LatexTypes'\nimport { mathaleaHandleExerciceSimple } from './mathalea.js'\nimport { getLang } from './stores/languagesStore'\nfunction testIfLoaded(\n  values: string[],\n  valuetoSearch: string,\n  valueToPut: string,\n) {\n  let search = false\n  for (const value of values) {\n    if (value.includes(valuetoSearch)) {\n      search = true\n      break\n    }\n  }\n  if (search) {\n    return valueToPut\n  }\n  return ''\n}\n\nclass Latex {\n  exercices: IExercice[]\n  constructor() {\n    this.exercices = []\n  }\n\n  isExerciceStaticInTheList() {\n    return this.exercices.some((e) => e.typeExercice === 'statique')\n  }\n\n  getExercices() {\n    return this.exercices.map((e, i) => ({\n      titre: e.titre,\n      uuid: e.uuid,\n      index: i,\n    }))\n  }\n\n  addExercices(exercices: IExercice[]) {\n    this.exercices.push(...exercices)\n  }\n\n  getContentsForAVersion(\n    latexFileInfos: LatexFileInfos,\n    indiceVersion: number = 1,\n  ): { content: string; contentCorr: string } {\n    if (latexFileInfos.style === 'ProfMaquette') {\n      return {\n        content: this.getContentForAVersionProfMaquette(\n          indiceVersion,\n          latexFileInfos,\n        ),\n        contentCorr: '',\n      }\n    }\n    if (latexFileInfos.style === 'ProfMaquetteQrcode') {\n      latexFileInfos.qrcodeOption = 'AvecQrcode'\n      return {\n        content: this.getContentForAVersionProfMaquette(\n          indiceVersion,\n          latexFileInfos,\n        ),\n        contentCorr: '',\n      }\n    }\n    let content = ''\n    let contentCorr = ''\n    this.loadExercicesWithVersion(indiceVersion)\n    if (latexFileInfos.style === 'Can') {\n      content += '\\\\begin{TableauCan}\\n'\n      contentCorr += '\\n\\\\begin{enumerate}'\n      for (const exercice of this.exercices) {\n        if (exercice != null) {\n          if (exercice.typeExercice === 'statique') {\n            if (exercice.content === '') {\n              content += '\\\\CompteurTC  &'\n              content += \"% Cet exercice n'est pas disponible au format LaTeX\\n\"\n              content += '&\\\\stepcounter{nbEx}\\\\\\\\ \\n'\n              contentCorr += `\\n\\\\item  Cet exercice n'est pas disponible au format LaTeX`\n            } else {\n              content += '\\\\CompteurTC  &'\n              content += `\\n % @see : ${getUrlFromExercice(exercice)}`\n              content += `\\n %{${exercice.examen || ''} ${exercice.mois || ''} ${exercice.annee || ''} ${exercice.lieu || ''}}\\n`\n              content += exercice.content\n              content += '&\\\\stepcounter{nbEx}\\\\\\\\ \\n'\n              contentCorr += `\\n\\\\item ${exercice.contentCorr || ''}`\n            }\n          } else {\n            // Initalisation de questionLiee  rien pour toutes les questions\n            const questionLiee: {\n              compteurQuestionsLiees: number\n              dejaLiee: boolean\n            }[] = Array.from(\n              { length: exercice.listeQuestions.length },\n              () => ({\n                compteurQuestionsLiees: 0,\n                dejaLiee: false,\n              }),\n            )\n\n            for (let i = 0; i < exercice.listeQuestions.length; i++) {\n              // Enonc de la question\n              const enonce =\n                exercice.listeCanEnonces != null &&\n                exercice.listeCanEnonces[i] !== undefined &&\n                exercice.listeCanEnonces[i].length !== 0\n                  ? exercice.listeCanEnonces[i]\n                  : exercice.listeQuestions[i]\n\n              // Ne fonctionne que pour les CAN\n              if (\n                exercice.listeCanLiees != null &&\n                !exercice.listeCanLiees.every((subTab) => subTab.length === 0)\n              ) {\n                // Recherche si la question est lie  la suivante et aux prochaines\n                if (\n                  exercice.listeCanLiees != null &&\n                  exercice.listeCanLiees[i].length !== 0 &&\n                  !questionLiee[i].dejaLiee\n                ) {\n                  // Recherche d'une question lie  d'autres\n                  let j = i + 1\n                  let questionSuivante = j < exercice.listeQuestions.length\n                  while (questionSuivante) {\n                    // Recherche des questions lies  la prcdente\n                    questionLiee[j].dejaLiee = exercice.listeCanLiees[\n                      j\n                    ].includes(exercice.listeCanNumerosLies[i])\n                    if (questionLiee[j].dejaLiee) {\n                      questionLiee[i].compteurQuestionsLiees++\n                    }\n                    questionSuivante =\n                      questionLiee[j] && j < exercice.listeQuestions.length - 1\n                    j++\n                  }\n                }\n              }\n\n              // L'nonc des CAN est dpendant des questions lies ou pas\n              content += '\\\\CompteurTC  &'\n              if (questionLiee[i].compteurQuestionsLiees !== 0) {\n                content += `\\\\SetCell[r=${questionLiee[i].compteurQuestionsLiees + 1}]{c}`\n              }\n              content += !questionLiee[i].dejaLiee\n                ? ` { ${format(enonce)} }&`\n                : '&'\n\n              // La rponse  complter des CAN est indpendante des questions lies\n              if (\n                exercice.listeCanReponsesACompleter != null &&\n                exercice.listeCanReponsesACompleter[i] !== undefined\n              ) {\n                content += `{${format(exercice.listeCanReponsesACompleter[i])} }`\n              }\n              content += '&\\\\stepcounter{nbEx}\\\\\\\\'\n\n              if (\n                i + 1 < exercice.listeQuestions.length &&\n                questionLiee[i + 1].dejaLiee\n              ) {\n                content += '*'\n              } // Cette toile permet de grer les sauts de page malencontreux\n              content += '\\n'\n            }\n            for (const correction of exercice.listeCorrections) {\n              contentCorr += `\\n\\\\item ${format(correction)}`\n            }\n          }\n        }\n      }\n      contentCorr += '\\n\\\\end{enumerate}\\n'\n      content += '\\\\end{TableauCan}\\n\\\\addtocounter{nbEx}{-1}'\n      /** On supprime les lignes vides car elles posent problme dans l'environnement TableauCan */\n      content = content.replace(/\\n\\s*\\n/gm, '')\n    } else {\n      for (const exercice of this.exercices) {\n        if (exercice.typeExercice === 'statique') {\n          if (exercice.content === '') {\n            content += \"% Cet exercice n'est pas disponible au format LaTeX\"\n          } else {\n            content += `\\n% @see : ${getUrlFromExercice(exercice)}`\n            content += `\\n\\\\begin{EXO}{${exercice.examen || ''} ${exercice.mois || ''} ${exercice.annee || ''} ${exercice.lieu || ''}}{}\\n`\n            content += testIfLoaded(\n              [exercice.content ?? ''],\n              '\\\\anote{',\n              '\\n\\\\resetcustomnotes',\n            )\n            if (Number(exercice.nbCols) > 1) {\n              content += `\\\\begin{multicols}{${exercice.nbCols}}\\n`\n            }\n            content += exercice.content\n            if (Number(exercice.nbCols) > 1) {\n              content += '\\n\\\\end{multicols}\\n'\n            }\n            content += testIfLoaded(\n              [exercice.content ?? ''],\n              '\\\\anote{',\n              '\\n\\\\printcustomnotes',\n            )\n            content += '\\n\\\\end{EXO}\\n'\n            contentCorr += '\\n\\\\begin{EXO}{}{}\\n'\n            contentCorr += testIfLoaded(\n              [exercice.contentCorr ?? ''],\n              '\\\\anote{',\n              '\\n\\\\resetcustomnotes',\n            )\n            contentCorr += exercice.contentCorr\n            contentCorr += testIfLoaded(\n              [exercice.contentCorr ?? ''],\n              '\\\\anote{',\n              '\\n\\\\printcustomnotes',\n            )\n            contentCorr += '\\n\\\\end{EXO}\\n'\n          }\n        } else {\n          contentCorr += '\\n\\\\begin{EXO}{}{}\\n'\n          contentCorr += testIfLoaded(\n            exercice.listeCorrections,\n            '\\\\anote{',\n            '\\n\\\\resetcustomnotes',\n          )\n          contentCorr += buildContent(\n            exercice.listeCorrections,\n            exercice.spacingCorr,\n            Boolean(exercice.listeAvecNumerotation),\n            Number(exercice.nbColsCorr),\n          )\n          contentCorr += testIfLoaded(\n            exercice.listeCorrections,\n            '\\\\anote{',\n            '\\n\\\\printcustomnotes',\n          )\n          contentCorr += '\\n\\\\end{EXO}\\n'\n          content += `\\n% @see : ${getUrlFromExercice(exercice)}`\n          content += `\\n\\\\begin{EXO}{${testIfLoaded([exercice.introduction, exercice.consigne, ...exercice.listeQuestions], '\\\\anote{', '\\n\\\\resetcustomnotes ')}${format(exercice.consigne, false)}}{${String(exercice.id).replace('.js', '')}}\\n`\n          content += writeIntroduction(exercice.introduction)\n          content += buildContent(\n            exercice.listeQuestions,\n            exercice.spacing,\n            Boolean(exercice.listeAvecNumerotation),\n            Number(exercice.nbCols),\n          )\n          content += testIfLoaded(\n            [\n              exercice.introduction,\n              exercice.consigne,\n              ...exercice.listeQuestions,\n            ],\n            '\\\\anote{',\n            '\\n\\\\printcustomnotes',\n          )\n          content += '\\n\\\\end{EXO}\\n'\n        }\n      }\n    }\n    return { content, contentCorr }\n  }\n\n  loadExercicesWithVersion(indiceVersion: number = 1) {\n    for (const exercice of this.exercices) {\n      if (exercice.typeExercice === 'statique') {\n        const serie = exercice?.examen?.toLowerCase()\n        if (serie === 'crpe' && indiceVersion === 1) {\n          exercice.content = exercice.content?.replaceAll('{Images/', '{')\n          exercice.contentCorr = exercice.contentCorr?.replaceAll(\n            '{Images/',\n            '{',\n          )\n        }\n        continue\n      }\n      if (!Object.prototype.hasOwnProperty.call(exercice, 'listeQuestions')) {\n        continue\n      }\n      const seedOld = exercice.seed\n      const seed =\n        indiceVersion > 1\n          ? exercice.seed + indiceVersion.toString()\n          : exercice.seed\n      exercice.seed = seed\n      if (exercice.typeExercice === 'simple') {\n        mathaleaHandleExerciceSimple(exercice, false)\n      } else {\n        seedrandom(seed, { global: true })\n        if (typeof exercice.nouvelleVersionWrapper === 'function') {\n          exercice.nouvelleVersionWrapper()\n        }\n      }\n      exercice.seed = seedOld // on remet l'ancienne seed pour ne pas perturber la gnration des versions suivantes\n    }\n  }\n\n  getContentForAVersionProfMaquette(\n    indiceVersion: number = 1,\n    latexFileInfos: LatexFileInfos,\n  ): string {\n    this.loadExercicesWithVersion(indiceVersion)\n    let content = ''\n    for (let k = 0; k < this.exercices.length; k++) {\n      const exercice = this.exercices[k]\n      const confExo: {\n        labels?: string\n        itemsep?: number\n        blocrep?: { nbligs: number; nbcols: number }\n        cols?: number\n        cols_corr?: number\n      } =\n        latexFileInfos.exos && latexFileInfos.exos[k]\n          ? latexFileInfos.exos[k]\n          : {}\n      content += `\\n% @see : ${getUrlFromExercice(exercice, indiceVersion)}`\n      if (exercice.typeExercice === 'statique') {\n        if (exercice.content === '') {\n          content += \"% Cet exercice n'est pas disponible au format LaTeX\"\n        } else {\n          content += '\\n\\\\needspace{10\\\\baselineskip}'\n          if (latexFileInfos.qrcodeOption === 'AvecQrcode') {\n            content += `\\n\\\\begin{exercice}[${\n              latexFileInfos.titleOption === 'AvecTitre'\n                ? `Titre=${latexFileInfos.titleOption}, `\n                : ''\n            }Ajout={\\\\node[anchor=north east, inner sep=2pt]\n        at (frame.north east) {\\\\hypersetup{urlcolor=black, pdfnewwindow=true}\\\\qrcode[height=2cm]{${getUrlFromExercice(exercice, indiceVersion)}&v=eleve&es=0211}};\n}]%[Lignes=5,Interieur]`\n          } else {\n            content += `\\n\\\\begin{exercice}${\n              latexFileInfos.titleOption === 'AvecTitre'\n                ? `[Titre=${latexFileInfos.titleOption}]`\n                : ''\n            }%[Lignes=5,Interieur]\\n`\n          }\n          if (latexFileInfos.qrcodeOption === 'AvecQrcode')\n            content += '\\n\\\\vspace{2cm}'\n          content += exercice.content\n          content += '\\n\\\\end{exercice}\\n'\n          content += '\\n\\\\begin{Solution}\\n'\n          content += exercice.contentCorr\n          content += '\\n\\\\end{Solution}\\n'\n        }\n      } else {\n        content += '\\n\\\\needspace{10\\\\baselineskip}'\n        if (latexFileInfos.qrcodeOption === 'AvecQrcode') {\n          content += `\\n\\\\begin{exercice}[${\n            latexFileInfos.titleOption === 'AvecTitre'\n              ? `Titre=${exercice.titre}, `\n              : ''\n          }Ajout={\\\\node[anchor=north east, inner sep=2pt]\n        at (frame.north east) {\\\\hypersetup{urlcolor=black}\\\\qrcode[height=2cm]{${getUrlFromExercice(exercice, indiceVersion)}&v=eleve&es=0211}};\n}]%[Lignes=5,Interieur]`\n        } else {\n          content += `\\n\\\\begin{exercice}${\n            latexFileInfos.titleOption === 'AvecTitre'\n              ? `[Titre=${exercice.titre}]`\n              : ''\n          }%[Lignes=5,Interieur]\\n`\n        }\n        content += testIfLoaded(\n          [\n            ...exercice.listeQuestions,\n            exercice.consigne,\n            exercice.introduction,\n          ],\n          '\\\\anote{',\n          '\\n\\\\resetcustomnotes',\n        )\n        if (latexFileInfos.qrcodeOption === 'AvecQrcode') {\n          const phrases =\n            exercice.listeQuestions.length > 0\n              ? exercice.listeQuestions[0].split(/\\\\\\\\|\\r?\\n/)\n              : []\n          const firstQuestion = phrases.length > 0 ? phrases[0] : ''\n          const secondQuestion = phrases.length > 1 ? phrases[1] : ''\n          if (\n            latexFileInfos.qrcodeOption === 'AvecQrcode' &&\n            (exercice.introduction.length > 40 ||\n              exercice.consigne.length > 40 ||\n              firstQuestion.length > 40 ||\n              secondQuestion.length > 40)\n          ) {\n            // il faut un espace pour le QRCODE\n            content += '\\n\\\\vspace{2cm}'\n          }\n        }\n\n        content += writeIntroduction(exercice.introduction)\n        content += '\\n' + format(exercice.consigne)\n        content += buildContent(\n          exercice.listeQuestions,\n          exercice.spacing,\n          Boolean(exercice.listeAvecNumerotation),\n          confExo.cols ? confExo.cols : Number(exercice.nbCols),\n          confExo,\n        )\n        content += testIfLoaded(\n          [\n            ...exercice.listeQuestions,\n            exercice.consigne,\n            exercice.introduction,\n          ],\n          '\\\\anote{',\n          '\\n\\\\printcustomnotes',\n        )\n        content += '\\n\\\\end{exercice}\\n'\n        content += '\\n\\\\begin{Solution}'\n        content += testIfLoaded(\n          [...exercice.listeCorrections],\n          '\\\\anote{',\n          '\\n\\\\resetcustomnotes',\n        )\n        content += buildContent(\n          exercice.listeCorrections,\n          exercice.spacingCorr,\n          Boolean(exercice.listeAvecNumerotation),\n          confExo.cols_corr ? confExo.cols_corr : Number(exercice.nbColsCorr),\n          confExo.labels ? { labels: confExo.labels } : {},\n        )\n        content += testIfLoaded(\n          [...exercice.listeCorrections],\n          '\\\\anote{',\n          '\\n\\\\printcustomnotes',\n        )\n        content += '\\n\\\\end{Solution}\\n'\n      }\n    }\n    return content\n  }\n\n  async getContents(latexFileInfos: LatexFileInfos): Promise<contentsType> {\n    const contents: contentsType = {\n      preamble: '',\n      intro: '',\n      content: '',\n      contentCorr: '',\n    }\n    if (\n      latexFileInfos.style === 'ProfMaquette' ||\n      latexFileInfos.style === 'ProfMaquetteQrcode'\n    ) {\n      if (latexFileInfos.style === 'ProfMaquette') {\n        for (let i = 1; i < latexFileInfos.nbVersions + 1; i++) {\n          if (latexFileInfos.signal?.aborted) {\n            throw new DOMException(\n              'Aborted in getContents of Latex.ts',\n              'AbortError',\n            )\n          }\n          const contentVersion = this.getContentForAVersionProfMaquette(\n            i,\n            latexFileInfos,\n          )\n          contents.content += `\\n\\\\begin{Maquette}[Fiche=${latexFileInfos.typeFiche === 'Fiche' ? 'true' : 'false'},IE=${latexFileInfos.typeFiche === 'Fiche' ? 'false' : 'true'}]{Numero= ,Niveau=${latexFileInfos.subtitle || ' '},Classe=${latexFileInfos.reference || ' '},Date= ${latexFileInfos.nbVersions > 1 ? 'v' + i : ' '} ,Theme={${latexFileInfos.title || 'Exercices'}},Code= ,Calculatrice=false}\\n`\n          contents.content += contentVersion\n\n          contents.content += '\\n\\\\end{Maquette}'\n          contents.content += '\\n\\\\clearpage'\n          contents.contentCorr = ''\n        }\n      } else if (latexFileInfos.style === 'ProfMaquetteQrcode') {\n        for (let i = 1; i < latexFileInfos.nbVersions + 1; i++) {\n          if (latexFileInfos.signal?.aborted) {\n            throw new DOMException(\n              'Aborted2 in getContents of Latex.ts',\n              'AbortError',\n            )\n          }\n          latexFileInfos.qrcodeOption = 'AvecQrcode'\n          const contentVersion = this.getContentForAVersionProfMaquette(\n            i,\n            latexFileInfos,\n          )\n          contents.content += `\\n\\\\begin{Maquette}[Fiche=true, IE=false, CorrigeApres=false, CorrigeFin=true]{Niveau=${latexFileInfos.subtitle || ' '},Classe=${latexFileInfos.reference || ' '},Date= ${latexFileInfos.nbVersions > 1 ? 'v' + i : ' '} ,Theme=${latexFileInfos.title || 'Exercices'}}\\n`\n          contents.content += contentVersion\n          contents.content += '\\n\\\\end{Maquette}'\n          contents.content += '\\n\\\\clearpage'\n          contents.contentCorr = ''\n        }\n      }\n      if (latexFileInfos.signal?.aborted) {\n        throw new DOMException(\n          'Aborted3 in getContents of Latex.ts',\n          'AbortError',\n        )\n      }\n      this.loadPreambuleFromContents(contents, latexFileInfos)\n      contents.intro += '\\n\\\\begin{document}'\n    } else {\n      for (let i = 1; i < latexFileInfos.nbVersions + 1; i++) {\n        if (latexFileInfos.signal?.aborted) {\n          throw new DOMException(\n            'Aborted in getContents of Latex.ts',\n            'AbortError',\n          )\n        }\n        const contentVersion = this.getContentsForAVersion(latexFileInfos, i)\n        if (i > 1) {\n          contents.content += '\\n\\\\clearpage'\n          contents.content += '\\n\\\\setcounter{ExoMA}{0}'\n          contents.contentCorr += '\\n\\\\clearpage'\n          contents.contentCorr += '\\n\\\\setcounter{ExoMA}{0}'\n        }\n        if (latexFileInfos.nbVersions > 1) {\n          contents.content += `\\n\\\\version{${i}}`\n          contents.contentCorr += `\\n\\\\version{${i}}`\n          if (i > 1 && latexFileInfos.style === 'Can') {\n            contents.content += '\\n\\\\setcounter{nbEx}{1}'\n            contents.content += '\\n\\\\setcounter{CompteurTableauCan}{0}'\n            contents.content += '\\n\\\\pageDeGardeCan{nbEx}\\n\\\\clearpage'\n          }\n        }\n        contents.content += contentVersion.content\n        contents.contentCorr += contentVersion.contentCorr\n      }\n      if (latexFileInfos.signal?.aborted) {\n        throw new DOMException(\n          'Aborted in getContents of Latex.ts',\n          'AbortError',\n        )\n      }\n      if (latexFileInfos.style === 'Can') {\n        const currentUrl = this.getURL()\n        contents.preamble = `% @see : ${currentUrl.href.replaceAll('%', '\\\\%')}\\n\\\\documentclass[a4paper,11pt,fleqn]{article}\\n\\n${addPackages(latexFileInfos, contents)}\\n\\n`\n        contents.preamble +=\n          '% Pour les carrs des cases  cocher\\n\\\\usepackage{fontawesome5}\\n\\n'\n        contents.preamble += '\\n\\\\newbool{correctionDisplay}'\n        contents.preamble += `\\n\\\\setbool{correctionDisplay}{${latexFileInfos.correctionOption === 'AvecCorrection' ? 'true' : 'false'}}`\n        contents.preamble += `\\n\\\\Theme[CAN]{}{}{${latexFileInfos.durationCanOption}}{}`\n        contents.intro += '\\n\\\\begin{document}'\n        contents.intro += '\\n\\\\setcounter{nbEx}{1}'\n        contents.intro += '\\n\\\\setcounter{CompteurTableauCan}{0}'\n        contents.intro += '\\n\\\\pageDeGardeCan{nbEx}'\n        contents.intro += '\\n\\\\clearpage'\n      } else {\n        const currentUrl = this.getURL()\n        contents.preamble += `% @see : ${currentUrl.href.replaceAll('%', '\\\\%')}\\n\\\\documentclass[a4paper,11pt,fleqn]{article}\\n\\n${addPackages(latexFileInfos, contents)}\\n\\n`\n        contents.preamble += `\\\\Theme[${latexFileInfos.style}]{nombres}{${latexFileInfos.title}}{${latexFileInfos.reference}}{${latexFileInfos.subtitle}}`\n        contents.intro += '\\n\\\\begin{document}\\n'\n      }\n    }\n    return contents\n  }\n\n  private getURL(): URL {\n    const currentUrl = new URL(window.location.href)\n    if (currentUrl.hostname === 'localhost') {\n      currentUrl.hostname = 'www.coopmaths.fr'\n      currentUrl.port = ''\n      currentUrl.protocol = 'https:'\n      if (!currentUrl.pathname.startsWith('/alea')) {\n        // garde la partie existante mais la prfixe\n        // ex: '/foo' -> '/alea/foo', '/alea' reste '/alea'\n        currentUrl.pathname = '/alea' + currentUrl.pathname\n      }\n    }\n    currentUrl.searchParams.set('v', 'eleve')\n    return currentUrl\n  }\n\n  private loadPreambuleFromContents(\n    contents: contentsType,\n    latexFileInfos: LatexFileInfos,\n  ) {\n    const currentUrl = this.getURL()\n    contents.preamble = `% @see : ${currentUrl.href.replaceAll('%', '\\\\%')}`\n    contents.preamble += '\\n\\\\documentclass[a4paper,11pt,fleqn]{article}'\n    loadProfCollegeIfNeed(contents) // avant profmaquette sinon a plante\n    contents.preamble += '\\n\\\\usepackage{xcolor}'\n    contents.preamble += '\\n\\\\usepackage{ProfMaquette}'\n    contents.preamble += `\\n\\\\setKVdefault[Boulot]{CorrigeFin=${latexFileInfos.correctionOption === 'AvecCorrection' ? 'true' : 'false'}}`\n    contents.preamble +=\n      '\\n\\\\setKVdefault[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}'\n    contents.preamble +=\n      '\\n\\\\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}'\n    contents.preamble += '\\n\\\\usepackage[luatex]{hyperref}'\n    contents.preamble += '\\n\\\\usepackage{tikz}'\n    contents.preamble += '\\n\\\\usetikzlibrary{calc}'\n    contents.preamble += '\\n\\\\usepackage{fancyhdr}'\n    contents.preamble += '\\n\\\\pagestyle{fancy}'\n\n    contents.preamble += '\\n\\\\renewcommand\\\\headrulewidth{0pt}'\n    contents.preamble += '\\n\\\\setlength{\\\\headheight}{18pt}'\n    contents.preamble += `\\n\\\\fancyhead[R]{\\\\href{${currentUrl.href.replaceAll('%', '\\\\%')}}{Mathala}}`\n    contents.preamble += '\\n\\\\fancyfoot[C]{\\\\thepage}'\n    contents.preamble += `\\n\\\\fancyfoot[R]{%\n\\\\begin{tikzpicture}[remember picture,overlay]\n  \\\\node[anchor=south east] at ($(current page.south east)+(-2,0.25cm)$) {\\\\scriptsize {\\\\bfseries \\\\href{https://coopmaths.fr/}{Coopmaths.fr} -- \\\\href{http://creativecommons.fr/licences/}{CC-BY-SA}}};\n\\\\end{tikzpicture}\n}`\n    contents.preamble += `\\n\\\\fancyhead[L]{\n\\\\begin{tikzpicture}[y=0.8, x=0.8, yscale=-0.04, xscale=0.04,remember picture, overlay,fill=orange!50,transform canvas={xshift=-1cm,yshift=1cm}]\n%%%% Arc suprieur gauche%%%%\n\\\\path[fill](523,1424)..controls(474,1413)and(404,1372)..(362,1333)..controls(322,1295)and(313,1272)..(331,1254)..controls(348,1236)and(369,1245)..(410,1283)..controls(458,1328)and(517,1356)..(575,1362)..controls(635,1368)and(646,1375)..(643,1404)..controls(641,1428)and(641,1428)..(596,1430)..controls(571,1431)and(538,1428)..(523,1424)--cycle;\n%%%% D face suprieur%%%%\n\\\\path[fill](512,1272)..controls(490,1260)and(195,878)..(195,861)..controls(195,854)and(198,846)..(202,843)..controls(210,838)and(677,772)..(707,772)..controls(720,772)and(737,781)..(753,796)..controls(792,833)and(1057,1179)..(1057,1193)..controls(1057,1200)and(1053,1209)..(1048,1212)..controls(1038,1220)and(590,1283)..(551,1282)..controls(539,1282)and(521,1278)..(512,1272)--cycle;\n%%%% D faces gauche et droite%%%%\n\\\\path[fill](1061,1167)..controls(1050,1158)and(978,1068)..(900,967)..controls(792,829)and(756,777)..(753,756)--(748,729)--(724,745)..controls(704,759)and(660,767)..(456,794)..controls(322,813)and(207,825)..(200,822)..controls(193,820)and(187,812)..(187,804)..controls(188,797)and(229,688)..(279,563)..controls(349,390)and(376,331)..(391,320)..controls(406,309)and(462,299)..(649,273)..controls(780,254)and(897,240)..(907,241)..controls(918,243)and(927,249)..(928,256)..controls(930,264)and(912,315)..(889,372)..controls(866,429)and(848,476)..(849,477)..controls(851,479)and(872,432)..(897,373)..controls(936,276)and(942,266)..(960,266)..controls(975,266)and(999,292)..(1089,408)..controls(1281,654)and(1290,666)..(1290,691)..controls(1290,720)and(1104,1175)..(1090,1180)..controls(1085,1182)and (1071,1176)..(1061,1167)--cycle;\n%%%% Arc infrieur bas%%%%\n\\\\path[fill](1329,861)..controls(1316,848)and(1317,844)..(1339,788)..controls(1364,726)and(1367,654)..(1347,591)..controls(1330,539)and(1338,522)..(1375,526)..controls(1395,528)and(1400,533)..(1412,566)..controls(1432,624)and(1426,760)..(1401,821)..controls(1386,861)and(1380,866)..(1361,868)..controls(1348,870)and(1334,866)..(1329,861)--cycle;\n%%%% Arc infrieur gauche%%%%\n\\\\path[fill](196,373)..controls(181,358)and(186,335)..(213,294)..controls(252,237)and(304,190)..(363,161)..controls(435,124)and(472,127)..(472,170)..controls(472,183)and(462,192)..(414,213)..controls(350,243)and(303,283)..(264,343)..controls(239,383)and(216,393)..(196,373)--cycle;\n\\\\end{tikzpicture}\n}\n%%%%%% Style Fiche\n\\\\tcbset{%\n  userfiche/.style={%\n    %move upwards=-1cm,colback=red!75%\n    top=5pt, left=5pt, right=5pt, colback=red!5!white%\n  }%\n}%\n\\\\tcbset{%\n  userfichecor/.style={%\n    %spread upwards=-1cm,colback=gray!5%\n    top=5pt, left=5pt, right=5pt, colback=red!5!white%\n  }%\n}%\n${latexFileInfos.qrcodeOption === 'AvecQrcode' ? '\\n\\\\tcbset{\\n  tikzfiche/.append style={height=4cm, height plus=25cm}\\n}\\n' : ''}\n${\n  latexFileInfos.typeFiche === 'Eval'\n    ? `\n% Interrogations crites\n% Dfinir un toggle \"calculatrice\"\n\\\\newtoggle{CalculatriceDisplay}\n% Valeur par dfaut : dsactive\n\\\\togglefalse{CalculatriceDisplay}\n\\\\tcbset{%\n  userie/.style={%\n  colback=gray!5,\n  enhanced,%\n  overlay unbroken and first={%\n    \\\\iftoggle{CalculatriceDisplay}{\n    \\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[IE]{Calculatrice}{autorise}{interdite} --};\n    }{}\n    }%\n  }%\n}%}`\n    : ''\n}\n% Parametrages\n\\\\hypersetup{\n    colorlinks=true,% On active la couleur pour les liens. Couleur par dfaut rouge\n    linkcolor=blue,% On dfinit la couleur pour les liens internes\n    % filecolor=magenta,% On dfinit la couleur pour les liens vers les fichiers locaux      \n    urlcolor=blue,% On dfinit la couleur pour les liens vers des sites web\n    % pdftitle={Puissance Quatre},% On dfinit un titre pour le document pdf\n    % pdfpagemode=FullScreen,% On fixe l'affichage par dfaut  plein cran\n}`\n    contents.preamble += '\\n\\\\usepackage{qrcode}'\n    contents.preamble += '\\n\\\\usepackage{mathrsfs}'\n    contents.preamble += '\\n\\\\usepackage{enumitem}'\n    contents.preamble += '\\n\\\\usepackage[french]{babel}'\n    contents.preamble += '\\n\\\\setlength{\\\\parindent}{0cm}'\n    loadPackagesFromContent(contents)\n    contents.preamble += loadFonts(latexFileInfos)\n    const [latexCmds, latexPackages] = this.getContentLatex()\n    for (const pack of latexPackages) {\n      logPDF(`pack: ${pack} : ${window.location.href}`)\n      if (pack === 'bclogo') {\n        if (!contents.preamble.includes('bclogo')) {\n          contents.preamble += '\\n\\\\usepackage[tikz]{' + pack + '}'\n        }\n      } else {\n        contents.preamble += '\\n\\\\usepackage{' + pack + '}'\n      }\n    }\n    for (const cmd of latexCmds) {\n      contents.preamble += '\\n' + cmd.replace('cmd', '')\n    }\n  }\n\n  async getFile(latexFileInfos: LatexFileInfos): Promise<latexFileType> {\n    const contents = await this.getContents(latexFileInfos)\n    const preamble = contents?.preamble\n    const intro = contents?.intro\n    const content = contents?.content\n    const contentCorr = contents?.contentCorr\n    let latexWithoutPreamble = ''\n    latexWithoutPreamble += intro\n    latexWithoutPreamble += content\n    if (\n      latexFileInfos.style === 'ProfMaquette' ||\n      latexFileInfos.style === 'ProfMaquetteQrcode'\n    ) {\n      latexWithoutPreamble += '\\n\\\\end{document}'\n    } else if (latexFileInfos.style === 'Can') {\n      latexWithoutPreamble +=\n        '\\n\\n\\\\clearpage\\n\\n\\\\ifbool{correctionDisplay}{\\n\\\\begin{Correction}' +\n        contentCorr +\n        '\\n\\\\clearpage\\n\\\\end{Correction}}{}\\n\\\\end{document}'\n      latexWithoutPreamble +=\n        '\\n\\n% Local Variables:\\n% TeX-engine: luatex\\n% End:'\n    } else {\n      latexWithoutPreamble +=\n        '\\n\\n\\\\clearpage\\n\\n\\\\begin{Correction}' +\n        contentCorr +\n        '\\n\\\\clearpage\\n\\\\end{Correction}\\n\\\\end{document}'\n      latexWithoutPreamble +=\n        '\\n\\n% Local Variables:\\n% TeX-engine: luatex\\n% End:'\n    }\n    const latexWithPreamble = preamble + latexWithoutPreamble\n    return { contents, latexWithoutPreamble, latexWithPreamble }\n  }\n\n  getContentLatex() {\n    const packLatex: string[] = []\n    for (const exo of this.exercices) {\n      if (typeof exo.listePackages === 'string') {\n        packLatex.push(exo.listePackages)\n      } else if (Array.isArray(exo.listePackages)) {\n        packLatex.push(...exo.listePackages)\n      }\n    }\n    const packageFiltered: string[] = packLatex.filter(\n      (value, index, array) => array.indexOf(value) === index,\n    )\n    const [latexCmds, latexPackages] = packageFiltered.reduce(\n      (result: [string[], string[]], element: string) => {\n        result[element.startsWith('cmd') ? 0 : 1].push(element)\n        return result\n      },\n      [[], []],\n    )\n\n    return [latexCmds, latexPackages]\n  }\n}\n\nfunction writeIntroduction(introduction = ''): string {\n  let content = ''\n  if (introduction.length > 0) {\n    content += '\\n' + format(introduction)\n  }\n  return content\n}\n\nfunction buildContent(\n  questions: string[],\n  spacing = 1,\n  numbersNeeded: boolean,\n  nbCols: number = 1,\n  confExo: {\n    labels?: string\n    itemsep?: number\n    blocrep?: { nbligs: number; nbcols: number }\n  } = {},\n): string {\n  let content = ''\n  const blocrep = confExo.blocrep\n    ? `\\\\blocrep[1.5]{${confExo.blocrep.nbligs}}{${confExo.blocrep.nbcols}} `\n    : ''\n  if (questions !== undefined && questions.length > 1) {\n    content += '\\n\\\\begin{enumerate}'\n    const specs: string[] = []\n    if (confExo.itemsep !== undefined && confExo.itemsep !== null) {\n      specs.push(`itemsep=${confExo.itemsep}em`)\n    } else if (spacing !== 0) {\n      specs.push(`itemsep=${spacing}em`)\n    }\n    if (confExo.labels) {\n      specs.push(`label=${confExo.labels}`)\n    } else if (!numbersNeeded) {\n      specs.push('label={}')\n    }\n    if (specs.length !== 0) {\n      content += '[' + specs.join(',') + ']'\n    }\n    for (const question of questions) {\n      if (nbCols > 1) {\n        content += `\\n\\t\\\\item \\\\begin{minipage}[t]{\\\\linewidth} ${format(question)} \\\\end{minipage}${blocrep}`\n      } else {\n        content += `\\n\\t\\\\item ${format(question)}${blocrep}`\n      }\n    }\n    content += '\\n\\\\end{enumerate}'\n  } else {\n    if (nbCols > 1) {\n      content += `\\n \\\\begin{minipage}[t]{\\\\linewidth} ${format(questions[0])} \\\\end{minipage}${blocrep}`\n    } else {\n      content += `\\n ${format(questions[0])}${blocrep}`\n    }\n  }\n  if (nbCols < 2) {\n    return content\n  }\n  return `\\\\begin{multicols}{${nbCols}}${content}\\n\\\\end{multicols}`\n}\n\n/**\n * Construire la liste des URLs pour les fichiers des images ncessaires\n * ### Remarques :\n * * Chaque URL est construite  partir de l'adresse du site Coopmaths\n * * Elle a __toujours__ pour forme `https://coopmaths.fr/alea/static/<serie>/<annee>/tex/<format>/<nom_image>.<format>`\n * * Elle prsuppose donc que les images sont toutes au format `eps` et qu'elles ne sont pas stockes ailleurs.\n * @author sylvain\n */\nexport function buildImagesUrlsList(\n  exosContentList: ExoContent[],\n  picsNames: picFile[][],\n) {\n  const imagesFilesUrls = [] as string[]\n  exosContentList.forEach((exo, i) => {\n    if (picsNames[i].length !== 0) {\n      const year = exo.year\n      const serie = exo?.serie?.toLowerCase()\n      for (const file of picsNames[i]) {\n        if (serie === 'crpe') {\n          if (file.format) {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/images/${file.name}.${file.format}`,\n            )\n          } else {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/images/${file.name}.png`,\n            )\n          }\n        } else if (serie != null) {\n          if (file.format) {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/tex/${file.format}/${file.name}.${file.format}`,\n            )\n          } else {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/tex/eps/${file.name}.eps`,\n            )\n          }\n        } else {\n          imagesFilesUrls.push(\n            `${window.location.origin}/alea/${file.name}.${file.format}`,\n          )\n        }\n      }\n    }\n  })\n  return imagesFilesUrls\n}\n\n/**\n * Constituer la liste des noms des images prsentes dans le code de la feuille d'exercices.\n * ### Principe :\n * * Les deux variables globales `exosContentList` et `picsNames` servent  stocker le contenu de chaque\n * exercice et le nom de chaque images.\n * * Dcoupe le contenu du code LaTeX pour identifier les exercices en dtectant\n * le texte entre les deux chanes `\\begin{EXO}` ... `\\end{EXO}` (hormi les corrections o `\\begin{EXO}`\n * est systmatiquement suivi de `{}` vides)\n * * Dans le code de chaque exercice, on repre la commande `\\includegraphics` dans les lignes non prcdes d'un signe `%`\n * et on rcupre le nom du fichier sans l'extension.\n * ### Remarques :\n * * `picsNames` est une tableau de tableaux au cas o des exercices contiendraient plusieurs figures\n * * les figures dans les corrections ne sont pas concernes.\n * @author sylvain\n */\n\nexport function getExosContentList(exercices: IExercice[]) {\n  const exosContentList: ExoContent[] = []\n  for (const exo of exercices) {\n    let data: ExoContent = {}\n    if (exo.typeExercice === undefined) {\n      Object.assign(data, {}, { content: exo.contenu ?? '' })\n    } else if (exo.typeExercice === 'simple') {\n      Object.assign(data, {}, { content: exo.listeQuestions.join(' ') })\n    } else {\n      data = {\n        content: exo.content,\n        contentCorr: exo.contentCorr,\n        serie: exo.examen,\n        month: exo.mois,\n        year: exo.annee,\n        zone: exo.lieu,\n        title: [exo.examen, exo.mois, exo.annee, exo.lieu].join(' '),\n      }\n    }\n    exosContentList.push(data)\n  }\n  return exosContentList\n}\nexport function getPicsNames(exosContentList: ExoContent[]) {\n  const picsList = [] as RegExpMatchArray[][]\n  const picsNames = [] as picFile[][]\n  const regDeleteCommentaires = /^(?:(?!%))(.*?)$/gm\n  const regExpImage =\n    /(?:.*?)\\\\includegraphics(?:\\[.*?\\])?\\{(?<fullName>.*?)\\}/gm\n  const regExpImageName = /(?<name>.*?)\\.(?<format>.*)$/gm\n  for (const exo of exosContentList) {\n    if (exo.content) {\n      const pics: RegExpMatchArray[] = []\n      // on supprime les phrases avec des commentaires\n      const content = [...exo.content.matchAll(regDeleteCommentaires)]\n      if (exo.contentCorr) {\n        content.push(...exo.contentCorr.matchAll(regDeleteCommentaires))\n      }\n      content.forEach((list) => {\n        // on recherche sur les lignes restantes si une image ou plusieurs images sont prsentes\n        const matchIm = Array.from(list[0].matchAll(regExpImage))\n        if (matchIm !== null && matchIm.length > 0) {\n          pics.push(...matchIm)\n        }\n      })\n      picsList.push(pics)\n    } else {\n      picsList.push([])\n    }\n  }\n  picsList.forEach((list, index) => {\n    picsNames.push([])\n    if (list.length !== 0) {\n      for (const item of list) {\n        let imgObj\n        if (item[1].match(regExpImageName)) {\n          const imgFile = [...item[1].matchAll(regExpImageName)]\n          if (imgFile[0].groups != null) {\n            imgObj = {\n              name: imgFile[0].groups.name,\n              format: imgFile[0].groups.format,\n            }\n          }\n        } else {\n          imgObj = { name: item[1], format: '' }\n        }\n        if (imgObj != null) {\n          picsNames[index].push(imgObj)\n        }\n      }\n    }\n  })\n  return picsNames\n}\n\n/**\n * Dtecter si le code LaTeX contient des images\n */\nexport function doesLatexNeedsPics(contents: {\n  content: string\n  contentCorr: string\n}) {\n  const exos: ExoContent = {\n    content: contents.content,\n    contentCorr: contents.content,\n  }\n  const imas = getPicsNames([exos])\n  return imas.some((e) => e.length > 0)\n}\n\nexport function makeImageFilesUrls(exercices: IExercice[]) {\n  const exosContentList = getExosContentList(exercices)\n  const picsNames = getPicsNames(exosContentList)\n  return buildImagesUrlsList(exosContentList, picsNames)\n}\n\n/**\n * Pour les exercices Mathalea on a des conventions pour les sauts de ligne qui fonctionnent en HTML comme en LaTeX\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip (si AvecLesDoublesEspaces est vrai). Dans this.consigne, il ne faut pas sinon cela fait planter la sortie LaTeX.\n *  Le \\\\euro mange l'espace qui vient aprs lui, d'o la ncessit d'insrer un espace inscable s'il y en avait un avant le replacement.\n */\nexport function format(\n  text: string,\n  AvecLesDoublesEspaces: boolean = true,\n): string {\n  if (text === undefined) return ''\n  const lang = getLang()\n  let formattedText = AvecLesDoublesEspaces\n    ? text.replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n    : text\n\n  formattedText = formattedText\n    .replace(/(\\d+)\\s*/g, '\\\\ang{$1}')\n    .replace(/<br>/g, '\\\\\\\\')\n    .replace(/( )?( )/g, '\\\\,\\\\euro{}~')\n    .replace(/( )?/g, '\\\\,\\\\euro{}')\n    .replace(/\\\\\\\\\\s*\\n\\n/gm, '\\\\\\\\')\n    .replaceAll('', '\\\\og{}')\n    .replaceAll('', '\\\\fg{}')\n    .replaceAll('', '\\\\oe ')\n    .replaceAll('', '$^\\\\circ$ ')\n\n  // Check if the language is 'fr-CH' and replace \\times with \\cdot if true\n  if (lang === 'fr-CH') {\n    formattedText = formattedText.replace(/\\\\times/g, '\\\\cdot')\n  }\n\n  return formattedText\n}\n\nfunction getUrlFromExercice(ex: IExercice, version: number = 1): string {\n  const url = new URL('https://coopmaths.fr/alea')\n  url.searchParams.append('uuid', String(ex.uuid))\n  if (ex.id !== undefined) url.searchParams.append('id', ex.id)\n  if (ex.nbQuestions !== undefined) {\n    url.searchParams.append('n', ex.nbQuestions.toString())\n  }\n  if (ex.duration !== undefined) {\n    url.searchParams.append('d', ex.duration.toString())\n  }\n  if (ex.sup !== undefined) url.searchParams.append('s', ex.sup)\n  if (ex.sup2 !== undefined) url.searchParams.append('s2', ex.sup2)\n  if (ex.sup3 !== undefined) url.searchParams.append('s3', ex.sup3)\n  if (ex.sup4 !== undefined) url.searchParams.append('s4', ex.sup4)\n  if (ex.sup5 !== undefined) url.searchParams.append('s5', ex.sup5)\n  if (ex.seed !== undefined)\n    url.searchParams.append(\n      'alea',\n      version > 1 ? ex.seed + version.toString : ex.seed,\n    )\n  if (ex.interactif) url.searchParams.append('i', '1')\n  if (ex.correctionDetaillee !== undefined) {\n    url.searchParams.append('cd', ex.correctionDetaillee ? '1' : '0')\n  }\n  if (ex.nbCols !== undefined) {\n    url.searchParams.append('cols', ex.nbCols.toString())\n  }\n  return url.href.replaceAll('%', '\\\\%')\n}\n\nfunction addPackages(latexFileInfos: LatexFileInfos, contents: contentsType) {\n  contents.preamble += genericPreamble\n  loadPreambule(latexFileInfos, contents)\n  contents.preamble += loadFonts(latexFileInfos)\n  return contents.preamble\n}\n\nexport default Latex\n","<script lang=\"ts\">\n  import { onDestroy } from 'svelte'\n  export let blob: Blob | null = null\n\n  let url: string | null = null\n\n  //  chaque fois que le blob change, on rgnre lURL\n  $: if (blob) {\n    if (url) URL.revokeObjectURL(url) // nettoyer ancienne URL\n    url = URL.createObjectURL(blob)\n  }\n\n  // librer quand le composant est dtruit\n  onDestroy(() => {\n    if (url) URL.revokeObjectURL(url)\n  })\n</script>\n\n{#if url}\n  <iframe src={url} class=\"w-full h-full border-0 rounded\" title=\"Aperu du PDF\"\n  ></iframe>\n{:else}\n  <p class=\"text-gray-500\">Aucun PDF charg.</p>\n{/if}\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import { tweened } from 'svelte/motion'\n  import type Latex from '../../../lib/Latex'\n  import {\n    buildImagesUrlsList,\n    doesLatexNeedsPics,\n    getExosContentList,\n    getPicsNames,\n  } from '../../../lib/Latex'\n  import { type LatexFileInfos } from '../../../lib/LatexTypes'\n  import PdFviewer from '../../shared/forms/PDFviewer.svelte'\n\n  const { latex, latexFileInfos, autoStart, pdfViewerDisplay } = $props<{\n    latex: Latex\n    latexFileInfos: LatexFileInfos\n    autoStart: boolean\n    pdfViewerDisplay: boolean\n  }>()\n\n  // Variables locales ractives\n  let pdfBlob: Blob | null = $state(null)\n  let downloadFilename: string | null = $state(null)\n  let pdfUrl: string | null = $state(null)\n  let clockAbled = $state(false)\n  let errorMessage: string | null = $state(null) //  <-- nouvelle variable dtat\n  let errorLog = $state('') //  pour stocker le texte brut du serveur\n\n  const original = 60 // secondes\n  const timer = tweened(original)\n\n  // fabrique un nom de fichier\n  function generateFilename(prefix = 'document', ext = 'pdf') {\n    const now = new Date()\n    const pad = (n: number) => String(n).padStart(2, '0')\n    const date = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}`\n    const time = `${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`\n    return `${prefix}_${date}_${time}.${ext}`\n  }\n\n  function downloadAndExtractPDF(blob: Blob, filename: string) {\n    pdfBlob = blob\n    downloadFilename = filename\n  }\n\n  //  fonction de compilation\n  export async function compileToPDF() {\n    errorMessage = null //  reset erreur  chaque tentative\n    errorLog = '' //  reset log derreur\n    const contents = await latex.getContents(latexFileInfos)\n    if (contents.content === '') {\n      pdfBlob = null\n      downloadFilename = null\n      return\n    }\n    const { latexWithPreamble } = await latex.getFile(latexFileInfos)\n    const picsWanted = doesLatexNeedsPics(contents)\n    const exosContentList = getExosContentList(latex.exercices)\n    const picsNames = getPicsNames(exosContentList)\n    const imagesUrls: string[] = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n\n    const formData = new FormData()\n    formData.append('name', 'document.tex')\n    formData.append('originalname', 'document.tex')\n    formData.append('file', new Blob([latexWithPreamble]), 'document.tex')\n\n    console.log(latexWithPreamble)\n\n    for (let im = 0; im < imagesUrls.length; im++) {\n      const imaUrl = imagesUrls[im].replace(\n        'https://coopmaths.fr',\n        window.location.origin,\n      )\n      const visual = await fetch(imaUrl)\n      const blob = await visual.blob()\n      formData.append('name', imaUrl.split('/').slice(-1)[0])\n      formData.append('originalname', imaUrl.split('/').slice(-1)[0])\n      formData.append('file', blob, imaUrl.split('/').slice(-1)[0])\n    }\n\n    // timer\n    timer.set(original)\n    clockAbled = true\n    const timeValue = setInterval(() => {\n      timer.update((n) => {\n        if (n > 0) return n - 1\n        clearInterval(timeValue)\n        return 0\n      })\n    }, 1000)\n\n    try {\n      const res = await fetch('https://latexcompiler.duckdns.org/generate', {\n        method: 'POST',\n        body: formData,\n        signal: AbortSignal.timeout(60 * 1000),\n      })\n      if (!res.ok) {\n        // Rcupre le contenu derreur (mme en 500)\n        errorLog = await res.text()\n        console.error('Rponse serveur:', res.status, errorLog)\n        throw new Error(`Erreur compilation (${res.status})`)\n      }\n      // if (res.status !== 200) throw new Error('Erreur compilation')\n      const blob = await res.blob()\n      await downloadAndExtractPDF(blob, generateFilename('document', 'pdf'))\n    } catch (err) {\n      console.error('Erreur de compilation:', err)\n      errorMessage = err instanceof Error ? err.message : String(err)\n    } finally {\n      clockAbled = false\n    }\n  }\n\n  $effect(() => {\n    if (pdfBlob === null) {\n      pdfUrl = null\n      return\n    }\n\n    const url = URL.createObjectURL(pdfBlob)\n    pdfUrl = url\n\n    // cleanup garanti :\n    // - avant le prochain effet\n    // -  la destruction du composant\n    return () => {\n      URL.revokeObjectURL(url)\n    }\n  })\n\n  // auto-lancement\n  onMount(() => {\n    if (autoStart) compileToPDF()\n  })\n</script>\n\n<div class=\"flex flex-col h-full\">\n  {#if !autoStart}\n    <!--  Bouton manuel pour lancer la compilation -->\n    <div class=\"m-2 text-center\">\n      <button\n        onclick={compileToPDF}\n        class=\"px-3 py-1 rounded bg-coopmaths-action text-white hover:bg-coopmaths-action-lightest disabled:opacity-50\"\n        disabled={clockAbled}\n      >\n        {#if clockAbled}\n          Compilation en cours...\n        {:else}\n          Compiler en PDF\n        {/if}\n      </button>\n    </div>\n  {/if}\n\n  {#if clockAbled}\n    <div class=\"loader text-center m-2\">\n      <progress value={$timer / original}></progress>\n      {$timer.toFixed(0)}s\n    </div>\n  {/if}\n\n  {#if pdfBlob}\n    {#if downloadFilename}\n      <div class=\"m-2\">\n        <a\n          href={pdfUrl}\n          download={downloadFilename}\n          class=\"px-3 py-1 rounded bg-coopmaths-action text-white hover:bg-coopmaths-action-lightest\"\n        >\n          Tlcharger {downloadFilename}\n        </a>\n      </div>\n    {/if}\n    {#if pdfViewerDisplay}\n      <div class=\"flex-1 overflow-auto m-2\">\n        <PdFviewer blob={pdfBlob} />\n      </div>\n    {/if}\n  {/if}\n\n  {#if !pdfBlob && !clockAbled && !errorMessage}\n    <div\n      class=\"m-2 text-center text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      Aucun PDF gnr\n    </div>\n  {/if}\n\n  <!--  Message derreur -->\n  {#if errorMessage}\n    <div\n      class=\"m-2 p-2 text-center text-red-600 border border-red-400 bg-red-50 rounded\"\n    >\n       Aucun PDF gnr : {errorMessage}\n    </div>\n  {/if}\n\n  {#if errorLog}\n    <div\n      class=\"m-2 p-2 border border-gray-300 bg-gray-100 rounded text-left overflow-auto\"\n    >\n      <pre class=\"text-xs text-gray-800 whitespace-pre-wrap\">\n        {errorLog}\n      </pre>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import type { LatexFileInfos } from '../../../lib/LatexTypes'\n  import type { IExercice } from '../../../lib/types'\n\n  import Latex from '../../../lib/Latex'\n  import { mathaleaGetExercicesFromParams } from '../../../lib/mathalea'\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n  import { context } from '../../../modules/context'\n  import PdfResult from './PdfResult.svelte'\n\n  export let indiceExercice: number\n  export let onClose: () => void\n\n  let dialog: HTMLDialogElement\n\n  /**\n   *\n   */\n  /**\n   * Toutes les variables configurables par l'interface WEB\n   * qui adaptent la sortie PDF\n   */\n  let latexFileInfos: LatexFileInfos = {\n    title: '',\n    reference: '',\n    subtitle: '',\n    style: 'ProfMaquette',\n    fontOption: 'StandardFont',\n    tailleFontOption: 12,\n    dysTailleFontOption: 14,\n    correctionOption: 'AvecCorrection',\n    qrcodeOption: 'SansQrcode',\n    typeFiche: 'Fiche',\n    durationCanOption: '9 min',\n    titleOption: 'SansTitre',\n    nbVersions: 1,\n    exos: {}, // tu peux garder vide par dfaut\n  }\n\n  let exercice: IExercice | undefined\n\n  const latex = new Latex()\n  let ready = false\n\n  onMount(async () => {\n    const exoParam = $exercicesParams[indiceExercice]\n    if (!exoParam) return\n    const exercices = await mathaleaGetExercicesFromParams([exoParam])\n    if (!exercices || exercices.length === 0) return\n    exercice = exercices[0]\n    exercice.seed = exoParam.alea\n    latex.addExercices([exercice])\n    ready = true\n    context.isHtml = false\n    exercice.interactif = false\n    dialog.showModal()\n  })\n\n  function close() {\n    dialog.close()\n    context.isHtml = true\n    onClose()\n  }\n</script>\n\n<dialog bind:this={dialog} class=\"rounded-xl p-6 shadow-xl w-[400px] m-auto\">\n  <!-- Bouton fermer -->\n  <button\n    type=\"button\"\n    aria-label=\"Fermer\"\n    class=\"absolute top-2 right-2 p-1 rounded\n           text-gray-500 hover:text-gray-800\n           dark:text-gray-400 dark:hover:text-gray-200\"\n    on:click={close}\n  >\n    <i class=\"bx bx-x text-2xl\"></i>\n  </button>\n\n  <h2 class=\"text-lg font-semibold mb-4\">Gnrer le PDF</h2>\n\n  <div class=\"flex justify-center\">\n    {#if ready}\n      <PdfResult\n        {latex}\n        {latexFileInfos}\n        autoStart={true}\n        pdfViewerDisplay={false}\n      />\n    {:else}\n      <div class=\"py-6 text-sm text-gray-500\"></div>\n    {/if}\n  </div>\n</dialog>\n","<script lang=\"ts\">\n  import {\n    exercicesParams,\n    moveExercice,\n    isReordering,\n  } from '../../../../../lib/stores/generalStore'\n  export let indice: number\n  export let indiceLastExercice: number\n  function descendre() {\n    isReordering.set(true)\n    exercicesParams.update((l) => {\n      return moveExercice(l, indice, indice + 1)\n    })\n    setTimeout(() => isReordering.set(false), 300)\n  }\n</script>\n\n<button\n  on:click={descendre}\n  aria-label=\"Descendre l'exercice\"\n  class={indice === indiceLastExercice ? 'hidden md:invisible' : ''}\n>\n  <i\n    class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-down-arrow-circle\"\n  ></i>\n</button>\n","<script lang=\"ts\">\n  import {\n    exercicesParams,\n    moveExercice,\n    isReordering,\n  } from '../../../../../lib/stores/generalStore'\n  export let indice: number\n  function monter() {\n    isReordering.set(true)\n    exercicesParams.update((l) => {\n      return moveExercice(l, indice, indice - 1)\n    })\n    setTimeout(() => isReordering.set(false), 300)\n  }\n</script>\n\n<button on:click={monter} aria-label=\"Monter l'exercice\" class={indice === 0 ? 'hidden md:invisible' : ''}>\n  <i\n    class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-up-arrow-circle\"\n  ></i>\n</button>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import refProfs from '../../../../../json/referentielProfs.json'\n  import uuidsRessources from '../../../../../json/uuidsRessources.json'\n  import { toMap } from '../../../../../lib/components/toMap'\n  import { mathaleaGenerateSeed } from '../../../../../lib/mathalea'\n  import { exercicesParams } from '../../../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../../../lib/stores/globalOptions'\n  import PdfDialog from '../../../../setup/latex/PdfDialog.svelte'\n  import InteractivityIcon from '../../../icons/TwoStatesIcon.svelte'\n  import BoutonDescendre from './BoutonDescendre.svelte'\n  import BoutonMonter from './BoutonMonter.svelte'\n\n  // paramtres obligatoires\n  export let title: string | undefined\n  export let id: string\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n  export let interactifReady: boolean\n  // paramtres optionnels\n  export let randomReady = true\n  export let settingsReady = true\n  export let correctionReady = true\n  export let correctionExists = true\n  export let isInteractif: boolean = false\n  export let isSortable: boolean = true\n  export let isDeletable: boolean = true\n  export let isHidable: boolean = true\n  let isVisible = true\n  export let isSettingsVisible = true\n  const isContentVisible = true\n  let isCorrectionVisible = false\n  let showPdfDialog = false\n  // redfinition du titre lorsqu'un exercice apparait plusieurs fois :\n  // si le titre contient le caractre | (ajout lors de la cration de l'exercice)\n  // on coupe le titre en deux et on distingue le titre de base de l'addendum\n  // afin de pouvoir dcorer cet addendum\n  let titleAddendum: string\n  let titleBase: string\n  $: {\n    if (title?.includes('|')) {\n      const decompo = title.split('|')\n      titleBase = decompo[0]\n      titleAddendum = decompo[1]\n    } else {\n      titleBase = title || ''\n      titleAddendum = ''\n    }\n  }\n  // ttablissement de la catgorie\n  const ressourcesUuids = Object.keys({ ...uuidsRessources })\n  const profsUuids = Array.from(toMap({ ...refProfs }).values()).map((e) =>\n    e.get('uuid'),\n  )\n  let category: string\n  if (ressourcesUuids.includes($exercicesParams[indiceExercice]?.uuid)) {\n    category = 'Ressource'\n  } else if (profsUuids.includes($exercicesParams[indiceExercice]?.uuid)) {\n    category = 'Outil'\n  } else {\n    category = 'Exercice'\n  }\n  const dispatch = createEventDispatcher()\n\n  function switchInteractif() {\n    isInteractif = !isInteractif\n    dispatch('clickInteractif', { isInteractif })\n  }\n\n  function newData() {\n    dispatch('clickNewData')\n  }\n\n  function remove() {\n    exercicesParams.update((l) => [\n      ...l.slice(0, indiceExercice),\n      ...l.slice(indiceExercice + 1),\n    ])\n    dispatch('exerciseRemoved')\n  }\n\n  function duplicate() {\n    exercicesParams.update((l) => {\n      const newExercice = { ...l[indiceExercice] }\n      newExercice.alea = mathaleaGenerateSeed()\n      return [\n        ...l.slice(0, indiceExercice + 1),\n        newExercice,\n        ...l.slice(indiceExercice + 1),\n      ]\n    })\n  }\n</script>\n\n<!--\n  @component\n  Barre de titre et d'actions au-dessus d'un exercice\n\n  __Utilisation__ :\n\n  ```tsx\n  const headerExerciceProps: HeaderProps = {\n    title: exercice.titre,\n    indiceExercice: 2,\n    indiceLastExercice: 4,\n    interactifReady: true,\n    randomReady: true,\n    settingsReady: true,\n    correctionReady: true\n  }\n  <HeaderExerciceVueProf {...headerExerciceProps}/>\n  ```\n -->\n\n<div class=\"z-0 flex-1\">\n  <h1\n    class=\"border-b border-coopmaths-struct dark:border-coopmathsdark-struct text-coopmaths-struct dark:text-coopmathsdark-struct pl-0 mt-4 flex flex-col lg:flex-row justify-start lg:justify-between items-start xl:items-baseline\"\n  >\n    <div\n      class=\"flex flex-col xl:flex-row xl:justify-start xl:items-center\"\n      id=\"exercice{indiceExercice}\"\n    >\n      <div\n        class=\"flex flex-row items-center whitespace-pre font-bold text-sm md:text-base lg:text-xl pb-1 lg:pb-0\"\n      >\n        <div\n          class=\"{$exercicesParams.length <= 1\n            ? 'hidden'\n            : 'flex'} items-center justify-center h-4 lg:h-8 w-4 lg:w-6 bg-coopmaths-struct dark:bg-coopmathsdark-struct text-coopmaths-canvas dark:text-coopmathsdark-canvas font-light text-xs lg:text-lg mr-2 lg:mr-4\"\n        >\n          {indiceExercice + 1}\n        </div>\n        {category}&#8239\n        {#if id && id.length !== 0}\n          {id}<span class=\"hidden xl:inline-flex xl:mx-1 font-bold\"\n            >&middot;</span\n          >\n        {/if}\n      </div>\n      {#key titleAddendum}\n        <div\n          id=\"exotitle-{indiceExercice}\"\n          class=\"flex items-center gap-x-1 text-sm md:text-base xl:text-lg pl-0\n        {id && id.length !== 0 ? 'lg:pl-0' : 'lg:pl-4'}\"\n        >\n          <div>\n            {titleBase}\n          </div>\n          {#if titleAddendum}\n            <span\n              class=\"ml-2 flex justify-center items-center shrink-0 rounded-full h-5 w-5 bg-coopmaths-warn-900 text-coopmaths-canvas font-bold text-sm\"\n            >\n              {titleAddendum}\n            </span>\n          {/if}\n        </div>\n      {/key}\n    </div>\n    <div\n      class=\"print-hidden flex flex-col md:flex-row justify-start space-x-2 md:space-x-10 text-normal mt-1 text-xl lg:justify-end mr-1\"\n    >\n      <div class=\"flex flex-row justify-start items-center\">\n        <!-- <button\n          class=\"mx-2 tooltip tooltip-left\"\n          data-tip={isMessagesVisible ? \"Masquer les messages\" : \"Montrer les messages\"}\n          type=\"button\"\n          on:click={() => {\n            isMessagesVisible = !isMessagesVisible\n            dispatch(\"clickMessages\", { isMessagesVisible })\n          }}\n        >\n          <i class=\"bx {isMessagesVisible ? 'bxs-bulb' : 'bx-bulb'}\" />\n        </button> -->\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral {correctionExists &&\n          correctionReady\n            ? ''\n            : 'hidden'}\"\n          data-tip={isCorrectionVisible\n            ? 'Masquer la correction'\n            : 'Montrer la correction'}\n          type=\"button\"\n          aria-label=\"Afficher / Masquer la correction\"\n          on:click={() => {\n            isCorrectionVisible = !isCorrectionVisible\n            dispatch('clickCorrection', {\n              isCorrectionVisible,\n              isContentVisible,\n            })\n          }}\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx {isCorrectionVisible\n              ? 'bxs-check-circle'\n              : 'bx-check-circle'}\"\n          ></i>\n        </button>\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral {$globalOptions.isInteractiveFree &&\n          interactifReady\n            ? ''\n            : 'hidden'}\"\n          data-tip={isInteractif\n            ? \"Dsactiver l'interactivit\"\n            : 'Rendre interactif'}\n          type=\"button\"\n          on:click={switchInteractif}\n        >\n          <InteractivityIcon isOnStateActive={isInteractif} />\n        </button>\n        <button\n          class=\"mx-2 tooltip tooltip-left\"\n          data-tip=\"Nouvel nonc\"\n          type=\"button\"\n          aria-label=\"Nouvel nonc\"\n          on:click={newData}\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-refresh {randomReady\n              ? ''\n              : 'hidden'}\"\n          ></i>\n        </button>\n        {#if isHidable}\n          <button\n            type=\"button\"\n            on:click={() => {\n              isVisible = !isVisible\n              dispatch('clickVisible', { isVisible })\n            }}\n            class=\"mx-2 tooltip tooltip-left\"\n            data-tip=\" {isVisible ? 'Masquer' : 'Montrer'} l'exercice\"\n            aria-label=\"Masquer / Montrer l'exercice\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx {isVisible\n                ? 'bx-hide'\n                : 'bx-show'}\"\n            ></i>\n          </button>\n        {/if}\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n          data-tip=\"Dupliquer l'exercice\"\n          type=\"button\"\n          aria-label=\"Dupliquer l'exercice\"\n          on:click={duplicate}\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-duplicate\"\n          ></i>\n        </button>\n        {#if isDeletable}\n          <button\n            class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n            data-tip=\"Supprimer l'exercice\"\n            type=\"button\"\n            aria-label=\"Supprimer\"\n            on:click={remove}\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-trash\"\n            ></i>\n          </button>\n        {/if}\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral {settingsReady\n            ? ''\n            : 'hidden'} \"\n          data-tip=\"Changer les paramtres de l'exercice\"\n          aria-label=\"Paramtres de l'exercice\"\n          type=\"button\"\n          on:click={() => {\n            isSettingsVisible = !isSettingsVisible\n            dispatch('clickSettings', { isSettingsVisible })\n          }}\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-slider\"\n          ></i>\n        </button>\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n          data-tip=\"Fichier PDF\"\n          aria-label=\"pdf\"\n          type=\"button\"\n          on:click={() => (showPdfDialog = true)}\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bxs-file-pdf\"\n          ></i>\n        </button>\n        {#if showPdfDialog}\n          <PdfDialog {indiceExercice} onClose={() => (showPdfDialog = false)} />\n        {/if}\n      </div>\n      <div\n        class=\"flex flex-row justify-start items-center space-x-4 md:space-x-1\"\n      >\n        {#if isSortable}\n          <BoutonMonter indice={indiceExercice} />\n          <BoutonDescendre indice={indiceExercice} {indiceLastExercice} />\n        {/if}\n      </div>\n    </div>\n  </h1>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  export let id: string\n  export let isChecked: boolean\n  export let isDisabled: boolean = false\n  export let label: string = ''\n  export let size: 'sm' | 'md' = 'md'\n  export let darkBackground: boolean = false\n\n  const dispatch = createEventDispatcher()\n\n  $: sizeClass = size === 'sm' ? 'w-3 h-3' : 'w-4 h-4'\n  $: fontSize = size === 'sm' ? 'text-xs' : 'text-sm'\n</script>\n\n<div\n  class=\"flex flex-row justify-start items-center p-1\n  {isDisabled ? 'opacity-30' : ''}\"\n>\n  <input\n    {id}\n    aria-describedby={id}\n    type=\"checkbox\"\n    class=\"{sizeClass} rounded\n      {darkBackground\n      ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n      : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n      {isDisabled\n      ? 'border-coopmaths-action/20 dark:border-coopmathsdark-action/20'\n      : 'border-coopmaths-action dark:border-coopmathsdark-action cursor-pointer'}\n      checked:bg-coopmaths-action dark:checked:bg-coopmathsdark-action\n      focus:ring-3\n      focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action\"\n    bind:checked={isChecked}\n    on:change={() => dispatch('change', isChecked)}\n    disabled={isDisabled}\n  />\n  {#if label}\n    <label\n      for={id}\n      class=\"ml-3 {fontSize} font-light\n        {isDisabled ? '' : 'cursor-pointer'}\"\n    >\n      {label}\n    </label>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  export let id: string\n  export let min: number = 1\n  export let max: number = 100\n  export let value: number | undefined | null = undefined\n  export let isDisabled: boolean = false\n  export let darkBackground: boolean = false\n  export let step: number = 1\n\n  const dispatch = createEventDispatcher()\n\n  // Display value: empty string when undefined/null, otherwise the number\n  $: displayValue = value === undefined || value === null ? '' : value\n\n  function handleInput(e: Event) {\n    const target = e.target as HTMLInputElement\n    const rawValue = target.value\n\n    if (rawValue === '') {\n      console.log(value)\n      value = undefined\n      dispatch('change', undefined)\n    } else {\n      let numValue = Number(rawValue)\n      // Clamp to min/max\n      if (numValue < min) numValue = min\n      if (numValue > max) numValue = max\n      value = numValue\n      dispatch('change', value)\n    }\n  }\n\n  function decrement() {\n    if (value === undefined || value === null) {\n      // If empty, set to max value when decrementing\n      value = max\n    } else if (value - step >= min) {\n      value = value - step\n    }\n    dispatch('change', value)\n  }\n\n  function increment() {\n    if (value === undefined || value === null) {\n      // If empty, set to min value when incrementing\n      value = min\n    } else if (value + step <= max) {\n      value = value + step\n    }\n    dispatch('change', value)\n  }\n</script>\n\n<span class=\"inline-flex items-center w-full\">\n  <input\n    type=\"number\"\n    {id}\n    {min}\n    {max}\n    {step}\n    value={displayValue}\n    on:input={handleInput}\n    class=\"{$$props.class} w-full h-10 pr-0\n      {darkBackground\n      ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n      : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n      text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark\n      border border-r-0\n      border-coopmaths-action dark:border-coopmathsdark-action\n      focus:outline-0 focus:ring-0\n      focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest\n      disabled:opacity-30\"\n    disabled={isDisabled}\n  />\n  <span class=\"inline-flex flex-col\">\n    <button\n      type=\"button\"\n      class=\"w-6 h-5 flex items-center justify-center\n      {darkBackground\n        ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n        : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n        border border-b-0\n        border-coopmaths-action dark:border-coopmathsdark-action\n        text-coopmaths-action dark:text-coopmathsdark-action\n        hover:bg-coopmaths-action hover:text-coopmaths-canvas\n        dark:hover:bg-coopmathsdark-action dark:hover:text-coopmathsdark-canvas\n        disabled:opacity-30 text-sm\"\n      disabled={isDisabled ||\n        (value !== undefined && value !== null && value >= max)}\n      on:click={increment}\n      aria-label=\"Augmenter\"\n    >\n      <i class=\"bx bx-chevron-up\"></i>\n    </button>\n    <button\n      type=\"button\"\n      class=\"w-6 h-5 flex items-center justify-center\n      {darkBackground\n        ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n        : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n        border\n        border-coopmaths-action dark:border-coopmathsdark-action\n        text-coopmaths-action dark:text-coopmathsdark-action\n        hover:bg-coopmaths-action hover:text-coopmaths-canvas\n        dark:hover:bg-coopmathsdark-action dark:hover:text-coopmathsdark-canvas\n        disabled:opacity-30 text-sm\"\n      disabled={isDisabled ||\n        (value !== undefined && value !== null && value <= min)}\n      on:click={decrement}\n      aria-label=\"Diminuer\"\n    >\n      <i class=\"bx bx-chevron-down\"></i>\n    </button>\n  </span>\n</span>\n\n<style>\n  /* Cacher les flches natives */\n  input[type='number']::-webkit-inner-spin-button,\n  input[type='number']::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    display: none;\n  }\n  input[type='number'] {\n    appearance: textfield;\n    -moz-appearance: textfield;\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { mathaleaGenerateSeed } from '../../../lib/mathalea'\n\n  export let title: string = ''\n  export let placeholder: string = ''\n  export let showTitle: boolean = true\n  export let value: string | number = ''\n  export let isDisabled: boolean = false\n  export let inputID: string = mathaleaGenerateSeed()\n  export let classAddenda: string = ''\n  export let darkBackground: boolean = false\n  export let autocomplete: 'on' | 'off' = 'off'\n  export let autocorrect: 'on' | 'off' = 'off'\n  export let autocapitalize:\n    | 'none'\n    | 'off'\n    | 'on'\n    | 'characters'\n    | 'sentences'\n    | 'words' = 'off'\n  export let spellcheck: boolean = false\n\n  const dispatch = createEventDispatcher()\n\n  function handleInput(event: Event) {\n    dispatch('input', event)\n  }\n\n  function handleChange(event: Event) {\n    dispatch('change', event)\n  }\n</script>\n\n<!--\n  @component\n  Champ de saisie de texte\n\n  ### Paramtres\n\n  * `title` : titre du champ de texte (situ au dessus du champ de saisie)\n  * `placeholder` : texte de'invite pour le champ\n  * `showTitle` : flag permettant de dcider de l'affichage du titre au dessus du champ ou pas\n  * `value` : valeur du champ\n  * `isDisabled` : flag permettant de dsactiver le champ\n  * `inputID` : ID du champ\n  * `classAddenda` : lments de style  ajouter  ceux dj prsents ( voir [Tailwindd CSS](https://tailwindcss.com/docs/installation))\n\n  ### Exemple\n\n  ```tsx\n  <InputText\n    title=\"Importer les exercices d'une feuille lve\"\n    placeholder=\"Lien\"\n    bind:value={urlFeuilleEleve}\n    classAddenda=\"w-50\"\n  />\n  ```\n\n -->\n\n<div class=\"w-full\">\n  <label\n    class=\"font-light text-sm pr-4\n      {showTitle ? 'block' : 'hidden'}\n      {isDisabled\n      ? 'text-coopmaths-struct/10 dark:text-coopmathsdark-struct/10'\n      : 'text-coopmaths-struct dark:text-coopmathsdark-struct'}\"\n    for={inputID}\n  >\n    {title}\n  </label>\n  <input\n    type=\"text\"\n    id={inputID}\n    name={inputID}\n    disabled={isDisabled}\n    bind:value\n    {placeholder}\n    {autocomplete}\n    {autocorrect}\n    {autocapitalize}\n    spellcheck={spellcheck ? 'true' : 'false'}\n    on:input={handleInput}\n    on:change={handleChange}\n    class=\"block w-full text-sm border h-10 pr-0\n      border-coopmaths-action dark:border-coopmathsdark-action\n      focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest\n      focus:outline-0 focus:ring-0 focus:border\n      {darkBackground\n      ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark'\n      : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light'}\n      disabled:opacity-20\n      {classAddenda}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n\n  export let id: string\n  export let value: string | number = ''\n  export let options: Array<{\n    label: string\n    value: string | number\n    isDisabled?: boolean\n  }> = []\n  export let isDisabled: boolean = false\n  export let name: string = ''\n  export let darkBackground: boolean = false\n  export let classAddenda: string = ''\n\n  const dispatch = createEventDispatcher()\n\n  function handleChange() {\n    dispatch('change', value)\n  }\n</script>\n\n<!--\n  @component\n  Formulaire de slection unique\n\n  ### Action :\n  `change` est dispatch lorsque la valeur slectionne change\n\n  ### Paramtres :\n  * `id` : identifiant unique du select\n  * `value` : valeur slectionne\n  * `options` : tableau des options avec label et value\n  * `isDisabled` : dsactive le select\n  * `name` : nom du champ pour les formulaires\n  * `darkBackground` : variante avec fond sombre\n  * `classAddenda` : classes CSS additionnelles\n-->\n\n<select\n  {id}\n  {name}\n  bind:value\n  on:change={handleChange}\n  disabled={isDisabled}\n  class=\"w-full px-2 py-1 h-10\n    {darkBackground\n    ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n    : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n    text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark\n    border\n    border-coopmaths-action dark:border-coopmathsdark-action\n    focus:outline-0 focus:ring-0\n    focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest\n    disabled:opacity-30\n    {classAddenda}\"\n>\n  {#each options as option}\n    <option\n      value={option.value}\n      disabled={option.isDisabled}\n      class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n    >\n      {option.label}\n    </option>\n  {/each}\n</select>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import type { IExercice } from '../../../../../../lib/types'\n  import CheckboxWithLabel from '../../../../forms/CheckboxWithLabel.svelte'\n  import InputNumber from '../../../../forms/InputNumber.svelte'\n  import InputText from '../../../../forms/InputText.svelte'\n  import SelectUnique from '../../../../forms/SelectUnique.svelte'\n\n  export let supIndex: 1 | 2 | 3 | 4 | 5\n  export let exercice: IExercice\n  export let exerciceIndex: number\n  export let supValue: any\n  export let formNum: { titre: string; champs: string[] | number } | undefined =\n    undefined\n\n  const dispatch = createEventDispatcher()\n\n  $: suffix = supIndex === 1 ? '' : supIndex.toString()\n\n  $: caseACocher =\n    exercice[`besoinFormulaire${suffix}CaseACocher` as keyof IExercice]\n  $: texte = exercice[`besoinFormulaire${suffix}Texte` as keyof IExercice]\n\n  $: formNumOptions = Array.isArray(formNum?.champs)\n    ? formNum.champs.map((entree, i) => ({ label: entree, value: i + 1 }))\n    : []\n\n  function handleChange() {\n    dispatch('change')\n  }\n</script>\n\n{#if caseACocher}\n  <CheckboxWithLabel\n    id=\"settings-check{supIndex}-{exerciceIndex}\"\n    bind:isChecked={supValue}\n    label={typeof caseACocher !== 'boolean' ? caseACocher[0] : ''}\n    on:change={handleChange}\n    darkBackground={true}\n  />\n{/if}\n\n{#if formNum}\n  {#if Array.isArray(formNum.champs)}\n    <div class=\"flex flex-col\">\n      <form\n        id=\"settings-form-formNum{supIndex}-{exerciceIndex}\"\n        action=\"\"\n        autocomplete=\"off\"\n      >\n        <label\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          for=\"settings-formNum{supIndex}-{exerciceIndex}\"\n          >{formNum.titre} :</label\n        >\n        <SelectUnique\n          id=\"settings-formNum{supIndex}-{exerciceIndex}\"\n          name=\"formNum{supIndex}\"\n          bind:value={supValue}\n          options={formNumOptions}\n          on:change={handleChange}\n          darkBackground={true}\n          classAddenda=\"flex flex-auto border-1 focus:border-1\"\n        />\n      </form>\n    </div>\n  {:else}\n    <div>\n      <label\n        class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n        for=\"settings-formNum{supIndex}-{exerciceIndex}\"\n        >{formNum.titre} :\n      </label>\n      <InputNumber\n        id=\"settings-formNum{supIndex}-{exerciceIndex}\"\n        min={1}\n        max={formNum.champs}\n        bind:value={supValue}\n        on:change={handleChange}\n        darkBackground={true}\n      />\n    </div>\n  {/if}\n{/if}\n\n{#if texte}\n  <form\n    id=\"settings-form-formText{supIndex}-{exerciceIndex}\"\n    name=\"settings-form-formText{supIndex}\"\n    autocomplete=\"off\"\n    on:submit|preventDefault={handleChange}\n  >\n    {#if typeof texte !== 'boolean'}\n      <div\n        class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n      >\n        <div>{texte[0]} :</div>\n        <div\n          class=\"w-full pl-4 pb-2 whitespace-pre-wrap text-[80%] text-coopmaths-struct-light leading-tight\"\n        >\n          {texte[1]}\n        </div>\n      </div>\n      <InputText\n        inputID=\"settings-formText{supIndex}-{exerciceIndex}\"\n        bind:value={supValue}\n        showTitle={false}\n        darkBackground={true}\n        classAddenda=\"w-full\"\n        on:input={handleChange}\n      />\n    {/if}\n  </form>\n{/if}\n","<script lang=\"ts\">\n  import { createEventDispatcher, onMount } from 'svelte'\n  import ExerciceSimple from '../../../../../../exercices/ExerciceSimple'\n  import type { IExercice } from '../../../../../../lib/types'\n  import CheckboxWithLabel from '../../../../forms/CheckboxWithLabel.svelte'\n  import InputNumber from '../../../../forms/InputNumber.svelte'\n  import InputText from '../../../../forms/InputText.svelte'\n  import SupParameterGroup from './SupParameterGroup.svelte'\n\n  export let exercice: IExercice\n  export let exerciceIndex: number\n  export let isVisible: boolean = true\n\n  const dispatch = createEventDispatcher()\n\n  type FormNumerique = {\n    titre: string\n    champs: string[] | number\n  }\n\n  let nbQuestions: number\n  let duration: number\n  let sup: boolean\n  let sup2: boolean\n  let sup3: boolean\n  let sup4: boolean\n  let sup5: boolean\n  let versionQcm: boolean\n  let alea: string\n  let correctionDetaillee: boolean\n\n  let isCommentDisplayed: boolean = false\n\n  let formNum1: FormNumerique\n  let formNum2: FormNumerique\n  let formNum3: FormNumerique\n  let formNum4: FormNumerique\n  let formNum5: FormNumerique\n\n  let previousSeed: string | undefined\n  $: {\n    // Pour que la srie dans le formulaire se mette  jour lorsqu'on clique sur \"Nouvel nonc\"\n    if (previousSeed !== exercice.seed) {\n      // Sans a, on ne peut pas modifier la srie dans le formulaire\n      previousSeed = exercice.seed\n      alea = exercice.seed ?? ''\n    }\n  }\n\n  onMount(() => {\n    nbQuestions = exercice.nbQuestions\n    duration = exercice.duration || 10\n    sup = exercice.sup === 'false' ? false : exercice.sup\n    sup2 = exercice.sup2 === 'false' ? false : exercice.sup2\n    sup3 = exercice.sup3 === 'false' ? false : exercice.sup3\n    sup4 = exercice.sup4 === 'false' ? false : exercice.sup4\n    sup5 = exercice.sup5 === 'false' ? false : exercice.sup5\n    versionQcm =\n      exercice instanceof ExerciceSimple ? exercice.versionQcm || false : false\n    correctionDetaillee = exercice.correctionDetaillee\n\n    if (\n      Array.isArray(exercice.besoinFormulaireNumerique) &&\n      exercice.besoinFormulaireNumerique.length > 0\n    ) {\n      formNum1 = parseFormNumerique(exercice.besoinFormulaireNumerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire2Numerique) &&\n      exercice.besoinFormulaire2Numerique.length > 0\n    ) {\n      formNum2 = parseFormNumerique(exercice.besoinFormulaire2Numerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire3Numerique) &&\n      exercice.besoinFormulaire3Numerique.length > 0\n    ) {\n      formNum3 = parseFormNumerique(exercice.besoinFormulaire3Numerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire4Numerique) &&\n      exercice.besoinFormulaire4Numerique.length > 0\n    ) {\n      formNum4 = parseFormNumerique(exercice.besoinFormulaire4Numerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire5Numerique) &&\n      exercice.besoinFormulaire5Numerique.length > 0\n    ) {\n      formNum5 = parseFormNumerique(exercice.besoinFormulaire5Numerique)\n    }\n  })\n\n  /**\n   * Transforme le tableau des tooltips d'un paramtre type numrique en un objet\n   * constitu d'un titre (celui du paramtre) et soit d'un tableau\n   * des options, soit d'un nombre correspond  la valeur maximale.\n   * <i>Rfrence :</i> commentaire du fichier Exercice.ts sur la proprit\n   * <code>besoinFormulaireNumerique</code> (<code>false</code>\n   * sinon this.besoinFormulaireNumerique = [texte, max, tooltip facultatif])\n   * @param {string[]} entreesFormulaire Typiquement la valeur de la proprit\n   * <code>besoinFormulaireNumerique</code>\n   * @author sylvain chambon\n   */\n  function parseFormNumerique(\n    entreesFormulaire:\n      | [titre: string, max: number, tooltip: string]\n      | [titre: string, max: number],\n  ): FormNumerique {\n    const entrees:\n      | [titre: string, max: number, tooltip: string]\n      | [titre: string, max: number] = [...entreesFormulaire]\n    if (![2, 3].includes(entrees.length)) {\n      // `besoinFormulaireNumerique` est de la forme [texte, max, tooltip] ou [texte, max]\n      throw new Error(\n        `Dans ${exercice.uuid}, besoinFormulaireNumerique est mal dclar`,\n      )\n    } else {\n      // la liste entrees a deux ou trois lments\n      const premier = entrees.shift()\n      const titre: string = (premier as string) ?? '' // le titre du paramtre est le 1er elt\n      let champs: string[] | number\n      if (entrees.length > 1) {\n        // il y a une liste de tooltips qui deviendront les entres\n        const dernier = entrees.pop() as string\n        if (dernier) {\n          champs = dernier\n            .split('\\n')\n            .map((x) => x.replace(/(?:\\d* *: *)/i, ''))\n        } else {\n          champs = []\n        }\n      } else {\n        // les champs se rsument  un seul nombre correspondant au maximum\n        const max = entrees[0]\n        champs = typeof max === 'number' ? max : parseInt(max)\n      }\n      return { titre, champs }\n    }\n  }\n\n  function dispatchNewSettings() {\n    dispatch('settings', {\n      nbQuestions,\n      duration,\n      sup,\n      sup2,\n      sup3,\n      sup4,\n      sup5,\n      versionQcm,\n      alea,\n      correctionDetaillee,\n    })\n  }\n</script>\n\n<div\n  id=\"settings{exerciceIndex}\"\n  class=\"relative text-coopmaths-struct dark:text-coopmathsdark-struct bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark z-20 {isVisible\n    ? 'visible lg:w-1/4'\n    : 'hidden lg:w-0'} flex flex-col duration-500\"\n>\n  <div class=\"absolute top-2 right-3\">\n    <button\n      type=\"button\"\n      aria-label=\"Fermer les paramtres\"\n      on:click={() => {\n        isVisible = !isVisible\n        dispatch('clickSettings', { isVisible })\n      }}\n    >\n      <i\n        class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n      ></i>\n    </button>\n  </div>\n  <div\n    class=\"text-lg lg:text-base ml-2 lg:ml-4 space-y-4 p-3 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <h3 class=\"text-coopmaths-struct dark:text-coopmathsdark-struct font-bold\">\n      Paramtres\n    </h3>\n    <div class=\"w-full flex flex-row items-end gap-x-4\">\n      <div class=\"w-1/2\">\n        {#if exercice.nbQuestionsModifiable}\n          <span\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          >\n            Nombre de questions&nbsp;:\n          </span>\n          <InputNumber\n            id=\"settings-nb-questions-{exerciceIndex}\"\n            min={1}\n            max={100}\n            bind:value={nbQuestions}\n            on:change={dispatchNewSettings}\n            darkBackground={true}\n          />\n        {/if}\n      </div>\n\n      <form\n        id=\"settings-form-formAlea-{exerciceIndex}\"\n        name=\"settings-form-formAlea\"\n        autocomplete=\"off\"\n        class=\"w-1/2\"\n        on:submit|preventDefault={dispatchNewSettings}\n      >\n        <InputText\n          inputID=\"settings-formAlea-{exerciceIndex}\"\n          title=\"Srie :\"\n          bind:value={alea}\n          darkBackground={true}\n          classAddenda=\"w-full\"\n          on:input={dispatchNewSettings}\n        />\n      </form>\n    </div>\n    <SupParameterGroup\n      supIndex={1}\n      {exercice}\n      {exerciceIndex}\n      bind:supValue={sup}\n      formNum={formNum1}\n      on:change={dispatchNewSettings}\n    />\n\n    <SupParameterGroup\n      supIndex={2}\n      {exercice}\n      {exerciceIndex}\n      bind:supValue={sup2}\n      formNum={formNum2}\n      on:change={dispatchNewSettings}\n    />\n\n    <SupParameterGroup\n      supIndex={3}\n      {exercice}\n      {exerciceIndex}\n      bind:supValue={sup3}\n      formNum={formNum3}\n      on:change={dispatchNewSettings}\n    />\n\n    <SupParameterGroup\n      supIndex={4}\n      {exercice}\n      {exerciceIndex}\n      bind:supValue={sup4}\n      formNum={formNum4}\n      on:change={dispatchNewSettings}\n    />\n\n    <SupParameterGroup\n      supIndex={5}\n      {exercice}\n      {exerciceIndex}\n      bind:supValue={sup5}\n      formNum={formNum5}\n      on:change={dispatchNewSettings}\n    />\n\n    {#if exercice.correctionDetailleeDisponible}\n      <CheckboxWithLabel\n        id=\"settings-correction-detaillee-{exerciceIndex}\"\n        bind:isChecked={correctionDetaillee}\n        label=\"Correction dtaille\"\n        on:change={dispatchNewSettings}\n      />\n    {/if}\n\n    {#if exercice instanceof ExerciceSimple && exercice.versionQcmDisponible}\n      <CheckboxWithLabel\n        id=\"settings-version-qcm-{exerciceIndex}\"\n        bind:isChecked={versionQcm}\n        label=\"Version QCM\"\n        on:change={dispatchNewSettings}\n      />\n    {/if}\n\n    {#if exercice.comment !== undefined}\n      <div class=\"flex flex-col justify-start items-start p-2\">\n        <button\n          type=\"button\"\n          class=\"flex items-center text-coopmaths-action dark:text-coopmathsdark-action cursor-pointer\"\n          on:click={() => {\n            isCommentDisplayed = !isCommentDisplayed\n          }}\n          on:keydown={() => {\n            isCommentDisplayed = !isCommentDisplayed\n          }}\n        >\n          <i class=\"bx bx-info-circle mr-2\"></i>En savoir plus...\n        </button>\n        <div\n          class=\"{isCommentDisplayed\n            ? 'block'\n            : 'hidden'} pt-4 font-light text-justify text-coopmaths-corpus-light text-sm\"\n        >\n          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n          {@html exercice.comment}\n        </div>\n      </div>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { afterUpdate, beforeUpdate, onDestroy, onMount, tick } from 'svelte'\n  import { get } from 'svelte/store'\n  import ExerciceSimple from '../../../../../exercices/ExerciceSimple'\n  import {\n    exercisesUuidRanking,\n    uuidCount,\n  } from '../../../../../lib/components/counts'\n  import {\n    exerciceInteractif,\n    prepareExerciceCliqueFigure,\n  } from '../../../../../lib/interactif/gestionInteractif'\n  import {\n    mathaleaFormatExercice,\n    mathaleaHandleExerciceSimple,\n    mathaleaHandleSup,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n    renderDiv,\n  } from '../../../../../lib/mathalea'\n  import {\n    changes,\n    exercicesParams,\n    resultsByExercice,\n  } from '../../../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../../../lib/stores/globalOptions'\n  import { isLocalStorageAvailable } from '../../../../../lib/stores/storage'\n  import type {\n    IExercice,\n    IExerciceSimple,\n    InterfaceParams,\n  } from '../../../../../lib/types'\n  import type { HeaderProps } from '../../../../../lib/types/ui'\n  import { loadMathLive } from '../../../../../modules/loaders'\n  import { countMathField } from '../../countMathField'\n  import { handleCorrectionAffichee } from '../../handleCorrection'\n  import HeaderExerciceVueProf from '../../shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte'\n  import Settings from './presentationalComponents/Settings.svelte'\n\n  export let exercise: IExercice | IExerciceSimple\n  export let exerciseIndex: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible = false\n  export let toggleSidenav: (open: boolean) => void\n\n  let divExercice: HTMLDivElement\n  let divScore: HTMLDivElement\n  let buttonScore: HTMLButtonElement\n  /*\n   * MGu Attention interfaceParams est un objet qui est une copie du store,\n   * donc le mettre  jour directement met  jour le store sans le signaler au subscriber\n   * DE PLUS, si on change l'ordre des exercices OU si on supprime un exercice, exerciseIndex\n   * va devenir faux mais cela n'est pas gnant car l'exercice va tre destroy...\n   * Cependant, avant un DESTROY, il y aura un beforeupdate et un afterupdate, donc cette variable\n   * peut devenir UNDEFINED ou ERRONEE\n   */\n  let interfaceParams: InterfaceParams | undefined =\n    get(exercicesParams)[exerciseIndex]\n  let exercicesNumber: number = get(exercicesParams).length\n\n  let id: string =\n    interfaceParams && interfaceParams.id\n      ? interfaceParams.id\n      : (exercise.id ?? '')\n\n  const subscribeExercicesParamsStore = exercicesParams.subscribe((value) => {\n    log('new interface')\n    if (value[exerciseIndex] !== interfaceParams) {\n      // MGu c'est une comparaison par rfrence\n      log('new interfaceParams subscribe:' + JSON.stringify(interfaceParams))\n      interfaceParams = value[exerciseIndex]\n    }\n    if (exercicesNumber !== value.length) {\n      exercicesNumber = value.length\n    }\n  })\n\n  let columnsCount = interfaceParams.cols || 1\n  let isVisible = true\n  let isContentVisible = true\n  let isSettingsVisible = true\n  let isInteractif = exercise.interactif\n  const interactifReady = exercise.interactifReady\n  const exerciceHasNoSettings =\n    !exercise.nbQuestionsModifiable &&\n    !exercise.correctionDetailleeDisponible &&\n    !exercise.seed &&\n    !exercise.besoinFormulaireCaseACocher &&\n    !exercise.besoinFormulaireNumerique &&\n    !exercise.besoinFormulaireTexte &&\n    !exercise.besoinFormulaire2CaseACocher &&\n    !exercise.besoinFormulaire2Numerique &&\n    !exercise.besoinFormulaire2Texte &&\n    !exercise.besoinFormulaire3CaseACocher &&\n    !exercise.besoinFormulaire3Numerique &&\n    !exercise.besoinFormulaire3Texte &&\n    !exercise.besoinFormulaire4CaseACocher &&\n    !exercise.besoinFormulaire4Numerique &&\n    !exercise.besoinFormulaire4Texte &&\n    !exercise.besoinFormulaire5CaseACocher &&\n    !exercise.besoinFormulaire5Numerique &&\n    !exercise.besoinFormulaire5Texte\n  let isExerciceChecked = false\n  const generateTitleAddendum = (): string => {\n    const ranks = exercisesUuidRanking(get(exercicesParams))\n    const counts = uuidCount(get(exercicesParams))\n    if (\n      interfaceParams &&\n      interfaceParams.uuid &&\n      counts[interfaceParams.uuid] > 1\n    ) {\n      return '|' + ranks[exerciseIndex]\n    } else {\n      return ''\n    }\n  }\n  let headerProps: HeaderProps = {\n    title: '',\n    id,\n    indiceExercice: exerciseIndex,\n    indiceLastExercice,\n    isInteractif,\n    interactifReady,\n    isSettingsVisible,\n  }\n\n  $: {\n    if (isContentVisible && isInteractif && buttonScore) initButtonScore()\n    if (!isInteractif && divScore) divScore.innerHTML = ''\n    headerProps.settingsReady = !exerciceHasNoSettings\n    headerProps.isSortable = true\n    headerProps.isDeletable = true\n    headerProps.isHidable = true\n    headerProps.id = id\n    headerProps.isInteractif = isInteractif\n    headerProps.correctionExists = exercise.listeCorrections.length > 0\n    headerProps.title = exercise.titre + generateTitleAddendum()\n    headerProps.indiceExercice = exerciseIndex\n    headerProps.indiceLastExercice = exercicesNumber\n    headerProps.isSettingsVisible = isSettingsVisible\n    headerProps = headerProps\n  }\n\n  let numberOfAnswerFields: number = 0\n\n  // on dtecte les changements dans la liste des exercices\n  // afin de mettre  jour le titre\n  const unsubscribeToChangesStore = changes.subscribe(() => {\n    headerProps.title = exercise.titre + generateTitleAddendum()\n  })\n\n  async function forceUpdate() {\n    if (exercise == null) return\n    exercise.numeroExercice = exerciseIndex\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function log(str: string) {\n    const debug = new URL(window.location.href).searchParams.get('log') === '1'\n    if (debug) {\n      console.info(exerciseIndex, exercise.id)\n      console.info(str)\n    }\n  }\n\n  beforeUpdate(async () => {\n    log('beforeUpdate:' + exercise.id)\n    if (numberOfAnswerFields !== countMathField(exercise)) {\n      numberOfAnswerFields = countMathField(exercise)\n    }\n    if (get(exercicesParams)[exerciseIndex] !== interfaceParams) {\n      // interface  changer car un exercice a t supprim au dessus...\n      interfaceParams = get(exercicesParams)[exerciseIndex]\n      log('new interfaceParams beforeUpdate:' + JSON.stringify(interfaceParams))\n      // obliger de charger l'exercice car son numro  changer, et il faut grer les id correctement des HTMLElements\n      await updateDisplay()\n    }\n  })\n\n  /**\n   * Fonction appele lorsque le listener dtecte `languageHasChanged`.\n   * Elle change la variable `interfaceParams` et surtout met  jour `id`\n   * qui est succeptible de changer avec la langue.\n   * @author sylvain\n   */\n  const updateExerciceAfterLanguageChange = () => {\n    if ($exercicesParams.length !== 0) {\n      interfaceParams = get(exercicesParams)[exerciseIndex]\n      id = get(exercicesParams)[exerciseIndex].id || ''\n    }\n  }\n\n  onMount(async () => {\n    log('onMount:' + exercise.id)\n    document.addEventListener('newDataForAll', newData)\n    document.addEventListener('setAllInteractif', setAllInteractif)\n    document.addEventListener('removeAllInteractif', removeAllInteractif)\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    document.addEventListener(\n      'languageHasChanged',\n      updateExerciceAfterLanguageChange,\n    )\n    await updateDisplay()\n  })\n\n  onDestroy(() => {\n    log('ondestroy' + exercise.id)\n    // Dtruit l'objet exercice pour librer la mmoire\n    exercise.reinit() // MGu ncessaire pour supprimer les listeners\n    exercise.destroy()\n    for (const prop of Object.keys(exercise)) {\n      Reflect.deleteProperty(exercise, prop)\n    }\n    document.removeEventListener('newDataForAll', newData)\n    document.removeEventListener('setAllInteractif', setAllInteractif)\n    document.removeEventListener('removeAllInteractif', removeAllInteractif)\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n    document.removeEventListener(\n      'languageHasChanged',\n      updateExerciceAfterLanguageChange,\n    )\n    unsubscribeToChangesStore()\n    subscribeExercicesParamsStore()\n  })\n\n  afterUpdate(async () => {\n    log('afterUpdate:' + exercise.id)\n    if (exercise) {\n      await tick()\n      if (isInteractif) {\n        await loadMathLive()\n        if (\n          exercise?.interactifType === 'cliqueFigure' &&\n          !isCorrectionVisible\n        ) {\n          prepareExerciceCliqueFigure(exercise)\n        }\n        // Ne pas tre not sur un exercice dont on a dj vu la correction\n        if (\n          isLocalStorageAvailable() &&\n          exercise.id !== undefined &&\n          exercise.seed !== undefined &&\n          window.localStorage.getItem(`${exercise.id}|${exercise.seed}`) !=\n            null &&\n          isContentVisible\n        ) {\n          await newData()\n        }\n      }\n      mathaleaRenderDiv(divExercice)\n      if (exerciceHasNoSettings) {\n        isSettingsVisible = false\n      }\n    }\n    // Evnement indispensable pour pointCliquable par exemple\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n    if (isCorrectionVisible) {\n      handleCorrectionAffichee()\n    }\n  })\n\n  async function newData() {\n    log('newData' + exercise.id)\n    if (Object.prototype.hasOwnProperty.call(exercise, 'listeQuestions')) {\n      if (isCorrectionVisible && isInteractif) isCorrectionVisible = false\n      if (\n        exercise !== undefined &&\n        typeof exercise?.applyNewSeed === 'function'\n      ) {\n        exercise.applyNewSeed()\n      }\n      if (buttonScore) initButtonScore()\n      if (divScore) divScore.innerHTML = ''\n      if (\n        isLocalStorageAvailable() &&\n        exercise.id !== undefined &&\n        isCorrectionVisible\n      ) {\n        window.localStorage.setItem(`${exercise.id}|${exercise.seed}`, 'true')\n      }\n      await updateDisplay()\n    }\n  }\n\n  async function setAllInteractif() {\n    if (exercise?.interactifReady) isInteractif = true\n    await updateDisplay()\n  }\n  async function removeAllInteractif() {\n    if (exercise?.interactifReady) isInteractif = false\n    await updateDisplay()\n  }\n\n  function handleNewSettings(event: CustomEvent) {\n    log('handleNewSettings:' + JSON.stringify(event.detail))\n    if (!interfaceParams) {\n      return\n    }\n    if (event.detail.nbQuestions) {\n      exercise.nbQuestions = event.detail.nbQuestions\n      interfaceParams.nbQuestions = exercise.nbQuestions\n    }\n    if (event.detail.duration) {\n      exercise.duration = event.detail.duration\n      interfaceParams.duration = exercise.duration\n    }\n    if (event.detail.sup !== undefined) {\n      exercise.sup = event.detail.sup\n      interfaceParams.sup = mathaleaHandleSup(exercise.sup)\n    }\n    if (event.detail.sup2 !== undefined) {\n      exercise.sup2 = event.detail.sup2\n      interfaceParams.sup2 = mathaleaHandleSup(exercise.sup2)\n    }\n    if (event.detail.sup3 !== undefined) {\n      exercise.sup3 = event.detail.sup3\n      interfaceParams.sup3 = mathaleaHandleSup(exercise.sup3)\n    }\n    if (event.detail.sup4 !== undefined) {\n      exercise.sup4 = event.detail.sup4\n      interfaceParams.sup4 = mathaleaHandleSup(exercise.sup4)\n    }\n    if (event.detail.sup5 !== undefined) {\n      exercise.sup5 = event.detail.sup5\n      interfaceParams.sup5 = mathaleaHandleSup(exercise.sup5)\n    }\n    if (\n      event.detail.versionQcm !== undefined &&\n      exercise instanceof ExerciceSimple\n    ) {\n      exercise.versionQcm = event.detail.versionQcm\n      interfaceParams.versionQcm = exercise.versionQcm ? '1' : '0'\n    }\n    if (event.detail.alea !== undefined) {\n      exercise.seed = event.detail.alea\n      interfaceParams.alea = exercise.seed\n    }\n    if (event.detail.correctionDetaillee !== undefined) {\n      exercise.correctionDetaillee = event.detail.correctionDetaillee\n      interfaceParams.cd = exercise.correctionDetaillee ? '1' : '0'\n    }\n    exercicesParams.update((list) => {\n      // interfaceParams a t mis  jour donc le store est  jour\n      return list\n    })\n    if (isExerciceChecked) {\n      // Si on change des rglages alors qu'on a dj une note  l'exercice\n      // alors on part sur de nouvelles donnes ainsi on efface le score et les rponses proposes\n      isExerciceChecked = false\n      newData()\n    } else {\n      updateDisplay()\n    }\n  }\n\n  async function updateDisplay(withNewVersion = true) {\n    log('updateDisplay:' + exercise.id)\n    if (\n      exercise === null ||\n      interfaceParams === undefined ||\n      exercise.uuid !== interfaceParams.uuid\n    ) {\n      return\n    }\n    if (\n      exercise.seed === undefined &&\n      typeof exercise.applyNewSeed === 'function'\n    ) {\n      exercise.applyNewSeed()\n    }\n    seedrandom(exercise.seed, { global: true })\n    if (exercise.typeExercice === 'simple' && withNewVersion) {\n      mathaleaHandleExerciceSimple(exercise, Boolean(isInteractif))\n    }\n    exercise.interactif = isInteractif\n    if (interfaceParams.alea !== exercise.seed && exercise.seed !== undefined) {\n      // on met  jour le storer seulement si besoin\n      interfaceParams.alea = exercise.seed\n      log('interfaceParams.alea updated' + interfaceParams.alea)\n      exercicesParams.update((list) => {\n        // interfaceParams a t mis  jour donc le store est  jour\n        return list\n      })\n    }\n    if (interfaceParams.interactif !== (isInteractif ? '1' : '0')) {\n      // on met  jour le storer seulement si besoin\n      interfaceParams.interactif = isInteractif ? '1' : '0'\n      log('interfaceParams.interactif updated' + interfaceParams.interactif)\n      exercicesParams.update((list) => {\n        // interfaceParams a t mis  jour donc le store est  jour\n        return list\n      })\n    }\n    if (interfaceParams.cols !== columnsCount) {\n      // on met  jour le storer seulement si besoin\n      if (columnsCount === 1 && interfaceParams.cols !== undefined) {\n        interfaceParams.cols = undefined\n        log('interfaceParams.cols updated' + interfaceParams.cols)\n        exercicesParams.update((list) => {\n          // interfaceParams a t mis  jour donc le store est  jour\n          return list\n        })\n      } else if (columnsCount > 1 && interfaceParams.cols !== columnsCount) {\n        interfaceParams.cols = columnsCount\n        log('interfaceParams.cols updated' + interfaceParams.cols)\n        exercicesParams.update((list) => {\n          // interfaceParams a t mis  jour donc le store est  jour\n          return list\n        })\n      }\n    }\n    exercise.numeroExercice = exerciseIndex\n    if (\n      exercise.typeExercice !== 'simple' &&\n      typeof exercise.nouvelleVersionWrapper === 'function' &&\n      withNewVersion\n    ) {\n      exercise.nouvelleVersionWrapper(exerciseIndex)\n    }\n    mathaleaUpdateUrlFromExercicesParams()\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function verifExercice() {\n    isCorrectionVisible = true\n    isExerciceChecked = true\n    resultsByExercice.update((l) => {\n      const indice = exercise.numeroExercice ?? 0\n      const result = {\n        ...exerciceInteractif(exercise, divScore, buttonScore),\n        indice,\n      }\n      if (result != null) {\n        l[indice] = result\n      }\n      return l\n    })\n  }\n\n  function initButtonScore() {\n    buttonScore.classList.remove(...buttonScore.classList)\n    buttonScore.classList.add(\n      'inline-flex',\n      'px-6',\n      'py-2.5',\n      'ml-6',\n      'bg-coopmaths-action',\n      'dark:bg-coopmathsdark-action',\n      'text-coopmaths-canvas',\n      'dark:text-coopmathsdark-canvas',\n      'font-medium',\n      'text-xs',\n      'leading-tight',\n      'uppercase',\n      'rounded',\n      'shadow-md',\n      'transform',\n      'hover:bg-coopmaths-action-lightest',\n      'dark:hover:bg-coopmathsdark-action-lightest',\n      'hover:shadow-lg',\n      'focus:bg-coopmaths-action-lightest',\n      'dark:focus:bg-coopmathsdark-action-lightest',\n      'focus:shadow-lg',\n      'focus:outline-none',\n      'focus:ring-0',\n      'active:bg-coopmaths-action-lightest',\n      'dark:active:bg-coopmathsdark-action-lightest',\n      'active:shadow-lg',\n      'transition',\n      'duration-150',\n      'ease-in-out',\n      'checkReponses',\n    )\n  }\n\n  /**\n   * Recherche toutes les figures ayant la classe `mathalea2d` et rduit leur largeur  95% de la valeur\n   * maximale du div reper par l'ID `consigne<X>-0` o `X` est l'indice de l'exercice\n   * @param {boolean} initialDimensionsAreNeeded si `true`, les valeurs initiales sont recharges ()`false` par dfaut)\n   * @author sylvain\n   */\n  async function adjustMathalea2dFiguresWidth(\n    initialDimensionsAreNeeded: boolean = false,\n  ) {\n    await tick()\n    const mathalea2dFigures =\n      document?.querySelectorAll<SVGElement>('.mathalea2d')\n    if (\n      mathalea2dFigures !== null &&\n      mathalea2dFigures !== undefined &&\n      mathalea2dFigures.length !== 0\n    ) {\n      for (let k = 0; k < mathalea2dFigures.length; k++) {\n        if (initialDimensionsAreNeeded) {\n          // rinitialisation\n          const initialWidth = mathalea2dFigures[k].getAttribute(\n            'data-width-initiale',\n          )\n          const initialHeight = mathalea2dFigures[k].getAttribute(\n            'data-height-initiale',\n          )\n          mathalea2dFigures[k].setAttribute('width', initialWidth ?? '0')\n          mathalea2dFigures[k].setAttribute('height', initialHeight ?? '0')\n          // les lments Katex des figures SVG\n          if (\n            mathalea2dFigures[k] != null &&\n            mathalea2dFigures[k].parentElement != null\n          ) {\n            const eltsInFigures =\n              mathalea2dFigures[k].parentElement?.querySelectorAll<HTMLElement>(\n                'div.divLatex',\n              ) || []\n            for (const elt of eltsInFigures) {\n              const e = elt\n              e.style.setProperty('top', e.dataset.top + 'px')\n              e.style.setProperty('left', e.dataset.left + 'px')\n            }\n          }\n        }\n        const consigneDiv = mathalea2dFigures[k].closest('[id^=\"consigne\"]')\n        if (\n          consigneDiv &&\n          mathalea2dFigures[k].clientWidth > consigneDiv.clientWidth\n        ) {\n          const coef =\n            (consigneDiv.clientWidth * 0.95) / mathalea2dFigures[k].clientWidth\n          const width = mathalea2dFigures[k].getAttribute('width')\n          const height = mathalea2dFigures[k].getAttribute('height')\n          if (!mathalea2dFigures[k].dataset.widthInitiale && width != null) {\n            mathalea2dFigures[k].dataset.widthInitiale = width\n          }\n          if (!mathalea2dFigures[k].dataset.heightInitiale && height != null) {\n            mathalea2dFigures[k].dataset.heightInitiale = height\n          }\n          mathalea2dFigures[k].setAttribute(\n            'height',\n            (\n              Number(mathalea2dFigures[k].dataset.heightInitiale) * coef\n            ).toString(),\n          )\n          mathalea2dFigures[k].setAttribute(\n            'width',\n            (\n              Number(mathalea2dFigures[k].dataset.widthInitiale) * coef\n            ).toString(),\n          )\n\n          if (\n            mathalea2dFigures[k] != null &&\n            mathalea2dFigures[k].parentElement !== null\n          ) {\n            const eltsInFigures =\n              mathalea2dFigures[k].parentElement?.querySelectorAll<HTMLElement>(\n                'div.divLatex',\n              ) || []\n            for (const elt of eltsInFigures) {\n              const e = elt\n              const initialTop = Number(e.dataset.top) ?? 0\n              const initialLeft = Number(e.dataset.left) ?? 0\n              e.style.setProperty('top', (initialTop * coef).toString() + 'px')\n              e.style.setProperty(\n                'left',\n                (initialLeft * coef).toString() + 'px',\n              )\n            }\n          }\n        }\n      }\n    }\n  }\n  // pour recalculer les tailles lors d'un changement de dimension de la fentre\n  window.onresize = async () => {\n    await adjustMathalea2dFiguresWidth(true)\n  }\n\n  async function handleExerciseRemoved(event: CustomEvent) {\n    if ($exercicesParams.length === 0) {\n      toggleSidenav(true)\n    }\n    await updateDisplay()\n  }\n</script>\n\n<div class=\"z-0 flex-1\" bind:this={divExercice}>\n  <HeaderExerciceVueProf\n    {...headerProps}\n    on:clickVisible={(event) => {\n      isVisible = event.detail.isVisible\n    }}\n    on:clickSettings={(event) =>\n      (isSettingsVisible = event.detail.isSettingsVisible)}\n    on:clickCorrection={async (event) => {\n      isContentVisible = event.detail.isContentVisible\n      isCorrectionVisible = event.detail.isCorrectionVisible\n\n      if (\n        isLocalStorageAvailable() &&\n        exercise.id !== undefined &&\n        isCorrectionVisible\n      ) {\n        window.localStorage.setItem(`${exercise.id}|${exercise.seed}`, 'true')\n      }\n      if (isInteractif) {\n        isInteractif = !isInteractif\n        exercise.interactif = isInteractif\n        await updateDisplay()\n      }\n      await adjustMathalea2dFiguresWidth()\n    }}\n    on:clickInteractif={async (event) => {\n      isInteractif = event.detail.isInteractif\n      exercise.interactif = isInteractif\n      exercicesParams.update((params) => {\n        params[exerciseIndex].interactif = isInteractif ? '1' : '0'\n        return params\n      })\n      await updateDisplay()\n    }}\n    on:clickNewData={newData}\n    interactifReady={Boolean(\n      exercise?.interactifReady &&\n      !isCorrectionVisible &&\n      headerProps?.interactifReady,\n    )}\n    on:exerciseRemoved={handleExerciseRemoved}\n  />\n\n  {#if isVisible}\n    <div class=\"flex flex-col-reverse lg:flex-row\">\n      <div\n        class=\"flex flex-col justify-start items-start relative {isSettingsVisible\n          ? 'w-full lg:w-3/4'\n          : 'w-full'} duration-500\"\n        id=\"exercice{exerciseIndex}\"\n      >\n        <div\n          class=\"print-hidden hidden md:flex flex-row justify-start text-coopmaths-struct dark:text-coopmathsdark-struct text-xs mt-2 pl-0 md:pl-2\"\n        >\n          <button\n            class={columnsCount > 1 ? 'visible' : 'invisible'}\n            type=\"button\"\n            aria-label=\"Diminuer le nombre de colonnes\"\n            title=\"Diminuer le nombre de colonnes\"\n            on:click={() => {\n              columnsCount--\n              updateDisplay(false)\n            }}\n          >\n            <i\n              class=\" text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-2 bx-xs bx-minus\"\n            ></i>\n          </button>\n          <i class=\"bx ml-1 bx-xs bx-columns\"></i>\n          <button\n            type=\"button\"\n            aria-label=\"Augmenter le nombre de colonnes\"\n            title=\"Augmenter le nombre de colonnes\"\n            on:click={() => {\n              columnsCount++\n              updateDisplay(false)\n            }}\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-1 bx-xs bx-plus\"\n            ></i>\n          </button>\n        </div>\n        <article\n          class=\"lg:text-base relative\"\n          style=\"font-size: {(\n            $globalOptions.z || 1\n          ).toString()}rem; line-height: calc({$globalOptions.z || 1});\"\n        >\n          <div class=\"mt-6 mb-4\">\n            {#key exercise.key + '-' + exerciseIndex}\n              {#if typeof exercise.consigne !== 'undefined' && exercise.consigne.length !== 0}\n                <div>\n                  <p\n                    class=\"mt-2 mb-2 ml-2 lg:mx-5 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                  >\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html mathaleaFormatExercice(exercise.consigne)}\n                  </p>\n                </div>\n              {/if}\n              {#if exercise.introduction}\n                <div>\n                  <p\n                    class=\"mt-2 mb-2 ml-2 lg:mx-5 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                  >\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html exercise.introduction}\n                  </p>\n                </div>\n              {/if}\n            {/key}\n          </div>\n          <div\n            style=\"columns: {columnsCount.toString()}\"\n            class=\"mt-4 lg:mt-6 mb-5\"\n          >\n            <ul\n              class=\"{exercise.listeQuestions.length === 1 ||\n              !exercise.listeAvecNumerotation\n                ? 'list-none'\n                : 'numbered-list'} w-full list-inside mb-2 mx-0 marker:text-coopmaths-struct dark:marker:text-coopmathsdark-struct marker:font-bold\"\n            >\n              {#each exercise.listeQuestions as item, i (exercise.key + '-' + exerciseIndex + '-' + i)}\n                <div\n                  style=\"break-inside:avoid\"\n                  id=\"consigne{exerciseIndex}-{i}\"\n                  class=\"container w-full grid grid-cols-1 auto-cols-min gap-1 lg:gap-4 mb-2 lg:mb-4 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                >\n                  <li\n                    id=\"exercice{exerciseIndex}Q{i}\"\n                    style=\"line-height: {exercise.spacing || 1}\"\n                  >\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html mathaleaFormatExercice(item)}\n                  </li>\n                  {#if isCorrectionVisible}\n                    <!-- EE : remplacement de ce class pour celui du dessous class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-6 lg:mt-2 mb-6 py-2 pl-4\"  -->\n                    <div\n                      class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus py-2 pl-4 mt-6 md:mt-4\"\n                      id=\"correction-exo{exerciseIndex}-Q{i}\"\n                      use:renderDiv={exercise.listeCorrections[i]}\n                    >\n                      <div\n                        class={exercise.consigneCorrection.length !== 0\n                          ? 'container bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark px-4 py-2 mr-2 ml-6 mb-2 font-light relative w-2/3'\n                          : 'hidden'}\n                      >\n                        <div\n                          class=\"{exercise.consigneCorrection.length !== 0\n                            ? 'container'\n                            : 'hidden'} absolute top-4 -left-4\"\n                        >\n                          <i\n                            class=\"bx bx-bulb scale-200 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n                          ></i>\n                        </div>\n                        <div class=\"\">\n                          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                          {@html exercise.consigneCorrection}\n                        </div>\n                      </div>\n                      <div\n                        class=\"container overflow-x-scroll overflow-y-hidden md:overflow-x-auto py-1\"\n                        style=\"line-height: {exercise.spacingCorr ||\n                          1}; break-inside:avoid\"\n                      >\n                        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                        {@html mathaleaFormatExercice(\n                          exercise.listeCorrections[i],\n                        )}\n                      </div>\n                      <!-- Avant le commit du 28/03/23, il y avait une mise en page plus complexe\n                      et cela posait problme au changement des paramtres avec la correction visible -->\n                      <!-- <div class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct top-0 left-0 border-b-[3px] w-10\" /> -->\n                      <div\n                        class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n                      >\n                        Correction\n                      </div>\n                      <div\n                        class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n                      ></div>\n                    </div>\n                  {/if}\n                </div>\n              {/each}\n            </ul>\n          </div>\n        </article>\n\n        {#if isInteractif && interactifReady && !isCorrectionVisible && isContentVisible}\n          <button\n            id=\"verif{exerciseIndex}\"\n            type=\"submit\"\n            on:click={verifExercice}\n            bind:this={buttonScore}\n            >Vrifier {numberOfAnswerFields > 1\n              ? 'les rponses'\n              : 'la rponse'}</button\n          >\n        {/if}\n        <div bind:this={divScore}></div>\n      </div>\n      <Settings\n        exercice={exercise}\n        bind:isVisible={isSettingsVisible}\n        exerciceIndex={exerciseIndex}\n        on:settings={handleNewSettings}\n      />\n    </div>\n  {/if}\n</div>\n\n<style>\n  li {\n    break-inside: avoid;\n  }\n</style>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../../exercices/Exercice'\n  import ExerciceMathaleaVueEleve from './exerciceMathaleaVueEleve/ExerciceMathaleaVueEleve.svelte'\n  import ExerciceMathaleaVueProf from './exerciceMathaleaVueProf/ExerciceMathaleaVueProf.svelte'\n\n  export let vue: 'prof' | 'eleve'\n  export let exercise: TypeExercice\n  export let exerciseIndex: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible: boolean = false\n  export let toggleSidenav: (open: boolean) => void\n</script>\n\n{#if vue === 'prof'}\n  <ExerciceMathaleaVueProf\n    {exercise}\n    {exerciseIndex}\n    {indiceLastExercice}\n    {isCorrectionVisible}\n    {toggleSidenav}\n    on:exerciseRemoved\n  />\n{:else if vue === 'eleve'}\n  <ExerciceMathaleaVueEleve\n    {exercise}\n    {exerciseIndex}\n    {indiceLastExercice}\n    {isCorrectionVisible}\n  />\n{/if}\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import type TypeExercice from '../../../../../exercices/Exercice'\n  import { isMenuNeededForExercises } from '../../../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../../../lib/stores/globalOptions'\n  import type { VueType } from '../../../../../lib/VueType'\n  import HeaderExerciceVueProf from '../../shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte'\n  import HeaderExerciceVueEleve from '../shared/HeaderExerciceVueEleve.svelte'\n  export let vue: VueType | undefined\n  export let exercise: TypeExercice\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n\n  let divExercice: HTMLDivElement\n\n  const headerExerciceProps = {\n    isMenuNeededForExercises: true,\n    title: exercise.titre,\n    indiceExercice: indiceExercice,\n  }\n\n  onMount(async () => {\n    if (exercise.html != null) {\n      divExercice.appendChild(exercise.html)\n    }\n    const exercicesAffiches = new window.Event('addedToDom', { bubbles: true })\n    divExercice.children[0].dispatchEvent(exercicesAffiches)\n  })\n\n  onDestroy(() => {\n    if (exercise.destroy != null) {\n      exercise.destroy()\n    }\n  })\n\n  $: {\n    headerExerciceProps.indiceExercice = indiceExercice\n  }\n</script>\n\n{#if vue === 'eleve'}\n  <HeaderExerciceVueEleve\n    {...headerExerciceProps}\n    isMenuNeededForExercises={$isMenuNeededForExercises}\n    presMode={$globalOptions.presMode ?? 'liste_exos'}\n  />\n{:else}\n  <HeaderExerciceVueProf\n    {...headerExerciceProps}\n    id={exercise.id ?? ''}\n    interactifReady={exercise.interactifReady}\n    {indiceLastExercice}\n    on:exerciseRemoved\n  />\n{/if}\n<section\n  id=\"insert-html-{indiceExercice}\"\n  class=\"mt-6 mb-2 ml-2 lg:mx-5 w-full\"\n>\n  <div bind:this={divExercice}></div>\n</section>\n","<script lang=\"ts\">\n  import HeaderExerciceVueProf from '../../shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte'\n  import { retrieveResourceFromUuid } from '../../../../../lib/components/refUtils'\n  import {\n    resourceHasPlace,\n    isStaticType,\n    type JSONReferentielObject,\n    isCrpeType,\n    isStaticWithoutPngUrl,\n  } from '../../../../../lib/types/referentiels'\n  /**\n   * Gestion du rfrentiel pour la recherche de l'uuid\n   */\n  import referentielStaticFR from '../../../../../json/referentielStaticFR.json'\n  import referentielStaticCH from '../../../../../json/referentielStaticCH.json'\n\n  import referentielBibliotheque from '../../../../../json/referentielBibliotheque.json'\n  import type { HeaderProps } from '../../../../../lib/types/ui'\n  // on rassemble les deux rfrentiel statique\n  const allStaticReferentiels: JSONReferentielObject = {\n    ...referentielBibliotheque,\n    ...referentielStaticFR,\n    ...referentielStaticCH,\n  }\n  // on supprime les entres par thme qui entrane des doublons\n  delete allStaticReferentiels['Brevet des collges par thme - APMEP']\n  delete allStaticReferentiels['BAC par thme - APMEP']\n  delete allStaticReferentiels['CRPE (2015-2019) par thme - COPIRELEM']\n  delete allStaticReferentiels['CRPE (2022-2023) par thme']\n  delete allStaticReferentiels['E3C par thme - APMEP']\n  delete allStaticReferentiels['EVACOM par thme']\n\n  export let uuid: string\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n  export let zoomFactor: string\n  export let isSolutionAccessible: boolean\n  const foundResource = retrieveResourceFromUuid(allStaticReferentiels, uuid)\n  if (isStaticWithoutPngUrl(foundResource)) {\n    const [examen, filiere] = foundResource.uuid.split('_')\n    if (examen === 'eam') {\n      foundResource.png = `https://coopmaths.fr/alea/static/eam/${foundResource.annee}/tex/png/${foundResource.uuid}.png`\n      foundResource.pngCor = `https://coopmaths.fr/alea/static/eam/${foundResource.annee}/tex/png/${foundResource.uuid}_cor.png`\n    } else if (examen === 'STL') {\n      foundResource.png = `https://coopmaths.fr/alea/static/stl/${foundResource.annee}/tex/png/${foundResource.uuid}.png`\n      foundResource.pngCor = `https://coopmaths.fr/alea/static/stl/${foundResource.annee}/tex/png/${foundResource.uuid}_cor.png`\n    } else {\n      foundResource.png = `https://coopmaths.fr/alea/static/${examen}/${foundResource.annee}/tex/png/${foundResource.uuid}.png`\n      foundResource.pngCor = `https://coopmaths.fr/alea/static/${examen}/${foundResource.annee}/tex/png/${foundResource.uuid}_cor.png`\n    }\n    console.log(foundResource)\n  }\n  const resourceToDisplay =\n    isStaticType(foundResource) || isCrpeType(foundResource)\n      ? { ...foundResource }\n      : null\n  const exercice =\n    resourceToDisplay === null\n      ? null\n      : {\n          png:\n            typeof resourceToDisplay.png === 'string'\n              ? [resourceToDisplay.png]\n              : resourceToDisplay.png,\n          pngCor:\n            typeof resourceToDisplay.pngCor === 'string'\n              ? [resourceToDisplay.pngCor]\n              : resourceToDisplay.pngCor,\n        }\n  let isCorrectionVisible = false\n  let isContentVisible = true\n  let headerExerciceProps: HeaderProps\n  if (resourceToDisplay !== null) {\n    headerExerciceProps = {\n      title: '',\n      id: '',\n      isInteractif: false,\n      settingsReady: false,\n      isSettingsVisible: false,\n      interactifReady: false,\n      indiceExercice,\n      indiceLastExercice,\n      randomReady: false,\n      correctionReady: isSolutionAccessible,\n    }\n    if (resourceHasPlace(resourceToDisplay)) {\n      headerExerciceProps.title = `${resourceToDisplay.typeExercice.toUpperCase()} ${\n        resourceToDisplay.mois || ''\n      } ${resourceToDisplay.annee} ${resourceToDisplay.lieu} ${resourceToDisplay.jour || ''} Ex ${resourceToDisplay.numeroInitial}`\n    } else {\n      headerExerciceProps.title = resourceToDisplay.uuid\n    }\n  }\n\n  let noCorrectionAvailable = false\n\n  function handleNoCorrectionAvailable() {\n    noCorrectionAvailable = true\n  }\n</script>\n\n<HeaderExerciceVueProf\n  {...headerExerciceProps}\n  {indiceExercice}\n  {indiceLastExercice}\n  on:clickCorrection={(event) => {\n    isCorrectionVisible = event.detail.isCorrectionVisible\n  }}\n  on:clickVisible={(event) => {\n    isContentVisible = event.detail.isVisible\n    isCorrectionVisible = event.detail.isVisible\n  }}\n  on:exerciseRemoved\n/>\n\n<div class=\"p-4\">\n  {#if isContentVisible}\n    {#if exercice}\n      {#each exercice.png as url}\n        <img\n          src={url}\n          class=\"mb-6\"\n          style=\"width: calc(100% * {zoomFactor}\"\n          alt=\"nonc\"\n        />\n      {/each}\n    {/if}\n  {/if}\n\n  {#if isCorrectionVisible}\n    <div\n      class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-6 lg:mt-2 mb-6 py-2 pl-4\"\n      id=\"correction{indiceExercice}\"\n    >\n      <div class=\"container\">\n        {#if exercice}\n          {#each exercice.pngCor as url}\n            {#if noCorrectionAvailable}\n              <p class=\"text-red-500\">Aucune correction disponible</p>\n            {:else}\n              <img\n                src={url}\n                class=\"p-2\"\n                style=\"width: calc(100% * {zoomFactor}\"\n                alt=\"correction\"\n                on:error={handleNoCorrectionAvailable}\n              />\n            {/if}\n          {/each}\n        {/if}\n      </div>\n      <!-- <div class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct top-0 left-0 border-b-[3px] w-10\" /> -->\n      <div\n        class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n      >\n        Correction\n      </div>\n      <div\n        class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n      ></div>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { onMount, type Component } from 'svelte'\n  import Exercice from '../../../exercices/Exercice'\n  import { isStatic, isSvelte } from '../../../lib/components/componentsUtils'\n  import {\n    getSvelteComponent,\n    mathaleaHandleParamOfOneExercice,\n    mathaleaLoadExerciceFromUuid,\n  } from '../../../lib/mathalea'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import type { IExercice, InterfaceParams } from '../../../lib/types'\n  import ExerciceMathalea from './exerciceMathalea/ExerciceMathalea.svelte'\n  import ExerciceHtml from './presentationalComponents/exerciceHtml/ExerciceHtml.svelte'\n  import ExerciceStatic from './presentationalComponents/exerciceStatic/ExerciceStatic.svelte'\n\n  export let paramsExercice: InterfaceParams\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible = false\n  export let toggleSidenav: (open: boolean) => void\n\n  type ExerciseType =\n    | 'mathaleaVueProf'\n    | 'mathaleaVueEleve'\n    | 'static'\n    | 'html'\n    | 'svelte'\n\n  let exercise: Exercice\n  let exerciseType: ExerciseType\n  let ComponentExercice: Component<any>\n\n  let debug = false\n  function log(str: string, level: number = 3) {\n    if (debug || window.logDebug >= level) {\n      console.info(str)\n    }\n  }\n\n  onMount(async () => {\n    log(\n      `Exercice.svelte mounted with paramsExercice: ` +\n        JSON.stringify(paramsExercice),\n    )\n    if (isStatic(paramsExercice.uuid)) {\n      exerciseType = 'static'\n    } else if (isSvelte(paramsExercice.uuid)) {\n      exerciseType = 'svelte'\n      ComponentExercice = await getSvelteComponent(paramsExercice)\n    } else {\n      exercise = (await getExercise(paramsExercice)) as Exercice\n      exerciseType = await getExerciseType(exercise)\n    }\n    log(\n      `Exercice.svelte n ${indiceExercice}: Loaded exercise of type ${exerciseType}: id ${exercise.id}, uuid ${exercise.uuid}`,\n    )\n  })\n\n  async function getExercise(\n    paramsExercice: InterfaceParams,\n  ): Promise<IExercice> {\n    const exercise = await mathaleaLoadExerciceFromUuid(paramsExercice.uuid)\n    exercise.numeroExercice = indiceExercice\n    mathaleaHandleParamOfOneExercice(exercise, paramsExercice)\n    if (paramsExercice.duration) exercise.duree = paramsExercice.duration\n    return exercise\n  }\n\n  async function getExerciseType(exercise: Exercice): Promise<ExerciseType> {\n    if (exercise.typeExercice && exercise.typeExercice.includes('html')) {\n      return 'html'\n    } else {\n      if (\n        $globalOptions.v === 'eleve' ||\n        $globalOptions.v === 'myriade' ||\n        $globalOptions.v === 'indices'\n      ) {\n        return 'mathaleaVueEleve'\n      } else {\n        return 'mathaleaVueProf'\n      }\n    }\n  }\n</script>\n\n{#if exerciseType === 'static'}\n  <ExerciceStatic\n    {indiceExercice}\n    {indiceLastExercice}\n    uuid={paramsExercice.uuid}\n    zoomFactor={$globalOptions.z ?? '1'}\n    isSolutionAccessible={!!$globalOptions.isSolutionAccessible}\n    on:exerciseRemoved\n  />\n{:else if exerciseType === 'html'}\n  <ExerciceHtml\n    vue={$globalOptions.v}\n    {exercise}\n    {indiceExercice}\n    {indiceLastExercice}\n    on:exerciseRemoved\n  />\n{:else if exerciseType === 'svelte'}\n  <svelte:component\n    this={ComponentExercice}\n    {indiceExercice}\n    {indiceLastExercice}\n  />\n{:else if exerciseType === 'mathaleaVueEleve'}\n  <ExerciceMathalea\n    vue=\"eleve\"\n    {exercise}\n    exerciseIndex={indiceExercice}\n    {indiceLastExercice}\n    {isCorrectionVisible}\n    {toggleSidenav}\n    on:exerciseRemoved\n  />\n{:else if exerciseType === 'mathaleaVueProf'}\n  <ExerciceMathalea\n    vue=\"prof\"\n    {exercise}\n    exerciseIndex={indiceExercice}\n    {indiceLastExercice}\n    {isCorrectionVisible}\n    {toggleSidenav}\n    on:exerciseRemoved\n  />\n{/if}\n\n<style>\n</style>\n","<script lang=\"ts\">\n  import { resizeTags } from '../../../lib/components/sizeTools'\n  import { mathaleaUpdateUrlFromExercicesParams } from '../../../lib/mathalea'\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n\n  export let size: 'xs' | 'sm' | 'md' | 'lg' | 'bx-sm md:bx-md' = 'sm'\n  export let isBorderTransparent: boolean = false\n\n  const urlParams = new URLSearchParams(window.location.search)\n  const z = urlParams.get('z')\n  let zoom: number = z ? Number.parseFloat(z) : 1\n\n  function zoomMinus() {\n    // zoom -= 0.1\n    zoom = Number.parseFloat((zoom - 0.1).toFixed(1))\n    updateSize()\n  }\n\n  function zoomPlus() {\n    // zoom += 0.1\n    zoom = Number.parseFloat((zoom + 0.1).toFixed(1))\n    updateSize()\n  }\n\n  function updateSize() {\n    globalOptions.update((params) => {\n      params.z = zoom.toString()\n      return params\n    })\n    // figures scratch\n    const scratchDivs = document.getElementsByClassName('scratchblocks')\n    for (const scratchDiv of scratchDivs) {\n      const svgDivs = scratchDiv.getElementsByTagName('svg')\n      resizeTags([...svgDivs], parseInt($globalOptions.z ?? '1'))\n    }\n    // QCM\n    const checkboxes = document.querySelectorAll('[id^=checkEx')\n    resizeTags([...checkboxes], parseInt($globalOptions.z ?? '1'))\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n    // Event pour apiGeom\n    const zoomEvent = new CustomEvent('zoomChanged', {\n      detail: { zoom: $globalOptions.z },\n    })\n    document.dispatchEvent(zoomEvent)\n  }\n</script>\n\n<button\n  type=\"button\"\n  on:click={zoomMinus}\n  class=\"tooltip tooltip-left tooltip-neutral\"\n  data-tip=\"Rduire la taille du texte\"\n  aria-label=\"Rduire la taille du texte\"\n>\n  <i\n    class=\"bx {size} rounded-full p-1 bx-minus border border-coopmaths-action hover:border-coopmaths-action-lightest bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmaths-action-lightest\n    {isBorderTransparent ? 'lg:border-transparent' : ''}\"\n  ></i>\n</button>\n<button\n  type=\"button\"\n  on:click={zoomPlus}\n  class=\"tooltip tooltip-left tooltip-neutral\"\n  data-tip=\"Augmenter la taille du texte\"\n  aria-label=\"Augmenter la taille du texte\"\n>\n  <i\n    class=\"bx {size} rounded-full p-1 bx-plus border border-coopmaths-action hover:border-coopmaths-action-lightest bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmaths-action-lightest\n    {isBorderTransparent ? 'lg:border-transparent' : ''}\"\n  ></i>\n</button>\n","<script lang=\"ts\">\n  import ButtonIcon from './ButtonIcon.svelte'\n  export let icon: string\n  export let tooltip: string\n  export let tooltipPosition: 'auto' | 'top' | 'bottom' | 'left' | 'right' =\n    'bottom'\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let floatUnderText: string = ''\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n</script>\n\n<!--  la diffrence de ButtonIcon qui est vraiment un bouton, ButtonIconTooltip est un div qui contient un bouton -->\n\n<div\n  class=\"tooltip tooltip-neutral\"\n  class:tooltip-top={tooltipPosition === 'top'}\n  class:tooltip-bottom={tooltipPosition === 'bottom'}\n  class:tooltip-left={tooltipPosition === 'left'}\n  class:tooltip-right={tooltipPosition === 'right'}\n  data-tip={tooltip}\n>\n  <ButtonIcon\n    class={$$props.class || ''}\n    {icon}\n    {title}\n    {disabled}\n    {floatUnderText}\n    {cornerIcon}\n    {cornerIconClass}\n    on:click\n  />\n</div>\n","<script lang=\"ts\">\n  import { mathaleaGoToView } from '../../../lib/mathaleaUtils'\n  import ButtonIconTooltip from '../forms/ButtonIconTooltip.svelte'\n\n  export let brandImagePath: string | null = null\n  export let productImagePath: string | null =\n    'assets/images/vendors/bordas/myriade-bordas-logo.png'\n  export let icon: string = 'bxs-cog'\n\n  function goToVueProf() {\n    window.history.replaceState({}, '', window.location.href)\n    mathaleaGoToView('')\n    window.history.replaceState({}, '', window.location.href)\n  }\n</script>\n\n<div\n  id=\"vendor-banner\"\n  class=\"flex flex-col items-center justify-center w-full px-2 lg:px-8 bg-coopmaths-canvas\"\n>\n  <div class=\"flex items-center justify-between w-full p-4\">\n    <img\n      src=\"assets/svg/logo_mathalea.svg\"\n      alt=\"D MathALA\"\n      class=\"h-7 lg:h-9\"\n    />\n    <div class=\"flex flex-row m-0 p-0 items-center justify-center space-x-3\">\n      <img class=\"h-6 lg:h-8\" src={productImagePath} alt=\"Manual\" />\n      {#if brandImagePath}\n        <img class=\"h-6 lg:h-8\" src={brandImagePath} alt=\"Brand\" />\n      {/if}\n    </div>\n    <ButtonIconTooltip\n      {icon}\n      tooltip=\"Accder aux rglages\"\n      class=\"hidden lg:block text-3xl\"\n      on:click={goToVueProf}\n    />\n  </div>\n  <ButtonIconTooltip\n    {icon}\n    tooltip=\"Accder aux rglages\"\n    class=\"block lg:hidden text-3xl\"\n    on:click={goToVueProf}\n  />\n</div>\n","<!--\n  @component\n  Permet de dessinner une flash card qui rvle la rponse on hover.\n  inspiration : https://jacky-ttt.medium.com/day156-css-card-flip-d25f102547bd\n  /!\\ si ne marche pas sur smartphone, essayer d'ajouter group-active:flip-rotate-y-180\n -->\n<div\n  class={`${$$props.class || 'w-[420px] h-[300px]'} bg-transparent group perspective cursor-pointer`}\n>\n  <div\n    class=\"relative preserve-3d group-hover:flip-rotate-y-180 w-full h-full rounded-xl duration-1000 shadow-xl\"\n  >\n    <div\n      class=\"absolute backface-hidden w-full h-full flex justify-center items-center rounded-xl text-2xl border-2 bg-coopmaths-canvas text-coopmaths-corpus border-coopmaths-struct-lightest dark:bg-coopmathsdark-canvas dark:text-coopmathsdark-corpus dark:border-coopmathsdark-struct-lightest\"\n    >\n      <slot name=\"question\">Question</slot>\n    </div>\n    <div\n      class=\"absolute flip-rotate-y-180 backface-hidden w-full h-full flex justify-center items-center rounded-xl text-2xl font-light bg-coopmaths-canvas-dark text-coopmaths-corpus dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus\"\n    >\n      <slot name=\"answer\">Rponse</slot>\n    </div>\n  </div>\n</div>\n","<script>\n</script>\n\n<footer\n  class=\"flex-1 w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas h-12 flex justify-center bottom-0 opacity-100\"\n>\n  <a href=\"/\" target=\"_blank\">\n    <img\n      class=\"px-6\"\n      style=\"height: 30px\"\n      src=\"assets/images/logo2.png\"\n      alt=\"Logo Coopmaths 2\"\n    />\n  </a>\n</footer>\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate, onDestroy, onMount, tick } from 'svelte'\n  import {\n    buildExercisesList,\n    splitExercisesIntoQuestions,\n  } from '../../../lib/components/exercisesUtils'\n  import {\n    getCanvasFont,\n    getTextWidth,\n    remToPixels,\n  } from '../../../lib/components/measures'\n  import { resizeContent } from '../../../lib/components/sizeTools'\n  import { handleFlowmath } from '../../../lib/handleFlowmath'\n  import { verifQuestionCliqueFigure } from '../../../lib/interactif/cliqueFigure'\n  import { prepareExerciceCliqueFigure } from '../../../lib/interactif/gestionInteractif'\n  import { verifQuestionMathLive } from '../../../lib/interactif/mathLive'\n  import { verifQuestionQcm } from '../../../lib/interactif/qcm'\n  import { verifQuestionListeDeroulante } from '../../../lib/interactif/questionListeDeroulante'\n  import {\n    mathaleaFormatExercice,\n    mathaleaRenderDiv,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea'\n  import {\n    darkMode,\n    exercicesParams,\n    isMenuNeededForExercises,\n    isMenuNeededForQuestions,\n    resultsByExercice,\n  } from '../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import { vendor } from '../../../lib/stores/vendorStore'\n  import {\n    isInteractivityType,\n    isOldFormatInteractifType,\n    type IExercice,\n    type InteractivityType,\n    type OldFormatInteractifType,\n  } from '../../../lib/types'\n  import { loadMathLive } from '../../../modules/loaders'\n  import Keyboard from '../../keyboard/Keyboard.svelte'\n  import { keyboardState } from '../../keyboard/stores/keyboardStore'\n  import Exercice from '../../shared/exercice/Exercice.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import ButtonToggle from '../../shared/forms/ButtonToggle.svelte'\n  import BtnZoom from '../../shared/ui/btnZoom.svelte'\n  import Banner from '../../shared/vendors/Banner.svelte'\n  import FlipCard from './FlipCard.svelte'\n  import Footer2 from './Footer2.svelte'\n\n  let currentIndex: number = 0\n  let exercices: IExercice[] = []\n  let questions: (string | IExercice)[] = []\n  let consignes: string[] = []\n  let corrections: string[] = []\n  let consignesCorrections: string[] = []\n  let indiceExercice: number[] = []\n  let indiceQuestionInExercice: number[] = []\n  const resultsByQuestion: boolean[] = []\n  const isDisabledButton: boolean[] = []\n  let isCorrectionVisible: boolean[] = []\n  const divsCorrection: HTMLDivElement[] = []\n  let currentWindowWidth: number = document.body.clientWidth\n  let eleveSection: HTMLElement\n  const brandImagePath = $vendor.brand.logoPath\n  const productImagePath = $vendor.product.logoPath\n\n  function urlToDisplay() {\n    const urlOptions = mathaleaUpdateExercicesParamsFromUrl()\n    globalOptions.update(() => {\n      urlOptions.v = 'eleve'\n      return urlOptions\n    })\n  }\n\n  /**\n   * Adaptation du titre des pages pour chaque exercice\n   * Plus le nombre d'exercices est lev, moins le titre contient de caractres\n   * @param {numer} dim largeur disponible  considrer pour le calcul si lment non dispo (dclenche le re-calcul)\n   * @param {number} nbOfExercises  nombre d'exercices\n   * @returns {string} titre\n   * @author sylvain\n   */\n  function buildExoTitle(dim: number, nbOfExercises: number) {\n    if ($globalOptions.presMode === 'liste_exos' || nbOfExercises === 0) {\n      return 'Exercice'\n    }\n    const navigationHeaderElt = document.getElementById('navigationHeaderID')\n    const exerciseTitleElt = document.getElementById('exerciseTitleID0')\n    // soit l'lment existe et on rcupre sa vraie largeur, soit on calcule une valeur approche\n    const roomForQuestionsTitles = navigationHeaderElt\n      ? navigationHeaderElt.offsetWidth\n      : ((dim - 2 * remToPixels(1)) * 11) / 12\n    const roomForOne =\n      roomForQuestionsTitles / nbOfExercises - 2 * remToPixels(1.5)\n    if (\n      roomForOne >=\n      getTextWidth(\n        'Exercice 10',\n        getCanvasFont(exerciseTitleElt ?? document.body),\n      )\n    ) {\n      if ($isMenuNeededForExercises) $isMenuNeededForExercises = false\n      return 'Exercice'\n    } else if (\n      roomForOne >=\n      getTextWidth('Ex 10', getCanvasFont(exerciseTitleElt ?? document.body)) +\n        20\n    ) {\n      if ($isMenuNeededForExercises) $isMenuNeededForExercises = false\n      return 'Ex'\n    } else if (\n      roomForOne >=\n      getTextWidth('10', getCanvasFont(exerciseTitleElt ?? document.body)) + 20\n    ) {\n      if ($isMenuNeededForExercises) $isMenuNeededForExercises = false\n      return ''\n    } else {\n      if (!$isMenuNeededForExercises) $isMenuNeededForExercises = true\n      return ''\n    }\n  }\n\n  $: exerciseTitle = buildExoTitle(currentWindowWidth, $exercicesParams.length)\n\n  /**\n   * Adaptation du titre des pages pour chaque question\n   * Plus le nombre de questions est lev, moins le titre contient de caractres\n   * @param {numer} dim largeur disponible  considrer pour le calcul si lment non dispo (dclenche le re-calcul)\n   * @param {number} nbOfQuestions  nombre de questions\n   * @returns {string} titre\n   * @author sylvain\n   */\n  function buildQuestionTitle(dim: number, nbOfQuestions: number) {\n    if ($globalOptions.presMode === 'liste_exos' || nbOfQuestions === 0) {\n      return 'Question'\n    }\n    const navigationHeaderElt = document.getElementById('navigationHeaderID')\n    const questionTitleElt = document.getElementById('questionTitleID0')\n    // soit l'lment existe et on rcupre sa vraie largeur, soit on calcule une valeur approche\n    const roomForQuestionsTitles = navigationHeaderElt\n      ? navigationHeaderElt.offsetWidth\n      : ((dim - 2 * remToPixels(1)) * 11) / 12\n    const roomForOne =\n      roomForQuestionsTitles / nbOfQuestions - 2 * remToPixels(0.5)\n    if (\n      roomForOne >=\n      getTextWidth(\n        'Question 10',\n        getCanvasFont(questionTitleElt ?? document.body),\n      )\n    ) {\n      $isMenuNeededForQuestions = false\n      return 'Question'\n    } else if (\n      roomForOne >=\n      getTextWidth('Q 10', getCanvasFont(questionTitleElt ?? document.body)) +\n        20\n    ) {\n      $isMenuNeededForQuestions = false\n      return 'Q'\n    } else if (\n      roomForOne >=\n      getTextWidth('10', getCanvasFont(questionTitleElt ?? document.body)) + 20\n    ) {\n      $isMenuNeededForQuestions = false\n      return ''\n    } else {\n      $isMenuNeededForQuestions = true\n      return ''\n    }\n  }\n\n  $: questionTitle = buildQuestionTitle(currentWindowWidth, questions.length)\n\n  let debug = false\n  function log(str: string, level: number = 3) {\n    if (debug || window.logDebug >= level) {\n      console.info(str)\n    }\n  }\n\n  exercicesParams.subscribe((value) => {\n    log('exercicesParams changed: ' + JSON.stringify(value))\n  })\n\n  globalOptions.subscribe((value) => {\n    log('globalOptions changed: ' + JSON.stringify(value))\n  })\n\n  beforeUpdate(() => {\n    log('Eleve.svelte beforeUpdate')\n  })\n\n  afterUpdate(() => {\n    log('Eleve.svelte afterUpdate')\n    const starttime = window.performance.now()\n    // Evnement indispensable pour pointCliquable par exemple\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n    if (eleveSection && $globalOptions.presMode === 'une_question_par_page') {\n      const params = $globalOptions\n      const zoom = Number(params.z) ?? 1\n      resizeContent(eleveSection, zoom)\n    }\n\n    log(\n      'Eleve.svelte afterUpdate done in ' +\n        (window.performance.now() - starttime),\n      2,\n    )\n  })\n\n  let resizeObserver: ResizeObserver\n  onMount(async () => {\n    log('Eleve.svelte mount')\n\n    // Pour FlowMath, on initialise d'abord le handler RPC AVANT de charger depuis l'URL\n    // Car les exercices peuvent arriver via postMessage plutt que via l'URL\n    if ($globalOptions.recorder === 'flowmath') {\n      handleFlowmath(exercicesParams, resultsByExercice)\n    }\n\n    // Si presMode est undefined cela signifie que l'on charge cet url\n    // sinon en venant du modal il existerait\n    if ($globalOptions.presMode === undefined) {\n      const urlOptions = mathaleaUpdateExercicesParamsFromUrl()\n      urlOptions.v = 'eleve'\n      globalOptions.update(() => {\n        return urlOptions\n      })\n      urlToDisplay()\n    } else {\n      // Si ce n'est pas un chargement d'url alors il faut initialiser le store des rsultats\n      if ($resultsByExercice.length > 0) {\n        resultsByExercice.update(() => [])\n      }\n    }\n    if ($globalOptions.setInteractive === '1') {\n      for (const param of $exercicesParams) {\n        if (param.interactif !== '1') {\n          param.interactif = '1'\n        }\n      }\n    }\n\n    if ($globalOptions.presMode === 'une_question_par_page') {\n      /** Charge les exercices\n       * MGU : pas besoin de charger les exos si ce n'est pas des questions,\n       * car c'est le composant qui affiche l'exo qui le charge\n       * DONC UNIQUEMENT SI ON EST EN MODE UNE QUESTION PAR PAGE!\n       */\n      exercices = await Promise.all(buildExercisesList())\n\n      // construit les questions\n      buildQuestions()\n    }\n\n    if (\n      $globalOptions.recorder === 'capytale' ||\n      $globalOptions.recorder === 'moodle' ||\n      $globalOptions.recorder === 'anki' ||\n      $globalOptions.recorder === 'labomep' ||\n      $globalOptions.recorder === 'flowmath'\n    ) {\n      // attend la fin de la mise  jour pour mettre l'observer\n      await tick()\n      /*\n      Ce code est ncessaire seulement si coopmaths est intgr dans un autre site pour permettre de redimensionner la fentre\n      */\n      resizeObserver = new ResizeObserver((x) => {\n        const url = new URL(window.location.href)\n        const iframe = url.searchParams.get('iframe')\n        window.parent.postMessage(\n          {\n            hauteurExercice: x[0].contentRect.height,\n            action: 'mathalea:resize',\n            iframe,\n          },\n          '*',\n        )\n        // ou x[0].contentRect.height ou x[0].contentBoxSize[0].blockSize ou x[0].borderBoxSize[0].inlineSize ou x[0].target.scrollHeight\n      })\n      if (eleveSection != null) resizeObserver.observe(eleveSection)\n    }\n    log('fin mount eleve')\n  })\n\n  onDestroy(() => {\n    log('destroy eleve')\n    if (resizeObserver) resizeObserver.disconnect()\n  })\n\n  async function buildQuestions() {\n    const splitResults = splitExercisesIntoQuestions(exercices)\n    questions = [...splitResults.questions]\n    consignes = [...splitResults.consignes]\n    corrections = [...splitResults.corrections]\n    consignesCorrections = [...splitResults.consignesCorrections]\n    isCorrectionVisible = [...splitResults.isCorrectionVisible]\n    indiceExercice = [...splitResults.indiceExercice]\n    indiceQuestionInExercice = [...splitResults.indiceQuestionInExercice]\n    if ($globalOptions.presMode === 'une_question_par_page') {\n      // Pour les autres mode de prsentation, cela est gr par ExerciceMathaleaVueProf\n      mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n      await tick()\n      const body = document.querySelector<HTMLElement>('body')\n      if (body) {\n        mathaleaRenderDiv(body)\n      }\n      loadMathLive()\n    }\n    const section = document.querySelector('section') as HTMLElement\n    const hauteurExercice = section.scrollHeight\n    const url = new URL(window.location.href)\n    const iframe = url.searchParams.get('iframe')\n    window.parent.postMessage(\n      {\n        hauteurExercice,\n        exercicesParams: $exercicesParams,\n        action: 'mathalea:init',\n        iframe,\n      },\n      '*',\n    )\n  }\n\n  async function checkQuestion(i: number) {\n    // ToFix exercices custom avec pointsCliquable\n    const exercice = exercices[indiceExercice[i]]\n    let type: InteractivityType | OldFormatInteractifType | undefined =\n      exercice.autoCorrection[indiceQuestionInExercice[i]]?.reponse?.param\n        ?.formatInteractif\n    if (type === undefined || type === null) {\n      const interactifType = exercice.interactifType\n      if (\n        isInteractivityType(interactifType) ||\n        isOldFormatInteractifType(interactifType)\n      ) {\n        type = interactifType\n      }\n    }\n    if (type == null) {\n      // @fixme on ne devrait jamais arriver ici pour un exercice non interactif !\n      window.notify(\n        'checkQuestion a t appel pour un exercice non interactif',\n        {\n          exercice: exercice.uuid,\n        },\n      )\n      resultsByQuestion[i] = false\n      return\n    }\n    if (type.toLowerCase() === 'mathlive') {\n      const resu = verifQuestionMathLive(\n        exercices[indiceExercice[i]],\n        indiceQuestionInExercice[i],\n      )\n      resultsByQuestion[i] =\n        resu !== undefined && (resu.isOk === 'Ok' || resu.isOk === true)\n    } else if (type === 'qcm') {\n      resultsByQuestion[i] =\n        verifQuestionQcm(\n          exercices[indiceExercice[i]],\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    } else if (type === 'listeDeroulante') {\n      resultsByQuestion[i] =\n        verifQuestionListeDeroulante(\n          exercices[indiceExercice[i]],\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    } else if (type === 'cliqueFigure') {\n      resultsByQuestion[i] =\n        verifQuestionCliqueFigure(\n          exercices[indiceExercice[i]],\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    } else if (type === 'custom') {\n      // si le typ est `custom` on est sr que `correctionInteractive` existe\n      // d'o le ! aprs `correctionInteractive`\n      resultsByQuestion[i] =\n        exercices[indiceExercice[i]].correctionInteractive!(\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    }\n    isDisabledButton[i] = true\n    isCorrectionVisible[i] = true\n    await tick()\n    const feedback = document.querySelector<HTMLElement>(\n      `#feedbackEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n    )\n    // ncessaire pour le feedback\n    if (feedback !== null && feedback !== undefined) mathaleaRenderDiv(feedback)\n    mathaleaRenderDiv(divsCorrection[i])\n  }\n\n  async function switchCorrectionVisible(i: number) {\n    isCorrectionVisible[i] = !isCorrectionVisible[i]\n    if (isCorrectionVisible[i]) {\n      await tick()\n      mathaleaRenderDiv(divsCorrection[i])\n    }\n  }\n\n  async function handleIndexChange(exoNum: number) {\n    currentIndex = exoNum\n    if ($globalOptions.presMode === 'une_question_par_page') {\n      await tick() // MGU attendre que le div soit affich avant de mettre  jour la question\n      const exo = exercices[indiceExercice[exoNum]]\n      const questionEvent = new CustomEvent('questionDisplay', {\n        detail: {\n          uuid: exo.uuid,\n          exoNumber: indiceExercice[exoNum],\n          questionNumber: exoNum,\n        },\n      })\n      document.dispatchEvent(questionEvent)\n      if (exo && exo.interactifType === 'cliqueFigure' && exo.interactif) {\n        prepareExerciceCliqueFigure(exo)\n      }\n    } else if ($globalOptions.presMode === 'un_exo_par_page') {\n      await tick() // MGU attendre que le div soit affich avant de mettre  jour la question\n      const exo = $exercicesParams[exoNum]\n      const questionEvent = new CustomEvent('questionDisplay', {\n        detail: {\n          uuid: exo.uuid,\n          exoNumber: exoNum,\n          questionNumber: null,\n        },\n      })\n      document.dispatchEvent(questionEvent)\n    }\n  }\n</script>\n\n<svelte:window bind:innerWidth={currentWindowWidth} />\n<section\n  bind:this={eleveSection}\n  class=\"relative flex flex-col min-h-screen min-w-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-corpus dark:text-coopmathsdark-corpus {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  {#if $globalOptions.v === 'myriade' || $globalOptions.v === 'indices'}\n    <Banner {brandImagePath} {productImagePath} />\n  {/if}\n  <div\n    class=\"fixed z-20 h-16 bottom-4 right-2 {(typeof $globalOptions.title ===\n      'string' &&\n      $globalOptions.title.length === 0 &&\n      $globalOptions.presMode === 'liste_exos') ||\n    ($globalOptions.title != null && $globalOptions.title.length > 0)\n      ? 'lg:top-8'\n      : 'lg:top-20'}  lg:right-6\"\n  >\n    <div\n      class=\"flex flex-col-reverse lg:flex-row space-y-reverse space-y-4 lg:space-y-0 lg:space-x-4 scale-75 lg:scale-100\n      {$globalOptions.v === 'myriade' || $globalOptions.v === 'indices'\n        ? 'translate-y-16'\n        : ''}\"\n    >\n      <BtnZoom\n        size=\"bx-sm md:bx-md\"\n        isBorderTransparent={typeof $globalOptions.title === 'string' &&\n          $globalOptions.title.length > 0}\n      />\n    </div>\n  </div>\n  <div class=\"mb-auto\">\n    <div\n      class=\"{typeof $globalOptions.title === 'string' &&\n      $globalOptions.title.length === 0 &&\n      $globalOptions.presMode === 'liste_exos'\n        ? 'hidden'\n        : 'h-[10%]'}  w-full flex flex-col justify-center items-center\"\n    >\n      <!-- titre de la feuille -->\n      {#if typeof $globalOptions.title === 'string' && $globalOptions.title.length > 0}\n        <div\n          class=\"w-full p-8 text-center text-4xl font-light {$globalOptions.recorder ===\n          'capytale'\n            ? 'bg-black'\n            : 'bg-coopmaths-struct'} dark:bg-coopmathsdark-struct text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n        >\n          {$globalOptions.title}\n        </div>\n      {/if}\n      <!-- barre de navigation -->\n      <div\n        id=\"navigationHeaderID\"\n        class=\"grid justify-items-center w-full mt-4 mb-8\n          {($globalOptions.presMode === 'un_exo_par_page' &&\n          !$isMenuNeededForExercises) ||\n        ($globalOptions.presMode === 'une_question_par_page' &&\n          !$isMenuNeededForQuestions)\n          ? 'border-b-2 border-coopmaths-struct'\n          : 'border-b-0'}\n              bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        style=\"grid-template-columns: repeat({$globalOptions.presMode ===\n        'un_exo_par_page'\n          ? $exercicesParams.length\n          : questions.length}, minmax(0, 1fr));\"\n      >\n        {#if $globalOptions.presMode === 'un_exo_par_page' && !$isMenuNeededForExercises}\n          {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n            <div class=\"\">\n              <button\n                class=\"relative group {currentIndex === i\n                  ? 'border-b-4'\n                  : 'border-b-0'} border-coopmaths-struct dark:border-coopmathsdark-struct text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                disabled={currentIndex === i}\n                on:click={() => handleIndexChange(i)}\n              >\n                <div\n                  id=\"exerciseTitleID{i}\"\n                  class=\"pt-2 pb-4 px-6 text-xl font-light\"\n                >\n                  {exerciseTitle}\n                  {i + 1}\n                  {#if $resultsByExercice[i] !== undefined}\n                    <div\n                      style=\"--nbPoints:{$resultsByExercice[i]\n                        .bestScore}; --nbQuestions:{$resultsByExercice[i]\n                        .numberOfQuestions};\"\n                      class=\"absolute bottom-0 left-0 right-0 mx-auto text-xs font-bold progressbar text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n                    >\n                      {$resultsByExercice[i].bestScore +\n                        '/' +\n                        $resultsByExercice[i].numberOfQuestions}\n                    </div>\n                  {/if}\n                </div>\n                <span\n                  class=\"absolute -bottom-1 left-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n                <span\n                  class=\"absolute -bottom-1 right-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n              </button>\n            </div>\n          {/each}\n        {/if}\n        {#if $globalOptions.presMode === 'une_question_par_page' && !$isMenuNeededForQuestions}\n          {#each questions as question, i (i + '_' + question)}\n            <div class=\"\">\n              <button\n                class=\"relative group {currentIndex === i\n                  ? 'border-b-4'\n                  : 'border-b-0'} border-coopmaths-struct dark:border-coopmathsdark-struct text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                disabled={currentIndex === i}\n                on:click={() => handleIndexChange(i)}\n              >\n                <div\n                  id=\"questionTitleID{i}\"\n                  class=\"py-2 px-2 text-xl font-light\"\n                >\n                  {questionTitle}\n                  {i + 1}\n                  {#if $resultsByExercice[i] !== undefined}\n                    <div\n                      class=\"absolute left-0 right-0 mx-auto bottom-1 h-2 w-2 rounded-full bg-coopmaths-warn\n                      {resultsByQuestion[i] === true ? '' : 'invisible'}\"\n                    ></div>\n                    <div\n                      class=\"absolute left-0 right-0 mx-auto bottom-1 h-2 w-2 rounded-full bg-red-600\n                      {resultsByQuestion[i] === false ? '' : 'invisible'}\"\n                    ></div>\n                  {/if}\n                </div>\n                <span\n                  class=\"absolute -bottom-1 left-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n                <span\n                  class=\"absolute -bottom-1 right-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n              </button>\n            </div>\n          {/each}\n        {/if}\n      </div>\n    </div>\n    <!-- Exercices -->\n    <div class=\"px-2 lg:px-8\">\n      {#if $globalOptions.presMode === 'un_exo_par_page'}\n        {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n          <div class=\"flex flex-col\">\n            <div class={$isMenuNeededForExercises ? '' : 'hidden'}>\n              <button\n                class=\"w-full {currentIndex === i\n                  ? 'bg-coopmaths-canvas-darkest'\n                  : 'bg-coopmaths-canvas-dark'} hover:bg-coopmaths-canvas-darkest text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                disabled={currentIndex === i}\n                on:click={() => handleIndexChange(i)}\n              >\n                <div\n                  id=\"exerciseTitleID2{i}\"\n                  class=\"flex flex-row items-center justify-center py-3 px-2 text-2xl font-bold\"\n                >\n                  Exercice {i + 1}\n                  {#if $resultsByExercice[i] !== undefined}\n                    <div\n                      class=\"ml-4 text-sm font-bold text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n                    >\n                      {$resultsByExercice[i].numberOfPoints +\n                        '/' +\n                        $resultsByExercice[i].numberOfQuestions}\n                    </div>\n                  {:else}\n                    <div class=\"ml-4 text-sm font-bold invisible\">8/8</div>\n                  {/if}\n                </div>\n              </button>\n            </div>\n            <div class={currentIndex === i ? '' : 'hidden'}>\n              <Exercice\n                {paramsExercice}\n                indiceExercice={i}\n                indiceLastExercice={$exercicesParams.length - 1}\n                isCorrectionVisible={isCorrectionVisible[i]}\n                toggleSidenav={() => {}}\n              />\n            </div>\n          </div>\n        {/each}\n      {:else if $globalOptions.presMode === 'liste_exos'}\n        <div\n          id=\"exercises-list\"\n          class=\"p-4 columns-1 {$globalOptions.twoColumns\n            ? 'md:columns-2'\n            : ''}\"\n        >\n          {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n            <div class=\"break-inside-avoid-column\">\n              <Exercice\n                {paramsExercice}\n                indiceExercice={i}\n                indiceLastExercice={$exercicesParams.length - 1}\n                isCorrectionVisible={isCorrectionVisible[i]}\n                toggleSidenav={() => {}}\n              />\n            </div>\n          {/each}\n        </div>\n      {:else if $globalOptions.presMode === 'recto' || $globalOptions.presMode === 'verso'}\n        <div\n          id=\"exercises-list\"\n          class=\"p-4 columns-1 {$globalOptions.twoColumns\n            ? 'md:columns-2'\n            : ''}\"\n        >\n          {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n            <div class=\"break-inside-avoid-column\">\n              <Exercice\n                {paramsExercice}\n                indiceExercice={i}\n                indiceLastExercice={$exercicesParams.length - 1}\n                isCorrectionVisible={$globalOptions.presMode === 'verso'}\n                toggleSidenav={() => {}}\n              />\n            </div>\n          {/each}\n        </div>\n      {:else if $globalOptions.presMode === 'une_question_par_page'}\n        <div>\n          {#each questions as question, k (k + '_' + question)}\n            <div class=\"flex flex-col\">\n              <div class={$isMenuNeededForQuestions ? '' : 'hidden'}>\n                <button\n                  class=\"group w-full {currentIndex === k\n                    ? 'bg-coopmaths-canvas-darkest'\n                    : 'bg-coopmaths-canvas-dark'} hover:bg-coopmaths-canvas-darkest text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                  disabled={currentIndex === k}\n                  on:click={() => handleIndexChange(k)}\n                >\n                  <div\n                    id=\"questionTitleID2{k}\"\n                    class=\"flex flex-row items-center justify-center py-3 px-2 text-xl font-bold\"\n                  >\n                    Question {k + 1}\n                    <div\n                      class=\"relative ml-2 h-2 w-2 rounded-full {currentIndex ===\n                      k\n                        ? 'bg-coopmaths-canvas-darkest'\n                        : 'bg-coopmaths-canvas-dark'} group-hover:bg-coopmaths-canvas-darkest\"\n                    >\n                      {#if $resultsByExercice[k] !== undefined}\n                        <div\n                          class=\"absolute h-2 w-2 rounded-full bg-coopmaths-warn {resultsByQuestion[\n                            k\n                          ] === true\n                            ? ''\n                            : 'hidden'}\"\n                        ></div>\n                        <div\n                          class=\"absolute h-2 w-2 rounded-full bg-red-600 {resultsByQuestion[\n                            k\n                          ] === false\n                            ? ''\n                            : 'hidden'}\"\n                        ></div>\n                      {/if}\n                    </div>\n                  </div>\n                </button>\n              </div>\n              <div\n                class={currentIndex === k ? '' : 'hidden'}\n                id={`exercice${indiceExercice[k]}Q${k}`}\n              >\n                <div\n                  class=\"pb-4 flex flex-col items-start justify-start relative {isMenuNeededForQuestions\n                    ? 'lg:mt-2'\n                    : ''}\"\n                >\n                  {#if typeof questions[k] !== 'string'}\n                    {''}\n                    <Exercice\n                      paramsExercice={$exercicesParams[indiceExercice[k]]}\n                      indiceExercice={indiceExercice[k]}\n                      indiceLastExercice={$exercicesParams.length - 1}\n                      isCorrectionVisible={isCorrectionVisible[\n                        indiceExercice[k]\n                      ]}\n                      toggleSidenav={() => {}}\n                    />\n                  {:else}\n                    <div\n                      class=\"container grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-10\"\n                      style=\"font-size: {($globalOptions.z || 1).toString()}rem\"\n                    >\n                      <div class=\"flex flex-col my-2 py-2\">\n                        <div class=\"text-coopmaths-corpus pl-2\">\n                          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                          {@html consignes[k]}\n                        </div>\n                        <div class=\"text-coopmaths-corpus pl-2\">\n                          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                          {@html question}\n                        </div>\n                      </div>\n                      {#if isCorrectionVisible[k]}\n                        <div\n                          class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-2 lg:{$isMenuNeededForQuestions\n                            ? 'mt-6'\n                            : 'mt-2'} mb-6 py-2 pl-4\"\n                          style=\"break-inside:avoid\"\n                          bind:this={divsCorrection[k]}\n                        >\n                          {#if consignesCorrections[k].length !== 0}\n                            <div\n                              class=\"container bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark px-4 py-2 mr-2 ml-6 mb-2 font-light relative w-2/3\"\n                            >\n                              <div class=\"container absolute top-4 -left-4\">\n                                <i\n                                  class=\"bx bx-bulb scale-200 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n                                ></i>\n                              </div>\n                              <div class=\"\">\n                                <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                                {@html consignesCorrections[k]}\n                              </div>\n                            </div>\n                          {/if}\n                          <div\n                            class=\"container overflow-x-auto overflow-y-hidden md:overflow-x-auto\"\n                            style=\"break-inside:avoid\"\n                          >\n                            <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                            {@html mathaleaFormatExercice(corrections[k])}\n                          </div>\n                          <!-- <div class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct top-0 left-0 border-b-[3px] w-10\" /> -->\n                          <div\n                            class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n                          >\n                            Correction\n                          </div>\n                          <div\n                            class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n                          ></div>\n                        </div>\n                      {/if}\n                    </div>\n                  {/if}\n                  {#if exercices[indiceExercice[k]].interactif && exercices[indiceExercice[k]].interactifReady}\n                    <div class=\"pb-4 mt-10\">\n                      <ButtonTextAction\n                        text=\"Vrifier\"\n                        on:click={() => checkQuestion(k)}\n                        disabled={isDisabledButton[k]}\n                      />\n                    </div>\n                  {:else if $globalOptions.isSolutionAccessible && corrections[k]}\n                    <div class={$isMenuNeededForExercises ? 'ml-4' : ''}>\n                      <ButtonToggle\n                        titles={['Voir la correction', 'Masquer la correction']}\n                        on:toggle={() => switchCorrectionVisible(k)}\n                      />\n                    </div>\n                  {/if}\n                </div>\n              </div>\n            </div>\n          {/each}\n        </div>\n      {:else if $globalOptions.presMode === 'cartes'}\n        <div\n          class=\"grid grid-flow-row gri-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 auto-rows-auto gap-6\"\n        >\n          {#each questions as question, k (k + '_' + question)}\n            <FlipCard>\n              <div slot=\"question\">\n                <div class=\"p-2\">\n                  <div class=\"text-coopmaths-corpus pl-2\">\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html consignes[k]}\n                  </div>\n                  <div class=\"text-coopmaths-corpus pl-2\">\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html question}\n                  </div>\n                </div>\n              </div>\n              <div slot=\"answer\">\n                <div class=\"p-2\">\n                  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                  {@html mathaleaFormatExercice(corrections[k])}\n                </div>\n              </div>\n            </FlipCard>\n          {/each}\n        </div>\n      {/if}\n    </div>\n  </div>\n  <Keyboard />\n  {#if $globalOptions.v !== 'myriade' && $globalOptions.v !== 'indices'}\n    <div\n      class=\"flex justify-center w-full {$keyboardState.isVisible\n        ? 'mt-52'\n        : ''}\"\n    >\n      <Footer2 />\n    </div>\n  {/if}\n</section>\n\n<style>\n  /* sur une ide de Mathieu Degrange */\n  .progressbar {\n    background: linear-gradient(\n      90deg,\n      #6ebc1f 0%,\n      #6ebc1f calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #d43d0e calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #d43d0e 100%\n    );\n  }\n  :global(.dark) .progressbar {\n    background: linear-gradient(\n      90deg,\n      #ff94d1 0%,\n      #ff94d1 calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #ff9523 calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #ff9523 100%\n    );\n  }\n</style>\n","import type { IExercice, InterfaceParams } from '../lib/types'\n\ninterface Items {\n  [key: string]: string\n}\n\ninterface DocumentsEntity {\n  title: string\n  items: string[]\n  number?: number\n}\n\nexport interface UserSettings {\n  items: Items\n  documents: DocumentsEntity[]\n}\n\nexport interface itemsWithExercises {\n  [key: string]: IExercice[]\n}\n\nexport function handleUrl(url: URL) {\n  const entries = url.searchParams.entries()\n  let indiceExercice = -1\n  const newExercisesParams: InterfaceParams[] = []\n  for (const entry of entries) {\n    if (entry[0] === 'uuid') {\n      indiceExercice++\n      const uuid = entry[1]\n      if (!newExercisesParams[indiceExercice])\n        newExercisesParams[indiceExercice] = { uuid }\n      newExercisesParams[indiceExercice].uuid = uuid // string\n      newExercisesParams[indiceExercice].interactif = '0' // par dfaut\n    } else if (entry[0] === 'n') {\n      newExercisesParams[indiceExercice].nbQuestions = parseInt(entry[1]) // int\n    } else if (entry[0] === 's') {\n      newExercisesParams[indiceExercice].sup = entry[1]\n    } else if (entry[0] === 's2') {\n      newExercisesParams[indiceExercice].sup2 = entry[1]\n    } else if (entry[0] === 's3') {\n      newExercisesParams[indiceExercice].sup3 = entry[1]\n    } else if (entry[0] === 's4') {\n      newExercisesParams[indiceExercice].sup4 = entry[1]\n    } else if (entry[0] === 's5') {\n      newExercisesParams[indiceExercice].sup5 = entry[1]\n    } else if (entry[0] === 'alea') {\n      newExercisesParams[indiceExercice].alea = entry[1]\n    } else if (entry[0] === 'cols') {\n      newExercisesParams[indiceExercice].cols = parseInt(entry[1])\n    } else if (entry[0] === 'i' && (entry[1] === '0' || entry[1] === '1')) {\n      newExercisesParams[indiceExercice].interactif = entry[1]\n    } else if (entry[0] === 'cd' && (entry[1] === '0' || entry[1] === '1')) {\n      newExercisesParams[indiceExercice].cd = entry[1]\n    }\n  }\n  return newExercisesParams\n}\n\nexport function generateLatex(\n  userSettings: UserSettings,\n  itemsWithExercises: itemsWithExercises,\n) {\n  let output = preambuleLight\n  let outputCorr = '\\n\\n%%%%%%%%%%%%%%%%%%%%'\n  outputCorr += '\\n%%%  CORRECTION  %%%'\n  outputCorr += '\\n%%%%%%%%%%%%%%%%%%%%'\n  outputCorr += '\\n\\n\\\\fancyhead[L]{Correction}'\n  for (const document of userSettings.documents) {\n    const numberOfVersions = document.number || 1\n    for (let i = 0; i < numberOfVersions; i++) {\n      const intro = `\n  \n  %%% ${document.title} %%%\n  \\\\clearpage\n  \\\\fancyhead[R]{${document.title}}\n  \\\\setcounter{numexercice}{0}\n  \n  `\n      output += intro\n      outputCorr += intro\n\n      for (const item of document.items) {\n        if (itemsWithExercises[item]) {\n          for (const exercise of itemsWithExercises[item]) {\n            exercise.reinit()\n            exercise.nouvelleVersion()\n            output += '\\n\\n\\\\exercice{}\\n' + exercise.contenu\n            outputCorr += '\\n\\n\\\\exercice{}\\n' + exercise.contenuCorrection\n          }\n        }\n      }\n    }\n  }\n  outputCorr += '\\n\\n\\\\end{document}'\n  return output + outputCorr\n}\n\nconst preambuleLight = `\n\\\\documentclass[12pt]{article}\n\\\\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}\n\\\\usepackage[utf8]{inputenc}        \n\\\\usepackage[T1]{fontenc}\n\\\\usepackage[french]{babel}\n\\\\usepackage{multicol} \n\\\\usepackage{calc} \n\\\\usepackage{enumerate}\n\\\\usepackage{enumitem}\n\\\\usepackage{graphicx}\n\\\\usepackage{tabularx}\n\\\\usepackage[autolanguage,np]{numprint}\n\\\\usepackage{hyperref}\n\\\\usepackage{amsmath,amsfonts,amssymb,mathrsfs} \n\\\\usepackage{cancel}\n\\\\usepackage{textcomp}\n\\\\usepackage{gensymb}\n\\\\usepackage{eurosym}\n\\\\usepackage{fancyhdr,lastpage}          \n\\\\pagestyle{fancy}                      \n\\\\usepackage{fancybox}\n\\\\usepackage{setspace}\n\\\\usepackage{colortbl}\n\\\\usepackage{xcolor}\n\\\\usepackage{qrcode}\n\\\\usepackage{pgf,tikz}\n\n\\\\setlength{\\\\parindent}{0mm}\n\\\\renewcommand{\\\\arraystretch}{1.5}\n\\\\renewcommand{\\\\labelenumi}{\\\\textbf{\\\\theenumi{}.}}\n\\\\renewcommand{\\\\labelenumii}{\\\\textbf{\\\\theenumii{}.}}\n\\\\newcommand{\\\\version}[1]{\\\\fancyhead[R]{Version #1}}\n\\\\setlength{\\\\headheight}{14.5pt}\n\n\\\\newcounter{numexercice}\n\\\\setcounter{numexercice}{0}\n\\\\newcommand{\\\\exercice}{\n  \\\\stepcounter{numexercice}\n  \\\\subsection*{Exercice \\\\thenumexercice}\n}\n\n\\\\fancyhead[C]{valuation  la carte}\n\\\\fancyfoot{}\n\\\\fancyhead[R]{}\n\n\\\\renewcommand{\\\\headrulewidth}{0.4pt}\n\n\\\\begin{document}\n`\n","<script>\n  import { keyboardState } from './keyboard/stores/keyboardStore'\n</script>\n\n<footer\n  class=\"{$keyboardState.isVisible\n    ? 'pt-48 md:pt-60'\n    : 'pt-4'} w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas h-12 flex flex-row-reverse justify-center items-center opacity-100 pb-4 px-4\"\n>\n  <a href=\"https://coopmaths.fr/www/mentions_legales/\" target=\"_blank\">\n    <img\n      class=\"hidden md:block px-6\"\n      style=\"height: 20px\"\n      src=\"assets/images/logo2.png\"\n      alt=\"Logo Coopmaths 2\"\n    />\n  </a>\n  <!-- <a\n    class=\"flex flex-row items-center justify-start pr-6 font-thin text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n    href=\"https://mathstodon.xyz/@coopmaths\"\n    target=\"_blank\"\n  >\n    <i class=\"bx bx-sm bxl-mastodon\" />\n  </a> -->\n  <a\n    class=\"flex flex-row items-center justify-start pr-6 font-thin text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n    href=\"mailto:contact@coopmaths.fr\"\n    aria-label=\"Envoyer un email  Coopmaths\"\n  >\n    <i class=\"bx bx-sm bx-envelope\"></i>\n  </a>\n</footer>\n","import { saveAs } from 'file-saver'\nimport JSZip from 'jszip'\nimport JSZipUtils from 'jszip-utils'\nimport {\n  buildImagesUrlsList,\n  doesLatexNeedsPics,\n  getExosContentList,\n  getPicsNames,\n} from './Latex'\nimport { type latexFileType } from './LatexTypes'\nimport type { IExercice } from './types'\n\nexport function downloadZip(filesUrls: string[], zipFileName: string) {\n  const zip = new JSZip()\n  let count = 0\n  filesUrls.forEach((url) => {\n    JSZipUtils.getBinaryContent(url, (err, data) => {\n      if (err) {\n        throw err\n      }\n      const splitUrl = url.split('/')\n      const fileName = splitUrl[splitUrl.length - 1]\n      zip.file(fileName, data ?? '', { binary: true })\n      count++\n      if (count === filesUrls.length) {\n        zip.generateAsync({ type: 'blob' }).then((content) => {\n          saveAs(content, zipFileName)\n        })\n      }\n    })\n  })\n}\n\n/**\n * Construit l'archive ZIP contenant le code LaTeX et tous les fichiers images ncessaires pour la compilation du code LaTeX\n * @param {string} zipFileName nom donn pour l'archive\n * @param {Latex} latex objet Latex contenant les donnes des exercices\n * @param {LatexFileInfos} filesInfo paramtres du fichier LaTeX  gnrer\n * @author sylvain\n */\nexport async function downloadTexWithImagesZip(\n  zipFileName: string,\n  latexFile: latexFileType,\n  exercices: IExercice[],\n) {\n  const zip = new JSZip()\n  const withImages = doesLatexNeedsPics(latexFile.contents)\n  const exosContentList = getExosContentList(exercices)\n  const picsNames = getPicsNames(exosContentList)\n  zip.file('main.tex', latexFile.latexWithPreamble)\n  if (withImages) {\n    const urls = buildImagesUrlsList(exosContentList, picsNames)\n    const imagesFolder = zip.folder('images')\n    let count = 0\n    urls.forEach((url) => {\n      JSZipUtils.getBinaryContent(url, (err, data) => {\n        if (err) {\n          throw err\n        }\n        const splitUrl = url.split('/')\n        const fileName = splitUrl[splitUrl.length - 1]\n        imagesFolder?.file(fileName, data ?? '', { binary: true })\n        count++\n        if (count === urls.length) {\n          zip.generateAsync({ type: 'blob' }).then((content) => {\n            // saveAs(content, [archiveName.replace(/\\.(?:.*)$/g, \"\"), \"zip\"].join(\".\"))\n            saveAs(content, [zipFileName, 'zip'].join('.'))\n          })\n        }\n      })\n    })\n  } else {\n    zip.generateAsync({ type: 'blob' }).then((content) => {\n      saveAs(content, [zipFileName, 'zip'].join('.'))\n    })\n  }\n}\n\nexport async function downloadFile(\n  content: string,\n  fileName: string,\n): Promise<'success' | 'error'> {\n  try {\n    const element = document.createElement('a')\n    element.setAttribute(\n      'href',\n      'data:text/plain;charset=utf-8,' + encodeURIComponent(content),\n    )\n    element.setAttribute('download', fileName)\n    element.style.display = 'none'\n    document.body.appendChild(element)\n    element.click()\n    document.body.removeChild(element)\n  } catch (error) {\n    console.error('Impossible de tlcharger le fichier', error)\n    return 'error'\n  }\n  return 'success'\n}\n","<script lang=\"ts\">\n  import BasicClassicModal from './BasicClassicModal.svelte'\n\n  export let contentDisplayed: 'success' | 'error' | 'none' //  bind avec le parent\n  export let successMessage: string\n  export let errorMessage: string\n  export let displayDuration: number = 3000\n\n  let isSuccessDisplayed: boolean\n  $: if (contentDisplayed === 'success') {\n    isSuccessDisplayed = true\n    setTimeout(() => {\n      contentDisplayed = 'none'\n    }, displayDuration)\n  }\n\n  let isErrorDisplayed: boolean\n  $: if (contentDisplayed === 'error') {\n    isErrorDisplayed = true\n    setTimeout(() => {\n      contentDisplayed = 'none'\n    }, displayDuration)\n  }\n\n  $: if (contentDisplayed === 'none') {\n    isSuccessDisplayed = false\n    isErrorDisplayed = false\n  }\n</script>\n\n<BasicClassicModal\n  isWithCloseButton={false}\n  bind:isDisplayed={isSuccessDisplayed}\n  on:close={() => (contentDisplayed = 'none')}\n>\n  <div slot=\"content\">\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html successMessage}\n  </div>\n</BasicClassicModal>\n\n<BasicClassicModal\n  isWithCloseButton={false}\n  bind:isDisplayed={isErrorDisplayed}\n  on:close={() => (contentDisplayed = 'none')}\n>\n  <div slot=\"content\">\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html errorMessage}\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import { buildMathAleaURL } from '../../../lib/components/urls'\n  import { downloadFile } from '../../../lib/files'\n  import BasicInfoModal from '../modal/BasicInfoModal.svelte'\n  import ButtonIconTooltip from './ButtonIconTooltip.svelte'\n  import ButtonTextAction from './ButtonTextAction.svelte'\n\n  export let action: 'copy' | 'download'\n  export let textToCopy: string = ''\n  export let urlToDownload: string = ''\n  export let fileName: string = 'mathAlea'\n  export let useCurrentUrl: boolean = false\n  export let removeSeed: boolean = false\n\n  export let icon: string = ''\n  export let tooltip: string = ''\n  export let disabled: boolean = false\n  export let floatUnderText: string = ''\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n\n  export let text: string = ''\n  export let title: string = ''\n  export let inverted: boolean = false\n\n  export let successMessage: string = 'Copi dans le presse-papier'\n  export let errorMessage: string =\n    'Une erreur est survenue lors de la copie dans le presse-papier.'\n  export let displayDuration: number = 3000\n\n  let contentDisplayed: 'success' | 'error' | 'none' = 'none'\n\n  let actionFunction: () => void\n  $: actionFunction = action === 'copy' ? copyToClipboard : download\n\n  // Reactive statement to update actionFunction when textToCopy changes\n  $: if (action === 'copy') {\n    actionFunction = copyToClipboard\n  } else {\n    actionFunction = download\n  }\n\n  function copyToClipboard() {\n    if (textToCopy === '' && !useCurrentUrl) {\n      console.error('Le texte  copier est vide')\n      contentDisplayed = 'error'\n      return\n    }\n    navigator.clipboard\n      .writeText(\n        useCurrentUrl\n          ? buildMathAleaURL({ removeSeed }).toString()\n          : textToCopy,\n      )\n      .then(\n        () => {\n          contentDisplayed = 'success'\n        },\n        (err) => {\n          console.error(\n            'Impossible de copier le texte dans le presse-papier',\n            err,\n          )\n          contentDisplayed = 'error'\n        },\n      )\n  }\n\n  function download() {\n    if (urlToDownload === '' && !useCurrentUrl) {\n      console.error(\"L'URL  tlcharger est vide\")\n      return\n    }\n    const text = `<html><head><meta http-equiv=\"refresh\" content=\"0;URL=${encodeURI(useCurrentUrl ? buildMathAleaURL({}).toString() : urlToDownload)}\"></head></html>`\n    downloadFile(text, `${fileName}.html`).then((returnString) => {\n      contentDisplayed = returnString\n    })\n  }\n</script>\n\n{#if text === ''}\n  <ButtonIconTooltip\n    {icon}\n    {tooltip}\n    {disabled}\n    {floatUnderText}\n    {cornerIcon}\n    {cornerIconClass}\n    class={$$props.class || ''}\n    on:click={actionFunction}\n  />\n{:else}\n  <ButtonTextAction\n    {text}\n    {title}\n    {disabled}\n    {icon}\n    {inverted}\n    class={$$props.class || ''}\n    on:click={actionFunction}\n  />\n{/if}\n\n<BasicInfoModal\n  bind:contentDisplayed\n  {successMessage}\n  {errorMessage}\n  {displayDuration}\n/>\n","import type { Language, LanguageDisplay } from '../types/languages'\nimport refToUuidCH from '../../json/refToUuidCH.json'\nimport refToUuidFR from '../../json/refToUuidFR.json'\n\ntype ValueOf<T> = T[keyof T]\nconst REFERENCES_TO_UUIDS_CH = { ...refToUuidCH } as const\nconst REFERENCES_TO_UUIDS_FR = { ...refToUuidFR } as const\ntype ReferencesCH = keyof typeof REFERENCES_TO_UUIDS_CH\ntype UuidsCH = ValueOf<typeof REFERENCES_TO_UUIDS_CH> // on devrait avoir des uuid mais on a que des string :-(\ntype ReferencesFR = keyof typeof REFERENCES_TO_UUIDS_FR\ntype UuidsFR = ValueOf<typeof REFERENCES_TO_UUIDS_FR>\ntype RefUuidPairs =\n  | Record<ReferencesCH, UuidsCH>\n  | Record<ReferencesFR, UuidsFR>\n\nconst allReferencesToUuids: Record<Language, RefUuidPairs> = {\n  'fr-FR': REFERENCES_TO_UUIDS_FR,\n  'fr-CH': REFERENCES_TO_UUIDS_CH,\n}\n\n/**\n * Objet pour associer les lments  afficher au langage slectionn\n */\nexport const languages: LanguageDisplay = {\n  'fr-FR': {\n    short: 'FR',\n    long: 'franais',\n    country: 'France',\n  },\n  'fr-CH': {\n    short: 'CH',\n    long: 'suisse',\n    country: 'Suisse',\n  },\n}\n\n/**\n * Retourne le drapeau correspondant  une langue (symbole alpha ISO du pays)\n * @param country langue slectionne\n * @returns le chemin vers le drapeau correspondant  une langue\n */\nexport const buildLangIconPath = (country: string): string => {\n  if (country.length !== 2) {\n    throw new Error(\n      `ISO country name \"${country}\" should have exactly two characters.`,\n    )\n  } else {\n    return `assets/svg/flags/${country.toLowerCase()}.svg`\n  }\n}\n\n/**\n * Recherche dans le rfrentiel de la langue slectionne si un UUID existe.\n * - si oui, on renvoie la rfrence correspondante\n * - si non, on renvoie la rfrence franaise\n * - si aucune correspondance n'est trouve, on renvoie une chane vide.\n * @param uuid uuid  cherche\n * @param locale langue slectionne sur le site\n * @returns la rfrence correspondant  l'UUID dans le rfrentiel local/franais\n */\nexport const uuidToLocaleRef = (\n  uuid: string,\n  locale: Language = 'fr-FR',\n): string => {\n  let reference = ''\n  if (locale !== 'fr-FR') {\n    // on regarde si la rfrence existe dans le rfrentiel local\n    const values = Object.fromEntries(\n      Object.entries(allReferencesToUuids[locale]).map(([k, v]) => [v, k]),\n    )\n    reference = values[uuid] // undefined si la rfrence n'existe pas\n  }\n  if (reference === undefined || locale === 'fr-FR') {\n    // la recherche prcdente n'a rien donn : on cherche dans le rfrentiel franais\n    const values = Object.fromEntries(\n      Object.entries(allReferencesToUuids['fr-FR']).map(([k, v]) => [v, k]),\n    )\n    reference = values[uuid]\n  }\n  return reference || ''\n}\n","<script lang=\"ts\">\n  import {\n    buildLangIconPath,\n    languages,\n  } from '../../../lib/components/languagesUtils'\n  import type { Language } from '../../../lib/types/languages'\n  export let locale: Language\n</script>\n\n<img\n  src={buildLangIconPath(languages[locale].short)}\n  alt={languages[locale].short}\n  class=\"h-4 w-4\"\n/>\n","<script lang=\"ts\">\n  import { languages } from '../../../lib/components/languagesUtils'\n  import type { Language } from '../../../lib/types/languages'\n  import LanguageIcon from '../ui/LanguageIcon.svelte'\n  import BasicClassicModal from './BasicClassicModal.svelte'\n\n  export let showLanguageChoiceModal: boolean\n  export let handleLanguage: (lang: string) => void\n  export let locale: Language\n</script>\n\n<BasicClassicModal bind:isDisplayed={showLanguageChoiceModal}>\n  <div slot=\"header\" class=\"text-2xl w-full\">Langue du Rfrentiel</div>\n  <div slot=\"content\">\n    <ul class=\"p2 flex flex-col justify-start items-end\">\n      {#each Object.entries(languages) as [loc, lang]}\n        <li\n          class=\"w-full space-x-2 py-2 px-4 font-light bg-coopmaths-canvas dark:bg-coopmathsdark-canvas hover:bg-coopmaths-canvas-dark dark:hover:bg-coopmathsdark-canvas-dark\"\n        >\n          <button\n            type=\"button\"\n            class=\"w-full flex flex-row space-x-2 justify-end items-center text-coopmaths-action dark:text-coopmathsdark-action\"\n            id=\"languageChoice{lang.short}\"\n            on:click={() => {\n              handleLanguage(loc)\n              showLanguageChoiceModal = false\n            }}\n          >\n            <div class=\"flex flex-row items-center\">\n              <i\n                class=\"bx bx-check pr-2 {loc.localeCompare(locale) === 0\n                  ? ''\n                  : 'hidden'}\"\n              ></i>\n              <span>Rfrentiel {lang.long}</span>\n            </div>\n            <div>\n              <LanguageIcon locale={loc} />\n            </div>\n          </button>\n        </li>\n      {/each}\n    </ul>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import type { Language } from '../../../lib/types/languages'\n  import { languages } from '../../../lib/components/languagesUtils'\n  import LanguageIcon from './LanguageIcon.svelte'\n  export let locale: Language\n  let isMenuOpen: boolean = false\n  export let handleLanguage: (lang: string) => void\n</script>\n\n<div class=\"w-full group inline-block relative\">\n  <button\n    type=\"button\"\n    class=\"flex flex-row justify-start items-center\"\n    on:click={() => {\n      isMenuOpen = !isMenuOpen\n    }}\n  >\n    <LanguageIcon {locale} />\n    <i\n      class=\"bx bx-chevron-down {isMenuOpen\n        ? 'rotate-180'\n        : 'rotate-0'} transition-transform ease-in-out duration-300 text-coopmaths-action dark:text-coopmathsdark-action\"\n    ></i>\n  </button>\n  <ul\n    id=\"languageChoiceMenu\"\n    class=\"{isMenuOpen ? '' : 'hidden'}\n    w-full relative md:absolute md:top-5 md:right-0 min-w-[15rem] flex flex-col justify-start items-end shadow-lg\"\n  >\n    {#each Object.entries(languages) as [loc, lang]}\n      <li\n        class=\"w-full space-x-2 py-2 px-4 font-light bg-coopmaths-canvas dark:bg-coopmathsdark-canvas hover:bg-coopmaths-canvas-dark dark:hover:bg-coopmathsdark-canvas-dark\"\n      >\n        <button\n          type=\"button\"\n          class=\"w-full flex flex-row space-x-2 justify-end items-center text-coopmaths-action dark:text-coopmathsdark-action\"\n          id=\"languageChoice{lang.short}\"\n          on:click={() => {\n            handleLanguage(loc)\n            isMenuOpen = false\n          }}\n        >\n          <div class=\"flex flex-row items-center\">\n            <i\n              class=\"bx bx-check pr-2 {loc.localeCompare(locale) === 0\n                ? ''\n                : 'hidden'}\"\n            ></i>\n            <span>Rfrentiel {lang.long}</span>\n          </div>\n          <div>\n            <LanguageIcon locale={loc} />\n          </div>\n        </button>\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script lang=\"ts\">\n  import { languages } from '../../../lib/components/languagesUtils'\n  import type { Language } from '../../../lib/types/languages'\n  export let locale: Language\n</script>\n\n<div\n  class={`${$$props.class || ''} relative flex justify-center items-center  text-coopmaths-struct dark:text-coopmathsdark-struct`}\n>\n  <i class=\"bx bx-sm bx-world\"></i>\n  <div class=\"absolute -bottom-1 -right-1 text-xs font-bold font-mono\">\n    {languages[locale].short}\n  </div>\n</div>\n","<script lang=\"ts\">\n  export let subtitle: string = ''\n  export let type: 'export' | 'design' = 'export'\n</script>\n\n<!--\n  @component\n  Sous-titre du header de NavBarV2\n\n  __Paramtres__ :\n\n  * `subtitle` :  titre du groupe de boutons\n  * `type`: `export`(dfaut) ou `design`\n\n  __Exemple__ :\n\n    ```tsx\n  <NavBarV2Subtitle\n    subtitle = \"Mon sous-titre\"\n    type = \"design\"\n  />\n  ```\n -->\n<div\n  class=\"flex flex-row items-center align-middle font-logo9 tracking-tighter ml-4\n  pt-6 md:pt-0\n  text-lg md:text-3xl xl:text-5xl\"\n>\n  <div\n    class=\"font-light\n    pl-0 md:pl-10\n    text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n  >\n    <i\n      class={type === 'export'\n        ? 'bx bx-export rotate-90 md:translate-y-1'\n        : 'hidden'}\n    ></i>\n    <i\n      class={type === 'design'\n        ? 'bx bx-chevron-right md:translate-y-1'\n        : 'hidden'}\n    ></i>\n  </div>\n  <div\n    class=\"font-black\n    ml-1 md:ml-3 xl:ml-5\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    {subtitle}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { mathaleaGoToView } from '../../../lib/mathaleaUtils'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import {\n    VUES_WITH_LANG_STATUS_ONLY,\n    type Language,\n  } from '../../../lib/types/languages'\n  import ButtonIcon from '../forms/ButtonIcon.svelte'\n  import ButtonToggleDarkMode from '../forms/ButtonToggleDarkMode.svelte'\n  import ModalLanguageChoice from '../modal/ModalLanguageChoice.svelte'\n  import LanguageDropdown from '../ui/LanguageDropdown.svelte'\n  import LanguageIcon from '../ui/LanguageIcon.svelte'\n  import LanguageStatus from '../ui/LanguageStatus.svelte'\n  import NavBarSubtitle from './NavBarSubtitle.svelte'\n\n  export let title: string = 'MathALA'\n  export let subtitle: string = ''\n  export let subtitleType: 'export' | 'design' = 'export'\n  export let locale: Language\n  export let handleLanguage: (lang: string) => void\n\n  let showLanguageChoiceModal: boolean = false\n</script>\n\n<!--\n  @component\n  Barre de titre pour une section du site positionne en haut dans la page.\n  Contient un titre pour l'endroit du site (MathALA, etc.),\n  un sous titre pour indiquer la section (export, ), un bouton pour grer le mode sombre et ventuellement\n  un bouton pour fermer (c'est--dire revenir  la page d'accueil de la section.)\n\n  ### Paramtres\n\n  * `title` : le titre de la page (`MathALA` par dfaut)\n  * `subtitle` : son sous-titre\n  * `subTItleType` : mot indiquant le type de la section pour dcider de l'affichage (seulelemnt deux mode `export` et `design`)\n\n  ### Exemple\n\n  ```tsx\n    <NavBarV2 subtitle=\"Conception de document\" subtitleType=\"design\" />\n  ```\n -->\n\n<nav\n  class=\"p-4\n  md:h-[120px]\n  bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  <!-- container -->\n  <div\n    class=\"flex flex-row justify-between items-start w-full mx-auto\n    space-x-0 md:space-x-6\"\n  >\n    <div\n      class=\"flex justify-start flex-col\n      space-x-0 md:space-x-2\"\n    >\n      <div\n        class=\"flex align-middle\n        flex-col md:flex-row\"\n      >\n        <div>\n          <div\n            on:click={() => mathaleaGoToView('')}\n            on:keydown={() => mathaleaGoToView('')}\n            role=\"link\"\n            tabindex=\"0\"\n            class=\"relative inline-flex font-logo9 tracking-tighter font-black\n            text-3xl md:text-6xl\n            {subtitleType === 'design'\n              ? 'text-coopmaths-struct dark:text-coopmathsdark-struct'\n              : `cursor-pointer\n                text-coopmaths-action dark:text-coopmathsdark-action\n                hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest`}\"\n          >\n            {title}\n          </div>\n          <div\n            class=\"absolute ml-3 -mt-1 font-light text-sm\n              text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n          >\n            <span class=\"font-light font-sans tracking-normal\">par</span>\n            <a\n              href=\"https://coopmaths.fr\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n              class=\"font-extrabold font-logo9 tracking-tighter\n                text-coopmaths-action dark:text-coopmathsdark-action\n                hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n            >\n              CoopMaths\n            </a>\n          </div>\n        </div>\n        <NavBarSubtitle {subtitle} type={subtitleType} />\n      </div>\n    </div>\n    <div\n      class=\"flex flex-row space-x-4 pt-2\n      pr-0 md:pr-4\"\n    >\n      {#if $globalOptions.v && VUES_WITH_LANG_STATUS_ONLY.includes($globalOptions.v)}\n        <LanguageStatus {locale} />\n      {:else}\n        <!-- Menu droulant en mode desktop -->\n        <div class=\"hidden md:block\">\n          <LanguageDropdown {locale} {handleLanguage} />\n        </div>\n        <!-- En mode smartphone bouton commandant un dialogue -->\n        <div class=\"md:hidden\">\n          <button\n            type=\"button\"\n            on:click={() => {\n              showLanguageChoiceModal = !showLanguageChoiceModal\n            }}\n          >\n            <LanguageIcon {locale} />\n          </button>\n        </div>\n      {/if}\n      <ButtonToggleDarkMode />\n      {#if $globalOptions.v !== ''}\n        <ButtonIcon\n          icon=\"bx-x {subtitleType === 'design' ? 'hidden' : ''}\"\n          class=\"text-3xl\"\n          on:click={() => {\n            mathaleaGoToView('')\n          }}\n        />\n      {/if}\n    </div>\n  </div>\n</nav>\n<ModalLanguageChoice bind:showLanguageChoiceModal {locale} {handleLanguage} />\n","<script lang=\"ts\">\n  import { writable } from 'svelte/store'\n  import { generateLatex, handleUrl } from '../../../lib/alacarte'\n  import { mathaleaGetExercicesFromParams } from '../../../lib/mathalea'\n  import { darkMode } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import type { IExercice } from '../../../lib/types'\n  import Footer from '../../Footer.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n\n  const userInput = writable('')\n  const latexOutput = writable('')\n\n  const itemsWithExercises: { [key: string]: IExercice[] } = {}\n\n  function formatUserInput() {\n    try {\n      const parsedInput = JSON.parse($userInput)\n      userInput.set(JSON.stringify(parsedInput, null, 4))\n      return true\n    } catch (e) {\n      console.info('JSON non valide')\n      return false\n    }\n  }\n\n  async function handleValidate() {\n    if (!formatUserInput()) {\n      alert('JSON invalide')\n      return\n    }\n    const userSettings = JSON.parse($userInput)\n    const items = userSettings?.items ?? {}\n    for (const item in items) {\n      if (typeof items[item] === 'string') {\n        const url = new URL(items[item])\n        const exercisesParams = handleUrl(url)\n        const exercises = await mathaleaGetExercicesFromParams(exercisesParams)\n        itemsWithExercises[item] = exercises\n      }\n    }\n    const content = generateLatex(userSettings, itemsWithExercises)\n    latexOutput.set(content)\n    navigator.clipboard\n      .writeText(content)\n      .then(() => {\n        alert('Code LaTeX copi dans le presse-papiers')\n      })\n      .catch((err) => {\n        console.error('Erreur lors de la copie dans le presse-papiers: ', err)\n      })\n  }\n\n  function handleKeyDownUserInput(event: KeyboardEvent) {\n    if (event.key === 'Tab') {\n      event.preventDefault()\n    }\n  }\n\n  const defaultValueForUserInput = `{\n    \"items\": {\n        \"Pythagore\": \"https://coopmaths.fr/alea/?uuid=bd660&id=4G20&n=1&d=10&s=3&s2=3&s3=false&alea=DEW7&cd=1&uuid=40c47&id=4G20-1&n=1&d=10&s=1&s2=3&s3=false&alea=scAR&cd=1\",\n        \"Relatifs\": \"https://coopmaths.fr/alea/?uuid=745ba&id=4C10&alea=Vlug\"\n    },\n    \"documents\": [\n        {\n            \"title\": \"lve 1\",\n            \"items\": [\n                \"Pythagore\"\n            ],\n            \"number\": 2\n        },\n        {\n            \"title\": \"lve 2\",\n            \"items\": [\n                \"Pythagore\",\n                \"Relatifs\"\n            ],\n            \"number\": 2\n        }\n    ]\n}`\n\n  userInput.set(defaultValueForUserInput)\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\" la carte\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n\n  <section\n    class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <textarea\n      bind:value={$userInput}\n      class=\"w-full p-2 border rounded mb-5\"\n      rows=\"10\"\n      placeholder=\"\"\n      on:keydown={handleKeyDownUserInput}\n    ></textarea>\n\n    <ButtonTextAction text=\"Valider\" on:click={handleValidate} />\n\n    <ButtonActionInfo\n      action=\"copy\"\n      textToCopy={$latexOutput}\n      text=\"Copier le code\"\n      successMessage=\"Code LaTeX copi\"\n      errorMessage=\"Impossible de copier le code LaTeX dans le presse-papier\"\n      class=\"px-2 py-1 rounded-md\"\n    />\n\n    <pre\n      class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-y-auto overflow-x-scroll text-xs\">\n      {$latexOutput}\n    </pre>\n  </section>\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","import { elimineDoublons } from '../../lib/interactif/qcm'\nimport { randint } from '../../modules/outils'\nimport { format as formatLatex } from '../Latex'\nimport {\n  arrondi,\n  nombreDeChiffresDansLaPartieDecimale,\n  nombreDeChiffresDansLaPartieEntiere,\n  nombreDeChiffresDe,\n} from '../outils/nombres'\nimport { lettreDepuisChiffre } from '../outils/outilString'\nimport { decimalToScientifique } from '../outils/texNombre'\n\n/**\n *\n * @param {array} exercice TypeExercice\n * @param {number} idExo c'est un numro unique pour grer les noms des lments d'un groupe de question, il est incrment par creerDocumentAmc()\n */\n\nexport function exportQcmAmc(exercice, idExo) {\n  let ref = `${exercice.id}/${exercice.sup ? 'S:' + exercice.sup : ''}${exercice.sup2 ? 'S2:' + exercice.sup2 : ''}${exercice.sup3 ? 'S3:' + exercice.sup3 : ''}${exercice.sup4 ? 'S4:' + exercice.sup4 : ''}${exercice.sup5 ? 'S5:' + exercice.sup5 : ''}`\n  if (ref[ref.length - 1] === '/') ref = ref.slice(0, -1)\n  const autoCorrection = exercice.autoCorrection\n  const titre = exercice.titre\n  const type = exercice.amcType\n  let texQr = ''\n  let id = 0\n  let horizontalite = 'reponseshoriz'\n  let lastchoice = false\n  let ordered = false\n  let nbChiffresPd, nbChiffresPe\n  let melange = true\n  let sautDeLigneApresEnonce\n  for (let j = 0; j < autoCorrection.length; j++) {\n    if (autoCorrection[j] === undefined) {\n      // normalement, cela ne devrait jamais arriver !\n      autoCorrection[j] = {}\n    }\n    if (autoCorrection[j].options !== undefined) {\n      if (autoCorrection[j].options.vertical === undefined) {\n        horizontalite = 'reponseshoriz'\n      } else {\n        horizontalite = 'reponses'\n      }\n      if (autoCorrection[j].options.ordered) {\n        ordered = true\n      }\n      if (autoCorrection[j].options.lastChoice !== undefined) {\n        lastchoice = autoCorrection[j].options.lastChoice\n      }\n    }\n    let valeurAMCNum = 0\n    if (autoCorrection[j].reponse !== undefined) {\n      if (!Array.isArray(autoCorrection[j].reponse.valeur))\n        autoCorrection[j].reponse.valeur = [autoCorrection[j].reponse.valeur]\n      valeurAMCNum = autoCorrection[j].reponse.valeur[0]\n      if (typeof valeurAMCNum === 'string') {\n        valeurAMCNum = valeurAMCNum.replace(/\\s/g, '').replaceAll(',', '.')\n      }\n    }\n    switch (type) {\n      case 'qcmMono': // question QCM 1 bonne rponse\n      case 'qcmMult':\n        if (elimineDoublons(autoCorrection[j].propositions)) {\n          console.error('doublons trouvs')\n        }\n        if (autoCorrection[j].enonce === undefined) {\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n        }\n        texQr += `\\\\element{${ref}}{\\n `\n        texQr += `\\\\begin{${type === 'qcmMono' ? 'question' : 'questionmult'}}{${ref}/${lettreDepuisChiffre(idExo + 1)}${id + 10}} \\n `\n        texQr += `${autoCorrection[j].enonce} \\n `\n        texQr += `\\t\\\\begin{${horizontalite}}`\n        if (ordered) {\n          texQr += '[o]'\n        }\n        texQr += '\\n '\n        for (let i = 0; i < autoCorrection[j].propositions.length; i++) {\n          if (lastchoice > 0 && i === lastchoice) {\n            texQr += '\\t\\t\\\\lastchoices\\n'\n          }\n          if (autoCorrection[j].propositions[i].statut) {\n            texQr += `\\t\\t\\\\bonne{${autoCorrection[j].propositions[i].texte}}\\n `\n          } else {\n            texQr += `\\t\\t\\\\mauvaise{${autoCorrection[j].propositions[i].texte}}\\n `\n          }\n        }\n        texQr += `\\t\\\\end{${horizontalite}}\\n `\n        texQr += `\\\\end{${type === 'qcmMono' ? 'question' : 'questionmult'}}\\n }\\n `\n        id++\n        break\n\n      case 'AMCOpen': // AMCOpen question ouverte corrige par l'enseignant\n        if (autoCorrection[j].enonce === undefined) {\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n        }\n        if (autoCorrection[j].propositions === undefined) {\n          autoCorrection[j].propositions = [\n            {\n              texte: exercice.listeCorrections[j],\n              statut: '3',\n            },\n          ]\n        }\n        texQr += `\\\\element{${ref}}{\\n `\n        texQr += `\\t\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n        texQr += `\\t\\t${autoCorrection[j].enonce} \\n `\n        texQr += `\\t\\t\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n        texQr += `\\t\\t\\\\notation{${autoCorrection[j].propositions[0].statut}}`\n        if (autoCorrection[j].propositions[0].sanscadre !== undefined) {\n          texQr += `[${autoCorrection[j].propositions[0].sanscadre}]` // le statut contiendra si on a un cadre ou pas\n        } else {\n          texQr += '[false]'\n        }\n        if (autoCorrection[j].propositions[0].pointilles !== undefined) {\n          texQr += `[${autoCorrection[j].propositions[0].pointilles}]` // // le statut contiendra les lignes sont des pointills ou vierges\n        } else {\n          texQr += '[true]'\n        }\n\n        texQr += '\\n\\t\\\\end{question}\\n }\\n'\n        id++\n        break\n      case 'AMCNum': // AMCNum avec encodage numrique de la rponse\n        /********************************************************************/\n        // On pourra rajouter des options : les paramtres sont nomms.\n        // {digits=0,digitsDen=0,digitsNum=0,decimals=0,vertical=false,signe=false,exposantNbChiffres=0,exposantSigne=false,approx=0}\n        // si digits=0 alors la fonction va analyser le nombre dcimal (ou entier) pour dterminer digits et decimals\n        // signe et exposantSigne sont des boolens\n        // approx est un entier : on enlve la virgule pour comparer la rponse avec la valeur : approx est le seuil de cette diffrence.\n        /********************************************************************/\n        if (autoCorrection[j].enonce === undefined) {\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n        }\n        if (autoCorrection[j].propositions === undefined) {\n          autoCorrection[j].propositions = [\n            {\n              texte: exercice.listeCorrections[j],\n              statut: '',\n            },\n          ]\n        }\n        if (!Array.isArray(autoCorrection[j].reponse.valeur)) {\n          autoCorrection[j].reponse.valeur = [autoCorrection[j].reponse.valeur]\n        }\n        if (autoCorrection[j].reponse.param.basePuissance !== undefined) {\n          if (autoCorrection[j].reponse.param.exposantPuissance === undefined) {\n            autoCorrection[j].reponse.param.exposantPuissance = 1000 // Nb volontairement grand pour faire comprendre  l'utilisateur AMC qu'il y a eu une erreur de programmation lors de la conception de l'exercice.\n          }\n          texQr += `\\\\element{${ref}}{\\n`\n          texQr += '\\\\begin{multicols}{2}\\n'\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n          texQr += `${autoCorrection[j].enonce} \\n \\\\vspace{0.25cm} \\n`\n          if (autoCorrection[j].propositions !== undefined) {\n            texQr += `\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n          }\n          let digitsBase = 0\n          if (autoCorrection[j].reponse.param.baseNbChiffres !== undefined) {\n            digitsBase = Math.max(\n              autoCorrection[j].reponse.param.baseNbChiffres,\n              nombreDeChiffresDansLaPartieEntiere(\n                autoCorrection[j].reponse.param.basePuissance,\n              ),\n            )\n          } else {\n            digitsBase = nombreDeChiffresDansLaPartieEntiere(\n              autoCorrection[j].reponse.param.basePuissance,\n            )\n          }\n          let digitsExposant = 0\n          if (\n            autoCorrection[j].reponse.param.exposantNbChiffres !== undefined\n          ) {\n            digitsExposant = Math.max(\n              autoCorrection[j].reponse.param.exposantNbChiffres,\n              nombreDeChiffresDansLaPartieEntiere(\n                autoCorrection[j].reponse.param.exposantPuissance,\n              ),\n            )\n          } else {\n            digitsExposant = nombreDeChiffresDansLaPartieEntiere(\n              autoCorrection[j].reponse.param.exposantPuissance,\n            )\n          }\n          texQr += '\\n'\n          texQr += `Base\\n \\\\AMCnumericChoices{${autoCorrection[j].reponse.param.basePuissance}}{digits=${digitsBase},decimals=0,sign=${autoCorrection[j].reponse.param.basePuissance < 0 || autoCorrection[j].reponse.param.signe ? 'true' : 'false'},approx=0,`\n          if (autoCorrection[j].reponse.param.aussiCorrect !== undefined)\n            texQr += `alsocorrect=${autoCorrection[j].reponse.param.aussiCorrect},`\n          texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${autoCorrection[j].reponse.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n          texQr += '\\\\end{questionmultx}\\n'\n          texQr += '\\\\AMCquestionNumberfalse\\\\def\\\\AMCbeginQuestion#1#2{}'\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 1}} \\n `\n          texQr += '\\\\vspace{18pt}'\n          // texQr += `Exposant\\n \\\\AMCnumericChoices{${autoCorrection[j].reponse.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=${autoCorrection[j].reponse.param.exposantPuissance < 0 ? 'true' : 'false'},approx=0,`\n          texQr += `Exposant\\n \\\\AMCnumericChoices{${autoCorrection[j].reponse.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=true,approx=0,`\n          texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${autoCorrection[j].reponse.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n          texQr += '\\\\end{questionmultx}\\n\\\\end{multicols}\\n}\\n\\n'\n          id += 2\n        } else if (\n          valeurAMCNum !== undefined &&\n          valeurAMCNum.num !== undefined\n        ) {\n          // Si une fraction a t passe  AMCNum, on met un seul AMCNumericChoice particulier\n          texQr += `\\\\element{${ref}}{\\n`\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n          texQr += `${autoCorrection[j].enonce} \\n`\n          if (autoCorrection[j].propositions !== undefined) {\n            texQr += `\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n          }\n          let digitsNum = 0\n          if (autoCorrection[j].reponse.param.digitsNum !== undefined) {\n            digitsNum = Math.max(\n              autoCorrection[j].reponse.param.digitsNum,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n            )\n          } else if (autoCorrection[j].reponse.param.digits !== undefined) {\n            digitsNum = Math.max(\n              autoCorrection[j].reponse.param.digits,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n            )\n          } else {\n            digitsNum = nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num)\n          }\n          let digitsDen = 0\n          if (autoCorrection[j].reponse.param.digitsDen !== undefined) {\n            digitsDen = Math.max(\n              autoCorrection[j].reponse.param.digitsDen ?? 0,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n            )\n          } else if (autoCorrection[j].reponse.param.digits !== undefined) {\n            digitsDen = Math.max(\n              autoCorrection[j].reponse.param.digits,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n            )\n          } else {\n            digitsDen = nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den)\n          }\n          let signeNum = true\n          if (autoCorrection[j].reponse.param.signe !== undefined) {\n            signeNum = autoCorrection[j].reponse.param.signe\n          } else {\n            signeNum = valeurAMCNum.signe === -1\n          }\n          let reponseF\n          let reponseAlsoCorrect\n          if (valeurAMCNum.num > 0) {\n            reponseF = arrondi(\n              valeurAMCNum.num + valeurAMCNum.den / 10 ** digitsDen,\n              8,\n            )\n            reponseAlsoCorrect = arrondi(\n              valeurAMCNum.num +\n                valeurAMCNum.den /\n                  10 ** nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n              8,\n            )\n          } else {\n            reponseF = arrondi(\n              valeurAMCNum.num - valeurAMCNum.den / 10 ** digitsDen,\n              8,\n            )\n            reponseAlsoCorrect = arrondi(\n              valeurAMCNum.num -\n                valeurAMCNum.den /\n                  10 ** nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n              8,\n            )\n          }\n          texQr += `\\\\AMCnumericChoices{${reponseF}}{digits=${digitsNum + digitsDen},decimals=${digitsDen},sign=${signeNum},approx=0,`\n          texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreexact=1,Tpoint={\\\\vspace{0.5cm} \\\\vrule height 0.4pt width 5.5cm },alsocorrect=${reponseAlsoCorrect}}\\n`\n          texQr += '\\\\end{questionmultx}\\n}\\n\\n'\n          id += 2\n        } else {\n          let nbChiffresExpo\n          if (\n            autoCorrection[j].reponse.param.exposantNbChiffres !== undefined &&\n            autoCorrection[j].reponse.param.exposantNbChiffres !== 0\n          ) {\n            nbChiffresPd = Math.max(\n              nombreDeChiffresDansLaPartieDecimale(\n                decimalToScientifique(valeurAMCNum)[0],\n              ),\n              autoCorrection[j].reponse.param.decimals ?? 0,\n            )\n            nbChiffresPe = Math.max(\n              nombreDeChiffresDansLaPartieEntiere(\n                decimalToScientifique(valeurAMCNum)[0],\n              ),\n              isNaN(autoCorrection[j].reponse.param.digits - nbChiffresPd)\n                ? 0\n                : autoCorrection[j].reponse.param.digits - nbChiffresPd,\n            )\n            nbChiffresExpo = Math.max(\n              nombreDeChiffresDansLaPartieEntiere(\n                decimalToScientifique(valeurAMCNum)[1],\n              ),\n              autoCorrection[j].reponse.param.exposantNbChiffres ?? 1,\n            )\n          } else {\n            nbChiffresPd = Math.max(\n              nombreDeChiffresDansLaPartieDecimale(valeurAMCNum),\n              autoCorrection[j].reponse.param.decimals ?? 0,\n            )\n            nbChiffresPe = Math.max(\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum),\n              isNaN(autoCorrection[j].reponse.param.digits - nbChiffresPd)\n                ? 0\n                : autoCorrection[j].reponse.param.digits - nbChiffresPd,\n            )\n          }\n          if (autoCorrection[j].reponse.param.milieuIntervalle !== undefined) {\n            const demiMediane =\n              autoCorrection[j].reponse.param.milieuIntervalle - valeurAMCNum\n            nbChiffresPd = Math.max(\n              nbChiffresPd,\n              nombreDeChiffresDansLaPartieDecimale(demiMediane),\n            )\n            valeurAMCNum = autoCorrection[j].reponse.param.milieuIntervalle\n            autoCorrection[j].reponse.param.approx =\n              autoCorrection[j].reponse.param.approx === 'intervalleStrict'\n                ? demiMediane * 10 ** nbChiffresPd - 1\n                : demiMediane * 10 ** nbChiffresPd\n          }\n          texQr += `\\\\element{${ref}}{\\n `\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n          texQr += `${autoCorrection[j].enonce} \\n `\n          if (autoCorrection[j].propositions !== undefined) {\n            texQr += `\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n          }\n          if (autoCorrection[j].reponse.textePosition === 'left')\n            texQr += `${autoCorrection[j].reponse.texte} `\n          texQr += `\\\\AMCnumericChoices{${valeurAMCNum}}{digits=${nbChiffresPe + nbChiffresPd},decimals=${nbChiffresPd},sign=${autoCorrection[j].reponse.param.signe},`\n          if (autoCorrection[j].reponse.param.aussiCorrect !== undefined)\n            texQr += `alsocorrect=${autoCorrection[j].reponse.param.aussiCorrect},`\n          if (\n            autoCorrection[j].reponse.param.exposantNbChiffres !== undefined &&\n            autoCorrection[j].reponse.param.exposantNbChiffres !== 0\n          ) {\n            // besoin d'un champ pour la puissance de 10. (notation scientifique)\n            texQr += `exponent=${nbChiffresExpo},exposign=${autoCorrection[j].reponse.param.exposantSigne},`\n          }\n          if (\n            autoCorrection[j].reponse.param.approx !== undefined &&\n            autoCorrection[j].reponse.param.approx !== 0\n          ) {\n            texQr += `approx=${autoCorrection[j].reponse.param.approx},`\n            texQr += `scoreapprox=${autoCorrection[j].reponse.param.scoreapprox || 0.667},`\n          }\n          if (\n            autoCorrection[j].reponse.param.vertical !== undefined &&\n            autoCorrection[j].reponse.param.vertical\n          ) {\n            texQr += `vertical=${autoCorrection[j].reponse.param.vertical},`\n          }\n          if (\n            autoCorrection[j].reponse.param.strict !== undefined &&\n            autoCorrection[j].reponse.param.strict\n          ) {\n            texQr += `strict=${autoCorrection[j].reponse.param.strict},`\n          }\n          if (\n            autoCorrection[j].reponse.param.vhead !== undefined &&\n            autoCorrection[j].reponse.param.vhead\n          ) {\n            texQr += `vhead=${autoCorrection[j].reponse.param.vhead},`\n          }\n          if (\n            autoCorrection[j].reponse.param.tpoint !== undefined &&\n            autoCorrection[j].reponse.param.tpoint\n          ) {\n            texQr += `Tpoint={${autoCorrection[j].reponse.param.tpoint}},`\n          } else {\n            texQr += 'Tpoint={,},'\n          }\n          texQr += 'borderwidth=0pt,backgroundcol=lightgray,scoreexact=1} '\n          if (autoCorrection[j].reponse.textePosition === 'right')\n            texQr += `${autoCorrection[j].reponse.texte}\\n`\n          texQr += '\\\\end{questionmultx}\\n }\\n\\n'\n          id++\n        }\n        break\n      default: // Si on arrive ici, c'est que le type est AMCHybride\n        if (type !== 'AMCHybride') {\n          window.notify(\n            'exportQcmAMC : Il doit y avoir une erreur de type AMC, je ne connais pas le type : ',\n            { type },\n          )\n        }\n\n        if (autoCorrection[j].enonce === undefined) {\n          // Si l'nonc n'a pas t dfini, on va le chercher dans la question\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n          if (autoCorrection[j].enonce === undefined) break // Toujours vide car exercice.listeQuestions[j] vide. Ce cas se produit lorsqu'on a un exercice avec multi-rponses en interactif mais un seul AMChybride avec plusieurs AMCNum, comme 6N11\n        }\n        if (autoCorrection[j].propositions === undefined) break\n\n        if (autoCorrection[j].melange !== undefined) {\n          melange = autoCorrection[j].melange\n        }\n        texQr += `\\\\element{${ref}}{\\n ` // Un seul lment du groupe de question pour AMC... plusieurs questions dedans !\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (autoCorrection[j].options.multicolsAll) {\n            texQr += '\\\\setlength{\\\\columnseprule}{'\n            if (autoCorrection[j].options.barreseparation) {\n              texQr += '0.5'\n            } else {\n              texQr += '0'\n            }\n            texQr += 'pt}\\\\begin{multicols}{2}\\n'\n          }\n        }\n\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (autoCorrection[j].options.numerotationEnonce) {\n            texQr += `\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}Enonce} \\\\QuestionIndicative `\n          }\n        }\n\n        if (autoCorrection[j].enonceAGauche) {\n          texQr += `\\\\noindent\\\\fbox{\\\\begin{minipage}{${autoCorrection[j].enonceAGauche[0]}\\\\linewidth}\\n`\n        }\n        sautDeLigneApresEnonce = '\\n '\n        if (\n          !(autoCorrection[j].enonceCentre === undefined) ||\n          autoCorrection[j].enonceCentre\n        ) {\n          texQr += '\\\\begin{center}'\n          sautDeLigneApresEnonce = ''\n        }\n        if (autoCorrection[j].enonceAvant === undefined) {\n          // Dans une suite de questions, il se peut qu'il n'y ait pas d'nonc gnral donc pas besoin de saut de ligne non plus.\n          texQr += `${autoCorrection[j].enonce} ` + sautDeLigneApresEnonce\n        } else if (autoCorrection[j].enonceAvant) {\n          texQr += `${autoCorrection[j].enonce} ` + sautDeLigneApresEnonce\n        } else if (autoCorrection[j].enonceAvantUneFois !== undefined) {\n          if (autoCorrection[j].enonceAvantUneFois && j === 0) {\n            texQr += `${autoCorrection[j].enonce} ` + sautDeLigneApresEnonce\n          }\n        }\n        if (\n          !(autoCorrection[j].enonceCentre === undefined) ||\n          autoCorrection[j].enonceCentre\n        ) {\n          texQr += '\\\\end{center}'\n        }\n        if (autoCorrection[j].enonceAGauche) {\n          texQr += `\\\\end{minipage}}\\n\\\\noindent\\\\begin{minipage}[t]{${autoCorrection[j].enonceAGauche[1]}\\\\linewidth}\\n`\n        }\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (autoCorrection[j].options.numerotationEnonce) {\n            texQr += '\\\\end{question}\\n'\n          }\n        }\n\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (\n            autoCorrection[j].options.multicols &&\n            !autoCorrection[j].options.multicolsAll\n          ) {\n            texQr += '\\\\setlength{\\\\columnseprule}{'\n            if (autoCorrection[j].options.barreseparation) {\n              texQr += '0.5'\n            } else {\n              texQr += '0'\n            }\n            texQr += 'pt}\\\\begin{multicols}{2}\\n'\n          }\n        }\n        for (\n          let qr = 0, qrType, prop, propositions, rep, nbChiffresExpo;\n          qr < autoCorrection[j].propositions.length;\n          qr++\n        ) {\n          // Dbut de la boucle pour traiter toutes les questions-reponses de l'lment j\n          prop = autoCorrection[j].propositions[qr] // prop est un objet avec cette structure : {type,propositions,reponse}\n          qrType = prop.type\n\n          propositions = prop.propositions\n          switch (qrType) {\n            case 'qcmMono': // qcmMono de Hybride\n            case 'qcmMult': // qcmMult de Hybride la diffrence est juste le nom de l'environnement chang dynamiquement\n              if (elimineDoublons(propositions)) {\n                console.info('doublons trouvs')\n              }\n              if (prop.options !== undefined) {\n                if (prop.options.vertical === undefined) {\n                  horizontalite = 'reponseshoriz'\n                } else {\n                  horizontalite = 'reponses'\n                }\n                if (prop.options.ordered) {\n                  ordered = true\n                }\n                if (prop.options.lastChoice !== undefined) {\n                  lastchoice = prop.options.lastChoice\n                }\n              }\n              texQr += `${qr > 0 && (qrType === 'qcmMono' || (qrType === 'qcmMult' && typeof autoCorrection[j].options !== 'undefined' && !autoCorrection[j].options.avecSymboleMult)) ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}`\n              texQr +=\n                typeof autoCorrection[j].options !== 'undefined' &&\n                autoCorrection[j].options.numerotationEnonce\n                  ? '\\n \\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse'\n                  : ''\n              texQr += `\\\\begin{${qrType === 'qcmMono' ? 'question' : 'questionmult'}}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n              if (prop.enonce !== undefined) {\n                texQr += prop.enonce + '\\n'\n              }\n              /* EE 13/10/2022 : A mon avis, ne sert  rien. Je le laisse car si pb, on saura que c'est peut-tre cela la raison.\n              if (propositions[0].reponse !== undefined) {\n                if (propositions[0].reponse.texte) {\n                  texQr += propositions[0].reponse.texte + '\\n'\n                }\n              }\n              */\n              texQr += `\\t\\\\begin{${horizontalite}}`\n              if (ordered) {\n                texQr += '[o]'\n              }\n              texQr += '\\n '\n              for (let i = 0; i < propositions.length; i++) {\n                if (lastchoice > 0 && i === lastchoice) {\n                  texQr += '\\t\\t\\\\lastchoices\\n'\n                }\n                if (prop.propositions[i].statut) {\n                  texQr += `\\t\\t\\\\bonne{${propositions[i].texte}}\\n `\n                } else {\n                  texQr += `\\t\\t\\\\mauvaise{${propositions[i].texte}}\\n `\n                }\n              }\n              texQr += `\\t\\\\end{${horizontalite}}\\n `\n              texQr += `\\\\end{${qrType === 'qcmMono' ? 'question' : 'questionmult'}}\\n`\n              id++\n              break\n            case 'AMCNum': // AMCNum de Hybride\n              rep = prop.propositions[0].reponse\n              if (!Array.isArray(rep.valeur)) {\n                // rep.valeur est un tableau si la rponse est une fraction\n                rep.valeur = [rep.valeur]\n              }\n              if (rep.param.basePuissance !== undefined) {\n                // Hybride dont la rponse est une puissance\n                if (rep.param.exposantPuissance === undefined) {\n                  rep.param.exposantPuissance = 1000 // Nb volontairement grand pour faire comprendre  l'utilisateur AMC qu'il y a eu une erreur de programmation lors de la conception de l'exercice.\n                }\n                if (\n                  qr === 0 &&\n                  autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                  autoCorrection[j].enonceApresNumQuestion\n                ) {\n                  texQr += `\\\\begin{questionmultx}{Enonce-${ref}/${lettreDepuisChiffre(idExo + 1)}${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonce de la question\n                  texQr += '\\\\end{questionmultx}'\n                }\n\n                // texQr += '\\\\begin{minipage}{\\\\textwidth}\\n'\n                texQr += '\\\\begin{multicols}{2}\\n'\n                texQr += `${qr > 0 || (qr === 0 && autoCorrection[j].enonceApresNumQuestion !== undefined && autoCorrection[j].enonceApresNumQuestion) ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n\n                if (propositions !== undefined) {\n                  texQr += `\\\\explain{${propositions[0].texte}}\\n`\n                }\n                texQr += `${rep.texte}\\n \\\\vspace{0.25cm} \\n`\n                let digitsBase = 0\n                if (rep.param.baseNbChiffres !== undefined) {\n                  digitsBase = Math.max(\n                    rep.param.baseNbChiffres,\n                    nombreDeChiffresDansLaPartieEntiere(\n                      rep.param.basePuissance,\n                    ),\n                  )\n                } else {\n                  digitsBase = nombreDeChiffresDansLaPartieEntiere(\n                    rep.param.basePuissance,\n                  )\n                }\n                let digitsExposant = 0\n                if (rep.param.exposantNbChiffres !== undefined) {\n                  digitsExposant = Math.max(\n                    rep.param.exposantNbChiffres,\n                    nombreDeChiffresDansLaPartieEntiere(\n                      rep.param.exposantPuissance,\n                    ),\n                  )\n                } else {\n                  digitsExposant = nombreDeChiffresDansLaPartieEntiere(\n                    rep.param.exposantPuissance,\n                  )\n                }\n                texQr += '\\n'\n                texQr += `Base\\n \\\\AMCnumericChoices{${rep.param.basePuissance}}{digits=${digitsBase},decimals=0,sign=${rep.param.basePuissance < 0 ? 'true' : 'false'},approx=0,`\n                texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${rep.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n                texQr += '\\\\end{questionmultx}\\n'\n                texQr += '\\\\AMCquestionNumberfalse\\\\def\\\\AMCbeginQuestion#1#2{}'\n                texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 1}} \\n `\n                texQr += '\\\\vspace{18pt}'\n                // texQr += `Exposant\\n \\\\AMCnumericChoices{${rep.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=${rep.param.exposantPuissance < 0 ? 'true' : 'false'},approx=0,`\n                texQr += `Exposant\\n \\\\AMCnumericChoices{${rep.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=true,approx=0,`\n                texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${rep.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n                texQr += '\\\\end{questionmultx}\\\\end{multicols}\\n'\n                // texQr += '\\\\end{minipage}\\n\\n'\n                id += 2\n              } else if (rep.valeur[0].num !== undefined) {\n                // Hybride dont la rponse est une fraction (et non une puissance)\n                // Si une fraction a t passe  AMCNum, on met deux AMCNumericChoice\n                // Pour rappel : rep = prop.propositions[0].reponse\n                valeurAMCNum = rep.valeur[0]\n\n                if (\n                  qr === 0 &&\n                  autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                  autoCorrection[j].enonceApresNumQuestion\n                ) {\n                  texQr += `\\\\begin{questionmultx}{Enonce-${ref}/${lettreDepuisChiffre(idExo + 1)}${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonce de la question\n                  texQr += '\\\\end{questionmultx}'\n                }\n\n                texQr += `${qr > 0 || (qr === 0 && autoCorrection[j].enonceApresNumQuestion !== undefined && autoCorrection[j].enonceApresNumQuestion) ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\begin{'\n                  texQr += `${propositions[0].reponse.alignement}}` // Alignement : gauche, droite, centr\n                }\n\n                if (\n                  !(\n                    qr === 0 &&\n                    autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                    autoCorrection[j].enonceApresNumQuestion\n                  )\n                )\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonc de la question\n\n                if (propositions !== undefined) {\n                  texQr += `\\\\explain{${propositions[0].texte}}\\n` // Correction\n                }\n                texQr += `${rep.texte}\\n` // Texte juste avant les cases  cocher\n                let digitsNum = 0\n                if (rep.param.digitsNum !== undefined) {\n                  digitsNum = Math.max(\n                    rep.param.digitsNum,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n                  )\n                } else if (rep.param.digits !== undefined) {\n                  digitsNum = Math.max(\n                    rep.param.digits,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n                  )\n                } else {\n                  digitsNum = nombreDeChiffresDansLaPartieEntiere(\n                    valeurAMCNum.num,\n                  )\n                }\n                let digitsDen = 0\n                if (rep.param.digitsDen !== undefined) {\n                  digitsDen = Math.max(\n                    rep.param.digitsDen,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n                  )\n                } else if (rep.param.digits !== undefined) {\n                  digitsDen = Math.max(\n                    rep.param.digits,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n                  )\n                } else {\n                  digitsDen = nombreDeChiffresDansLaPartieEntiere(\n                    valeurAMCNum.den,\n                  )\n                }\n                let signeNum = true\n                if (rep.param.signe !== undefined) {\n                  signeNum = rep.param.signe\n                } else {\n                  signeNum = valeurAMCNum.num * valeurAMCNum.den < 0\n                }\n                let reponseF\n                let reponseAlsoCorrect\n                if (\n                  rep.param.aussiCorrect != null &&\n                  rep.param.aussiCorrect.num != null &&\n                  rep.param.aussiCorrect.den != null\n                ) {\n                  if (valeurAMCNum.num > 0) {\n                    reponseF = arrondi(\n                      valeurAMCNum.num + valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                  } else {\n                    reponseF = arrondi(\n                      valeurAMCNum.num - valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                  }\n                  if (rep.param.aussiCorrect.num > 0) {\n                    reponseAlsoCorrect = arrondi(\n                      rep.param.aussiCorrect.num +\n                        rep.param.aussiCorrect.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                  } else {\n                    reponseAlsoCorrect = arrondi(\n                      rep.param.aussiCorrect.num -\n                        rep.param.aussiCorrect.den / 10 ** digitsDen,\n                    )\n                  }\n                } else {\n                  if (valeurAMCNum.num > 0) {\n                    reponseF = arrondi(\n                      valeurAMCNum.num + valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                    reponseAlsoCorrect = arrondi(\n                      valeurAMCNum.num +\n                        valeurAMCNum.den /\n                          10 **\n                            nombreDeChiffresDansLaPartieEntiere(\n                              valeurAMCNum.den,\n                            ),\n                      8,\n                    )\n                  } else {\n                    reponseF = arrondi(\n                      valeurAMCNum.num - valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                    reponseAlsoCorrect = arrondi(\n                      valeurAMCNum.num -\n                        valeurAMCNum.den /\n                          10 **\n                            nombreDeChiffresDansLaPartieEntiere(\n                              valeurAMCNum.den,\n                            ),\n                      8,\n                    )\n                  }\n                }\n                texQr += `\\\\AMCnumericChoices{${reponseF}}{digits=${digitsNum + digitsDen},decimals=${digitsDen},sign=${signeNum},approx=0,`\n                texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreexact=1,Tpoint={\\\\vspace{0.5cm} \\\\vrule height 0.4pt width 5.5cm },alsocorrect=${reponseAlsoCorrect}}\\n`\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\end{'\n                  texQr += `${propositions[0].reponse.alignement}}`\n                }\n                texQr += '\\\\end{questionmultx}\\n'\n                id += 2\n              } else {\n                // Hybride dont la rponse n'est ni une puissance, ni une fraction mais une valeur numrique simple (dcimal relatif)\n                if (\n                  rep.param.exposantNbChiffres !== undefined &&\n                  rep.param.exposantNbChiffres !== 0\n                ) {\n                  nbChiffresPd = Math.max(\n                    nombreDeChiffresDansLaPartieDecimale(\n                      decimalToScientifique(rep.valeur[0])[0],\n                    ),\n                    rep.param.decimals ?? 0,\n                  )\n                  nbChiffresPe = Math.max(\n                    nombreDeChiffresDansLaPartieEntiere(\n                      decimalToScientifique(rep.valeur[0])[0],\n                    ),\n                    isNaN(rep.param.digits - nbChiffresPd)\n                      ? 0\n                      : rep.param.digits - nbChiffresPd,\n                  )\n                  nbChiffresExpo = Math.max(\n                    nombreDeChiffresDansLaPartieEntiere(\n                      decimalToScientifique(rep.valeur[0])[1],\n                    ),\n                    rep.param.exposantNbChiffres ?? 0,\n                  )\n                } else {\n                  nbChiffresPd = Math.max(\n                    nombreDeChiffresDansLaPartieDecimale(rep.valeur[0]),\n                    rep.param.decimals ?? 0,\n                  )\n                  nbChiffresPe = Math.max(\n                    nombreDeChiffresDansLaPartieEntiere(rep.valeur[0]),\n                    isNaN(rep.param.digits - nbChiffresPd)\n                      ? nombreDeChiffresDe(rep.valeur[0] - nbChiffresPd)\n                      : rep.param.digits - nbChiffresPd,\n                  )\n                }\n                if (rep.param.milieuIntervalle !== undefined) {\n                  const demiMediane = rep.param.milieuIntervalle - valeurAMCNum\n                  nbChiffresPd = Math.max(\n                    nbChiffresPd,\n                    nombreDeChiffresDansLaPartieDecimale(demiMediane),\n                  )\n                  valeurAMCNum = rep.param.milieuIntervalle\n                  rep.param.approx =\n                    autoCorrection[j].reponse.param.approx ===\n                    'intervalleStrict'\n                      ? demiMediane * 10 ** nbChiffresPd - 1\n                      : demiMediane * 10 ** nbChiffresPd\n                }\n\n                // Rajout EE 27/12/2022 : Si on veut que l'nonc soit aprs le numro de la question\n                if (\n                  qr === 0 &&\n                  autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                  autoCorrection[j].enonceApresNumQuestion\n                ) {\n                  texQr += `\\\\begin{questionmultx}{Enonce-${ref}/${lettreDepuisChiffre(idExo + 1)}${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                  texQr += `${autoCorrection[j].enonce} \\n`\n                  texQr += '\\\\end{questionmultx}'\n                }\n\n                // Rajout EE 27/12/2022 : Si on veut que le multicols commence avant cette question\n                if (\n                  typeof propositions[0].multicolsBegin !== 'undefined' &&\n                  propositions[0].multicolsBegin\n                ) {\n                  texQr += '\\\\setlength{\\\\columnseprule}{'\n                  if (\n                    autoCorrection[j].options.barreseparation !== undefined &&\n                    autoCorrection[j].options.barreseparation\n                  ) {\n                    texQr += '0.5'\n                  } else {\n                    texQr += '0'\n                  }\n                  texQr += 'pt}\\\\begin{multicols}{2}\\n'\n                }\n\n                if (\n                  qr > 0 ||\n                  (qr === 0 &&\n                    autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                    autoCorrection[j].enonceApresNumQuestion)\n                )\n                  texQr +=\n                    '\\n\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse'\n\n                texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                /*\n                if (!(qr === 0 && autoCorrection[j].enonceApresNumQuestion !== undefined && autoCorrection[j].enonceApresNumQuestion)) {\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonce de la question\n                }\n                */\n                if (propositions !== undefined) {\n                  texQr += `\\\\explain{${propositions[0].texte}}\\n`\n                }\n                texQr += `${rep.texte}\\n`\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\begin{'\n                  texQr += `${propositions[0].reponse.alignement}}`\n                }\n                texQr += `\\\\AMCnumericChoices{${rep.valeur[0]}}{digits=${nbChiffresPe + nbChiffresPd},decimals=${nbChiffresPd},sign=${rep.param.signe},`\n                if (\n                  rep.param.exposantNbChiffres !== undefined &&\n                  rep.param.exposantNbChiffres !== 0\n                ) {\n                  // besoin d'un champ pour la puissance de 10. (notation scientifique)\n                  texQr += `exponent=${nbChiffresExpo},exposign=${rep.param.exposantSigne},`\n                }\n                if (rep.param.approx !== undefined && rep.param.approx !== 0) {\n                  texQr += `approx=${rep.param.approx},`\n                  // texQr += `scoreapprox=${rep.param.scoreapprox || 0.667},`\n                }\n                if (rep.param.vertical !== undefined && rep.param.vertical) {\n                  texQr += `vertical=${rep.param.vertical},`\n                }\n                if (rep.param.strict !== undefined && rep.param.strict) {\n                  texQr += `strict=${rep.param.strict},`\n                }\n                if (rep.param.vhead !== undefined && rep.param.vhead) {\n                  texQr += `vhead=${rep.param.vhead},`\n                }\n                if (\n                  rep.param.aussiCorrect !== undefined &&\n                  rep.param.aussiCorrect\n                ) {\n                  texQr += `alsocorrect=${rep.param.aussiCorrect},`\n                }\n                if (rep.param.tpoint !== undefined && rep.param.tpoint) {\n                  texQr += `Tpoint={${rep.param.tpoint}},`\n                } else {\n                  texQr += 'Tpoint={,},'\n                }\n                texQr +=\n                  'borderwidth=0pt,backgroundcol=lightgray,scoreexact=1}\\n'\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\end{'\n                  texQr += `${propositions[0].reponse.alignement}}`\n                }\n                texQr += '\\\\end{questionmultx}\\n'\n                // Rajout EE 27/12/2022 : Si on veut que le multicols finisse eprs cette question\n                if (typeof propositions[0].multicolsEnd !== 'undefined') {\n                  if (propositions[0].multicolsEnd) {\n                    texQr += '\\\\end{multicols}\\n'\n                  }\n                }\n\n                id++\n              }\n              break\n            case 'AMCOpen': // AMCOpen de Hybride\n              // Rajout EE 19/11/2023 : Si on veut que le multicols commence avant cette question\n              if (\n                typeof propositions[0].multicolsBegin !== 'undefined' &&\n                propositions[0].multicolsBegin\n              ) {\n                texQr += '\\\\setlength{\\\\columnseprule}{'\n                if (\n                  autoCorrection[j].options !== undefined &&\n                  autoCorrection[j].options.barreseparation !== undefined &&\n                  autoCorrection[j].options.barreseparation\n                ) {\n                  texQr += '0.5'\n                } else {\n                  texQr += '0'\n                }\n                texQr += '0pt}\\\\begin{multicols}{2}\\n'\n                if (qr > 0)\n                  texQr +=\n                    '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse'\n              }\n              if (propositions[0].numQuestionVisible === undefined) {\n                texQr += `\\t${qr > 0 ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n`\n              } else if (propositions[0].numQuestionVisible) {\n                texQr += `\\t${qr > 0 ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n`\n              } else {\n                texQr += `\\t\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse \\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}}\\\\QuestionIndicative \\n`\n              }\n              if (!(propositions[0].enonce === undefined))\n                texQr += `\\t${propositions[0].enonce}\\n`\n              texQr += `\\t\\t\\\\explain{${propositions[0].texte}}\\n`\n\n              // if (propositions[0].numQuestionVisible === undefined) {\n              texQr += `\\t\\t\\\\notation{${propositions[0].statut}}`\n              if (!isNaN(propositions[0].sanscadre)) {\n                texQr += `[${propositions[0].sanscadre}]` // le statut contiendra si on a un cadre ou pas\n              } else {\n                texQr += '[false]'\n              }\n              if (!isNaN(propositions[0].pointilles)) {\n                texQr += `[${propositions[0].pointilles}]` // le statut contiendra les lignes sont des pointills ou vierges\n              } else {\n                texQr += '[true]'\n              }\n              //  }\n\n              texQr += '\\n' // le statut contiendra le nombre de lignes pour ce type\n              texQr += '\\t\\\\end{question}\\n'\n              // Rajout EE 19/11/2023 : Si on veut que le multicols finisse eprs cette question\n              if (typeof propositions[0].multicolsEnd !== 'undefined') {\n                if (propositions[0].multicolsEnd) {\n                  texQr += '\\\\end{multicols}\\n'\n                }\n              }\n              id++\n              break\n          }\n        }\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (\n            autoCorrection[j].options.multicols ||\n            autoCorrection[j].options.multicolsAll\n          ) {\n            texQr += '\\\\end{multicols}\\n'\n          }\n        }\n        if (autoCorrection[j].enonceAGauche) {\n          texQr += '\\\\end{minipage}\\n'\n        }\n        texQr += '}\\n'\n        break\n    }\n  }\n  texQr = texQr.replaceAll(\n    /(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim,\n    '\\n\\n\\\\medskip\\n',\n  )\n  texQr = texQr.replaceAll('<br>', '\\\\\\\\\\n')\n  return [texQr, ref, exercice.nbQuestions, titre, melange]\n}\n\n/**\n * @author Jean-Claude Lhote\n * Fonction qui cre un document pour AMC (pour le compiler, le package automultiplechoice.sty doit tre prsent)\n *\n *  exercices est un tableau d'exercies TypeExercice[]\n *\n * nbQuestions est un tableau pour prciser le nombre de questions  prendre dans chaque groupe pour constituer une copie\n * s'il est indfini, toutes les questions du groupe seront poses.\n * nb_exemplaire est le nombre de copies  gnrer\n * matiere et titre se passent de commentaires : ils renseignent l'entte du sujet.\n */\nexport function creerDocumentAmc({\n  exercices,\n  nbQuestions = [],\n  nbExemplaires = 1,\n  matiere = 'Mathmatiques',\n  titre = 'Evaluation',\n  typeEntete = 'AMCcodeGrid',\n  format = 'A4',\n}) {\n  // Attention exercices est maintenant un tableau de tous les exercices.\n  // Dans cette partie, la fonction rcupre toutes les exercices et les trie pour les rassembler par groupe\n  // Toutes les questions d'un mme exercice seront regroupes ce qui permet ventuellement de les rcuprer dans des fichiers individuels pour se constituer une base\n  let idExo = 0\n  let code\n  let indexOfCode\n  const nombreDeQuestionsIndefinie = []\n  const graine = randint(1, 100000)\n  const groupeDeQuestions = []\n  const texQuestions = [[]]\n  const titreQuestion = []\n  const melangeQuestion = []\n  const nombreExoAmc = exercices.filter((el) => el.amcReady).length\n  if (nombreExoAmc === 0) return ''\n  for (const exercice of exercices) {\n    code = exportQcmAmc(exercice, idExo)\n    idExo++\n    indexOfCode = groupeDeQuestions.indexOf(code[1])\n    if (indexOfCode === -1) {\n      // si le groupe n'existe pas\n      groupeDeQuestions.push(code[1])\n      indexOfCode = groupeDeQuestions.indexOf(code[1])\n      texQuestions[indexOfCode] = formatLatex(code[0])\n\n      // Si le nombre de questions du groupe n'est pas dfini, alors on met toutes les questions sinon on laisse le nombre choisi par l'utilisateur\n      if (typeof nbQuestions[indexOfCode] === 'undefined') {\n        nombreDeQuestionsIndefinie[indexOfCode] = true\n        nbQuestions[indexOfCode] = code[2]\n      } else {\n        // Si le nombre de question ( restituer pour ce groupe de question) a t dfini par l'utilisateur, alors on le laisse !\n        nombreDeQuestionsIndefinie[indexOfCode] = false\n      }\n      // Si le nombre de questions du groupe n'est pas dfini, alors on met toutes les questions sinon on laisse le nombre choisi par l'utilisateur\n      titreQuestion[indexOfCode] = code[3]\n      melangeQuestion[indexOfCode] = code[4]\n    } else {\n      // Donc le groupe existe, on va vrifier si la question existe dj et si non, on l'ajoute.\n      if (texQuestions[indexOfCode].indexOf(code[0]) === -1) {\n        texQuestions[indexOfCode] += code[0]\n        // Si le nombre de questions du groupe n'est pas dfini, alors on met toutes les questions sinon on laisse le nombre choisi par l'utilisateur\n        if (nombreDeQuestionsIndefinie[indexOfCode]) {\n          nbQuestions[indexOfCode] += code[2]\n        }\n      }\n    }\n  }\n  // Fin de la prparation des groupes\n\n  let isImpressionRectoVerso = false\n  const checkBoxImpressionRectoVerso = document.getElementById(\n    'impression_recto_verso',\n  )\n  if (checkBoxImpressionRectoVerso !== null)\n    isImpressionRectoVerso = checkBoxImpressionRectoVerso.checked\n  // variable qui contiendra le code LaTeX pour AMC\n  let codeLatex = ''\n\n  // variable preambule  abonder le cas chant si des packages sont ncessaires.\n  // Merci  Sbastien Lozano pour la vrification des dpendances\n  // Merci  Liouba Leroux pour ses documents qui ont servi de base\n  // A faire : abonder le preambule pour qu'il colle  tous les exos Mathalea_AMC\n\n  let preambule = `%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%%% -I- PRAMBULE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \\n`\n  if (format === 'A3') {\n    preambule += `\\t \\\\documentclass[${isImpressionRectoVerso ? 'twoside,' : ''}10pt,a3paper,landscape,french,svgnames]{article}\\n`\n  } else {\n    preambule += `\\t \\\\documentclass[${isImpressionRectoVerso ? 'twoside,' : ''}10pt,a4paper,french,svgnames]{article}\\n`\n  }\n\n  preambule += `\\t\n  %%%%%% EE : Le mettre le plus tt possible pour viter un Warning  la compilation\n  \\\\RequirePackage{etex}\\t  % pour avoir plus de \"registres\" mmoires / tikz...\n  %%%%% PACKAGES LANGUE %%%%%\n  \\\\usepackage{babel} % sans option => langue dfinie dans la classe du document\n   \\\\usepackage[T1]{fontenc}\n   \\\\usepackage[utf8x]{inputenc}\n   \\\\usepackage{lmodern}\\t        \\t% Choix de la fonte (Latin Modern de D. Knuth)\n   \\\\usepackage{fp}\n   \\\\usepackage{ProfCollege}\n\n  %%%%%%%%%%%%%%%%%%%%% SPCIFICITS A.M.C. %%%%%%%%%%%%%%%%%%%%%%\n  %\\\\usepackage[francais,bloc,completemulti]{automultiplechoice}\n  %   remarque : avec completmulti => \"aucune rponse ne convient\" en +\n   \\\\usepackage[francais,bloc,insidebox,nowatermark]{automultiplechoice} %//,insidebox\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n  %%%%% PACKAGES MISE EN PAGE %%%%%\n   \\\\usepackage{multicol}\n   \\\\usepackage{wrapfig}\n   \\\\usepackage{fancybox}  % pour \\\\doublebox \\\\shadowbox  \\\\ovalbox \\\\Ovalbox\n   \\\\usepackage{calc} \\t% Calculs\n   \\\\usepackage{enumerate}\\t% Pour modifier les numrotations\n   \\\\usepackage{enumitem}\n   \\\\usepackage{tabularx}\\t% Pour faire des tableaux\n\n   \\\\usepackage{xargs}\\t% EE : pour permettre DES options dans newcommand\n\n  %%%%% PACKAGES FIGURES %%%%%\n  %\\\\usepackage{pstricks,pst-plot,pstricks-add}\n  %   POUR PSTRICKS d'o compilation sans PDFLateX mais : dvi, dvi2ps, ps2PDF...\n  %   MAIS ON PRFRERA UTILISER TIKZ...\n  \\\\usepackage{xcolor}% [avant tikz] xcolor permet de nommer + de couleurs\n  \\\\usepackage{pgf,tikz}\n  \\\\usepackage{graphicx} % pour inclure une image\n  \\\\usetikzlibrary{arrows,calc,fit,patterns,plotmarks,shapes.geometric,shapes.misc,shapes.symbols,shapes.arrows,\n    shapes.callouts, shapes.multipart, shapes.gates.logic.US,shapes.gates.logic.IEC, er, automata,backgrounds,chains,topaths,trees,petri,mindmap,matrix, calendar, folding,fadings,through,positioning,scopes,decorations.fractals,decorations.shapes,decorations.text,decorations.pathmorphing,decorations.pathreplacing,decorations.footprints,decorations.markings,shadows,babel} % Charge toutes les librairies de Tikz\n  \\\\usepackage{tkz-tab,tkz-fct,tkz-euclide}\\t% Gomtrie euclidienne avec TikZ\n  %\\\\usetkzobj{all} %problme de compilation\n\n  %%%%% PACKAGES MATHS %%%%%\n   \\\\usepackage{ucs}\n   \\\\usepackage{bm}\n   \\\\usepackage{amsmath}\n   \\\\usepackage{amsfonts}\n   \\\\usepackage{amssymb}\n   \\\\usepackage{gensymb}\n   \\\\usepackage{eurosym}\n   \\\\usepackage{frcursive}\n   \\\\newcommand{\\\\Vcurs}{\\\\begin{cursive}V\\\\end{cursive}}\n   \\\\usepackage[normalem]{ulem}\n   % plus utilis avec ProfCollege\n   % \\\\usepackage{sistyle} \\\\SIdecimalsign{,} %% => \\\\num{...} \\\\num*{...}\n   % cf. http://fr.wikibooks.org/wiki/LaTeX/%C3%89crire_de_la_physique\n   %  sous Ubuntu, paquet texlive-science  installer\n   %\\\\usepackage[autolanguage,np]{numprint} % dj appel par dfaut dans introLatex\n   \\\\usepackage{mathrsfs}  % Spcial math\n   %\\\\usepackage[squaren]{SIunits}\\t% Pour les units (gre le conflits avec  \\\\square de l'extension amssymb)\n   \\\\usepackage{pifont}\\t% Pour les symboles \"ding\"\n   \\\\usepackage{bbding}\\t% Pour les symboles\n   \\\\usepackage[misc]{ifsym}\\t% Pour les symboles\n   \\\\usepackage{cancel}\\t% Pour pouvoir barrer les nombres\n\n  %%%%% AUTRES %%%%%\n   \\\\usepackage{ifthen}\n   \\\\usepackage{url} \\t        \\t% Pour afficher correctement les url\n   \\\\urlstyle{sf}                          \\t% qui s'afficheront en police sans serif\n   \\\\usepackage{fancyhdr,lastpage}          \\t% En-ttes et pieds\n    \\\\pagestyle{fancy}                      \\t% de pages personnaliss\n   \\\\usepackage{fancybox}\\t% Pour les encadrs\n   \\\\usepackage{xlop}\\t% Pour les calculs poss\n  %\\\\usepackage{standalone}\\t% Pour avoir un apercu d'un fichier qui sera utilis avec un input\n   \\\\usepackage{multido}\\t% Pour faire des boucles\n  %\\\\usepackage{hyperref}\\t% Pour grer les liens hyper-texte\n   \\\\usepackage{fourier}\n   \\\\usepackage{colortbl} \\t% Pour des tableaux en couleur\n   \\\\usepackage{setspace}\\t% Pour \\\\begin{spacing}{2.0} \\\\end{spacing}\n   \\\\usepackage{multirow}\\t% Pour des cellules multilignes dans un tableau\n  %\\\\usepackage{import}\\t% Equivalent de input mais en spcifiant le rpertoire de travail\n  %\\\\usepackage[]{qrcode}\n  %\\\\usepackage{pdflscape}\n   \\\\usepackage[framemethod=tikz]{mdframed} % Pour les cadres\n   \\\\usepackage{tikzsymbols}\n   \\\\usepackage{scratch3}\n  %\\\\usepackage{tasks}\\t% Pour les listes horizontales\n\\\\usepackage{csvsimple}\n\n  %%%%% Librairies utilises par Mathgraphe32 %%%%\n  \\\\usepackage{fix-cm}\n  \\\\usepackage{textcomp}\n  \n  %%%%% PERSONNALISATION %%%%%\n  \\\\renewcommand{\\\\multiSymbole}{$\\\\begin{smallmatrix}\\\\circ\\\\bullet\\\\bullet \\\\\\\\\n           \\\\circ\\\\bullet\\\\circ \\\\end{smallmatrix}$\\\\noindent} % par dfaut $\\\\clubsuit$\n  %\\\\renewcommand{\\\\multiSymbole}{\\\\textbf{(! vent. plusieurs rponses !)}\\\\noindent} % par dfaut $\\\\clubsuit$\n  \\\\renewcommand{\\\\AMCbeginQuestion}[2]{\\\\noindent{\\\\colorbox{gray!20}{\\\\bf#1}}#2}\n  %\\\\renewcommand{\\\\AMCIntervalFormat}[2]{\\\\texttt{[}#1\\\\,;\\\\,#2\\\\texttt{[}}\n                           % Crochets plus nets, virgule...\n  %\\\\AMCboxDimensions{size=1.7ex,down=.2ex} %% taille des cases  cocher diminue\n  \\\\newcommand{\\\\collerVertic}{\\\\vspace{-3mm}} % vite un trop grand espace vertical\n  \\\\newcommand{\\\\TT}{\\\\sout{\\\\textbf{Tiers Temps}} \\\\noindent} %\n  \\\\newcommand{\\\\Prio}{\\\\fbox{\\\\textbf{PRIORITAIRE}} \\\\noindent} %\n  \\\\newcommandx{\\\\notation}[3][2=false,3=true]{\n    \\\\AMCOpen{lines=#1,lineup=#2,lineuptext=\\\\hspace{1cm},dots=#3}{\\\\mauvaise[{\\\\tiny NR}]{NR}\\\\scoring{0}\\\\mauvaise[{\\\\tiny RR}]{RR}\\\\scoring{0.01}\\\\mauvaise[{\\\\tiny R}]{R}\\\\scoring{0.33}\\\\mauvaise[{\\\\tiny V}]{V}\\\\scoring{0.67}\\\\bonne[{\\\\tiny VV}]{VV}\\\\scoring{1}}\n  }\n  %%\\\\newcommand{\\\\notation}[1]{\n  %%\\\\AMCOpen{lines=#1}{\\\\mauvaise[{\\\\tiny NR}]{NR}\\\\scoring{0}\\\\mauvaise[{\\\\tiny RR}]{RR}\\\\scoring{0.01}\\\\mauvaise[{\\\\tiny R}]{R}\\\\scoring{0.33}\\\\mauvaise[{\\\\tiny V}]{V}\\\\scoring{0.67}\\\\bonne[{\\\\tiny VV}]{VV}\\\\scoring{1}}\n  %%}\n  \n  %%pour afficher ailleurs que dans une question\n  \\\\makeatletter\n  \\\\newcommand{\\\\AffichageSiCorrige}[1]{\\\\ifAMC@correc #1\\\\fi}\n  \\\\makeatother\n  \n  \n  %%%%% TAILLES %%%%%\n   \\\\usepackage{geometry}\n   \\\\geometry{headsep=0.3cm, left=1.5cm,right=1.5cm,top=2.4cm,bottom=1.5cm}\n   \\\\DecimalMathComma\n  \n   \\\\AMCcodeHspace=.3em % rduction de la taille des cases pour le code lve\n   \\\\AMCcodeVspace=.3em\n  % \\\\AMCcodeBoxSep=.1em\n   \n   \\\\def\\\\AMCotextReserved{\\\\emph{Ne rien cocher, rserv au prof !}}\n   \n  %%%%%% Dfinition des barmes\n  \\\\baremeDefautS{\n    e=0.0001,% incohrence (plusieurs rponses donnes  0,0001 pour dfinir des manquements au respect de consignes)\n    b=1,% bonne rponse 1\n    m=-0.01,% mauvaise rponse 0,01 pour diffrencier de la\n    v=0} % non rponse qui reste  0\n  \n  \\\\baremeDefautM{formula=((NBC-NMC)/NB)*((NBC-NMC)/NB>0)} % nombre de bonnes rponses coches minores des mauvaises rponses coches, ramenes  1, et ramene  0 si rsultat ngatif.\n  \n  %%%%%%%%% Paramtres pour rponses  construire\n  \\\\AMCinterIrep=0pt \\\\AMCinterBrep=.5ex \\\\AMCinterIquest=0pt \\\\AMCinterBquest=3ex \\\\AMCpostOquest=7mm \\\\setlength{\\\\AMChorizAnswerSep}{3em plus 4em} \\\\setlength{\\\\AMChorizBoxSep}{1em}\n  %%%%% Fin du prambule %%%%%%%\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  `\n\n  // Variable contenant la partie document\n  // Celle-ci contient une partie statique et une partie variable (la zone de dfinition des groupes qui est construite  la vole  partir de la variable groupeDeQuestions alimente au dbut)\n\n  let debutDocument = `%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%% -II-DOCUMENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\\\\begin{document}\n\\\\AMCrandomseed{${graine}}   % On choisit les \"graines\" pour initialiser le \"hasard\"\n\\\\FPseed=${graine}\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%% -II-a. CONCEPTION DU QCM %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n  %%% prparation des groupes\n  \\\\setdefaultgroupmode{cyclic}\\n`\n\n  for (const g of groupeDeQuestions) {\n    const i = groupeDeQuestions.indexOf(g)\n    debutDocument += texQuestions[i]\n  }\n\n  // Variable qui contient l'entte d'une copie\n  // A faire : Proposer diffrent type d'entte en fonction d'un paramtre ?\n  const enteteTypeCodeGrid = `\\\\begin{minipage}{10cm}\n  \\\\champnom{\\\\fbox{\\\\parbox{10cm}{\n    crivez vos nom, prnom et classe : \\\\\\\\\n  }}}\n  \\\\end{minipage}\n  \n  %\\\\\\\\\n  \\\\vspace{2mm}\n  \n  Puis remplir les cases des trois premires lettres de votre \\\\textbf{nom de famille} PUIS des deux premires lettres de votre \\\\textbf{prnom}\n  \\\\vspace{1mm}\n\n  \\\\def\\\\AMCchoiceLabelFormat##1{\\\\textcolor{black!70}{{\\\\tiny ##1}}}  % pour allger la couleur des lettres dans les cases et les rduire\n  \\\\AMCcodeGrid[h]{ID}{ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ}\n  `\n  const enteteTypeChampnomSimple = `\\\\begin{minipage}{10cm}\n  \\\\champnom{\\\\fbox{\\\\parbox{10cm}{\n    crivez vos nom, prnom et classe : \\\\\\\\\n   \\\\\\\\\n  }}}\n  \\\\end{minipage}\n  \n  %\\\\\\\\\n  \\\\vspace{2mm}\n  `\n  const enteteTypePreremplie = `\\\\begin{center}\n  \\\\noindent{}\\\\fbox{\\\\vspace*{3mm}\n       \\\\Large\\\\bf\\\\nom{}~\\\\prenom{}\\\\normalsize{}%\n        \\\\vspace*{3mm}\n      }\n  \\\\end{center}\\n`\n\n  let enteteCopie = ''\n  if (typeEntete === 'AMCassociation') {\n    enteteCopie += '\\\\newcommand{\\\\sujet}{\\n'\n  }\n  enteteCopie += `\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%% -II-b. MISE EN PAGE DU QCM %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \\\\exemplaire{${nbExemplaires}}{   % <======  /!\\\\ PENSER  ADAPTER /!\\\\  ===  %\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \\n`\n  if (format === 'A3') {\n    enteteCopie += '\\\\begin{multicols}{2}\\n'\n  }\n  enteteCopie += `\n  %%%%% EN-TTE, IDENTIFICATION AUTOMATIQUE DE L'LVE %%%%%\n  \n  \\\\vspace*{-17mm}\n  \n  %%%%% INTRODUCTION VENTUELLE %%%%%\n  \n  \\\\vspace{5mm}\n  %\\\\noindent\\\\AMCcode{num.etud}{8}\\\\hspace*{\\\\fill} % Pour la version \"verticale\"\n  %\\\\noindent\\\\AMCcodeH{num.etud}{8}\\t % version \"horizontale\"\n  \\\\begin{minipage}{7cm}\n  \\\\begin{center}\n    \\\\textbf{${matiere}}\n    \n    \\\\textbf{${titre}}\n  \\\\end{center}\n  \\\\end{minipage}\n  \\\\hfill\\n`\n  if (typeEntete === 'AMCassociation') {\n    enteteCopie += enteteTypePreremplie\n  } else if (typeEntete === 'AMCcodeGrid') {\n    enteteCopie += enteteTypeCodeGrid\n  } else {\n    enteteCopie += enteteTypeChampnomSimple\n  }\n  enteteCopie += `\\n{\\\\footnotesize REMPLIR avec un stylo NOIR la ou les cases pour chaque question. Si vous devez modifier un choix, NE PAS chercher  redessiner la case coche par erreur, mettez simplement un coup de \"blanc\" dessus.\n  \n  Les questions prcdes de \\\\multiSymbole peuvent avoir plusieurs rponses.\\\\\\\\ Les questions qui commencent par \\\\TT ne doivent pas tre faites par les lves disposant d'un tiers temps.\n  \n   Il est fortement conseill de faire les calculs dans sa tte ou sur la partie blanche de la feuille sans regarder les solutions proposes avant de remplir la bonne case plutt que d'essayer de choisir entre les propositions (ce qui demande de toutes les examiner et prend donc plus de temps) }\n  \n  `\n\n  // Ici On ajoute les commandes pour insrer les questions issues des groupes en quantit selon le nb_question[i]\n  // nb_question est un tableau pass en paramtre  la fonction creerDocumentAmc pour dterminer le nombre de questions  restituer par groupe.\n  // si ce nombre est 0, on restitue toutes les questions du groupe\n  let contenuCopie = ''\n  if (typeEntete === 'AMCcodeGrid') {\n    contenuCopie += '\\t \\\\def\\\\AMCchoiceLabel##1{}'\n  }\n  for (const g of groupeDeQuestions) {\n    const i = groupeDeQuestions.indexOf(g)\n    contenuCopie += `\n  \\\\begin{center}\n    \\\\hrule\n    \\\\vspace{2mm}\n    \\\\bf\\\\Large ${titreQuestion[i]}\n    \\\\vspace{1mm}\n    \\\\hrule\n  \\\\end{center}\\n`\n    if (!melangeQuestion[i]) {\n      contenuCopie += `\\\\setgroupmode{${g}}{cyclic}\\n\\n`\n    }\n    // contenuCopie += `\\\\melangegroupe{${g}}\\n` // Pour Eric, ne pas effacer\n    if (nbQuestions[i] > 0) {\n      contenuCopie += `\\\\restituegroupe[${nbQuestions[i]}]{${g}}\\n\\n`\n    } else {\n      contenuCopie += `\\\\restituegroupe{${g}}\\n\\n`\n    }\n  }\n  if (format === 'A3') {\n    contenuCopie += '\\\\end{multicols}\\n'\n  }\n  if (typeEntete === 'AMCassociation') {\n    contenuCopie += `\\\\AMCassociation{\\\\id}\\n\n    }\n  }\\n`\n  } else {\n    contenuCopie += '}\\n'\n  }\n\n  // On assemble les diffrents morceaux et on retourne le rsultat\n  codeLatex =\n    preambule + '\\n' + debutDocument + '\\n' + enteteCopie + contenuCopie\n  if (typeEntete === 'AMCassociation') {\n    codeLatex +=\n      '\\n \\n \\\\csvreader[head to column names]{liste.csv}{}{\\\\sujet}\\n'\n  }\n  codeLatex += '\\\\end{document}\\n'\n  return codeLatex\n}\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  type FlexOrientation = 'col' | 'row'\n\n  export let title: string\n  export let valueSelected: string | number\n  export let labelsValues: {\n    label: string\n    value: string | number\n    isDisabled?: boolean\n  }[] = []\n  export let isDisabled: boolean = false\n  export let orientation: FlexOrientation = 'col'\n\n  const name =\n    title !== undefined\n      ? title\n          .replaceAll(' ', '')\n          .normalize('NFD')\n          .replace(/[\\u0300-\\u036f]/g, '')\n      : Math.round(new Date().getTime()).toString()\n  const dispatch = createEventDispatcher()\n  function valueHasChanged() {\n    dispatch('newvalue')\n  }\n</script>\n\n<!--\n  @component\n  Formulaire avec boutons radios\n\n  ### Action :\n\n  `newvalue` est dispatch lorsque la valeur du groupe de question a chang\n\n  ### Paramtres :\n\n  * `title` :  titre du groupe de boutons\n  * `isDisabled`: boolen servant  dsactiver le groupe\n\n  ### Exemple :\n\n    ```tsx\n  <FormRadio\n      isDisabled={maVariable2 === 0}\n      bind:valueSelected={maVariable}\n      labelsValues={[\n          { label: 'Titre du label 1', value: '1' },\n          { label: 'Titre du label 2', value: '2', isDisabled: true }\n      ]}\n      on:newvalue={() => {do_something}}\n  />\n  ```\n -->\n\n<div\n  class=\"flex justify-start items-start mt-1\"\n  class:flex-col={orientation === 'col'}\n  class:flex-row={orientation === 'row'}\n>\n  {#each labelsValues as labelValue, i}\n    <div class=\"form-check flex flex-row ml-4 items-center\">\n      <input\n        class=\"form-check-input rounded-full h-4 w-4 mt-1 mr-2 border\n          transition duration-200 focus:outline-0 focus:ring-0\n          text-coopmaths-action dark:text-coopmathsdark-action\n          bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark\n          border-coopmaths-action dark:border-coopmathsdark-action\n          checked:border-coopmaths-action dark:checked:border-coopmathsdark-action\n          active:border-coopmaths-action dark:active:border-coopmathsdark-action\n          focus:border-coopmaths-action dark:focus:border-coopmathsdark-action\n          checked:bg-coopmaths-action dark:checked:bg-coopmathsdark-action\n          {isDisabled || labelValue.isDisabled ? '' : 'cursor-pointer'}\"\n        type=\"radio\"\n        {name}\n        id={name + i.toString()}\n        bind:group={valueSelected}\n        value={labelValue.value}\n        disabled={isDisabled || labelValue.isDisabled}\n        on:change={valueHasChanged}\n      />\n      <label\n        class=\"form-check-label inline-block text-sm\n          {valueSelected === labelValue.value ? 'font-semibold' : 'font-light'}\n          {isDisabled || labelValue.isDisabled\n          ? 'text-coopmaths-corpus/10 dark:text-coopmathsdark-corpus/10'\n          : 'text-coopmaths-corpus/70 dark:text-coopmathsdark-corpus/70 cursor-pointer'}\"\n        for={name + i.toString()}\n      >\n        {labelValue.label}\n      </label>\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { onMount } from 'svelte'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import { creerDocumentAmc } from '../../../lib/amc/creerDocumentAmc.js'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaGetExercicesFromParams,\n    mathaleaHandleExerciceSimple,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea.js'\n  import {\n    darkMode,\n    exercicesParams,\n  } from '../../../lib/stores/generalStore.js'\n  import { referentielLocale } from '../../../lib/stores/languagesStore.js'\n  import { context } from '../../../modules/context.js'\n  import Footer from '../../Footer.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import InputNumber from '../../shared/forms/InputNumber.svelte'\n  import InputText from '../../shared/forms/InputText.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import BasicClassicModal from '../../shared/modal/BasicClassicModal.svelte'\n\n  const isSettingsVisible: boolean[] = []\n  let exercices: TypeExercice[] = []\n  let content = ''\n  let entete = 'AMCcodeGrid'\n  let format = 'A4'\n  let matiere = ''\n  let titre = ''\n  const nbQuestionsModif: number[] = []\n  const exercicesARetirer: string[] = []\n  let refsExercicesARetirer: string[]\n  $: refsExercicesARetirer = []\n\n  type NbQuestionsIndexees = {\n    indexExercice: number\n    nombre: number\n  }\n\n  let nbQuestions: Array<NbQuestionsIndexees> = []\n  let nbExemplaires = 1\n  let textForOverleaf: HTMLInputElement\n  let isNonAMCModaleDisplayed = false\n  let isOverleafModalDisplayed = false\n\n  async function initExercices() {\n    exercicesARetirer.length = 0\n    await mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    for (const exercice of exercices) {\n      isSettingsVisible.push(false)\n      context.isHtml = false\n      context.isAmc = true\n      seedrandom(exercice.seed, { global: true })\n      if (exercice.typeExercice === 'simple') {\n        mathaleaHandleExerciceSimple(exercice, false)\n      } else {\n        if (exercice.nouvelleVersionWrapper != null)\n          exercice.nouvelleVersionWrapper()\n      }\n      if (exercice.amcType == null) {\n        // l'exercice n'est pas disponible AMC\n        exercicesARetirer.push(exercice.uuid)\n        if (exercice.id != null) {\n          refsExercicesARetirer.push(exercice.id)\n        } else {\n          const proprietes: string[] = Object.values(exercice)\n          proprietes.shift()\n          refsExercicesARetirer.push(proprietes.join(' '))\n        }\n      }\n    }\n    exercices = exercices.filter(\n      (exercice) => !exercicesARetirer.includes(exercice.uuid),\n    )\n\n    refsExercicesARetirer = refsExercicesARetirer\n    // afficher le modal pour les exercices non AMC ?\n    isNonAMCModaleDisplayed = refsExercicesARetirer.length !== 0\n  }\n\n  initExercices()\n\n  $: {\n    // ToDo vrifier la saisie utilisateur\n    // Si les copies sont prremplies, c'est un seul exemplaire pour ne pas avoir plusieurs sujets avec le mme nom\n    if (entete === 'AMCassociation') nbExemplaires = 1\n    // On rcupre les nombres de questions par groupe index sur l'index d'exercice dans exercices\n    // la ligne suivante lve une erreur\n    // nbQuestions = nbQuestionsModif.map((elt, i) => {\n    //   if (elt !== null) return { indexExercice: i, nombre: elt }\n    // })\n    // on la remplace par une boucle classique\n    nbQuestions.length = 0\n    for (let i = 0; i < nbQuestionsModif.length; i++) {\n      nbQuestions.push({ indexExercice: i, nombre: nbQuestionsModif[i] })\n    }\n    nbQuestions = nbQuestions\n    // on blinde le nbExemplaires qui ne peut tre 0 ou undefined\n    if (nbExemplaires == null) nbExemplaires = 1\n    for (let i = 0; i < exercices.length; i++) {\n      const exo = exercices[i]\n      const nbQ = nbQuestions.find((elt, i) => elt.indexExercice === i)\n      if (nbQ != null) {\n        if (exo.nbQuestions < nbQ.nombre) {\n          exo.nbQuestions = nbQ.nombre * nbExemplaires\n          context.isHtml = false\n          context.isAmc = true\n          seedrandom(exo.seed, { global: true })\n          if (exo.typeExercice === 'simple') {\n            mathaleaHandleExerciceSimple(exo, false)\n          } else {\n            if (exo.nouvelleVersionWrapper != null) exo.nouvelleVersionWrapper()\n          }\n        }\n      }\n    }\n    content = creerDocumentAmc({\n      exercices,\n      typeEntete: entete,\n      format,\n      matiere,\n      titre,\n      nbQuestions: nbQuestions.map((elt) => elt.nombre),\n      nbExemplaires,\n    })\n  }\n\n  /* =======================================================\n   *\n   * Mcanismes de gestion du modal d'infos sur OverLeaf\n   *\n   */\n  let overleafForm: HTMLFormElement\n  // $: isNonAmcModal Visible = false\n  onMount(async () => {\n    overleafForm = document.getElementById('overleaf-form') as HTMLFormElement\n  })\n\n  /**\n   * Grer le POST pour Overleaf\n   */\n  function handleOverLeaf() {\n    textForOverleaf.value =\n      'data:text/plain;base64,' + btoa(unescape(encodeURIComponent(content)))\n    overleafForm.submit()\n    isOverleafModalDisplayed = false\n  }\n\n  // =======================================================\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"AMC\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n\n  <section\n    class=\"px-10 py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-lightest\"\n  >\n    <div\n      class=\"flex flex-col md:flex-row justify-start items-start my-4 space-y-5 md:space-y-0 md:space-x-10\"\n    >\n      <div>\n        <div class=\"pb-2 font-bold\">Type d'entte</div>\n        <FormRadio\n          bind:valueSelected={entete}\n          labelsValues={[\n            { label: 'Grille de codage', value: 'AMCcodeGrid' },\n            { label: 'Copies pr-remplies', value: 'AMCassociation' },\n            { label: 'Noms et prnoms manuscrits', value: 'manuscrits' },\n          ]}\n          title=\"entete\"\n        />\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Format\n        </div>\n        <FormRadio\n          bind:valueSelected={format}\n          labelsValues={[\n            { label: 'Format A4 portrait', value: 'A4' },\n            { label: 'Format A3 paysage 2 colonnes', value: 'A3' },\n          ]}\n          title=\"format\"\n        />\n      </div>\n    </div>\n    <div\n      class=\"flex flex-col md:flex-row justify-start items-start my-4 space-y-5 md:space-y-0 md:space-x-10\"\n    >\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Matire\n        </div>\n        <InputText\n          inputID=\"amc-export-matiere-input\"\n          bind:value={matiere}\n          showTitle={false}\n          classAddenda=\"ml-4 md:ml-0\"\n        />\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Titre\n        </div>\n        <InputText\n          inputID=\"amc-export-titre-input\"\n          bind:value={titre}\n          showTitle={false}\n          classAddenda=\"ml-4 md:ml-0\"\n        />\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Nombre de questions par groupe\n        </div>\n        {#each exercices as exercice, i}\n          <div>\n            {exercice.id}{exercice.sup\n              ? `-S:${exercice.sup}`\n              : ''}{exercice.sup2 ? `-S2:${exercice.sup2}` : ''}{exercice.sup3\n              ? `-S3:${exercice.sup3}`\n              : ''}\n            <InputText\n              inputID=\"amc-export-nb-questions-gr{i}-input\"\n              placeholder={exercice.nbQuestions.toString()}\n              bind:value={nbQuestionsModif[i]}\n              showTitle={false}\n              classAddenda=\"ml-4 md:ml-0\"\n            />\n            <span>{exercice.amcType ? exercice.amcType : 'not amcReady'}</span>\n            <button\n              class=\"mx-2 tooltip tooltip-left\"\n              data-tip=\"Nouvel nonc\"\n              id=\"amc-export-new-enonce-button\"\n              type=\"button\"\n              aria-label=\"Nouvel nonc\"\n              on:click={() => {\n                exercice.seed = mathaleaGenerateSeed()\n                seedrandom(exercice.seed, { global: true })\n                if (exercice.nouvelleVersionWrapper != null)\n                  exercice.nouvelleVersionWrapper()\n                $exercicesParams[i].alea = exercice.seed\n                mathaleaUpdateUrlFromExercicesParams()\n              }}\n              ><i\n                class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-refresh\"\n              ></i>\n            </button>\n            <!-- <button\n               class=\"tooltip tooltip-left tooltip-neutral\"\n               data-tip=\"Changer les paramtres de l'exercice\"\n               type=\"button\"\n               on:click={() => {\n    isSettingsVisible[i] = !isSettingsVisible[i]\n  }}\n             >\n               <i\n                 class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx {isSettingsVisible\n        ? 'bxs-cog'\n        : 'bx-cog'}\"\n               />\n             </button>\n            <div class=\"{isSettingsVisible[i] ? 'flex': 'hidden'} flex-col ...\">\n              <SettingsAmc {exercice}/>\n            </div>\n                         -->\n          </div>\n        {/each}\n        <div>\n          <BasicClassicModal\n            bind:isDisplayed={isNonAMCModaleDisplayed}\n            icon=\"bxs-error\"\n          >\n            <span slot=\"header\"></span>\n            <div slot=\"content\" class=\"text-justify\">\n              Les exercices suivants n'ayant pas de version AMC, ils ont t\n              retirs de la liste.\n              <ul class=\"list-inside list-disc text-left text-base mt-1\">\n                {#each refsExercicesARetirer as reference}\n                  <li>{reference}</li>\n                {/each}\n              </ul>\n            </div>\n          </BasicClassicModal>\n        </div>\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Nombre d'exemplaires distincts\n        </div>\n        <InputNumber\n          id=\"amc-nb-exemplaires\"\n          min={1}\n          max={100}\n          bind:value={nbExemplaires}\n        />\n      </div>\n    </div>\n\n    <div\n      class=\"flex flex-col md:flex-row justify-start items-start my-4 space-y-5 md:space-y-0 md:space-x-10 mt-8\"\n    >\n      <ButtonActionInfo\n        action=\"copy\"\n        textToCopy={content}\n        tooltip=\"Copier le code LaTeX dans le presse-papier\"\n        text=\"Copier le code LaTeX\"\n        inverted={false}\n        successMessage=\"Le code LaTeX a t copi dans le presse-papier\"\n        errorMessage=\"Impossible de copier le code dans le presse-papier !\"\n        displayDuration={3000}\n        class=\"px-2 py-1 rounded-md\"\n      />\n      <ButtonTextAction\n        class=\"px-2 py-1 rounded-md\"\n        id=\"open-btn\"\n        on:click={() => {\n          isOverleafModalDisplayed = true\n        }}\n        text=\"Compiler sur OverLeaf\"\n      />\n    </div>\n    <pre\n      class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">\n      {content}\n    </pre>\n  </section>\n  <!-- Message avant envoi sur Overleaf -->\n  <BasicClassicModal\n    bind:isDisplayed={isOverleafModalDisplayed}\n    icon=\"bxs-error\"\n  >\n    <span slot=\"header\">Attention !</span>\n    <ul class=\"list-inside list-disc text-left text-base\" slot=\"content\">\n      <li>Le fichier sorti d'Overleaf ne constitue qu'un aperu.</li>\n      <li>\n        Le fichier doit tre compil sous AMC imprativement pour que le fichier\n        soit fonctionnel.\n      </li>\n    </ul>\n    <div slot=\"footer\">\n      <ButtonTextAction\n        text=\"Compiler sur OverLeaf\"\n        on:click={handleOverLeaf}\n      />\n    </div>\n  </BasicClassicModal>\n  <!-- Formulaire pour Overleaf -->\n  <form\n    action=\"https://www.overleaf.com/docs\"\n    id=\"overleaf-form\"\n    method=\"POST\"\n    target=\"_blank\"\n  >\n    <input\n      type=\"hidden\"\n      name=\"snip_uri[]\"\n      value=\"https://coopmaths.fr/alea/static/amc/automultiplechoice.sty\"\n      autocomplete=\"off\"\n    />\n    <input\n      type=\"hidden\"\n      name=\"snip_name[]\"\n      value=\"automultiplechoice.sty\"\n      autocomplete=\"off\"\n    />\n    <input\n      autocomplete=\"off\"\n      bind:this={textForOverleaf}\n      name=\"snip_uri[]\"\n      type=\"hidden\"\n      value=\"\"\n    />\n    <input\n      autocomplete=\"off\"\n      name=\"snip_name[]\"\n      type=\"hidden\"\n      value=\"coopmaths.tex\"\n    />\n    <input autocomplete=\"off\" name=\"engine\" type=\"hidden\" value=\"lualatex\" />\n  </form>\n  <Footer />\n</main>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../exercices/Exercice'\n  import {\n    mathaleaGetExercicesFromParams,\n    mathaleaUpdateExercicesParamsFromUrl,\n  } from '../../../lib/mathalea.js'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n\n  type TypeNote = {\n    deckName: string\n    modelName: string\n    fields: {\n      Titre: string\n      url: string\n    }\n    options?: {\n      allowDuplicate?: boolean\n    }\n  }\n  const notes: TypeNote[] = []\n  let exercices: TypeExercice[]\n\n  let chargement = true\n\n  async function initExercices() {\n    mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    let i = 0\n    for (const param of $exercicesParams) {\n      let paramUrl = ''\n      for (const key of Object.keys(param)) {\n        if (key === 'sup') {\n          paramUrl += `s=${param[key]}&`\n        } else if (key === 'sup2') {\n          paramUrl += `s2=${param[key]}&`\n        } else if (key === 'sup3') {\n          paramUrl += `s3=${param[key]}&`\n        } else if (key === 'nbQuestions') {\n          paramUrl += `n=${param[key]}&`\n        } else if (key === 'versionQcm') {\n          paramUrl += `qcm\\\\=${param[key]}&`\n        } else if (key !== 'alea' && key !== 'id') {\n          paramUrl += `${key}=${param[key]}&`\n        }\n      }\n      paramUrl = paramUrl.slice(0, -1)\n\n      notes.push({\n        deckName: 'MathALA',\n        modelName: 'MathALEA',\n        fields: {\n          Titre: exercices[i].titre,\n          url: 'https://coopmaths.fr/alea/?' + paramUrl,\n        },\n      })\n      i++\n    }\n    chargement = false\n  }\n\n  initExercices()\n\n  let logs = ''\n\n  const ANKI_API_URL = new URL('http://127.0.0.1:8765')\n  // hostname // port\n\n  function ankiConnect(action: string, params = {}) {\n    console.info('ankiConnect:', action, '...')\n    return fetch(ANKI_API_URL, {\n      method: 'POST',\n      body: JSON.stringify({\n        action,\n        version: 6,\n        params,\n      }),\n    })\n      .then((r) => r.json())\n      .then((r) => {\n        if (r.error) {\n          throw new Error(r.error)\n        }\n        console.info('ankiConnect:', action, '... russi !')\n        return r.result\n      })\n      .catch((e) => {\n        console.error('ankiConnect:', action, '... chou !')\n        throw e\n      })\n  }\n\n  function importer() {\n    logs = ''\n\n    ankiConnect('requestPermission')\n      .then((r) => {\n        if (r.permission === 'granted') {\n          return ankiConnect('modelNames')\n        } else {\n          throw new Error('Permission not granted')\n        }\n      })\n      .then((r) => {\n        logs += 'Connexion  Anki russie\\n'\n        if (!r.includes('MathALEA')) {\n          logs += 'Cration du model MathALEA\\n'\n          return ankiConnect('createModel', {\n            modelName: 'MathALEA',\n            inOrderFields: ['Titre', 'url'],\n            css: '/*\\n  Author: Guillaume Valmont\\n  Date : November 5, 2023\\n  Licence: CC-BY-SA 4.0\\n  https://forge.apps.education.fr/anki-templates/mathalea\\n*/\\n\\n.loader-container {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  height: 75vh;\\n}\\n\\n.loader {\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 100%;\\n  max-width: 15rem;\\n}\\n\\n.loading-text {\\n  position: absolute;\\n  color: #f15929;\\n  font-size: 1.5rem;\\n}\\n\\n.loader:before,\\n.loader:after {\\n  content: \"\";\\n  position: absolute;\\n  border-radius: 50%;\\n  animation: pulsOut 1.8s ease-in-out infinite;\\n  filter: drop-shadow(0 0 1rem rgba(241, 89, 41, 0.75));\\n  backface-visibility: hidden;\\n}\\n\\n.loader:before {\\n  width: 100%;\\n  padding-bottom: 100%;\\n  box-shadow: inset 0 0 0 1rem #f15929;\\n  animation-name: pulsIn;\\n}\\n\\n.loader:after {\\n  width: calc(100% - 2rem);\\n  padding-bottom: calc(100% - 2rem);\\n  box-shadow: 0 0 0 0 #f15929;\\n}\\n\\n@keyframes pulsIn {\\n  0% {\\n    box-shadow: inset 0 0 0 1rem #f15929;\\n    opacity: 1;\\n  }\\n  50%, 100% {\\n    box-shadow: inset 0 0 0 0 #f15929;\\n    opacity: 0;\\n  }\\n}\\n\\n@keyframes pulsOut {\\n  0%, 50% {\\n    box-shadow: 0 0 0 0 #f15929;\\n    opacity: 0;\\n  }\\n  100% {\\n    box-shadow: 0 0 0 1rem #f15929;\\n    opacity: 1;\\n  }\\n}\\n',\n            // \"isCloze\": false,\n            cardTemplates: [\n              {\n                Name: 'Card 1',\n                Front:\n                  '\\x3C!-- \\n  Author: Guillaume Valmont\\n  Date : November 15, 2023\\n  Licence: CC-BY-SA 4.0\\n  https://forge.apps.education.fr/anki-templates/mathalea\\n-->\\n\\n<link rel=\"stylesheet\" href=\"https://coopmaths.fr/alea/anki/mathalea-anki-style.css\">\\n\\n<div id=\\'recto-iframe-container\\'>\\n  <div class=\"loader-container\">\\n    <div class=\"loader\">\\n      <span class=\"loading-text\">Chargement</span>\\n    </div>\\n  </div>\\n</div>\\n\\n\\x3Cscript src=\"https://coopmaths.fr/alea/anki/mathalea-anki-script.js\" onload=\"executeIframeUpdate()\">\\x3C/script>\\n\\n\\x3Cscript>\\n  function executeIframeUpdate() {\\n    rectoIframeUpdate((function () {/* {{url}} */ }).toString())\\n  }\\n\\x3C/script>\\n',\n                Back: '\\x3C!-- \\n  Author: Guillaume Valmont\\n  Date : November 15, 2023\\n  Licence: CC-BY-SA 4.0\\n  https://forge.apps.education.fr/anki-templates/mathalea\\n-->\\n\\n<link rel=\"stylesheet\" href=\"https://coopmaths.fr/alea/anki/mathalea-anki-style.css\">\\n\\n<div id=\\'verso-iframe-container\\'>\\n  <div class=\"loader-container\">\\n    <div class=\"loader\">\\n      <span class=\"loading-text\">Chargement</span>\\n    </div>\\n  </div>\\n</div>\\n\\n\\x3Cscript src=\"https://coopmaths.fr/alea/anki/mathalea-anki-script.js\" onload=\"executeIframeUpdate()\">\\x3C/script>\\n\\n\\x3Cscript>\\n  function executeIframeUpdate() {\\n    versoIframeUpdate((function () {/* {{url}} */ }).toString())\\n  }\\n\\x3C/script>\\n',\n              },\n            ],\n          })\n        }\n      })\n      .then(() => {\n        // Le deck ne sera cr que s'il n'existe pas\n        return ankiConnect('createDeck', {\n          deck: 'MathALA',\n        })\n      })\n      .then(() => {\n        return ankiConnect('canAddNotes', {\n          notes,\n        })\n      })\n      .then((can) => {\n        return ankiConnect('addNotes', {\n          notes: notes.filter((note, i) => can[i]), // On n'ajoute que les notes qui peuvent l'tre (vite les doublons)\n        })\n      })\n      .then((r) => {\n        const nbExos = r.length\n        const nbExosDejaPresent = notes.length - r.length\n        logs += `${nbExos} ${nbExos > 1 ? 'exercices imports' : 'exercice import'} ${nbExosDejaPresent ? `(dont ${nbExosDejaPresent} dj prsent${nbExosDejaPresent > 1 ? 's' : ''}) ` : ''}dans Anki avec succs !\\n`\n      })\n      .catch((e) => {\n        logs += \"ERREUR, L'IMPORTATION N'A PAS RUSSI :\\n\\t\" + e + '\\n'\n        logs += 'Veuillez vrifier que :\\n'\n        logs += '- Anki est bien install sur votre ordinateur\\n'\n        logs += '- Le plugin AnkiConnect est bien install et activ\\n'\n        logs += '- Anki est bien actuellement lanc\\n'\n      })\n  }\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"Anki\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n\n  <section\n    class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <h1\n      class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Comment l'utiliser ?\n    </h1>\n\n    <p\n      class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n    >\n      MathALA vous permet d'importer automatiquement les exercices slectionn\n      dans Anki.<br />\n      Cette interface ncessite que\n      <a\n        href=\"https://apps.ankiweb.net/\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-coopmaths-action dark:text-coopmathsdark-action\">Anki</a\n      >\n      soit install sur votre ordinateur avec le plugin\n      <a\n        href=\"https://ankiweb.net/shared/info/2055492159\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n        >AnkiConnect</a\n      >\n      et que Anki soit <strong>actuellement lanc</strong> sur votre ordinateur.<br\n      />Veuillez consulter la\n      <a\n        href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Anki\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n        >documentation</a\n      > pour plus d'information.\n    </p>\n    <h1\n      class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Importation\n    </h1>\n\n    <div\n      class=\"flex flex-row w-full justify-center md:justify-start items-center\"\n    >\n      {#if !chargement}\n        <button\n          type=\"submit\"\n          on:click={importer}\n          class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n        >\n          <i class=\"bx bx-download mr-2\"></i>Importer les exercices dans Anki\n        </button>\n      {/if}\n    </div>\n    <div\n      class=\"flex flex-row w-full justify-center md:justify-start items-center\"\n    >\n      {#if logs}\n        <pre\n          class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">{logs}</pre>\n      {/if}\n    </div>\n  </section>\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import {\n    getBlobFromImageElement,\n    copyBlobToClipboard,\n    canCopyImagesToClipboard,\n  } from 'copy-image-clipboard'\n  import BasicClassicModal from '../modal/BasicClassicModal.svelte'\n  import ButtonIconTooltip from './ButtonIconTooltip.svelte'\n  import BasicInfoModal from '../modal/BasicInfoModal.svelte'\n  import QRCode from 'qrcode'\n  import { notify } from '../../../bugsnag'\n  import { mathaleaGenerateSeed } from '../../../lib/mathalea'\n  import { buildMathAleaURL } from '../../../lib/components/urls'\n\n  export let customUrl: string = ''\n  export let icon: string = 'bx-qr text-2xl'\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n  export let tooltip: string = ''\n  export let useCurrentUrl: boolean = false\n  export let removeSeed: boolean = false\n\n  const imageId: string = mathaleaGenerateSeed()\n\n  const QRCodeOptions = {\n    errorCorrectionLevel: 'M',\n    type: 'image/png',\n    quality: 0.9,\n    margin: 1,\n    scale: 2,\n    width: 400,\n    color: {\n      dark: '#000',\n      light: '#fff',\n    },\n  }\n\n  let isDisplayed = false\n  let QRCodeCopyState: 'success' | 'error' | 'none' = 'none'\n\n  async function updateQRCodeImage() {\n    const url = useCurrentUrl\n      ? buildMathAleaURL({ removeSeed }).toString()\n      : customUrl\n    QRCode.toDataURL(url, QRCodeOptions, (error: Error, url: string) => {\n      const imageElement = document.getElementById(imageId)\n      if (!imageElement || !(imageElement instanceof HTMLImageElement)) {\n        notify('QR-Code image element not found', { imageId })\n        return\n      }\n      if (error) {\n        notify('Error generating QR-Code', { error })\n        return\n      }\n      imageElement.setAttribute('src', url)\n    })\n  }\n\n  async function copyQRCodeImageToClipboard() {\n    updateQRCodeImage()\n    const imageElement = document.getElementById(imageId)\n    if (!imageElement || !(imageElement instanceof HTMLImageElement)) {\n      notify(`ImageElement with ID: ${imageId} not found.`, {})\n      QRCodeCopyState = 'error'\n      return\n    }\n\n    if (!canCopyImagesToClipboard()) {\n      console.error('Copying images to clipboard is not supported.')\n      QRCodeCopyState = 'error'\n      return\n    }\n\n    try {\n      const blob = await getBlobFromImageElement(imageElement)\n      await copyBlobToClipboard(blob)\n      QRCodeCopyState = 'success'\n    } catch (error) {\n      notify('Error copying QR Code to clipboard:', { error })\n      QRCodeCopyState = 'error'\n    }\n  }\n\n  async function downloadQRCodeImage() {\n    updateQRCodeImage()\n    const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, '')\n\n    const imageElement = document.getElementById(imageId)\n    if (!imageElement || !(imageElement instanceof HTMLImageElement)) {\n      notify('QR-Code image element not found', { imageId, imageElement })\n      return\n    }\n\n    const imageSrc = imageElement.getAttribute('src')\n    if (!imageSrc) {\n      notify(`Image with ID: ${imageId} has no attribute \"src\".`, {})\n      return\n    }\n\n    try {\n      const response = await fetch(imageSrc)\n      const blob = await response.blob()\n      const url = window.URL.createObjectURL(blob)\n\n      // Creating virtual link for download\n      const downloadLink = document.createElement('a')\n      downloadLink.style.display = 'none'\n      downloadLink.href = url\n      downloadLink.download = `qrcode_coopmaths_${timestamp}.png`\n      document.body.appendChild(downloadLink)\n      downloadLink.click()\n      window.URL.revokeObjectURL(url)\n    } catch (error) {\n      notify('Error downloading the QR Code image:', { error })\n    }\n  }\n</script>\n\n<ButtonIconTooltip\n  {icon}\n  {cornerIcon}\n  {cornerIconClass}\n  {tooltip}\n  on:click={() => {\n    updateQRCodeImage()\n    isDisplayed = !isDisplayed\n  }}\n/>\n\n<BasicClassicModal bind:isDisplayed>\n  <h3 slot=\"header\">QR-Code</h3>\n  <div slot=\"content\" class=\"flex flex-col items-center\">\n    <div class=\"flex flex-col justify-center\">\n      <div class=\"flex flex-row justify-center p-4\">\n        <img id={imageId} alt=\"QR-Code\" width=\"200px\" />\n      </div>\n    </div>\n  </div>\n  <div slot=\"footer\">\n    <div class=\"flex flex-row justify-center\">\n      <ButtonIconTooltip\n        icon=\"bx-copy-alt text-[30px] mx-3\"\n        tooltip=\"Copier le QR-Code\"\n        on:click={copyQRCodeImageToClipboard}\n      />\n      <ButtonIconTooltip\n        icon=\"bx-download text-[30px] mx-3\"\n        tooltip=\"Tlcharger le QR-Code\"\n        on:click={downloadQRCodeImage}\n      />\n    </div>\n  </div>\n</BasicClassicModal>\n\n<BasicInfoModal\n  bind:contentDisplayed={QRCodeCopyState}\n  successMessage=\"Le QR-Code est copi dans le presse-papier !\"\n  errorMessage=\"Impossible de copier le QR-Code dans ce navigateur !<br /> Vrifier les permissions.\"\n/>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../lib/components/time'\n\n  export let title: string\n  export let explanations = [\"Text when it's on\", \"Text when it's off\"]\n  export let value: boolean = true\n  export let isDisabled: boolean = false\n  export let inLine: boolean = false\n  export let id = ['toggle-', getUniqueStringBasedOnTimeStamp()].join('')\n  const dispatch = createEventDispatcher()\n\n  function toggle() {\n    value = !value\n    dispatch('toggle')\n  }\n</script>\n\n<div\n  {id}\n  class=\"flex justify-start {$$props.class} {inLine\n    ? 'flex-row items-center'\n    : 'flex-col items-start'}\"\n>\n  <div class=\"flex flex-row items-center space-x-1\">\n    <input\n      class=\"mr-2 mt-[0.3rem] h-3 w-8 appearance-none rounded-[0.4375rem] bg-coopmaths-canvas border-coopmaths-action dark:border-coopmathsdark-action disabled:border-coopmaths-action/10 dark:disabled:border-coopmathsdark-action/10 before:pointer-events-none before:absolute before:h-3 before:w-3 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-4 after:w-4 after:rounded-full after:border disabled:after:border-coopmaths-action/10 dark:disabled:after:border-coopmathsdark-action/0 after:border-coopmaths-action dark:after:border-coopmathsdark-action after:bg-coopmaths-canvas-darkest after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-coopmaths-action checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-4 checked:after:w-4 checked:after:rounded-full checked:after:border-none checked:after:bg-coopmaths-action checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-4 focus:after:w-4 focus:after:rounded-full focus:after:content-[''] checked:focus:border-coopmaths-action checked:focus:bg-coopmaths-action checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 dark:bg-coopmathsdark-canvas dark:after:bg-coopmathsdark-canvas-darkest dark:checked:bg-coopmathsdark-action dark:checked:after:bg-coopmathsdark-action\"\n      type=\"checkbox\"\n      role=\"switch\"\n      id=\"input-{id}\"\n      disabled={isDisabled}\n      on:change={toggle}\n      checked={value}\n    />\n    <label\n      class=\"inline-block pl-[0.15rem] hover:cursor-pointer text-sm\n      {value ? 'font-semibold' : 'font-light'}\n      {isDisabled\n        ? 'text-coopmaths-corpus/10 dark:text-coopmathsdark-corpus/10'\n        : 'text-coopmaths-corpus/70 dark:text-coopmathsdark-corpus/70'}\"\n      for=\"input-{id}\"\n    >\n      {title}\n    </label>\n  </div>\n  <div\n    class=\"flex flex-row font-light text-xs\n    {isDisabled\n      ? 'text-coopmaths-corpus/10 dark:text-coopmathsdark-corpus/10'\n      : 'text-coopmaths-corpus/70 dark:text-coopmathsdark-corpus/70'}\n    {inLine ? 'px-2 mt-[0.1125rem]' : 'p-2'}\"\n  >\n    {#if value}\n      {explanations[0]}\n    {:else}\n      {explanations[1]}\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n\n  type Tab = {\n    id: string\n    label: string\n    ariaControls?: string\n  }\n\n  export let tabs: Tab[]\n  export let activeTab: string\n\n  const dispatch = createEventDispatcher<{ change: string }>()\n\n  function handleClick(tabId: string) {\n    dispatch('change', tabId)\n  }\n</script>\n\n<ul\n  class=\"flex list-none flex-row flex-wrap border-b-0 pl-0 pt-0 bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas\"\n  role=\"tablist\"\n>\n  {#each tabs as tab}\n    <li role=\"presentation\" class=\"flex-grow basis-0 text-center\">\n      <button\n        type=\"button\"\n        id=\"{tab.id}-btn\"\n        class=\"relative block w-full font-extrabold px-7 pb-3.5 pt-4 text-base uppercase leading-tight hover:isolate focus:isolate\n        {activeTab === tab.id\n          ? 'bg-coopmaths-canvas text-coopmaths-struct dark:bg-coopmathsdark-canvas dark:text-coopmathsdark-struct'\n          : 'bg-coopmaths-canvas-darkest text-coopmaths-action dark:bg-coopmathsdark-canvas-darkest dark:text-coopmathsdark-action hover:bg-coopmaths-action/10 dark:hover:bg-coopmathsdark-action/20'}\"\n        role=\"tab\"\n        aria-controls={tab.ariaControls ?? tab.id}\n        aria-selected={activeTab === tab.id}\n        on:click={() => handleClick(tab.id)}\n      >\n        {tab.label}\n      </button>\n    </li>\n  {/each}\n</ul>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import { buildMathAleaURL } from '../../../lib/components/urls'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea.js'\n  import { canOptions } from '../../../lib/stores/canStore'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonQRCode from '../../shared/forms/ButtonQRCode.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import ButtonToggleAlt from '../../shared/forms/ButtonToggleAlt.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import InputNumber from '../../shared/forms/InputNumber.svelte'\n  import InputText from '../../shared/forms/InputText.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import Tabs from '../../shared/ui/Tabs.svelte'\n\n  $: activeTab = $canOptions.isChoosen ? 'can' : 'classic'\n\n  const tabs = [\n    {\n      id: 'classic',\n      label: 'Prsentation classique',\n      ariaControls: 'tabs-pres-classic',\n    },\n    { id: 'can', label: 'Course aux nombres', ariaControls: 'tabs-pres-can' },\n  ]\n\n  function handleTabChange(e: CustomEvent<string>) {\n    if (e.detail === 'classic') {\n      $canOptions.isChoosen = false\n    } else {\n      $canOptions.isChoosen = true\n      toggleCan()\n    }\n  }\n\n  onMount(() => {\n    handleSeed()\n  })\n\n  const availableLinkFormats = {\n    clear: {\n      toolTipsMessage: 'En clair',\n      icon: 'bx-glasses-alt',\n      isShort: false,\n      isEncrypted: false,\n    },\n    short: {\n      toolTipsMessage: 'Raccourci',\n      icon: 'bx-move-horizontal',\n      isShort: true,\n      isEncrypted: false,\n    },\n    crypt: {\n      toolTipsMessage: 'Crypt',\n      icon: 'bx-lock',\n      isShort: false,\n      isEncrypted: true,\n    },\n  }\n  $: $canOptions.isInteractive = $globalOptions.setInteractive === '1'\n  type LinkFormat = keyof typeof availableLinkFormats\n  let currentLinkFormat: LinkFormat = 'clear'\n  let setInteractive: string = $globalOptions.setInteractive ?? '2'\n  let presMode:\n    | 'liste_exos'\n    | 'un_exo_par_page'\n    | 'une_question_par_page'\n    | 'recto'\n    | 'verso' = $globalOptions.presMode ?? 'liste_exos'\n\n  /**\n   * Construit l'URL correspondant aux choix de la page de configuration et bascule sur cette page\n   */\n  function handleVueSetUp() {\n    const nextView = $canOptions.isChoosen ? 'can' : 'eleve'\n    const url = buildMathAleaURL({\n      view: nextView,\n      isEncrypted: availableLinkFormats[currentLinkFormat].isEncrypted,\n      removeSeed: isDataRandom,\n    })\n    window.open(url, '_blank')?.focus()\n  }\n\n  // Gestion de la graine\n  let isDataRandom: boolean = false\n  function handleSeed() {\n    for (const param of $exercicesParams) {\n      if (!isDataRandom && param.alea === undefined) {\n        param.alea = mathaleaGenerateSeed()\n      } else if (isDataRandom) {\n        param.alea = undefined\n      }\n    }\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n  }\n\n  function toggleCan() {\n    if ($canOptions.isChoosen) {\n      $globalOptions.setInteractive = '1'\n    }\n  }\n</script>\n\n<main\n  class=\" {$darkMode.isActive\n    ? 'dark'\n    : ''} mb-auto flex flex-col min-h-screen justify-start bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n>\n  <NavBar\n    subtitle=\"La page lve\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n  <div\n    class=\"flex flex-col h-full w-full bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <div\n      class=\"h-full w-full md:w-2/3 lg:w-3/5 flex flex-col px-4 pb-4 md:py-10 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark mx-auto\"\n    >\n      <div\n        class=\"flex flex-col md:flex-row justify-start px-4 py-4 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <h3\n          class=\"font-bold text-2xl text-coopmaths-struct dark:text-coopmathsdark-struct bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n        >\n          Rglages\n        </h3>\n      </div>\n      <!-- Tabulations pour la prsentation -->\n      <Tabs {tabs} {activeTab} on:change={handleTabChange} />\n      <!-- Pages des rglages -->\n      <div class=\"pb-6 pt-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n        <div\n          class=\"transition-opacity duration-150 ease-linear {activeTab ===\n          'classic'\n            ? 'block opacity-100'\n            : 'hidden opacity-0'}\"\n          id=\"tabs-pres-classic\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-pres-classic-btn\"\n        >\n          <!-- Prsentation classique -->\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            Les exercices seront poss suivant les rglages ci-dessous.\n          </div>\n          <div class=\"pt-2 px-4 grid grid-flow-row md:grid-cols-3 gap-4\">\n            <div class=\"pb-2 w-full flex flex-col\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Prsentation\n              </div>\n              <div\n                class=\"pl-4 pb-4 w-full flex flex-row justify-start items-center space-x-2\"\n              >\n                <div\n                  class=\"text-sm font-light w-1/4 text-coopmaths-corpus/70 dark:text-coopmathsdark-corpus/70\"\n                >\n                  Titre :\n                </div>\n                <InputText\n                  inputID=\"config-eleve-titre-input\"\n                  bind:value={$globalOptions.title}\n                  showTitle={false}\n                  classAddenda=\"w-1/2 font-light\"\n                />\n                <div\n                  class=\"mt-1 text-coopmaths-corpus font-light italic text-xs {$globalOptions.title &&\n                  $globalOptions.title.length === 0\n                    ? ''\n                    : 'invisible'}\"\n                >\n                  Pas de bandeau si laiss vide.\n                </div>\n              </div>\n              <FormRadio\n                title=\"prsentation\"\n                bind:valueSelected={presMode}\n                on:newvalue={() => ($globalOptions.presMode = presMode)}\n                labelsValues={[\n                  {\n                    label: 'Tous les exercices sur une page',\n                    value: 'liste_exos',\n                  },\n                  {\n                    label: 'Une page par exercice',\n                    value: 'un_exo_par_page',\n                    isDisabled: $exercicesParams.length === 1,\n                  },\n                  {\n                    label: 'Une page par question',\n                    value: 'une_question_par_page',\n                  },\n                  // { label: 'Cartes', value: 'cartes' }\n                ]}\n              />\n              <div class=\"pl-4 pt-4\">\n                <ButtonToggleAlt\n                  title={'Deux colonnes'}\n                  isDisabled={$globalOptions.presMode === 'un_exo_par_page' ||\n                    $globalOptions.presMode === 'une_question_par_page'}\n                  bind:value={$globalOptions.twoColumns}\n                  id={'config-eleve-nb-colonnes-toggle'}\n                  explanations={[\n                    'Les exercices seront prsents sur deux colonnes.',\n                    'Les exercices seront prsents sur une seule colonne.',\n                  ]}\n                />\n              </div>\n            </div>\n\n            <div class=\"pb-2\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Interactivit\n              </div>\n              <FormRadio\n                title=\"Interactif\"\n                bind:valueSelected={setInteractive}\n                on:newvalue={() =>\n                  ($globalOptions.setInteractive = setInteractive)}\n                labelsValues={[\n                  { label: 'Laisser tel quel', value: '2' },\n                  { label: 'Tout interactif', value: '1' },\n                  { label: \"Pas d'interactivit\", value: '0' },\n                ]}\n              />\n              <div class=\"pl-2 pt-4\">\n                <ButtonToggleAlt\n                  title={\"Modifier l'interactivit\"}\n                  bind:value={$globalOptions.isInteractiveFree}\n                  id={'config-eleve-interactif-permis-toggle'}\n                  explanations={[\n                    \"Les lves peuvent rendre l'exercice interactif ou pas.\",\n                    \"Les lves ne pourront pas changer le status de l'interactivit.\",\n                  ]}\n                />\n              </div>\n              <div class=\"pl-2 pt-2\">\n                <ButtonToggleAlt\n                  title={'Une seule rponse'}\n                  isDisabled={$globalOptions.setInteractive === '0'}\n                  bind:value={$globalOptions.oneShot}\n                  id={'config-eleve-refaire-toggle'}\n                  explanations={[\n                    \"Les lves n'auront qu'une seule possibilit pour rpondre aux exercices.\",\n                    \"Les lves pourront refaire les exercices autant de fois qu'ils le souhaitent.\",\n                  ]}\n                />\n              </div>\n            </div>\n            <div class=\"pb-2\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Correction\n              </div>\n              <div class=\"flex flex-row justify-start items-center px-4\">\n                <ButtonToggleAlt\n                  title={'Accs aux corrections'}\n                  bind:value={$globalOptions.isSolutionAccessible}\n                  id={'config-eleve-acces-corrections-toggle'}\n                  explanations={[\n                    'Les lves pourront accder aux corrections en cliquant sur un bouton.',\n                    \"Les lves n'auront aucun moyen de voir la correction.\",\n                  ]}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <div\n          class=\"transition-opacity duration-150 ease-linear\n          {activeTab === 'can' ? 'block opacity-100' : 'hidden opacity-0'}\"\n          id=\"tabs-pres-can\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-pres-can-btn\"\n        >\n          <!-- Can -->\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            Les questions seront poses les unes  la suite des autres en temps\n            limit.\n          </div>\n          <div class=\"pt-2 px-4 grid grid-flow-row md:grid-cols-2 gap-4\">\n            <div class=\"pb-2 w-full flex flex-col\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Prsentation\n              </div>\n              <div\n                class=\"flex flex-col items-start justify-start space-y-2 px-4\"\n              >\n                <div class=\"flex justify-start flex-row items-center space-x-2\">\n                  <div\n                    class=\"text-sm font-light {$canOptions.isChoosen\n                      ? 'text-coopmaths-corpus-light dark:text-coopmathsdark-corpus'\n                      : 'text-coopmaths-corpus-light/10 dark:text-coopmathsdark-corpus/10'}\"\n                  >\n                    Dure&nbsp;:\n                  </div>\n                  <InputNumber\n                    id=\"config-eleve-can-duration-input\"\n                    min={1}\n                    max={60}\n                    bind:value={$canOptions.durationInMinutes}\n                    isDisabled={!$canOptions.isChoosen}\n                  />\n                  <div\n                    class=\"text-sm font-light {$canOptions.isChoosen\n                      ? 'text-coopmaths-corpus-light dark:text-coopmathsdark-corpus'\n                      : 'text-coopmaths-corpus-light/10 dark:text-coopmathsdark-corpus/10'}\"\n                  >\n                    minute{$canOptions.durationInMinutes !== undefined &&\n                    $canOptions.durationInMinutes > 1\n                      ? 's'\n                      : ''}.\n                  </div>\n                </div>\n                <div class=\"flex justify-start flex-row items-center space-x-2\">\n                  <div\n                    class=\"text-sm font-light {$canOptions.isChoosen\n                      ? 'text-coopmaths-corpus-light dark:text-coopmathsdark-corpus'\n                      : 'text-coopmaths-corpus-light/10 dark:text-coopmathsdark-corpus/10'}\"\n                  >\n                    Sous-titre :\n                  </div>\n                  <InputText\n                    inputID=\"config-eleve-can-subtitle-input\"\n                    bind:value={$canOptions.subTitle}\n                    isDisabled={!$canOptions.isChoosen}\n                    showTitle={false}\n                    classAddenda=\"w-1/2 font-light\"\n                  />\n                </div>\n              </div>\n            </div>\n            <div class=\"pb-2\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Solutions\n              </div>\n              <div\n                class=\"flex flex-col items-start justify-start space-y-2 px-4\"\n              >\n                <ButtonToggleAlt\n                  title={'Accs aux solutions'}\n                  id={'config-eleve-solutions-can-toggle'}\n                  bind:value={$canOptions.solutionsAccess}\n                  isDisabled={!$canOptions.isChoosen}\n                  explanations={[\n                    'Les lves auront accs aux solutions dans le format dfini ci-dessous.',\n                    \"Les lves n'auront pas accs aux solutions.\",\n                  ]}\n                />\n                <FormRadio\n                  title=\"can-solutions-config\"\n                  bind:valueSelected={$canOptions.solutionsMode}\n                  isDisabled={!$canOptions.isChoosen ||\n                    !$canOptions.solutionsAccess}\n                  labelsValues={[\n                    {\n                      label: 'Solutions rassembles  la fin.',\n                      value: 'gathered',\n                    },\n                    {\n                      label: 'Solutions avec les questions.',\n                      value: 'split',\n                    },\n                  ]}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div\n        class=\"pt-2 pl-2 grid grid-flow-row md:grid-cols-2 gap-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      >\n        <div class=\"pb-2\">\n          <div\n            class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            Donnes\n          </div>\n          <div class=\"flex flex-row justify-start items-center px-4\">\n            <ButtonToggleAlt\n              title={'Donnes diffrentes'}\n              bind:value={isDataRandom}\n              id={'config-eleve-donnes-differentes-toggle'}\n              explanations={[\n                \"Chaque lve aura des pages avec des donnes diffrentes d'un autre lve.\",\n                'Tous les lves auront des pages identiques.',\n              ]}\n            />\n          </div>\n        </div>\n        <div class=\"pb-2\">\n          <div\n            class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            Affichage du titre de l'exercice\n          </div>\n          <div class=\"flex flex-row justify-start items-center px-4\">\n            <ButtonToggleAlt\n              title={\"Titre de l'exercice\"}\n              bind:value={$globalOptions.isTitleDisplayed}\n              id={'config-eleve-title-displayed-toggle'}\n              explanations={[\n                'Les titres sont affichs',\n                'Les titres sont masqus.',\n              ]}\n              on:toggle={handleSeed}\n            />\n          </div>\n        </div>\n      </div>\n      <div\n        class=\"pt-4 pb-8 px-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      >\n        <ButtonTextAction\n          on:click={handleVueSetUp}\n          class=\"px-2 py-1 rounded-md\"\n          text=\"Visualiser\"\n        />\n      </div>\n      <div\n        class=\"flex flex-row justify-start px-4 pt-4 pb-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <h3\n          class=\"font-bold text-2xl text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          Utilisation\n        </h3>\n      </div>\n      <div class=\"py-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n        <div\n          class=\"flex flex-col md:flex-row justify-start space-x-10 items-start md:items-center px-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          <div\n            class=\"text-coopmaths-struct-light dark:text-coopmathsdark-struct-light font-semibold\"\n          >\n            Format de l'URL\n          </div>\n          <div class=\"flex\">\n            <FormRadio\n              title=\"linkFormat\"\n              bind:valueSelected={currentLinkFormat}\n              labelsValues={[\n                { label: 'En clair', value: 'clear' },\n                { label: 'Crypt', value: 'crypt' },\n                { label: 'Raccourci', value: 'short', isDisabled: true },\n              ]}\n              orientation=\"row\"\n            />\n          </div>\n        </div>\n        <div\n          class=\"flex flex-row justify-start items-start space-x-10 pt-3 pl-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          <div class=\"flex flex-col items-center px-2\">\n            <div\n              class=\"text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-light font-semibold\"\n            >\n              Lien\n            </div>\n            <div class=\"my-1\">\n              <ButtonActionInfo\n                action=\"copy\"\n                textToCopy={buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\n                tooltip={'Lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage}\n                icon={'bx-link text-2xl'}\n                cornerIcon={availableLinkFormats[currentLinkFormat].icon}\n                messageSuccess=\"Le lien de la fiche lve est copi dans le presse-papier !\"\n                messageError=\"Impossible de copier le lien dans le presse-papier !\"\n              />\n            </div>\n          </div>\n          <div class=\"flex flex-col justify-center items-center px-2\">\n            <div\n              class=\"font-semibold\n              text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-lightest\"\n            >\n              QR-Code\n            </div>\n            <div class=\"my-1\">\n              <ButtonQRCode\n                tooltip={'QR-code (lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage +\n                  ')'}\n                customUrl={buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\n                cornerIcon={availableLinkFormats[currentLinkFormat].icon}\n              />\n            </div>\n          </div>\n          <div class=\"flex flex-col justify-center items-center px-2\">\n            <div\n              class=\"text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-light font-semibold\"\n            >\n              Embarqu\n            </div>\n            <div class=\"my-1\">\n              <ButtonActionInfo\n                action=\"copy\"\n                textToCopy={`<iframe src=\"${buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\" width=\"100%\" height=\"100%\" frameborder=\"0\" allowfullscreen></iframe>`}\n                tooltip={'Code (lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage +\n                  ')'}\n                icon={'bx-code-alt text-2xl'}\n                cornerIcon={availableLinkFormats[currentLinkFormat].icon}\n                messageSuccess=\"Le code de la fiche lve est copi dans le presse-papier !\"\n                messageError=\"Impossible de copier le code dans le presse-papier !\"\n              />\n            </div>\n          </div>\n          <div class=\"flex flex-col justify-center items-center px-2\">\n            <div\n              class=\"text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-light font-semibold\"\n            >\n              Fichier\n            </div>\n            <div class=\"my-1\">\n              <ButtonActionInfo\n                action=\"download\"\n                urlToDownload={buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\n                fileName={$globalOptions.title\n                  ? $globalOptions.title\n                  : 'mathAlea'}\n                successMessage=\"Le tlchargement va dbut dans quelques instants.\"\n                errorMessage=\"Impossible de tlcharger le fichier.\"\n                tooltip={'Fichier de redirection (lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage +\n                  ')'}\n                icon={'bxs-file-export text-2xl'}\n                cornerIcon={availableLinkFormats[currentLinkFormat].icon}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <Footer />\n</main>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-zoom-out text-3xl\"\n  tooltip=\"Rduire la taille du texte\"\n  on:click={() => zoomUpdate('-')}\n/>\n<ButtonIconTooltip\n  icon=\"bx-zoom-in text-3xl\"\n  tooltip=\"Augmenter la taille du texte\"\n  on:click={() => zoomUpdate('+')}\n/>\n","<script lang=\"ts\">\n  export let isQuestionsVisible: boolean | undefined\n  export let isCorrectionVisible: boolean | undefined\n  export let currentVue: number\n  export let nbOfVues: 0 | 1 | 2 | 3 | 4\n  export let setCurrentVue: (value: number) => void\n  export let setQuestionsVisible: (value: boolean) => void\n  export let setCorrectionVisible: (value: boolean) => void\n  export let handleCorrectionsStepsClick: (\n    button: 'backward' | 'forward',\n  ) => void\n  export let newDataForAll: () => void\n  export let backToSettings: () => void\n</script>\n\n<div\n  class=\"flex flex-col items-center w-14 min-h-screen py-4\n  bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\n  text-coopmaths-struct dark:text-coopmathsdark-struct\"\n>\n  <button\n    type=\"button\"\n    class=\"pb-8\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    aria-label=\"Retour aux paramtres\"\n    on:click={backToSettings}\n  >\n    <i class=\"bx bx-sm bx-arrow-back\"></i>\n  </button>\n  <button\n    type=\"button\"\n    class=\"pb-8\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    aria-label=\"Nouvel nonc pour tous les exercices\"\n    on:click={newDataForAll}\n  >\n    <i class=\"bx bx-sm bx-refresh\"></i>\n  </button>\n\n  <span\n    class=\"text-xs\n    {isQuestionsVisible ? 'font-bold' : 'font-light'}\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Questions\n  </span>\n  <button\n    type=\"button\"\n    aria-label={isQuestionsVisible\n      ? 'Masquer les questions'\n      : 'Afficher les questions'}\n    on:click={() => setQuestionsVisible(!isQuestionsVisible)}\n  >\n    <i\n      class=\"bx bx-sm cursor-pointer\n      {isQuestionsVisible ? 'bx-toggle-right' : 'bx-toggle-left'}\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    ></i>\n  </button>\n  <span\n    class=\"text-xs pt-2\n    {isCorrectionVisible ? 'font-bold' : 'font-light'}\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Rponses\n  </span>\n  <button\n    type=\"button\"\n    aria-label={isCorrectionVisible\n      ? 'Masquer les rponses'\n      : 'Afficher les rponses'}\n    on:click={() => setCorrectionVisible(!isCorrectionVisible)}\n  >\n    <i\n      class=\"mb-8 bx bx-sm cursor-pointer\n      {isCorrectionVisible ? 'bx-toggle-right' : 'bx-toggle-left'}\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    ></i>\n  </button>\n  <span\n    class=\"text-xs font-bold pt-2\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Pas  pas\n  </span>\n  <div\n    class=\"flex flex-row justify-center items-center mb-8\n    text-coopmaths-action dark:text-coopmathsdark-action\n    hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n  >\n    <button\n      type=\"button\"\n      aria-label=\"tape prcdente\"\n      on:click={() => handleCorrectionsStepsClick('backward')}\n    >\n      <i class=\"bx bxs-left-arrow mr-2 cursor-pointer\"></i>\n    </button>\n    <button\n      type=\"button\"\n      aria-label=\"tape suivante\"\n      on:click={() => handleCorrectionsStepsClick('forward')}\n    >\n      <i class=\"bx bxs-right-arrow cursor-pointer\"></i>\n    </button>\n  </div>\n\n  <!-- Onglets Sries -->\n  {#if nbOfVues > 1}\n    {#each [...Array(nbOfVues).keys()] as i}\n      <input\n        type=\"radio\"\n        id=\"tab{i + 1}\"\n        value={i}\n        bind:group={currentVue}\n        on:change={() => setCurrentVue(i)}\n        class=\"peer/tab{i + 1} items-center justify-center hidden\"\n      />\n      <label\n        class=\"flex flex-row justify-center items-center text-center\n          w-14 h-14 rounded-l-lg border-y border-l\n          cursor-pointer peer-checked/tab{i + 1}:cursor-default\n          border-coopmaths-struct dark:border-coopmathsdark-struct\n          bg-coopmaths-canvas-dark font-bold dark:bg-coopmathsdark-canvas-dark\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\n          peer-checked/tab{i + 1}:bg-coopmaths-canvas dark:peer-checked/tab{i +\n          1}:bg-coopmathsdark-canvas\n          peer-checked/tab{i +\n          1}:text-coopmaths-struct dark:peer-checked/tab{i +\n          1}:text-coopmathsdark-struct\"\n        for=\"tab{i + 1}\"\n      >\n        {i + 1}\n      </label>\n    {/each}\n    <input\n      type=\"radio\"\n      id=\"tab5\"\n      value={4}\n      bind:group={currentVue}\n      on:change={() => setCurrentVue(4)}\n      class=\"hidden peer/tab5 items-center justify-center\"\n    />\n    <label\n      class=\"flex flex-row rounded-l-lg border-y border-l border-coopmaths-struct dark:border-coopmathsdark-struct w-14 h-14 justify-center items-center text-center cursor-pointer bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark font-bold text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest peer-checked/tab5:bg-coopmaths-canvas dark:peer-checked/tab5:bg-coopmathsdark-canvas peer-checked/tab5:text-coopmaths-struct dark:peer-checked/tab5:text-coopmathsdark-struct peer-checked/tab5:cursor-default\"\n      for=\"tab5\"\n    >\n      Tout\n    </label>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import type { Serie } from '../../../types'\n  import { mathaleaFormatExercice } from '../../../../../../lib/mathalea'\n\n  export let isQuestionsVisible: boolean | undefined\n  export let isCorrectionVisible: boolean | undefined\n  export let seriesIndex: number\n  export let order: number[]\n  export let series: Serie[]\n  export let correctionsSteps: number[]\n</script>\n\n<div\n  class=\"p-6 pb-2 text-3xl font-black\n  text-coopmaths-struct dark:text-coopmathsdark-struct\"\n>\n  {#if series.length > 1}\n    Srie {seriesIndex + 1}\n  {:else}\n    {isQuestionsVisible ? 'Questions' : ''}\n    {isCorrectionVisible && isQuestionsVisible ? ' / ' : ''}\n    {isCorrectionVisible ? 'Rponses' : ''}\n  {/if}\n</div>\n<div\n  class=\"mt-2\n  mx-2 lg:mx-6\"\n>\n  {#each order as i, index}\n    <div class=\"flex flex-row my-4\">\n      <div class=\"pr-2\">\n        <span\n          class=\"font-black\n          text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          {index + 1})\n        </span>\n      </div>\n      <div class=\"flex flex-col justify-start items-start\">\n        {#if isQuestionsVisible}\n          <div>\n            <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n            {@html mathaleaFormatExercice(series[seriesIndex].questions[i])}\n          </div>\n        {/if}\n        {#if isCorrectionVisible || correctionsSteps.includes(i)}\n          <div\n            class=\"relative self-start max-w-full border-l-[3px] mt-6 py-2 pl-6\n              border-l-coopmaths-struct dark:border-l-coopmathsdark-struct\n              text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <div class=\"container overflow-x-auto overflow-y-hidden\">\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html mathaleaFormatExercice(series[seriesIndex].corrections[i])}\n            </div>\n            <div\n              class=\"absolute -left-[3px] -top-[15px] py-[1.5px] px-3 rounded-t-md\n                font-semibold text-xs\n                bg-coopmaths-struct dark:bg-coopmathsdark-struct\n                text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n            >\n              Correction\n            </div>\n            <div\n              class=\"absolute bottom-0 left-0 border-b-[3px] w-4\n                border-coopmaths-struct dark:border-coopmathsdark-struct\"\n            ></div>\n          </div>\n        {/if}\n      </div>\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import type { Serie } from '../../../types'\n  import SlideshowOverviewSeries from './SlideshowOverviewSerie.svelte'\n\n  export let isQuestionsVisible: boolean | undefined\n  export let isCorrectionVisible: boolean | undefined\n  export let currentSeriesIndex: number\n  export let order: number[]\n  export let series: Serie[]\n  export let correctionsSteps: number[]\n</script>\n\n{#each Array(series.length).keys() as seriesId}\n  <div\n    class={currentSeriesIndex === 4 || currentSeriesIndex === seriesId\n      ? ''\n      : 'hidden'}\n  >\n    <SlideshowOverviewSeries\n      {isQuestionsVisible}\n      {isCorrectionVisible}\n      seriesIndex={seriesId}\n      {order}\n      {series}\n      {correctionsSteps}\n    />\n  </div>\n{/each}\n","<script lang=\"ts\">\n  import { tick } from 'svelte'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../../lib/mathalea'\n  import {\n    darkMode,\n    exercicesParams,\n  } from '../../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../../lib/stores/globalOptions'\n  import type { IExercice, InterfaceParams } from '../../../../lib/types'\n  import { isIntegerInRange0to4 } from '../../../../lib/types/integerInRange'\n  import ZoomButtons from '../../start/presentationalComponents/header/headerButtons/setupButtons/ZoomButtons.svelte'\n  import type { Serie, Slideshow } from '../types'\n  import SlideshowOverviewLeftPanel from './presentationalComponent/SlideshowOverviewLeftPanel.svelte'\n  import SlideshowOverviewMainPanel from './presentationalComponent/mainPanel/SlideshowOverviewMainPanel.svelte'\n\n  export let exercises: IExercice[] = []\n  export let slideshow: Slideshow\n  export let updateExercises: (\n    updateSlidesContent?: boolean,\n    updateParamsFromUrl?: boolean,\n  ) => void\n  export let backToSettings: () => void\n\n  let currentSeriesIndex: 0 | 1 | 2 | 3 | 4 = 0\n  let isCorrectionVisible = false\n  let isQuestionsVisible = true\n  let divExercice: HTMLElement\n  let correctionsSteps: number[] = []\n\n  let nbVues: 0 | 1 | 2 | 3 | 4\n  $: {\n    const nbVuesCandidate = slideshow.slides[0].vues.length\n    if (isIntegerInRange0to4(nbVuesCandidate)) {\n      nbVues = nbVuesCandidate\n    }\n  }\n\n  let order: number[]\n  $: {\n    const questionsNb =\n      slideshow.selectedQuestionsNumber || slideshow.slides.length\n    order =\n      $globalOptions.order === undefined || $globalOptions.order.length === 0\n        ? [...Array(questionsNb).keys()]\n        : $globalOptions.order\n  }\n\n  let series: Serie[] = []\n  $: {\n    series = []\n    for (let i = 0; i < nbVues; i++) {\n      const serie: Serie = {\n        consignes: [],\n        questions: [],\n        corrections: [],\n      }\n      for (const slide of slideshow.slides) {\n        serie.consignes.push(slide.vues[i].consigne)\n        serie.questions.push(slide.vues[i].question)\n        serie.corrections.push(slide.vues[i].correction)\n      }\n      series.push(serie)\n    }\n  }\n\n  $: if (\n    (isQuestionsVisible ||\n      isCorrectionVisible ||\n      correctionsSteps.length > 0) &&\n    currentSeriesIndex !== undefined\n  ) {\n    tick().then(() => mathaleaRenderDiv(divExercice))\n  }\n\n  function setCorrectionVisible(correctionVisibility: boolean) {\n    isCorrectionVisible = correctionVisibility\n    if (!isCorrectionVisible) {\n      setQuestionsVisible(true)\n    }\n  }\n\n  function setCurrentVue(vue: number) {\n    if (isIntegerInRange0to4(vue)) {\n      currentSeriesIndex = vue\n    }\n  }\n\n  function setQuestionsVisible(questionsVisibility: boolean) {\n    isQuestionsVisible = questionsVisibility\n    if (!isQuestionsVisible) {\n      setCorrectionVisible(true)\n    }\n  }\n\n  function newDataForAll() {\n    const newParams: InterfaceParams[] = []\n    for (const exercice of exercises) {\n      exercice.seed = mathaleaGenerateSeed()\n      newParams.push({\n        uuid: exercice.uuid,\n        id: exercice.id,\n        alea: exercice.seed.substring(0, 4),\n        nbQuestions: exercice.nbQuestions,\n        duration: exercice.duration,\n      })\n    }\n    exercicesParams.set(newParams)\n    updateExercises(true)\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n    isQuestionsVisible = true\n    isCorrectionVisible = false\n    correctionsSteps = []\n  }\n\n  /**\n   * Gestion du pas  pas pour l'affichage des corrections\n   * @param {string} button chane correspondant  la direction du pas  pas (\"backward\" ou \"forward\")\n   */\n  function handleCorrectionsStepsClick(button: 'backward' | 'forward') {\n    if (button === 'backward') {\n      if (correctionsSteps.length !== 0) {\n        correctionsSteps.pop()\n        correctionsSteps = correctionsSteps\n      }\n    }\n    if (button === 'forward') {\n      if (correctionsSteps.length < order.length) {\n        correctionsSteps.push(order[correctionsSteps.length])\n      }\n      correctionsSteps = correctionsSteps\n    }\n  }\n\n  function zoomUpdate(plusMinus: '+' | '-') {\n    const oldZoom = Number($globalOptions.z || 1)\n    const newZoom = Number(\n      (plusMinus === '+' ? oldZoom + 0.1 : oldZoom - 0.1).toFixed(1),\n    )\n    $globalOptions.z = newZoom.toString()\n    const main = document.querySelector('main')\n    tick().then(() => mathaleaRenderDiv(main))\n    mathaleaUpdateUrlFromExercicesParams()\n  }\n</script>\n\n<div class={$darkMode.isActive ? 'dark' : ''}>\n  <div\n    class=\"fixed z-20 rounded-b-full rounded-t-full\n    bottom-2 lg:bottom-6\n    right-2 lg:right-6\n    bg-coopmaths-canvas/80 dark:bg-coopmathsdark-canvas/80\"\n  >\n    <div\n      class=\"flex flex-col space-y-2\n      scale-75 lg:scale-100\"\n    >\n      <ZoomButtons {zoomUpdate} />\n    </div>\n  </div>\n  <div\n    class=\"flex\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <aside class=\"h-screen sticky top-0\">\n      <SlideshowOverviewLeftPanel\n        {isQuestionsVisible}\n        {isCorrectionVisible}\n        currentVue={currentSeriesIndex}\n        nbOfVues={nbVues}\n        {setCurrentVue}\n        {setQuestionsVisible}\n        {setCorrectionVisible}\n        {handleCorrectionsStepsClick}\n        {newDataForAll}\n        {backToSettings}\n      />\n    </aside>\n    <main\n      class=\"flex flex-row p-2\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n      bind:this={divExercice}\n    >\n      <SlideshowOverviewMainPanel\n        {isQuestionsVisible}\n        {isCorrectionVisible}\n        {currentSeriesIndex}\n        {order}\n        {series}\n        {correctionsSteps}\n      />\n    </main>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { buildMathAleaURL } from '../../../../../lib/components/urls'\n  import ButtonQRCode from '../../../../shared/forms/ButtonQRCode.svelte'\n  import ButtonActionInfo from '../../../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonIconTooltip from '../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let returnToStart: () => void\n  export let backToSettings: () => void\n  export let goToOverview: () => void\n</script>\n\n<div class=\"flex flex-row items-baseline justify-center w-full my-4\">\n  <ButtonIconTooltip\n    icon=\"bx-arrow-back mx-[3vw] my-2 text-[6vw]\"\n    tooltip=\"Dbut du Diaporama\"\n    on:click={returnToStart}\n  />\n  <ButtonIconTooltip\n    icon=\"bx-detail mx-[3vw] my-2 text-[6vw]\"\n    tooltip=\"Questions + Rponses\"\n    on:click={goToOverview}\n  />\n  <ButtonActionInfo\n    action=\"copy\"\n    textToCopy={buildMathAleaURL({ view: 'diaporama' }).toString()}\n    icon=\"bx-link text-[6vw] mx-[3vw] my-2\"\n    tooltip=\"Lien du Diaporama\"\n    successMessage=\"Le lien est copi dans le presse-papier !\"\n    errorMessage=\"Impossible de copier le lien dans le presse-papier.\"\n  />\n  <ButtonQRCode\n    icon=\"bx-qr text-[6vw] mx-[3vw] my-2\"\n    tooltip=\"QR-code du diaporama\"\n    customUrl={document.URL}\n  />\n  <ButtonIconTooltip\n    icon=\"bx-home-alt-2 text-[6vw] mx-[3vw] my-2\"\n    tooltip=\"Sortir du diaporama\"\n    on:click={backToSettings}\n  />\n</div>\n","<script lang=\"ts\">\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div>\n  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n  {@html slideView.correction}\n</div>\n","<script lang=\"ts\">\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div>\n  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n  {@html slideView.correctionText}\n</div>\n<div>\n  {#each slideView.correctionSvgs as correctionSvg}\n    <div>\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html correctionSvg}\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import { renderDiv } from '../../../../../../lib/mathalea'\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div class=\"flex flex-col\">\n  <div>\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html slideView.consigne}\n  </div>\n  {#key slideView.question}\n    <div use:renderDiv={slideView.question}>\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html slideView.question}\n    </div>\n  {/key}\n</div>\n","<script lang=\"ts\">\n  import { renderDiv } from '../../../../../../lib/mathalea'\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div class=\"flex flex-row\">\n  <div>\n    {#each slideView.consigneSvgs as consigneSvg}\n      <div>\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html consigneSvg}\n      </div>\n    {/each}\n  </div>\n  {#key slideView.question}\n    <div use:renderDiv={slideView.question}>\n      <div>\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html slideView.consigneText}\n      </div>\n      <div>\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html slideView.questionText}\n      </div>\n    </div>\n    <div class=\"flex flex-row\">\n      {#each slideView.questionSvgs as questionSvg}\n        <div>\n          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n          {@html questionSvg}\n        </div>\n      {/each}\n    </div>\n  {/key}\n</div>\n","<script lang=\"ts\">\n  import type { Slide } from '../../../types'\n  import CorrectionWithImagesInside from './CorrectionWithImagesInside.svelte'\n  import CorrectionWithImagesOnSides from './CorrectionWithImagesOnSides.svelte'\n  import QuestionWithImagesInside from './QuestionWithImagesInside.svelte'\n  import QuestionWithImagesOnSides from './QuestionWithImagesOnSides.svelte'\n\n  export let divQuestion: HTMLDivElement[]\n  export let isQuestionVisible: boolean\n  export let isCorrectionVisible: boolean\n  export let currentSlide: Slide\n  export let currentQuestion: number\n  export let selectedQuestionsNumber: number\n  export let isImagesOnSides: boolean\n\n  let nbVues\n  $: nbVues = currentSlide?.vues.length || 0\n</script>\n\n<div\n  class=\"place-content-stretch justify-items-center w-full h-full grid\n  {nbVues > 1 ? 'grid-cols-2 gap-4 auto-rows-fr' : 'grid-cols-1'}\"\n>\n  {#each [...Array(nbVues).keys()] as i}\n    <div\n      class=\"relative flex flex-col justify-center justify-self-stretch place-items-stretch\n      min-h-[100%] max-h-[100%] p-2 text-center\n      {nbVues > 1\n        ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n        : ''}\"\n    >\n      {#if nbVues > 1}\n        <div\n          class=\"absolute -top-1 -left-1 rounded-tl-2xl w-1/12 h-1/12 font-black text-4xl\n          bg-coopmaths-struct dark:bg-coopmathsdark-struct\n          text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n        >\n          {i + 1}\n        </div>\n      {/if}\n      {#key currentSlide.vues[i].question + currentSlide.vues[i].correction}\n        <div\n          id=\"exerciseContainer{i}\"\n          bind:this={divQuestion[i]}\n          class=\"flex flex-col justify-center items-center px-4 w-full min-h-[100%] max-h-[100%]\"\n        >\n          {#if isQuestionVisible && currentSlide.vues[i]}\n            <div class=\"py-4 flex items-center\" id=\"question{i}\">\n              {#if isImagesOnSides}\n                <QuestionWithImagesOnSides slideView={currentSlide.vues[i]} />\n              {:else}\n                <QuestionWithImagesInside slideView={currentSlide.vues[i]} />\n              {/if}\n            </div>\n          {/if}\n          {#if isCorrectionVisible && currentSlide.vues[i]}\n            <div\n              id=\"correction{i}\"\n              class=\"flex items-center my-10\n              bg-coopmaths-warn-light/30 dark:bg-coopmathsdark-warn-light/30\"\n            >\n              {#if isImagesOnSides}\n                <CorrectionWithImagesOnSides slideView={currentSlide.vues[i]} />\n              {:else}\n                <CorrectionWithImagesInside slideView={currentSlide.vues[i]} />\n              {/if}\n            </div>\n          {/if}\n        </div>\n      {/key}\n    </div>\n  {/each}\n</div>\n<dialog\n  id=\"transition\"\n  class=\"absolute top-0 left-0 min-w-full w-full min-h-full h-full\n    text-[150px] font-extralight\n    bg-coopmaths-struct dark:bg-coopmathsdark-struct\n    text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n>\n  <div class=\"flex justify-center items-center w-full min-h-full h-full\">\n    <div\n      class=\"radial-progress\"\n      style=\"--value:{((currentQuestion + 1) / selectedQuestionsNumber) * 100};\"\n    >\n      {currentQuestion + 1} / {selectedQuestionsNumber}\n    </div>\n  </div>\n</dialog>\n\n<style>\n  dialog::backdrop {\n    backdrop-filter: blur(4px);\n  }\n  .radial-progress {\n    font-size: 20vw;\n    --size: 60vw;\n    --thickness: 3vw;\n  }\n\n  @media (min-aspect-ratio: 1/1) {\n    .radial-progress {\n      font-size: 20vh;\n      --size: 60vh;\n      --thickness: 3vh;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { showDialogForLimitedTime } from '../../../../../../../lib/components/dialogs'\n  import TwoStatesIcon from '../../../../../../../components/shared/icons/TwoStatesIcon.svelte'\n  import { onMount, onDestroy } from 'svelte'\n\n  export let callback: (isFullScreen: boolean) => void = () => {}\n\n  type FullscreenRequestEnabled = {\n    requestFullscreen?(): Promise<void>\n    mozRequestFullScreen?(): Promise<void>\n    webkitRequestFullscreen?(): Promise<void>\n    msRequestFullscreen?(): Promise<void>\n  }\n\n  const isFullscreenRequestEnabled = (\n    element: HTMLElement,\n  ): element is HTMLElement & FullscreenRequestEnabled => {\n    return (\n      'requestFullscreen' in element ||\n      'mozRequestFullScreen' in element ||\n      'webkitRequestFullscreen' in element ||\n      'msRequestFullscreen' in element\n    )\n  }\n\n  type FullscreenExitEnabled = {\n    exitFullscreen?(): Promise<void>\n    mozCancelFullScreen?(): Promise<void>\n    webkitExitFullscreen?(): Promise<void>\n    msExitFullscreen?(): Promise<void>\n  }\n\n  const isFullscreenExitEnabled = (\n    doc: Document,\n  ): doc is Document & FullscreenExitEnabled => {\n    return (\n      'exitFullscreen' in doc ||\n      'mozCancelFullScreen' in doc ||\n      'webkitExitFullscreen' in doc ||\n      'msExitFullscreen' in doc\n    )\n  }\n\n  const appId = 'appComponent'\n  let isFullScreen = false\n\n  onMount(() => {\n    document.addEventListener('fullscreenchange', handleFullscreenChange)\n  })\n\n  onDestroy(() => {\n    document.removeEventListener('fullscreenchange', handleFullscreenChange)\n  })\n\n  const handleFullscreenChange = () => {\n    const isInFullScreen = document.fullscreenElement != null\n    isFullScreen = isInFullScreen\n    callback?.(isFullScreen)\n  }\n\n  const switchFullScreen = async () => {\n    const element = document.getElementById(appId)\n    if (!element) {\n      handleFullScreenError(new Error(`#${appId} non trouv`))\n      return\n    }\n\n    isFullScreen = !isFullScreen\n\n    const isInFullScreen = document.fullscreenElement != null\n    if (isFullScreen && !isInFullScreen) {\n      if (isFullscreenRequestEnabled(element)) {\n        try {\n          await requestFullScreen(element)\n        } catch (error) {\n          console.error('Erreur lors de la requte de plein cran.')\n        }\n      } else {\n        handleFullScreenError(new Error('Plein cran non disponible'))\n      }\n    }\n    if (!isFullScreen && isInFullScreen) {\n      if (isFullscreenExitEnabled(document)) {\n        try {\n          await exitFullScreen()\n        } catch (error) {\n          console.error('Erreur lors de la sortie du plein cran.')\n        }\n      } else {\n        handleFullScreenError(new Error('Sortie du plein cran non disponible'))\n      }\n    }\n    callback?.(isFullScreen)\n  }\n\n  const requestFullScreen = async (\n    element: HTMLElement & FullscreenRequestEnabled,\n  ) => {\n    if (\n      !(element instanceof HTMLElement) ||\n      !isFullscreenRequestEnabled(element)\n    ) {\n      handleFullScreenError(new Error(\"Le plein cran n'est plus disponible\"))\n      return\n    }\n    const method =\n      element.requestFullscreen ||\n      element.mozRequestFullScreen ||\n      element.webkitRequestFullscreen ||\n      element.msRequestFullscreen\n    if (method) {\n      try {\n        await method.call(element)\n      } catch (error) {\n        handleFullScreenError(new Error('Requte de plein cran refuse'))\n      }\n    } else {\n      handleFullScreenError(new Error('Plein cran non disponible'))\n    }\n  }\n\n  const exitFullScreen = async () => {\n    if (!isFullscreenExitEnabled(document)) {\n      handleFullScreenError(new Error(\"Le plein cran n'est plus disponible\"))\n      return\n    }\n    const method =\n      document.exitFullscreen ||\n      document.mozCancelFullScreen ||\n      document.webkitExitFullscreen ||\n      document.msExitFullscreen\n    if (method) {\n      await method.call(document)\n    } else {\n      handleFullScreenError(new Error('Sortie du plein cran non disponible'))\n    }\n  }\n\n  const handleFullScreenError = (error: Error) => {\n    console.error(error)\n    showDialogForLimitedTime('notifDialog', 2000, 'Accs au plein cran refus')\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip={isFullScreen ? 'Quitter le plein cran' : 'Plein cran'}\n  on:click={switchFullScreen}\n>\n  <div class=\"px-2\">\n    <TwoStatesIcon isOnStateActive={isFullScreen}>\n      <i\n        slot=\"icon_to_switch_on\"\n        class=\"bx bx-fullscreen text-3xl\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      ></i>\n      <i\n        slot=\"icon_to_switch_off\"\n        class=\"bx bx-exit-fullscreen text-3xl\n        text-coopmaths-action dark:text-coopmathsdark-action\n        hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      ></i>\n    </TwoStatesIcon>\n  </div>\n</button>\n","<script lang=\"ts\">\n  import ButtonIcon from '../../../../../shared/forms/ButtonIcon.svelte'\n  import FullscreenButton from '../../../../start/presentationalComponents/header/headerButtons/setupButtons/FullscreenButton.svelte'\n\n  export let zoomPlus: () => void\n  export let zoomMinus: () => void\n  export let BUTTONS_CLASS: string\n</script>\n\n<FullscreenButton />\n<ButtonIcon\n  icon=\"bx-plus {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : +\"\n  on:click={zoomPlus}\n/>\n<ButtonIcon\n  icon=\"bx-minus {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : -\"\n  on:click={zoomMinus}\n/>\n","<script lang=\"ts\">\n  import ButtonIcon from '../../../../../shared/forms/ButtonIcon.svelte'\n\n  export let isPause: boolean\n  export let isManualModeActive: boolean | undefined\n  export let prevQuestion: () => void\n  export let nextQuestion: () => void\n  export let switchPause: (isUserAction?: boolean) => void\n  export let BUTTONS_CLASS: string\n</script>\n\n<ButtonIcon\n  icon=\"bx-skip-previous {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : flche gauche\"\n  on:click={prevQuestion}\n/>\n<ButtonIcon\n  icon=\"{isPause ? 'bx-play' : 'bx-pause'} {BUTTONS_CLASS} {isManualModeActive\n    ? 'invisible'\n    : ''}\"\n  title=\"Raccourci clavier : espace\"\n  on:click={() => switchPause(true)}\n/>\n<ButtonIcon\n  icon=\"bx-skip-next {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : flche droite\"\n  on:click={nextQuestion}\n/>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { setPhraseDuree } from '../../../lib/components/time'\n\n  let cursorTimeValue = 10\n\n  let messageDuree: string\n  $: messageDuree = setPhraseDuree(cursorTimeValue)\n\n  const dispatch = createEventDispatcher()\n</script>\n\n<div class=\"flex flex-col\">\n  <input\n    class=\"py-3\"\n    type=\"range\"\n    max=\"30\"\n    min=\"0\"\n    name=\"duration\"\n    id=\"duration\"\n    bind:value={cursorTimeValue}\n    on:change={() => dispatch('change', cursorTimeValue)}\n  />\n  <label\n    class=\"\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    for=\"duration\"\n  >\n    {messageDuree}\n  </label>\n</div>\n\n<style lang=\"scss\">\n  // Styling Cross-Browser Compatible Range Inputs with Sass\n  // Github: https://github.com/darlanrod/input-range-sass\n  // Author: Darlan Rod https://github.com/darlanrod\n  // Version 1.5.3\n  // MIT License\n\n  @use 'sass:math';\n  @use 'sass:color';\n\n  $track-color: white !default;\n  $track-color-dark-mode: #1a202c !default;\n  $thumb-color: default !default; // coopmaths-action\n\n  $thumb-radius: 999px !default;\n  $thumb-height: 18px !default;\n  $thumb-width: 18px !default;\n  $thumb-shadow-size: 2px !default;\n  $thumb-shadow-blur: 2px !default;\n  $thumb-shadow-color: rgba(0, 0, 0, 0.2) !default;\n  $thumb-border-width: 2px !default;\n  $thumb-border-color: #eceff1 !default;\n\n  $track-width: 100% !default;\n  $track-height: 5px !default;\n  $track-shadow-size: 0px !default;\n  $track-shadow-blur: 1px !default;\n  $track-shadow-color: rgba(0, 0, 0, 0.2) !default;\n  $track-border-width: 1px !default;\n  $track-border-color: #cfd8dc !default;\n  $track-radius: 5px !default;\n\n  $contrast: 5% !default;\n  $ie-bottom-track-color: color.adjust(\n    $track-color,\n    $lightness: -$contrast\n  ) !default;\n\n  @mixin shadow($shadow-size, $shadow-blur, $shadow-color) {\n    box-shadow:\n      $shadow-size $shadow-size $shadow-blur $shadow-color,\n      0 0 $shadow-size color.adjust($shadow-color, $lightness: $contrast);\n  }\n\n  @mixin track {\n    cursor: default;\n    height: $track-height;\n    transition: all 0.2s ease;\n    width: $track-width;\n  }\n\n  @mixin thumb {\n    @include shadow(\n      $thumb-shadow-size,\n      $thumb-shadow-blur,\n      $thumb-shadow-color\n    );\n    background: $thumb-color;\n    border: $thumb-border-width solid $thumb-border-color;\n    border-radius: $thumb-radius;\n    box-sizing: border-box;\n    cursor: default;\n    height: $thumb-height;\n    width: $thumb-width;\n  }\n\n  [type='range'] {\n    -webkit-appearance: none;\n    appearance: none;\n    background: transparent;\n    margin: math.div($thumb-height, 2) 0;\n    width: $track-width;\n\n    &::-moz-focus-outer {\n      border: 0;\n    }\n\n    &:focus {\n      outline: 0;\n\n      &::-webkit-slider-runnable-track {\n        background: color.adjust($track-color, $lightness: $contrast);\n      }\n\n      &::-ms-fill-lower {\n        background: $track-color;\n      }\n\n      &::-ms-fill-upper {\n        background: color.adjust($track-color, $lightness: $contrast);\n      }\n    }\n\n    &::-webkit-slider-runnable-track {\n      @include track;\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      background: $track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: $track-radius;\n    }\n\n    &::-webkit-slider-thumb {\n      @include thumb;\n      -webkit-appearance: none;\n      margin-top: (\n        math.div((-$track-border-width * 2 + $track-height), 2) - math.div(\n            $thumb-height,\n            2\n          )\n      );\n    }\n\n    &::-moz-range-track {\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      @include track;\n      background: $track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: $track-radius;\n      height: math.div($track-height, 2);\n    }\n\n    &::-moz-range-thumb {\n      @include thumb;\n    }\n\n    &::-ms-track {\n      @include track;\n      background: transparent;\n      border-color: transparent;\n      border-width: math.div($thumb-height, 2) 0;\n      color: transparent;\n    }\n\n    &::-ms-fill-lower {\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      background: $ie-bottom-track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: ($track-radius * 2);\n    }\n\n    &::-ms-fill-upper {\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      background: $track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: ($track-radius * 2);\n    }\n\n    &::-ms-thumb {\n      @include thumb;\n      margin-top: math.div($track-height, 4);\n    }\n\n    &:disabled {\n      &::-webkit-slider-thumb,\n      &::-moz-range-thumb,\n      &::-ms-thumb,\n      &::-webkit-slider-runnable-track,\n      &::-ms-fill-lower,\n      &::-ms-fill-upper {\n        cursor: not-allowed;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import RangeSlider from '../../../../../shared/forms/RangeSlider.svelte'\n  import BasicClassicModal from '../../../../../shared/modal/BasicClassicModal.svelte'\n\n  export let handleTimerChange: (cursorTimeValue: number) => void\n  export let isTimerSettingsModalDisplayed: boolean\n</script>\n\n<BasicClassicModal\n  bind:isDisplayed={isTimerSettingsModalDisplayed}\n  icon=\"bx-stopwatch\"\n>\n  <h3\n    slot=\"header\"\n    class=\"font-bold text-lg\n    text-coopmaths-struc dark:text-coopmathsdark-struct\"\n  >\n    <p>Temps par question</p>\n  </h3>\n  <div slot=\"content\" class=\"flex flex-col justify-center items-center\">\n    <p\n      class=\"\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      Rgler la dure de projection en secondes\n    </p>\n    <div class=\"flex justify-center w-full md:w-3/4 xl:w-2/3\">\n      <RangeSlider\n        on:change={(e) => {\n          const cursorTimeValue = e.detail\n          handleTimerChange(cursorTimeValue)\n        }}\n      />\n    </div>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import ButtonIcon from '../../../../../shared/forms/ButtonIcon.svelte'\n  import SlideshowPlayTimerSettingsModal from './SlideshowPlayTimerSettingsModal.svelte'\n\n  export let handleTimerChange: (cursorTimeValue: number) => void\n  export let switchDisplayMode: () => void\n  export let backToSettings: (event: Event) => void\n  export let pause: () => void\n  export let play: (isUserAction: boolean) => void\n  export let isManualModeActive: boolean | undefined\n  export let isQuestionVisible: boolean\n  export let isCorrectionVisible: boolean\n  export let currentSlideDuration: number\n  export let BUTTONS_CLASS: string\n\n  let isTimerSettingsModalDisplayedOnce = false\n\n  $: getDisplayMode = () => {\n    if (isQuestionVisible && !isCorrectionVisible) {\n      return 'Q'\n    }\n    if (isQuestionVisible && isCorrectionVisible) {\n      return 'Q+C'\n    }\n    if (!isQuestionVisible && isCorrectionVisible) {\n      return 'C'\n    }\n    return ''\n  }\n\n  let isTimerSettingsModalDisplayed = false\n  function displayTimerSettingsModal() {\n    isTimerSettingsModalDisplayed = true\n  }\n\n  $: if (isTimerSettingsModalDisplayed) {\n    pause()\n    isTimerSettingsModalDisplayedOnce = true\n  } else if (isTimerSettingsModalDisplayedOnce) {\n    play(true)\n  }\n</script>\n\n<ButtonIcon\n  icon=\"bx-stopwatch {BUTTONS_CLASS}\"\n  title=\"Rgler la dure de chaque question\"\n  floatUnderText={isManualModeActive ? 'Manuel' : currentSlideDuration + 's'}\n  on:click={displayTimerSettingsModal}\n/>\n<ButtonIcon\n  icon=\"bx-show {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : Entre\"\n  floatUnderText={getDisplayMode()}\n  on:click={switchDisplayMode}\n/>\n<ButtonIcon\n  icon=\"bx-power-off {BUTTONS_CLASS}\"\n  title=\"Retour au paramtrage\"\n  on:click={backToSettings}\n/>\n<SlideshowPlayTimerSettingsModal\n  bind:isTimerSettingsModalDisplayed\n  {handleTimerChange}\n/>\n","<script lang=\"ts\">\n  import SlideshowPlayDisplaySettings from './SlideshowPlayDisplaySettings.svelte'\n  import SlideshowPlayControlSettings from './SlideshowPlayControlSettings.svelte'\n  import SlideshowPlayOtherSettings from './SlideshowPlayOtherSettings.svelte'\n\n  export let isManualModeActive: boolean | undefined\n  export let isQuestionVisible: boolean\n  export let isCorrectionVisible: boolean\n  export let handleTimerChange: (cursorTimeValue: number) => void\n  export let backToSettings: (event: Event) => void\n  export let isPause: boolean\n  export let nextQuestion: () => void\n  export let prevQuestion: () => void\n  export let switchDisplayMode: () => void\n  export let switchPause: (isUserAction?: boolean) => void\n  export let zoomMinus: () => void\n  export let zoomPlus: () => void\n  export let pause: () => void\n  export let play: (isUserAction?: boolean) => void\n  export let currentSlideDuration: number\n\n  const BUTTONS_CLASS = 'mx-1.5 bx-sm md:bx-lg'\n</script>\n\n<div class=\"flex flex-row justify-start items-center ml-7 w-[33%]\">\n  <SlideshowPlayDisplaySettings {BUTTONS_CLASS} {zoomPlus} {zoomMinus} />\n</div>\n<div class=\"flex flex-row justify-center items-center w-[33%]\">\n  <SlideshowPlayControlSettings\n    {BUTTONS_CLASS}\n    {isPause}\n    {isManualModeActive}\n    {prevQuestion}\n    {nextQuestion}\n    {switchPause}\n  />\n</div>\n<div class=\"flex flex-row justify-end items-baseline mr-7 w-[33%]\">\n  <SlideshowPlayOtherSettings\n    {BUTTONS_CLASS}\n    {pause}\n    {play}\n    {handleTimerChange}\n    {switchDisplayMode}\n    {backToSettings}\n    {isManualModeActive}\n    {isQuestionVisible}\n    {isCorrectionVisible}\n    {currentSlideDuration}\n  />\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n\n  export let isManualModeActive: boolean | undefined\n  export let currentQuestionNumber: number\n  export let totalQuestionsNumber: number\n  export let goToQuestion: (index: number) => void\n  export let ratioTime: number\n  export let currentSlideDuration: number\n\n  let stepsContainer: HTMLElement | null\n  onMount(() => {\n    stepsContainer = document.getElementById('stepsContainer')\n  })\n\n  $: {\n    if (stepsContainer) {\n      const steps = stepsContainer.querySelectorAll('button')\n      if (steps[currentQuestionNumber]) {\n        steps[currentQuestionNumber].scrollIntoView()\n      }\n      if (steps[currentQuestionNumber + 5]) {\n        steps[currentQuestionNumber + 5].scrollIntoView()\n      } else {\n        steps[totalQuestionsNumber - 1].scrollIntoView()\n      }\n      if (steps[currentQuestionNumber - 5]) {\n        steps[currentQuestionNumber - 5].scrollIntoView()\n      } else {\n        steps[0].scrollIntoView()\n      }\n      const diapoProgressContainer = document.getElementById(\n        'diapoProgressContainer',\n      )\n      if (diapoProgressContainer) diapoProgressContainer.scrollIntoView()\n    }\n  }\n</script>\n\n<div\n  id=\"diapoProgressContainer\"\n  class:invisible={isManualModeActive}\n  class=\"flex flex-row flex-shrink-0 h-6 border\n    border-coopmaths-warn dark:border-coopmathsdark-warn\"\n>\n  <div\n    class=\"bg-coopmaths-warn dark:bg-coopmathsdark-warn\"\n    style=\"width: {ratioTime}%; transition: width {currentSlideDuration /\n      100}s linear\"\n  ></div>\n</div>\n<div id=\"stepsContainer\" class=\"steps-container\">\n  {#each [...Array(totalQuestionsNumber).keys()] as i}\n    <button\n      on:click={() => goToQuestion(i)}\n      class=\"step-item\"\n      class:step-completed={currentQuestionNumber > i}\n      class:step-current={currentQuestionNumber === i}\n    >\n      <span class=\"step-indicator\">{i + 1}</span>\n    </button>\n  {/each}\n</div>\n\n<style>\n  .steps-container {\n    display: flex;\n    flex-wrap: nowrap;\n    width: 100%;\n    margin-top: 0.5rem;\n    margin-bottom: 0.5rem;\n    padding: 0.5rem 1rem;\n    overflow-x: auto;\n    overflow-y: hidden;\n  }\n\n  .step-item {\n    display: flex;\n    flex-grow: 1;\n    justify-content: center;\n    position: relative;\n    cursor: pointer;\n    background: transparent;\n    border: none;\n    min-width: 4rem;\n  }\n\n  .step-item::before {\n    content: '';\n    position: absolute;\n    width: 100%;\n    height: 8px;\n    top: 50%;\n    right: 50%;\n    transform: translateY(-50%);\n    background-color: #d1d5db;\n  }\n\n  .step-item:first-child::before {\n    display: none;\n  }\n\n  :global(.dark) .step-item::before {\n    background-color: #4b5563;\n  }\n\n  .step-item.step-completed::before,\n  .step-item.step-current::before {\n    background-color: #f15929;\n  }\n\n  :global(.dark) .step-item.step-completed::before,\n  :global(.dark) .step-item.step-current::before {\n    background-color: #ffb86c;\n  }\n\n  .step-indicator {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    position: relative;\n    z-index: 1;\n    width: 2rem;\n    height: 2rem;\n    border-radius: 50%;\n    background-color: #d1d5db;\n    transition: transform 0.2s ease-in-out;\n  }\n\n  :global(.dark) .step-indicator {\n    background-color: #4b5563;\n  }\n\n  .step-completed .step-indicator {\n    background-color: #f15929;\n  }\n\n  :global(.dark) .step-completed .step-indicator {\n    background-color: #ffb86c;\n  }\n\n  .step-current .step-indicator {\n    background-color: #f15929;\n    animation: pulse 1s infinite ease-in-out;\n  }\n\n  :global(.dark) .step-current .step-indicator {\n    background-color: #ffb86c;\n  }\n\n  .step-item:hover .step-indicator {\n    transform: scale(1.2);\n  }\n\n  @keyframes pulse {\n    0%,\n    100% {\n      transform: scale(1);\n    }\n    50% {\n      transform: scale(1.3);\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { onDestroy, tick } from 'svelte'\n  import { showDialogForLimitedTime } from '../../../../lib/components/dialogs'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { arrondi } from '../../../../lib/outils/nombres'\n  import { globalOptions } from '../../../../lib/stores/globalOptions'\n  import type { Slide, Slideshow } from '../types'\n  import SlideshowPlayEndButtons from './presentationalComponents/SlideshowPlayEndButtons.svelte'\n  import SlideshowPlayQuestion from './presentationalComponents/slideshowPlayQuestion/SlideshowPlayQuestion.svelte'\n  import SlideshowPlaySettings from './presentationalComponents/slideshowPlaySettings/SlideshowPlaySettings.svelte'\n  import SlideshowPlaySteps from './presentationalComponents/SlideshowPlaySteps.svelte'\n\n  export let slideshow: Slideshow\n  export let transitionSounds: Record<string, HTMLAudioElement>\n  export let backToSettings: () => void\n  export let goToOverview: () => void\n\n  const divQuestion: HTMLDivElement[] = []\n  const exercicesAffiches = new window.Event('exercicesAffiches', {\n    bubbles: true,\n  })\n  let isCorrectionVisible = false\n  let isPause = false\n  let isManualPause = false\n  let isQuestionVisible = true\n  let advanceRatioTimeInterval: number\n  let ratioTime = 0 // Pourcentage du temps coul (entre 1 et 100)\n  let optimalZoom = 1\n  let userZoom: number[] = Array(\n    slideshow.selectedQuestionsNumber || slideshow.slides.length,\n  ).fill(1)\n\n  let flow: 'Q->Q' | 'Q->R->Q' | 'Q->(Q+R)->Q'\n  $: {\n    switch ($globalOptions.flow) {\n      case 0:\n        flow = 'Q->Q'\n        break\n      case 1:\n        flow = 'Q->R->Q'\n        break\n      case 2:\n        flow = 'Q->(Q+R)->Q'\n        break\n    }\n  }\n\n  let order: number[] = []\n  $: {\n    const questionsNb =\n      slideshow.selectedQuestionsNumber || slideshow.slides.length\n    order = $globalOptions.order || [...Array(questionsNb).keys()]\n  }\n\n  let nbVues: 1 | 2 | 3 | 4\n  $: nbVues = $globalOptions.nbVues ?? 1\n\n  let currentSlide: Slide\n  $: currentSlide = slideshow.slides[order[slideshow.currentQuestion]]\n\n  let currentSlideDuration: number\n  $: currentSlideDuration =\n    $globalOptions.durationGlobal ||\n    (currentSlide && currentSlide.exercise.duration) ||\n    10\n\n  $: if (slideshow.currentQuestion > -1) {\n    playCurrentQuestion()\n  }\n\n  onDestroy(() => {\n    pause()\n  })\n\n  function prevQuestion() {\n    if (slideshow.currentQuestion === 0) {\n      pause()\n      backToSettings()\n      return\n    }\n    if (isManualPause) {\n      slideshow.currentQuestion--\n      return\n    }\n    isQuestionVisible = true\n    isCorrectionVisible = false\n    ratioTime = 0\n    slideshow.currentQuestion--\n  }\n\n  function nextQuestion() {\n    if (isManualPause) {\n      slideshow.currentQuestion++\n      return\n    }\n    if (flow === 'Q->Q' || isCorrectionVisible) {\n      isQuestionVisible = true\n      isCorrectionVisible = false\n      ratioTime = 0\n      slideshow.currentQuestion++\n      return\n    }\n    isQuestionVisible = flow === 'Q->(Q+R)->Q'\n    isCorrectionVisible = true\n    pause()\n    renderAllViews()\n  }\n\n  async function playCurrentQuestion() {\n    const isEndScreen =\n      slideshow.currentQuestion === slideshow.selectedQuestionsNumber\n    if (isEndScreen) {\n      return\n    }\n    await renderAllViews()\n    if (isManualPause) {\n      ratioTime = 0\n      return\n    }\n    if ($globalOptions.sound !== undefined && $globalOptions.sound > 0) {\n      try {\n        await transitionSounds[$globalOptions.sound - 1].play()\n      } catch (error) {\n        if (error instanceof Error) {\n          if (error.name === 'NotAllowedError') {\n            console.error(\n              'Audio playback was not allowed. Please interact with the page to enable audio.',\n            )\n          } else {\n            console.error(\n              'An error occurred while trying to play the audio:',\n              error,\n            )\n          }\n        } else {\n          console.error('An unknown error occurred:', error)\n        }\n      }\n    }\n    if ($globalOptions.screenBetweenSlides)\n      await showDialogForLimitedTime('transition', 1000)\n    play(false)\n  }\n\n  async function renderAllViews(optimalZoomUpdate: boolean = true) {\n    if (optimalZoomUpdate) {\n      optimalZoom = await findOptimalZoom()\n    }\n    for (let vueIndex = 0; vueIndex < nbVues; vueIndex++) {\n      const exerciseContainerDiv = document.getElementById(\n        'exerciseContainer' + vueIndex,\n      )\n      mathaleaRenderDiv(\n        exerciseContainerDiv,\n        optimalZoom * userZoom[slideshow.currentQuestion],\n      )\n    }\n    document.dispatchEvent(exercicesAffiches)\n  }\n\n  async function findOptimalZoom() {\n    await tick()\n    const optimalZoomForViews = new Array(nbVues).fill(0)\n    for (let vueIndex = 0; vueIndex < nbVues; vueIndex++) {\n      optimalZoomForViews[vueIndex] = findOptimalZoomForView(vueIndex)\n    }\n    return Math.min(...optimalZoomForViews)\n  }\n\n  function findOptimalZoomForView(vueIndex: number) {\n    const MIN_ZOOM = 0.5\n    const exerciseContainerDiv = document.getElementById(\n      'exerciseContainer' + vueIndex,\n    )\n    const questionDiv = document.getElementById('question' + vueIndex)\n    const correctionDiv = document.getElementById('correction' + vueIndex)\n    if (!exerciseContainerDiv) return\n    const svgContainers =\n      exerciseContainerDiv.getElementsByClassName('svgContainer') ?? []\n    for (const svgContainer of svgContainers) {\n      svgContainer.classList.add('flex')\n      svgContainer.classList.add('justify-center')\n      svgContainer\n        .querySelectorAll<HTMLElement>('[id^=\"M2D\"]')\n        .forEach((item) => {\n          item.style.display = 'inline-block'\n        })\n    }\n    mathaleaRenderDiv(exerciseContainerDiv, 1)\n    const { height: questionHeight, width: questionWidth } =\n      getSizes(questionDiv)\n    const { height: correctionHeight, width: correctionWidth } =\n      getSizes(correctionDiv)\n    const containerWidth = exerciseContainerDiv.clientWidth\n    const containerHeight = exerciseContainerDiv.clientHeight\n    const questionWidthOptimalZoom = containerWidth / questionWidth\n    const correctionWidthOptimalZoom = containerWidth / correctionWidth\n    const questionCorrectionHeightOptimalZoom =\n      containerHeight / (questionHeight + correctionHeight)\n    return Math.max(\n      Math.min(\n        questionWidthOptimalZoom,\n        correctionWidthOptimalZoom,\n        questionCorrectionHeightOptimalZoom,\n      ),\n      MIN_ZOOM,\n    )\n  }\n\n  function getSizes(element: HTMLElement | null) {\n    if (element === null) {\n      return { height: 0, width: 0 }\n    } else {\n      return {\n        height:\n          element.scrollHeight > element.clientHeight\n            ? element.scrollHeight\n            : element.clientHeight,\n        width:\n          element.scrollWidth > element.clientWidth\n            ? element.scrollWidth\n            : element.clientWidth,\n      }\n    }\n  }\n\n  window.onresize = () => {\n    renderAllViews()\n  }\n\n  function handleShortcut(e: KeyboardEvent) {\n    if (e.key === '+' && !e.metaKey && !e.ctrlKey) {\n      e.preventDefault()\n      zoomPlus()\n    }\n    if (e.key === '-' && !e.metaKey && !e.ctrlKey) {\n      e.preventDefault()\n      zoomMinus()\n    }\n    if (e.key === 'ArrowLeft') {\n      e.preventDefault()\n      prevQuestion()\n    }\n    if (e.key === 'ArrowRight') {\n      e.preventDefault()\n      nextQuestion()\n    }\n    if (e.key === ' ') {\n      e.preventDefault()\n      switchPause(true)\n    }\n    if (e.key === 'Enter') {\n      e.preventDefault()\n      switchDisplayMode()\n    }\n  }\n\n  function handleTimerChange(cursorTimeValue: number) {\n    const durationGlobal = cursorTimeValue || undefined\n    $globalOptions.manualMode = !durationGlobal\n    $globalOptions.durationGlobal = durationGlobal\n    pause(true)\n  }\n\n  function zoomPlus() {\n    updateZoom(0.05)\n  }\n\n  function zoomMinus() {\n    if (userZoom[slideshow.currentQuestion] > 0.5) {\n      updateZoom(-0.05)\n    }\n  }\n\n  function updateZoom(zoomIncrease: number) {\n    const currentZoom = userZoom[slideshow.currentQuestion]\n    const newZoom = arrondi(currentZoom + zoomIncrease, 2)\n    const currentUuid = currentSlide.exercise.uuid\n    const slidesCount =\n      slideshow.selectedQuestionsNumber || slideshow.slides.length\n    for (let i = 0; i < slidesCount; i++) {\n      if (slideshow.slides[order[i]].exercise.uuid === currentUuid) {\n        userZoom[i] = newZoom\n      }\n    }\n    renderAllViews(false)\n  }\n\n  async function switchDisplayMode() {\n    pause()\n    if (isQuestionVisible && !isCorrectionVisible) {\n      isQuestionVisible = false\n      isCorrectionVisible = true\n    } else if (isQuestionVisible && isCorrectionVisible) {\n      isQuestionVisible = true\n      isCorrectionVisible = false\n    } else if (!isQuestionVisible && isCorrectionVisible) {\n      isQuestionVisible = true\n      isCorrectionVisible = true\n    }\n    await tick()\n    renderAllViews()\n  }\n\n  function play(isUserAction: boolean = false) {\n    if (ratioTime >= 100) {\n      nextQuestion()\n    }\n    if (isUserAction) isManualPause = false\n    if (isManualPause) {\n      return\n    }\n    isPause = false\n    if (ratioTime === 0) {\n      // Permet de ne pas sauter une question si la correction est affiche et qu'on se dplace en cliquant sur les steps\n      isQuestionVisible = true\n      isCorrectionVisible = false\n    }\n    if ($globalOptions.manualMode) {\n      return\n    }\n    if (isCorrectionVisible) {\n      nextQuestion()\n      return\n    }\n    clearInterval(advanceRatioTimeInterval)\n    advanceRatioTimeInterval = window.setInterval(() => {\n      ratioTime++\n      if (ratioTime >= 100) {\n        clearInterval(advanceRatioTimeInterval)\n        if (!$globalOptions.pauseAfterEachQuestion) {\n          nextQuestion()\n        }\n      }\n    }, currentSlideDuration * 10)\n  }\n\n  function pause(isUserAction: boolean = false) {\n    if ($globalOptions.manualMode) {\n      return\n    }\n    clearInterval(advanceRatioTimeInterval)\n    isPause = true\n    if (isUserAction) isManualPause = true\n  }\n\n  function switchPause(isUserAction: boolean = false) {\n    if ($globalOptions.manualMode) {\n      return\n    }\n    if (isPause || ratioTime >= 100) {\n      play(isUserAction)\n    } else {\n      pause(isUserAction)\n    }\n  }\n\n  function goToQuestion(questionNumber: number) {\n    if (\n      questionNumber < 0 ||\n      questionNumber > slideshow.selectedQuestionsNumber\n    ) {\n      return\n    }\n    slideshow.currentQuestion = questionNumber\n    ratioTime = 0\n  }\n\n  function returnToStart() {\n    isQuestionVisible = true\n    isCorrectionVisible = false\n    pause(true)\n    goToQuestion(0)\n  }\n</script>\n\n<svelte:window on:keydown={handleShortcut} />\n\n{#if slideshow.currentQuestion < slideshow.selectedQuestionsNumber && slideshow.currentQuestion > -1}\n  <div\n    id=\"diap\"\n    class=\"flex flex-col h-screen scrollbar-hide\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    data-theme=\"daisytheme\"\n  >\n    <header\n      class=\"flex flex-col pb-1 w-full\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    >\n      <SlideshowPlaySteps\n        currentQuestionNumber={slideshow.currentQuestion}\n        isManualModeActive={$globalOptions.manualMode}\n        totalQuestionsNumber={slideshow.selectedQuestionsNumber}\n        {ratioTime}\n        {currentSlideDuration}\n        {goToQuestion}\n      />\n    </header>\n    <main\n      class=\"h-[80%]\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    >\n      <SlideshowPlayQuestion\n        {divQuestion}\n        {isQuestionVisible}\n        {isCorrectionVisible}\n        {currentSlide}\n        currentQuestion={slideshow.currentQuestion}\n        selectedQuestionsNumber={slideshow.selectedQuestionsNumber}\n        isImagesOnSides={!!$globalOptions.isImagesOnSides}\n      />\n    </main>\n    <footer\n      class=\"sticky flex flex-row justify-between w-full py-1 bottom-0 opacity-100\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    >\n      <SlideshowPlaySettings\n        isManualModeActive={$globalOptions.manualMode}\n        {isQuestionVisible}\n        {isCorrectionVisible}\n        {currentSlideDuration}\n        {handleTimerChange}\n        {backToSettings}\n        {isPause}\n        {prevQuestion}\n        {nextQuestion}\n        {switchDisplayMode}\n        {switchPause}\n        {play}\n        {pause}\n        {zoomPlus}\n        {zoomMinus}\n      />\n    </footer>\n  </div>\n{:else}\n  <div\n    id=\"end\"\n    class=\"flex flex-col h-screen scrollbar-hide justify-center\n      text-coopmaths-struct dark:text-coopmathsdark-struct\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    data-theme=\"daisytheme\"\n  >\n    <div\n      class=\"flex flex-row items-center justify-center w-full text-[20vw] font-extrabold\"\n    >\n      Fin !\n    </div>\n    <SlideshowPlayEndButtons {returnToStart} {backToSettings} {goToOverview} />\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../shared/forms/ButtonIconTooltip.svelte'\n  import FullscreenButton from '../../../start/presentationalComponents/header/headerButtons/setupButtons/FullscreenButton.svelte'\n\n  export let goToOverview: () => void\n</script>\n\n<div class=\"flex flex-row justify-start items-center pb-6\">\n  <div\n    class=\"flex text-lg font-bold\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Aperu\n  </div>\n  <div class=\"pl-4\">\n    <ButtonIconTooltip\n      icon=\"bx-detail text-2xl\"\n      tooltip=\"Aperu des questions/rponses\"\n      on:click={goToOverview}\n    />\n  </div>\n  <div class=\"pl-4\">\n    <FullscreenButton />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { formattedTimeStamp } from '../../../../../lib/components/time'\n  import { exercicesParams } from '../../../../../lib/stores/generalStore'\n  import type { IExercice } from '../../../../../lib/types'\n  import NumberInput from '../../../../shared/forms/InputNumber.svelte'\n\n  export let exercises: IExercice[]\n  export let selectedExercisesIndexes: number[]\n  export let isManualModeActive: boolean\n  export let updateExercises: (updateSlidesContent?: boolean) => void\n  export let durationGlobal: number | undefined\n  export let remove: (exerciseIndex: number) => void\n  let stringDureeTotale = '0'\n\n  $: getTotalNbOfQuestions = () => {\n    let sum = 0\n    for (const [i, exercice] of exercises.entries()) {\n      if (selectedExercisesIndexes.length > 0) {\n        if (selectedExercisesIndexes.includes(i)) {\n          sum += exercice.nbQuestions\n        }\n      } else {\n        sum += exercice.nbQuestions\n      }\n    }\n    return sum\n  }\n\n  $: if (exercises && exercises.length > 0) {\n    stringDureeTotale = formattedTimeStamp(getTotalDuration())\n  }\n\n  function getTotalDuration() {\n    let sum = 0\n    for (const [i, exercice] of exercises.entries()) {\n      if (\n        selectedExercisesIndexes !== undefined &&\n        selectedExercisesIndexes.length > 0\n      ) {\n        if (selectedExercisesIndexes.includes(i)) {\n          sum +=\n            (durationGlobal || exercice.duration || 10) * exercice.nbQuestions\n        }\n      } else {\n        sum +=\n          (durationGlobal || exercice.duration || 10) * exercice.nbQuestions\n      }\n    }\n    return sum\n  }\n\n  function updateQuestionsNb(i: number, value: number) {\n    exercises[i].nbQuestions = value\n    exercicesParams.update((params) => {\n      params[i].nbQuestions = value\n      return params\n    })\n    updateExercises()\n  }\n\n  function updateDuration(i: number, value: number) {\n    exercises[i].duration = value\n    exercicesParams.update((params) => {\n      params[i].duration = value\n      return params\n    })\n    updateExercises()\n  }\n</script>\n\n<div\n  class=\"table-wrp block shadow ring-1 rounded-lg\n  ring-opacity-10 dark:ring-opacity-20\n  ring-coopmaths-struct dark:ring-coopmathsdark-struct\"\n>\n  <table\n    class=\"table-fixed min-w-full\n    divide-y\n    divide-opacity-10 dark:divide-opacity-20\n    divide-coopmaths-struct dark:divide-coopmathsdark-struct\"\n  >\n    <thead\n      class=\"sticky top-0\n      bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n    >\n      <tr>\n        <th\n          scope=\"col\"\n          class=\"py-3.5 pl-4 pr-3 w-4/6\n            text-left text-sm font-semibold\n            text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          Exercices\n          <span\n            class=\"pl-1 font-light text-xs\n            text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\n            {selectedExercisesIndexes.length > 0 ? '' : 'invisible'}\"\n          >\n            ({selectedExercisesIndexes.length} parmi {exercises.length})\n          </span>\n        </th>\n        <th\n          scope=\"col\"\n          class=\"py-3.5 pl-4 pr-3 w-1/6\n            text-center text-sm font-semibold\n            text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          <div class={isManualModeActive ? 'opacity-20' : ''}>\n            Dure par question\n          </div>\n          <div\n            class=\"font-light text-xs\n            text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            {#if !isManualModeActive}\n              Dure diapo :<span class=\"font-light ml-1\"\n                >{stringDureeTotale}</span\n              >\n            {:else}\n              <span class=\"font-light ml-1\"></span>\n            {/if}\n          </div>\n        </th>\n        <th\n          scope=\"col\"\n          class=\"py-3.5 pl-4 pr-3 w-1/6\n            text-center text-sm font-semibold\n            text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          <div>Nombres de questions</div>\n          <div\n            class=\"font-light text-xs\n            text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            Total :<span class=\"font-light ml-1\">{getTotalNbOfQuestions()}</span\n            >\n          </div>\n        </th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody class=\"overflow-y-auto\" id=\"exercisesList\">\n      {#each exercises as exercise, i (exercise.id + '-' + i)}\n        <tr>\n          <td\n            class=\"whitespace-normal px-3 py-4 text-sm text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <span\n              class=\"{selectedExercisesIndexes.length > 0 &&\n              selectedExercisesIndexes.length < exercises.length &&\n              selectedExercisesIndexes.includes(i)\n                ? ''\n                : 'invisible'} pr-2\"\n            >\n              <i\n                class=\"bx text-xs bxs-circle text-coopmaths-warn-lightest dark:text-coopmathsdark-warn-lightest\"\n              ></i>\n            </span>\n            {exercise.id} - {exercise.titre}\n          </td>\n          <td class=\"whitespace-normal px-3 py-4 text-sm\">\n            <NumberInput\n              id=\"diaporama-exo-duration-{i}\"\n              max={1000}\n              value={exercise.duration || 10}\n              isDisabled={!!durationGlobal || isManualModeActive}\n              on:change={(e) => {\n                const duration = e.detail\n                updateDuration(i, duration)\n              }}\n            />\n          </td>\n          <td class=\"whitespace-normal px-3 py-4 text-sm\">\n            <NumberInput\n              id=\"diaporama-exo-nb-questions-{i}\"\n              value={exercise.nbQuestions}\n              on:change={(e) => {\n                const nbQuestions = e.detail\n                updateQuestionsNb(i, nbQuestions)\n              }}\n            />\n          </td>\n          <td>\n            <button\n              class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n              data-tip=\"Supprimer l'exercice\"\n              type=\"button\"\n              aria-label=\"Supprimer l'exercice\"\n              on:click={() => remove(i)}\n            >\n              <i\n                class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-trash\"\n              ></i>\n            </button>\n          </td>\n        </tr>\n      {/each}\n    </tbody>\n  </table>\n</div>\n\n<style>\n  .table-wrp {\n    max-height: 60%;\n    overflow-y: auto;\n    display: block;\n  }\n  thead {\n    position: sticky;\n    top: 0;\n  }\n</style>\n","<script lang=\"ts\">\n  import type Exercice from '../../../../../exercices/Exercice'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import NumberInput from '../../../../shared/forms/InputNumber.svelte'\n\n  export let exercises: Exercice[]\n  export let isManualModeActive: boolean\n  export let updateManualMode: (isManualModeActive: boolean) => void\n  export let durationGlobal: number | undefined\n  export let updateDurationGlobal: (durationGlobal: number | undefined) => void\n\n  let previousDurationGlobal = durationGlobal || 10\n  let isSameDurationForAll = !!durationGlobal\n  function handleChangeIsSameDurationForAll(newIsSameDurationForAll: boolean) {\n    isSameDurationForAll = newIsSameDurationForAll\n    if (isSameDurationForAll) {\n      updateDurationGlobal(previousDurationGlobal)\n    } else {\n      updateDurationGlobal(undefined)\n    }\n  }\n\n  function updatePreviousDurationGlobal(newDurationGlobal: number) {\n    previousDurationGlobal = newDurationGlobal\n    updateDurationGlobal(newDurationGlobal)\n  }\n</script>\n\n<div\n  class=\"flex flex-col lg:flex-row px-4 pb-4 w-full\n  justify-start lg:justify-between\n  items-start lg:items-center\"\n>\n  <div\n    class=\"flex text-lg font-bold\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Dures et nombres de questions\n  </div>\n  <div class=\"flex items-center\">\n    <CheckboxWithLabel\n      id=\"slideshow-manual-mode-checkbox\"\n      isChecked={isManualModeActive}\n      label=\"Dfilement manuel\"\n      on:change={(e) => {\n        const isChecked = e.detail\n        updateManualMode(isChecked)\n      }}\n    />\n    <CheckboxWithLabel\n      id=\"slideshow-same-duration-checkbox\"\n      isChecked={isSameDurationForAll}\n      isDisabled={exercises.length === 1 || isManualModeActive}\n      label=\"Mme dure pour toutes les questions\"\n      on:change={(e) => {\n        const isChecked = e.detail\n        handleChangeIsSameDurationForAll(isChecked)\n      }}\n    />\n    <NumberInput\n      id=\"diaporama-same-duration-input\"\n      value={previousDurationGlobal}\n      isDisabled={!isSameDurationForAll || isManualModeActive}\n      on:change={(e) => {\n        const previousDurationGlobal = e.detail\n        updatePreviousDurationGlobal(previousDurationGlobal)\n      }}\n    />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ButtonQRCode from '../../../../shared/forms/ButtonQRCode.svelte'\n  import ButtonActionInfo from '../../../../shared/forms/ButtonActionInfo.svelte'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n\n  let isSameData: boolean = false\n</script>\n\n<div>\n  <div\n    class=\"flex text-lg font-bold pb-2\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Liens\n  </div>\n  <div>\n    <CheckboxWithLabel\n      id=\"slideshow-links-same-data-checkbox\"\n      bind:isChecked={isSameData}\n      label=\"Mmes valeurs d'une session  l'autre\"\n    />\n  </div>\n  <div class=\"flex flex-row pl-4 space-x-2 font-normal\">\n    <ButtonActionInfo\n      action=\"copy\"\n      icon={'bx-link text-2xl'}\n      useCurrentUrl={true}\n      removeSeed={!isSameData}\n      tooltip=\"Lien du Diaporama\"\n      successMessage=\"Le lien du diaporama est copi dans le presse-papier !\"\n      errorMessage=\"Impossible de copier le lien du diaporama dans le presse-papier.\"\n    />\n    <ButtonQRCode\n      tooltip={'QR-code du diaporama'}\n      useCurrentUrl={true}\n      removeSeed={!isSameData}\n    />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n\n  export let isQuestionsOrdered: boolean\n  export let updateQuestionsOrder: (isQuestionsOrdered: boolean) => void\n</script>\n\n<div class=\"pb-6\">\n  <div\n    class=\"flex text-lg font-bold mb-1\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Ordre\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-order-checkbox\"\n    isChecked={isQuestionsOrdered}\n    label=\"Questions dans l'ordre\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      updateQuestionsOrder(isChecked)\n    }}\n  />\n</div>\n","<script lang=\"ts\">\n  import type { IExercice } from '../../../../../lib/types'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import NumberInput from '../../../../shared/forms/InputNumber.svelte'\n\n  export let exercises: IExercice[]\n  export let selectedExercisesIndexes: number[]\n  export let applyRandomSelectionOfExercises: (\n    numberOfSelectedExercises: number,\n  ) => void\n\n  const isSelectedExercises: boolean = selectedExercisesIndexes.length > 0\n  let selectedExercisesCount: number = selectedExercisesIndexes.length\n</script>\n\n<div class=\"pb-6\">\n  <div\n    class=\"flex text-lg font-bold mb-1\n      {exercises.length === 1 ? 'text-coopmaths-struct/20 dark:text-coopmathsdark-struct/20' : 'text-coopmaths-struct dark:text-coopmathsdark-struct'}\"\n  >\n    Slection alatoire d'exercices\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-selected-exercises-checkbox\"\n    isChecked={isSelectedExercises}\n    isDisabled={exercises.length === 1}\n    label=\"Seulement certains exercices de la liste\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      selectedExercisesCount = isChecked ? exercises.length - 1 : 0\n      applyRandomSelectionOfExercises(selectedExercisesCount)\n    }}\n  />\n  <div class=\"pl-8 mt-1 flex\">\n    <NumberInput\n      id=\"slideshow-selected-exercises-count-input\"\n      max={exercises.length - 1}\n      value={selectedExercisesCount}\n      isDisabled={!selectedExercisesCount}\n      on:change={(e) => {\n        const selectedExercisesCount = e.detail\n        applyRandomSelectionOfExercises(selectedExercisesCount)\n      }}\n    />\n    <span\n      class=\"ml-2 my-auto\n        {selectedExercisesCount\n        ? 'text-coopmaths-corpus dark:text-coopmathsdark-corpus'\n        : 'text-coopmaths-corpus/10 dark:text-coopmathsdark-corpus/10'}\"\n    >\n      parmi {exercises.length}\n    </span>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { isIntegerInRange0to3 } from '../../../../../lib/types/integerInRange'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n\n  export let transitionSounds: {\n    0: HTMLAudioElement\n    1: HTMLAudioElement\n    2: HTMLAudioElement\n    3: HTMLAudioElement\n  }\n  export let screenBetweenSlides: boolean\n  export let sound: 0 | 1 | 2 | 3 | 4\n  export let updateFlow: (flow: 0 | 1 | 2) => void\n  export let updateScreenBetweenSlides: (screenBetweenSlides: boolean) => void\n  export let updateTune: (tune: -1 | 0 | 1 | 2 | 3) => void\n  export let updatePauseAfterEachQuestion: (\n    pauseAfterEachQuestion: boolean,\n  ) => void\n  export let questionThenCorrectionToggle: boolean\n  export let questionWithCorrectionToggle: boolean\n  export let pauseAfterEachQuestion: boolean\n\n  const labelsForSounds = [\n    { label: 'Son 1', value: 0 },\n    { label: 'Son 2', value: 1 },\n    { label: 'Son 3', value: 2 },\n    { label: 'Son 4', value: 3 },\n  ]\n\n  let soundToggle = sound > 0\n  $: soundToggle = sound > 0\n\n  const tuneCandidate = Math.max(sound - 1, 0)\n  let tune: 0 | 1 | 2 | 3 = isIntegerInRange0to3(tuneCandidate)\n    ? tuneCandidate\n    : 0\n</script>\n\n<div class=\"pb-8\">\n  <div\n    class=\"flex text-lg font-bold mb-1\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Transitions\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-transition-alternate-checkbox\"\n    isChecked={questionThenCorrectionToggle}\n    label=\"Alterner questions et corrections\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      updateFlow(isChecked ? 1 : 0)\n    }}\n  />\n  <div class=\"ml-3\">\n    <CheckboxWithLabel\n      id=\"slideshow-transition-with-question-checkbox\"\n      isChecked={questionWithCorrectionToggle}\n      isDisabled={!questionThenCorrectionToggle}\n      label=\"En gardant les questions affiches\"\n      on:change={(e) => {\n        const isChecked = e.detail\n        updateFlow(isChecked ? 2 : 1)\n      }}\n    />\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-transition-screen-between-checkbox\"\n    isChecked={screenBetweenSlides}\n    label=\"Avec des cartons entre les questions\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      updateScreenBetweenSlides(isChecked)\n    }}\n  />\n  <CheckboxWithLabel\n    id=\"slideshow-transition-sound-checkbox\"\n    isChecked={soundToggle}\n    label=\"Jouer un son entre les questions\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      if (isChecked) {\n        transitionSounds[tune].play()\n        updateTune(tune)\n      } else {\n        updateTune(-1)\n      }\n    }}\n  />\n  <FormRadio\n    title=\"son\"\n    isDisabled={!soundToggle}\n    bind:valueSelected={tune}\n    labelsValues={labelsForSounds}\n    orientation=\"row\"\n    on:newvalue={() => {\n      transitionSounds[tune].play()\n      updateTune(tune)\n    }}\n  />\n  <CheckboxWithLabel\n    id=\"slideshow-pause-after-each-question-checkbox\"\n    isChecked={pauseAfterEachQuestion}\n    label=\"Avec une pause aprs chaque question\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      updatePauseAfterEachQuestion(isChecked)\n    }}\n  />\n</div>\n","<script lang=\"ts\">\n  import type { NumberRange } from '../../../../../lib/types'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n\n  export let nbOfViews: NumberRange<1, 4>\n  export let updateNbOfViews: (nbOfViews: NumberRange<1, 4>) => void\n  export let isImagesOnSides: boolean\n  export let updateIsImagesOnSides: (isImagesOnSides: boolean) => void\n\n  const labelsForMultivue = [\n    { label: 'Pas de multivue', value: 1 },\n    { label: 'Deux vues', value: 2 },\n    { label: 'Trois vues', value: 3 },\n    { label: 'Quatre vues', value: 4 },\n  ]\n</script>\n\n<div\n  class=\"flex text-lg font-bold mb-2\n  text-coopmaths-struct dark:text-coopmathsdark-struct\"\n>\n  Affichage\n</div>\n<div class=\"flex flex-col px-4 pb-8\">\n  <FormRadio\n    bind:valueSelected={nbOfViews}\n    on:newvalue={() => updateNbOfViews(nbOfViews)}\n    title=\"multivue\"\n    labelsValues={labelsForMultivue}\n  />\n  <CheckboxWithLabel\n    id=\"slideshow-view-images-on-sides-checkbox\"\n    isChecked={isImagesOnSides}\n    label=\"Afficher les images sur les cts\"\n    on:change={(e) => {\n      const isChecked = e.detail\n      updateIsImagesOnSides(isChecked)\n    }}\n  />\n</div>\n","<script lang=\"ts\">\n  import { tick } from 'svelte'\n  import type Exercice from '../../../../exercices/Exercice'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { listOfRandomIndexes } from '../../../../lib/outils/arrayOutils'\n  import { globalOptions } from '../../../../lib/stores/globalOptions'\n  import { referentielLocale } from '../../../../lib/stores/languagesStore'\n  import { type NumberRange } from '../../../../lib/types'\n  import { isIntegerInRange0to4 } from '../../../../lib/types/integerInRange'\n  import NavBar from '../../../shared/header/NavBar.svelte'\n  import DisplaySettings from './presentationalComponents/DisplaySettings.svelte'\n  import ExercisesSettings from './presentationalComponents/ExercisesSettings.svelte'\n  import GlobalDurationSettings from './presentationalComponents/GlobalDurationSettings.svelte'\n  import LinksSettings from './presentationalComponents/LinksSettings.svelte'\n  import OrderSettings from './presentationalComponents/OrderSettings.svelte'\n  import SelectedExercisesSettings from './presentationalComponents/SelectedExercisesSettings.svelte'\n  import TransitionSettings from './presentationalComponents/TransitionSettings.svelte'\n  import ViewSettings from './presentationalComponents/ViewSettings.svelte'\n\n  export let exercises: Exercice[]\n  export let updateExercises: (updateSlidesContent?: boolean) => void\n  export let transitionSounds: {\n    0: HTMLAudioElement\n    1: HTMLAudioElement\n    2: HTMLAudioElement\n    3: HTMLAudioElement\n  }\n  export let startSlideshow: () => void\n  export let goToOverview: () => void\n  export let goToHome: () => void\n\n  let divTableDurationsQuestions: HTMLDivElement\n  let previousNumberOfSelectedExercises: number\n\n  $: if (divTableDurationsQuestions && exercises.length > 0) {\n    tick().then(() => {\n      mathaleaRenderDiv(divTableDurationsQuestions)\n    })\n  }\n\n  function applyRandomSelectionOfExercises(numberOfSelectedExercises: number) {\n    let selection: number[] | undefined\n    if (\n      numberOfSelectedExercises > 0 &&\n      numberOfSelectedExercises < exercises.length\n    ) {\n      selection = [\n        ...listOfRandomIndexes(exercises.length, numberOfSelectedExercises),\n      ].sort((a, b) => a - b)\n    }\n    previousNumberOfSelectedExercises = numberOfSelectedExercises\n    updateSelect(selection)\n  }\n\n  function updateNbOfViews(nbVues: NumberRange<1, 4>) {\n    $globalOptions.nbVues = nbVues\n  }\n\n  function updateFlow(flow: 0 | 1 | 2) {\n    $globalOptions.flow = flow\n  }\n\n  function updateScreenBetweenSlides(screenBetweenSlides: boolean) {\n    $globalOptions.screenBetweenSlides = screenBetweenSlides\n  }\n\n  function updatePauseAfterEachQuestion(pauseAfterEachQuestion: boolean) {\n    $globalOptions.pauseAfterEachQuestion = pauseAfterEachQuestion\n  }\n\n  function updateTune(tune: -1 | 0 | 1 | 2 | 3) {\n    const soundCandidate = tune + 1\n    if (isIntegerInRange0to4(soundCandidate)) {\n      $globalOptions.sound = soundCandidate\n    }\n  }\n\n  function updateQuestionsOrder(isQuestionsOrdered: boolean) {\n    $globalOptions.shuffle = !isQuestionsOrdered\n    updateExercises()\n  }\n\n  function updateSelect(selectedExercisesIndexes: number[] | undefined) {\n    $globalOptions.select = selectedExercisesIndexes\n    updateExercises()\n  }\n\n  function updateManualMode(isManualModeActive: boolean) {\n    $globalOptions.manualMode = isManualModeActive\n  }\n\n  function updateDurationGlobal(durationGlobal: number | undefined) {\n    $globalOptions.durationGlobal = durationGlobal\n  }\n\n  function updateIsImagesOnSides(isImagesOnSides: boolean) {\n    $globalOptions.isImagesOnSides = isImagesOnSides\n  }\n\n  function remove(exerciseIndex: number) {\n    exercises.splice(exerciseIndex, 1)\n    if (exercises.length === 0) {\n      goToHome()\n    }\n    applyRandomSelectionOfExercises(previousNumberOfSelectedExercises)\n    updateExercises()\n    exercises = exercises // to refresh ExercisesSettings component\n  }\n</script>\n\n<div\n  id=\"start\"\n  class=\"flex flex-col min-h-screen scrollbar-hide\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n    text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n>\n  <NavBar\n    subtitle=\"Rglages du diaporama\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n  <div\n    class=\"flex justify-end items-start mt-10\n    flex-col md:flex-row\"\n  >\n    <!-- Left Side -->\n    <div class=\"flex flex-col justify-start ml-4\">\n      <DisplaySettings {goToOverview} />\n      <ViewSettings\n        nbOfViews={$globalOptions.nbVues ?? 1}\n        {updateNbOfViews}\n        isImagesOnSides={!!$globalOptions.isImagesOnSides}\n        {updateIsImagesOnSides}\n      />\n      <TransitionSettings\n        {transitionSounds}\n        screenBetweenSlides={!!$globalOptions.screenBetweenSlides}\n        sound={$globalOptions.sound ?? 0}\n        {updateFlow}\n        {updateScreenBetweenSlides}\n        {updateTune}\n        {updatePauseAfterEachQuestion}\n        questionThenCorrectionToggle={$globalOptions.flow === 1 ||\n          $globalOptions.flow === 2}\n        questionWithCorrectionToggle={$globalOptions.flow === 2}\n        pauseAfterEachQuestion={!!$globalOptions.pauseAfterEachQuestion}\n      />\n      <OrderSettings\n        isQuestionsOrdered={!$globalOptions.shuffle}\n        {updateQuestionsOrder}\n      />\n      <SelectedExercisesSettings\n        {exercises}\n        selectedExercisesIndexes={$globalOptions.select ?? []}\n        {applyRandomSelectionOfExercises}\n      />\n      <LinksSettings />\n    </div>\n    <!-- Right Side -->\n    <div\n      class=\"flex flex-col justify-start\n      md:w-4/6\n      mr-0 md:mr-4\"\n    >\n      <GlobalDurationSettings\n        {exercises}\n        isManualModeActive={!!$globalOptions.manualMode}\n        {updateManualMode}\n        durationGlobal={$globalOptions.durationGlobal}\n        {updateDurationGlobal}\n      />\n      <div\n        class=\"flex flex-col align-middle min-w-full h-[100vh] px-4\"\n        bind:this={divTableDurationsQuestions}\n      >\n        <ExercisesSettings\n          {exercises}\n          isManualModeActive={!!$globalOptions.manualMode}\n          {updateExercises}\n          durationGlobal={$globalOptions.durationGlobal}\n          selectedExercisesIndexes={$globalOptions.select ?? []}\n          {remove}\n        />\n        <div class=\"flex flex-row items-center justify-end w-full my-4\">\n          <button\n            type=\"button\"\n            id=\"diaporama-play-button\"\n            class=\"animate-pulse inline-flex items-center justify-center shadow-2xl rounded-lg p-4 pr-2\n              font-extrabold text-3xl\n              bg-coopmaths-action dark:bg-coopmathsdark-action\n              hover:bg-coopmaths-action-lightest dark:hover:bg-coopmathsdark-action-lightest\n              text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n            on:click={startSlideshow}\n            on:keydown={startSlideshow}\n          >\n            Play<i class=\"bx bx-play\"></i>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import { notify } from '../../../bugsnag'\n  import type Exercice from '../../../exercices/Exercice'\n  import {\n    getExercisesFromExercicesParams,\n    mathaleaFormatExercice,\n    mathaleaGenerateSeed,\n    mathaleaHandleExerciceSimple,\n    mathaleaHandleSup,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea'\n  import { shuffle } from '../../../lib/outils/arrayOutils'\n  import {\n    darkMode,\n    exercicesParams,\n    previousView,\n  } from '../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import type { IExercice, InterfaceParams } from '../../../lib/types'\n  import type { CanState } from '../../../lib/types/can'\n  import { isIntegerInRange0to3 } from '../../../lib/types/integerInRange'\n  import { context } from '../../../modules/context.js'\n  import CountDown from '../../display/can/presentationalComponents/CountDown.svelte'\n  import KickOff from '../../display/can/presentationalComponents/KickOff.svelte'\n  import ButtonText from '../../shared/forms/ButtonText.svelte'\n  import SlideshowOverview from './slideshowOverview/SlideshowOverview.svelte'\n  import SlideshowPlay from './slideshowPlay/SlideshowPlay.svelte'\n  import SlideshowSettings from './slideshowSettings/SlideshowSettings.svelte'\n  import type { Slide, Slideshow } from './types'\n\n  const transitionSounds = {\n    0: new Audio('assets/sounds/transition_sound_01.mp3'),\n    1: new Audio('assets/sounds/transition_sound_02.mp3'),\n    2: new Audio('assets/sounds/transition_sound_03.mp3'),\n    3: new Audio('assets/sounds/transition_sound_04.mp3'),\n  }\n\n  let state: CanState = 'end'\n  let exercises: Exercice[] = []\n  let slideshow: Slideshow = {\n    slides: [],\n    currentQuestion: -1,\n    selectedQuestionsNumber: 0,\n  }\n\n  $: if ($globalOptions.v === 'overview' && exercises.length > 0)\n    updateExercises(true)\n  $: if (state === 'race') startSlideshow()\n\n  onMount(async () => {\n    if ($previousView === undefined) state = 'start'\n    context.vue = 'diap'\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    exercises = await getExercisesFromExercicesParams()\n    updateExercises(false, true)\n  })\n\n  onDestroy(() => {\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  async function forceUpdate() {\n    updateExercises(true)\n  }\n\n  async function updateExercises(\n    updateSlidesContent = false,\n    updateParamsFromUrl = false,\n  ) {\n    if (updateSlidesContent) setSlidesContent(exercises)\n    if ($globalOptions.v !== 'overview') adjustQuestionsOrder()\n    updateParamsFromUrl\n      ? mathaleaUpdateExercicesParamsFromUrl()\n      : updateExerciseParams(exercises)\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n  }\n\n  function setSlidesContent(newExercises: Exercice[]) {\n    const slides = []\n    const nbOfVues = $globalOptions.nbVues || 1\n    let selectedQuestionsNumber = 0\n    for (const [k, exercise] of [...newExercises].entries()) {\n      reroll(exercise)\n      const isSelected = $globalOptions.select?.includes(k) ?? true\n      if (isSelected) selectedQuestionsNumber += exercise.listeQuestions.length\n      for (let i = 0; i < exercise.listeQuestions.length; i++) {\n        const slide: Slide = {\n          exercise,\n          isSelected,\n          vues: [],\n        }\n        for (let idVue = 0; idVue < nbOfVues; idVue++) {\n          if (isIntegerInRange0to3(idVue)) {\n            reroll(exercise, idVue)\n          } else {\n            notify(`idVue ${idVue} is not an integer in range 0 to 3`, {})\n          }\n          const consigne = mathaleaFormatExercice(\n            exercise.consigne + exercise.introduction\n              ? '\\n' + exercise.consigne + exercise.introduction\n              : '',\n          )\n          const question = mathaleaFormatExercice(exercise.listeQuestions[i])\n          const correction = mathaleaFormatExercice(\n            exercise.listeCorrections[i],\n          )\n          const { svgs: questionSvgs, text: questionText } =\n            splitSvgFromText(question)\n          const { svgs: consigneSvgs, text: consigneText } =\n            splitSvgFromText(consigne)\n          const { svgs: correctionSvgs, text: correctionText } =\n            splitSvgFromText(correction)\n          slide.vues.push({\n            consigne,\n            question,\n            correction,\n            consigneSvgs,\n            consigneText,\n            questionSvgs,\n            questionText,\n            correctionSvgs,\n            correctionText,\n          })\n        }\n        slides.push(slide)\n      }\n    }\n    slideshow = {\n      slides,\n      currentQuestion: -1,\n      selectedQuestionsNumber: selectedQuestionsNumber || slides.length,\n    }\n  }\n\n  function reroll(exercise: IExercice, idVue?: 0 | 1 | 2 | 3) {\n    const interactif = exercise.interactif\n    exercise.interactif = false\n    if (exercise.seed === undefined) exercise.seed = mathaleaGenerateSeed()\n    const originalSeed = exercise.seed\n    if (idVue !== undefined && idVue > 0)\n      exercise.seed = exercise.seed + String(idVue)\n    if (exercise.typeExercice === 'simple') {\n      mathaleaHandleExerciceSimple(exercise, false)\n    } else {\n      seedrandom(exercise.seed, { global: true })\n      exercise.nouvelleVersionWrapper?.()\n    }\n    exercise.seed = originalSeed\n    exercise.interactif = interactif\n  }\n\n  function splitSvgFromText(sourceText: string) {\n    const parser = new DOMParser()\n    const doc = parser.parseFromString(sourceText, 'text/html')\n    const mathalea2dContainers = doc.querySelectorAll('div.svgContainer')\n    const scratchContainers = doc.querySelectorAll('pre.blocks')\n    const svgContainers = [...mathalea2dContainers, ...scratchContainers]\n    const svgs = Array.from(svgContainers).map(\n      (container) => container.outerHTML,\n    )\n    const text = removeSvgContainers(doc.body.innerHTML, svgs)\n    return {\n      svgs,\n      text,\n    }\n  }\n\n  function removeSvgContainers(wholeQuestion: string, svgContainers: string[]) {\n    let questionWithoutSvgContainers = wholeQuestion\n    svgContainers.forEach((svgContainer) => {\n      questionWithoutSvgContainers = questionWithoutSvgContainers.replace(\n        svgContainer,\n        '',\n      )\n    })\n    return questionWithoutSvgContainers\n  }\n\n  function adjustQuestionsOrder() {\n    const areSomeExercisesSelected =\n      $globalOptions.select && $globalOptions.select.length > 0\n    const selectedIndexes = areSomeExercisesSelected\n      ? getSelectedQuestionsIndexes()\n      : [...Array(slideshow.slides.length).keys()]\n    let order = undefined\n    if ($globalOptions.order && $globalOptions.order.length > 0) {\n      order = $globalOptions.order.slice(0, selectedIndexes.length)\n    }\n    if (\n      ($globalOptions.select && $globalOptions.select.length > 0) ||\n      ($globalOptions.order &&\n        $globalOptions.order.length < selectedIndexes.length)\n    ) {\n      order = selectedIndexes\n    }\n    if ($globalOptions.shuffle) {\n      if (\n        !$globalOptions.order ||\n        $globalOptions.order.length === 0 ||\n        isSameArray($globalOptions.order, selectedIndexes)\n      ) {\n        order = shuffle(selectedIndexes)\n      } else {\n        if ($globalOptions.order.length >= selectedIndexes.length) {\n          order = $globalOptions.order.slice(0, selectedIndexes.length)\n        } else {\n          order = shuffle(selectedIndexes)\n        }\n      }\n    }\n    $globalOptions.order = order\n  }\n\n  function isSameArray(a: number[], b: number[]) {\n    if (a.length !== b.length) return false\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false\n    }\n    return true\n  }\n\n  function getSelectedQuestionsIndexes() {\n    const indexes = []\n    for (const [i, slide] of [...slideshow.slides].entries()) {\n      if (slide.isSelected) {\n        indexes.push(i)\n      }\n    }\n    return indexes\n  }\n\n  function updateExerciseParams(newExercises: Exercice[]) {\n    if (newExercises.length === get(exercicesParams).length) {\n      // Update si ncessaire\n      exercicesParams.update((params: InterfaceParams[]) => {\n        params.forEach((param, i) => {\n          if (\n            param.alea &&\n            param.alea !== newExercises[i].seed?.substring(0, 4)\n          )\n            param.alea = newExercises[i].seed?.substring(0, 4)\n        })\n        return params\n      })\n    } else {\n      // MGU : on remet tout mais j'aime PAS , ancien code, ne devrait pas tre utilis\n      const newParams: InterfaceParams[] = []\n      for (const exercice of newExercises) {\n        newParams.push({\n          cd: exercice.correctionDetaillee ? '1' : '0',\n          uuid: exercice.uuid,\n          id: exercice.id,\n          alea: exercice.seed?.substring(0, 4),\n          nbQuestions: exercice.nbQuestions,\n          duration: exercice.duration,\n          sup: mathaleaHandleSup(exercice.sup),\n          sup2: mathaleaHandleSup(exercice.sup2),\n          sup3: mathaleaHandleSup(exercice.sup3),\n          sup4: mathaleaHandleSup(exercice.sup4),\n          sup5: mathaleaHandleSup(exercice.sup5),\n        })\n      }\n      exercicesParams.set(newParams)\n    }\n  }\n\n  function startSlideshow() {\n    updateExercises(true)\n    $globalOptions.v = 'diaporama'\n    slideshow.currentQuestion = 0\n  }\n\n  function backToSettings() {\n    $globalOptions.v = 'diaporama'\n    slideshow.currentQuestion = -1\n  }\n\n  function goToHome() {\n    $globalOptions.v = ''\n  }\n\n  function goToOverview() {\n    $globalOptions.v = 'overview'\n  }\n</script>\n\n<div\n  id=\"diaporama\"\n  class=\"min-h-screen h-screen {$darkMode.isActive ? 'dark' : ''}\"\n>\n  {#if $globalOptions.v === 'overview' && slideshow.slides.length > 0}\n    <SlideshowOverview\n      {exercises}\n      {slideshow}\n      {updateExercises}\n      {backToSettings}\n    />\n  {:else}\n    {#if slideshow.currentQuestion === -1}\n      {#if state === 'start'}\n        <KickOff title=\"Diaporama\" subTitle=\"\" bind:state>\n          <ButtonText\n            class=\"mt-8 py-3 px-6 text-3xl rounded-xl font-bold border-2\n              border-coopmaths-struct-light dark:border-coopmathsdark-struct-light\n              text-coopmaths-canvas dark:text-coopmathsdark-canvas\n              bg-coopmaths-struct dark:bg-coopmathsdark-struct\n              hover:bg-coopmaths-struct-light dark:hover:bg-coopmathsdark-struct-lightest\"\n            text=\"Paramtres\"\n            on:click={() => {\n              state = 'end'\n            }}\n          />\n        </KickOff>\n      {:else if state === 'countdown'}\n        <CountDown bind:state />\n      {:else}\n        <SlideshowSettings\n          {exercises}\n          {updateExercises}\n          {transitionSounds}\n          {startSlideshow}\n          {goToOverview}\n          {goToHome}\n        />\n      {/if}\n    {/if}\n    {#if slideshow.currentQuestion > -1}\n      <SlideshowPlay\n        {slideshow}\n        {transitionSounds}\n        {backToSettings}\n        {goToOverview}\n      />\n    {/if}\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import * as ace from 'brace'\n  import 'brace/ext/searchbox'\n  import 'brace/mode/latex'\n  import 'brace/theme/monokai'\n\n  import { onDestroy, onMount, tick } from 'svelte'\n  import { tweened, type Tweened } from 'svelte/motion'\n  import type Latex from '../../../lib/Latex'\n  import {\n    buildImagesUrlsList,\n    doesLatexNeedsPics,\n    getExosContentList,\n    getPicsNames,\n  } from '../../../lib/Latex'\n  import { type LatexFileInfos } from '../../../lib/LatexTypes'\n  import ButtonTextAction from './ButtonTextAction.svelte'\n\n  export let latex: Latex\n  export let latexFileInfos: LatexFileInfos\n  export let id: string\n\n  let clockAbled: boolean = false\n\n  let idkey = id || '0'\n\n  const original = 1 * 60 // TYPE NUMBER OF SECONDS HERE\n  const timer: Tweened<number> = tweened(original)\n  const defaultengine = 'lualatex'\n  const defaultreturn = 'pdfjs'\n\n  onMount(() => {\n    window.addEventListener('keydown', handleKeyDown)\n  })\n  onDestroy(() => {\n    window.removeEventListener('keydown', handleKeyDown)\n  })\n  function handleKeyDown(event: KeyboardEvent) {\n    const isSaveShortcut = (event.ctrlKey || event.metaKey) && event.key === 's'\n    if (isSaveShortcut) {\n      event.preventDefault()\n      compileToPDF()\n    }\n  }\n\n  // ------ dont need to modify code below\n\n  function addinput(f: HTMLFormElement, n: string, v: string) {\n    const inp = document.createElement('input')\n    inp.setAttribute('type', 'text')\n    inp.setAttribute('name', n)\n    inp.value = encodeURIComponent(v)\n    f.appendChild(inp)\n  }\n\n  function addinputnoenc(f: HTMLFormElement, n: string, v: string) {\n    const inp = document.createElement('input')\n    inp.setAttribute('type', 'text')\n    inp.setAttribute('name', n)\n    inp.value = v\n    f.appendChild(inp)\n  }\n\n  function addtextarea(f: HTMLFormElement, n: string, v: string) {\n    const inp = document.createElement('textarea')\n    inp.setAttribute('type', 'text')\n    inp.setAttribute('name', n)\n    inp.textContent = v\n    f.appendChild(inp)\n  }\n\n  function submitFormToIframe(formData: FormData) {\n    const form = document.getElementById(`form${idkey}`) as HTMLFormElement\n    form.innerHTML = ''\n    form.action = 'https://texlive.net/cgi-bin/latexcgi'\n    form.method = 'POST'\n    form.target = `pre0ifr${idkey}`\n    form.enctype = 'multipart/form-data'\n\n    for (const [name, value] of formData.entries()) {\n      if (name === 'filecontents[]') {\n        addtextarea(form, name, value.toString())\n      } else if (name === 'filename[]') {\n        addinputnoenc(form, name, value.toString())\n      } else {\n        addinput(form, name, value.toString())\n      }\n    }\n    form.style.display = 'none'\n    form.submit()\n  }\n\n  function resetIframe(): HTMLElement {\n    const iframe = document.getElementById(`pre0ifr${idkey}`) as HTMLElement\n    const parent = iframe.parentElement\n    parent?.removeChild(iframe)\n    const iframe2 = document.createElement('iframe')\n    iframe2.setAttribute('title', 'output')\n    iframe2.setAttribute('width', '100%')\n    iframe2.setAttribute('height', '100%')\n    iframe2.setAttribute('id', `pre0ifr${idkey}`)\n    iframe2.setAttribute('name', `pre0ifr${idkey}`)\n    parent?.appendChild(iframe2)\n    return iframe2\n  }\n\n  async function compileToPDF() {\n    const editor = ace.edit(`editor${idkey}`)\n    const t = editor.getValue()\n\n    const iframe2 = resetIframe()\n\n    const formData = new FormData()\n    formData.append('filecontents[]', t)\n    formData.append('filename[]', 'document.tex')\n    formData.append('engine', defaultengine)\n    formData.append('return', defaultreturn)\n\n    const contents = await latex.getContents(latexFileInfos)\n    const picsWanted = doesLatexNeedsPics(contents)\n    const exosContentList = getExosContentList(latex.exercices)\n    const picsNames = getPicsNames(exosContentList)\n    const imagesUrls: string[] = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n\n    for (let im = 0; im < imagesUrls.length; im++) {\n      const imaUrl = imagesUrls[im].replace(\n        'https://coopmaths.fr',\n        window.location.origin,\n      )\n      const visual = await fetch(imaUrl)\n      const blob = await visual.blob()\n      const stringfile = await blob.text()\n      formData.append('filecontents[]', stringfile)\n      formData.append('filename[]', imaUrl.split('/').slice(-1)[0])\n    }\n\n    timer.set(original)\n    clockAbled = true\n    const timeValue = setInterval(() => {\n      if ($timer > 0) {\n        $timer--\n      } else {\n        clearInterval(timeValue)\n      }\n    }, 1000)\n\n    iframe2.addEventListener('load', function (this) {\n      clockAbled = false\n      clearInterval(timeValue)\n      timer.set(original)\n    })\n\n    submitFormToIframe(formData)\n  }\n\n  /**\n   * Affiche ou ferme si dj ouvert le code Latex dans une boite de dialogue\n   */\n  async function dialogToDisplayToggle() {\n    const dialog = document.getElementById(\n      `editorLatex${idkey}`,\n    ) as HTMLDialogElement\n    if (dialog.open) {\n      clockAbled = false\n      dialog.close()\n    } else {\n      const contents = await latex.getContents(latexFileInfos)\n      const picsWanted = doesLatexNeedsPics(contents)\n      const exosContentList = getExosContentList(latex.exercices)\n      const picsNames = getPicsNames(exosContentList)\n      const imagesUrls: string[] = picsWanted\n        ? buildImagesUrlsList(exosContentList, picsNames)\n        : []\n\n      const { latexWithPreamble } = await latex.getFile(latexFileInfos)\n\n      const editor = ace.edit(`editor${idkey}`)\n      editor.getSession().setMode('ace/mode/latex')\n      editor.getSession().setNewLineMode('unix')\n      editor.setTheme('ace/theme/monokai')\n      // Ouvrir la searchbox avec Ctrl+F\n      editor.commands.addCommand({\n        name: 'showSearchBox',\n        bindKey: { win: 'Ctrl-F', mac: 'Command-F' },\n        exec: function (edite: any) {\n          edite.execCommand('find')\n        },\n      })\n      editor.setShowPrintMargin(false)\n      editor.setValue(latexWithPreamble)\n      editor.gotoLine(1)\n\n      resetIframe()\n\n      const imageLatex = document.getElementById('imagesLatex') as HTMLElement\n      imageLatex.innerHTML = \"Nombre d'images: \" + imagesUrls.length\n      dialog.showModal()\n      await tick()\n      compileToPDF()\n    }\n  }\n</script>\n\n<!--\n  @component\n  Bouton dclenchant l'exportation vers OverLeaf\n\n  ### Paramtres\n\n  * `latex` : code latex du document\n  * `latexFileInfos` : objet contenant les lments de mise en forme du fichier\n  * `disabled` : flag permettant de dsactiver le bouton\n\n  ### Exemple\n  ```tsx\n  <ButtonOverleaf\n    {latex}\n    latexFileInfos={{ title, reference, subtitle, style, nbVersions }}\n    disabled={false}\n  />\n  ```\n -->\n\n<form\n  class=\"{`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\"\n  target=\"_blank\"\n>\n  <button\n    id=\"btn_overleaf\"\n    type=\"submit\"\n    on:click|preventDefault=\"{dialogToDisplayToggle}\"\n    class=\"px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n  >\n    Compiler et obtenir le PDF\n  </button>\n</form>\n\n<dialog\n  class=\"fixed rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus left-[2%] top-[2%] w-[96%] h-[96%] dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  id=\"editorLatex{idkey}\"\n>\n  <div class=\"mt-3 text-center\">\n    <div class=\"text-3xl font-medium text-coopmaths-warn-dark\">\n      <span class=\"header\">\n        <div class=\"absolute top-2 right-3\">\n          <button\n            type=\"button\"\n            aria-label=\"Close editor\"\n            on:click=\"{() => {\n              dialogToDisplayToggle()\n            }}\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n            ></i>\n          </button>\n        </div>\n      </span>\n    </div>\n    <div class=\"font-light\">\n      <div class=\"flex h-[80vh] flex-row max-md:portrait:flex-col\">\n        <div id=\"editor{idkey}\" class=\"flex flex-grow flex-1\"></div>\n        <div class=\"bg-gray-100 flex flex-grow flex-1\">\n          {#if clockAbled}\n            <div class=\"loader\">\n              <span\n                ><progress value=\"{$timer / original}\"\n                ></progress>{$timer.toFixed(0)}s</span\n              >\n            </div>\n          {/if}\n          <iframe\n            title=\"output\"\n            width=\"100%\"\n            height=\"100%\"\n            id=\"pre0ifr{idkey}\"\n            name=\"pre0ifr{idkey}\"\n          ></iframe>\n        </div>\n      </div>\n      <div id=\"imagesLatex\"></div>\n      <ButtonTextAction\n        disabled=\"{clockAbled}\"\n        class=\"px-2 py-1 rounded-md\"\n        text=\"Compiler en PDF\"\n        on:click=\"{compileToPDF}\"\n      />\n      <form id=\"form{idkey}\"></form>\n    </div>\n  </div>\n</dialog>\n","export default \"% Author     : Christophe Poulain\\n% licence    : Released under the LaTeX Project Public License v1.3c\\n% or later, see http://www.latex-project.org/lppl.txtf\\n\\\\NeedsTeXFormat{LaTeX2e}%\\n\\\\def\\\\filedate{2024/10/21}%\\n\\\\let\\\\PfMfiledate\\\\filedate%\\n\\\\def\\\\fileversion{0.99-i}%\\n\\\\let\\\\PfMfileversion\\\\fileversion%\\n\\n\\\\ProvidesPackage{ProfMaquette}[\\\\filedate\\\\space v\\\\fileversion\\\\space Maquettage de documents]%\\n\\n\\\\newif\\\\if@Dyslexie \\\\@Dyslexiefalse\\n\\\\newif\\\\if@CAN \\\\@CANfalse\\n\\\\newif\\\\if@Revision \\\\@Revisionfalse\\n\\\\newif\\\\if@AssembleCorrections \\\\@AssembleCorrectionsfalse\\n\\\\newif\\\\if@Personnel \\\\@Personnelfalse\\n\\n\\\\DeclareOption{Dyslexie}{\\\\@Dyslexietrue}\\n\\\\DeclareOption{CAN}{\\\\@CANtrue}\\n\\\\DeclareOption{Revision}{\\\\@Revisiontrue}\\n\\\\DeclareOption{AssembleCorrections}{\\\\@AssembleCorrectionstrue}\\n\\\\DeclareOption{Personnel}{\\\\@Personneltrue}\\n\\\\ProcessOptions\\\\relax\\n\\n\\\\if@AssembleCorrections\\n  \\\\AddToHook{env/document/end}[AC]{\\\\PfMAffichageTousCorriges}%\\n\\\\fi\\n\\n% packages ncessaires\\n\\\\RequirePackage{verbatim}%\\n\\\\RequirePackage{xintexpr}\\n\\\\RequirePackage{calc}%\\n\\n\\\\RequirePackage{xlop}%\\n\\n\\\\RequirePackage{varwidth}%\\n\\n\\\\RequirePackage{tcolorbox}%\\n\\\\tcbuselibrary{breakable,external,fitting,hooks,magazine,poster,raster,skins,theorems,listings,listingsutf8}%\\n\\n\\\\RequirePackage{xinttools}%\\n\\n\\\\RequirePackage{listofitems}%\\n\\\\RequirePackage{array}%\\n\\\\RequirePackage{datatool}%\\n\\n\\\\RequirePackage{modulus}%\\n\\n\\\\RequirePackage{ragged2e}%\\n\\\\RequirePackage{fontawesome5}\\n\\\\makeatletter\\n\\\\gdef\\\\PfMFontSize{\\\\@ptsize}\\n%\\\\gdef\\\\PfMFontSize{\\\\f@size}\\n\\\\makeatother\\n%dfinition des cls\\n\\\\RequirePackage{simplekv}%\\n\\\\setKVdefault[Boulot]{PixelArt=false,AMC=false,IntroductionAMC=false,Graine=1,Dys=false,Taille=14,Cours=false,Base=false,BaseHTML=false,CAN=false,Fiche=false,DM=false,DS=false,IE=false,Kholle=false,RecapBrevet=false,PdT=false,Parcours=false,Contrat=false,FdR=false,ParcoursPerso=false,OlympiadesAPMEP=false,LivreHeros=false,CorrigeInverse=false,CorrigeSeul=false,CorrigeApres=false,CorrigeFin=false,CorrigeAll=false,Brevet=false,BaremeComplet=false,BaremeGlobal=false,CorrectionColonnes=false,EntrainementColonnes=false,Epaisseur=0pt,EEpaisseur=0pt,ESansSaut=false,VersSolution=false,AvecEntrainement=false,Small=false,Footnotesize=false,Scriptsize=false,AllDirect=false,AllPouce=false,Input=false}%\\n\\\\defKV[Boulot]{Colonnes=\\\\setKV[Boulot]{CorrectionColonnes}}%\\n\\\\defKV[Boulot]{EColonnes=\\\\setKV[Boulot]{EntrainementColonnes}}%\\n\\\\setKVdefault[PixelArt]{Aleatoire=false,Landscape=false,CoupureTableau=false,Fichier={},Lettres={},Largeur={},Hauteur={},ListeCouleurs={},Solution=false,Theme=Essai,Arcenciel=false,LargeurTab=40pt}%\\n\\\\defKV[PixelArt]{CoupeTableau=\\\\setKV[PixelArt]{CoupureTableau}}%\\n%\\\\defKV[PixelArt]{ListeNombres=\\\\setKV[PixelArt]{Aleatoire}\\\\setsepchar{,}\\\\ignoreemptyitems\\\\readlist*\\\\ListePourLesItems{#1}\\\\reademptyitems}\\n\\\\setKVdefault[AMC]{Date=\\\\today,Classe={},Niveau={},Code=\\\\jobname,NomExercice=Exercice,Theme=Numration,Calculatrice=false}%\\n\\\\setKVdefault[Cours]{Couleur=Crimson,Theme=Trace \\\\'ecrite,NomExercice=Exercice}%\\n\\\\setKVdefault[DM]{Numero=1,Date=\\\\today,Classe={},Niveau=3,Code=\\\\jobname}%\\n\\\\setKVdefault[DS]{Numero=1,Date=\\\\today,Classe={},Niveau=3,Code=\\\\jobname,Calculatrice=false,Sujet=A}%\\n\\\\setKVdefault[Beamer]{Theme=Les nombres d\\\\'ecimaux,SousTheme={},Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice,}%\\n\\\\setKVdefault[Fiche]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[PdT]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[FdR]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[Parcours]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice,Vertical=false,Plan=false,Court=false}%\\n\\\\setKVdefault[Contrat]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[OlympiadesAPMEP]{Theme=Les nombres d\\\\'ecimaux,Bandeau=false}%\\n\\\\setKVdefault[ParcoursPerso]{Fichier={}}%\\n\\\\setKVdefault[IE]{Nom=\\\\'Evaluation,Sujets=false,Theme={},Numero=1,Date=\\\\today,Classe={},Niveau=3,Code=\\\\jobname,Calculatrice=false}%\\n\\\\defKV[IE]{Sujet=\\\\setKV[IE]{Sujets}}%\\n\\\\setKVdefault[RecapBrevet]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[Kholle]{Sujet=1,Numero=1,Date=15,Niveau=TSI-1,Code=\\\\jobname,Lieu=Lyc\\\\'ee\\n  du Hainaut (Valenciennes),NomEleve=Albert Einstein,CR=false}%\\n\\\\setKVdefault[CAN]{Date=\\\\today,Niveau=6,Duree=9,CoefQ=0.4,CoefR=0.35,CoefJ=0.1}%\\n\\\\setKVdefault[ClesExercices]{Open,NbQuestions=1,PasTitre=false,AffichageSource=false,BaremeTotal,BaremeDetaille=false,MotPoint=point,AffichageTitre=false,Calculatrice=true,Oral=false,Difficulte=0,AffichageCompetence=false,PasCorrige=false,Direct=false,Pouce=false,Parcours=false,Contrat=false,FdR=false,Routes=false,Stops=false,Background=white,Cadre=gray!50,Numerote,Ligne=false,Doublespacing=false,Onehalfspacing=false,Cadres=false,Grilles=false,Cinq=false,Huit=false,TitreSol=false,NonUtilise=false,Profile=false,AEntretenir=false,Fragile=false,AvecIndications=false,ACompleter=false,Aide=0,Score=0,EchelleSeyes=8,Ajout={},TitreCorrige=Corrig de l'exercice,Interieur=false,NombreEleves=0,Categorie=0}%\\n%\\\\defKV[ClesExercices]{AMCReponses=\\\\ifboolKV[Boulot]{AMC}{\\\\setKV[ClesExercices]{Open=false}}{}}%\\n\\\\defKV[ClesExercices]{TitreSolution=\\\\setKV[ClesExercices]{TitreSol}}%\\n\\\\defKV[ClesExercices]{Source=\\\\setKV[ClesExercices]{AffichageSource}}%\\n\\\\defKV[ClesExercices]{Titre=\\\\setKV[ClesExercices]{AffichageTitre}}%\\n\\\\defKV[ClesExercices]{Competence=\\\\setKV[ClesExercices]{AffichageCompetence}}%\\n\\\\defKV[ClesExercices]{Trajet=\\\\setKV[ClesExercices]{Parcours}}%\\n\\\\defKV[ClesExercices]{Confiance=\\\\setKV[ClesExercices]{Contrat}}%\\n\\\\defKV[ClesExercices]{Route=\\\\setKV[ClesExercices]{Routes}}%\\n\\\\defKV[ClesExercices]{Stop=\\\\setKV[ClesExercices]{Stops}}%\\n\\\\defKV[ClesExercices]{Lignes=\\\\setKV[ClesExercices]{Ligne}}%\\n\\\\defKV[ClesExercices]{Encart=\\\\setKV[ClesExercices]{Cadres}}%\\n\\\\defKV[ClesExercices]{CinqCinq=\\\\setKV[ClesExercices]{Grilles}\\\\setKV[ClesExercices]{Cinq}}%\\n\\\\defKV[ClesExercices]{Seyes=\\\\setKV[ClesExercices]{Grilles}\\\\setKV[ClesExercices]{Huit}}%\\n\\\\def\\\\PfMTexteEncart{Indique ton travail ci-dessous.}%\\n\\\\setKVdefault[SchemaParcours]{Colonnes=100,Rayon=2.5mm,Largeur=7.5mm,Couleur=gray!70}%,Csv=false}%\\n\\\\setKVdefault[SchemaContrat]{Ecart=7mm,Rayon=2.5mm}%\\n\\\\setKVdefault[SchemaFdR]{Ecart=7mm,Colonnes=100,Rayon=2.5mm,Largeur=7.5mm,Hauteur=1cm,Couleur=gray!70}%,Csv=false}%\\n% Commande pour retenir le nombre d'exercices par maquette.Utile seulement pour la cl AssembleCorrection\\n\\\\xdef\\\\PfMRetiensLienExoMa{}%\\n\\\\xdef\\\\PfMRetiensLienDefMa{}%\\n% Commande pour passer des options  travers la cl Input. Elle remplace \\\\input :)\\n\\\\NewDocumentCommand\\\\Input{om}{%\\n  \\\\def\\\\Relecture{\\\\setKV[ClesExercices]{#1}}%\\n  \\\\input{#2}%\\n  \\\\def\\\\Relecture{}%\\n}%\\n% Sucres\\n\\\\makeatletter%\\n\\\\NewDocumentCommand\\\\PfMDotfill{}{%\\n\\\\leavevmode%\\n\\\\cleaders\\\\hb@xt@.44em{\\\\hss\\\\xleaders\\\\hrule width0.33em\\\\hss}\\\\hfill%\\n\\\\kern\\\\z@}%\\n\\\\makeatother%\\n%\\n\\\\NewDocumentCommand\\\\PfMpointilles{o}{%\\n  \\\\IfNoValueTF{#1}{\\\\PfMDotfill}{\\\\makebox[#1]{\\\\PfMDotfill}}%\\n}%\\n%\\n\\\\NewDocumentCommand\\\\PfMNbLignesRestantes{}{%\\n  \\\\edef\\\\measurepage{\\\\dimexpr\\\\pagegoal-\\\\pagetotal\\\\relax}%\\n  \\\\edef\\\\measurepagemax{\\\\dimexpr\\\\textheight\\\\relax}%\\n % \\\\edef\\\\measurepage{\\\\dimeval{\\\\pagegoal-\\\\pagetotal-\\\\baselineskip}}%\\n  \\\\xdef\\\\PfMResteLignes{\\\\fpeval{trunc((\\\\the\\\\measurepage)/(\\\\baselineskip),0)}}%\\n  \\\\xdef\\\\PfMResteLignesMax{\\\\fpeval{trunc((\\\\the\\\\measurepagemax)/(\\\\baselineskip),0)}}%\\n  \\\\ifnum\\\\PfMResteLignesMax<\\\\PfMResteLignes\\\\relax\\n    \\\\xdef\\\\PfMResteLignes{\\\\PfMResteLignesMax}\\n  \\\\fi\\n  %\\\\xdef\\\\PfMResteLignes{\\\\dimeval{trunc((\\\\the\\\\measurepage)/(\\\\baselineskip),0)}}%\\n  %Il reste \\\\PfMResteLignes{} lignes alors que le nombre maximal de lignes sur une page est \\\\PfMResteLignesMax{}.\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMLignesFinales{}{%\\n  \\\\PfMNbLignesRestantes%\\n  \\\\xintFor* ##1 in {\\\\xintSeq {1}{\\\\PfMResteLignes}}\\\\do{%\\n    \\\\PfMpointilles\\\\par%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMLignespointilles{sm}{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\par\\\\PfMLignesFinales%\\n  }{%\\n    \\\\xintifboolexpr{\\\\fpeval{#2}>1}{%\\n      \\\\xintFor* ##1 in {\\\\xintSeq {1}{#2}}\\\\do{%\\n        \\\\PfMpointilles\\\\par%\\n      }%\\n    }{}%\\n  }%\\n}%\\n% Definition de longueurs\\n\\\\newlength\\\\PfMLargeurTableauPixelArt%\\n\\\\newlength\\\\PfMLargeurSchemaParcours%\\n\\\\newlength\\\\PfMRayonSchemaParcours%\\n\\\\newlength\\\\PfMLargeurSchemaContrat%\\n\\\\newlength\\\\PfMRayonSchemaContrat%\\n\\\\newlength\\\\PfMLargeurSchemaFdR%\\n\\\\newlength\\\\PfMRayonSchemaFdR%\\n\\\\newlength\\\\PfMHauteurSchemaFdR%\\n\\\\newlength\\\\PfMHauteurAppreciation%\\n\\\\newlength\\\\PfMHauteurRemarque%\\n\\\\newlength\\\\PfMLargeurQuestion%\\n\\\\newlength\\\\PfMLargeurReponse%\\n\\\\newlength\\\\PfMLargeurJury%\\n\\\\newlength\\\\PfMEspaceAvantLignes%\\n\\\\newlength\\\\PfMEspaceApresLignes%\\n\\\\newlength\\\\PfMLargeurComp%\\n\\\\newlength\\\\CRRHauteur%\\n\\\\newlength\\\\PfMEcartSupInterMots%\\n\\\\newlength\\\\PfMCoefcompetences%\\n\\\\def\\\\PfMCoefCompetences{0.85}%\\n\\\\setlength{\\\\CRRHauteur}{10cm}%\\n\\\\setlength{\\\\PfMHauteurAppreciation}{5cm}%\\n\\\\setlength{\\\\PfMHauteurRemarque}{5cm}%\\n\\\\setlength{\\\\PfMEspaceAvantLignes}{1em}%\\n\\\\setlength{\\\\PfMEspaceApresLignes}{1em}%\\n\\\\setlength{\\\\PfMEcartSupInterMots}{1pt}%\\n\\\\setlength{\\\\PfMCoefcompetences}{0.7\\\\linewidth}%\\n% dfinition des compteurs\\n\\\\newcounter{PfMMaquette}%Pour compter le nombres de \\\"travaux\\\"\\n\\\\setcounter{PfMMaquette}{0}%\\n\\\\newcounter{PfMMaquetteSol}[PfMMaquette]%Pour compter le nombres de \\\"travaux\\\" dans les corrections\\n\\\\setcounter{PfMMaquetteSol}{0}%\\n\\\\newcounter{PfMSection}%Pour le barme et ne pas faire obstruction  section\\n\\\\setcounter{PfMSection}{0}%\\n\\\\newcounter{PfMExo}[PfMMaquette]%Numro des exercices\\n\\\\setcounter{PfMExo}{0}%\\n%\\\\newcounter{PfMExoSolAlea}%Pour reprer les valeurs alatoires construites automatiquement dans la solution\\n%\\\\setcounter{PfMExoSolAlea}{0}%\\n\\\\newcounter{PfMExoSol}[PfMMaquette]%\\n\\\\setcounter{PfMExoSol}{0}%\\n\\\\newcounter{PfMExoEntrai}%Pour reprer les entrainements\\n\\\\setcounter{PfMExoEntrai}{0}%\\n\\\\newcounter{PfMCorrigeParcoursPerso}%affichage des solutions ou pas dans le cadre d'un parcours perso\\n\\\\setcounter{PfMCorrigeParcoursPerso}{0}%\\n\\\\newcounter{PfMRetiensMapourPP}%Pour retenir le numro de la maquette de rfrence pour les parcours perso\\n\\\\setcounter{PfMRetiensMapourPP}{0}%\\n\\\\newcounter{PfMSOS}%Numro des SOS dans les parcours flchs\\n\\\\setcounter{PfMSOS}{0}%\\n\\\\newcounter{PfMAlea}%Pour reprer les valeurs alatoires construites automatiquement\\n\\\\setcounter{PfMAlea}{0}%\\n%\\n\\\\newcounter{PfMNbListeReponsesAMC}%%Pour diffrencier les questions lors d'un exercice  plusieurs questions.\\n\\\\newcounter{PfMAMCOpen}%%Pour diffrencier les questions lors d'un exercice  plusieurs questions.\\n\\\\newcounter{RetiensSol}%Pour l'affichage des solutions\\n\\\\newcounter{RetiensRep}%Pour l'affichage des reponses.\\n\\\\newcounter{RetiensInd}%Pour l'affichage des indices.\\n\\\\newcounter{RetiensIndic}%Pour l'affichage des indications.\\n\\\\newcounter{PfMRetiensQr}%Pour l'affichage des entrainements\\n\\\\setcounter{RetiensSol}{0}%\\n\\\\setcounter{RetiensRep}{0}%\\n\\\\setcounter{RetiensInd}{0}%\\n\\\\setcounter{RetiensIndic}{0}%\\n\\\\setcounter{PfMRetiensQr}{0}%\\n\\\\newcounter{PfMNbLogo}%Pour dcaler les logos sur la ligne haute de tcolorbox\\n\\\\setcounter{PfMNbLogo}{0}%\\n\\\\newcount\\\\Orientation%Pour le schma des parcours\\n\\\\newcount\\\\TotalParcoursTikz%Pour le total des exos  utiliser dans l'affichage des parcours tikz\\n\\\\newcounter{PfMCNNumQ}%\\n\\n\\\\newcounter{Nbcolonnes}\\n\\n\\\\newbox\\\\PfMSauvegardeBox%\\n\\n\\\\newif\\\\ifPfMDeuxColonnes\\n\\\\newif\\\\ifPfMRectoVerso\\n\\\\newif\\\\ifPfMRevision\\n\\n\\\\makeatletter\\n\\\\if@twocolumn\\n  \\\\PfMDeuxColonnestrue\\n  \\\\setcounter{Nbcolonnes}{2}\\n\\\\else\\n  \\\\PfMDeuxColonnesfalse\\n  \\\\setcounter{Nbcolonnes}{4}\\n\\\\fi\\n\\\\if@twoside\\n  \\\\PfMRectoVersotrue\\n\\\\else\\n  \\\\PfMRectoVersofalse\\n\\\\fi\\n\\\\if@Revision\\n  \\\\PfMRevisiontrue\\n\\\\else\\n  \\\\PfMRevisionfalse\\n\\\\fi\\n\\\\makeatother\\n\\n% couleurs\\n\\\\colorlet{PfMColCpt}{gray!50}%\\n\\\\colorlet{PfMColSrc}{gray!50}%\\n\\\\colorlet{PfMCadreEncart}{gray!50}\\n\\\\colorlet{PfMCadreDM}{gray!85}%\\n\\\\colorlet{PfMCadreParcours}{gray!50}%\\n\\\\colorlet{PfMCadreContrat}{gray!50}%\\n\\\\colorlet{PfMColbackFdR}{white}%\\n\\\\colorlet{PfMCadreFdR}{gray!50}%\\n\\\\colorlet{PfMFondEncart}{white}%\\n% Dfinitions de commandes\\n\\\\newcommand\\\\PfMIENom{\\\\dotfill}%\\n\\\\newcommand\\\\PfMIEPrenom{\\\\dotfill}%\\n\\\\newcommand\\\\PfMIEClasse{\\\\dotfill}%\\n\\\\newcommand\\\\PfMCompNA{NA}%\\n\\\\newcommand\\\\PfMCompECA{ECA}%\\n\\\\newcommand\\\\PfMCompA{A}%\\n\\n\\\\NewDocumentCommand\\\\TournerPage{O{\\\\faShare}}{%\\n  \\\\par\\\\vfill\\\\par\\\\hfill{\\\\em Tourner la page #1}\\\\clearpage\\n}%\\n\\n\\\\tcbset{%\\n  consignes/.style={\\n    empty,\\n    right=0pt,\\n    left=0mm,\\n    top=0pt,\\n    bottom=0pt,\\n    frame engine=path,\\n    colframe=Crimson!10,\\n    notitle,\\n    sharp corners=west,\\n    borderline west={3pt}{0pt}{Crimson!50}\\n  }\\n}\\n\\n\\\\NewDocumentEnvironment{Consignes}{b}{%\\n  \\\\ifboolKV[Boulot]{CAN}{}{%\\n  \\\\begin{tcolorbox}[consignes]%\\n    \\\\small\\\\sffamily\\n    #1\\n  }%\\n}{%\\n\\\\ifboolKV[Boulot]{CAN}{}{\\\\end{tcolorbox}}%\\n}%\\n\\n\\\\tcbset{%\\n  indications/.style={\\n    empty,\\n    right=0pt,\\n    left=0mm,\\n    top=0pt,\\n    bottom=0pt,\\n    frame engine=path,\\n    % colframe=Crimson!10,\\n    frame hidden,\\n    notitle,\\n    sharp corners=west,\\n    borderline west={3pt}{0pt}{black!50}\\n  }\\n}\\n\\n%% Option french pour les mathmatiques\\n% By CT\\n\\\\NewDocumentCommand\\\\TypoMathFrance{}{%\\n  \\\\unless\\\\ifdefined\\\\countletters\\\\newcount\\\\countletters\\\\fi\\n  \\\\countletters=`A\\n  \\\\loop\\n  \\\\unless\\\\ifnum\\\\countletters>`Z\\n    \\\\begingroup\\\\lccode`!=\\\\countletters\\n    \\\\lowercase{\\\\endgroup\\\\DeclareMathSymbol{!}{\\\\mathalpha}{operators}{`!}}%\\n    \\\\advance\\\\countletters 1\\n    \\\\repeat\\n}%\\n\\n% On bloque la graine de fabrication des nombres alatoires.\\n\\\\ExplSyntaxOn\\n\\\\cs_new_eq:NN \\\\PfMGraineAlea \\\\sys_gset_rand_seed:n\\n\\\\ExplSyntaxOff\\n\\n\\\\ExplSyntaxOn\\n\\\\cs_new_eq:NN \\\\PfMChoisisGraineAlea \\\\int_rand:n\\n\\\\ExplSyntaxOff\\n\\n%% Gestion de l'affichage ou pas des item (Pour lves PAP) par exemple\\n% Code by egreg : https://tex.stackexchange.com/questions/627250/hide-specific-item-in-a-list\\n\\\\ExplSyntaxOn\\n\\n\\\\NewDocumentCommand{\\\\cacheitem}{}\\n {\\n  \\\\PfMitem_hide:\\n }\\n\\n\\\\NewDocumentCommand{\\\\PfMhideitems}{}\\n {\\n  \\\\bool_set_true:N \\\\l_PfMitem_hide_bool\\n }\\n\\\\NewDocumentCommand{\\\\PfMshowitems}{}\\n {\\n  \\\\bool_set_false:N \\\\l_PfMitem_hide_bool\\n }\\n\\n\\\\bool_new:N \\\\l_PfMitem_hide_bool\\n\\n\\\\cs_new_protected:Nn \\\\PfMitem_hide:\\n {\\n  \\\\bool_if:NT \\\\l_PfMitem_hide_bool\\n   {\\n    \\\\peek_regex_replace_once:nn\\n     % search \\\\item followed by anything until finding\\n     % \\\\item or \\\\hideit or \\\\end{<current environment>}\\n     { \\\\c{item}.*?(\\\\c{item}|\\\\c{cacheitem}|\\\\c{end}\\\\{\\\\u{@currenvir}\\\\}) }\\n     % replace by the matching item\\n     { \\\\1 }\\n   }\\n }\\n\\n\\\\ExplSyntaxOff\\n\\n\\\\definecolor{SLCP}{HTML}{00B51A}%\\n\\\\colorlet{Evidence}{SLCP}%\\n\\n\\\\NewDocumentCommand\\\\RepartirEffectifTotal{mmm}{%\\n  % #1 valeur de l'effectif total\\n  % #2 nombre de valeurs  obtenir\\n  % #3 cart acceptable :) autour de la moyenne\\n  \\\\xdef\\\\PfCSLEffectifs{}%\\n  \\\\xdef\\\\PfCValeurMoyenneTemp{\\\\fpeval{floor(#1/#2)}}%\\n  \\\\xdef\\\\PfCRetiensRETSomme{}%\\n  \\\\xdef\\\\PfCRetiensRETSommeTotale{0}%\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\fpeval{#2-1}}}\\\\do{%\\n    \\\\xdef\\\\PfCSLDelta{\\\\fpeval{randint(0,#3)}}%\\n    \\\\ifodd##1\\\\relax%\\n      \\\\xdef\\\\PfCSLEffectifs{\\\\PfCSLEffectifs \\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCSLDelta},}%\\n      \\\\xdef\\\\PfCRetiensRETSomme{\\\\PfCRetiensRETSomme-\\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCSLDelta}}%\\n      \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCSLDelta}}%\\n    \\\\else%\\n      \\\\xdef\\\\PfCSLEffectifs{\\\\PfCSLEffectifs \\\\fpeval{\\\\PfCValeurMoyenneTemp-\\\\PfCSLDelta},}%\\n      \\\\xdef\\\\PfCRetiensRETSomme{\\\\PfCRetiensRETSomme-\\\\fpeval{\\\\PfCValeurMoyenneTemp-\\\\PfCSLDelta}}%\\n      \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\fpeval{\\\\PfCValeurMoyenneTemp-\\\\PfCSLDelta}}%\\n    \\\\fi%\\n  }%\\n  % On rectifie sur la dernire valeur :)\\n  \\\\xdef\\\\PfCSLEffectifs{\\\\PfCSLEffectifs \\\\fpeval{#1+\\\\PfCRetiensRETSomme}}%\\n  \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\fpeval{#1+\\\\PfCRetiensRETSomme}}%\\n%  On voulait un effectif fixe  #1 en #2 valeurs avec un cart de #3 par rapport  la moyenne.\\\\\\\\\\n  %Les choix : \\\\PfCSLEffectifs.\\\\\\\\\\n  % Somme totale : \\\\fpeval{\\\\PfCRetiensRETSommeTotale}\\\\\\\\\\n}\\n\\n\\\\NewDocumentCommand\\\\RepartirEffectifTotalB{mmm}{%\\n  % #1 valeur de l'effectif total\\n  % #2 nombre de valeurs  obtenir\\n  % #3 le scale de la valeur de base pour calculer le delta\\n  \\\\xdef\\\\PfCCPEffectifs{}%\\n  \\\\xdef\\\\PfCValeurMoyenneTemp{\\\\fpeval{floor(#1/#2)}}%\\n  \\\\xdef\\\\PfCRetiensRETSomme{#1}%\\n  \\\\xdef\\\\PfCRetiensRETSommeTotale{0}%\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\fpeval{#2-1}}}\\\\do{%\\n    %La valeur moyenne ##1 est \\\\PfCValeurMoyenneTemp\\\\\\\\\\n    %On cherche entre \\\\fpeval{-\\\\PfCValeurMoyenneTemp+1} et \\\\fpeval{\\\\PfCValeurMoyenneTemp-1}\\\\\\\\\\n    \\\\xdef\\\\PfCCPDelta{\\\\fpeval{randint(-floor(#3*\\\\PfCValeurMoyenneTemp)+1,floor(#3*\\\\PfCValeurMoyenneTemp)-1)}}%\\n    %Le delta ##1 est \\\\PfCCPDelta\\\\\\\\\\n    \\\\xdef\\\\PfCCPValeurRetenue{\\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCCPDelta}}%\\n    %La valeur retenue ##1 est \\\\PfCCPValeurRetenue\\\\\\\\\\n    \\\\xdef\\\\PfCCPEffectifs{\\\\PfCCPEffectifs \\\\PfCCPValeurRetenue,}%\\n    \\\\xdef\\\\PfCRetiensRETSomme{\\\\fpeval{\\\\PfCRetiensRETSomme-\\\\PfCCPValeurRetenue}}%\\n    \\\\xdef\\\\PfCValeurMoyenneTemp{\\\\fpeval{floor(\\\\PfCRetiensRETSomme/(#2-##1))}}%\\n    \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\PfCCPValeurRetenue}%\\n    %La somme totale ##1 est \\\\fpeval{\\\\PfCRetiensRETSommeTotale}\\\\\\\\\\n  }%\\n%  % On rectifie sur la dernire valeur :)\\n  \\\\xdef\\\\PfCCPEffectifs{\\\\PfCCPEffectifs \\\\fpeval{#1-\\\\fpeval{\\\\PfCRetiensRETSommeTotale}}}%\\n  %Les choix : \\\\PfCCPEffectifs.\\\\\\\\\\n  %% Somme totale : \\\\fpeval{\\\\PfCRetiensRETSommeTotale}\\\\\\\\\\n}\\n\\n% Pour la gestion de l'alatoire\\n% afin de permettre d'utiliser le mme exercice.\\n% Extraire des sommets\\n\\\\newcounter{PfMSommetcount}%\\n\\\\newcommand\\\\ChoixSommet[2]{%\\n  % #1 le nombre de sommets\\n  % #2 le nom de base des commandes qui sauvegarde les noms\\n  % aprs chgt\\n  \\\\stepcounter{PfMAlea}%\\n  % fin chgt\\n  \\\\xdef\\\\CANSGFoo{A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z}%\\n  \\\\MelangeListe{\\\\CANSGFoo}{#1}%\\n  \\\\ignoreemptyitems%\\n  \\\\readlist*\\\\PfMSommet{\\\\faa}%\\n  \\\\reademptyitems%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\setcounter{PfMSommetcount}{##1}%\\n    \\\\expandafter\\\\xdef\\\\csname p\\\\Alph{PfMSommetcount}\\\\endcsname{\\\\PfMSommet[##1]}%\\n    % avant chgt\\n    % \\\\expandafter\\\\xdef\\\\csname #2\\\\Roman{PfMExo}\\\\alph{PfMSommetcount}\\\\endcsname{\\\\PfMSommet[##1]}%\\n    % aprs chgt\\n    \\\\expandafter\\\\xdef\\\\csname #2\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\alph{PfMSommetcount}\\\\endcsname{\\\\PfMSommet[##1]}%\\n  }%\\n}%\\n%%%\\n\\n\\\\NewDocumentCommand\\\\RestoreSommet{mm}{%\\n  % #1 le nombre de sommets\\n  % #2 le nom de base utilis lors de la cration des sommets\\n  \\\\stepcounter{PfMAlea}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\setcounter{PfMSommetcount}{##1}%\\n    \\\\expandafter\\\\xdef\\\\csname p\\\\Alph{PfMSommetcount}\\\\endcsname{\\\\csname #2\\\\Roman{PfMExoSol}\\\\roman{PfMAlea}\\\\alph{PfMSommetcount}\\\\endcsname}%\\n  }%\\n}%\\n\\n\\\\ifdef{\\\\VariableAlea}{%\\n  \\\\RenewDocumentCommand\\\\VariableAlea{s m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{#3}}%\\n      \\\\expandafter\\\\xdef\\\\csname #2\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n    }{%\\n      \\\\xdef#2{\\\\fpeval{#3}}%\\n    }%\\n  }%\\n}{%\\n  \\\\NewDocumentCommand\\\\VariableAlea{s m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{#3}}%\\n      \\\\expandafter\\\\xdef\\\\csname #2\\\\endcsname{\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n    }{%\\n      \\\\xdef#2{\\\\fpeval{#3}}%\\n    }%\\n  }%\\n}%\\n\\n\\\\ifdef{\\\\ChoixAlea}{%\\n  \\\\RenewDocumentCommand\\\\ChoixAlea{s o m m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{randint(#3,#4)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }%\\n    }{%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\xdef#5{\\\\fpeval{randint(#3,#4)}}%\\n      }{%\\n        \\\\xdef#5{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n      }%\\n    }%\\n  }%\\n}{%\\n  \\\\NewDocumentCommand\\\\ChoixAlea{s o m m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{randint(#3,#4)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }%\\n    }{%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\xdef#5{\\\\fpeval{randint(#3,#4)}}%\\n      }{%\\n        \\\\xdef#5{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n      }%\\n    }%\\n  }%\\n}% \\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMultiMix{mmmmm}{%\\n  % #1 nombre de valeurs  choisir\\n  % #2 valeur minimale\\n  % #3 valeur maximale\\n  % #4 valeur(s) exclue(s)\\n  % #5 Nom de la liste qui rcupre les donnes.\\n  \\\\ifx\\\\bla#4\\\\bla%\\n    \\\\PackageWarning{ProfMaquette}{Il faut dfinir au moins une valeur  exclure.}%\\n  \\\\else%\\n    \\\\xdef\\\\PfMMixFoo{#2}%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\xdef\\\\PfMMixFooEx{#4}%\\n    \\\\readlist*\\\\ListeValeursExclues{\\\\PfMMixFooEx}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{\\\\fpeval{#2+1}}{#3}}\\\\do{%\\n      \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,##1}%\\n    }%\\n    \\\\readlist*\\\\ListeValeursRetenues{\\\\PfMMixFoo}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xdef\\\\PfMMixFoo{}%\\n      \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\ListeValeursRetenueslen}}\\\\do{%\\n        \\\\xintifboolexpr{\\\\ListeValeursRetenues[##2]==\\\\ListeValeursExclues[##1]}{}{%\\n          \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,\\\\ListeValeursRetenues[##2]}%\\n        }%\\n      }%\\n      \\\\ignoreemptyitems%\\n      \\\\readlist*\\\\ListeValeursRetenues{\\\\PfMMixFoo}%\\n    }%\\n    \\\\ifnum\\\\ListeValeursRetenueslen=1\\\\relax%\\n      \\\\xdef#5{\\\\PfMMixFoo}%\\n    \\\\else%\\n      \\\\MelangeListe{\\\\PfMMixFoo}{#1}%\\n      \\\\xdef#5{\\\\faa}%\\n    \\\\fi%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMultiMixListe{mmmm}{%\\n  % #1 nombre de valeurs  choisir\\n  % #2 Liste  parcourir\\n  % #3 valeur(s) exclue(s)\\n  % #4 Nom de la liste qui rcupre les donnes.\\n  \\\\ifx\\\\bla#3\\\\bla%\\n    \\\\PackageWarning{ProfMaquette}{Il faut dfinir au moins une valeur  exclure.}%\\n  \\\\else%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeValeursExclues{#3}%\\n    \\\\readlist*\\\\ListeValeursRetenues{#2}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xdef\\\\PfMMixFoo{}%\\n      \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\ListeValeursRetenueslen}}\\\\do{%\\n        \\\\xintifboolexpr{\\\\ListeValeursRetenues[##2]==\\\\ListeValeursExclues[##1]}{}{%\\n          \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,\\\\ListeValeursRetenues[##2]}%\\n        }%\\n      }%\\n      \\\\setsepchar{,}\\\\ignoreemptyitems%\\n      \\\\readlist*\\\\ListeValeursRetenues{\\\\PfMMixFoo}%\\n    }%\\n    \\\\ifnum\\\\ListeValeursRetenueslen>1\\\\relax%\\n      \\\\MelangeListe{\\\\PfMMixFoo}{#1}%\\n      \\\\xdef#4{\\\\faa}%\\n    \\\\else%\\n      \\\\xdef#4{\\\\PfMMixFoo}%\\n    \\\\fi%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaListe{ommmm}{%\\n  % Il n'y a pas de rptitions des lments.\\n  % #1 prcision des dcimaux\\n  % #2 nombre d'lments\\n  % #3 valeur entire minimale\\n  % #4 valeur entire maximale\\n  % #5 nom de la liste rcuprant les nombres choisis.\\n  % 1ere valeur\\n  \\\\IfNoValueTF{#1}{\\\\xdef\\\\ListeNombresAlea{\\\\fpeval{randint(#3,#4)}}}{\\\\xdef\\\\ListeNombresAlea{\\\\fpeval{round(randint(#3,#4-1)+rand(),#1)}}}%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n  \\\\whiledo{\\\\ListeARenvoyerlen<#2}{%\\n    \\\\IfNoValueTF{#1}{\\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{randint(#3,#4)}}}{\\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{round(randint(#3,#4-1)+rand(),#1)}}}%\\n    \\\\def\\\\Unique{0}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeARenvoyerlen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeARenvoyer[##1]}}{%\\n        \\\\def\\\\Unique{1}%\\n        \\\\xintBreakFor%\\n      }{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xdef\\\\ListeNombresAlea{\\\\ListeNombresAlea,\\\\SuivantNombreAlea}%\\n      \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n    \\\\fi%\\n  }%\\n  \\\\xdef#5{\\\\ListeNombresAlea}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaListeold{mmmm}{%\\n  % Il n'y a pas de rptitions des lments.\\n  % #1 nombre d'lments\\n  % #2 valeur entire minimale\\n  % #3 valeur entire maximale\\n  % #4 nom de la liste rcuprant les nombres choisis.\\n  % 1ere valeur\\n  \\\\xdef\\\\ListeNombresAlea{\\\\fpeval{randint(#2,#3)}}\\n  \\\\setsepchar{,}\\\\ignoreemptyitems\\n  \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n  \\\\whiledo{\\\\ListeARenvoyerlen<#1}{%\\n    \\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{randint(#2,#3)}}%\\n    \\\\def\\\\Unique{0}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeARenvoyerlen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeARenvoyer[##1]}}{%\\n        \\\\def\\\\Unique{1}%\\n        \\\\xintBreakFor%\\n      }{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xdef\\\\ListeNombresAlea{\\\\ListeNombresAlea,\\\\SuivantNombreAlea}%\\n      \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n    \\\\fi%\\n  }%\\n  \\\\xdef#4{\\\\ListeNombresAlea}%\\n}\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaListeMix{mmmmm}{%\\n  % ide by reddit : I need a randomly ordered list...\\n  % Il n'y a pas de rptitions des lments.\\n  % #1 nombre d'lments\\n  % #2 valeur entire minimale\\n  % #3 valeur entire maximale\\n  % #4 Liste des valeurs  exclure  \\n  % #5 nom de la liste rcuprant les nombres choisis.\\n  \\\\xdef\\\\Toto{#4}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeValeursExclues{\\\\Toto}%\\n  % 1ere valeur\\n  \\\\xdef\\\\PfMNbCoups{0}%\\n  \\\\whiledo{\\\\fpeval{\\\\PfMNbCoups}<\\\\ListeValeursExclueslen}{%\\n    \\\\xdef\\\\ListeNombresAlea{\\\\fpeval{randint(#2,#3)}}%\\n    \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\ListeNombresAlea}==\\\\fpeval{\\\\ListeValeursExclues[##1]}}{%\\n        \\\\xdef\\\\PfMNbCoups{0}%\\n        \\\\xintBreakFor%\\n      }{\\\\xdef\\\\PfMNbCoups{\\\\fpeval{\\\\PfMNbCoups+1}}}%\\n    }%\\n  }%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n  \\\\whiledo{\\\\ListeARenvoyerlen<#1}{%\\n    \\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{randint(#2,#3)}}%\\n    \\\\def\\\\Unique{0}%\\n    \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeValeursExclues[##1]}}{%\\n        \\\\def\\\\Unique{1}%\\n        \\\\xintBreakFor%\\n      }{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeARenvoyerlen}}\\\\do{%\\n        \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeARenvoyer[##1]}}{%\\n          \\\\def\\\\Unique{1}%\\n          \\\\xintBreakFor%\\n        }{}%\\n      }%\\n    \\\\fi%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xdef\\\\ListeNombresAlea{\\\\ListeNombresAlea,\\\\SuivantNombreAlea}%\\n      \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n    \\\\fi%\\n  }%\\n  \\\\xdef#5{\\\\ListeNombresAlea}%\\n}\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMulti{mmmm}{%\\n  % #1 nombre de valeurs  choisir qui peut tre suprieur au nombre de valeurs entires disponibles\\n  % #2 valeur minimale\\n  % #3 valeur maximale\\n  % #4 Nom de la liste qui rcupre les donnes.\\n  \\\\xdef\\\\PfMMixFoo{\\\\fpeval{randint(#2,#3)}}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{#1-1}}}\\\\do{%\\n    \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,\\\\fpeval{randint(#2,#3)}}%\\n  }%\\n  \\\\xdef#4{\\\\PfMMixFoo}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMultiMixRep{mmmmm}{%\\n  % #1 nombre de valeurs  choisir\\n  % #2 valeur minimale\\n  % #3 valeur maximale\\n  % #4 valeur  exclure\\n  % #5 Nom de la liste qui rcupre les donnes.\\n  \\\\xdef\\\\PfCRetiensRetenues{}%\\n  \\\\xdef\\\\PfMMixFoo{#2,#3}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\xdef\\\\PfMMixFooExclues{#4}%\\n  \\\\readlist*\\\\ListeValeursExclues{\\\\PfMMixFooExclues}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{\\\\fpeval{#2+1}}{\\\\fpeval{#3-1}}}\\\\do{%\\n    \\\\xdef\\\\PfCRetiensExclues{0}%\\n    \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xintifboolexpr{##1==\\\\ListeValeursExclues[##2]}{\\\\xdef\\\\PfCRetiensExclues{\\\\fpeval{\\\\PfCRetiensExclues+1}}}{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\PfCRetiensExclues}=0\\\\relax%\\n      \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,##1}%\\n    \\\\fi%\\n  }%\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\MelangeListe{\\\\PfMMixFoo}{1}%\\n    \\\\xdef\\\\PfCRetiensRetenues{\\\\PfCRetiensRetenues\\\\faa}%\\n  }%\\n  \\\\xdef#5{\\\\PfCRetiensRetenues}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\MelangeNomFonction{mm}{%\\n  % #1 Nombre d'lments  conserver\\n  % #2 Nom de la commande qui conserve\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeInter{f,g,h,k,\\\\ell,m,p,q,r,s,u,v,w}%%\\n  \\\\xdef\\\\faa{}% Liste construite\\n  \\\\xdef\\\\fii{}% Liste dtruite\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\xintifboolexpr{#1==1}{%\\n      \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n      \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea]}%\\n    }{%\\n      \\\\xintifboolexpr{\\\\ListeInterlen>1}{%\\n        \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea],}%\\n        \\\\xdef\\\\fii{}%\\n        \\\\xintFor* ##2 in {\\\\xintSeq{1}{\\\\ListeInterlen}}\\\\do{%\\n          \\\\xintifboolexpr{##2 == \\\\Alea}{%\\n          }{%\\n            \\\\xdef\\\\fii{\\\\fii \\\\ListeInter[##2],}%\\n          }%\\n        }%\\n      }{%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[1]}%\\n      }%\\n      \\\\readlist*\\\\ListeInter{\\\\fii}%\\n    }%\\n  }%\\n  \\\\xdef#2{\\\\faa}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\MelangeNomVariable{mm}{%\\n  % #1 Nombre d'lments  conserver\\n  % #2 Nom de la commande qui conserve\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeInter{a,b,n,t,x,y,z}%\\n  \\\\xdef\\\\faa{}% Liste construite\\n  \\\\xdef\\\\fii{}% Liste dtruite\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\xintifboolexpr{#1==1}{%\\n      \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n      \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea]}%\\n    }{%\\n      \\\\xintifboolexpr{\\\\ListeInterlen>1}{%\\n        \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea],}%\\n        \\\\xdef\\\\fii{}%\\n        \\\\xintFor* ##2 in {\\\\xintSeq{1}{\\\\ListeInterlen}}\\\\do{%\\n          \\\\xintifboolexpr{##2 == \\\\Alea}{%\\n          }{%\\n            \\\\xdef\\\\fii{\\\\fii \\\\ListeInter[##2],}%\\n          }%\\n        }%\\n      }{%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[1]}%\\n      }%\\n      \\\\readlist*\\\\ListeInter{\\\\fii}%\\n    }%\\n  }%\\n  \\\\xdef#2{\\\\faa}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\AffSigne{smm}{%\\n  \\\\ifnum#2=0\\\\relax{}\\n  \\\\else\\n  \\\\ifnum#3=0\\\\relax{}\\n  \\\\else\\n  \\\\ifnum#3>0\\\\relax{}\\n  +\\n  \\\\fi\\n  \\\\fi\\n  \\\\fi\\n}%\\n\\n\\\\NewDocumentCommand\\\\AffPoly{O{x}m}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems\\n  \\\\readlist*\\\\ListeCoeff{#2}\\n  \\\\ensuremath{\\n    \\\\ifnum\\\\ListeCoeff[1]=0\\\\relax\\n    \\\\Affichage{\\\\ListeCoeff[2]}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}%\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[1]=1\\\\relax\\n    #1^3%\\n    \\\\else\\\\ifnum\\\\ListeCoeff[1]=-1\\\\relax\\n    -#1^3\\n    \\\\else\\\\num{\\\\ListeCoeff[1]}#1^3\\n    \\\\fi\\n    \\\\fi\\n    \\\\ifnum\\\\ListeCoeff[2]=0\\\\relax\\n    \\\\ifnum\\\\ListeCoeff[3]=0\\\\relax\\n    \\\\ifnum\\\\ListeCoeff[4]=0\\\\relax\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[4]>0\\n    +\\\\Affichage[Lettre=#1]{0}{0}{\\\\ListeCoeff[4]}\\n    \\\\else\\n    \\\\Affichage[Lettre=#1]{0}{0}{\\\\ListeCoeff[4]}\\n    \\\\fi\\n    \\\\fi\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[3]>0\\\\relax\\n    +\\\\Affichage[Lettre=#1]{0}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}\\n    \\\\else\\n    \\\\Affichage[Lettre=#1]{0}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}\\n    \\\\fi\\n    \\\\fi\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[2]>0\\\\relax\\n    +\\\\Affichage[Lettre=#1]{\\\\ListeCoeff[2]}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}%\\\\num{\\\\ListeCoeff[2]}x^2\\n    \\\\else\\n    \\\\Affichage[Lettre=#1]{\\\\ListeCoeff[2]}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}%\\\\num{\\\\ListeCoeff[2]}x^2\\n    \\\\fi\\n    \\\\fi\\n    \\\\fi\\n  }\\n}\\n\\n\\\\newcounter{PfCenumi}\\n\\n\\\\NewDocumentCommand\\\\RestoreChoixAlea{m}{%\\n  \\\\stepcounter{PfMAlea}%\\n  %Je restaure la valeur \\\\thePfMExoSol-\\\\thePfMAlea\\n  \\\\expandafter\\\\xdef\\\\csname #1\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExoSol}\\\\roman{PfMAlea}\\\\endcsname}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ExporteListe{mm}{%\\n  %#1 le nom de la liste\\n  %#2 le contenu de la liste.\\n  \\\\stepcounter{PfMAlea}%\\n  \\\\expandafter\\\\xdef\\\\csname Liste\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{#2}%\\n  \\\\expandafter\\\\xdef\\\\csname #1\\\\endcsname{\\\\csname Liste\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RestoreListe{m}{%\\n  %#1 le nom de la liste  restaurer\\n  \\\\stepcounter{PfMAlea}%\\n  \\\\expandafter\\\\xdef\\\\csname #1\\\\endcsname{\\\\csname Liste\\\\Roman{PfMMaquette}\\\\Roman{PfMExoSol}\\\\roman{PfMAlea}\\\\endcsname}%\\n}%\\n\\n%%\\n\\\\newcounter{Melquestions}%\\n\\\\newcounter{Comptequestions}%\\n%\\n\\\\NewDocumentEnvironment{Enumelange}{o+b}{%\\n  \\\\setcounter{Melquestions}{0}%\\n  \\\\setsepchar{\\\\item}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{#2}%\\n  \\\\reademptyitems\\n % La liste des lments retenus est \\\\showitems*\\\\ListeTest[]\\\\par\\n  \\\\IfNoValueTF{#1}{%\\n    \\\\ChoixAleaMultiMix{\\\\ListeTestlen}{1}{\\\\ListeTestlen}{0}{\\\\ListeShuffleA}%\\n    \\\\xdef\\\\MelangeValeurTotale{\\\\ListeTestlen}%\\n  }{%\\n    \\\\ChoixAleaMultiMix{#1}{1}{\\\\ListeTestlen}{0}{\\\\ListeShuffleA}%\\n    \\\\xdef\\\\MelangeValeurTotale{#1}%\\n  }%\\n  \\\\ExporteListe{ListeShuffle}{\\\\ListeShuffleA}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeNumQ{\\\\ListeShuffleA}%\\n  \\\\reademptyitems\\n % L'ordre des questions est \\\\ListeNumQ[]\\n  \\\\setcounter{Comptequestions}{1}%\\n  \\\\begin{enumerate}\\n    \\\\loop%\\n    \\\\setcounter{Melquestions}{\\\\ListeNumQ[\\\\theComptequestions]}%\\n  \\\\item \\\\ListeTest[\\\\theMelquestions]%\\n    \\\\stepcounter{Comptequestions}%\\n    \\\\ifnum\\\\theComptequestions<\\\\numexpr\\\\MelangeValeurTotale+1%\\n      \\\\repeat%\\n  \\\\end{enumerate}\\n}{}%\\n\\n\\\\NewDocumentEnvironment{Enumelangesol}{b}{%\\n  \\\\setcounter{Melquestions}{0}%\\n  \\\\setsepchar{\\\\item}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{#1}%\\n  \\\\reademptyitems\\n  \\\\RestoreListe{ListeShuffle}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeNumQ{\\\\ListeShuffle}%\\n  \\\\reademptyitems\\n%  la liste des lments retenus est \\\\showitems*\\\\ListeTest[]\\\\par\\n%  L'ordre des questions est \\\\ListeNumQ[]\\\\par\\n  \\\\setcounter{Comptequestions}{1}%\\n  \\\\begin{enumerate}\\n    \\\\loop%\\n    \\\\setcounter{Melquestions}{\\\\ListeNumQ[\\\\theComptequestions]}%\\n  \\\\item \\\\ListeTest[\\\\theMelquestions]%\\n    \\\\stepcounter{Comptequestions}%\\n    \\\\ifnum\\\\theComptequestions<\\\\numexpr\\\\ListeNumQlen+1%\\n      \\\\repeat%\\n  \\\\end{enumerate}\\n}{}%\\n\\n\\\\newcount\\\\PfManp%\\n\\\\newcount\\\\PfMbnp%\\n\\\\newcount\\\\PfMcnp%\\n\\\\newcount\\\\PfMdnp%\\n\\n\\\\NewDocumentCommand\\\\DeterminerNonPremiersEntreEuxInf{m}{%#1 : le nombre entier \\\\`a tester\\n  \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{}%\\n  \\\\xdef\\\\RetiensPremiersEntreEuxInf{}%\\n  \\\\PfManp=#1%\\n  \\\\PfMbnp=2%\\n  \\\\PfMcnp=0%\\n  \\\\PfMdnp=0%\\n  \\\\whiledo{\\\\PfMbnp<\\\\PfManp}{%\\n    \\\\PGCD{\\\\the\\\\PfManp}{\\\\the\\\\PfMbnp}{}%\\n    \\\\ifnum\\\\pgcd>1\\\\relax\\n      \\\\PfMcnp=\\\\numexpr\\\\PfMcnp+1\\\\relax\\n      \\\\ifnum\\\\PfMcnp=1\\\\relax\\n        \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{\\\\the\\\\PfMbnp}%\\n      \\\\else%\\n        \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{\\\\RetiensNonPremiersEntreEuxInf,\\\\the\\\\PfMbnp}%\\n      \\\\fi%\\n    \\\\else\\n      \\\\PfMdnp=\\\\numexpr\\\\PfMdnp+1\\\\relax\\n      \\\\ifnum\\\\PfMdnp=1\\\\relax\\n        \\\\xdef\\\\RetiensPremiersEntreEuxInf{\\\\the\\\\PfMbnp}%\\n      \\\\else%\\n        \\\\xdef\\\\RetiensPremiersEntreEuxInf{\\\\RetiensPremiersEntreEuxInf,\\\\the\\\\PfMbnp}%\\n      \\\\fi%\\n    \\\\fi%\\n    \\\\PfMbnp=\\\\numexpr\\\\PfMbnp+1%\\n  }%\\n  \\\\ifnum\\\\PfMcnp=0\\\\relax%\\n    \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{1}%\\n  \\\\fi%\\n  \\\\ifnum\\\\PfMdnp=0\\\\relax%\\n    \\\\xdef\\\\RetiensPremiersEntreEuxInf{1}%\\n  \\\\fi%\\n}%\\n\\n% Dfinitions pour les comptences\\n\\\\NewDocumentCommand\\\\Competences{O{3}m}{%\\n  \\\\setsepchar[*]{/}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeCompetence{#2}\\n  \\\\ifnum#1=3\\\\relax\\n  \\\\buildtabcompetences%\\n  \\\\else\\n  \\\\Buildtabcompetences{#1}{\\\\ListeCompetencelen}%\\n  \\\\fi\\n}\\n\\n\\\\def\\\\buildtabcompetences{%\\n  \\\\[\\\\begin{tabular}{|p{\\\\PfMCoefcompetences}|*{3}{>{\\\\centering\\\\arraybackslash}p{0.05\\\\linewidth}|}}\\n      \\\\cline{2-4}\\n      \\\\multicolumn{1}{c|}{}&\\\\PfMCompNA&\\\\PfMCompECA&\\\\PfMCompA\\\\\\\\\\n      \\\\hline\\n      \\\\xintFor* ##1 in {\\\\xintSeq {1}{\\\\ListeCompetencelen}}\\\\do{\\\\ListeCompetence[##1]&&&\\\\\\\\\\\\hline}\\n    \\\\end{tabular}\\n  \\\\]\\n}%\\n\\n\\\\def\\\\Buildtabcompetences#1#2{%\\n  \\\\setlength{\\\\PfMLargeurComp}{\\\\fpeval{\\\\PfMCoefCompetences-0.05*#1}\\\\linewidth-\\\\fpeval{2*(#1-3)}\\\\tabcolsep}%\\n  \\\\[\\\\begin{tabular}{|p{\\\\PfMLargeurComp}|*{#1}{>{\\\\centering\\\\arraybackslash}p{0.05\\\\linewidth}|}}%\\n      \\\\cline{2-\\\\fpeval{1+#1}}%\\n      \\\\multicolumn{1}{c|}{}\\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n      &\\\\ListeCompetence[##1]}\\\\\\\\%\\n      \\\\hline%\\n      \\\\xintFor* ##1 in {\\\\xintSeq {\\\\fpeval{#1+1}}{\\\\ListeCompetencelen}}\\\\do{\\\\ListeCompetence[##1]%\\n      \\\\xintFor* ##2 in {\\\\xintSeq{1}{#1}}\\\\do{&}%\\n      \\\\\\\\\\\\hline%\\n      }%\\n    \\\\end{tabular}%\\n  \\\\]%\\n}%\\n%\\n%\\n%%% Dfinitions des environnements pour la correction\\n\\\\makeatletter\\n\\\\newwrite\\\\verbatim@out\\n\\n\\\\def\\\\SolutionWrite{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.sol\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endSolutionWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\n\\\\def\\\\SolutionWritePP{%\\n  \\\\@bsphack\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\thePfMExo.sol\\\" %\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials\\n  \\\\catcode`\\\\^^M\\\\active\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}\\n\\\\def\\\\endSolutionWritePP{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}\\n\\n\\\\def\\\\ReponseWrite{%\\n  \\\\@bsphack\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.rep\\\" %\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials\\n  \\\\catcode`\\\\^^M\\\\active\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}\\n\\\\def\\\\endReponseWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}\\n\\n\\\\def\\\\IndiceWrite{%\\n  \\\\@bsphack\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.cdp\\\" %coup de pouce\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials\\n  \\\\catcode`\\\\^^M\\\\active\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}\\n\\\\def\\\\endIndiceWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}\\n\\\\makeatother\\n\\n\\\\def\\\\SolutionNow{\\\\textbf{\\\\csname PfMTNomSol\\\\Roman{PfMExo}\\\\endcsname~--}\\\\par\\\\nopagebreak\\\\setcounter{PfMExoSol}{\\\\thePfMExo}\\\\setcounter{PfMAlea}{0}\\\\PfMAffichageHideItemSolution}%\\\\setcounter{PfMExoSolAlea}{\\\\thePfMExo}\\n\\\\def\\\\endSolutionNow{\\\\par\\\\goodbreak\\\\PfMshowitems}\\n\\n\\\\def\\\\ReponseNow{\\\\textbf{Rponse(s) de l'exercice --}\\\\par\\\\nopagebreak\\\\PfMAffichageHideItemSolution}\\n\\\\def\\\\endReponseNow{\\\\par\\\\goodbreak\\\\PfMshowitems}\\n\\n\\\\def\\\\IndiceNow{\\\\textbf{Indice(s) --}\\\\par\\\\nopagebreak\\\\PfMAffichageHideItemSolution}\\n\\\\def\\\\endIndiceNow{\\\\par\\\\goodbreak\\\\PfMshowitems}\\n\\n\\\\NewDocumentEnvironment{Solution}{}{}{}%\\n\\\\NewDocumentEnvironment{Reponse}{}{}{}%\\n\\\\NewDocumentEnvironment{Indice}{}{}{}%\\n\\\\NewDocumentEnvironment{PfMHide}{+b}{}{}%\\n\\\\NewDocumentEnvironment{PfMSeek}{+b}{#1}{}%\\n\\n\\\\NewDocumentEnvironment{AideA}{+b}{%\\n  \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Aide}}>0\\\\relax%\\n    \\\\begin{PfMSeek}%\\n      #1\\n    \\\\end{PfMSeek}%\\n  \\\\else%\\n    \\\\begin{PfMHide}%\\n      #1\\n    \\\\end{PfMHide}\\n  \\\\fi%\\n}{%\\n}%\\n\\n\\\\NewDocumentEnvironment{AideB}{+b}{%\\n  \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Aide}}>1\\\\relax%\\n    \\\\begin{PfMSeek}%\\n      #1\\n    \\\\end{PfMSeek}\\n  \\\\else%\\n    \\\\begin{PfMHide}%\\n      #1\\n    \\\\end{PfMHide}\\n  \\\\fi%\\n}{%\\n}%\\n  \\n\\\\NewDocumentEnvironment{Indications}{+b}{%\\n  \\\\ifnum\\\\theRetiensIndic=1\\\\relax%\\n    \\\\textbf{\\\\PfMTexteDesIndications :}\\\\par%\\n      #1\\n  \\\\fi%\\n}{%\\n}%\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\PfMChoixAffichageCorrection{}{%\\n  \\\\if@AssembleCorrections\\n    \\\\let\\\\Solution\\\\SolutionWrite\\\\let\\\\endSolution\\\\endSolutionWrite\\n  \\\\fi\\n  \\\\ifboolKV[Boulot]{CorrigeAll}{%\\n    \\\\let\\\\Solution\\\\SolutionWrite\\\\let\\\\endSolution\\\\endSolutionWrite\\n    \\\\let\\\\Reponse\\\\ReponseWrite\\\\let\\\\endReponse\\\\endReponseWrite\\n    \\\\let\\\\Indice\\\\IndiceWrite\\\\let\\\\endIndice\\\\endIndiceWrite\\n  }{%\\n  \\\\ifboolKV[Boulot]{ParcoursPerso}{%\\n    \\\\let\\\\Solution\\\\SolutionWritePP\\\\let\\\\endSolution\\\\endSolutionWritePP\\n  }{%\\n    \\\\ifnum\\\\theRetiensSol=1\\\\relax\\n    \\\\let\\\\Reponse\\\\comment\\\\let\\\\endReponse\\\\endcomment\\n    \\\\let\\\\Indice\\\\comment\\\\let\\\\endIndice\\\\endcomment\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\let\\\\Solution\\\\SolutionWrite\\\\let\\\\endSolution\\\\endSolutionWrite\\n    }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n        \\\\let\\\\Solution\\\\SolutionNow\\\\let\\\\endSolution\\\\endSolutionNow\\n      }{}%\\n    }%\\n    \\\\else\\n    \\\\let\\\\Solution\\\\comment\\\\let\\\\endSolution\\\\endcomment\\n    \\\\let\\\\Indice\\\\comment\\\\let\\\\endIndice\\\\endcomment\\n    \\\\ifnum\\\\theRetiensRep=1\\\\relax\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\let\\\\Reponse\\\\ReponseWrite\\\\let\\\\endReponse\\\\endReponseWrite\\n    }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n        \\\\let\\\\Reponse\\\\ReponseNow\\\\let\\\\endReponse\\\\endReponseNow\\n      }{}%\\n    }%\\n    \\\\else\\n    \\\\let\\\\Solution\\\\comment\\\\let\\\\endSolution\\\\endcomment\\n    \\\\let\\\\Reponse\\\\comment\\\\let\\\\endReponse\\\\endcomment\\n    \\\\ifnum\\\\theRetiensInd=1\\\\relax\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\let\\\\Indice\\\\IndiceWrite\\\\let\\\\endIndice\\\\endIndiceWrite\\n    }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n        \\\\let\\\\Indice\\\\IndiceNow\\\\let\\\\endIndice\\\\endIndiceNow\\n      }{}%\\n    }%\\n    \\\\fi\\n    \\\\fi\\n    \\\\fi\\n  }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\PfMChoixCorrection{}{%\\n  \\\\setcounter{RetiensSol}{0}%\\n  \\\\setcounter{RetiensRep}{0}%\\n  \\\\setcounter{RetiensInd}{0}%\\n  \\\\if@AssembleCorrections\\n    \\\\setcounter{RetiensSol}{1}%\\n  \\\\else\\n  \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n%    \\\\ifboolKV[Boulot]{CorrigeAll}{%\\n%      \\\\setcounter{RetiensSol}{1}%\\n%      \\\\setcounter{RetiensRep}{1}%\\n%      \\\\setcounter{RetiensInd}{1}%\\n%    }{%\\n      \\\\setcounter{RetiensSol}{1}%\\n      \\\\setcounter{RetiensRep}{0}%\\n      \\\\setcounter{RetiensInd}{0}%\\n%    }%\\n  }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n      \\\\setcounter{RetiensSol}{1}%\\n      \\\\setcounter{RetiensRep}{0}%\\n      \\\\setcounter{RetiensInd}{0}%\\n    }{}%\\n  }%\\n  \\\\fi\\n  \\\\ifboolKV[ClesExercices]{PasCorrige}{%\\n    \\\\setcounter{RetiensSol}{0}%\\n    \\\\setcounter{RetiensRep}{0}%\\n    \\\\setcounter{RetiensInd}{0}%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{Direct}{%\\n      \\\\setcounter{RetiensSol}{0}%\\n      \\\\setcounter{RetiensRep}{1}%\\n      \\\\setcounter{RetiensInd}{0}%\\n    }{%\\n      \\\\ifboolKV[ClesExercices]{Pouce}{%\\n        \\\\setcounter{RetiensSol}{0}%\\n        \\\\setcounter{RetiensRep}{0}%\\n        \\\\setcounter{RetiensInd}{1}%\\n      }{}%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\PfMChoixEntrainement{}{%\\n  \\\\setcounter{PfMRetiensQr}{0}%\\n  \\\\ifboolKV[ClesExercices]{AEntretenir}{\\\\setcounter{PfMRetiensQr}{1}}{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixAffichageEntrainement{}{%\\n  \\\\ifnum\\\\thePfMRetiensQr=1\\\\relax%\\n    \\\\let\\\\Entrainement\\\\EntrainementWrite\\\\let\\\\endEntrainement\\\\endEntrainementWrite%\\n  \\\\else%\\n    \\\\let\\\\Entrainement\\\\comment\\\\let\\\\endEntrainement\\\\endcomment\\n  \\\\fi%\\n}%\\n\\n\\\\def\\\\PfMTexteDuCorrige{Corrig de l'exercice}%\\n\\\\def\\\\PfMTexteDeLEntrainement{Automatisme(s) li(s)  l'exercice}%\\n\\\\def\\\\PfMTexteDesIndications{Indications}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageCorrige{}{%\\n  \\\\ifboolKV[Boulot]{CAN}{%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n      \\\\setcounter{PfMExoSol}{##1}%\\n      \\\\setcounter{PfMAlea}{0}%\\n      \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}{\\\\textbf{Question\\\\ifnum\\\\PfMCANTotalExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{TestCAN-##1}}:\\\\fi}~\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}\\\\par\\\\goodbreak}{}%\\n    }%\\n  }{%\\n    \\\\setcounter{PfMExoSol}{0}%\\n    %\\\\setcounter{PfMExoSolAlea}{0}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n      \\\\refstepcounter{PfMExoSol}%\\n      %\\\\stepcounter{PfMExoSolAlea}%\\n      \\\\label{pagesol-\\\\thePfMMaquette-\\\\thePfMExoSol}%\\n      \\\\setcounter{PfMAlea}{0}%\\n      \\\\def\\\\PfMTexteDuCorrige{\\\\csname PfMTNomSol\\\\Roman{PfMExoSol}\\\\endcsname}%\\n      \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}{\\\\PfMAffichageHideItemSolution\\\\textbf{\\\\PfMTexteDuCorrige\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-\\\\thePfMMaquette-##1}}\\\\fi\\\\PfMAffichageTitreSolution}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}\\\\par\\\\goodbreak}{\\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}{\\\\PfMAffichageHideItemSolution\\\\textbf{Rponse(s) seule(s) de l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-\\\\thePfMMaquette-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}\\\\par\\\\goodbreak}{%\\n          \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}{\\\\PfMAffichageHideItemSolution\\\\textbf{Indice(s) pour l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-\\\\thePfMMaquette-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}\\\\par\\\\goodbreak}{}%\\n        }%\\n      }%\\n      \\\\PfMshowitems%\\n    }%\\n  }%\\n}%\\n\\n% Tous les corrigs\\n\\\\NewDocumentCommand\\\\PfMAffichageTousCorriges{}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeNombreExoMq{\\\\PfMRetiensLienExoMa}%\\n  \\\\reademptyitems%\\n  \\\\xdef\\\\Tototaltal{\\\\thePfMMaquette}%\\n  \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\Tototaltal}}\\\\do{%\\n    \\\\refstepcounter{PfMMaquetteSol}%\\n    \\\\setcounter{PfMMaquette}{##2}%\\n    \\\\setcounter{PfMExoSol}{0}%\\n    %\\\\setcounter{PfMExoSolAlea}{0}%\\n    \\\\ifPfMRectoVerso%\\n      \\\\cleardoublepage%\\n    \\\\else%\\n      \\\\clearpage%\\n    \\\\fi%\\n    \\\\input{\\\\jobname-DefiMq-\\\\thePfMMaquette}%\\n    \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeNombreExoMq[##2]}}\\\\do{%\\n      \\\\stepcounter{PfMExoSol}%\\n      %\\\\stepcounter{PfMExoSolAlea}%\\n      \\\\label{pagesol-\\\\thePfMMaquetteSol-\\\\thePfMExoSol}%\\n      \\\\setcounter{PfMAlea}{0}%\\n      \\\\IfFileExists{\\\\jobname-Ma##2-Ex##1.sol}{\\\\PfMAffichageHideItemSolution\\\\textbf{\\\\PfMTexteDuCorrige\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-##2-##1}}\\\\fi\\\\PfMAffichageTitreSolution}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma##2-Ex##1.sol}\\\\par\\\\goodbreak}{\\\\IfFileExists{\\\\jobname-Ma##2-Ex##1.rep}{\\\\PfMAffichageHideItemSolution\\\\textbf{Rponse(s) seule(s) de l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-##2-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma##2-Ex##1.rep}\\\\par\\\\goodbreak}{%\\n          \\\\IfFileExists{\\\\jobname-Ma##2-Ex##1.cdp}{\\\\PfMAffichageHideItemSolution\\\\textbf{Indice(s) pour l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-##2-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma##2-Ex##1.cdp}\\\\par\\\\goodbreak}{}%\\n        }%\\n      }%\\n      \\\\PfMshowitems%\\n    }%\\n    \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{Entrainement}{}{}{}%\\n\\n\\\\makeatletter\\n\\\\def\\\\EntrainementWrite{%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.qrc\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endEntrainementWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageEntrainement{}{%\\n  \\\\ifboolKV[Boulot]{ESansSaut}{\\\\vfill}{%\\n    \\\\ifPfMDeuxColonnes\\n      \\\\newpage\\n    \\\\else\\n      \\\\ifPfMRectoVerso\\n        \\\\cleardoublepage\\n      \\\\else\\n        \\\\clearpage\\n      \\\\fi\\n    \\\\fi\\n  }%\\n  \\\\TikzAutomatismes\\n  \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{EEpaisseur}}%\\n  \\\\ifboolKV[Boulot]{EntrainementColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{EColonnes}}}{}%\\n  \\\\setcounter{PfMExoEntrai}{0}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n    \\\\refstepcounter{PfMExoEntrai}%\\n    \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.qrc}{%\\n      \\\\begin{center}\\n        \\\\label{pageentrai-\\\\thePfMMaquette-\\\\thePfMExoEntrai}%\\n        \\\\textbf{\\\\PfMTexteDeLEntrainement\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ref{page-\\\\thePfMMaquette-##1}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.qrc}\\\\end{center}%\\n    }{}%\\n  }%\\n  \\\\ifboolKV[Boulot]{EntrainementColonnes}{\\\\end{multicols}}{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzAutomatismes{}{%\\n  \\\\begin{tcolorbox}\\n    \\\\begin{center}\\n      \\\\Large\\\\sffamily Automatismes%\\n    \\\\end{center}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n%%%%%%%% BAREME %%%%%%%%%%%\\n%% Bareme\\n\\\\newlength{\\\\brouillon}\\n\\n\\\\newcommand*\\\\FranPt[1]{%\\n%  \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n    \\\\color{gray!75}(\\\\num{#1})%\\n%  }{}\\n}\\n\\n\\\\makeatletter\\n\\\\newcommand\\\\BaremeEspace@Marge{18pt}\\n\\\\newcommand\\\\BaremeEspace@MargeCorrection{0pt}\\n%\\\\f@size est la taille par dfaut de la fonte.\\n\\n\\\\newcommand*\\\\brm[1]{%\\n  \\\\ifboolKV[Boulot]{Fiche}{}{%\\n    \\\\ifboolKV[Boulot]{FdR}{}{%\\n      \\\\ifboolKV[Boulot]{Contrat}{}{%\\n        \\\\ifboolKV[Boulot]{Parcours}{}{%\\n          \\\\immediate\\\\write\\\\@auxout{%\\n            \\\\string\\\\opadd*{#1}%\\n            {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n            {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n            \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n          }%\\n          \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n            \\\\setlength{\\\\brouillon}{\\\\BaremeEspace@Marge-\\\\linewidth+\\\\textwidth}%\\n            \\\\makebox[0pt][r]{\\\\footnotesize\\\\FranPt{#1}\\\\hspace*{\\\\brouillon}}%\\n            \\\\ignorespaces%\\n          }{}%\\n        }%\\n      }%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\BRM{som}{%\\n  \\\\ifboolKV[Boulot]{Fiche}{}{%\\n    \\\\immediate\\\\write\\\\@auxout{%\\n      \\\\string\\\\opadd*{#3}%\\n      {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n      {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n      \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n    }%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n        \\\\setlength{\\\\brouillon}{\\\\fpeval{\\\\BaremeEspace@Marge-#2}pt}%\\n        \\\\makebox[0pt][r]{\\\\footnotesize\\\\FranPt{#3}\\\\hspace*{\\\\brouillon}}%\\n        \\\\ignorespaces%\\n      }{}%\\n    }{%\\n      \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n        \\\\setlength{\\\\brouillon}{\\\\BaremeEspace@Marge-\\\\linewidth+\\\\textwidth}%\\n        \\\\makebox[0pt][r]{\\\\footnotesize\\\\FranPt{#3}\\\\hspace*{\\\\brouillon}}%\\n        \\\\ignorespaces%\\n      }{}%\\n    }%\\n  }%\\n}%\\n\\n\\\\newcommand*{\\\\Brm}[1]{%\\n  \\\\ifboolKV[Boulot]{Fiche}{}{%\\n    \\\\setlength{\\\\brouillon}{\\\\BaremeEspace@MargeCorrection-\\\\linewidth+\\\\textwidth}%\\n    \\\\makebox[0pt][r]{\\\\footnotesize\\\\color{gray!75}(\\\\opprint{#1})\\\\hspace*{\\\\brouillon}}%\\n    \\\\ignorespaces%\\n  }%\\n}%\\n\\n\\\\newcommand\\\\total[1]{%\\n  \\\\@ifundefined{Op@total#1}{recompilez}%\\n  {%\\n    \\\\opunzero{total#1}% on ne sait jamais\\n    \\\\opset{decimalsepsymbol={,}}%\\n    \\\\opprint{total#1}~%\\n    \\\\opset{decimalsepsymbol={.}}%\\n    \\\\useKV[ClesExercices]{MotPoint}%\\n    \\\\opcmp{total#1}{2}%\\n    \\\\ifopge s\\\\fi%\\n  }%\\n}\\n\\n\\\\newcommand\\\\ScoreMaximal{%\\n  \\\\@ifundefined{Op@ScoreTotal\\\\thePfMMaquette}{recompilez}%\\n  {%\\n    \\\\opunzero{ScoreTotal\\\\thePfMMaquette}% on ne sait jamais\\n    \\\\opset{decimalsepsymbol={,}}%\\n    \\\\opprint{ScoreTotal\\\\thePfMMaquette}~%\\n    \\\\opset{decimalsepsymbol={.}}%\\n    \\\\useKV[ClesExercices]{MotPoint}%\\n    \\\\opcmp{ScoreTotal\\\\thePfMMaquette}{2}%\\n    \\\\ifopge s\\\\fi%\\n  }%\\n}\\n\\n\\\\newcommand\\\\NoteFinale{%\\n  \\\\@ifundefined{Op@TotalExo}{Recompilez}%\\n  {%\\n    \\\\opexport{TotalExo}{\\\\TotalExo}%Le total d'exercices est \\\\TotalExo.\\n    \\\\xdef\\\\NoteTotale{0}%\\n    \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\TotalExo}}\\\\do{%\\n     \\\\opexport{total##1-##1}{\\\\totalUn}%\\n     \\\\xdef\\\\NoteTotale{\\\\fpeval{\\\\NoteTotale+\\\\totalUn}}%\\n   }%\\n   \\\\NoteTotale%\\n  }%\\n}%\\n\\n\\\\def\\\\TexteDevantPointParExercice{}%\\n\\n\\\\newcommand\\\\TableauRecapitulatif{%\\n  \\\\@ifundefined{Op@TotalExo}{Recompilez}%\\n  {%\\n    \\\\opexport{TotalExo}{\\\\TotalExo}%\\n    \\\\begin{tabular}{|c|c|}\\n      \\\\hline\\n      \\\\multicolumn{2}{|c|}{Barme rcapitulatif}\\\\\\\\\\n      \\\\hline\\n      \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\TotalExo}}\\\\do{\\n      Exercice ##1&\\\\TexteDevantPointParExercice\\\\total{##1-##1}\\\\\\\\\\n      }\\n      \\\\hline\\n    \\\\end{tabular}\\n  }\\n}%\\n\\\\makeatother\\n%%%%%%%% FIN BAREME %%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%% Commandes pour les affichages optionnels dans les cadres\\n\\\\NewDocumentCommand{\\\\PfMAffichageLogos}{}{%\\n  \\\\ifboolKV[ClesExercices]{Calculatrice}{}{\\\\node[fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\cancel{\\\\faCalculator}};\\\\stepcounter{PfMNbLogo}}%\\n  \\\\ifboolKV[ClesExercices]{Oral}{\\\\node[fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\faBullhorn};\\\\stepcounter{PfMNbLogo}}{}\\n  % \\n  \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{NombreEleves}}=1\\\\relax\\n    \\\\node[colLogo,fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\faUser};\\\\stepcounter{PfMNbLogo}\\n  \\\\else%\\n    \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{NombreEleves}}>1\\\\relax\\n      \\\\node[colLogo,fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\faUsers};\\\\stepcounter{PfMNbLogo}%\\n    \\\\fi%\\n  \\\\fi%\\n}\\n%\\n\\\\NewDocumentCommand{\\\\PfMAffichageCompetencesTravaillees}{}{%\\n  \\\\ifboolKV[ClesExercices]{AffichageCompetence}{%\\n     \\\\node[%\\n     fill=white,%\\n     anchor=east,%\\n     xshift=-10pt,%\\n     text=PfMColCpt,%\\n     ]\\n     at (frame.north east)\\n     {\\\\itshape\\\\scriptsize\\\\sffamily Comptence(s) dominante(s) : \\\\useKV[ClesExercices]{Competence}};\\n   }{}%\\n }%\\n%\\n\\\\NewDocumentCommand{\\\\PfMLienVersSolution}{}{%\\n  \\\\ifboolKV[Boulot]{VersSolution}{%\\n    \\\\ifboolKV[ClesExercices]{PasCorrige}{}{%\\n      \\\\node[%\\n      fill=tcbcolback,%\\n      anchor=center,%\\n      ] at ($(frame.north east)!0.25!(frame.south east)$){\\\\hyperref[pagesol-\\\\thePfMMaquette-\\\\thePfMExo]{\\\\faKey}};%\\n    }%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentCommand{\\\\PfMLienVersEntrainement}{}{%\\n  \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n    \\\\ifboolKV[ClesExercices]{AEntretenir}{%\\n      \\\\node[%\\n      fill=tcbcolback,%\\n      anchor=center,rotate=45%\\n      ] at ($(frame.north east)!0.75!(frame.south east)$){\\\\hyperref[pageentrai-\\\\thePfMMaquette-\\\\thePfMExo]{\\\\faDumbbell}};%\\n    }{}%\\n  }{}%\\n}%\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand{\\\\PfMAffichageSource}{}{%\\n  \\\\ifboolKV[ClesExercices]{AffichageSource}{%\\n    \\\\node[%\\n    fill=tcbcolback,\\n    anchor=east,\\n    yshift=0.5pt,\\n    xshift=-\\\\kvtcb@rightlower,%-10pt,\\n    text=PfMColSrc,\\n    ]\\n    at (frame.south east)\\n    {\\\\scriptsize\\\\sffamily \\\\useKV[ClesExercices]{Source}};\\n  }{}%\\n}%\\n\\\\makeatother\\n%%%%%%%%%%%%%%%%%%%%%%%%\\n%\\n%\\n%%%Style des diffrents documents\\n\\\\tcbset{%\\n  tikzbase/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    bicolor,\\n    colback=LightSteelBlue,\\n    colbacklower=white,\\n    frame hidden,\\n    overlay=\\\\useKV[ClesExercices]{Ajout}%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  tikzbasehtml/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    fonttitle=\\\\bfseries\\\\sffamily,\\n    title=\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\useKV[ClesExercices]{Titre}}{},%\\n    coltitle=black,\\n    frame hidden,\\n    overlay=\\\\useKV[ClesExercices]{Ajout}%\\n  }\\n}\\n\\n\\\\makeatletter\\n%%% Base des exercices DM\\n\\\\tcbset{%\\n  tikzdm/.style={%\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=PfMCadreDM,\\n    fonttitle=\\\\bfseries\\\\sffamily,\\n    title=Exercice\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{},\\n    attach boxed title to top left={xshift=0.2mm},\\n    boxed title size=standard,\\n    boxed title style={%\\n      empty,\\n      rounded corners=north, \\n      boxrule=0pt,\\n      bottom=0pt\\n    },\\n    underlay boxed title={%\\n      \\\\filldraw[rounded corners, gray!85, line width=.5mm]\\n      (title.south east)--++(90:\\\\tcboxedtitleheight)--++(183:\\\\tcboxedtitlewidth)--++(-90:\\\\tcboxedtitleheight)|-cycle;\\n    },%\\n    overlay unbroken and first={%\\n      %\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n        \\\\node[\\n        fill=white,\\n        anchor=east,\\n        xshift=-10pt,\\n        text=black,\\n        font=\\\\bfseries\\n        ]\\n        at (frame.north east)\\n        {\\\\footnotesize\\\\sffamily \\\\total{\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}};\\n      }{}%\\n      \\\\PfMLienVersSolution%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceDM}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n  }%\\n  \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n    \\\\immediate\\\\write\\\\@auxout{%\\n      \\\\string\\\\opcopy{0}{total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n    }}{}%\\n  \\\\begin{tcolorbox}[%\\n  tikzdm,%\\n  label is label,%\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo,%\\n  ]%\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n}%\\n}%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}%\\n  \\\\PfMApresLesExercices%\\n}%\\n}%\\n}%\\n\\n%%Contrat\\n\\n%\\\\makeatletter\\n\\\\NewDocumentCommand\\\\AfficheContrat{o}{%\\n  \\\\useKVdefault[SchemaContrat]%\\n  \\\\setKV[SchemaContrat]{#1}%\\n  \\\\setlength{\\\\PfMLargeurSchemaContrat}{\\\\useKV[SchemaContrat]{Ecart}}%\\n  \\\\setlength{\\\\PfMRayonSchemaContrat}{\\\\useKV[SchemaContrat]{Rayon}}%\\n  %\\\\colorlet{PfMCouleurSP}{\\\\useKV[SchemaContrat]{Couleur}}%\\n  \\\\@ifundefined{Op@\\\\Roman{PfMMaquette}-ContratTotalExo}{Recompilez pour obtenir le contrat.}%\\n  {%\\n    \\\\opexport{\\\\Roman{PfMMaquette}-ContratTotalExo}{\\\\ContratTotalExo}%\\n%    % Total Exo : \\\\ContratTotalExo\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\xdef\\\\PfCFooListeA{\\\\csname \\\\Roman{PfMMaquette}Contrata\\\\endcsname}%\\n    \\\\xdef\\\\PfCFooListeB{\\\\csname \\\\Roman{PfMMaquette}Contratb\\\\endcsname}%\\n    \\\\readlist*\\\\ListeA{\\\\PfCFooListeA}%\\n    \\\\readlist*\\\\ListeB{\\\\PfCFooListeB}%\\n%    Liste A : \\\\showitems\\\\ListeA[]\\\\par\\n%    Liste B : \\\\showitems\\\\ListeB[]\\\\par\\n%    % On crit en supposant que la liste A est la plus longue\\n    \\\\xdef\\\\LongueurA{\\\\ListeAlen}%\\n    \\\\xdef\\\\LongueurB{\\\\ListeBlen}%\\n    \\\\xdef\\\\Foo{}%\\n    \\\\xdef\\\\Decalage{0}%\\n    % On change la liste B en ajoutant des 0 o il manque des lments.\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurB}}\\\\do{%\\n      \\\\xdef\\\\Test{0}%\\n      \\\\xintFor * ##2 in {\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n        % ListeA vaut \\\\ListeA[##2] et ListeB vaut \\\\ListeB[##1]\\\\par\\n        \\\\IfStrEq{\\\\ListeA[##2]}{\\\\ListeB[##1]}{\\\\xdef\\\\Test{\\\\fpeval{\\\\Test+1}}\\\\xdef\\\\Position{##2}}{}%\\n      }%\\n      \\\\xintifboolexpr{\\\\Test==0}{%pas prsent\\n        \\\\xdef\\\\Foo{\\\\Foo,\\\\ListeB[##1]}\\n      }{%prsent\\n        \\\\xintifboolexpr{\\\\Position>\\\\fpeval{##1+\\\\Decalage}}{%\\n          \\\\xintFor* ##3 in{\\\\xintSeq{\\\\fpeval{##1+\\\\Decalage}}{\\\\fpeval{\\\\Position-1}}}\\\\do{%\\n            \\\\xdef\\\\Foo{\\\\Foo,0}%\\n          }\\n          \\\\xdef\\\\Decalage{\\\\fpeval{\\\\Position-##1-\\\\Decalage}}\\n        }{}\\n        \\\\xdef\\\\Foo{\\\\Foo,\\\\ListeB[##1]}\\n      }%\\n    }%\\n    % on vrifie qu'on n'a pas oubli des 0 :)\\n    \\\\readlist*\\\\ListeB{\\\\Foo}%\\n    \\\\ifnum\\\\ListeAlen>\\\\ListeBlen\\\\relax\\n      \\\\xintFor* ##4 in{\\\\xintSeq{1}{\\\\fpeval{\\\\ListeAlen-\\\\ListeBlen}}}\\\\do{\\n        \\\\xdef\\\\Foo{\\\\Foo,0}\\n      }\\n    \\\\fi\\n%    La liste A est \\\\showitems\\\\ListeA[]\\\\par\\n    \\\\readlist*\\\\ListeB{\\\\Foo}%\\n%    La liste B modifie est \\\\showitems\\\\ListeB[]\\\\par\\n    \\\\xdef\\\\FooNoeuds{}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeA{%\\n      \\\\xdef\\\\FooNoeuds{\\\\FooNoeuds,\\\\ListeA[\\\\compteurcnt]/\\\\ListeB[\\\\compteurcnt]}%\\n    }%\\n    \\\\BuildConfianceTikz{\\\\FooNoeuds}%\\n  }%\\n}%\\n%\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\BuildConfianceTikz{m}{%\\n  \\\\setsepchar[*]{,*/}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\Noeuds{#1}%\\n  \\\\begin{tikzpicture}\\n    \\\\coordinate (C-0) at (-\\\\PfMLargeurSchemaContrat,0);%\\n    \\\\coordinate (A-0) at (-\\\\PfMLargeurSchemaContrat,-\\\\PfMLargeurSchemaContrat+\\\\PfMRayonSchemaContrat);%\\n    \\\\coordinate (B-0) at (-\\\\PfMLargeurSchemaContrat,\\\\PfMLargeurSchemaContrat-\\\\PfMRayonSchemaContrat);%\\n    \\\\xintFor*##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\Noeudslen+1}}}\\\\do{%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaContrat] (C-##1) at (C-\\\\fpeval{##1-1});%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaContrat] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaContrat] (B-##1) at (B-\\\\fpeval{##1-1});%\\n    }%\\n    % On place les points\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\Noeudslen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\Noeuds[##1,1]==\\\\Noeuds[##1,2]}{%\\n        \\\\coordinate (A-##1) at (C-##1);%\\n        \\\\coordinate (B-##1) at (C-##1);%\\n      }{}%\\n    }%\\n    % on trace\\n    \\\\xintifboolexpr{\\\\Noeuds[1,1]==\\\\Noeuds[1,2]}{\\\\draw[line width=1pt,->] (C-0)--(C-1);%\\n    }{%\\n      \\\\draw[line width=1pt,->] (A-0)--(A-1);\\n      \\\\draw[line width=1pt,->] (B-0)--(B-1);\\n    }%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\Noeudslen}}\\\\do{%\\n      \\\\draw[line width=1pt] (A-\\\\fpeval{##1-1})--(A-##1);%\\n      \\\\draw[line width=1pt] (B-\\\\fpeval{##1-1})--(B-##1);%\\n    }%\\n    \\\\xintifboolexpr{\\\\Noeuds[\\\\Noeudslen,1]==\\\\Noeuds[\\\\Noeudslen,2]}{\\\\draw[line width=1pt,->] (C-\\\\Noeudslen)--(C-\\\\fpeval{\\\\Noeudslen+1});%\\n    }{%\\n      \\\\draw[line width=1pt,->] (A-\\\\Noeudslen)--(A-\\\\fpeval{\\\\Noeudslen+1});\\n      \\\\draw[line width=1pt,->] (B-\\\\Noeudslen)--(B-\\\\fpeval{\\\\Noeudslen+1});\\n    }%\\n    % on dessine les cercles\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\Noeudslen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\Noeuds[##1,1]==\\\\Noeuds[##1,2]}{%\\n        \\\\draw[fill=white] (C-##1) circle (\\\\PfMRayonSchemaContrat) node{\\\\ref{page-\\\\thePfMMaquette-\\\\Noeuds[##1,1]}};%\\n      }{%\\n        \\\\draw[fill=white] (A-##1) circle (\\\\PfMRayonSchemaContrat) node{\\\\ref{page-\\\\thePfMMaquette-\\\\Noeuds[##1,1]}};%\\n        \\\\xintifboolexpr{\\\\Noeuds[##1,2]==0}{}{\\\\draw[fill=white] (B-##1) circle (\\\\PfMRayonSchemaContrat) node{\\\\ref{page-\\\\thePfMMaquette-\\\\Noeuds[##1,2]}};}%\\n      }%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RemplisContrat{m}{%\\n  \\\\ifcsname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname,\\\\thePfMExo}%\\n%  Yes !\\n  \\\\else\\n%  No !\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname{\\\\thePfMExo}%\\n  \\\\fi\\n  \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname \\\\Roman{PfMMaquette}Contrat#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname}}%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceContrat}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{\\\\string\\\\opcopy{\\\\thePfMExo}{\\\\Roman{PfMMaquette}-ContratTotalExo}}%\\n  % Creation des parcours\\n  \\\\ifboolKV[ClesExercices]{Contrat}{%\\n    % Remise  zro de conteneurs des parcours\\n    \\\\setsepchar{,}%\\n    \\\\xdef\\\\PfMFooListeContrat{\\\\useKV[ClesExercices]{Confiance}}\\n    \\\\readlist*\\\\ListeContrat{\\\\PfMFooListeContrat}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeContrat{%\\n      \\\\RemplisContrat{\\\\ListeContrat[\\\\compteurcnt]}%\\n    }%\\n  }{}%\\n  %\\n  \\\\begin{tcolorbox}[%\\n    tikzcontrat,\\n    label is label,\\n    label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n    ]\\n    \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }%\\n  }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n    \\\\end{tcolorbox}\\n    \\\\PfMApresLesExercices%\\n  }%\\n  }%\\n}%\\n%%% Contrat %%%\\n\\\\tcbset{%\\n  usercontrat/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  usercontratcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzContrat{}{%\\n  \\\\begin{tcolorbox}[usercontrat]%\\n    \\\\Large\\\\sffamily \\\\useKV[Contrat]{Theme}\\\\hfill\\\\useKV[Contrat]{Niveau} \\\\useKV[Contrat]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[Contrat]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Contrat]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzContratCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\clearpage\\n  \\\\setKV[Contrat]{#1}%\\n  \\\\begin{tcolorbox}[usercontratcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Contrat]{Theme} (Correction) \\\\hfill\\\\useKV[Contrat]{Niveau} \\\\useKV[Contrat]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Contrat]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Contrat]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\tcbset{%\\n  tikzcontrat/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=PfMCadreContrat,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[Contrat]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos%\\n      %%\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %%\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n      %\\n      \\\\PfMLienVersEntrainement%\\n    }%\\n  }%\\n}%\\n%% Fin Contrat %%%\\n\\n%%FdR\\n\\\\NewDocumentCommand\\\\AfficheFdR{o}{%\\n  \\\\useKVdefault[SchemaFdR]%\\n  \\\\setKV[SchemaFdR]{#1}%\\n  \\\\setlength{\\\\PfMLargeurSchemaFdR}{\\\\useKV[SchemaFdR]{Ecart}}%\\n  \\\\setlength{\\\\PfMRayonSchemaFdR}{\\\\useKV[SchemaFdR]{Rayon}}%\\n  \\\\setlength{\\\\PfMHauteurSchemaFdR}{\\\\useKV[SchemaFdR]{Hauteur}}%\\n  \\\\colorlet{PfMCouleurFdR}{\\\\useKV[SchemaFdR]{Couleur}}%\\n  \\\\@ifundefined{Op@\\\\Roman{PfMMaquette}-FdRTotalExo}{Recompilez pour obtenir la feuille de route.}%\\n  {%\\n    \\\\opexport{\\\\Roman{PfMMaquette}-FdRTotalExo}{\\\\FdRTotalExo}%\\n    \\\\xdef\\\\PfMListeExerciceFdR{\\\\csname \\\\Roman{PfMMaquette}FdRtrue\\\\endcsname}%\\n    \\\\ifcsname \\\\Roman{PfMMaquette}FdRstop\\\\endcsname%\\n      \\\\xdef\\\\PfMListeExerciceFdRStop{\\\\csname \\\\Roman{PfMMaquette}FdRstop\\\\endcsname}%\\n    \\\\else%\\n      \\\\xdef\\\\PfMListeExerciceFdRStop{}%\\n    \\\\fi%\\n    % On ajoute un stop au dernier exercice\\n    \\\\xdef\\\\PfMListeExerciceFdRStop{\\\\PfMListeExerciceFdRStop,\\\\FdRTotalExo}%\\n    %Liste Exos : \\\\PfMListeExerciceFdR\\\\\\\\\\n    %Liste Stop : \\\\PfMListeExerciceFdRStop\\\\\\\\\\n    \\\\BuildRouteTikz{\\\\FdRTotalExo}{\\\\PfMListeExerciceFdR}{\\\\PfMListeExerciceFdRStop}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\BuildRouteTikz{mmm}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeRetiensExo{#2}%\\n  \\\\readlist*\\\\ListeRetiensStop{#3}%\\n  \\\\reademptyitems%\\n  %Les exos retenus : \\\\showitems\\\\ListeRetiensExo[]\\\\\\\\\\n  %Les exos stop : \\\\showitems\\\\ListeRetiensStop[]\\\\\\\\\\n  \\\\xdef\\\\LongueurA{\\\\ListeRetiensExolen}%\\n  \\\\xdef\\\\LongueurB{\\\\fpeval{\\\\ListeRetiensStoplen-1}}%\\n  \\\\xdef\\\\PfMFooExoIncrustes{}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\xdef\\\\RetiensExclus{0}%\\n    \\\\xintFor* ##2 in {\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\ListeRetiensExo[##2]==##1}{\\\\xdef\\\\RetiensExclus{1}}{}%\\n    }%\\n    \\\\xintifboolexpr{\\\\RetiensExclus>0}{}{\\\\xdef\\\\PfMFooExoIncrustes{\\\\PfMFooExoIncrustes,##1}}%\\n  }%\\n  %%%%%%%%%%\\n  %PfMFooExoIncrustes : \\\\PfMFooExoIncrustes\\\\\\\\%\\n  \\\\ifx\\\\bla\\\\PfMFooExoIncrustes\\\\bla%\\n    \\\\xdef\\\\LongueurC{0}%\\n  \\\\else%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeRetiensExclus{\\\\PfMFooExoIncrustes}%\\n    \\\\xdef\\\\LongueurC{\\\\ListeRetiensExcluslen}%\\n  \\\\fi%\\n  %%%%%%%%%%%%%%%%%%%%\\n  % portion 1\\n  % Portion 1 :\\\\\\\\\\n  \\\\xdef\\\\ListeRoute{}%\\n  \\\\xdef\\\\ListeRouteExclus{}%\\n  \\\\xdef\\\\NBExo{0}\\\\xdef\\\\NBExoSup{0}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n    \\\\xintifboolexpr{\\\\ListeRetiensExo[##1]>\\\\ListeRetiensStop[1]}{%\\n      %\\n    }{%\\n      \\\\xdef\\\\NBExo{\\\\fpeval{\\\\NBExo+1}}\\\\xdef\\\\ListeRoute{\\\\ListeRoute,\\\\ListeRetiensExo[##1]}%\\n    }%\\n  }%\\n  \\\\ifnum\\\\LongueurC=0\\\\relax%\\n  \\\\else%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurC}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\ListeRetiensExclus[##1]>\\\\ListeRetiensStop[1]}{}{\\\\xdef\\\\NBExoSup{\\\\fpeval{\\\\NBExoSup+1}}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,\\\\ListeRetiensExclus[##1]}}%\\n    }%\\n  \\\\fi%\\n  \\\\xintifboolexpr{\\\\NBExoSup==\\\\NBExo}{}{%\\n    \\\\xintifboolexpr{\\\\NBExoSup>\\\\NBExo}{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExoSup-\\\\NBExo}}}\\\\do{%\\n        \\\\xdef\\\\ListeRoute{\\\\ListeRoute,-1}%0 pour l'cart\\n      }%\\n    }{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExo-\\\\NBExoSup}}}\\\\do{%\\n        \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,-1}%0 pour l'cart\\n      }%\\n    }%\\n  }%\\n  \\\\xdef\\\\ListeRoute{\\\\ListeRoute,0}%0 pour le symbole stop\\n  \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,0}%0 pour le symbole stop\\n   %Route Basse P1 : \\\\ListeRoute\\\\\\\\\\n   %Route Haute P1 : \\\\ListeRouteExclus\\\\\\\\\\n  % portions centrales\\n  % Portions centrales :\\\\\\\\\\n   \\\\xintifboolexpr{\\\\ListeRetiensStoplen>2}{%\\n     \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\LongueurB-1}}}\\\\do{%\\n       \\\\xdef\\\\NBExo{0}\\\\xdef\\\\NBExoSup{0}%\\n       \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n         \\\\xintifboolexpr{\\\\ListeRetiensExo[##2]<\\\\fpeval{\\\\ListeRetiensStop[##1]+1} || \\\\ListeRetiensExo[##2]>\\\\ListeRetiensStop[\\\\fpeval{##1+1}]}{}{\\\\xdef\\\\NBExo{\\\\fpeval{\\\\NBExo+1}}\\\\xdef\\\\ListeRoute{\\\\ListeRoute,\\\\ListeRetiensExo[##2]}%\\n         }%\\n       }%\\n       \\\\ifnum\\\\LongueurC=0\\\\relax%\\n       \\\\else%\\n         \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\LongueurC}}\\\\do{%\\n           \\\\xintifboolexpr{\\\\ListeRetiensExclus[##2]<\\\\fpeval{\\\\ListeRetiensStop[##1]+1} || \\\\ListeRetiensExclus[##2]>\\\\ListeRetiensStop[\\\\fpeval{##1+1}]}{}{\\\\xdef\\\\NBExoSup{\\\\fpeval{\\\\NBExoSup+1}}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,\\\\ListeRetiensExclus[##2]}%\\n           }%%\\n         }%\\n       \\\\fi%\\n      \\\\xintifboolexpr{\\\\NBExoSup==\\\\NBExo}{}{%\\n        \\\\xintifboolexpr{\\\\NBExoSup>\\\\NBExo}{%\\n          \\\\xintFor* ##3 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExoSup-\\\\NBExo}}}\\\\do{%\\n            \\\\xdef\\\\ListeRoute{\\\\ListeRoute,-1}%0 pour l'cart\\n          }%\\n        }{%\\n          \\\\xintFor* ##3 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExo-\\\\NBExoSup}}}\\\\do{%\\n            \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,-1}%0 pour l'cart\\n          }%\\n        }%\\n      }%\\n      \\\\xdef\\\\ListeRoute{\\\\ListeRoute,0}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,0}%\\n    }%\\n   }{}%\\n   %Route Basse P2 : \\\\ListeRoute\\\\\\\\\\n   %Route Haute P2 : \\\\ListeRouteExclus\\\\\\\\\\n  % portion finale\\n  % Portion fin \\\\\\\\\\n   \\\\xintifboolexpr{\\\\ListeRetiensStoplen>1}{%\\n     \\\\xdef\\\\NBExo{0}\\\\xdef\\\\NBExoSup{0}%\\n     \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n       \\\\xintifboolexpr{\\\\fpeval{\\\\ListeRetiensExo[##1]}>\\\\fpeval{\\\\ListeRetiensStop[\\\\ListeRetiensStoplen-1]}}{\\\\xdef\\\\NBExo{\\\\fpeval{\\\\NBExo+1}}\\\\xdef\\\\ListeRoute{\\\\ListeRoute,\\\\ListeRetiensExo[##1]}}{}%\\n     }%\\n     \\\\ifnum\\\\LongueurC=0\\\\relax%\\n     \\\\else%\\n     \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurC}}\\\\do{%\\n       \\\\xintifboolexpr{\\\\ListeRetiensExclus[##1]>\\\\fpeval{\\\\ListeRetiensStop[\\\\ListeRetiensStoplen-1]}}{\\\\xdef\\\\NBExoSup{\\\\fpeval{\\\\NBExoSup+1}}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,\\\\ListeRetiensExclus[##1]}}{}%\\n     }%\\n     \\\\fi%\\n     \\\\xintifboolexpr{\\\\NBExoSup==\\\\NBExo}{}{%\\n       \\\\xintifboolexpr{\\\\NBExoSup>\\\\NBExo}{%\\n         \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExoSup-\\\\NBExo}}}\\\\do{%\\n           \\\\xdef\\\\ListeRoute{\\\\ListeRoute,-1}%0 pour l'cart\\n         }%\\n       }{%\\n         \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExo-\\\\NBExoSup}}}\\\\do{%\\n           \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,-1}%0 pour l'cart\\n         }%\\n       }%\\n     }%\\n     \\\\xdef\\\\ListeRoute{\\\\ListeRoute,0}%0 pour le symbole stop\\n     \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,0}%0 pour le symbole stop\\n   }{}%\\n  %Route Basse P3 : \\\\ListeRoute\\\\\\\\\\n  %Route Haute P3 : \\\\ListeRouteExclus\\\\\\\\\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeRouteBasse{\\\\ListeRoute}%\\n  \\\\readlist*\\\\ListeRouteHaute{\\\\ListeRouteExclus}%\\n  %Liste Route : \\\\showitems\\\\ListeRouteBasse[]\\\\\\\\\\n  %Liste Exclus : \\\\showitems\\\\ListeRouteHaute[]\\\\\\\\\\n  \\\\begin{tikzpicture}\\n    \\\\coordinate (A-0) at (-\\\\PfMLargeurSchemaFdR,0);\\n    \\\\coordinate (A-1) at (0,0);%\\n    \\\\coordinate (B-1) at (0,\\\\PfMHauteurSchemaFdR);%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeRouteBasselen}}\\\\do{%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaFdR] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaFdR] (B-##1) at (B-\\\\fpeval{##1-1});%\\n    }%\\n   \\\\coordinate[xshift=\\\\PfMLargeurSchemaFdR] (A-\\\\fpeval{\\\\ListeRouteBasselen+1}) at (A-\\\\ListeRouteBasselen);%\\n   % Route haute\\n   % Correct !\\n   %\\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeRouteHautelen}}\\\\do{%\\n   %  \\\\xintifboolexpr{\\\\ListeRouteHaute[##1]<0}{%\\n   %    \\\\draw[red] (B-##1) to (B-\\\\fpeval{##1+1});\\n   %  }{%\\n   %    \\\\xintifboolexpr{\\\\ListeRouteHaute[##1]==0}{%\\n   %      \\\\draw (B-##1) to (A-##1);%\\n   %    }{%\\n   %      \\\\draw[blue] (B-##1) to (B-\\\\fpeval{##1+1});\\n   %      \\\\draw[fill=white](B-##1) circle (\\\\PfMRayonSchemaFdR) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRouteHaute[##1]}};\\n   %    }%\\n   %  }%\\n   %}%\\n   %% Fin Correct !\\n   \\\\xdef\\\\RetiensLesZeros{0}%\\n   \\\\xdef\\\\RetiensLeDepart{0}%\\n   \\\\xdef\\\\RetiensLesReponses{0}%\\n   \\\\xdef\\\\RetiensNonAffichees{0}%\\n   \\\\xdef\\\\RetiensEtage{0}%\\n   \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeRouteHautelen}}\\\\do{%\\n     \\\\xintifboolexpr{\\\\ListeRouteHaute[##1]==0}{%\\n       \\\\xdef\\\\RetiensEtage{\\\\fpeval{\\\\RetiensEtage+1}}%\\n       \\\\xdef\\\\RetiensLesReponses{\\\\fpeval{\\\\RetiensLesReponses+1}}%\\n       \\\\xintFor* ##2 in{\\\\xintSeq{\\\\fpeval{\\\\RetiensLeDepart+1}}{\\\\fpeval{\\\\RetiensLeDepart+\\\\RetiensLesReponses}}}\\\\do{%\\n         \\\\xintifboolexpr{\\\\ListeRouteHaute[##2]<0}{%\\n           \\\\xdef\\\\RetiensNonAffichees{\\\\fpeval{\\\\RetiensNonAffichees+1}}%\\n         }{}%\\n       }%\\n       %\\\\node at (0,\\\\RetiensEtage) {Il y a \\\\RetiensNonAffichees fois le nombre -1.};\\n       % On affiche\\n       \\\\xintifboolexpr{\\\\fpeval{\\\\RetiensLesReponses-1}==\\\\RetiensNonAffichees}{%\\n%         %\\n       }{%\\n         \\\\xintFor* ##2 in{\\\\xintSeq{\\\\fpeval{\\\\RetiensLeDepart+1}}{\\\\fpeval{\\\\RetiensLeDepart+\\\\RetiensLesReponses}}}\\\\do{%\\n           \\\\xintifboolexpr{\\\\ListeRouteHaute[##2]<0}{%\\n             \\\\draw (B-##2) to (B-\\\\fpeval{##2+1});%\\n           }{%\\n             \\\\xintifboolexpr{\\\\ListeRouteHaute[##2]==0}{%\\n               %\\\\xintifboolexpr{\\\\fpeval{\\\\RetiensLesReponses-1}==\\\\RetiensNonAffichees}{}{\\n                 \\\\draw (B-##2) to (A-##2);%\\n               %}\\n             }{%\\n               \\\\draw[] (B-##2) to (B-\\\\fpeval{##2+1});%\\n               \\\\draw[fill=white](B-##2) circle (\\\\PfMRayonSchemaFdR) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRouteHaute[##2]}};%\\n             }%\\n           }%    \\n         }%\\n       }%\\n       %\\n       \\\\xdef\\\\RetiensLeDepart{\\\\fpeval{\\\\RetiensLeDepart+\\\\RetiensLesReponses}}%\\n       \\\\xdef\\\\RetiensLesReponses{0}%\\n       \\\\xdef\\\\RetiensNonAffichees{0}%\\n     }{\\\\xdef\\\\RetiensLesReponses{\\\\fpeval{\\\\RetiensLesReponses+1}}%\\n     }%\\n   }%\\n   % Route basse\\n    \\\\foreach\\\\i in{1,...,\\\\fpeval{\\\\ListeRouteBasselen}}{%\\n      \\\\draw[line width=1pt] (A-\\\\fpeval{\\\\i-1}) -- (A-\\\\i);%\\n    }%\\n    \\\\draw[line width=1pt,>=latex,->] (A-\\\\ListeRouteBasselen) to (A-\\\\fpeval{\\\\ListeRouteBasselen+1});%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeRouteBasselen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\ListeRouteBasse[##1]<0}{}{%\\n        \\\\xintifboolexpr{\\\\ListeRouteBasse[##1]==0}{%\\n          \\\\draw[fill=white,draw=white](A-##1) circle (\\\\PfMRayonSchemaFdR) node{\\\\faCheck};%\\n        }{%\\n          \\\\draw[fill=PfMCouleurFdR](A-##1) circle (\\\\PfMRayonSchemaFdR) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRouteBasse[##1]}};%\\n        }%\\n      }%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RemplisFdR{m}{%\\n  \\\\ifcsname \\\\Roman{PfMMaquette}route#1\\\\endcsname\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname,\\\\thePfMExo}%\\n%  Yes !\\n  \\\\else\\n%  No !\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname{\\\\thePfMExo}%\\n  \\\\fi\\n  \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname \\\\Roman{PfMMaquette}FdR#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname}}%\\n}%\\n\\n\\\\def\\\\Relecture{}%\\n\\n\\\\NewDocumentEnvironment{exerciceFdR}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{\\\\string\\\\opcopy{\\\\thePfMExo}{\\\\Roman{PfMMaquette}-FdRTotalExo}}%\\n  % Creation des parcours\\n  \\\\ifboolKV[ClesExercices]{Routes}{%\\n    \\\\colorlet{PfMCadreFdR}{black}\\n    % Remise  zro de conteneurs des parcours\\n    \\\\setsepchar{,}%\\n    % \\\\ifboolKV[ClesExercices]{Stop}{\\\\xdef\\\\PfMFooListeFdR{\\\\useKV[ClesExercices]{Route},0}}{\\n    \\\\xdef\\\\PfMFooListeFdR{\\\\useKV[ClesExercices]{Route}}\\n %   % }%\\n    \\\\readlist*\\\\ListeFdR{\\\\PfMFooListeFdR}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeFdR{%\\n      \\\\RemplisFdR{\\\\ListeFdR[\\\\compteurcnt]}%\\n    }%\\n  }{\\\\colorlet{PfMCadreFdR}{gray!15}}\\n  \\\\ifboolKV[ClesExercices]{Stops}{%\\n    \\\\setsepchar{,}%\\n    % \\\\ifboolKV[ClesExercices]{Stop}{\\\\xdef\\\\PfMFooListeFdR{\\\\useKV[ClesExercices]{Route},0}}{\\n    \\\\xdef\\\\PfMFooListeFdR{stop}%\\n    % }%\\n    \\\\readlist*\\\\ListeFdR{\\\\PfMFooListeFdR}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeFdR{%\\n      \\\\RemplisFdR{\\\\ListeFdR[\\\\compteurcnt]}%\\n    }%\\n  }{}%\\n  %\\n  \\\\begin{tcolorbox}[%\\n    tikzFdR,\\n    label is label,\\n    label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n    ]\\n    \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }%\\n  }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}\\n  \\\\PfMApresLesExercices%\\n}%\\n}%\\n}%\\n\\n%CAN\\n\\\\setsepchar[*]{,*/}%\\n\\\\readlist*\\\\ListeNoms{Aude/Elle/d'Aude/qu'Aude/elle,Bernard/Il/de Bernard/que Bernard/il,Cline/Elle/de Cline/que Cline/elle,Daniel/Il/de Daniel/que Daniel/il,\\\\'Elise/Elle/d'\\\\'Elise/qu'\\\\'Elise/elle,Fabien/Il/de Fabien/que Fabien/il,Grard/Il/de Grard/que Grard/il,Hlne/Elle/d'Hlne/qu'Hlne/elle,Ilies/Il/d'Ilies/qu'Ilies/il,Jasmine/Elle/de Jasmine/que Jasmine/elle,Kylian/Il/de Kylian/que Kylian/il,Laurent/Il/de Laurent/que Laurent/il,Mathilde/Elle/de Mathilde/que Mathilde/elle,Nina/Elle/de Nina/que Nina/elle,Octave/Il/d'Octave/qu'Octave/il,Philippe/Il/de Philippe/que Philippe/il,Joachim/Il/de Joachim/que Joachim/il,Thrse/Elle/de Thrse/que Thrse/elle,Nawel/Elle/de Nawel/que Nawel/elle,Alexandre/Il/d'Alexandre/qu'Alexandre/il,Maxence/Il/de Maxence/que Maxence/il,Sophie/Elle/de Sophie/que Sophie/elle,Christophe/Il/de Christophe/que Christophe/il,Myriam/Elle/de Myriam/que Myriam/elle,Nathalie/Elle/de Nathalie/que Nathalie/elle,Sbastien/Il/de Sbastion/que Sbastien/il}%\\n\\\\readlist*\\\\ListeChersObjets{montre/une,collier/un,bague/une,pendentif/un}%\\n\\\\readlist*\\\\ListeSport{Football/du football/le football,Tennis/du tennis/le tennis,Basket/du basket/le basket,Athltisme/de l'athltisme/l'athltisme,Natation/de la natation/la natation,Hand-ball/du hand-ball/le hand-ball,Volley-ball/du volley-ball/le volley-ball}\\n\\\\setsepchar{,}%\\n\\\\readlist*\\\\ListePetitsObjets{bonbons,billes,biscuits,gommes,clous,vis,cahiers,trousses}%\\n\\\\readlist*\\\\ListeFruits{pommes,poires,abricots,cerises,fraises,framboises,noix,pches,nectarines,myrtilles,oranges,mandarines,kiwis}%\\n\\\\readlist*\\\\ListeVariables{a,b,c,\\\\ell,m,n,p,r,s,t,x,y,z}%\\n\\n\\\\makeatletter\\n\\\\def\\\\ExoCANWrite{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\PfMChoixCorrection%\\n  \\\\stepcounter{PfMExo}%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n  }%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.can\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{\\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endExoCANWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\Complement{+m}{%\\n  \\\\ifboolKV[Boulot]{CAN}{%\\n    \\\\expandafter\\\\xdef\\\\csname CNReponse\\\\endcsname{\\\\noexpand #1}%\\n  }{%\\n    \\\\begin{center}\\n      #1%\\n    \\\\end{center}\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\EcartComplement{m}{%\\n  \\\\rule{0mm}{#1}%\\n}%\\n\\n\\\\tcbset{%\\n  usercan/.style={%\\n    enhanced,\\n    frame hidden,\\n    colback=white,\\n    middle=24pt,\\n    overlay={% unbroken and first={%\\n      \\\\draw[line width=2pt] (frame.north west)--(frame.north east);\\n      \\\\draw[line width=2pt] (frame.south west)--(frame.south east);\\n    }\\n  }%\\n}%\\n\\\\tcbset{%\\n  usercancor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\newlength\\\\PfMEspaceItemPGCAN\\n\\\\newlength\\\\PfMEspaceTitreSujetPGCAN\\n\\\\setlength{\\\\PfMEspaceItemPGCAN}{0.5em}\\n\\\\setlength{\\\\PfMEspaceTitreSujetPGCAN}{12pt}\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\TikzCAN{}{%\\n  \\\\begin{tcolorbox}[usercan]%\\n    {\\\\sc Nom :} \\\\PfCTBstrut\\\\pointilles[0.35\\\\linewidth]\\\\hfill\\\\textbf{\\\\sc Prnom :} \\\\pointilles[0.35\\\\linewidth]\\n    \\\\par\\\\bigskip\\\\par\\n    \\\\textbf{\\\\sc Classe :} \\\\pointilles[0.35\\\\linewidth]\\\\hfill\\n    \\\\begin{minipage}{0.3\\\\linewidth}\\n      \\\\begin{tcolorbox}\\n        \\\\textbf{\\\\sc Score :} \\\\hfill\\\\textbf{/\\\\@ifundefined{Op@TotalExo}{Recompilez}{\\\\opexport{TotalExo}{\\\\TotalExo}\\\\TotalExo}}\\n      \\\\end{tcolorbox}\\n    \\\\end{minipage}\\n    \\\\tcblower\\n    \\\\begin{itemize}\\n    \\\\item[\\\\faCheck] \\\\textbf{Dure : \\\\useKV[CAN]{Duree} minutes.}\\\\\\\\[\\\\PfMEspaceItemPGCAN]\\n    \\\\item[\\\\faCheck] \\\\textit{L'preuve comporte \\\\@ifundefined{Op@TotalExo}{Recompilez}{\\\\opexport{TotalExo}{\\\\TotalExo}\\\\TotalExo{} question\\\\ifnum\\\\TotalExo=1\\\\else\\\\relax s\\\\fi.}}\\\\\\\\[\\\\PfMEspaceItemPGCAN]\\n    \\\\item[\\\\faCheck] \\\\textit{L'usage de la calculatrice et du brouillon sont interdits. Il n'est pas permis d'crire des calculs intermdiaires.} \\n    \\\\end{itemize}\\n    \\\\vspace*{\\\\PfMEspaceTitreSujetPGCAN}\\n  \\\\end{tcolorbox}%\\n  \\\\begin{center}\\n    \\\\Large Sujet \\\\useKV[CAN]{Niveau}\\\\hspace{0.15\\\\linewidth}\\\\useKV[CAN]{Date}\\n  \\\\end{center}\\n  \\\\clearpage%\\n}%\\n%\\\\makeatother\\n\\n%\\\\makeatletter\\n\\\\NewDocumentCommand\\\\TikzCANCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[CAN]{#1}%\\n  \\\\begin{tcolorbox}[usercancor]%\\n    \\\\begin{center}\\n      \\\\Large\\\\sffamily Course aux nombres (Correction)\\n    \\\\end{center}\\n    \\\\hfill\\\\useKV[CAN]{Niveau}%\\n  \\\\end{tcolorbox}%\\n}\\n%%% FdR %%%\\n\\\\tcbset{%\\n  userfdr/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userfdrcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzFdR{}{%\\n  \\\\begin{tcolorbox}[userfdr]%\\n    \\\\Large\\\\sffamily \\\\useKV[FdR]{Theme}\\\\hfill\\\\useKV[FdR]{Niveau} \\\\useKV[FdR]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[FdR]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[FdR]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzFdRCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[FdR]{#1}%\\n  \\\\begin{tcolorbox}[userfdrcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[FdR]{Theme} (Correction) \\\\hfill\\\\useKV[FdR]{Niveau} \\\\useKV[FdR]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[FdR]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[FdR]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\tcbset{%\\n  tikzFdR/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=PfMColbackFdR,\\n    colframe=PfMCadreFdR,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[FdR]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos\\n      %%\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %%\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n      %\\n      \\\\PfMLienVersEntrainement%\\n    }%\\n  }%\\n}%\\n%% Fin FdR %%%\\n\\n%% Parcours\\n\\n%\\\\makeatletter\\n\\\\NewDocumentCommand\\\\AfficheParcours{om}{%\\n  \\\\useKVdefault[SchemaParcours]%\\n  \\\\setKV[SchemaParcours]{#1}%\\n  \\\\setlength{\\\\PfMLargeurSchemaParcours}{\\\\useKV[SchemaParcours]{Largeur}}%\\n  \\\\colorlet{PfMCouleurSP}{\\\\useKV[SchemaParcours]{Couleur}}%\\n  \\\\@ifundefined{Op@\\\\Roman{PfMMaquette}-ParcoursTotalExo}{Recompilez pour obtenir le parcours.}%\\n  {%\\n    \\\\opexport{\\\\Roman{PfMMaquette}-ParcoursTotalExo}{\\\\ParcoursTotalExo}%\\n%    Total Exo : \\\\ParcoursTotalExo\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeExercicesPA{\\\\csname \\\\Roman{PfMMaquette}Parcours#2\\\\endcsname}\\n    \\\\reademptyitems%\\n    \\\\xdef\\\\PfMFooTestA{\\\\ListeExercicesPA[1]}%\\n    \\\\ifnum\\\\ListeExercicesPAlen>1\\\\relax%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeExercicesPAlen}}\\\\do{%\\n        \\\\xdef\\\\PfMFooTestA{\\\\PfMFooTestA,\\\\ListeExercicesPA[##1]}%\\n      }%\\n    \\\\fi%\\n    \\\\ifboolKV[Parcours]{Plan}{%\\n      \\\\BuildParcoursPlan{\\\\ParcoursTotalExo}{\\\\PfMFooTestA}%\\n    }{%\\n      \\\\ifboolKV[Parcours]{Vertical}{%\\n        \\\\BuildParcoursTikzV{\\\\ParcoursTotalExo}{\\\\PfMFooTestA}%\\n      }{%\\n        \\\\BuildParcoursTikz{\\\\ParcoursTotalExo}{\\\\PfMFooTestA}%\\n      }%\\n    }%\\n  }%\\n}%\\n%\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\BuildParcoursPlan{mm}{%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeRetiens{#2}%\\n  \\\\begin{enumerate}\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n    \\\\item[$\\\\square$] Exercice \\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}%\\n    }%\\n  \\\\end{enumerate}\\n}%\\n\\n\\\\NewDocumentCommand\\\\BuildParcoursTikzV{mm}{%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeRetiens{#2}%\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      % On place les points%anchor=base,baseline[xshift=-1cm,yshift=-4cm]\\n      \\\\coordinate (A-1) at (0,0);%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{2}{#1}}\\\\do{%\\n        \\\\coordinate[yshift=-1cm] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      }%\\n      \\\\foreach\\\\i in{2,...,#1}{%\\n        \\\\draw[line width=1pt] (A-\\\\fpeval{\\\\i-1}) -- (A-\\\\i);%\\n      }%\\n      %\\n      \\\\draw[line width=1pt,>=latex,->] (A-#1)--(A-\\\\fpeval{#1+1});\\n      %\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n        \\\\draw[fill=white,dashed](A-##1) circle (2.5mm) node{##1};%\\n      }%\\n      \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n        \\\\draw[fill=PfMCouleurSP](A-\\\\ListeRetiens[\\\\compteurcnt]) circle (2.5mm) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}};%\\n      }%\\n    \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\BuildParcoursTikz{mm}{%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeRetiens{#2}%\\n  \\\\begin{tikzpicture}[anchor=center,baseline=-1.25mm]\\n    % On place les points\\n    \\\\Orientation=1\\\\relax\\n    \\\\ifboolKV[Parcours]{Court}{%\\n      \\\\TotalParcoursTikz=\\\\ListeRetienslen%\\n    }{%\\n      \\\\TotalParcoursTikz=#1%\\n    }%\\n    \\\\coordinate[anchor=base,baseline=-1.25mm] (A-1) at (0,0);%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\fpeval{\\\\the\\\\TotalParcoursTikz+1}}}\\\\do{%\\n      \\\\modulo{##1}{\\\\useKV[SchemaParcours]{Colonnes}}%\\n      \\\\ifnum\\\\remainder=0\\\\relax%\\n      \\\\Orientation=\\\\numexpr\\\\Orientation*(-1)\\\\relax%\\n      \\\\coordinate[yshift=-1cm] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\else%\\n      \\\\coordinate[xshift=\\\\the\\\\Orientation*\\\\PfMLargeurSchemaParcours] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\fi%\\n    }%\\n    \\\\foreach\\\\i in{1,...,\\\\the\\\\TotalParcoursTikz}{%\\n      \\\\draw[line width=1pt] (A-\\\\i) -- (A-\\\\fpeval{\\\\i+1});%\\n    }%\\n%    %\\n    \\\\draw[line width=1pt,>=latex,->] (A-\\\\the\\\\TotalParcoursTikz)--(A-\\\\fpeval{\\\\the\\\\TotalParcoursTikz+1});\\n%    %\\n    \\\\ifboolKV[Parcours]{Court}{%\\n      \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n        \\\\draw[fill=PfMCouleurSP](A-\\\\compteurcnt) circle (2.5mm) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}};%\\n      }%\\n    }{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\the\\\\TotalParcoursTikz}}\\\\do{%\\n        \\\\draw[fill=white,dashed](A-##1) circle (2.5mm) node{##1};%\\n      }%\\n      \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n        \\\\draw[fill=PfMCouleurSP](A-\\\\ListeRetiens[\\\\compteurcnt]) circle (2.5mm) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}};%\\n      }%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RemplisParcours{m}{%\\n  \\\\ifcsname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname,\\\\thePfMExo}%\\n%  Yes !\\n  \\\\else\\n%  No !\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname{\\\\thePfMExo}%\\n  \\\\fi\\n  \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname \\\\Roman{PfMMaquette}Parcours#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname}}%\\n}%\\n\\n\\\\def\\\\exerciceParcoursPerso{%\\n  \\\\stepcounter{PfMExo}%\\n  \\\\PfMChoixCorrection%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\thePfMExo.tex\\\" %\\n  \\\\immediate\\\\write\\\\verbatim@out{\\\\string\\\\begin{exercice}}\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\n\\\\def\\\\endexerciceParcoursPerso{\\\\immediate\\\\write\\\\verbatim@out{\\\\string\\\\end{exercice}}\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n  \\n\\\\NewDocumentEnvironment{exerciceParcours}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{\\\\string\\\\opcopy{\\\\thePfMExo}{\\\\Roman{PfMMaquette}-ParcoursTotalExo}}%\\n  % Creation des parcours\\n  \\\\ifboolKV[ClesExercices]{Parcours}{%\\n      % Remise  zro de conteneurs des parcours\\n      \\\\setsepchar{,}%\\n    \\\\xdef\\\\PfMFooListeParcours{\\\\useKV[ClesExercices]{Trajet}}\\n    \\\\readlist*\\\\ListeParcours{\\\\PfMFooListeParcours}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeParcours{%\\n      \\\\RemplisParcours{\\\\ListeParcours[\\\\compteurcnt]}%\\n    }%\\n  }{}%\\n  %\\n  \\\\begin{tcolorbox}[%\\n    tikzparcours,\\n    label is label,\\n    label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n    ]\\n    \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }%\\n  }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}\\n  \\\\PfMApresLesExercices%\\n}%\\n}%\\n}%\\n\\n%%%%%%%%%%%%%%%%%%%%%%%\\n% Pour encart\\n%%%%%%%%%%%%%%%%%%%%%%\\n\\n\\\\newtcolorbox{PfMtcbEncart}{%\\n  before skip=1em,\\n    enhanced,\\n    breakable,\\n    frame hidden,\\n    height=\\\\useKV[ClesExercices]{Encart},\\n    colback=PfMFondEncart,\\n    left=10pt,\\n%    % colframe=PfMCadreEncart,\\n    overlay unbroken and first={%\\n      \\\\coordinate[xshift=10*\\\\kvtcb@leftlower] (B) at (frame.north west);\\n      \\\\coordinate[xshift=-10*\\\\kvtcb@leftlower] (C) at (frame.south east);\\n      \\\\draw[PfMCadreEncart,line width=1pt] (frame.south east)--(frame.south west)--(frame.north west)--(B);\\n      \\\\node[%\\n      name=A,\\n      fill=PfMFondEncart,\\n      anchor=west,\\n      xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily\\\\PfMTexteEncart};\\n      %% \\n    }%\\n  }%\\n\\n% From setspace.sty\\n\\\\NewDocumentCommand\\\\PfMSetStretch{}{%\\n  \\\\ifboolKV[ClesExercices]{Doublespacing}{%\\n    \\\\setstretch {1.667}%  default\\n    \\\\ifx\\\\@ptsize\\\\@undefined\\\\else\\n      \\\\ifcase \\\\@ptsize \\\\relax% 10pt\\n        \\\\setstretch {1.667}%\\n      \\\\or % 11pt\\n        \\\\setstretch {1.618}%\\n      \\\\or % 12pt\\n        \\\\setstretch {1.655}%\\n      \\\\fi\\n    \\\\fi\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{Onehalfspacing}{%\\n      \\\\setstretch{1.25}%  default\\n      \\\\ifx\\\\@ptsize\\\\@undefined\\\\else\\n        \\\\ifcase \\\\@ptsize \\\\relax % 10pt\\n          \\\\setstretch {1.25}%\\n        \\\\or % 11pt\\n          \\\\setstretch {1.213}%\\n        \\\\or % 12pt\\n          \\\\setstretch {1.241}%\\n        \\\\fi%\\n      \\\\fi%\\n    }{}%\\n  }%\\n}%\\n\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n\\\\NewDocumentCommand\\\\PfMScore{m}{%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opadd*{#1}{ScoreTotal\\\\thePfMMaquette}{ScoreTotal\\\\thePfMMaquette}%\\n  }%\\n  \\\\num{#1} pt\\\\xintifboolexpr{#1>2 || #1==2}{s}{}%\\n}%\\n\\n\\\\def\\\\PfMMPGrilleCode{%\\n  PapierLargeur=floor(\\\\mpdim{\\\\linewidth}/(5mm));\\n  color PapierCouleur;\\n  PapierCouleur=0.8white;\\n  %\\n  vardef Papier(expr nb,score)=\\n    path horizon,verticon;\\n    horizon=(0,0)--(PapierLargeur*5mm,0);\\n    verticon=(0,0)--(0,abs(nb)*5mm);\\n    picture Papiers;\\n    Papiers=image(\\n      drawoptions(withcolor PapierCouleur);\\n      for k=0 upto PapierLargeur:\\n        draw verticon shifted((k*5mm,0));\\n      endfor;\\n      for k=0 upto abs(nb):\\n        draw horizon shifted((0,k*5mm));\\n      endfor;\\n      drawoptions();\\n      if nb<0:\\n        path cc,cd,ce;\\n        cd=(unitsquare xscaled (3*5mm) yscaled (abs(nb)*5mm)) shifted(5mm*(PapierLargeur-3,0));\\n        ce=(unitsquare scaled (2*5mm)) shifted(5mm*(PapierLargeur-2.5,1));\\n        cc=(unitsquare xscaled (6*5mm) yscaled (2*5mm)) shifted(5mm*(PapierLargeur-10,1));\\n        fill cd withcolor PapierCouleur;\\n        fill ce withcolor white;\\n        fill cc withcolor white;\\n        %drawoptions(withpen pencircle scaled 1);\\n        draw ce;\\n        draw cc;\\n        draw cd;\\n        draw polygone((0,0),(PapierLargeur*5mm,0),5mm*(PapierLargeur,abs(nb)),5mm*(0,abs(nb)));\\n        if score>0:\\n          label.bot(TEX(\\\"\\\\PfMScore{\\\"&decimal(score)&\\\"}\\\"),5mm*(PapierLargeur-1.5,1));\\n        fi;\\n      fi;\\n    );\\n    Papiers\\n  enddef;\\n}%\\n\\n\\\\def\\\\PfMPapierCinqCinq#1#2{%\\n  \\\\begin{center}\\n  \\\\ifluatex%\\n    \\\\mplibforcehmode%\\n    \\\\begin{mplibcode}%\\n      \\\\PfMMPGrilleCode\\n      trace Papier(#1,#2);\\n    \\\\end{mplibcode}%\\n  \\\\else%\\n    \\\\begin{mpost}[mpsettings={\\\\PfMMPGrilleCode}]\\n      trace Papier(#1,#2);\\n    \\\\end{mpost}%\\n  \\\\fi%\\n  \\\\end{center}\\n}%\\n\\n\\\\def\\\\PfMMPSeyesCode{%\\n  u:=\\\\useKV[ClesExercices]{EchelleSeyes}*1mm;\\n  PapierLargeur=floor(\\\\mpdim{\\\\linewidth}/(u));\\n  color PapierCouleur;\\n  PapierCouleur=0.8white;%\\\\useKV[Papiers]{Couleur};\\n  vardef Seyes(expr nb,score)=\\n    path horizon,verticon;\\n    horizon=(0,0)--u*(PapierLargeur,0);\\n    verticon=(0,0)--u*(0,abs(nb));\\n    picture PapierSeyes;\\n    PapierSeyes=image(\\n      drawoptions(withcolor PapierCouleur);\\n      for k=0 upto (PapierLargeur):\\n        draw verticon shifted((k*u,0));\\n      endfor;\\n      for k=0 step 0.25 until abs(nb):\\n        draw horizon shifted((0,k*u)) withpen pencircle scaled 0.5;\\n      endfor;\\n      for k=0 upto abs(nb):\\n        draw horizon shifted((0,k*u)) withpen pencircle scaled 1.25;\\n      endfor;\\n      drawoptions();\\n      if nb<0:\\n        path cc,cd,ce;\\n        cd=(unitsquare xscaled (2*u) yscaled (abs(nb)*u)) shifted(u*(PapierLargeur-2,0));\\n        ce=(unitsquare scaled (1*u)) shifted(u*(PapierLargeur-1.5,1));\\n        cc=(unitsquare xscaled (4*u) yscaled (1*u)) shifted(u*(PapierLargeur-7,1));\\n        fill cd withcolor PapierCouleur;\\n        fill ce withcolor white;\\n        fill cc withcolor white;\\n        draw cc;\\n        draw cd;\\n        draw ce;\\n        draw polygone((0,0),(PapierLargeur*u,0),u*(PapierLargeur,abs(nb)),u*(0,abs(nb)));\\n        if score>0:\\n          label.bot(TEX(\\\"\\\\PfMScore{\\\"&decimal(score)&\\\"}\\\"),u*(PapierLargeur-1,1));\\n        fi;\\n      fi;  \\n    );\\n    PapierSeyes\\n  enddef;\\n}%\\n\\n\\\\def\\\\PfMPapierSeyes#1#2{%\\n  \\\\begin{center}\\n    \\\\ifluatex%\\n      \\\\mplibforcehmode%\\n      \\\\begin{mplibcode}%\\n        \\\\PfMMPSeyesCode\\n        trace Seyes(#1,#2);\\n      \\\\end{mplibcode}%\\n    \\\\else%\\n      \\\\begin{mpost}[mpsettings={\\\\PfMMPSeyesCode}]%\\n        trace Seyes(#1,#2);\\n      \\\\end{mpost}\\n    \\\\fi%\\n  \\\\end{center}\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMJusteAvantLaFinDesExercices{}{%\\n  \\\\ifboolKV[ClesExercices]{Interieur}{%\\n    \\\\ifboolKV[ClesExercices]{Ligne}{%\\n      \\\\vspace*{\\\\PfMEspaceAvantLignes}\\\\par%\\n      \\\\PfMSetStretch%\\n      \\\\PfMLignespointilles{\\\\useKV[ClesExercices]{Lignes}}%\\n      \\\\par\\\\vspace*{\\\\PfMEspaceApresLignes}\\\\par%\\n    }{}%\\n    \\\\par%\\n    \\\\ifboolKV[ClesExercices]{Cadres}{%\\n      \\\\begin{PfMtcbEncart}%\\n        % \\n      \\\\end{PfMtcbEncart}%\\n    }{}%\\n    \\\\ifboolKV[ClesExercices]{Grilles}{%\\n      \\\\ifboolKV[ClesExercices]{Cinq}{%\\n        \\\\PfMPapierCinqCinq{\\\\useKV[ClesExercices]{CinqCinq}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n      \\\\ifboolKV[ClesExercices]{Huit}{%\\n        \\\\PfMPapierSeyes{\\\\useKV[ClesExercices]{Seyes}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n    }{}%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMApresLesExercices{}{%\\n    \\\\ifboolKV[ClesExercices]{Interieur}{}{%\\n    \\\\ifboolKV[ClesExercices]{Ligne}{%\\n      \\\\vspace*{\\\\PfMEspaceAvantLignes}%\\n      \\\\PfMSetStretch\\\\PfMLignespointilles{\\\\useKV[ClesExercices]{Lignes}}%\\n      \\\\par\\\\vspace*{\\\\PfMEspaceApresLignes}\\\\par%\\n    }{}%\\n    \\\\par%\\n    \\\\ifboolKV[ClesExercices]{Cadres}{%\\n      \\\\begin{PfMtcbEncart}%\\n        % \\n      \\\\end{PfMtcbEncart}%\\n    }{}%\\n    \\\\ifboolKV[ClesExercices]{Grilles}{%\\n      \\\\ifboolKV[ClesExercices]{Cinq}{%\\n        \\\\PfMPapierCinqCinq{\\\\useKV[ClesExercices]{CinqCinq}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n      \\\\ifboolKV[ClesExercices]{Huit}{%\\n        \\\\PfMPapierSeyes{\\\\useKV[ClesExercices]{Seyes}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n    }{}\\n  }%\\n  \\\\ifboolKV[ClesExercices]{Profile}{\\\\PfMshowitems}{}%\\n  \\\\ifboolKV[ClesExercices]{ACompleter}{%\\n    \\\\IfHookExistsTF{env/center/begin}{\\\\RemoveFromHook{env/center/begin}[*]}{}%\\n    \\\\IfHookExistsTF{env/center/end}{\\\\RemoveFromHook{env/center/end}[*]}{}%\\n    \\\\IfHookExistsTF{env/itemize/begin}{\\\\RemoveFromHook{env/itemize/begin}[*]}{}%\\n    \\\\IfHookExistsTF{env/itemize/end}{\\\\RemoveFromHook{env/itemize/end}[*]}{}%\\n    \\\\IfHookExistsTF{env/description/begin}{\\\\RemoveFromHook{env/description/begin}[*]}{}%\\n    \\\\IfHookExistsTF{env/description/end}{\\\\RemoveFromHook{env/description/end}[*]}{}%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageTitreSolution{}{%\\n  %Affichage du titre de la solution :) Le compteur PfMExoSol vaut \\\\thePfMExoSol\\n  \\\\expandafter\\\\xdef\\\\csname PfMEcrireTitreSol\\\\endcsname{\\\\csname PfMTSol\\\\Roman{PfMExoSol}\\\\endcsname}%\\n  \\\\ifx\\\\bla\\\\PfMEcrireTitreSol\\\\bla%\\n  \\\\else\\n    ~:~\\\\PfMEcrireTitreSol%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixTitreSolution{}{%\\n  \\\\ifboolKV[ClesExercices]{TitreSol}{%\\n    %J'ai un titre  mettre  la solution.\\\\par LE compteur PfMExo vaut \\\\thePfMExo\\n    \\\\expandafter\\\\xdef\\\\csname PfMTSol\\\\Roman{PfMExo}\\\\endcsname{\\\\useKV[ClesExercices]{TitreSolution}}}{%\\n    %Je n'ai pas de titre  mettre  la solution.\\\\par%\\n    \\\\expandafter\\\\xdef\\\\csname PfMTSol\\\\Roman{PfMExo}\\\\endcsname{}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixNomCorrection{}{%\\n  \\\\expandafter\\\\xdef\\\\csname PfMTNomSol\\\\Roman{PfMExo}\\\\endcsname{\\\\useKV[ClesExercices]{TitreCorrige}}\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixHideItemSolution{}{%\\n  \\\\ifboolKV[ClesExercices]{Profile}{%\\n %   J'ai un lve  profil : Je dois me souvenir que la correction doit tre profile. Le compteur PfMExo vaut \\\\thePfMExo\\n    \\\\expandafter\\\\xdef\\\\csname PfMHideSol\\\\Roman{PfMExo}\\\\endcsname{A}}{%\\n    %Je n'ai pas d'lve  profil\\n    \\\\expandafter\\\\xdef\\\\csname PfMHideSol\\\\Roman{PfMExo}\\\\endcsname{}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageHideItemSolution{}{%\\n  \\\\expandafter\\\\xdef\\\\csname PfMEcrireHideItemSol\\\\endcsname{\\\\csname PfMHideSol\\\\Roman{PfMExoSol}\\\\endcsname}%\\n  \\\\ifx\\\\bla\\\\PfMEcrireHideItemSol\\\\bla%\\n%    \\\\textcolor{blue}{Normalement, pas de hide car cl profile pas active.}\\n  \\\\else\\n%    \\\\textcolor{red}{Hide Item dans les solutions}\\n    \\\\PfMhideitems%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAvantLesExercices{}{%\\n  \\\\ifboolKV[ClesExercices]{AvecIndications}{\\\\setcounter{RetiensIndic}{1}}{}%\\n  \\\\ifboolKV[ClesExercices]{Profile}{\\\\PfMhideitems}{}%\\n  \\\\refstepcounter{PfMSection}%\\n  \\\\PfMChoixCorrection%\\n  \\\\PfMChoixEntrainement%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixNomCorrection%\\n  \\\\ifboolKV[ClesExercices]{ACompleter}{%\\n    \\\\let\\\\oldenumerate\\\\enumerate%\\n    \\\\let\\\\oldendenumerate\\\\endenumerate%\\n    \\\\let\\\\enumerate\\\\autoenumerate%\\n    \\\\let\\\\endenumerate\\\\endautoenumerate%\\n    \\\\AddToHook{env/center/begin}[Bcenter]{\\\\let\\\\item\\\\olditem}%\\n    \\\\AddToHook{env/center/end}[Ecenter]{\\\\let\\\\item\\\\litem}%\\n    \\\\AddToHook{env/description/begin}[Bdescription]{\\\\let\\\\item\\\\olditem}%\\n    \\\\AddToHook{env/description/end}[Edescription]{\\\\let\\\\item\\\\litem}%\\n    \\\\AddToHook{env/itemize/begin}[Bitemize]{\\\\let\\\\item\\\\olditem}%\\n    \\\\AddToHook{env/itemize/end}[Eitemize]{\\\\let\\\\item\\\\litem}%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceFiche}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n    \\\\colorlet{PfMCadreFiche}{\\\\useKV[ClesExercices]{Cadre}}%\\n    \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n    \\\\PfMAvantLesExercices%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n      \\\\PfMChoixTitreSolution%\\n      \\\\PfMChoixHideItemSolution%\\n      \\\\begin{tcolorbox}[%\\n        tikzfiche,\\n        label is label,\\n        label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n        ]\\n        \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n        \\\\end{tcolorbox}%\\n        \\\\PfMApresLesExercices%\\n      }%\\n    }%\\n}%\\n\\n% \\\\makeatletter\\n\\\\NewDocumentCommand\\\\TikzOlympiadesAPMEP{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[OlympiadesAPMEP]{#1}%\\n  \\\\begin{tcolorbox}[colback=colLogo]\\n    \\\\begin{Dispo}*{\\\\normalsize\\\\logoapmep{\\\\scale@logo}}\\n      \\\\Large\\\\sffamily \\\\useKV[OlympiadesAPMEP]{Theme}\\n    \\\\end{Dispo}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzOlympiadesAPMEPCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[OlympiadesAPMEP]{#1}%\\n  \\\\begin{tcolorbox}[colback=colLogo]\\n    \\\\begin{Dispo}*{\\\\normalsize\\\\logoapmep{\\\\scale@logo}}\\n      \\\\Large\\\\sffamily \\\\useKV[OlympiadesAPMEP]{Theme}\\n\\n      (Correction)%\\n    \\\\end{Dispo}\\n  \\\\end{tcolorbox}%\\n}%\\n%\\\\makeatother\\n\\n\\\\NewDocumentEnvironment{exerciceOlympiadesAPMEP}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n    \\\\PfMAvantLesExercices%\\n%    \\\\refstepcounter{PfMSection}%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n    \\\\PfMChoixTitreSolution%\\n    \\\\PfMChoixHideItemSolution%\\n    \\\\begin{tcolorbox}[%\\n      tikzOlympiadesAPMEP,\\n      label is label,\\n      label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n      ]\\n      \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n        \\\\end{tcolorbox}%\\n        \\\\PfMApresLesExercices%\\n      }%\\n    }%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceDS}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\PfMAvantLesExercices\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n      \\\\PfMChoixTitreSolution%\\n      \\\\immediate\\\\write\\\\@auxout{%\\n        \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n      }\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n        \\\\immediate\\\\write\\\\@auxout{%\\n          \\\\string\\\\opcopy{0}{total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n        }}{}\\n      \\\\begin{tcolorbox}[%\\n        tikzds,\\n        label is label,\\n        label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n        ]\\n        \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n      \\\\end{tcolorbox}%\\n      \\\\PfMApresLesExercices%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{ExerciceRecapBrevet}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n  \\\\colorlet{PfMCadreFiche}{\\\\useKV[ClesExercices]{Cadre}}%\\n  \\\\refstepcounter{PfMSection}%\\n  \\\\PfMChoixCorrection%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n    \\\\immediate\\\\write\\\\@auxout{%\\n      \\\\string\\\\opcopy{0}{total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n    }%\\n  }{}%\\n  \\\\begin{tcolorbox}[%\\n  tikzrecapbrevet,\\n  label is label,\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n  ]\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }{%\\n    \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}\\n  \\\\PfMApresLesExercices%\\n}%\\n\\n\\\\makeatother\\n\\n%%% Recap Brevet\\n%%% Style Brevet\\n\\\\tcbset{%\\n  userbrevet/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userbrevetcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n% Fiche Exercice Brevet\\n\\\\newcommand\\\\TikzRecapBrevet{%\\n\\\\begin{tcolorbox}[userbrevet]%\\n  \\\\Large\\\\sffamily \\\\useKV[RecapBrevet]{Theme}%\\n  \\\\par{\\\\tiny\\\\useKV[RecapBrevet]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[RecapBrevet]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\newcommand\\\\TikzRecapBrevetCor[1]{%\\n  \\\\clearpage\\n  \\\\setKV[RecapBrevet]{#1}%\\n  \\\\begin{tcolorbox}[userbrevetcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[RecapBrevet]{Theme} (Correction)\\n    \\\\par{\\\\tiny\\\\useKV[RecapBrevet]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[RecapBrevet]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzrecapbrevet/.style={%\\n    before skip=1em,%\\n    enhanced,%\\n    breakable,%\\n    colback=white,%\\n    colframe=PfMCadreFiche,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,%\\n      fill=white,%\\n      anchor=west,%\\n      xshift=10pt,%\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[Fiche]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};%\\n      %%\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{\\\\node[%\\n      fill=white,%\\n      anchor=east,%\\n      xshift=-10pt,%\\n      text=black,%\\n      font=\\\\bfseries%\\n      ]\\n      at (frame.north east)%\\n      {\\\\footnotesize\\\\sffamily \\\\total{\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}};%\\n      }{}%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n%% PDT\\n\\\\tcbset{%\\n  tikzpdt/.style={%\\n    top=\\\\ifboolKV[ClesExercices]{PasTitre}{0mm}{2mm},bottom=0mm,left=0mm,right=0mm,%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=blue!50,\\n    remember,\\n    overlay unbroken and first={%\\n      \\\\coordinate[xshift=2pt,yshift=-2pt] (NO-\\\\thePfMExo) at (frame.north west);%\\n      \\\\coordinate[xshift=-2pt,yshift=-2pt] (NE-\\\\thePfMExo) at (frame.north east);%\\n      \\\\coordinate[xshift=-2pt,yshift=2pt] (SE-\\\\thePfMExo) at (frame.south east);%\\n      \\\\coordinate[xshift=2pt,yshift=2pt] (SO-\\\\thePfMExo) at (frame.south west);%\\n      \\\\coordinate (N-\\\\thePfMExo) at (frame.north);\\n      \\\\coordinate (S-\\\\thePfMExo) at (frame.south);\\n      \\\\coordinate (E-\\\\thePfMExo) at (frame.east);\\n      \\\\coordinate (O-\\\\thePfMExo) at (frame.west);\\n      \\\\ifboolKV[ClesExercices]{PasTitre}{%\\n        \\\\coordinate[xshift=10pt] (A) at (frame.north west);\\n      }{%\\n        \\\\node[%\\n        name=A,\\n        fill=white,\\n        anchor=west,\\n        xshift=10pt,\\n        ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[PdT]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      }\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %% \\n      \\\\PfMAffichageLogos%\\n      %\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n    }%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userpdt/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userpdtcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzPdT{}{%\\n  \\\\begin{tcolorbox}[userpdt]%\\n    \\\\Large\\\\sffamily \\\\useKV[PdT]{Theme}\\\\hfill\\\\useKV[PdT]{Niveau} \\\\useKV[PdT]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[PdT]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[PdT]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzPdTCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[PdT]{#1}%\\n  \\\\begin{tcolorbox}[userpdtcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[PdT]{Theme} (Correction) \\\\hfill\\\\useKV[PdT]{Niveau} \\\\useKV[PdT]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[PdT]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[PdT]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\newenvironment{exercicePdT}[1][]{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\refstepcounter{PfMSection}%\\n  \\\\PfMChoixCorrection%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\tcolorbox[%\\n  tikzpdt,\\n  label is label,\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n  ]%\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{SOS}[1][]{%\\n  \\\\stepcounter{PfMSOS}%\\n  \\\\tcolorbox[%\\n  enhanced,\\n  remember,%\\n  tikzsos,\\n  overlay unbroken and first={%\\n    \\\\coordinate[xshift=2pt,yshift=-2pt] (SOS-NO-\\\\thePfMSOS) at (frame.north west);%\\n    \\\\coordinate[xshift=-2pt,yshift=-2pt] (SOS-NE-\\\\thePfMSOS) at (frame.north east);%\\n    \\\\coordinate[xshift=-2pt,yshift=2pt] (SOS-SE-\\\\thePfMSOS) at (frame.south east);%\\n    \\\\coordinate[xshift=2pt,yshift=2pt] (SOS-SO-\\\\thePfMSOS) at (frame.south west);%\\n    \\\\coordinate (SOS-N-\\\\thePfMSOS) at (frame.north);\\n    \\\\coordinate (SOS-S-\\\\thePfMSOS) at (frame.south);\\n    \\\\coordinate (SOS-E-\\\\thePfMSOS) at (frame.east);\\n    \\\\coordinate (SOS-O-\\\\thePfMSOS) at (frame.west);\\n  }%\\n  ]%\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\tikzstyle{cheminPdT}=[-stealth]\\n\\n\\\\NewDocumentCommand\\\\CheminVrai{m}{%\\n  \\\\setsepchar[*]{,*/}%\\n  \\\\readlist*\\\\ListeCheminVrai{#1}%\\n  \\\\setsepchar{,}%\\n  \\\\begin{tikzpicture}[remember picture,overlay]%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeCheminVrai{%\\n      \\\\draw[cheminPdT] (\\\\ListeCheminVrai[\\\\compteurcnt,1]) to node[midway]{\\\\Large \\\\RKbigsmile}(\\\\ListeCheminVrai[\\\\compteurcnt,2]);%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\CheminNeutre{m}{%\\n  \\\\setsepchar[*]{,*/}%\\n  \\\\readlist*\\\\ListeCheminVrai{#1}%\\n  \\\\setsepchar{,}%\\n  \\\\begin{tikzpicture}[remember picture,overlay]%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeCheminVrai{%\\n      \\\\draw[cheminPdT] (\\\\ListeCheminVrai[\\\\compteurcnt,1]) to (\\\\ListeCheminVrai[\\\\compteurcnt,2]);%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\CheminFaux{m}{%\\n  \\\\setsepchar[*]{,*/}%\\n  \\\\readlist*\\\\ListeCheminVrai{#1}%\\n  \\\\setsepchar{,}%\\n  \\\\begin{tikzpicture}[remember picture,overlay]%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeCheminVrai{%\\n      \\\\draw[cheminPdT] (\\\\ListeCheminVrai[\\\\compteurcnt,1]) to node[midway]{\\\\Large \\\\RKdevilish}(\\\\ListeCheminVrai[\\\\compteurcnt,2]);%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\tcbset{%\\n  tikzsos/.style={%\\n    left=0pt,right=0pt,top=0pt,bottom=0pt,%\\n    colback=Crimson!15,%\\n    colframe=Crimson!50,%\\n  }%\\n}%\\n\\n%% Kholle\\n\\\\tcbset{%\\n  tikzkholle/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=gray!50,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\ifboolKV[ClesExercices]{AffichageTitre}{%\\n          {\\\\bfseries\\\\sffamily\\\\useKV[ClesExercices]{Titre}}%\\n        }{\\\\bfseries\\\\sffamily Exercice \\\\thePfMExo}%\\n        \\\\xintifboolexpr{\\\\useKV[ClesExercices]{Difficulte}<1}{}{%\\n          ~(\\\\foreach \\\\s in {1,...,\\\\useKV[ClesExercices]{Difficulte}}{%\\n            $\\\\star$%\\n          })%\\n        }\\n      }\\n      ;\\n      %%\\n      \\\\PfMAffichageSource%\\n    }%\\n  }%\\n}%\\n\\n\\\\newenvironment{CRNote}{%\\n  \\\\tcolorbox[colback=white,height=2cm,title=NOTE,fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white,enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      anchor=east,\\n      yshift=-8pt,\\n      xshift=-10pt,\\n      text=black,\\n      ]\\n      at (frame.north east)\\n      {\\\\sffamily\\\\bfseries \\\\useKV[Kholle]{NomEleve}};\\n      \\\\node[%\\n      anchor=center,\\n      yshift=-8pt,\\n      text=black,\\n      ]\\n      at (frame.north)\\n      {\\\\sffamily\\\\bfseries \\\\useKV[Kholle]{Date}};\\n    }\\n    ]%\\n  }{%\\n  \\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{CRRemarque}{%\\n  \\\\tcolorbox[colback=white,height=\\\\CRRHauteur,title=REMARQUE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n  ]}\\n{%\\n  \\\\endtcolorbox%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceKholle}{o}{%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMChoixCorrection%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\tcolorbox[%\\n  tikzkholle,\\n  label is label,\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n  ]\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{exerciceBase}[1][]{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]\\n  \\\\setKV[ClesExercices]{#1}\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}\\n  \\\\refstepcounter{PfMExo}\\n  \\\\tcolorbox[%\\n  tikzbase\\n  ]\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{exerciceBaseHTML}[1][]{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]\\n  \\\\setKV[ClesExercices]{#1}\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}\\n  \\\\refstepcounter{PfMExo}\\n  \\\\tcolorbox[%\\n  standard jigsaw, opacityback=0,\\n  lowerbox=ignored,\\n  tikzbasehtml\\n  ]\\n}{\\\\endtcolorbox%\\n}\\n\\n%Alias pour tous les exercices.\\n\\\\NewDocumentEnvironment{exercice}{}{}{}%\\n\\\\NewDocumentEnvironment{Exercice}{}{}{}%\\n\\n%%%%%%%%% STyle Kholle%%%%%%%%%%\\n% Kholle\\n\\\\tcbset{%\\n  userkholle/.style={%\\n    frame hidden,colback=white,enhanced,%\\n    borderline north={3pt}{0pt}{gray!85},\\n    borderline north={2pt}{0.5pt}{gray!15},\\n    borderline south={3pt}{0pt}{gray!85},\\n    borderline south={2pt}{0.5pt}{gray!15}\\n  }%\\n}%\\n\\n\\\\newcommand\\\\TikzKholle{%\\n  \\\\clearpage\\n  \\\\begin{tcolorbox}[userkholle]%\\n    \\\\sffamily Interrogation Orale \\\\useKV[Kholle]{Numero}\\\\hfill\\n    \\\\ifboolKV[Kholle]{CR}{}{Sujet \\\\useKV[Kholle]{Sujet}\\\\hfill}\\\\useKV[Kholle]{Niveau}%\\n    \\\\par\\\\useKV[Kholle]{Lieu}\\\\hfill Le \\\\useKV[Kholle]{Date}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\newcommand\\\\TikzKholleCor[1]{%\\n  \\\\clearpage\\n  \\\\setKV[Kholle]{#1}\\n  \\\\begin{tcolorbox}[colback=white,height=2cm,title=NOTE,fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white,enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      anchor=east,\\n      yshift=-8pt,\\n      xshift=-10pt,\\n      text=black,\\n      ]\\n      at (frame.north east)\\n      {\\\\sffamily\\\\bfseries Nom : \\\\hbox to5cm{}};\\n      \\\\node[%\\n      anchor=center,\\n      yshift=-8pt,\\n      text=black,\\n      ]\\n      at (frame.north)\\n      {\\\\sffamily\\\\bfseries \\\\useKV[Kholle]{Date}};\\n    }\\n    ]%\\n  \\\\end{tcolorbox}%\\n  \\\\begin{tcolorbox}[colback=white,height=2cm,title=EXERCICE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n    ]%\\n  \\\\end{tcolorbox}%\\n  \\\\begin{tcolorbox}[colback=white,height=\\\\textheight-5cm,title=REMARQUE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n    ]%\\n  \\\\end{tcolorbox}%\\n}\\n\\n%%%%%%%%%% Style DM%%%%%%%%%%%%%\\n\\\\tcbset{%\\n  userdm/.style={%\\n    frame hidden,colback=white,enhanced,%\\n    borderline north={3pt}{0pt}{gray!85},%\\n    borderline north={2pt}{0.5pt}{gray!15},%\\n    borderline south={3pt}{0pt}{gray!85},%\\n    borderline south={2pt}{0.5pt}{gray!15}%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userdmcor/.style={%\\n    colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzDM{}{%\\n  \\\\clearpage%\\n  \\\\begin{tcolorbox}[userdm]%\\n    \\\\sffamily Devoir en temps libre \\\\useKV[DM]{Numero}\\\\hfill\\\\useKV[DM]{Niveau} \\\\useKV[DM]{Classe}%\\\\no\\n    \\\\par{\\\\tiny\\\\useKV[DM]{Code}}\\\\hfill{\\\\scriptsize Pour le \\\\useKV[DM]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzDMCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[DM]{#1}%\\n  \\\\begin{tcolorbox}[colback=white,height=\\\\PfMHauteurAppreciation,title=APPR\\\\'ECIATION,fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white,enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      inner sep=0pt,\\n      fill=white,\\n      anchor=east,\\n      yshift=-9pt,\\n      xshift=-10pt,\\n      text=black,\\n      ]\\n      at (frame.north east)\\n      {\\\\scriptsize\\\\sffamily\\\\bfseries \\\\useKV[DM]{Code}};\\n    }\\n    ]%\\n  \\\\end{tcolorbox}%\\n  \\\\begin{tcolorbox}[colback=white,height=\\\\PfMHauteurRemarque,title=CONSEIL(S) / REMARQUE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n    ]%\\n  \\\\end{tcolorbox}%\\n}\\n%%% Style Cours\\n\\\\tcbset{\\n  usercours/.style={\\n    enhanced,\\n  skin=enhancedlast jigsaw,\\n  attach boxed title to top left={xshift=-4mm,yshift=-0.5mm},\\n  fonttitle=\\\\bfseries\\\\sffamily,\\n  colbacktitle=blue!45,\\n  colframe=red!50!black,\\n  interior style={\\n    top color=blue!10,\\n    bottom color=red!10\\n  },\\n  boxed title style={\\n    empty,\\n    arc=0pt,\\n    outer arc=0pt,\\n    boxrule=0pt\\n  },\\n  underlay boxed title={\\n    \\\\fill[blue!45!white] \\n      (title.north west) -- \\n      (title.north east) -- \\n      +(\\\\tcboxedtitleheight-1mm,-\\\\tcboxedtitleheight+1mm) -- \\n      ([xshift=4mm,yshift=0.5mm]frame.north east) -- \\n      +(0mm,-1mm) -- \\n      (title.south west) -- cycle;\\n    \\\\fill[blue!45!white!50!black] \\n      ([yshift=-0.5mm]frame.north west) -- \\n      +(-0.4,0) -- \\n      +(0,-0.3) -- cycle;\\n    \\\\fill[blue!45!white!50!black] \\n      ([yshift=-0.5mm]frame.north east) -- \\n      +(0,-0.3) -- \\n      +(0.4,0) -- cycle; \\n  },\\n  title={\\\\useKV[Cours]{Theme}},\\n}\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzCours{}{%\\n  \\\\begin{tcolorbox}[usercours]%\\n%    \\\\Large\\\\sffamily\\\\bfseries  Cours : \\\\useKV[Fiche]{Theme}%\\n%    \\\\useKV[Fiche]{Niveau}~\\\\useKV[Fiche]{Classe}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n%%%%%% Style Fiche\\n\\\\tcbset{%\\n  userfiche/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userfichecor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzFiche{}{%\\n  \\\\begin{tcolorbox}[userfiche]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme}\\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzFicheCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Fiche]{#1}%\\n  \\\\begin{tcolorbox}[userfichecor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme} (Correction) \\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzFicheCorRep{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Fiche]{#1}%\\n  \\\\begin{tcolorbox}[userfichecor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme} (Rponses) \\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzFicheCorInd{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Fiche]{#1}%\\n  \\\\begin{tcolorbox}[userfichecor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme} (Indices) \\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzfiche/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=ColExoFiche,\\n    colframe=PfMCadreFiche,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=ColExoFiche,\\n      anchor=west,\\n      xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily\\\\useKV[Fiche]{NomExercice}\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\ifboolKV[ClesExercices]{Numerote}{~:~}{\\\\xdef\\\\PfMTitiLgNE{\\\\useKV[Fiche]{NomExercice}}\\\\IfStrEq{\\\\PfMTitiLgNE}{}{}{~:~}}\\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %% \\n      \\\\PfMAffichageLogos%\\n      %\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %\\n      \\\\PfMAffichageSource%\\n      % Lien vers la solution\\n      \\\\PfMLienVersSolution\\n      % Lien vers les entrainements\\n      \\\\PfMLienVersEntrainement\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzOlympiadesAPMEP/.style={%\\n    top=10pt,\\n    left=0mm,right=0mm,\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=ColExoFiche,\\n    frame hidden,\\n    overlay unbroken and first={%\\n      \\\\draw[colLogo,line width=1pt] ([yshift=-12pt]frame.north west)--([yshift=-12pt]frame.north east);\\n      \\\\node[%\\n      name=A,\\n      fill=ColExoFiche,\\n      anchor=west,\\n      xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\color{colLogo}\\\\resizebox{1em}{!}{\\\\carreEntoure{}}~\\\\Large\\\\bfseries\\\\sffamily\\\\useKV[Fiche]{NomExercice}\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\ifboolKV[ClesExercices]{Numerote}{.~}{\\\\xdef\\\\PfMTitiLgNE{\\\\useKV[Fiche]{NomExercice}}\\\\IfStrEq{\\\\PfMTitiLgNE}{}{}{.~}}\\\\useKV[ClesExercices]{Titre}}{}};\\n      \\\\node[%\\n      name=B,\\n      fill=ColExoFiche,\\n      anchor=east,\\n      xshift=-\\\\kvtcb@leftlower,\\n      ] at (frame.north east){\\\\color{colLogo}\\\\Large\\\\bfseries\\\\sffamily\\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Categorie}}=1\\\\relax\\n          Spcialistes%\\n        \\\\else\\n          \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Categorie}}=2\\\\relax\\n            Non spcialistes\\n          \\\\fi\\n        \\\\fi};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos%\\n      %\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %\\n      \\\\PfMAffichageSource%\\n      % Lien vers la solution\\n      \\\\PfMLienVersSolution\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n%%% Parcours %%%\\n\\\\tcbset{%\\n  userparcours/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userparcourscor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzParcours{}{%\\n  \\\\begin{tcolorbox}[userparcours]%\\n    \\\\Large\\\\sffamily \\\\useKV[Parcours]{Theme}\\\\hfill\\\\useKV[Parcours]{Niveau} \\\\useKV[Parcours]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[Parcours]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Parcours]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzParcoursCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Parcours]{#1}%\\n  \\\\begin{tcolorbox}[userparcourscor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Parcours]{Theme} (Correction) \\\\hfill\\\\useKV[Parcours]{Niveau} \\\\useKV[Parcours]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Parcours]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Parcours]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\tcbset{%\\n  tikzparcours/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=PfMCadreParcours,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[Parcours]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos%\\n      %%\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %%\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n      %\\n      \\\\PfMLienVersEntrainement%\\n    }%\\n  }%\\n}%\\n%% Fin Parcours %%%\\n%%% DS %%%\\n\\\\tcbset{%\\n  userds/.style={%\\n    colback=gray!5,%\\n    enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[DS]{Calculatrice}{autorise}{interdite} --};\\n    }%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userdscor/.style={%\\n    colback=gray!5%\\n  }%\\n}%\\n\\n\\n\\\\newcommand\\\\TikzDS{%\\n  \\\\clearpage\\n  \\\\begin{tcolorbox}[userds]%\\n    \\\\sffamily Devoir surveill \\\\useKV[DS]{Numero} (Sujet \\\\useKV[DS]{Sujet})\\\\hfill\\\\useKV[DS]{Niveau} \\\\useKV[DS]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[DS]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[DS]{Date}}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzDSCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[DS]{#1}%\\n  \\\\begin{tcolorbox}[userdscor]%\\n    \\\\sffamily Devoir surveill \\\\useKV[DS]{Numero} (Sujet \\\\useKV[DS]{Sujet})\\\\hfill\\\\useKV[DS]{Niveau} \\\\useKV[DS]{Classe}%\\n    \\\\par Correction%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzds/.style={%\\n    enhanced,\\n    breakable,\\n    before skip=2mm,after skip=2mm,\\n    colback=white,\\n    attach boxed title to top left={xshift=1cm,yshift*=1mm-\\\\tcboxedtitleheight},\\n    varwidth boxed title*=-3cm,\\n    boxed title style={frame code={\\n        \\\\path[fill=tcbcolback!30!black]\\n        ([yshift=-1mm,xshift=-1mm]frame.north west)\\n        arc[start angle=0,end angle=180,radius=1mm]\\n        ([yshift=-1mm,xshift=1mm]frame.north east)\\n        arc[start angle=180,end angle=0,radius=1mm];\\n        \\\\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,\\n        middle color=tcbcolback!80!black]\\n        ([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)\\n        [rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)\\n        -- (frame.south east) -- (frame.south west)\\n        -- ([xshift=-1mm,yshift=-1mm]frame.north west)\\n        [sharp corners]-- cycle;\\n      },interior engine=empty,\\n    },\\n    fonttitle=\\\\bfseries\\\\sffamily,\\n    title=Exercice\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{},\\n    overlay unbroken and first={%\\n      %\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n        \\\\node[\\n        fill=white,\\n        anchor=east,\\n        xshift=-10pt,\\n        text=black,\\n        font=\\\\bfseries\\n        ]\\n        at (frame.north east)\\n        {\\\\footnotesize\\\\sffamily \\\\total{\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}};\\n      }{}\\n      \\\\PfMLienVersSolution%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n% Interrogations crites\\n\\\\tcbset{%\\n  userie/.style={%\\n  colback=gray!5,\\n  enhanced,%\\n  overlay unbroken and first={%\\n    \\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[IE]{Calculatrice}{autorise}{interdite} --};\\n    }%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  useriecor/.style={%\\n  colback=gray!5,\\n  enhanced,%\\n  overlay unbroken and first={%\\n    \\\\node[yshift=1em] at (frame.south) {\\n      \\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[IE]{Calculatrice}{autorise}{interdite} --\\n      };%\\n    }%\\n  }%\\n}%\\n\\\\newcommand\\\\TikzIE{%\\n  \\\\clearpage\\n  \\\\begin{minipage}{0.6\\\\linewidth}\\n    \\\\begin{tcolorbox}[userie]%\\n      \\\\sffamily \\\\useKV[IE]{Nom} \\\\useKV[IE]{Numero} : \\\\useKV[IE]{Theme} \\\\ifboolKV[IE]{Sujets}{{\\\\scriptsize(Sujet \\\\useKV[IE]{Sujet})}}{}\\n      \\\\vspace{1em}\\n      \\\\par{\\\\tiny\\\\useKV[IE]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[IE]{Date}}\\n    \\\\end{tcolorbox}%\\n  \\\\end{minipage}\\\\hfill\\\\begin{minipage}{0.35\\\\linewidth}\\n    Nom : \\\\PfMIENom\\\\\\\\[0.5em]\\n    Prnom : \\\\PfMIEPrenom\\\\\\\\[0.5em]\\n    Classe : \\\\PfMIEClasse%\\n  \\\\end{minipage}%\\n  \\\\par\\\\bigskip%\\n}%\\n\\n\\\\newcommand\\\\TikzIECor[1]{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[IE]{#1}%\\n  \\\\begin{tcolorbox}[useriecor]%\\n    \\\\sffamily \\\\useKV[IE]{Nom} \\\\useKV[IE]{Numero} : \\\\useKV[IE]{Theme} \\\\ifboolKV[IE]{Sujets}{\\\\scriptsize(Sujet \\\\useKV[IE]{Sujet})}{}\\\\hfill Correction%\\n    \\\\par{\\\\tiny\\\\useKV[IE]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[IE]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMRecapitulatif{mm}{%\\n  \\\\setKV[Boulot]{#1}%\\n  \\\\setcounter{PfMRetiensMapourPP}{\\\\thePfMMaquette}%\\n  \\\\DTLforeach*{dataperso}{\\\\Prenom=PrenomEleve,\\\\Nom=NomEleve,\\\\RecapListeExo=ListeExo}{%\\n    \\\\ifboolKV[Boulot]{Dys}{%\\n      \\\\begin{Maquette}[Fiche,Dys]{#2,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n    }{%\\n      \\\\begin{Maquette}[Fiche]{#2,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n    }%\\n    \\\\readlist*\\\\ListeExercices{\\\\RecapListeExo}%\\n    \\\\ifnum\\\\fpeval{\\\\ListeExerciceslen}=1\\\\relax{}\\n      \\\\setKVdefault[ClesExercices]{Numerote=false}\\n      \\\\input{\\\\jobname-Ma\\\\thePfMRetiensMapourPP-PPEx\\\\ListeExercices[1].tex}%\\n      \\\\setKVdefault[ClesExercices]{Numerote}\\n    \\\\else\\n      \\\\foreach\\\\i in{1,...,\\\\ListeExerciceslen}{%\\n        \\\\input{\\\\jobname-Ma\\\\thePfMRetiensMapourPP-PPEx\\\\ListeExercices[\\\\i].tex}%\\n      }\\n    \\\\fi\\n    \\\\ifnum\\\\thePfMCorrigeParcoursPerso=1\\\\relax%\\n      % \\\\RecapitulatifCorrection{#2}%\\n      \\\\clearpage\\n      \\\\TikzFicheCor{#1,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n      \\\\readlist*\\\\ListeExercices{\\\\RecapListeExo}%\\n      \\\\ifnum\\\\fpeval{\\\\ListeExerciceslen}=1\\\\relax{}\\n        \\\\textbf{Corrig de l'exercice} : \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\ListeExercices[1].sol}\\\\par\\\\goodbreak%\\n      \\\\else\\n        \\\\foreach\\\\i in{1,...,\\\\ListeExerciceslen}{%\\n          \\\\textbf{Corrig de l'exercice \\\\i} : \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\ListeExercices[\\\\i].sol}\\\\par\\\\goodbreak%\\n        }%\\n      \\\\fi%\\n    \\\\fi%\\n  \\\\end{Maquette}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RecapitulatifCorrection{m}{%\\n  \\\\DTLforeach*{dataperso}{\\\\Prenom=PrenomEleve,\\\\Nom=NomEleve,\\\\RecapListeExo=ListeExo}{%\\n    \\\\clearpage\\n    \\\\TikzFicheCor{#1,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n    \\\\readlist*\\\\ListeExercices{\\\\RecapListeExo}%\\n    \\\\foreach\\\\i in{1,...,\\\\ListeExerciceslen}{%\\n      \\\\IfFileExists{\\\\jobname-PPEx\\\\ListeExercices[\\\\i].sol}{\\\\textbf{Corrig de l'exercice \\\\i} : \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\ListeExercices[\\\\i].sol}\\\\par\\\\goodbreak}{}%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMFontDys{}{}%\\n\\\\NewDocumentCommand\\\\PfMFontNonDys{}{}%\\n\\n\\\\NewDocumentCommand\\\\PfMBasculeDys{}{%\\n  \\\\ifboolKV[Boulot]{Dys}{%\\n      % d'aprs \\\\url{https://culturedys.com/quelle-est-la-meilleure-police-pour-les-dyslexiques/}\\n    \\\\xdef\\\\PfMTaillePointDys{\\\\useKV[Boulot]{Taille}}%\\n    \\\\fontsize{\\\\PfMTaillePointDys}{\\\\fpeval{\\\\PfMTaillePointDys*1.2*1.5}}\\\\selectfont%\\n    \\\\raggedright%\\n    \\\\setlength{\\\\spaceskip}{\\\\PfMEcartSupInterMots+\\\\fontdimen2\\\\font}%\\n    \\\\PfMFontDys%\\n  }{%\\n    \\\\ifnum\\\\thePfMMaquette=1\\\\relax%\\n    \\\\else%\\n      \\\\fontsize{\\\\fpeval{10+\\\\PfMFontSize}}{\\\\fpeval{1.2*(10+\\\\PfMFontSize)}}%\\n      \\\\selectfont%\\n      \\\\renewcommand{\\\\JustifyingParindent}{\\\\parindent}\\n      \\\\justifying%\\n    \\\\fi%\\n    \\\\PfMFontNonDys%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChangerTailleCorrection{}{%\\n  \\\\ifboolKV[Boulot]{Small}{%\\n    \\\\small%\\n  }{%\\n    \\\\ifboolKV[Boulot]{Footnotesize}{%\\n      \\\\footnotesize\\n    }{%\\n      \\\\ifboolKV[Boulot]{Scriptsize}{%\\n        \\\\scriptsize\\n      }{}%\\n    }%\\n  }%\\n}%\\n\\n%% Pour factoriser l'appel aux corrections dans l'environnement Maquette\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\PfMPrepareCorrection{m}{%\\n  \\\\useKVdefault[Boulot]%\\n  \\\\setKV[Boulot]{#1}%\\n  \\\\if@CAN\\n    \\\\ifnum\\\\thepage<5\\\\relax\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{5-\\\\thepage}}}\\\\do{%\\n        ~\\\\clearpage%\\n      }%\\n    \\\\fi%\\n  \\\\fi%\\n  \\\\if@Dyslexie%\\n    \\\\setKV[Boulot]{Dys}%\\n  \\\\fi%\\n  \\\\PfMBasculeDys%\\n  \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{Epaisseur}}%\\n  \\\\PfMChangerTailleCorrection%\\n}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageCorrectionColonnes{}{%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n  \\\\PfMAffichageCorrige%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageEntrainementColonnes{}{%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n  \\\\PfMAffichageEntrainement%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n}%\\n\\n% GameBook\\n\\\\tcbset{%\\n  userlivreheros/.style={%\\n    spread upwards=-1cm,colback=Ivory,colframe=black!25!Ivory%\\n  }%\\n}%\\n\\n\\\\setKVdefault[LivreHeros]{Theme=Les nombres d\\\\'ecimaux}\\n\\n\\\\NewDocumentCommand\\\\vaen{m}{\\\\ref{#1}}%\\n\\n\\\\NewDocumentCommand\\\\TikzLivreHeros{}{%\\n  \\\\begin{tcolorbox}[userlivreheros]%\\n    \\\\begin{center}\\n      \\\\Large\\\\sffamily \\\\useKV[LivreHeros]{Theme}\\n      \\\\end{center}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\tcbset{%\\n  tikzLH/.style={%\\n    before skip=1em,\\n    enhanced,\\n    coltitle=black,\\n    colbacktitle=black!10!Ivory,\\n    colframe=white,\\n    colback=white,\\n    attach boxed title to top center={yshift=-2mm},\\n    label is label\\n  }%\\n}%\\n\\n\\\\newcounter{PfMGameBook}[PfMMaquette]\\n\\\\setcounter{PfMGameBook}{0}\\n\\n\\\\makeatletter\\n\\\\def\\\\ExoGBWrite{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\PfMChoixCorrection%\\n  \\\\stepcounter{PfMExo}%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n  }%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.gb\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{\\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endExoGBWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\\\makeatother\\n%%%%\\n\\n\\\\NewDocumentEnvironment{exerciceBeamer}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n    \\\\colorlet{PfMCadreFiche}{\\\\useKV[ClesExercices]{Cadre}}%\\n    \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n    \\\\PfMAvantLesExercices%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n      \\\\PfMChoixTitreSolution%\\n      \\\\PfMChoixHideItemSolution%\\n      \\\\begin{tcolorbox}[%\\n        tikzbeamer,\\n        label is label,\\n        label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n        ]\\n        \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n          \\\\PfMJusteAvantLaFinDesExercices%\\n        \\\\end{tcolorbox}%\\n        % \\\\ifboolKV[ClesExercices]{Profile}{\\\\PfMshowitems}{}%\\n        \\\\PfMApresLesExercices%\\n      }%\\n    }%\\n}%\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzbeamer/.style={%\\n    before skip=0.5em,\\n    enhanced,\\n    breakable,\\n    colback=white,%ColExoFiche,\\n    frame hidden,\\n    %colframe=PfMCadreFiche,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      anchor=center,\\n      xshift=8*\\\\kvtcb@leftlower/10,\\n      yshift=-10*\\\\kvtcb@leftlower/9,\\n      ] at (frame.north west){\\\\thePfMExo};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %% \\n      \\\\PfMAffichageSource%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n%%%%%%%%%%%%%%%%% AMC\\n\\n\\\\def\\\\PfMTexteAMC{\\\\scriptsize Pour chaque question, remplir avec un stylo {\\\\em noir} la case associe  {\\\\em l'unique} rponse correcte.\\\\par En cas d'erreur, {\\\\em ne redessiner pas} la case coche par erreur, mettez simplement un coup de  blanc  dessus.}\\n\\n\\\\newcommand\\\\TikzAMC{%\\n  \\\\begin{tcolorbox}[%\\n    colback=LightGray!10,\\n    colframe=LightGray,\\n    enhanced,%\\n    overlay unbroken and first={%\\n      \\\\ifboolKV[AMC]{Calculatrice}{\\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice autorise --};}{}%\\n    }%\\n    ]%\\n    \\\\sffamily \\\\useKV[AMC]{Theme}\\n    \\\\vspace{1em}\\n    \\\\par\\\\hfill{\\\\scriptsize\\\\useKV[AMC]{Date}}\\n  \\\\end{tcolorbox}%\\n  \\\\ifboolKV[Boulot]{IntroductionAMC}{\\\\PfMTexteAMC}{}%\\n  \\\\par\\\\bigskip%\\n}%\\n\\n\\\\newlength\\\\PfMAMCBarreFraction\\n\\\\makeatletter\\n\\n\\n\\\\setKVdefault[ListeReponses]{Lettre=x,Unites=false}\\n\\\\defKV[ListeReponses]{Unite=\\\\setKV[ListeReponses]{Unites}\\\\DeclareSIUnit{\\\\TempoAMC}{#1}}\\n\\n\\\\NewDocumentCommand\\\\ListeReponses{som}{%\\n  \\\\ifboolKV[Boulot]{AMC}{%\\n    \\\\useKVdefault[ListeReponses]%\\n    \\\\setKV[ListeReponses]{#2}%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeAMCRep{#3}%\\n    \\\\reademptyitems%\\n%    \\\\showitems\\\\ListeAMCRep[]\\n    \\\\setcounter{PfMAMCOpen}{1}%\\n    \\\\stepcounter{PfMNbListeReponsesAMC}%\\n    \\\\par\\n    \\\\ifnum\\\\fpeval{\\\\ListeAMCReplen}=1\\\\relax%\\n      % On teste la prsence de ! pour les fractions, de : pour l'criture ax+b, de ! pour une criture du style $a^p$ et de | pour les critures scientifiques.\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{/}[\\\\PfMAMCPresenceFraction]%\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{:}[\\\\PfMAMCPresenceLitteral]%\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{!}[\\\\PfMAMCPresencePuissances]%\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{|}[\\\\PfMAMCPresencePuissancesDix]%\\n      \\\\ifnum\\\\fpeval{\\\\PfMAMCPresenceFraction+\\\\PfMAMCPresenceLitteral+\\\\PfMAMCPresencePuissances+\\\\PfMAMCPresencePuissancesDix}=0\\\\relax\\n        \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\n          \\\\IfInteger{\\\\ListeAMCRep[1]}{%\\n            \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n            \\\\StrLen{\\\\fpeval{abs(\\\\Toto)}}[\\\\PfMLongueurCaseAMC]%\\n            \\\\IfBooleanTF{#1}{%\\n              \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\PfMLongueurCaseAMC,sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            }{%\\n              \\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\PfMLongueurCaseAMC,sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\n              \\\\end{minipage}\\\\ifboolKV[ListeReponses]{Unites}{~~~\\\\si[per-mode=symbol]{\\\\TempoAMC}}{}%\\n            }%\\n          }{%\\n            \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n            \\\\StrCut{\\\\Toto}{.}{\\\\TotoAv}{\\\\TotoAp}%\\n            \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCAv]%\\n            \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCAp]%\\n            \\\\IfBooleanTF{#1}{%\\n              \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCAv+\\\\PfMLongueurCaseAMCAp},decimals=\\\\PfMLongueurCaseAMCAp,sign,Tpoint={,},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            }{%\\n              \\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCAv+\\\\PfMLongueurCaseAMCAp},decimals=\\\\PfMLongueurCaseAMCAp,sign=false,Tpoint={,},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n              \\\\end{minipage}\\\\ifboolKV[ListeReponses]{Unites}{~~~\\\\si[per-mode=symbol]{\\\\TempoAMC}}{}%\\n            }%\\n          }%\\n        \\\\end{questionmultx}\\n      \\\\else\\n        %Fraction\\n        \\\\ifnum\\\\PfMAMCPresenceFraction=1\\\\relax%\\n          \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{/}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCNum]%\\n          \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCDeno]%\\n          \\\\IfBooleanTF{#1}{%\\n            \\\\AMCnumericChoices{\\\\TotoAv.\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCNum+\\\\PfMLongueurCaseAMCDeno},decimals=\\\\PfMLongueurCaseAMCDeno,sign,Tpoint={\\\\raisebox{0.25\\\\AMC@boxedheight}{\\\\rule{\\\\PfMAMCBarreFraction}{1pt}}},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n          }{%\\n            \\\\AMCnumericChoices{\\\\TotoAv.\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCNum+\\\\PfMLongueurCaseAMCDeno},decimals=\\\\PfMLongueurCaseAMCDeno,sign=false,Tpoint={\\\\raisebox{0.25\\\\AMC@boxedheight}{\\\\rule{\\\\PfMAMCBarreFraction}{1pt}}},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n          }%\\n          \\\\end{questionmultx}\\n        \\\\fi\\n        % Puissances\\n        \\\\ifnum\\\\PfMAMCPresencePuissances=1\\\\relax%\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{!}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCMant]%\\n          \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCPuis]%\\n          \\\\IfBooleanTF{#1}{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCMant},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCPuis},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}$\\n          }{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCMant},sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCPuis},sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}$\\n          }%\\n        \\\\fi\\n        % PuissancesDix\\n        \\\\ifnum\\\\PfMAMCPresencePuissancesDix=1\\\\relax%\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{|}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCMant]%\\n          \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCPuis]%\\n          \\\\StrCut{\\\\TotoAv}{.}{\\\\TotoAva}{\\\\TotoApa}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAva)}}[\\\\PfMLongueurCaseAMCManta]%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoApa)}}[\\\\PfMLongueurCaseAMCMantb]%\\n          \\\\IfBooleanTF{#1}{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCManta+\\\\PfMLongueurCaseAMCMantb},Tpoint={,},decimals=\\\\PfMLongueurCaseAMCMantb,sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\n              \\\\end{questionmultx}\\n            \\\\end{minipage}\\\\quad\\\\times10^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n             \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\PfMLongueurCaseAMCPuis,sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}\\n            $\\n          }{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCManta+\\\\PfMLongueurCaseAMCMantb},Tpoint={,},decimals=\\\\PfMLongueurCaseAMCMantb,sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\n              \\\\end{questionmultx}\\n            \\\\end{minipage}\\\\quad\\\\times10^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n             \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\PfMLongueurCaseAMCPuis,sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}\\n            $\\n          }%\\n        \\\\fi\\n        % Litteral\\n        \\\\ifnum\\\\PfMAMCPresenceLitteral=1\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{:}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCMono]%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAp)}}[\\\\PfMLongueurCaseAMCConst]%\\n          $\\n          \\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n            \\\\footnotesize%\\n            \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}%\\n              \\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCMono},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            \\\\end{questionmultx}%\\n          \\\\end{minipage}\\n          \\\\qquad\\\\useKV[ListeReponses]{Lettre}\\\\quad\\n          \\\\begin{minipage}{\\\\PfMAMCBarreFraction}%\\n            \\\\stepcounter{PfMNbListeReponsesAMC}\\\\footnotesize\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}%\\n              \\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCConst},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            \\\\end{questionmultx}%\\n          \\\\end{minipage}\\n          $\\n        \\\\fi\\n      \\\\fi\\n    \\\\else%\\n      \\\\begin{question}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\n        \\\\ifPfMDeuxColonnes\\n          \\\\begin{reponses}%\\n            \\\\bonne{\\\\ListeAMCRep[1]}%\\n            \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeAMCReplen}}\\\\do{%\\n              \\\\mauvaise{\\\\ListeAMCRep[##1]}%\\n            }%\\n          \\\\end{reponses}%\\n        \\\\else\\n          \\\\begin{reponseshoriz}%\\n            \\\\bonne{\\\\ListeAMCRep[1]}%\\n            \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeAMCReplen}}\\\\do{%\\n              \\\\mauvaise{\\\\ListeAMCRep[##1]}%\\n            }%\\n          \\\\end{reponseshoriz}%\\n        \\\\fi\\n        \\\\end{question}\\n      \\\\fi\\n  }{}%\\n}%\\n\\\\makeatother\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzamc/.style={%\\n    before skip=0em,\\n    bottom=0pt,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    frame hidden,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      %xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily\\\\useKV[AMC]{NomExercice}\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\ifboolKV[ClesExercices]{Numerote}{~:~}{\\\\xdef\\\\PfMTitiLgNE{\\\\useKV[Fiche]{NomExercice}}\\\\IfStrEq{\\\\PfMTitiLgNE}{}{}{~:~}}\\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n%      %% \\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\def\\\\PfMScoreA{5}%\\n\\\\def\\\\PfMScoreB{3}%\\n\\\\def\\\\PfMScoreC{1}%\\n\\\\def\\\\PfMScoreD{0.1}%\\n\\n\\\\NewDocumentEnvironment{exerciceAmc}{o}{%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  \\\\setcounter{PfMAMCOpen}{0}%\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\begin{tcolorbox}[tikzamc]%\\n  }{%\\n    \\\\ifnum\\\\thePfMAMCOpen=0\\\\relax\\n      \\\\PfMApresLesExercices\\n      \\\\par\\n      \\\\begin{question}{\\\\Roman{PfMExo}}\\n        \\\\AMCOpen{lineup=true,lineuptext=~,dots=false,backgroundcol=gray!20}{\\\\mauvaise[RR]{RR}\\\\scoring{\\\\PfMScoreD}\\\\mauvaise[R]{R}\\\\scoring{\\\\PfMScoreC}\\\\mauvaise[V]{V}\\\\scoring{\\\\PfMScoreB}\\\\bonne[VV]{VV}\\\\scoring{\\\\PfMScoreA}}%gray!15\\n      \\\\end{question}%\\n    \\\\fi\\n  \\\\end{tcolorbox}%\\n}%\\n\\n%%%%%%%%%%%%%%%%% Fin AMC\\n\\n%%% PixelArt\\n\\\\newtoks\\\\ToksPXTheme%\\n\\\\newtoks\\\\ToksPXNiveau%\\n\\\\def\\\\UpdateToksPXNiveau#1\\\\nil{\\\\addtotok\\\\ToksPXNiveau{#1}}%\\n\\\\def\\\\UpdateToksPXTheme#1\\\\nil{\\\\addtotok\\\\ToksPXTheme{#1}}%\\n\\n\\\\NewDocumentCommand\\\\PfMPXCount{}{%\\n  \\\\stepcounter{PfMLettresPixelArt}%\\n  \\\\xdef\\\\PfMCountPX{\\\\csname p\\\\Alph{PfMLettresPixelArt}\\\\endcsname}%\\n  \\\\PfMCountPX%\\n}%\\n\\n\\\\newcounter{PfMLettresPixelArt}\\n\\n\\\\NewDocumentCommand\\\\MPPixelArt{mm}{\\n  \\\\mplibforcehmode\\n  \\\\begin{mplibcode}\\n    path carre[];\\n\\n    u:=0.5mm;\\n\\n    color ColorEntier[],ColFond;\\n\\n    vardef BlocAffichage=\\n      for k=0 upto 34:\\n        carre[k]:=(unitsquare scaled u) shifted(u*(k mod 5,5-(k div 5)));\\n      endfor;\\n    enddef;\\n    \\n    vardef Affichage(expr decomp)=\\n      save $;\\n      picture $;\\n      drawoptions(withpen pensquare scaled0.1);\\n      $=image(%\\n        for k=0 upto 34:\\n          if (substring(k,k+1) of decomp)=\\\"1\\\":\\n            fill carre[k] withcolor ColFond;\\n          fi;\\n        endfor;\\n      );\\n      drawoptions();\\n      $\\n      enddef;\\n\\n      nblignes:=1;\\n\\n      decahoriz:=0;\\n\\n      vardef Test(expr cptk)(text cptnt)=\\n        pair Decalage;\\n        Decalage=u*(decahoriz,-8*(nblignes-1));\\n        decahoriz:=decahoriz+6;\\n        if substring(cptk,cptk+1) of cptnt=\\\"A\\\":draw Affichage(\\\"01110100011000110001111111000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"B\\\":draw Affichage(\\\"11110100011000111110100011000111110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"C\\\":draw Affichage(\\\"01110100011000010000100001000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"D\\\":draw Affichage(\\\"11100100101000110001100011001011100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"E\\\":draw Affichage(\\\"11111100001000011111100001000011111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"F\\\":draw Affichage(\\\"11111100001000011111100001000010000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"G\\\":draw Affichage(\\\"01110100011000010111100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"H\\\":draw Affichage(\\\"10001100011000111111100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"I\\\":draw Affichage(\\\"01110001000010000100001000010001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"J\\\":draw Affichage(\\\"00111000100001000010000101001001100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"K\\\":draw Affichage(\\\"10001100101010011000101001001010001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"L\\\":draw Affichage(\\\"10000100001000010000100001000011111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"M\\\":draw Affichage(\\\"10001110111010110101100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"N\\\":draw Affichage(\\\"10001100011100110101100111000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"O\\\":draw Affichage(\\\"01110100011000110001100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"P\\\":draw Affichage(\\\"11110100011000111110100001000010000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"Q\\\":draw Affichage(\\\"01110100011000110001101011001001101\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"R\\\":draw Affichage(\\\"11110100011000111110101001001010001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"S\\\":draw Affichage(\\\"01111100001000001110000010000111110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"T\\\":draw Affichage(\\\"11111001000010000100001000010000100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"U\\\":draw Affichage(\\\"10001100011000110001100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"V\\\":draw Affichage(\\\"10001100011000110001100010101000100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"W\\\":draw Affichage(\\\"10101101011010110101101011010101010\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"X\\\":draw Affichage(\\\"10001100010101000100010101000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"Y\\\":draw Affichage(\\\"10001100011000101010001000010000100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"Z\\\":draw Affichage(\\\"11111000010001000100010001000011111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"a\\\":draw Affichage(\\\"00000000000111100001011111000101111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"b\\\":draw Affichage(\\\"10000100001011011001100011000111110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"c\\\":draw Affichage(\\\"00000000000111010000100001000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"d\\\":draw Affichage(\\\"00001000010110110011100011000101111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"e\\\":draw Affichage(\\\"00000000000111010001111111000001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"f\\\":draw Affichage(\\\"00110010010100011100010000100001000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"g\\\":draw Affichage(\\\"00000011111000110001011110000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"h\\\":draw Affichage(\\\"10000100001011011001100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"i\\\":draw Affichage(\\\"00100000000110000100001000010001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"j\\\":draw Affichage(\\\"00010000000011000010000101001001100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"k\\\":draw Affichage(\\\"10000100001001010100110001010010010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"l\\\":draw Affichage(\\\"01100001000010000100001000010001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"m\\\":draw Affichage(\\\"00000000001101010101101011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"n\\\":draw Affichage(\\\"00000000001011011001100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"o\\\":draw Affichage(\\\"00000000000111010001100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"p\\\":draw Affichage(\\\"00000000001111010001111101000010000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"q\\\":draw Affichage(\\\"00000000000110110011011110000100001\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"r\\\":draw Affichage(\\\"00000000001011011001100001000010000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"s\\\":draw Affichage(\\\"00000000000111010000011100000111110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"t\\\":draw Affichage(\\\"01000010001110001000010000100100110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"u\\\":draw Affichage(\\\"00000000001000110001100011001101101\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"v\\\":draw Affichage(\\\"00000000001000110001100010111000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"w\\\":draw Affichage(\\\"00000000001010110101101011010101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"x\\\":draw Affichage(\\\"00000000001000101010001000101010001\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"y\\\":draw Affichage(\\\"00000000001000110001011110000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"z\\\":draw Affichage(\\\"00000000001111100010001000100011111\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"0\\\":draw Affichage(\\\"01110100011001110101110011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"1\\\":draw Affichage(\\\"00100011000010000100001000010001110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"2\\\":draw Affichage(\\\"01110100010000100010001000100011111\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"3\\\":draw Affichage(\\\"11111000100010000010000011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"4\\\":draw Affichage(\\\"00010001100101010010111110001000010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"5\\\":draw Affichage(\\\"11111100001111000001000011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"6\\\":draw Affichage(\\\"00110010001000011110100011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"7\\\":draw Affichage(\\\"11111000010001000100010000100001000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"8\\\":draw Affichage(\\\"01110100011000101110100011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"9\\\":draw Affichage(\\\"01110100011000101111000010001001100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"!\\\":draw Affichage(\\\"00100001000010000100000000000000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"'\\\":draw Affichage(\\\"01100001000100000000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"(\\\":draw Affichage(\\\"00010001000100001000010000010000010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\")\\\":draw Affichage(\\\"01000001000001000010000100010001000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"*\\\":draw Affichage(\\\"00000001001010101110101010010000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"+\\\":draw Affichage(\\\"00000001000010011111001000010000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"-\\\":draw Affichage(\\\"00000000000000011111000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\".\\\":draw Affichage(\\\"00000000000000000000000000110001100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\":\\\":draw Affichage(\\\"00000011000110000000011000110000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\";\\\":draw Affichage(\\\"00000011000110000000011000010001000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"<\\\":draw Affichage(\\\"00010001000100010000010000010000010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"=\\\":draw Affichage(\\\"00000000001111100000111110000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\">\\\":draw Affichage(\\\"10000010000010000010001000100010000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"?\\\":draw Affichage(\\\"01110100010000100010001000000000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"[\\\":draw Affichage(\\\"01110010000100001000010000100001110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"]\\\":draw Affichage(\\\"01110000100001000010000100001001110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"`\\\":draw Affichage(\\\"01000001000001000000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"|\\\":draw Affichage(\\\"00100001000010000100001000010000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\" \\\":draw Affichage(\\\"00000000000000000000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"&\\\":draw Affichage(\\\"00000100001100011100110001000000000\\\") shifted(Decalage);\\n%    elseif substring(cptk,cptk+1) of cptnt=\\\"$\\\":draw Affichage(\\\"00000000000000100001000010000111111\\\") shifted(Decalage);\\n%    elseif substring(cptk,cptk+1) of cptnt=\\\"^\\\":draw Affichage(\\\"00100010101000100000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"_\\\":draw Affichage(\\\"00000000000000000000000000000000000\\\") shifted(Decalage);\\n%    elseif substring(cptk,cptk+1) of cptnt=\\\"~\\\":draw Affichage(\\\"01000010000111001000010000100001000\\\") shifted(Decalage);\\n    fi;\\nenddef;\\n\\nvardef LCDSeul(text nt)=\\n  decahoriz:=0;\\n  ColFond:=black;\\n    if length(nt)>0:\\n    for k=0 upto length(nt)-1:\\n    BlocAffichage;\\n    Test(k,nt);\\n    endfor;\\n    fi;\\n    enddef;\\n    \\n    picture TestLCD;\\n    TestLCD=image(\\n    LCDSeul(#1);\\n    );\\n    bboxmargin:=3u;\\n    maxlarg=abs(lrcorner bbox TestLCD - llcorner bbox TestLCD)/u;\\n    maxhaut=abs(urcorner bbox TestLCD - lrcorner bbox TestLCD)/u;\\n    for k=0 upto maxlarg-1:\\n      for l=0 upto maxhaut-1:\\n        draw (unitsquare scaled u) shifted(llcorner bbox TestLCD+u*(k,l)) withcolor 0.8white;\\n      endfor;\\n    endfor;\\n    draw bbox TestLCD;\\n    \\n    draw TestLCD;\\n    picture Retiens;\\n    Retiens=currentpicture;\\n    currentpicture:=nullpicture;\\n    draw Retiens scaled 2;\\n  \\\\end{mplibcode}\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzPixelArt{}{%\\n  \\\\ToksPXNiveau{}%\\n  \\\\xdef\\\\Titi{\\\"Classe de \\\\useKV[PixelArt]{Niveau}\\\"}%\\n  \\\\expandafter\\\\UpdateToksPXNiveau\\\\Titi\\\\nil%\\n  \\\\ToksPXTheme{}%\\n  \\\\xdef\\\\Toto{\\\"\\\\useKV[PixelArt]{Theme}\\\"}%\\n  \\\\expandafter\\\\UpdateToksPXTheme\\\\Toto\\\\nil%\\n  \\\\xdef\\\\ListeAvantCouleurs{\\\\useKV[PixelArt]{ListeCouleurs}}%\\n  \\\\begin{center}\\n    \\\\MPPixelArt{\\\\the\\\\ToksPXTheme}{\\\\ListeAvantCouleurs}%\\n  \\\\end{center}\\n}%\\n\\n\\\\newcounter{PfMPX}[PfMMaquette]\\n\\\\setcounter{PfMPX}{0}\\n\\n\\\\NewDocumentCommand\\\\PfMSolPixelArt{m}{%\\n  \\\\ifboolKV[Boulot]{PixelArt}{%\\n    \\\\stepcounter{PfMLettresPixelArt}%\\n    \\\\ifboolKV[PixelArt]{Aleatoire}{%\\n         \\\\hfill\\\\textbf{Lettre~\\\\ListePourLesItems[\\\\fpeval{\\\\thePfMLettresPixelArt+1}]}%\\n        %Num Lettre = \\\\thePfMLettresPixelArt\\n    }{%\\n      \\\\hfill\\\\textbf{Lettre~\\\\Alph{PfMLettresPixelArt}}%\\n    }%\\n    \\\\ifdef{\\\\ListeSolAv}{%\\n      \\\\xdef\\\\ListeSolAv{\\\\ListeSolAv,#1}%\\n    }{%\\n      \\\\xdef\\\\ListeSolAv{#1}%\\n    }%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentEnvironment{exercicePX}{o}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}%\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\refstepcounter{PfMExo}%\\n}{}\\n%%% Fin PixelArt\\n\\n\\\\def\\\\PfMLogoBeamer{}\\n\\n%%%%%%%%%%%%%%% Debut Maquette %%%%%%%\\n% Environnement englobant le tout.\\n\\\\makeatletter\\n\\\\newwrite\\\\PfMfile@out%\\n\\n\\\\IfClassLoadedTF{beamer}{%\\n  %-> tex.stackexchange.com/questions/605282/beamer-custom-frame-environment-with-options\\n  \\\\NewDocumentEnvironment{Maquette}{om}{%\\n    \\\\ifcsname PfMGraineBeamer\\\\endcsname%\\n      \\\\setKVdefault[Boulot]{Graine=\\\\fpeval{\\\\PfMGraineBeamer+\\\\thePfMMaquette}}%\\n    \\\\else%\\n      \\\\def\\\\PfMGraineBeamer{\\\\fpeval{randint(1000)}}%\\n    \\\\fi%\\n    \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname PfMGraineBeamer\\\\endcsname{\\\\csname PfMGraineBeamer\\\\endcsname}}%\\n    %\\n    \\\\setcounter{RetiensSol}{0}%\\n    \\\\setcounter{RetiensRep}{0}%\\n    \\\\setcounter{RetiensInd}{0}%\\n    % on remet  zro le compteur des exercices\\n    % \\\\setcounter{PfMExo}{0}%\\n    \\\\setcounter{PfMSOS}{0}%\\n    % nouvelles valeurs.\\n    \\\\stepcounter{PfMMaquette}%\\n    \\\\IfHookExistsTF{env/exercice/after}{\\\\RemoveFromHook{env/exercice/after}[*]\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}{\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}%\\n    \\\\useKVdefault[Boulot]%\\n    \\\\setKV[Boulot]{#1}%\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n        \\\\AtEndDocument{%\\n          \\\\PfMPrepareCorrection{#1}%\\n          \\\\begin{frame}\\n            \\\\frametitle{\\\\useKV[Beamer]{Theme}\\\\hfill\\\\raisebox{-0.25\\\\height}{%\\n                \\\\PfMLogoBeamer}~\\\\phantom{t}}%\\n            \\\\PfMAffichageCorrige%\\n          \\\\end{frame}\\n        }%\\n      }{}%\\n    \\\\useKVdefault[Beamer]%\\n    \\\\setKV[Beamer]{#2}%\\n    \\\\let\\\\exercice\\\\exerciceBeamer\\\\let\\\\endexercice\\\\endexerciceBeamer%\\n    \\\\begin{frame}[environment=Maquette,fragile]\\n      \\\\setcounter{PfMExo}{0}%\\n      \\\\PfCGraineAlea{\\\\useKV[Boulot]{Graine}}%\\n      \\\\frametitle{\\\\useKV[Beamer]{Theme}\\\\hfill\\\\raisebox{-0.25\\\\height}{%\\n        \\\\PfMLogoBeamer}~\\\\phantom{t}}%\\n    }{%\\n    \\\\end{frame}\\n  }%\\n}{%\\n\\\\NewDocumentEnvironment{Maquette}{om}{%\\n  % on remet  zro les compteurs de solutions : inutile ?\\n  \\\\setcounter{RetiensSol}{0}%\\n  \\\\setcounter{RetiensRep}{0}%\\n  \\\\setcounter{RetiensInd}{0}%\\n  % on remet  zro le compteur des exercices\\n  %\\\\setcounter{PfMExo}{0}%\\n  \\\\setcounter{PfMSOS}{0}%\\n  % nouvelles valeurs.\\n  \\\\stepcounter{PfMMaquette}%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{0}{ScoreTotal\\\\thePfMMaquette}\\n  }%\\n  %% \\\\opadd*{#1}{ScoreTotal\\\\thePfMMaquette}{ScoreTotal\\\\thePfMMaquette}%\\n  \\\\useKVdefault[Boulot]%\\n  \\\\setKV[Boulot]{#1}%\\n  \\\\if@AssembleCorrections\\n  \\\\immediate\\\\openout\\\\PfMfile@out \\\\jobname-DefiMq-\\\\thePfMMaquette.tex%\\n  \\\\immediate\\\\write\\\\PfMfile@out{\\\\unexpanded{\\\\useKVdefault[Boulot]}}%\\n  \\\\immediate\\\\write\\\\PfMfile@out{\\\\unexpanded{\\\\setKV[Boulot]{#1}}}%\\n  \\\\ifboolKV[Boulot]{Fiche}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzFicheCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{DS}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzDSCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{DM}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzDMCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{IE}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzIECor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{FdR}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzFdRCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{Contrat}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzContratCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{Parcours}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzParcoursCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\immediate\\\\closeout\\\\PfMfile@out%\\n  \\\\fi\\n  % options de boulot\\n  \\\\IfHookExistsTF{env/Maquette/after}{\\\\RemoveFromHook{env/Maquette/after}[*]}{}%\\n  \\\\AddToHook{env/Maquette/after}[RetiensExo]{\\\\xdef\\\\PfMRetiensLienExoMa{\\\\PfMRetiensLienExoMa,\\\\thePfMExo}}\\n    %--------------\\n%  \\\\useKVdefault[Boulot]%\\n%  \\\\setKV[Boulot]{#1}%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{\\\\setKV[Boulot]{CorrigeFin}}{}%\\n  \\\\if@Dyslexie%\\n    \\\\setKV[Boulot]{Dys}%\\n  \\\\fi%\\n  \\\\PfMBasculeDys%\\n  \\\\IfHookExistsTF{env/exercice/after}{\\\\RemoveFromHook{env/exercice/after}[*]\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}{\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}%\\n  % Test\\n  \\\\IfHookExistsTF{env/exercice/begin}{\\\\RemoveFromHook{env/exercice/begin}[*]}{}%\\n  \\\\IfHookExistsTF{env/Maquette/end}{\\\\RemoveFromHook{env/Maquette/end}[*]}{}%\\n  \\\\ifboolKV[Boulot]{AMC}{%\\n      \\\\setcounter{PfMNbListeReponsesAMC}{0}%\\n      \\\\setKV[AMC]{#2}%\\n      \\\\let\\\\exercice\\\\exerciceAmc\\\\let\\\\endexercice\\\\endexerciceAmc%\\n      \\\\TikzAMC%\\n    }{%\\n  \\\\ifboolKV[Boulot]{OlympiadesAPMEP}{%\\n    \\\\setKV[OlympiadesAPMEP]{#2}%\\\\TikzOlympiadesAPMEP%\\n    \\\\let\\\\exercice\\\\exerciceOlympiadesAPMEP\\\\let\\\\endexercice\\\\endexerciceOlympiadesAPMEP%\\n    \\\\ifboolKV[OlympiadesAPMEP]{Bandeau}{%\\n        \\\\TikzOlympiadesAPMEP{#2}%\\n        \\\\bigskip\\n    }{%\\n      \\\\xdef\\\\PfMTitreAPMEP{\\\\useKV[OlympiadesAPMEP]{Theme}}\\n      \\\\chapter{\\\\PfMTitreAPMEP}\\n    }\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\AddToHook{env/Maquette/after}[Correction]{%\\n        \\\\PfMPrepareCorrection{#1}%\\n        \\\\TikzOlympiadesAPMEPCor{#2}%\\n        \\\\PfMAffichageCorrectionColonnes%\\n      }%\\n    }{}%\\n  }{%\\n    \\\\ifboolKV[Boulot]{CAN}{%\\n      \\\\setKV[CAN]{#2}%\\n      \\\\setcounter{PfMCNNumQ}{0}%\\n      \\\\setlength{\\\\PfMLargeurQuestion}{\\\\useKV[CAN]{CoefQ}\\\\linewidth}\\\\setlength{\\\\PfMLargeurReponse}{\\\\useKV[CAN]{CoefR}\\\\linewidth}\\\\setlength{\\\\PfMLargeurJury}{\\\\useKV[CAN]{CoefJ}\\\\linewidth}%\\n      \\\\let\\\\exercice\\\\ExoCANWrite\\\\let\\\\endexercice\\\\endExoCANWrite%\\n      \\\\AddToHook{env/exercice/begin}{\\\\setcounter{PfMAlea}{0}}%\\n      \\\\AddToHook{env/Maquette/end}{%\\n        \\\\xdef\\\\PfMAncienneGraine{\\\\PfMChoisisGraineAlea{123456789}}%\\n        \\\\xdef\\\\PfMCANTotalExo{\\\\thePfMExo}%\\n        \\\\setbox\\\\PfMSauvegardeBox\\\\vbox{%\\n          \\\\PfMGraineAlea{\\\\thePfMMaquette}%\\n          \\\\setcounter{PfMExo}{0}%\\n          \\\\renewcommand{\\\\arraystretch}{2}%\\n          \\\\begin{longtable}{|c|m{\\\\PfMLargeurQuestion}|>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurReponse}|m{\\\\PfMLargeurJury}|}%\\n            \\\\hhline{~---}%\\n            \\\\multicolumn{1}{c|}{}&\\\\cellcolor{gray!15}\\\\centering Question&\\\\cellcolor{gray!15}\\\\centering Rponse&\\\\cellcolor{gray!15}\\\\centering\\\\arraybackslash Jury\\\\\\\\%\\n            \\\\hline%\\n            \\\\endhead%\\n            \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n              \\\\refstepcounter{PfMCNNumQ}\\\\ttfamily{\\\\thePfMCNNumQ}\\\\label{TestCAN-\\\\thePfMCNNumQ}&\\\\Complement{}\\\\stepcounter{PfMExo}\\\\setcounter{PfMAlea}{0}\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.can}&\\\\CNReponse&\\\\\\\\\\n              \\\\hline%\\n            }%\\n          \\\\end{longtable}%\\n          \\\\renewcommand{\\\\arraystretch}{1}%\\n        }%\\n        \\\\ifboolKV[Boulot]{CorrigeInverse}{%\\n          \\\\PfMPrepareCorrection{#1}%\\n          \\\\TikzCANCor{#2}%\\n          \\\\PfMAffichageCorrectionColonnes%\\n          \\\\clearpage\\n          \\\\normalsize%\\n          \\\\TikzCAN%\\n          \\\\PfMGraineAlea{\\\\thePfMMaquette}%\\n          \\\\setcounter{PfMCNNumQ}{0}%\\n          \\\\setcounter{PfMExo}{0}%\\n          \\\\renewcommand{\\\\arraystretch}{2}%\\n          \\\\begin{longtable}{|c|m{\\\\PfMLargeurQuestion}|>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurReponse}|m{\\\\PfMLargeurJury}|}%\\n            \\\\hhline{~---}%\\n            \\\\multicolumn{1}{c|}{}&\\\\cellcolor{gray!15}\\\\centering Question&\\\\cellcolor{gray!15}\\\\centering Rponse&\\\\cellcolor{gray!15}\\\\centering\\\\arraybackslash Jury\\\\\\\\%\\n            \\\\hline%\\n            \\\\endhead%\\n            \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n              \\\\refstepcounter{PfMCNNumQ}\\\\ttfamily{\\\\thePfMCNNumQ}\\\\label{TestCAN-\\\\thePfMCNNumQ}&\\\\Complement{}\\\\stepcounter{PfMExo}\\\\setcounter{PfMAlea}{0}\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.can}&\\\\CNReponse&\\\\\\\\\\n              \\\\hline%\\n            }%\\n          \\\\end{longtable}%\\n          \\\\renewcommand{\\\\arraystretch}{1}%\\n        }{%\\n          \\\\PfMGraineAlea{\\\\PfMAncienneGraine}%\\n          \\\\TikzCAN%\\n          \\\\setcounter{PfMCNNumQ}{0}%\\n          \\\\setcounter{PfMExo}{0}%\\n          \\\\renewcommand{\\\\arraystretch}{2}%\\n          \\\\begin{longtable}{|c|m{\\\\PfMLargeurQuestion}|>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurReponse}|m{\\\\PfMLargeurJury}|}%\\n            \\\\hhline{~---}%\\n            \\\\multicolumn{1}{c|}{}&\\\\cellcolor{gray!15}\\\\centering Question&\\\\cellcolor{gray!15}\\\\centering Rponse&\\\\cellcolor{gray!15}\\\\centering\\\\arraybackslash Jury\\\\\\\\%\\n            \\\\hline%\\n            \\\\endhead%\\n            \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n              \\\\refstepcounter{PfMCNNumQ}\\\\ttfamily{\\\\thePfMCNNumQ}\\\\label{TestCAN-\\\\thePfMCNNumQ}&\\\\Complement{}\\\\stepcounter{PfMExo}\\\\setcounter{PfMAlea}{0}\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.can}&\\\\CNReponse&\\\\\\\\\\n              \\\\hline%\\n            }%\\n          \\\\end{longtable}%\\n          \\\\renewcommand{\\\\arraystretch}{1}%\\n          \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n            \\\\ifboolKV[Boulot]{CorrigeInverse}{}{%\\n              \\\\clearpage\\n              \\\\PfMPrepareCorrection{#1}%\\n              \\\\TikzCANCor{#2}%\\n              \\\\PfMAffichageCorrectionColonnes%\\n            }%\\n          }{}%\\n        }%\\n      }%\\n    }{%\\n      \\\\ifboolKV[Boulot]{FdR}{%\\n        % \\\\input{PfMMaquetteFdR.tex}%\\n        \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n          \\\\setKV[FdR]{#2}\\\\TikzFdR%\\n        }%\\n        \\\\let\\\\exercice\\\\exerciceFdR\\\\let\\\\endexercice\\\\endexerciceFdR%\\n        \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n          \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n            \\\\PfMAffichageEntrainementColonnes%\\n          }%\\n        }{}%\\n        \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n          \\\\AddToHook{env/Maquette/after}[Correction]{%\\n            \\\\PfMPrepareCorrection{#1}%\\n            \\\\TikzFdRCor{#2}%\\n            \\\\PfMAffichageCorrectionColonnes%\\n          }%\\n        }{}%\\n      }{%\\n        \\\\ifboolKV[Boulot]{Contrat}{%\\n          % \\\\input{PfMMaquetteContrat.tex}%\\n          \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n            \\\\setKV[Contrat]{#2}\\\\TikzContrat%\\n          }%\\n          \\\\let\\\\exercice\\\\exerciceContrat\\\\let\\\\endexercice\\\\endexerciceContrat%\\n          \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n            \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n              \\\\PfMAffichageEntrainementColonnes%\\n            }%\\n          }{}%\\n          \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n              \\\\PfMPrepareCorrection{#1}%\\n              \\\\TikzContratCor{#2}%\\n              \\\\PfMAffichageCorrectionColonnes%\\n            }%\\n          }{}%\\n        }{%\\n          \\\\ifboolKV[Boulot]{Cours}{%\\n            % \\\\input{PfMMaquetteCours.tex}%\\n            \\\\setKV[Cours]{#2}%\\n            \\\\TikzCours%\\n            \\\\let\\\\exercice\\\\exerciceFiche\\\\let\\\\endexercice\\\\endexerciceFiche%\\n            \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n              \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                \\\\PfMPrepareCorrection{#1}%\\n                \\\\TikzFicheCor{#2}%\\n                \\\\PfMAffichageCorrectionColonnes%\\n              }%\\n            }{}%\\n          }{%\\n            \\\\ifboolKV[Boulot]{RecapBrevet}{%\\n              % \\\\input{PfMMaquetteRecapBrevet.tex}%\\n              \\\\setKV[RecapBrevet]{#2}%\\n              \\\\TikzRecapBrevet%\\n              \\\\let\\\\exercice\\\\ExerciceRecapBrevet\\\\let\\\\endexercice\\\\endExerciceRecapBrevet%\\n              \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                  \\\\PfMPrepareCorrection{#1}%\\n                  \\\\TikzRecapBrevetCor{#2}%\\n                  \\\\PfMAffichageCorrectionColonnes%\\n                }%\\n              }{}%\\n            }{%\\n              \\\\ifboolKV[Boulot]{ParcoursPerso}{%\\n                % \\\\input{PfMMaquetteParcoursPerso.tex}%\\n                \\\\setKV[ParcoursPerso]{#2}%\\n                \\\\DTLloaddb[noheader,keys={PrenomEleve,NomEleve,ListeExo}]{dataperso}{\\\\useKV[ParcoursPerso]{Fichier}.csv}%\\n                \\\\let\\\\exercice\\\\exerciceParcoursPerso\\\\let\\\\endexercice\\\\endexerciceParcoursPerso%\\n                \\\\ifboolKV[Boulot]{CorrigeFin}{\\\\setcounter{PfMCorrigeParcoursPerso}{1}}{}%\\n                \\\\setcounter{PfMExo}{0}%\\n                \\\\AtEndDocument{%\\n                  \\\\PfMRecapitulatif{#1}{#2}%\\n                }%\\n              }{%\\n                \\\\ifboolKV[Boulot]{Parcours}{%\\n                  % \\\\input{PfMMaquetteParcours.tex}%\\n                  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                    \\\\setKV[Parcours]{#2}\\\\TikzParcours%\\n                  }%\\n                  \\\\let\\\\exercice\\\\exerciceParcours\\\\let\\\\endexercice\\\\endexerciceParcours%\\n                  \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n                    \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n                      \\\\PfMAffichageEntrainementColonnes%\\n                    }%\\n                  }{}%\\n                  \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                    \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                      \\\\PfMPrepareCorrection{#1}%\\n                      \\\\TikzParcoursCor{#2}%\\n                      \\\\PfMAffichageCorrectionColonnes%\\n                    }%\\n                  }{}%\\n                }{%\\n                  \\\\ifboolKV[Boulot]{PdT}{%\\n                    % \\\\input{PfMMaquettePdT.tex}%\\n                    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                      \\\\setKV[PdT]{#2}\\\\TikzPdT%\\n                    }%\\n                    \\\\let\\\\exercice\\\\exercicePdT\\\\let\\\\endexercice\\\\endexercicePdT%\\n                    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                      \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                        \\\\PfMPrepareCorrection{#1}%\\n                        \\\\TikzPdTCor{#2}%\\n                        \\\\PfMAffichageCorrectionColonnes%\\n                      }%\\n                    }{}%\\n                  }{%\\n                    \\\\ifboolKV[Boulot]{DM}{%\\n                      % \\\\input{PfMMaquetteDM.tex}%\\n                      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                        \\\\setKV[DM]{#2}\\\\TikzDM%\\n                      }%\\n                      \\\\let\\\\exercice\\\\exerciceDM\\\\let\\\\endexercice\\\\endexerciceDM%\\n                      \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                        \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                          \\\\PfMPrepareCorrection{#1}%\\n                          \\\\TikzDMCor{#2}%\\n                          \\\\PfMAffichageCorrectionColonnes%\\n                        }%\\n                      }{}%\\n                    }{%\\n                      \\\\ifboolKV[Boulot]{Fiche}{%\\n                        \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                          \\\\setKV[Fiche]{#2}%\\n                          \\\\TikzFiche%\\n                        }%\\n                        \\\\let\\\\exercice\\\\exerciceFiche\\\\let\\\\endexercice\\\\endexerciceFiche%\\n                        \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n                          \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n                            \\\\PfMAffichageEntrainementColonnes%\\n                          }%\\n                        }{}%\\n                        \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                          \\\\ifboolKV[Boulot]{CorrigeAll}{%\\n                            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                              \\\\PfMPrepareCorrection{#1}%\\n                              \\\\TikzFicheCor{#2}%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}{\\\\textbf{Corrig de l'exercice ##1}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}\\\\par\\\\goodbreak}{}%\\n                              }%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                              \\\\TikzFicheCorRep{#2}%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}{\\\\textbf{Rponse(s) de l'exercice ##1}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}\\\\par\\\\goodbreak}{}%\\n                              }%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                              \\\\TikzFicheCorInd{#2}%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}{\\\\textbf{Indice(s) pour l'exercice ##1}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}\\\\par\\\\goodbreak}{}%\\n                              }% \\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                            }%\\n                          }{%\\n                            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n%                              \\\\useKVdefault[Boulot]%\\n%                              \\\\setKV[Boulot]{#1}%\\n%                              %%\\n%                              \\\\if@Dyslexie\\n%                                \\\\setKV[Boulot]{Dys}%\\n%                              \\\\fi\\n%                              \\\\PfMBasculeDys%\\n%                              \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{Epaisseur}}%\\n                              \\\\if@AssembleCorrections\\n                              \\\\else\\n                                \\\\PfMPrepareCorrection{#1}%\\n                                \\\\TikzFicheCor{#2}%\\n                                \\\\PfMAffichageCorrectionColonnes%\\n                              \\\\fi%\\n                            }%\\n                          }%\\n                        }{}%\\n                      }{%\\n                        \\\\ifboolKV[Boulot]{DS}{%\\n                          % \\\\input{PfMMaquetteDS.tex}%\\n                          \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                            \\\\setKV[DS]{#2}\\\\TikzDS%\\n                          }%\\n                          \\\\let\\\\exercice\\\\exerciceDS\\\\let\\\\endexercice\\\\endexerciceDS%\\n                          \\\\ifboolKV[Boulot]{BaremeComplet}{%\\n                            \\\\begin{center}\\n                              \\\\TableauRecapitulatif\\n                            \\\\end{center}\\n                          }{}%\\n                          \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                              \\\\if@AssembleCorrections\\n                              \\\\else\\n                                \\\\PfMPrepareCorrection{#1}%\\n                                \\\\TikzDSCor{#2}%\\n                                \\\\PfMAffichageCorrectionColonnes%\\n                              \\\\fi%\\n                            }%\\n                          }{}%\\n                        }{%\\n                          \\\\ifboolKV[Boulot]{IE}{%\\n                            % \\\\input{PfMMaquetteIE.tex}%\\n                            \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                              \\\\setKV[IE]{#2}\\\\TikzIE%\\n                            }%\\n                            \\\\let\\\\exercice\\\\exerciceDS\\\\let\\\\endexercice\\\\endexerciceDS%On garde exerciceDS\\n                            \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                              \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                                \\\\PfMPrepareCorrection{#1}%\\n                                \\\\TikzIECor{#2}%\\n                                \\\\PfMAffichageCorrectionColonnes%\\n                              }%\\n                            }{}%\\n                          }{%\\n                            \\\\ifboolKV[Boulot]{Kholle}{%\\n                              % \\\\input{PfMMaquetteKholle.tex}%\\n                              \\\\setKV[Kholle]{#2}%\\n                              \\\\TikzKholle%\\n                              \\\\let\\\\exercice\\\\exerciceKholle\\\\let\\\\endexercice\\\\endexerciceKholle%\\n                              \\\\ifboolKV[Kholle]{CR}{}{%\\n                                \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                                  \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                                    \\\\TikzKholleCor{#2}%\\n                                    \\\\TikzKholleCor{#2}%\\n                                    \\\\TikzKholleCor{#2}%\\n                                    \\\\PfMAffichageCorrige%\\n                                  }%\\n                                }{}%\\n                              }%\\n                            }{%\\n                              \\\\ifboolKV[Boulot]{LivreHeros}{%\\n                                \\\\setKV[LivreHeros]{#2}%\\n                                \\\\TikzLivreHeros%\\n                                \\\\let\\\\exercice\\\\ExoGBWrite\\\\let\\\\endexercice\\\\endExoGBWrite%\\n                                \\\\AddToHook{env/Maquette/end}{%\\n                                  \\\\xdef\\\\PfMListeExoGB{}%\\n                                  \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\thePfMExo}}\\\\do{%\\n                                    \\\\xdef\\\\PfMListeExoGB{\\\\PfMListeExoGB,##1}%\\n                                  }%\\n                                  \\\\MelangeListe{\\\\PfMListeExoGB}{\\\\fpeval{\\\\thePfMExo-1}}%\\n                                  \\\\xdef\\\\PfMFooMelange{1,\\\\faa}%\\n                                  \\\\setsepchar{,}\\\\ignoreemptyitems\\\\readlist*\\\\ListePerm{\\\\PfMFooMelange}\\\\reademptyitems%\\n                                  \\\\phantomsection{}\\n                                  \\\\addcontentsline{toc}{section}{\\\\useKV[LivreHeros]{Theme}}%\\n                                  \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{Epaisseur}}%\\n                                  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                                  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                    \\\\itemtomacro\\\\ListePerm[##1]\\\\PfMPermute%\\n                                    \\\\begin{tcolorbox}[tikzLH,title=##1]%\\n                                      \\\\refstepcounter{PfMGameBook}%\\n                                      \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\PfMPermute.gb}%\\n                                    \\\\end{tcolorbox}%\\n                                  }%\\n                                  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                                }%\\n                              }{%\\n                                \\\\ifboolKV[Boulot]{PixelArt}{%\\n                                    \\\\setcounter{PfMLettresPixelArt}{0}\\n                                  \\\\xdef\\\\ListeSolAv{}%\\n                                  \\\\setKV[PixelArt]{#2}%\\n                                  \\\\setlength{\\\\PfMLargeurTableauPixelArt}{\\\\useKV[PixelArt]{LargeurTab}}%\\n                                  \\\\ifboolKV[PixelArt]{Aleatoire}{%\\n                                      \\\\setcounter{PfMLettresPixelArt}{1}%\\n                                      \\\\StrLen{\\\\useKV[PixelArt]{Lettres}}[\\\\PfMNbLettres]%\\n                                      \\\\ChoixSommet{\\\\PfMNbLettres}{S}%\\n                                      \\\\xdef\\\\ListePourLesItemsAv{\\\\pA}%\\n                                      \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\PfMNbLettres}}\\\\do{%\\n                                        \\\\stepcounter{PfMLettresPixelArt}%\\n                                        \\\\xdef\\\\ListePourLesItemsAv{\\\\ListePourLesItemsAv,\\\\csname p\\\\Alph{PfMLettresPixelArt}\\\\endcsname}%\\n                                      }%\\n                                      \\\\setsepchar{,}\\\\ignoreemptyitems\\\\readlist*\\\\ListePourLesItems{\\\\ListePourLesItemsAv}\\\\reademptyitems%\\n                                      \\\\setcounter{PfMLettresPixelArt}{-1}%\\n                                      \\\\setKVdefault[PfMPixelArt]{ListeNombres={\\\\ListePourLesItemsAv}}%\\n                                    }{}%\\n                                  \\\\TikzPixelArt%\\n                                  \\\\let\\\\exercice\\\\exercicePX\\\\let\\\\endexercice\\\\endexercicePX%\\n                                  \\\\AddToHook{env/Maquette/end}{%\\n                                    \\\\StrLen{\\\\useKV[PixelArt]{Lettres}}[\\\\PfMNbLettres]\\n                                    \\\\setsepchar{,}\\\\ignoreemptyitems\\n                                    \\\\readlist*\\\\ListeSolPX{\\\\ListeSolAv}%\\n                                    \\\\reademptyitems\\n                                    \\\\ifnum\\\\fpeval{\\\\ListeSolPXlen}=\\\\fpeval{\\\\PfMNbLettres}\\\\relax\\n                                      \\\\xdef\\\\PfMListeExoPX{}%\\n                                      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeSolPXlen}}\\\\do{%\\n                                        \\\\xdef\\\\PfMListeExoPX{\\\\PfMListeExoPX,##1}%\\n                                      }%\\n                                      \\\\MelangeListe{\\\\PfMListeExoPX}{\\\\ListeSolPXlen}%\\n                                      \\\\xdef\\\\PfMFooMelange{\\\\faa}%\\n                                      \\\\xdef\\\\PfMListeCouleursAv{\\\\useKV[PixelArt]{ListeCouleurs}}%\\n                                      \\\\setsepchar{,}\\\\ignoreemptyitems%\\n                                      \\\\readlist*\\\\ListePerm{\\\\PfMFooMelange}%\\n                                      \\\\readlist*\\\\ListeCouleursPX{\\\\PfMListeCouleursAv}%\\n                                      \\\\reademptyitems%\\n%                                      Le nombre de couleurs est \\\\ListeCouleursPXlen.\\\\\\\\\\n%                                      Le nombre de lettres est \\\\PfMNbLettres\\\\\\\\\\n                                      \\\\ifnum\\\\fpeval{\\\\ListeCouleursPXlen}=\\\\fpeval{\\\\PfMNbLettres}\\\\relax\\n                                        \\\\ifboolKV[PixelArt]{CoupureTableau}{%\\n                                          \\\\begin{center}\\n                                            \\\\quotient{\\\\ListeSolPXlen}{\\\\useKV[PixelArt]{CoupeTableau}}%\\n                                            \\\\modulo{\\\\ListeSolPXlen}{\\\\useKV[PixelArt]{CoupeTableau}}%\\n                                            \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\the\\\\intquotient}}\\\\do{%\\n                                              \\\\begin{tabular}{|*{\\\\useKV[PixelArt]{CoupeTableau}}{>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurTableauPixelArt}|}}%\\n                                                \\\\hline%\\n                                                \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\useKV[PixelArt]{CoupeTableau}}}\\\\do{%\\n                                                \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*(##1-1)+##2}]\\\\PfMPermute%\\n                                                \\\\itemtomacro\\\\ListeCouleursPX[\\\\PfMPermute]\\\\Toto%\\n                                                \\\\xdef\\\\Titi{\\\\Toto}%\\n                                                \\\\cellcolor{\\\\Titi}\\\\xintifForLast{}{&}%\\\\Titi\\n                                                                                    }\\\\\\\\\\n                                                \\\\hline%\\n                                                \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\useKV[PixelArt]{CoupeTableau}}}\\\\do{%\\n                                                \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*(##1-1)+##2}]\\\\PfMPermute%\\n                                                \\\\itemtomacro\\\\ListeSolPX[\\\\PfMPermute]\\\\Toto%\\n                                                \\\\Toto\\\\xintifForLast{}{&}%\\\\Toto\\n                                                                        }\\\\\\\\\\n                                                \\\\hline\\n                                              \\\\end{tabular}\\\\par%\\n                                            }%\\n                                            \\\\ifnum\\\\remainder>0\\\\relax\\n                                            \\\\begin{tabular}{|*{\\\\the\\\\remainder}{>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurTableauPixelArt}|}}%\\n                                              \\\\hline\\n                                              \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*\\\\the\\\\intquotient+##2}]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeCouleursPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\xdef\\\\Titi{\\\\Toto}%\\n                                              \\\\cellcolor{\\\\Titi}\\\\xintifForLast{}{&}%\\\\Titi\\n                                                                                  }\\\\\\\\\\n                                              \\\\hline\\n                                              \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*\\\\the\\\\intquotient+##2}]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeSolPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\Toto\\\\xintifForLast{}{&}%\\\\Toto\\n                                                                      }\\\\\\\\\\n                                              \\\\hline\\n                                            \\\\end{tabular}\\n                                            \\\\fi\\n                                          \\\\end{center}\\n                                        }{%\\n                                          \\\\begin{center}\\n                                            \\\\begin{tabular}{|*{\\\\ListeSolPXlen}{>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurTableauPixelArt}|}}\\n                                              \\\\hline%\\n                                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeSolPXlen}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[##1]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeCouleursPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\xdef\\\\Titi{\\\\Toto}%\\n                                              \\\\cellcolor{\\\\Titi}\\\\xintifForLast{}{&}\\n                                                                                  }\\\\\\\\\\n                                              \\\\hline\\n                                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeSolPXlen}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[##1]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeSolPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\Toto\\\\xintifForLast{}{&}\\n                                                                      }\\\\\\\\\\n                                              \\\\hline\\n                                            \\\\end{tabular}\\n                                          \\\\end{center}%\\n                                        }\\n                                        \\\\begin{center}\\n                                          \\\\PfMPixelArt[#2]{\\\\useKV[PixelArt]{Fichier}}%\\n                                        \\\\end{center}\\n                                      \\\\else\\n                                        Le nombre de couleurs et le nombre de lettres ne correspondent pas.\\n                                      \\\\fi\\n                                    \\\\else\\n                                      \\\\ifnum\\\\fpeval{\\\\ListeSolPXlen}<\\\\fpeval{\\\\PfMNbLettres}\\\\relax\\n                                        Il manque des lments de solutions.\\n                                      \\\\else\\n                                        Il y a trop d'lments de solutions.\\n                                      \\\\fi\\n                                    \\\\fi\\n                                  }%\\n                                }{}%\\n                              }%\\n                            }%\\n                          }%\\n                        }%\\n                      }%\\n                    }%\\n                  }%\\n                }%\\n              }%\\n            }%\\n          }%\\n        }%\\n      }%\\n    }%\\n  }%\\n}%\\n}%\\n}{}%\\n\\\\makeatother\\n%D'aprs JCC\\n% Package pour grer les nombres pseudo-alatoires\\n\\\\makeatletter\\n\\\\input{random}\\n\\n% Pour toutes les macros de liste, le premier paramtre est le nom de\\n% la macro reprsentant la liste.\\n\\n% macro pour tester si une liste est vide\\n\\\\def\\\\empty@list{}\\n\\n% Macro pour dfinir une nouvelle liste\\n\\\\newcommand\\\\PfMdefinelist[2]{\\\\def#1{#2}}\\n\\n% Macro pour ajouter un lment en fin de liste\\n\\\\newcommand\\\\push[2]{%\\n  \\\\ifx\\\\\\\\#2\\\\\\\\%\\n    \\\\PackageError{randomlist}\\n                 {You can't push an empty value.}\\n                 {Arg 2 of \\\\string\\\\pushlist is empty.}%\\n  \\\\else\\n    \\\\ifx#1\\\\empty@list\\n      \\\\def#1{#2}%\\n    \\\\else\\n      \\\\edef#1{#1,#2}%\\n    \\\\fi\\n  \\\\fi\\n}\\n\\n% Macro pour retirer le premier lment d'une liste\\n\\\\newcommand\\\\pop[2]{%\\n  \\\\getwidth{#1}{\\\\RL@temp}%\\n  \\\\ifnum\\\\RL@temp = 0\\n    % cas de la liste vide\\n    \\\\PackageError{randomlist}\\n                 {You can't pop an empty list.}\\n                 {There is no value to pull in list #1.}%\\n  \\\\else\\\\ifnum\\\\RL@temp = 1\\n    % cas de la liste avec un seul lment\\n    \\\\edef#2{#1}%\\n    \\\\def#1{}%\\n  \\\\else\\n    % cas de la liste avec au moins deux lments\\n    \\\\expandafter\\\\@@poplist#1,\\\\@nil#1#2%\\n  \\\\fi\\\\fi\\n}\\n\\\\def\\\\@@poplist#1,#2,\\\\@nil#3#4{%\\n  \\\\def#4{#1}%\\n  \\\\def#3{#2}%\\n}\\n\\n% Macro comptant le nombre d'lment d'une liste.\\n\\\\newcount\\\\RL@cnta\\n\\\\newcommand\\\\getwidth[2]{%\\n  \\\\RL@cnta \\\\z@\\n  \\\\unless\\\\ifx#1\\\\empty@list\\n    \\\\expandafter\\\\@countlist#1,\\\\@nil,%\\n  \\\\fi\\n  \\\\edef#2{\\\\the\\\\RL@cnta}%\\n}\\n\\\\def\\\\@countlist#1,{%\\n  \\\\def\\\\RL@arg{#1}%\\n  \\\\unless\\\\ifx\\\\RL@arg\\\\@nnil\\n    \\\\advance\\\\RL@cnta \\\\@ne\\n    \\\\expandafter\\\\@countlist\\n  \\\\fi\\n}\\n\\n% Macro d'extraction de la nieme valeur\\n\\\\newcommand\\\\extract[3]{%\\n  % #1 = liste\\n  % #2 = indice\\n  % #3 = macro de retour de la nieme valeur\\n  % On vrifie si la longueur de la liste est suffisante\\n  \\\\getwidth{#1}{\\\\RL@temp}%\\n  \\\\ifnum#2>\\\\RL@temp\\n    \\\\PackageError{randomlist}\\n                 {Value number #2 doesn't exist in list #1}\\n                 {List #1 has only \\\\RL@temp\\\\ values}%\\n  \\\\else\\n    \\\\RL@cnta #2\\n    % On initialise une liste temporaire qui se remplira avec les\\n    % lments non extraits\\n    \\\\def\\\\RL@temp{}%\\n    % Lancement de la lecture rcursive de la liste\\n    \\\\expandafter\\\\RL@extract#1,\\\\@nil,%\\n    % On met la valeur extraite dans la macro prvue\\n    \\\\edef#3{\\\\RL@return}%cp a remplac edef par xdef\\n    % La liste est celle sans l'lment extrait\\n    \\\\let#1\\\\RL@temp\\n  \\\\fi\\n}\\n\\\\def\\\\RL@extract#1,{%\\n  % Dans cette tape, on ne peut pas atteindre la fin de la liste, il\\n  % faut juste reprer l'lment  extraire\\n  \\\\advance\\\\RL@cnta \\\\m@ne\\n  \\\\ifnum\\\\RL@cnta = 0\\n    % L'lment est atteint, on le sauvegarde\\n    \\\\def\\\\RL@return{#1}%\\n    % et on appelle la macro rcursive de fin de lecture.\\n    \\\\expandafter\\\\RL@@extract\\n  \\\\else\\n    % L'lment n'est pas atteint, on augmente la liste temporaire\\n    % on protge d'ventuelles virgule avec des accolades\\n    \\\\edef\\\\RL@temp{\\\\RL@temp,{#1}}%\\n    % et on ralise l'appel rcursif\\n    \\\\expandafter\\\\RL@extract\\n  \\\\fi\\n}\\n\\\\def\\\\RL@@extract#1,{%\\n  % L'lment a t extrait, on lit le reste de la liste pour mettre \\n  % jour la liste temporaire\\n  \\\\def\\\\RL@arg{#1}%\\n  \\\\ifx\\\\RL@arg\\\\@nnil\\n    % Si la liste est vide, on place une virgule\\n    \\\\ifx\\\\RL@temp\\\\empty\\n      \\\\def\\\\RL@temp{,}%\\n    \\\\fi\\n    % La fin de la liste est atteinte, il faut supprimer la virgule\\n    % initiale de la liste temporaire\\n    \\\\expandafter\\\\RL@@@extract\\\\RL@temp\\\\@nil\\n  \\\\else\\n    % On n'a pas atteint la fin de liste, on augmente la liste\\n    % temporaire avec l'lment lu et on ralise l'appel rcursif\\n    % l'lment ajout est protg avec des accolades au cas o il\\n    % contiendrait des virgules.\\n    \\\\edef\\\\RL@temp{\\\\RL@temp,{#1}}%\\n    \\\\expandafter\\\\RL@@extract\\n  \\\\fi\\n}\\n\\\\def\\\\RL@@@extract,#1\\\\@nil{\\\\def\\\\RL@temp{#1}}\\n\\n% Extraction de l'lment <n> de la liste. Le choix de <n> tant\\n% alatoire\\n\\\\newcount\\\\RL@cntb\\n\\\\newcommand\\\\randomextract[2]{%\\n  % Le choix alatoire se fait dans l'intervalle [1,max de la liste]\\n  % donc on commence par rcuprer l'indice maximum de la liste.\\n  \\\\getwidth{#1}{\\\\RL@temp}%\\n  % Nombre alatoire dans le compteur \\\\RL@cntb\\n  \\\\setrannum{\\\\RL@cntb}{1}{\\\\RL@temp}%\\n  % Appel de la macro d'extraction\\n  \\\\extract{#1}{\\\\the\\\\RL@cntb}{#2}%\\n}\\n%\\n% Initialisation du germe en gardant la mme valeur toutes les #2\\n% compilations. Lors de la premire compilation, c'est #1 qui sera le\\n% germe (si valeur vide, on laisse faire random)\\n\\\\newcommand\\\\initrandomlist[2][]{%\\n  \\\\ifdefined\\\\randomlistseed\\n    % Si le germe existe, c'est qu'il a t dclar dans le\\n    % fichier .aux avec le compteur de compilation. Le germe et le\\n    % compteur de compilation existent et sont  jour.\\n  \\\\else\\n    % Si le fichier aux n'a pas dclar de compteur \\\\randomlistseed\\n    % on considre qu'on est  la premire compilation donc qu'on\\n    % compile avec un nouveau germe et un compteur de compilation \\n    % un. Dans ce cas particulier, on laisse random.tex choisir le\\n    % germe.\\n    \\\\newcount\\\\randomlistseed\\n    \\\\ifx\\\\\\\\#1\\\\\\\\\\n      % si l'argument optionnel est vide, on laisse faire random\\n      \\\\nextrandom\\n      \\\\randomlistseed \\\\randomi\\n    \\\\else\\n      % sinon, on prend cet argument comme germe initial\\n      \\\\randomlistseed #1\\n    \\\\fi\\n    \\\\newcount\\\\randomlistcompile\\n    \\\\randomlistcompile \\\\@ne\\n  \\\\fi\\n  % Utilisation du germe adquat pour la compilation en cours.\\n  \\\\randomi\\\\randomlistseed\\n  % Prparation de la compilation suivante (dans le fichier .aux)\\n  % On regarde si le nombre de compilations est gale   zro modulo #2 \\n  \\\\ifnum\\\\numexpr(\\\\randomlistcompile/#2)*#2-\\\\randomlistcompile=0\\n    % Si le nombre de compilations avec le mme germe est atteint\\n    % on changera le germe  la prochaine compilation.\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\newcount\\\\string\\\\randomlistseed\\n    }%\\n    % modification du germe (sans laisser faire random sinon cela ne\\n    % change pas au cours de chaque minute)\\n    \\\\ifnum\\\\randomlistseed>2147483646\\n      \\\\randomlistseed \\\\z@\\n    \\\\else\\n      \\\\advance\\\\randomlistseed \\\\@ne\\n    \\\\fi\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\global\\\\string\\\\randomlistseed=\\\\the\\\\randomlistseed\\n    }%\\n  \\\\else\\n    % Il faut faire encore des compilations avec le mme germe, on\\n    % sauvegarde le germe et le compteur de compilation dans le\\n    % fichier .aux.\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\newcount\\\\string\\\\randomlistseed\\n    }%\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\global\\\\string\\\\randomlistseed=\\\\the\\\\randomlistseed\\n    }%\\n  \\\\fi\\n  % Dans tous les cas, on augmente le compteur de compilation\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\newcount\\\\string\\\\randomlistcompile\\n    }%\\n    \\\\advance\\\\randomlistcompile \\\\@ne\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\global\\\\string\\\\randomlistcompile=\\\\the\\\\randomlistcompile\\n    }%\\n}\\n\\\\makeatother\\n\\\\newcommand\\\\initEnsemblede{%\\n  \\\\PfMdefinelist{\\\\EnsembleDe}{%\\n    {2,4,6,8,10,12},%\\n    {1,3,5,7,9,11},%\\n    {2,3,5,7,11,13},%\\n  }\\n}\\n\\n\\\\newcommand\\\\GetValeurDe[1]{%\\n  \\\\extract{\\\\EnsembleDe}{#1}{\\\\DeChoisi}%\\n  \\\\randomextract{\\\\DeChoisi}{\\\\NbDeChoisi}%\\n}\\n\\n\\\\def\\\\PfMListeNombresPremiers{2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97}\\n  \\n\\n\\\\newcommand\\\\initpremiers{%\\n  \\\\PfMdefinelist{\\\\listpremiers}{13,17,19,23,29,31,37,41,43,47}%\\n}\\n\\n\\\\newcommand\\\\initPremiers{%\\n  \\\\PfMdefinelist{\\\\listPremiers}{71,73,79,83,89,97,101,103,107,109,113,127,131,137,139}%\\n}\\n\\n\\\\newcommand\\\\getpremier{%\\n  \\\\randomextract{\\\\listpremiers}{\\\\NbPremier}\\n}%\\n\\n\\\\newcommand\\\\getPremier{%\\n  \\\\randomextract{\\\\listPremiers}{\\\\NBPremier}\\n}%\\n\\n\\\\newcommand\\\\getpytha{%\\n  \\\\randomextract{\\\\tripletspythaentier}{\\\\triplet}%\\n  \\\\extract{\\\\triplet}{3}{\\\\grand}% le troisime et le plus grand\\n  \\\\randomextract{\\\\triplet}{\\\\cote}%\\n  \\\\randomextract{\\\\triplet}{\\\\autre}%\\n}\\n\\n\\\\newcommand\\\\initalpha{%\\n  \\\\PfMdefinelist{\\\\alphas}{b,c,d,e,f}\\n}\\n\\\\newcommand\\\\getalpha{%\\n  \\\\randomextract{\\\\alphas}{\\\\alphaA}%\\n}%\\n\\n\\\\newcommand\\\\initsommet{%\\n  \\\\PfMdefinelist{\\\\sommets}{A,B,C,D,E,F,G,H,I,J,K,L,M,% pas d'espace ?\\n                        N,O,P,Q,R,S,T,U,V,W,X,Y,Z}%\\n}\\n\\n\\\\newcommand\\\\initsommetrep{%\\n  \\\\PfMdefinelist{\\\\sommets}{A,B,C,D,E,F,G,H,I,J,K,L,M,% pas d'espace ?\\n                        N,P,Q,R,S,T,U,V,W,X,Y,Z}%\\n}\\n\\n\\\\newcommand\\\\gettri{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n}\\n\\n\\\\newcommand\\\\getquad{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n}\\n\\n\\\\newcommand\\\\getpenta{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n}\\n\\n\\\\newcommand\\\\gethexa{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n}\\n\\n\\\\newcommand\\\\gethepta{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n}\\n\\n\\\\newcommand\\\\getocto{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n  \\\\randomextract{\\\\sommets}{\\\\pH}%\\n}\\n\\n\\\\newcommand\\\\getnonna{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n  \\\\randomextract{\\\\sommets}{\\\\pH}%\\n  \\\\randomextract{\\\\sommets}{\\\\pI}%\\n}\\n\\n\\\\newcommand\\\\gettreize{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n  \\\\randomextract{\\\\sommets}{\\\\pH}%\\n  \\\\randomextract{\\\\sommets}{\\\\pI}%\\n  \\\\randomextract{\\\\sommets}{\\\\pJ}%\\n  \\\\randomextract{\\\\sommets}{\\\\pK}%\\n  \\\\randomextract{\\\\sommets}{\\\\pL}%\\n  \\\\randomextract{\\\\sommets}{\\\\pM}%\\n}\\n\\n\\\\PfMdefinelist{\\\\quadruplets}{%\\n{2{,}8,9{,}6,6,8},%10\\n{3{,}2,12{,}6,5,12},%13\\n{6{,}6,11{,}2,5,12},%13\\n{7{,}8,10{,}4,5,12},%13\\n{3{,}2,12{,}6,6{,}6,11{,}2},%13\\n{3{,}2,12{,}6,7{,}8,10{,}4},%13\\n{6{,}6,11{,}2,7{,}8,10{,}4},%13\\n{7{,}8,10{,}4,6{,}6,11{,}2},%13\\n{4{,}2,14{,}4,9,12},%15\\n{2{,}6,16{,}8,7{,}2,15{,}4},%17\\n{8,15,10{,}2,13{,}6},%17\\n{2{,}6,16{,}8,8,15},%17\\n{2{,}6,16{,}8,10{,}2,13{,}6},%17\\n{5{,}6,19{,}2,12,16},%20\\n{12,16,5{,}6,19{,}2},%20\\n{7,24,8{,}8,23{,}4},%25\\n{7,24,15,20},%25\\n{8{,}8,23{,}4,15,20},%25\\n{6{,}4,25{,}2,10,24},%26\\n{6{,}4,25{,}2,13{,}2,22{,}4},%26\\n{10,24,13{,}2,22{,}4},%26\\n{10,24,15{,}6,20{,}8},%26\\n{13{,}2,22{,}4,15{,}6,20{,}8},%26\\n{9,40,16{,}8,37{,}4},%41\\n{24{,}6,32{,}8,26{,}6,31{,}2},%41\\n{9,40,26{,}6,31{,}2},%41\\n{24{,}6,32{,}8,16{,}8,37{,}4}%41\\n}%\\n\\n\\\\PfMdefinelist{\\\\Quadruplets}{%pour un fonctionnement avec \\\\fpeval\\n{2.8,9.6,6,8},%10\\n{3.2,12.6,5,12},%13\\n{6.6,11.2,5,12},%13\\n{7.8,10.4,5,12},%13\\n{3.2,12.6,6.6,11.2},%13\\n{3.2,12.6,7.8,10.4},%13\\n{6.6,11.2,7.8,10.4},%13\\n{7.8,10.4,6.6,11.2},%13\\n{4.2,14.4,9,12},%15\\n{2.6,16.8,7.2,15.4},%17\\n{8,15,10.2,13.6},%17\\n{2.6,16.8,8,15},%17\\n{2.6,16.8,10.2,13.6},%17\\n{5.6,19.2,12,16},%20\\n{12,16,5.6,19.2},%20\\n{7,24,8.8,23.4},%25\\n{7,24,15,20},%25\\n{8.8,23.4,15,20},%25\\n{6.4,25.2,10,24},%26\\n{6.4,25.2,13.2,22.4},%26\\n{10,24,13.2,22.4},%26\\n{10,24,15.6,20.8},%26\\n{13.2,22.4,15.6,20.8},%26\\n{9,40,16.8,37.4},%41\\n{24.6,32.8,26.6,31.2},%41\\n{9,40,26.6,31.2},%41\\n{24.6,32.8,16.8,37.4}%41\\n}%\\n\\n\\\\PfMdefinelist{\\\\tripletspytha}{{2{,}8,9{,}6,10},{6,8,10},%10\\n{3{,}2,12{,}6,13},{5,12,13},%13\\n{6{,}6,11{,}2,13},{7{,}8,10{,}4,13},%13\\n{4{,}2,14{,}4,15},{9,12,15},%15\\n{2{,}6,16{,}8,17},{7{,}2,15{,}4,17},%17\\n{8,15,17},{10{,}2,13{,}6,17},%17\\n{5{,}6,19{,}2,20},{12,16,20},%20\\n{7,24,25},{8{,}8,23{,}4,25},%25\\n{15,20,25},%25\\n{8{,}8,23{,}4,25},%25\\n{6{,}4,25{,}2,26},{10,24,26},%26\\n{13{,}2,22{,}4,26},%26\\n{15{,}6,20{,}8,26},%26\\n{9,40,41},{16{,}8,37{,}4,41},%41\\n{24{,}6,32{,}8,41},{26{,}6,31{,}2,41}%41\\n}%\\n\\n\\\\PfMdefinelist{\\\\tripletspythaentier}{%\\n{3,4,5},{5,12,13},{6,8,10},{7,24,25},{8,15,17},{9,12,15},{9,40,41},{10,24,26},{11,60,61},{12,16,20},{12,35,37},{13,84,85},{14,48,50},{15,20,25},{15,36,39},{16,30,34},{16,63,65},{18,24,30},{18,80,82},{20,21,29},{20,48,52},{21,28,35},{21,72,75},{24,32,40},{24,45,51},{24,70,74},{25,60,65},{27,36,45},{28,45,53},{28,96,100},{30,40,50},{30,72,78},{32,60,68},{33,44,55},{33,56,65},{35,84,91},{36,48,60},{36,77,85},{39,52,65},{39,80,89},{40,42,58},{40,75,85},{42,56,70},{45,60,75},{48,55,73},{48,64,80},{51,68,85},{54,72,90},{57,76,95},{60,63,87},{60,80,100},{65,72,97}}%%d'aprs villement.gerard.free.fr\\n\\n\\n\\\\newcommand\\\\initcarre{%\\n  \\\\PfMdefinelist{\\\\carres}{4,9,16,25,36,49,64,81,100}%\\n}\\n\\\\newcommand\\\\getcarre{%\\n  \\\\randomextract{\\\\carres}{\\\\carreA}\\n}\\n\\n%2009-2018\\n  % Source https://ec.europa.eu/eurostat/databrowser/view/ENV_AIR_GGE__custom_743354/default/table?lang=en\\n\\\\PfMdefinelist{\\\\GazSerreEu}{%\\n  {{la },Belgique,131038.46,123642.9},%\\n  {{la },Bulgarie,58617.88,58595.07},%\\n  {{le },Danemark,65734.85,51299.75},%\\n  {{l'},Allemagne,934202.04,888718.56},%\\n  {{l'},Irlande,63985.03,64241.55},%\\n  {{la },Grce,127381.2,96113.19},%\\n  {{l'},Espagne,385211.04,352208.55},%\\n  {{la },France,521519.73,462798.66},%\\n  {{l'},Italie,510950.49,439263.95},%\\n  {{les },{Pays Bas},212360.67,200458.52},%\\n  {{la },Pologne,395464.33,415858.2},%\\n  {{la },Norvge,54280.59,53769.04},%\\n  {{la },Suisse,57276.22,52099.15}%\\n}\\n\\n\\\\newcommand\\\\getGazSerre{%\\n  \\\\randomextract{\\\\GazSerreEu}{\\\\GazSerrePays}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\ArticlePaysGS}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\NomPaysGS}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\ConsoAPaysGS}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\ConsoBPaysGS}%\\n}\\n\\n  \\\\PfMdefinelist{\\\\VehiculesINSEE}{%\\n    {2012,13132,22264,8111,15242},%\\n    {2013,12853,22712,8028,15020},%\\n    {2014,12778,23134,8049,14905},%\\n    {2015,12874,23460,8144,14813},%\\n    {2016,13144,23634,8308,14813},%\\n    {2017,13580,23645,8437,14629},%\\n    {2018,14140,23293,8652,14453},%\\n    {2019,14756,22636,8920,14392}%\\n  }%\\n  \\\\newcommand\\\\getVehiculesINSEE{%\\n    \\\\randomextract{\\\\VehiculesINSEE}{\\\\NbVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\AnneeVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\EssenceVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\DieselVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\KmEssenceVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\KmDieselVehiculesINSEE}%\\n  }\\n\\n  % On met Christ7  la fin :)\\n  \\\\newcommand{\\\\vecteur}[1]{\\\\overrightarrow{\\\\strut #1}}\\n  \\n  \\\\newlength{\\\\ltxt}\\n  \\n  \\\\newcommand\\\\compo[4]{%\\n    \\\\setlength{\\\\ltxt}{\\\\linewidth}\\n    \\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.#1}}\\n    \\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n    \\\\addtolength{\\\\ltxt}{-10pt}\\n    \\\\begin{minipage}{\\\\wd#1}\\n      \\\\includegraphics[scale=#3]{#2.#1}\\n    \\\\end{minipage}\\n    \\\\hfill\\n    \\\\begin{minipage}{\\\\ltxt}\\n      #4\\n    \\\\end{minipage}\\n  }%\\n\\n\\\\newlength{\\\\lntxt}\\n\\\\newcommand{\\\\Compo}[4]{\\n\\\\setlength{\\\\lntxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2}}\\n\\\\addtolength{\\\\lntxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\lntxt}{-10pt}\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2}\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\lntxt}\\n#4\\n\\\\end{minipage}\\n}\\n\\n\\\\newcommand{\\\\Compog}[4]{\\n\\\\setlength{\\\\lntxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2}}\\n\\\\addtolength{\\\\lntxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\lntxt}{-10pt}\\n\\\\begin{minipage}{\\\\lntxt}\\n#4\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2}\\n\\\\end{minipage}\\n}\\n\\n\\\\newlength{\\\\ecart}\\n\\\\setlength{\\\\ecart}{-20pt}\\n\\n\\\\newcommand{\\\\compog}[4]{%\\n\\\\setlength{\\\\ltxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.#1}}\\n\\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\ltxt}{\\\\ecart}\\n\\\\begin{minipage}{\\\\ltxt}\\n#4\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2.#1}\\n\\\\end{minipage}\\n}\\n\\n\\\\newlength{\\\\appui}\\n\\\\setlength{\\\\appui}{20pt}\\n\\n\\\\newlength{\\\\lnttxt}\\n\\\\newcommand\\\\dispo[3]{%\\n\\\\setlength{\\\\lnttxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{#2}\\n\\\\addtolength{\\\\lnttxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\lnttxt}{-\\\\appui}\\n\\\\begin{minipage}{\\\\wd#1}\\n#2\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\lnttxt}\\n#3\\n\\\\end{minipage}\\n}\\n\\n\\\\newcommand\\\\dispog[3]{%\\n\\\\setlength{\\\\lnttxt}{\\\\linewidth}%\\n\\\\setbox#1=\\\\hbox{#2}%\\n\\\\addtolength{\\\\lnttxt}{-\\\\wd#1}%\\n\\\\addtolength{\\\\lnttxt}{-\\\\appui}%\\n\\\\begin{minipage}{\\\\lnttxt}%\\n#3\\n\\\\end{minipage}%\\n\\\\hfill%\\n\\\\begin{minipage}{\\\\wd#1}%\\n#2\\n\\\\end{minipage}%\\n}%\\n\\n\\\\newcommand\\\\compoxe[4][1]{%\\n  \\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.pdf}}%\\n  \\\\setlength{\\\\lnttxt}{\\\\linewidth-\\\\wd#1-\\\\appui}%\\n  \\\\begin{minipage}{\\\\wd#1}%\\n    \\\\usebox#1%\\n  \\\\end{minipage}%\\n  \\\\hfill%\\n  \\\\begin{minipage}{\\\\lnttxt}%\\n    #4%\\n  \\\\end{minipage}%\\n}%\\n\\n\\\\newcommand\\\\compogxe[4][1]{%\\n  \\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.pdf}}%\\n  \\\\setlength{\\\\lnttxt}{\\\\linewidth-\\\\wd#1-\\\\appui}%\\n  \\\\begin{minipage}{\\\\lnttxt}%\\n    #4\\n  \\\\end{minipage}%\\n  \\\\hfill%\\n  \\\\begin{minipage}{\\\\wd#1}%\\n    \\\\usebox#1\\n  \\\\end{minipage}%\\n}%\\n\\n\\\\newcommand{\\\\compogb}[4]{%\\n\\\\setlength{\\\\ltxt}{\\\\linewidth}\\n\\\\BaremeEspaceMarge{-20pt-82pt-\\\\wd#1}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.#1}}\\n\\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\ltxt}{-20pt}\\n\\\\begin{minipage}{\\\\ltxt}\\n#4\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2.#1}\\n\\\\end{minipage}\\n\\\\BaremeEspaceMarge{-82pt}\\n}\\n\\n\\\\newcommand{\\\\dispogb}[3]{\\n\\\\setlength{\\\\ltxt}{\\\\linewidth}\\n\\\\BaremeEspaceMarge{-20pt-82pt-\\\\wd#1}\\n\\\\setbox#1=\\\\hbox{#2}\\n\\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\ltxt}{-\\\\appui}\\n\\\\begin{minipage}{\\\\ltxt}\\n#3\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n#2\\n\\\\end{minipage}\\n\\\\BaremeEspaceMarge{-82pt}\\n}\\n\\n%\\\\AddToHook{env/multicols/begin}{\\\\setcounter{Nbcolonnes}{2}}%\\n%\\\\AddToHook{env/multicols/after}{\\\\setcounter{Nbcolonnes}{4}}%\\n\\n\\\\NewDocumentCommand\\\\Cicontre{s}{%\\n  \\\\ifPfMDeuxColonnes\\n    \\\\IfBooleanTF{#1}{ci-dessous}{ci-dessus}%\\n  \\\\else\\n    ci-contre%\\n  \\\\fi\\n}%\\n\\n\\\\NewDocumentEnvironment{Dispo}{sm+b}{%\\n  \\\\ifPfMDeuxColonnes\\n    \\\\IfBooleanTF{#1}{%\\n      #3\\n      \\\\begin{center}\\n        #2\\n      \\\\end{center}\\n    }{%\\n      \\\\begin{center}\\n        #2\\n      \\\\end{center}\\n      #3\\n    }%\\n  \\\\else%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\dispog{1}{#2}{#3}\\n    }{%\\n      \\\\dispo{1}{#2}{#3}\\n    }%\\n  \\\\fi%\\n}{}%\\n\\n\\\\NewDocumentEnvironment{CALign}{O{&=\\\\dots&}O{&=\\\\dots}mb}{%\\n  % #1 sparateur gnraliste\\n  % #2 sparateur dernire colonne\\n  % #3 nombre de colonnes souhaites\\n  % #4 environnement\\n  \\\\xdef\\\\Foo{#4}%\\n  \\\\setsepchar{}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{\\\\Foo}%\\n  \\\\reademptyitems%\\n  \\\\quotient{\\\\ListeTestlen}{#3}%\\n  \\\\modulo{\\\\ListeTestlen}{#3}%\\n  \\\\begin{align*}\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\n    \\\\xintFor* ##9 in{\\\\xintSeq{0}{\\\\fpeval{\\\\the\\\\intquotient-1}}}\\\\do{%\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{#3}}\\\\do{\\n    \\\\ListeTest[\\\\fpeval{##9*#3+##8}]\\\\xintifForLast{#2}{#1}\\n    }\\\\ifnum##9<\\\\fpeval{\\\\the\\\\intquotient-1}\\\\relax\\\\\\\\\\\\fi\\n    }\\n    \\\\fi\\n    \\\\ifnum\\\\remainder>0\\\\relax\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\\\\\\\\\\\fi\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{\\n    \\\\ListeTest[\\\\fpeval{\\\\the\\\\intquotient*#3+##8}]\\\\xintifForLast{#2}{#1}\\n    }\\n    \\\\fi\\n  \\\\end{align*}\\n}{}%\\n\\n\\\\NewDocumentEnvironment{CALignAv}{O{A&=}mb}{%\\n  % #1 sparateur gnraliste\\n  % #2 nombre de colonnes souhaites\\n  % #3 environnement\\n  \\\\xdef\\\\Foo{#3}%\\n  \\\\setsepchar{}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{\\\\Foo}%\\n  \\\\reademptyitems%\\n  \\\\quotient{\\\\ListeTestlen}{#2}%\\n  \\\\modulo{\\\\ListeTestlen}{#2}%\\n  \\\\begin{align*}\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\n    \\\\xintFor* ##9 in{\\\\xintSeq{0}{\\\\fpeval{\\\\the\\\\intquotient-1}}}\\\\do{%\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{#2}}\\\\do{%\\n    #1\\\\ListeTest[\\\\fpeval{##9*#2+##8}]\\\\ifnum##8<#2\\\\relax\\\\uppercase{&}\\\\fi\\n                                                        }\\\\ifnum##9<\\\\fpeval{\\\\the\\\\intquotient-1}\\\\relax{}\\\\\\\\\\\\fi\\n    }%\\n    \\\\fi%\\n    \\\\ifnum\\\\remainder>0\\\\relax%\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\\\\\\\\\\\fi\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{%\\n    #1\\\\ListeTest[\\\\fpeval{\\\\the\\\\intquotient*#2+##8}]\\\\ifnum##8<\\\\remainder\\\\relax\\\\uppercase{&}\\\\fi\\n                                                                                 }%\\n    \\\\fi%\\n  \\\\end{align*}\\n}{}%\\n\\n\\\\def\\\\RetiensEchelle{1cm}\\n\\\\def\\\\ChoixNbQuestions{5}\\n\\n\\\\NewDocumentCommand\\\\QuestionBoulotold{}{%\\n  \\\\ifboolKV[Boulot]{CAN}{\\\\setKV[ClesExercices]{NbQuestions=1}}{%\\n    \\\\ifboolKV[Boulot]{AMC}{\\\\setKV[ClesExercices]{NbQuestions=1}}{%\\n      \\\\setKV[ClesExercices]{NbQuestions=\\\\ChoixNbQuestions}%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\QuestionBoulot{O{\\\\ChoixNbQuestions}}{%\\n  \\\\ifboolKV[Boulot]{CAN}{%\\n    \\\\setKV[ClesExercices]{NbQuestions=1}%\\n  }{%\\n    \\\\setKV[ClesExercices]{NbQuestions=#1}%\\n  }%\\n}%\\n\\\\makeatletter\\n\\\\if@CAN\\n  \\\\AddToHook{env/document/before}{%\\n    \\\\ProvidesPackage{ProfMaquette}[Mode CAN (CP)]%\\n    \\\\RequirePackage{pgfmorepages}\\n    \\\\pgfmorepagesloadextralayouts\\n    \\\\pgfpagesuselayout{4 on 2, book format}[a4paper,landscape]\\n  }\\n\\\\fi\\n\\n\\\\if@Revision\\n  \\\\AddToHook{env/document/before}{%\\n    \\\\ProvidesPackage{ProfMaquette}[Mode Revision (CP)]%\\n    \\\\setcounter{Nbcolonnes}{2}%\\n    \\\\def\\\\RetiensEchelle{0.5cm}\\n    \\\\RequirePackage{pgfmorepages}\\n    \\\\pgfmorepagesloadextralayouts\\n    \\\\pgfpagesuselayout{4 on 2, book format}[a4paper]\\n  }\\n\\\\fi\\n\\n\\\\if@Personnel\\n  \\\\input{PfMPerso.cfg}\\n\\\\fi\\n\\\\makeatother\\n\\n\\\\IfClassLoadedTF{beamer}{}{%\\n  % enumitem obligatoire ^^\\n% mais pas compatible beamer\\n\\\\RequirePackage{enumitem}\\n% d'aprs https://tex.stackexchange.com/questions/164613/adding-code-at-the-end-of-each-list-item\\n\\\\newif\\\\iffirstlegal\\\\firstlegalfalse% We need a toggle to track whether the item is first in the list or not\\n\\n\\\\newlist{Test}{enumerate}{3}\\n\\n\\\\def\\\\PfMPar{\\\\par}\\n\\n\\\\NewDocumentCommand\\\\litem{}{}\\n\\n\\\\let\\\\olditem\\\\item% save the standard definition of \\\\item in a macro, \\\\olditem\\n\\n\\\\setlist[Test,1]{%\\n  leftmargin=*,\\n  label=\\\\arabic*.,\\n  before={%\\n    \\\\setcounter{PfMProfondeur}{1}%\\n    \\\\setcounter{PfMNbLignesFinitem}{0}\\n    \\\\firstlegaltrue% set the toggle for first item in the list to true\\n    \\\\def\\\\Primeitem{\\\\iffirstlegal\\\\olditem\\\\stepcounter{PfMNbLignesFinitem}%\\n        \\\\firstlegalfalse\\n      \\\\else\\n        \\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]>1\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\\\fi%\\n        \\\\olditem\\\\stepcounter{PfMNbLignesFinitem}%\\n      \\\\fi\\n    }% new, temporary defition of \\\\item\\n    \\\\let\\\\litem\\\\Primeitem\\n    \\\\let\\\\item\\\\litem\\n  },\\n  after={%\\n    \\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]>0\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\\\fi%\\n    % fill for final item in list\\n    \\\\let\\\\litem\\\\olditem% restore standard definition of \\\\item\\n    \\\\let\\\\item\\\\olditem\\n    \\\\setcounter{PfMProfondeur}{0}%\\n  }%\\n}%\\n\\n\\\\setlist[Test,2]{%\\n  leftmargin=*,\\n  label=(\\\\alph*),\\n  before={%\\n    \\\\setcounter{PfMProfondeur}{2}%\\n    \\\\setcounter{PfMNbLignesFinitemi}{0}\\n    \\\\firstlegaltrue%\\n    \\\\def\\\\Seconditem{\\\\iffirstlegal\\\\olditem\\\\stepcounter{PfMNbLignesFinitemi}\\\\firstlegalfalse\\\\else%\\n        \\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]>1\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\n      \\\\fi%\\n        \\\\olditem\\\\stepcounter{PfMNbLignesFinitemi}\\n      \\\\fi\\n    }% new, temporary defition of \\\\item\\n    \\\\let\\\\litem\\\\Seconditem\\n    \\\\let\\\\item\\\\litem\\n  },\\n  after={%\\n    \\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]>1\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\n    \\\\fi%\\n%    % fill for final item in list\\n    \\\\let\\\\litem\\\\Primeitem%\\n    \\\\let\\\\item\\\\litem\\n    \\\\setcounter{PfMProfondeur}{1}%\\n  }%\\n}\\n\\n\\\\newcounter{PfMNbLignesFinitem}\\n\\\\newcounter{PfMNbLignesFinitemi}\\n\\\\newcounter{PfMProfondeur}\\n\\\\setcounter{PfMProfondeur}{0}%\\n\\n\\\\NewDocumentEnvironment{autoenumerate}{O{}m +b}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\ifnum\\\\thePfMProfondeur=0\\\\relax%\\n    \\\\readlist*\\\\PfMListeDesAjoutsdeLignes{#2}%\\n  \\\\else%\\n    \\\\readlist*\\\\PfMListeDesAjoutsdeLignesi{#2}%\\n  \\\\fi%\\n  \\\\begin{Test}[#1]%\\n    #3\\n  \\\\end{Test}%\\n}{}%\\n}%\\n\\n%%%\\n% PixelArt\\n%%%\\n\\\\newtoks\\\\toklistePfMPANombre%\\n\\\\newtoks\\\\tokPfMPXNomCouleur%\\n\\\\def\\\\UpdatetoksPfMPANombre#1\\\\nil{\\\\addtotok\\\\toklistePfMPANombre{\\\"#1\\\",}}%\\n\\\\def\\\\UpdatetoksPfMPXNomCouleur#1\\\\nil{\\\\addtotok\\\\tokPfMPXNomCouleur{\\\"#1\\\",}}%\\n\\n\\\\setKVdefault[PfMPixelArt]{Largeur=29,Hauteur=29,Solution=false,Lettres=ABCDEFGHIJK,Nombres=false,ListeCouleurs={},Unite=5mm,Geant=false,HauteurD=1,LargeurD=1,Complet=false,Numero=1,Separations=false,Deforme=false,Coefx=0.25,Coefy=0.25,Borne=false,Graines=false}%\\n\\\\defKV[PfMPixelArt]{ListeNombres=\\\\setKV[PfMPixelArt]{Nombres}}%\\n\\\\defKV[PfMPixelArt]{Graine=\\\\setKV[PfMPixelArt]{Graines}}%\\n\\n%\\\"mario1.txt\\\"\\n\\n\\\\NewDocumentCommand\\\\PfMPixelArt{o m}{%\\n  \\\\toklistePfMPANombre{}%\\n  \\\\tokPfMPXNomCouleur{}%\\n  \\\\useKVdefault[PfMPixelArt]%\\n  \\\\setKV[PfMPixelArt]{#1}%\\n%  \\\\expandafter\\\\UpdatetoksPfMPXNomFichier\\\\useKV[PixelArt]{Fichier}\\\\nil%\\n%  Le tok fichier est \\\\the\\\\tokPfMPXNomFichier\\n  \\\\xdef\\\\ListeAvantCouleurs{\\\\useKV[PfMPixelArt]{ListeCouleurs}}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListePACouleur{\\\\ListeAvantCouleurs}%\\n  \\\\reademptyitems%\\n  \\\\foreachitem\\\\compteur\\\\in\\\\ListePACouleur{\\\\expandafter\\\\UpdatetoksPfMPXNomCouleur\\\\compteur\\\\nil}%\\n  \\\\ifboolKV[PfMPixelArt]{Nombres}{%\\n    \\\\xdef\\\\ListeAvantNombres{\\\\useKV[PfMPixelArt]{ListeNombres}}%\\n    \\\\setsepchar{,}%\\n    \\\\readlist*\\\\ListePANombre{\\\\ListeAvantNombres}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListePANombre{\\\\expandafter\\\\UpdatetoksPfMPANombre\\\\compteur\\\\nil}%\\n  }{}\\n  \\\\ifboolKV[PfMPixelArt]{Geant}{%\\n    % Dcoupe en hauteur : \\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}}\\\\\\\\\\n    % Dcoupe en largeur : \\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}-1}}\\\\par\\n    \\\\ifboolKV[PfMPixelArt]{Complet}{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{0}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}-1}}}\\\\do{%\\n        \\\\xintFor* ##2 in{\\\\xintSeq{0}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}-1}}}\\\\do{%\\n          \\\\fpeval{##1*\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}+##2} : \\\\PfMBuildPixelArtGeant{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}{##1}{##2}\\\\\\\\%\\n        }%\\n      }%\\n    }{%\\n%      \\\\quotient{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}}}%\\n%      \\\\modulo{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}}}%\\n      \\\\quotient{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}}}%\\n      \\\\modulo{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}}}%\\n%      quotient = \\\\the\\\\intquotient -- remainder = \\\\the\\\\remainder :\\\\\\\\\\n      \\\\PfMBuildPixelArtGeant{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}{\\\\the\\\\intquotient}{\\\\the\\\\remainder}%\\n    }%\\n  }{%\\n    \\\\ifboolKV[PfMPixelArt]{Deforme}{%\\n        \\\\PfMBuildPixelArtDeforme{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}%\\n      }{%\\n        % \\\\PfMBuildPixelArt{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}%\\n        \\\\PfMBuildPixelArt{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\the\\\\tokPfMPXNomCouleur}{\\\\the\\\\toklistePfMPANombre}%%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMBuildPixelArt{m m m m}{%\\n  \\\\ifluatex\\n  \\\\mplibforcehmode\\n  \\\\begin{mplibcode}\\n%    largeur:=\\\\useKV[PfMPixelArt]{Largeur};\\n%    hauteur:=\\\\useKV[PfMPixelArt]{Hauteur};\\n    largeurd:=\\\\useKV[PfMPixelArt]{LargeurD};\\n    hauteurd:=\\\\useKV[PfMPixelArt]{HauteurD};\\n    Unite:=\\\\useKV[PfMPixelArt]{Unite};\\n\\n    boolean Solution,Nombres,Separations,RotationPixel;\\n    Solution:=\\\\useKV[PfMPixelArt]{Solution};\\n    Nombres:=\\\\useKV[PfMPixelArt]{Nombres};\\n    Separations:=\\\\useKV[PfMPixelArt]{Separations};\\n    RotationPixel:=\\\\useKV[PixelArt]{Landscape};\\n    \\n    string BaseLettres;\\n    BaseLettres=str #2;\\n    numeric EchelleScale;\\n    EchelleScale=Unite/5mm;\\n    \\n    color ColorEntier[],ColFond;\\n    n:=0;\\n    for p_=#3:\\n      n:=n+1;\\n      index:=0;\\n      for k=0 upto (length p_-1):\\n      if substring(k,k+1) of p_=\\\"!\\\":\\n      index:=k;\\n      fi;\\n    endfor;\\n    if index>0:  \\n    color base;\\n    base=scantokens(substring(0,index) of p_);\\n    atte:=scantokens(substring(index+1,length p_) of p_);\\n    ColorEntier[n]:=(atte/100)[white,base];\\n    else:\\n    ColorEntier[n]:=scantokens(p_);\\n    fi;\\n%    ColorEntier[n]:=black;\\n    endfor;\\n\\n    string RetiensNombres[];\\n    if Nombres:\\n    k:=0;\\n    for p_=#4:\\n    k:=k+1;\\n    RetiensNombres[k]=p_;\\n    endfor;\\n    else:\\n    m:=0;\\n    for p_=0 upto n-1:\\n    m:=m+1;\\n    RetiensNombres[m]=substring(p_,p_+1) of BaseLettres;\\n    endfor;\\n    fi;\\n\\n    picture Etiquette[];\\n    for k=1 upto n:\\n    Etiquette[k]=image(\\n    label(TEX(RetiensNombres[k]) scaled EchelleScale,(0,0));\\n    );\\n    endfor;\\n\\n    vardef Largeur(expr nomfichier)=\\n      string p_;\\n      p_=readfrom nomfichier;\\n      largeur=(length p_+1) div 2;\\n      closefrom nomfichier;\\n    enddef;\\n\\n    vardef Hauteur(expr nomfichier)=\\n      string p_;\\n      hauteur=0;\\n      p_=readfrom nomfichier;\\n      forever: exitif p_=EOF;\\n        hauteur:=hauteur+1;\\n        p_:=readfrom nomfichier;\\n      endfor;\\n      closefrom nomfichier;\\n    enddef;\\n    \\n    vardef Lecturecsv(expr nomfichier)=\\n    for h=hauteur downto 1:\\n      string p_;\\n      p_=readfrom nomfichier;\\n      l:=0;\\n      for p=0 step 2 until 2*largeur-2:\\n        l:=l+1;\\n        if Solution=false:\\n          if (substring(p,p+1) of p_)=\\\"-\\\":\\n          else:\\n            for m=0 upto (length BaseLettres-1):\\n              if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n              draw Etiquette[m+1] shifted((l-1)*Unite,(h-1)*Unite);\\n              fi;\\n            endfor;\\n          fi;\\n        fi;\\n        if Solution:\\n          if (substring(p,p+1) of p_)=\\\"-\\\":\\n          else:\\n            for m=0 upto (length BaseLettres-1):\\n              if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n                ColFond:=ColorEntier[m+1];\\n              fi;\\n            endfor;\\n            if unknown ColFond:\\n            else:\\n              fill (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite) withcolor ColFond\\n            fi;\\n          fi;\\n        fi;\\n        trace (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite);  \\n      endfor;\\n    endfor;\\n    closefrom nomfichier;\\n    enddef;\\n\\n    Largeur(#1);\\n    Hauteur(#1);\\n%    label.top(TEX(\\\"Largeur = \\\"&decimal(largeur)),(0,-1cm));\\n%    label.bot(TEX(\\\"Hauteur = \\\"&decimal(hauteur)),(0,-1cm));\\n    Lecturecsv(#1);\\n    if Separations:\\n    drawoptions(withcolor Purple);\\n    for k=hauteur step -hauteurd until 0:\\n    draw (Unite*(-1,k-0.5)--Unite*(largeur,k-0.5)) withpen pencircle scaled 1.25;\\n    endfor;\\n    for k=0 step largeurd until largeur:\\n    draw (Unite*(k-0.5,hauteur+0.125)--Unite*(k-0.5,-0.875)) withpen pencircle scaled 1.25;\\n    endfor;\\n    drawoptions();\\n    fi;\\n    if RotationPixel:\\n    picture Retiens;\\n    Retiens:=currentpicture;\\n    currentpicture:=nullpicture;\\n    draw Retiens rotatedabout(center Retiens,90);\\n    fi;\\n  \\\\end{mplibcode}\\n  \\\\fi\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMBuildPixelArtDeforme{m m m m}{%\\n  \\\\ifluatex\\n  \\\\mplibforcehmode\\n  \\\\begin{mplibcode}\\n    largeur:=\\\\useKV[PfMPixelArt]{Largeur};\\n    hauteur:=\\\\useKV[PfMPixelArt]{Hauteur};\\n    largeurd:=\\\\useKV[PfMPixelArt]{LargeurD};\\n    hauteurd:=\\\\useKV[PfMPixelArt]{HauteurD};\\n    Unite:=\\\\useKV[PfMPixelArt]{Unite};\\n\\n    %Deformation\\n    Coefx=\\\\useKV[PfMPixelArt]{Coefx};\\n    Coefy=\\\\useKV[PfMPixelArt]{Coefy};\\n    boolean Borne,Graines;\\n    Borne=\\\\useKV[PfMPixelArt]{Borne};\\n    Graines=\\\\useKV[PfMPixelArt]{Graines};\\n    if Graines:\\n    randomseed:=\\\\useKV[PfMPixelArt]{Graine};\\n    fi;\\n    %\\n    pair M[][];\\n    for l=1 upto hauteur+1:\\n      for c=1 upto largeur+1:\\n      if Borne:\\n      if (l=1) or (l=hauteur+1):\\n      M[l][c]=Unite*(c,l)+Unite*(-Coefx+uniformdeviate(2*Coefx),0);\\n      if (c=1) or (c=largeur+1):\\n      M[l][c]:=Unite*(c,l);\\n      fi;\\n      else:\\n      if (c=1) or (c=largeur+1):\\n      M[l][c]=Unite*(c,l-1)+Unite*(0,uniformdeviate(Coefy));\\n      else:\\n      M[l][c]=Unite*(c,l)+Unite*(-Coefx+uniformdeviate(2*Coefx),-Coefy+uniformdeviate(2*Coefy));\\n      fi;\\n      fi;\\n      else:\\n      M[l][c]=Unite*(c,l)+Unite*(-Coefx+uniformdeviate(2*Coefx),-Coefy+uniformdeviate(2*Coefy));\\n      fi;\\n      %dotlabel(\\\"\\\",M[l][c]);\\n      endfor;\\n    endfor;\\n    \\n    boolean Solution,Nombres,Separations;\\n    Solution:=\\\\useKV[PfMPixelArt]{Solution};\\n    Nombres:=\\\\useKV[PfMPixelArt]{Nombres};\\n    Separations:=\\\\useKV[PfMPixelArt]{Separations};\\n    \\n    string BaseLettres;\\n    BaseLettres=str #2;\\n    numeric EchelleScale;\\n    EchelleScale=Unite/10mm;\\n    \\n    color ColorEntier[],ColFond;\\n    n:=0;\\n    for p_=#3:\\n    n:=n+1;\\n    ColorEntier[n]:=p_;\\n    endfor;\\n\\n    string RetiensNombres[];\\n    if Nombres:\\n    n:=0;\\n    for p_=#4:\\n    n:=n+1;\\n    RetiensNombres[n]=p_;\\n    endfor;\\n    fi;\\n        \\n    vardef Lecturecsv(expr nomfichier)=\\n    for h=hauteur downto 1:\\n    string p_;\\n    p_=readfrom nomfichier;\\n    l:=0;\\n    for p=0 step 2 until 2*largeur-2:\\n    l:=l+1;\\n    if (substring(p,p+1) of p_)=\\\"-\\\":\\n    else:\\n    if Nombres:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    label(TEX(RetiensNombres[m+1]) scaled EchelleScale,iso(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]));\\n    fi;\\n    endfor;\\n    else:\\n    label(TEX(substring(p,p+1) of p_) scaled EchelleScale,iso(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]));\\n    fi;\\n    if Solution:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    ColFond:=ColorEntier[m+1];\\n    fi;\\n    endfor;\\n    if unknown ColFond: else: fill polygone(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]) withcolor ColFond fi;\\n    fi;\\n    trace polygone(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]);\\n   fi;\\n    endfor;\\n    endfor;\\n    closefrom nomfichier;\\n    enddef;\\n    \\n    Lecturecsv(\\\"#1\\\");\\n  \\\\end{mplibcode}\\n\\\\fi\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMBuildPixelArtGeant{m m m m m m}{%\\n  \\\\ifluatex%\\n  \\\\mplibforcehmode%\\n  \\\\begin{mplibcode}%\\n    largeur:=\\\\useKV[PfMPixelArt]{Largeur};\\n    hauteur:=\\\\useKV[PfMPixelArt]{Hauteur};\\n    largeurd:=\\\\useKV[PfMPixelArt]{LargeurD};\\n    hauteurd:=\\\\useKV[PfMPixelArt]{HauteurD};\\n    \\n    Unite:=\\\\useKV[PfMPixelArt]{Unite};\\n\\n    boolean Solution,Nombres;\\n    Solution:=\\\\useKV[PfMPixelArt]{Solution};\\n    Nombres:=\\\\useKV[PfMPixelArt]{Nombres};\\n    \\n    string BaseLettres;\\n    BaseLettres=str #2;\\n\\n    numeric EchelleScale;\\n    EchelleScale=Unite/5mm;\\n    \\n    color ColorEntier[],ColFond;\\n    n:=0;\\n    for p_=#3:\\n    n:=n+1;\\n    ColorEntier[n]:=p_;\\n    endfor;\\n\\n    string RetiensNombres[];\\n    if Nombres:\\n    n:=0;\\n    for p_=#4:\\n    n:=n+1;\\n    RetiensNombres[n]=p_;\\n    endfor;\\n    fi;\\n        \\n    vardef Lecturecsv(expr nomfichier)=\\n    % for h=hauteur-#5*hauteurd downto hauteur-(#5+1)*hauteurd:\\n    for h=hauteur downto 1:\\n    string p_;\\n    p_=readfrom nomfichier;\\n    l:=0;\\n    if (h>hauteur-(#5+1)*hauteurd) and (h<hauteur-#5*hauteurd+1):\\n    for p=2*#6*largeurd step 2 until 2*(#6+1)*largeurd-2:\\n    l:=l+1;\\n    if (substring(p,p+1) of p_)=\\\"-\\\":\\n    else:\\n    if Nombres:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    label(TEX(RetiensNombres[m+1]) scaled EchelleScale,((l-1)*Unite,(h-1)*Unite));\\n    fi;\\n    endfor;\\n    else:\\n    label(TEX(substring(p,p+1) of p_) scaled EchelleScale,((l-1)*Unite,(h-1)*Unite));\\n    fi;\\n    if Solution:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    ColFond:=ColorEntier[m+1];\\n    fi;\\n    endfor;\\n    if unknown ColFond: else: fill (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite) withcolor ColFond fi;\\n    fi;\\n    trace (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite);\\n   fi;\\n   endfor;\\n   fi;\\n    endfor;\\n    closefrom nomfichier;\\n    enddef;\\n    \\n    Lecturecsv(\\\"#1\\\");\\n  \\\\end{mplibcode}\\n  \\\\fi%\\n}%\"","<script lang=\"ts\">\n  import {\n    buildImagesUrlsList,\n    doesLatexNeedsPics,\n    getExosContentList,\n    getPicsNames,\n  } from '../../../lib/Latex'\n  import { type latexFileType } from '../../../lib/LatexTypes'\n\n  import ProfMaquette from '../../../lib/latex/ProfMaquette.sty?raw'\n  import type { IExercice } from '../../../lib/types'\n\n  export let disabled: boolean\n  export let exercices: IExercice[]\n  export let latexFile: latexFileType\n\n  let textForOverleafInput: HTMLInputElement\n  let textForProfMaquette: string = ''\n  let imagesUrls = [] as string[]\n\n  /**\n   * Construction du matriel ncessaire au tlversement vers Overleaf :\n   * -- constitution des URLs pour le tlchargement des images (elles doivent pointer vers un serveur)\n   * -- encodage du contenu du code LaTeX de la feuille d'exercices\n   */\n  async function copyDocumentToOverleaf() {\n    const picsWanted = doesLatexNeedsPics(latexFile.contents)\n    const exosContentList = getExosContentList(exercices)\n    const picsNames = getPicsNames(exosContentList)\n    imagesUrls = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n    textForProfMaquette = latexFile.latexWithPreamble.includes('ProfMaquette')\n      ? 'data:text/plain;base64,' +\n        btoa(unescape(encodeURIComponent(ProfMaquette)))\n      : ''\n    textForOverleafInput.value =\n      'data:text/plain;base64,' +\n      btoa(unescape(encodeURIComponent(latexFile.latexWithPreamble)))\n  }\n</script>\n\n<!--\n  @component\n  Bouton dclenchant l'exportation vers OverLeaf\n\n  ### Paramtres\n\n  * `latex` : code latex du document\n  * `latexFileInfos` : objet contenant les lments de mise en forme du fichier\n  * `disabled` : flag permettant de dsactiver le bouton\n\n  ### Exemple\n  ```tsx\n  <ButtonOverleaf\n    {latex}\n    latexFileInfos={{ title, reference, subtitle, style, nbVersions }}\n    disabled={false}\n  />\n  ```\n -->\n\n<form\n  class=\"{`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\"\n  method=\"POST\"\n  action=\"https://www.overleaf.com/docs\"\n  target=\"_blank\"\n>\n  {#each imagesUrls as imageUrl}\n    <input\n      type=\"hidden\"\n      name=\"snip_uri[]\"\n      value=\"{imageUrl}\"\n      autocomplete=\"off\"\n    />\n    <input\n      type=\"hidden\"\n      name=\"snip_name[]\"\n      value=\"{imageUrl.split('/')[imageUrl.split('/').length - 1]}\"\n      autocomplete=\"off\"\n    />\n  {/each}\n  {#if textForProfMaquette.length > 0}\n    <input\n      type=\"hidden\"\n      name=\"snip_uri[]\"\n      value=\"{textForProfMaquette}\"\n      autocomplete=\"off\"\n    />\n    <input\n      type=\"hidden\"\n      name=\"snip_name[]\"\n      value=\"ProfMaquette.sty\"\n      autocomplete=\"off\"\n    />\n  {/if}\n  <input\n    type=\"hidden\"\n    name=\"snip_uri[]\"\n    bind:this=\"{textForOverleafInput}\"\n    autocomplete=\"off\"\n  />\n  <input\n    type=\"hidden\"\n    name=\"snip_name[]\"\n    value=\"coopmath.tex\"\n    autocomplete=\"off\"\n  />\n  <input type=\"hidden\" name=\"engine\" value=\"lualatex\" autocomplete=\"off\" />\n  <button\n    id=\"btn_overleaf\"\n    type=\"submit\"\n    {disabled}\n    on:click=\"{copyDocumentToOverleaf}\"\n    class=\"{disabled\n      ? 'px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action-lightest  dark:bg-coopmathsdark-action-lightest '\n      : 'px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest'}\"\n  >\n    Aller sur Overleaf\n  </button>\n</form>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n\n  export let images: { src: string; alt: string }[] = []\n  export let interval: number = 3000\n\n  let currentIndex = 0\n  let intervalId: ReturnType<typeof setInterval> | null = null\n\n  function nextSlide() {\n    currentIndex = (currentIndex + 1) % images.length\n  }\n\n  function startAutoPlay() {\n    if (!intervalId && images.length > 1) {\n      intervalId = setInterval(nextSlide, interval)\n    }\n  }\n\n  function stopAutoPlay() {\n    if (intervalId) {\n      clearInterval(intervalId)\n      intervalId = null\n    }\n  }\n\n  onMount(() => {\n    startAutoPlay()\n  })\n\n  onDestroy(() => {\n    stopAutoPlay()\n  })\n</script>\n\n<div class=\"relative w-full overflow-hidden\">\n  {#each images as image, i}\n    <div\n      class=\"w-full transition-opacity duration-300 ease-in-out {i === currentIndex ? 'block opacity-100' : 'hidden opacity-0'}\"\n    >\n      <img\n        src={image.src}\n        alt={image.alt}\n        class=\"block h-auto w-full rounded-r-lg\"\n      />\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  export let title = 'Mon titre'\n  export let icon = 'bxs-file-pdf'\n</script>\n\n<div\n  class=\"{$$props.class ||\n    'mr-4'} block rounded-lg bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)] dark:bg-coopmathsdark-canvas-dark\"\n>\n  {#if icon.length !== 0}\n    <div class=\"flex justify-center items-center p-4\">\n      <i\n        class=\"bx {icon} text-[100px] text-coopmaths-warn dark:text-coopmathsdark-warn\"\n      ></i>\n    </div>\n  {/if}\n  <div class=\"py-6 px-6 md:px-16\">\n    <h5\n      class=\"mb-2 text-3xl font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n    >\n      {title}\n    </h5>\n    <p\n      class=\"flex flex-col space-y-2 w-full mb-4 text-base font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      <slot>\n        Un texte devrait s'afficher ici. Celui-ci est le texte par dfaut.\n      </slot>\n    </p>\n\n    <div class=\"flex flex-col justify-center items-center space-y-2\">\n      {#if $$slots.button1}\n        <slot name=\"button1\">\n          <button\n            type=\"button\"\n            class=\"inline-block rounded bg-primary px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-white shadow-[0_4px_9px_-4px_#3b71ca] transition duration-150 ease-in-out hover:bg-primary-600 hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:bg-primary-600 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-primary-700 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] dark:shadow-[0_4px_9px_-4px_rgba(59,113,202,0.5)] dark:hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]\"\n          >\n            Go somewhere\n          </button>\n        </slot>\n      {/if}\n      {#if $$slots.button2}\n        <slot name=\"button2\">\n          <button\n            type=\"button\"\n            class=\"inline-block rounded bg-primary px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-white shadow-[0_4px_9px_-4px_#3b71ca] transition duration-150 ease-in-out hover:bg-primary-600 hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:bg-primary-600 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-primary-700 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] dark:shadow-[0_4px_9px_-4px_rgba(59,113,202,0.5)] dark:hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]\"\n          >\n            Go somewhere\n          </button>\n        </slot>\n      {/if}\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n\n  export let id: string\n  export let value: (string | number)[] = []\n  export let options: Array<{\n    label: string\n    value: string | number\n    isDisabled?: boolean\n  }> = []\n  export let isDisabled: boolean = false\n  export let size: number | undefined = undefined\n  export let name: string = ''\n  export let darkBackground: boolean = false\n  export let classAddenda: string = ''\n\n  const dispatch = createEventDispatcher()\n\n  function handleChange() {\n    dispatch('change', value)\n  }\n</script>\n\n<!--\n  @component\n  Formulaire de slection multiple\n\n  ### Action :\n  `change` est dispatch lorsque la valeur slectionne change\n\n  ### Paramtres :\n  * `id` : identifiant unique du select\n  * `value` : tableau des valeurs slectionnes\n  * `options` : tableau des options avec label et value\n  * `isDisabled` : dsactive le select\n  * `size` : nombre de lignes visibles\n  * `name` : nom du champ pour les formulaires\n  * `darkBackground` : variante avec fond sombre\n  * `classAddenda` : classes CSS additionnelles\n-->\n\n<select\n  {id}\n  {name}\n  multiple\n  {size}\n  bind:value\n  on:change={handleChange}\n  disabled={isDisabled}\n  class=\"w-full px-2 py-1\n    {darkBackground\n    ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n    : 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n    border rounded\n    border-coopmaths-action dark:border-coopmathsdark-action\n    focus:outline-0 focus:ring-0\n    focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest\n    disabled:opacity-30\n    {classAddenda}\"\n>\n  {#each options as option}\n    <option\n      value={option.value}\n      disabled={option.isDisabled}\n      class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n    >\n      {option.label}\n    </option>\n  {/each}\n</select>\n","<script lang=\"ts\">\n  import Latex from '../../../lib/Latex'\n  import { type LatexFileInfos } from '../../../lib/LatexTypes'\n  import CheckboxWithLabel from './CheckboxWithLabel.svelte'\n  import InputNumber from './InputNumber.svelte'\n  import SelectMultiple from './SelectMultiple.svelte'\n  import SelectUnique from './SelectUnique.svelte'\n\n  export let latexFileInfos: LatexFileInfos\n  export let latex: Latex\n\n  const labelsOptions = [\n    { label: '(aucune)', value: '' },\n    { label: 'a, b, c, ...', value: '\\\\alph*)' },\n    { label: 'A, B, C, ...', value: '\\\\Alph*)' },\n    { label: 'i, ii, iii, ...', value: '\\\\roman*)' },\n    { label: 'I, II, III, ...', value: '\\\\Roman*)' },\n    { label: '1, 2, 3, ...', value: '\\\\arabic*)' },\n  ]\n\n  $: exercicesOptions = latex.getExercices().map((exo) => ({\n    label: `${exo.index + 1} - ${exo.titre}`,\n    value: exo.index,\n  }))\n\n  let selectedExos: number[] = Array.from(\n    { length: latex.exercices.length },\n    (_, i) => i,\n  ) // exos slectionns pour appliquer config globale\n  let globalConfig = {\n    labels: '',\n    itemsep: { enabled: false, value: 1 },\n    cols: { enabled: false, value: 1 },\n    cols_corr: { enabled: false, value: 1 },\n    blocrep: { enabled: false, nbligs: 5, nbcols: 1 },\n  }\n\n  function applyGlobalConfig() {\n    latexFileInfos.exos = latexFileInfos.exos || {}\n    for (const idx of selectedExos) {\n      const exoConfig: any = {}\n\n      if (globalConfig.labels !== '' && globalConfig.labels !== undefined) {\n        exoConfig.labels = globalConfig.labels\n      }\n\n      if (globalConfig.itemsep.enabled) {\n        exoConfig.itemsep = globalConfig.itemsep.value\n      }\n\n      if (globalConfig.cols?.enabled) {\n        exoConfig.cols = globalConfig.cols.value\n      }\n\n      if (globalConfig.cols_corr?.enabled) {\n        exoConfig.cols_corr = globalConfig.cols_corr.value\n      }\n\n      if (globalConfig.blocrep?.enabled) {\n        exoConfig.blocrep = {\n          nbligs: globalConfig.blocrep.nbligs,\n          nbcols: globalConfig.blocrep.nbcols,\n        }\n      }\n      latexFileInfos.exos[idx] = {\n        ...latexFileInfos.exos[idx],\n        ...exoConfig,\n      }\n    }\n  }\n\n  function cancelAllChanges() {\n    // Rinitialise toutes les configurations des exercices\n    latexFileInfos.exos = {}\n    selectedExos = []\n    globalConfig = {\n      labels: '',\n      itemsep: { enabled: false, value: 1 },\n      cols: { enabled: false, value: 1 },\n      cols_corr: { enabled: false, value: 1 },\n      blocrep: { enabled: false, nbligs: 5, nbcols: 1 },\n    }\n  }\n</script>\n\n<section class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto\">\n  <h3 class=\"text-lg font-semibold mb-3 text-center\">\n    Configuration globale des exercices\n  </h3>\n  <div class=\"flex flex-col gap-3 items-start\">\n    <!-- Labels -->\n    <div class=\"flex flex-col w-50 text-left\">\n      Numrotation des questions\n      <SelectUnique\n        id=\"global-config-labels\"\n        bind:value={globalConfig.labels}\n        options={labelsOptions}\n        classAddenda=\"mt-1\"\n      />\n    </div>\n\n    <!-- Itemsep -->\n    <div class=\"flex flex-col w-full text-left\">\n      Espace entre les questions\n      <div class=\"flex flex-row items-center gap-2 w-30\">\n        <CheckboxWithLabel\n          id=\"global-config-itemsep-enabled\"\n          bind:isChecked={globalConfig.itemsep.enabled}\n        />\n        <InputNumber\n          id=\"global-config-itemsep\"\n          min={0}\n          max={50}\n          isDisabled={!globalConfig.itemsep.enabled}\n          bind:value={globalConfig.itemsep.value}\n        />\n      </div>\n    </div>\n\n    <!-- Colonnes -->\n    <div class=\"flex flex-col w-full text-left\">\n      Nombre de colonnes pour l'exercice\n      <div class=\"flex flex-row items-center gap-2 w-30\">\n        <CheckboxWithLabel\n          id=\"global-config-cols-enabled\"\n          bind:isChecked={globalConfig.cols.enabled}\n        />\n        <InputNumber\n          id=\"global-config-cols\"\n          min={1}\n          max={5}\n          isDisabled={!globalConfig.cols.enabled}\n          bind:value={globalConfig.cols.value}\n        />\n      </div>\n    </div>\n\n    <div class=\"flex flex-col w-full text-left\">\n      Nombre de colonnes pour la correction\n      <div class=\"flex flex-row items-center gap-2 w-30\">\n        <CheckboxWithLabel\n          id=\"global-config-cols-corr-enabled\"\n          bind:isChecked={globalConfig.cols_corr.enabled}\n        />\n        <InputNumber\n          id=\"global-config-cols-corr\"\n          min={1}\n          max={5}\n          isDisabled={!globalConfig.cols_corr.enabled}\n          bind:value={globalConfig.cols_corr.value}\n        />\n      </div>\n    </div>\n\n    <!-- Bloc rponse -->\n    <fieldset class=\"flex flex-col gap-4 w-full\">\n      <legend class=\"text-left font-medium\">Bloc rponse</legend>\n      <CheckboxWithLabel\n        id=\"global-config-blocrep-enabled\"\n        bind:isChecked={globalConfig.blocrep.enabled}\n        label=\"Activer le bloc rponse\"\n      />\n\n      <div>\n        <div class=\"flex flex-row items-center gap-2 w-60\">\n          <label for=\"global-config-blocrep-nbligs\" class=\"w-32 text-left\"\n            >Nombre de lignes</label\n          >\n          <InputNumber\n            id=\"global-config-blocrep-nbligs\"\n            min={1}\n            max={20}\n            isDisabled={!globalConfig.blocrep.enabled}\n            bind:value={globalConfig.blocrep.nbligs}\n          />\n        </div>\n\n        <div class=\"flex flex-row items-center gap-2 w-60 mt-2\">\n          <label for=\"global-config-blocrep-nbcols\" class=\"w-32 text-left\"\n            >Nombre de colonnes</label\n          >\n          <InputNumber\n            id=\"global-config-blocrep-nbcols\"\n            min={1}\n            max={20}\n            isDisabled={!globalConfig.blocrep.enabled}\n            bind:value={globalConfig.blocrep.nbcols}\n          />\n        </div>\n      </div>\n    </fieldset>\n\n    <!-- Exercices cibls -->\n    <label class=\"flex flex-col w-full\">\n      Appliquer aux exercices :\n      <SelectMultiple\n        id=\"global-config-selectedExos\"\n        bind:value={selectedExos}\n        options={exercicesOptions}\n        classAddenda=\"mt-1 h-24\"\n      />\n    </label>\n  </div>\n\n  <!-- Boutons daction -->\n  <div class=\"pt-4 flex flex-col sm:flex-row sm:flex-wrap gap-3 justify-start\">\n    <button\n      type=\"button\"\n      on:click={applyGlobalConfig}\n      class=\"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-500\"\n    >\n      Appliquer\n    </button>\n\n    <button\n      type=\"button\"\n      class=\"px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600\"\n      on:click={cancelAllChanges}\n    >\n      Annuler les changements\n    </button>\n  </div>\n</section>\n","<script lang=\"ts\">\n  import Latex from '../../../lib/Latex'\n  import { type LatexFileInfos } from '../../../lib/LatexTypes'\n  import InputNumber from './InputNumber.svelte'\n  import SelectUnique from './SelectUnique.svelte'\n\n  export let latexFileInfos: LatexFileInfos\n  export let latex: Latex\n\n  const labelsOptions = [\n    { label: '(aucune)', value: '' },\n    { label: '\\\\alph* : a, b, c, ...', value: '\\\\alph*)' },\n    { label: '\\\\Alph* : A, B, C, ...', value: '\\\\Alph*)' },\n    { label: '\\\\roman* : i, ii, iii, ...', value: '\\\\roman*)' },\n    { label: '\\\\Roman* : I, II, III, ...', value: '\\\\Roman*)' },\n    { label: '\\\\arabic* : 1, 2, 3, ...', value: '\\\\arabic*)' },\n  ]\n</script>\n\n<section class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto\">\n  <h3 class=\"text-lg font-semibold mb-3\">\n    Configuration individuelle des exercices\n  </h3>\n  {#each latex.getExercices() as exo}\n    <fieldset\n      style=\"margin-top:1rem; border-radius:0.5rem; padding:0.5rem; border:1px solid #ccc;\"\n    >\n      <legend class=\"px-2 text-base font-semibold text-gray-700\"\n        >Exercice {exo.index + 1}</legend\n      >\n      <div class=\"mt-2 mb-3 space-y-1\">\n        <div class=\"text-sm text-gray-600\">\n          <span class=\"font-medium text-gray-800\">Titre :</span>\n          {exo.titre}\n        </div>\n        <div class=\"text-sm text-gray-500 truncate\">\n          <span class=\"font-medium text-gray-700\">UUID :</span>\n          {exo.uuid}\n        </div>\n      </div>\n      <label class=\"flex flex-col text-left w-60 my-4\">\n        Numration des questions\n        <SelectUnique\n          id=\"individual-config-labels-{exo.index}\"\n          value={latexFileInfos.exos?.[exo.index]?.labels ?? ''}\n          options={labelsOptions}\n          classAddenda=\"w-40\"\n          on:change={(e) => {\n            latexFileInfos.exos = latexFileInfos.exos || {}\n            latexFileInfos.exos[exo.index] =\n              latexFileInfos.exos[exo.index] || {}\n            latexFileInfos.exos[exo.index].labels = e.detail || undefined\n          }}\n        />\n      </label>\n      <div class=\"flex flex-col text-left w-60 my-4\">\n        <label for=\"individual-config-itemsep-{exo.index}\"\n          >Espace entre les questions</label\n        >\n        <InputNumber\n          id=\"individual-config-itemsep-{exo.index}\"\n          min={0}\n          max={50}\n          value={latexFileInfos.exos?.[exo.index]?.itemsep ?? undefined}\n          on:change={(e) => {\n            latexFileInfos.exos = latexFileInfos.exos || {}\n            latexFileInfos.exos[exo.index] =\n              latexFileInfos.exos[exo.index] || {}\n            if (e.detail === undefined) {\n              delete latexFileInfos.exos[exo.index].itemsep\n            } else {\n              latexFileInfos.exos[exo.index].itemsep = e.detail\n            }\n          }}\n        />\n      </div>\n      <div class=\"flex flex-col text-left w-60 my-4\">\n        <label for=\"individual-config-cols-{exo.index}\"\n          >Nombre de colonnes pour l'exercice</label\n        >\n        <InputNumber\n          id=\"individual-config-cols-{exo.index}\"\n          min={1}\n          max={5}\n          value={latexFileInfos.exos?.[exo.index]?.cols}\n          on:change={(e) => {\n            latexFileInfos.exos = latexFileInfos.exos || {}\n            latexFileInfos.exos[exo.index] =\n              latexFileInfos.exos[exo.index] || {}\n            if (e.detail === undefined) {\n              delete latexFileInfos.exos[exo.index].cols\n            } else {\n              latexFileInfos.exos[exo.index].cols = e.detail\n            }\n          }}\n        />\n      </div>\n      <div class=\"flex flex-col text-left w-60 my-4\">\n        <label for=\"individual-config-cols-corr-{exo.index}\"\n          >Nombre de colonnes pour la correction</label\n        >\n        <InputNumber\n          id=\"individual-config-cols-corr-{exo.index}\"\n          min={1}\n          max={5}\n          value={latexFileInfos.exos?.[exo.index]?.cols_corr}\n          on:change={(e) => {\n            latexFileInfos.exos = latexFileInfos.exos || {}\n            latexFileInfos.exos[exo.index] =\n              latexFileInfos.exos[exo.index] || {}\n            if (e.detail === undefined) {\n              delete latexFileInfos.exos[exo.index].cols_corr\n            } else {\n              latexFileInfos.exos[exo.index].cols_corr = e.detail\n            }\n          }}\n        />\n      </div>\n      <fieldset>\n        <legend class=\"flex flex-col text-left w-60 mt-4\">Bloc rponse</legend>\n        <div class=\"flex flex-col text-left w-60 mb-2\">\n          <label for=\"individual-config-blocrep-nbligs-{exo.index}\"\n            >Nombre de lignes</label\n          >\n          <InputNumber\n            id=\"individual-config-blocrep-nbligs-{exo.index}\"\n            min={1}\n            max={20}\n            value={latexFileInfos.exos?.[exo.index]?.blocrep?.nbligs}\n            on:change={(e) => {\n              latexFileInfos.exos = latexFileInfos.exos || {}\n              latexFileInfos.exos[exo.index] =\n                latexFileInfos.exos[exo.index] || {}\n              if (e.detail === undefined) {\n                delete latexFileInfos.exos[exo.index].blocrep\n              } else {\n                const blocrep = latexFileInfos.exos[exo.index].blocrep || {\n                  nbligs: 1,\n                  nbcols: 1,\n                }\n                blocrep.nbligs = e.detail\n                latexFileInfos.exos[exo.index].blocrep = blocrep\n              }\n            }}\n          />\n        </div>\n        <div class=\"flex flex-col text-left w-60 mb-4\">\n          <label for=\"individual-config-blocrep-nbcols-{exo.index}\"\n            >Nombre de colonnes</label\n          >\n          <InputNumber\n            id=\"individual-config-blocrep-nbcols-{exo.index}\"\n            min={1}\n            max={20}\n            value={latexFileInfos.exos?.[exo.index]?.blocrep?.nbcols}\n            on:change={(e) => {\n              latexFileInfos.exos = latexFileInfos.exos || {}\n              latexFileInfos.exos[exo.index] =\n                latexFileInfos.exos[exo.index] || {}\n              if (e.detail === undefined) {\n                delete latexFileInfos.exos[exo.index].blocrep\n              } else {\n                const blocrep = latexFileInfos.exos[exo.index].blocrep || {\n                  nbligs: 1,\n                  nbcols: 1,\n                }\n                blocrep.nbcols = e.detail\n                latexFileInfos.exos[exo.index].blocrep = blocrep\n              }\n            }}\n          />\n        </div>\n      </fieldset>\n    </fieldset>\n  {/each}\n\n  <!-- Card JSON -->\n  <div class=\"w-full mt-6 p-4 border rounded-2xl shadow bg-gray-50\">\n    <h2 class=\"text-lg font-bold mb-3\">Aperu JSON</h2>\n    <pre\n      class=\"bg-gray-900 text-green-200 p-3 text-left rounded-lg text-sm overflow-x-auto max-h-80\">{JSON.stringify(\n        latexFileInfos.exos || {},\n        null,\n        2,\n      )}\n      </pre>\n  </div>\n</section>\n","<script lang=\"ts\">\n  import Latex from '../../../lib/Latex'\n  import { type LatexFileInfos } from '../../../lib/LatexTypes'\n  import FormConfigGlobal from './FormConfigGlobal.svelte'\n  import FormConfigIndividual from './FormConfigIndividual.svelte'\n\n  export let latex: Latex\n  export let latexFileInfos: LatexFileInfos\n  export let callback: () => void\n\n  /**\n   * Affiche ou ferme si dj ouvert le code Latex dans une boite de dialogue\n   */\n  async function dialogConfigToDisplayToggle() {\n    const dialog = document.getElementById('configLatex') as HTMLDialogElement\n    if (dialog.open) {\n      dialog.close()\n      callback()\n    } else {\n      dialog.showModal()\n    }\n  }\n</script>\n\n<form\n  class={`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\n  target=\"_blank\"\n>\n  <button\n    id=\"btn_config\"\n    type=\"submit\"\n    on:click|preventDefault={dialogConfigToDisplayToggle}\n    class=\"px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n  >\n    Paramtrer\n  </button>\n</form>\n\n<dialog\n  class=\"fixed rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus left-[2%] top-[2%] w-[96%] h-[96%] dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  id=\"configLatex\"\n>\n  <div class=\"mt-3 text-center\">\n    <div class=\"text-3xl font-medium text-coopmaths-warn-dark\">\n      <span class=\"header\">\n        <div class=\"absolute top-2 right-3\">\n          <button\n            type=\"button\"\n            aria-label=\"Fermer la configuration\"\n            on:click={() => {\n              dialogConfigToDisplayToggle()\n            }}\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n            ></i>\n          </button>\n        </div>\n      </span>\n    </div>\n\n    <!-- Config globale -->\n    <FormConfigGlobal bind:latexFileInfos {latex} />\n\n    <!-- Config individuelle -->\n    <FormConfigIndividual bind:latexFileInfos {latex} />\n\n    <!-- Card JSON -->\n    <div class=\"w-full mt-6 p-4 border rounded-2xl shadow bg-gray-50\">\n      <h2 class=\"text-lg font-bold mb-3\">Aperu JSON</h2>\n      <pre\n        class=\"bg-gray-900 text-green-200 p-3 text-left rounded-lg text-sm overflow-x-auto max-h-80\">{JSON.stringify(\n          latexFileInfos.exos || {},\n          null,\n          2,\n        )}\n      </pre>\n    </div>\n  </div>\n</dialog>\n","<script lang=\"ts\">\n  import type Latex from '../../../lib/Latex'\n  import type { LatexFileInfos } from '../../../lib/LatexTypes'\n  import ButtonConfig from '../../shared/forms/ButtonConfig.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import InputNumber from '../../shared/forms/InputNumber.svelte'\n  import InputText from '../../shared/forms/InputText.svelte'\n\n  export let latexFileInfos: LatexFileInfos\n  export let latex: Latex\n  export let promise: Promise<any> | null = null\n\n  const isExerciceStaticInTheList = latex.isExerciceStaticInTheList()\n</script>\n\n<h5\n  class=\"mb-2 text-3xl font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Mise en page\n</h5>\n<h6\n  class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Modle\n</h6>\n<FormRadio\n  title=\"Style\"\n  orientation={'col'}\n  bind:valueSelected={latexFileInfos.style}\n  labelsValues={[\n    { label: 'Classique', value: 'Classique' },\n    { label: 'ProfMaquette', value: 'ProfMaquette' },\n    { label: 'Coopmaths', value: 'Coopmaths' },\n    {\n      label: 'Course aux nombres',\n      value: 'Can',\n      isDisabled: isExerciceStaticInTheList,\n    },\n  ]}\n/>\n{#if latexFileInfos.style === 'Coopmaths' || latexFileInfos.style === 'Classique' || latexFileInfos.style === 'ProfMaquetteQrcode'}\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Police de caractres\n  </h6>\n  <FormRadio\n    title=\"fontOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.fontOption}\n    labelsValues={[\n      { label: 'Standard', value: 'StandardFont' },\n      { label: 'Dys', value: 'DysFont' },\n    ]}\n  />\n  {#if latexFileInfos.fontOption === 'StandardFont'}\n    <span class=\"flex items-center gap-2 w-30\">\n      Taille:\n      <InputNumber\n        id=\"export-latex-taille-input\"\n        min={8}\n        max={20}\n        bind:value={latexFileInfos.tailleFontOption}\n      />\n    </span>\n  {/if}\n  {#if latexFileInfos.fontOption === 'DysFont'}\n    <span class=\"flex items-center gap-2 w-30\">\n      Taille:\n      <InputNumber\n        id=\"export-latex-dys-taille-input\"\n        min={8}\n        max={20}\n        bind:value={latexFileInfos.dysTailleFontOption}\n      />\n    </span>\n  {/if}\n{/if}\n{#if latexFileInfos.style === 'Can'}\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Options\n  </h6>\n  <FormRadio\n    title=\"durationCanOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.correctionOption}\n    labelsValues={[\n      { label: 'Avec correction', value: 'AvecCorrection' },\n      { label: 'Sans correction', value: 'SansCorrection' },\n    ]}\n  />\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Police de caractres\n  </h6>\n  <FormRadio\n    title=\"fontOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.fontOption}\n    labelsValues={[\n      { label: 'Standard', value: 'StandardFont' },\n      { label: 'Dys', value: 'DysFont' },\n    ]}\n  />\n  {#if latexFileInfos.fontOption === 'StandardFont'}\n    <span class=\"flex items-center gap-2 w-30\">\n      Taille:\n      <InputNumber\n        id=\"export-latex-can-taille-input\"\n        min={8}\n        max={20}\n        bind:value={latexFileInfos.tailleFontOption}\n      />\n    </span>\n  {/if}\n  {#if latexFileInfos.fontOption === 'DysFont'}\n    <span class=\"flex items-center gap-2 w-30\">\n      Taille :\n      <InputNumber\n        id=\"export-latex-can-dys-taille-input\"\n        min={8}\n        max={20}\n        bind:value={latexFileInfos.dysTailleFontOption}\n      />\n    </span>\n  {/if}\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Dure :\n  </h6>\n  <span class=\"w-30\">\n    <InputText\n      inputID=\"export-latex-duree-input\"\n      placeholder=\"9 min\"\n      bind:value={latexFileInfos.durationCanOption}\n      showTitle={false}\n      classAddenda=\"placeholder:opacity-40\"\n    />\n  </span>\n{/if}\n{#if latexFileInfos.style === 'ProfMaquette'}\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Options\n  </h6>\n  <FormRadio\n    title=\"correctionOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.correctionOption}\n    labelsValues={[\n      { label: 'Avec correction', value: 'AvecCorrection' },\n      { label: 'Sans correction', value: 'SansCorrection' },\n    ]}\n  />\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Format\n  </h6>\n  <FormRadio\n    title=\"typeFiche\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.typeFiche}\n    labelsValues={[\n      { label: 'Fiche', value: 'Fiche' },\n      { label: 'valuation', value: 'Eval' },\n    ]}\n  />\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Configuration\n  </h6>\n  {#await promise}\n    <p>Chargement en cours...</p>\n  {:then}\n    <ButtonConfig\n      class=\"\"\n      {latex}\n      {latexFileInfos}\n      callback={() => {\n        latexFileInfos = { ...latexFileInfos } // force la ractivit\n      }}\n    />\n  {/await}\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Exercices\n  </h6>\n  <FormRadio\n    title=\"titlenOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.titleOption}\n    labelsValues={[\n      { label: 'Avec titre', value: 'AvecTitre' },\n      { label: 'Sans titre', value: 'SansTitre' },\n    ]}\n  />\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Police de caractres\n  </h6>\n  <FormRadio\n    title=\"fontOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.fontOption}\n    labelsValues={[\n      { label: 'Standard', value: 'StandardFont' },\n      { label: 'Dys', value: 'DysFont' },\n    ]}\n  />\n  {#if latexFileInfos.fontOption === 'StandardFont'}\n    <span class=\"flex items-center gap-2 w-30\">\n      Taille:\n      <InputNumber\n        id=\"export-latex-prof-taille-input\"\n        min={8}\n        max={20}\n        bind:value={latexFileInfos.tailleFontOption}\n      />\n    </span>\n  {/if}\n  {#if latexFileInfos.fontOption === 'DysFont'}\n    <span class=\"flex items-center gap-2 w-30\">\n      Taille:\n      <InputNumber\n        id=\"export-latex-prof-dys-taille-input\"\n        min={8}\n        max={20}\n        bind:value={latexFileInfos.dysTailleFontOption}\n      />\n    </span>\n  {/if}\n  <h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n  >\n    Qrcode\n  </h6>\n  <FormRadio\n    title=\"qrcodeOption\"\n    orientation={'col'}\n    bind:valueSelected={latexFileInfos.qrcodeOption}\n    labelsValues={[\n      { label: 'Avec', value: 'AvecQrcode' },\n      { label: 'Sans', value: 'SansQrcode' },\n    ]}\n  />\n{/if}\n","// Helpers pour encoder/dcoder\nexport function encodeBase64(obj: any): string {\n  return btoa(unescape(encodeURIComponent(JSON.stringify(obj))))\n}\n\nexport function decodeBase64(str: string): any {\n  try {\n    return JSON.parse(decodeURIComponent(escape(atob(str))))\n  } catch (e) {\n    return {}\n  }\n}\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate, onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import { downloadTexWithImagesZip, downloadZip } from '../../../lib/files'\n  import Latex, {\n    doesLatexNeedsPics,\n    getExosContentList,\n    getPicsNames,\n    makeImageFilesUrls,\n  } from '../../../lib/Latex'\n  import {\n    type Exo,\n    type LatexFileInfos,\n    type latexFileType,\n    type picFile,\n  } from '../../../lib/LatexTypes'\n  import {\n    mathaleaGetExercicesFromParams,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea.js'\n  import { mathaleaGoToView } from '../../../lib/mathaleaUtils'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import type { IExercice } from '../../../lib/types'\n  import Footer from '../../Footer.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonCompileLatexToPDF from '../../shared/forms/ButtonCompileLatexToPDF.svelte'\n  import ButtonOverleaf from '../../shared/forms/ButtonOverleaf.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import InputNumber from '../../shared/forms/InputNumber.svelte'\n  import InputText from '../../shared/forms/InputText.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import BasicClassicModal from '../../shared/modal/BasicClassicModal.svelte'\n  import ImageCarousel from '../../shared/ui/ImageCarousel.svelte'\n  import SimpleCard from '../../shared/ui/SimpleCard.svelte'\n  import FormConfigSection from './FormConfigSection.svelte'\n  import { decodeBase64, encodeBase64 } from './LatexConfig'\n\n  const url = new URL(window.location.href)\n  const decoded = decodeBase64(\n    url.searchParams.get('pdfParam') || '',\n  ) as Partial<LatexFileInfos>\n\n  /**\n   * Toutes les variables configurables par l'interface WEB\n   * qui adaptent la sortie PDF\n   */\n  let latexFileInfos: LatexFileInfos = {\n    title: '',\n    reference: '',\n    subtitle: '',\n    style: 'Coopmaths',\n    fontOption: 'StandardFont',\n    tailleFontOption: 12,\n    dysTailleFontOption: 14,\n    correctionOption: 'AvecCorrection',\n    qrcodeOption: 'SansQrcode',\n    typeFiche: 'Fiche',\n    durationCanOption: '9 min',\n    titleOption: 'SansTitre',\n    nbVersions: 1,\n    exos: {}, // tu peux garder vide par dfaut\n    ...decoded, //  crase les valeurs par dfaut si prsente\n  }\n\n  const imgStylePartialUrls = {\n    Coopmaths: 'images/exports/export-coopmaths',\n    Classique: 'images/exports/export-classique',\n    ProfMaquette: 'images/exports/export-profmaquette',\n    ProfMaquetteQrcode: 'images/exports/export-profmaquette-qrcode',\n    Can: 'images/exports/export-can',\n  }\n\n  $: carouselImages = [\n    {\n      src: `${imgStylePartialUrls[latexFileInfos.style]}-thumb1.png`,\n      alt: `${latexFileInfos.style} image-1`,\n    },\n    {\n      src: `${imgStylePartialUrls[latexFileInfos.style]}-thumb2.png`,\n      alt: `${latexFileInfos.style} image-2`,\n    },\n  ]\n\n  let dialogLua: HTMLDialogElement\n  let exercices: IExercice[]\n  let latexFile: latexFileType = {\n    contents: { preamble: '', intro: '', content: '', contentCorr: '' },\n    latexWithoutPreamble: '',\n    latexWithPreamble: '',\n  }\n\n  let picsWanted: boolean\n  let messageForCopyPasteModal: string\n  let picsNames: picFile[][] = []\n  let exosContentList: Exo[] = []\n  let divText: HTMLDivElement\n  let promise: Promise<void>\n  let isDownloadPicsModalDisplayed = false\n  let pdfParam = ''\n\n  const latex = new Latex()\n\n  async function initExercices() {\n    // console.log('initExercices')\n    const interfaceParams = get(exercicesParams)\n    interfaceParams.forEach((e) => {\n      e.interactif = '0'\n    })\n    mathaleaUpdateUrlFromExercicesParams(interfaceParams)\n    exercices = await mathaleaGetExercicesFromParams(interfaceParams)\n    latex.addExercices(exercices.filter((ex) => ex.typeExercice !== 'html'))\n    latexFile.contents = await latex.getContents(latexFileInfos)\n    picsWanted = doesLatexNeedsPics(latexFile.contents)\n    messageForCopyPasteModal = buildMessageForCopyPaste(picsWanted)\n  }\n\n  async function updateLatexWithAbortController() {\n    const clone = UpdateController.update()\n    if (clone.signal?.aborted) {\n      return Promise.reject(\n        new DOMException(\n          'Aborted in updateLatexWithAbortController',\n          'AbortError',\n        ),\n      )\n    }\n\n    return new Promise<void>(async (resolve, reject) => {\n      // Listen for abort event on signal\n      const rej = () => {\n        log('reject')\n        clone.signal?.removeEventListener('abort', rej)\n        reject(\n          new DOMException(\n            'Aborted in updateLatexWithAbortController',\n            'AbortError',\n          ),\n        )\n      }\n      clone.signal?.addEventListener('abort', rej)\n      // Something fake async\n      await updateLatex(clone)\n        .then(() => {\n          clone.signal?.removeEventListener('abort', rej)\n          log('Promise resolu')\n          resolve()\n        })\n        .catch((err) => {\n          reject(new DOMException(`Aborted : ${err.message}`, 'AbortError'))\n        })\n    })\n  }\n\n  async function updateLatex(clone: LatexFileInfos) {\n    try {\n      log('updateLatex')\n      // await new Promise((resolve) => setTimeout(resolve, 10000))\n      latexFile = await latex.getFile(clone)\n      log('fin updateLatex')\n    } catch (error) {\n      if (error instanceof DOMException && error.name === 'AbortError') {\n        // nouvelle demande de fichier LATEX demande\n        throw error\n      }\n      console.error('Erreur lors de la cration du code LaTeX :', error)\n      latexFile.latexWithoutPreamble = '% Erreur  signaler'\n    }\n  }\n\n  class UpdateController {\n    static controller: AbortController | undefined\n    static update() {\n      if (UpdateController.controller === undefined) {\n        UpdateController.controller = new AbortController()\n      } else {\n        UpdateController.controller.abort()\n        UpdateController.controller = new AbortController()\n      }\n      const clone = structuredClone(latexFileInfos)\n      clone.signal = UpdateController.controller.signal\n      return clone\n    }\n  }\n\n  const debug = false\n  function log(str: string) {\n    if (debug) {\n      console.info(str)\n    }\n  }\n\n  $: {\n    if (latex.exercices.length > 0) {\n      log('update')\n      latexFileInfos = {\n        ...latexFileInfos,\n        exos: {\n          ...latexFileInfos.exos,\n          // les blocrep sont dj des sous-objets clons quand tu les modifies\n        },\n      }\n\n      pdfParam = encodeBase64(latexFileInfos)\n      url.searchParams.set('pdfParam', pdfParam)\n      history.replaceState(null, '', url) // change lURL sans recharger\n\n      promise = updateLatexWithAbortController().catch((err) => {\n        if (err.name === 'AbortError') {\n          log('Promise Aborted')\n        } else {\n          log('Promise Rejected')\n        }\n      })\n    }\n  }\n\n  async function forceUpdate() {\n    log('forceUpdate')\n    latexFileInfos.title = latexFileInfos.title\n  }\n\n  onMount(async () => {\n    // console.log('onMount')\n    promise = initExercices()\n      .then(() => updateLatexWithAbortController())\n      .catch((err) => {\n        if (err.name === 'AbortError') {\n          log('Promise Aborted')\n        } else {\n          log('Promise Rejected')\n        }\n      })\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    mathaleaRenderDiv(divText)\n    // console.log('fin onMount')\n  })\n\n  onDestroy(async () => {\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  beforeUpdate(async () => {\n    // console.log('beforeUpdate')\n  })\n\n  afterUpdate(async () => {\n    // console.log('afterUpdate')\n  })\n\n  /**\n   * Grer le tlchargement des images dans une archive `images.zip` lors du clic sur le bouton du modal\n   * @author sylvain\n   */\n  function handleActionFromDownloadPicsModal() {\n    // console.log('handleActionFromDownloadPicsModal')\n    const imagesFilesUrls = makeImageFilesUrls(exercices)\n    downloadZip(imagesFilesUrls, 'images.zip')\n    isDownloadPicsModalDisplayed = false\n  }\n\n  /**\n   * Grer l'affichage du modal : on donne la liste des images par exercice\n   */\n  function handleDownloadPicsModalDisplay() {\n    // console.log('handleDownloadPicsModalDisplay')\n    exosContentList = getExosContentList(exercices)\n    picsNames = getPicsNames(exosContentList)\n    isDownloadPicsModalDisplayed = true\n  }\n\n  /**\n   * Construction d'un message contextualis indiquant le besoin de tlcharger les images si besoin\n   */\n  export function buildMessageForCopyPaste(picsWanted: boolean) {\n    if (picsWanted) {\n      return `<p>Le code LaTeX a t copi dans le presse-papier.</p>\n      <p class=\"font-bold text-coopmaths-warn-darkest\">Ne pas oublier de tlcharger les figures !</p>`\n    } else {\n      return 'Le code LaTeX a t copi dans le presse-papier.'\n    }\n  }\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"LaTeX\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n\n  <section\n    class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <h1\n      class=\"mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Paramtrage\n    </h1>\n    <div\n      class=\"grid grid-cols-1 grid-rows-1 md:grid-cols-2 xl:grid-cols-3 gap-8\"\n    >\n      <div\n        class=\"flex flex-col w-full md:flex-row justify-between rounded-lg bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)] dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <div\n          class=\"flex flex-col py-4 pl-16 w-2/3 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n        >\n          <FormConfigSection {latex} bind:latexFileInfos {promise} />\n        </div>\n        <!-- Carousel de vignette pour les aperus -->\n        <div class=\"flex justify-center w-full md:w-1/3\">\n          <div class=\"relative w-2/3 md:w-full\">\n            <ImageCarousel images={carouselImages} interval={3000} />\n          </div>\n        </div>\n      </div>\n\n      <SimpleCard icon={''} title={'lments de titres'}>\n        <div class=\"flex flex-col w-full justify-start items-start space-y-2\">\n          <InputText\n            inputID=\"export-latex-titre-input\"\n            placeholder={latexFileInfos.style === 'Can'\n              ? 'Course aux nombres'\n              : 'Titre'}\n            bind:value={latexFileInfos.title}\n            showTitle={false}\n            classAddenda=\"placeholder:opacity-40\"\n          />\n          <InputText\n            inputID=\"export-latex-reference-input\"\n            placeholder={latexFileInfos.style === 'Coopmaths' ||\n            latexFileInfos.style === 'ProfMaquetteQrcode' ||\n            latexFileInfos.style === 'ProfMaquette'\n              ? 'Rfrence'\n              : 'Haut de page gauche'}\n            bind:value={latexFileInfos.reference}\n            isDisabled={latexFileInfos.style === 'Can'}\n            showTitle={false}\n            classAddenda=\"placeholder:opacity-40\"\n          />\n          <InputText\n            inputID=\"export-latex-soustitre-input\"\n            placeholder={latexFileInfos.style === 'Coopmaths' ||\n            latexFileInfos.style === 'ProfMaquetteQrcode' ||\n            latexFileInfos.style === 'ProfMaquette'\n              ? 'Sous-titre / Chapitre'\n              : 'Pied de page droit'}\n            bind:value={latexFileInfos.subtitle}\n            isDisabled={latexFileInfos.style === 'Can'}\n            showTitle={false}\n            classAddenda=\"placeholder:opacity-40\"\n          />\n        </div>\n      </SimpleCard>\n      <SimpleCard icon={''} title={'Nombre de versions des exercices'}>\n        <span class=\"w-30\">\n          <InputNumber\n            id=\"export-latex-nb-versions-input\"\n            min={1}\n            max={50}\n            bind:value={latexFileInfos.nbVersions}\n          />\n        </span>\n      </SimpleCard>\n    </div>\n\n    <div bind:this={divText}>\n      <h1\n        class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n      >\n        Exportation\n      </h1>\n      <div class=\"pl-4\">\n        <div\n          class=\"text-coopmaths-struct-light dark:text-coopmathsdark-struct-light md:text-2xl font-bold pb-2\"\n        >\n          Que faire du code $\\LaTeX$ ?\n        </div>\n        <div\n          class=\"grid grid-cols-1 grid-rows-1 md:grid-cols-2 xl:grid-cols-2 gap-8\"\n        >\n          <SimpleCard title={'Compiler le code pour avoir un fichier PDF'}>\n            <div>\n              Je souhaite obtenir un fichier PDF  partir du code $\\LaTeX$.\n              J'essaie le nouveau compilateur en ligne (serveur TexLive.net) qui\n              ne ncessite pas d'avoir un compte.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <div>\n                  <ButtonCompileLatexToPDF\n                    class=\"flex w-full flex-col justify-center\"\n                    {latex}\n                    {latexFileInfos}\n                    id=\"0\"\n                  />\n                </div>\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard title={'Obtenir un PDF'}>\n            <div>\n              Je souhaite obtenir un fichier PDF  partir du code $\\LaTeX$. Je\n              vais tre redirig(e) vers le site OverLeaf (qui ncessite d'avoir\n              un compte) pour compiler le code en ligne.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <div>\n                  <ButtonOverleaf\n                    class=\"flex w-full flex-col justify-center\"\n                    {latexFile}\n                    {exercices}\n                    disabled={false}\n                  />\n                </div>\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard title={'Copier le code'} icon={'bx-copy-alt'}>\n            <div>\n              Je souhaite copier le code $\\LaTeX$ pour le coller dans un autre\n              logiciel.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <div>\n                  <ButtonActionInfo\n                    action=\"copy\"\n                    textToCopy={latexFile.latexWithoutPreamble}\n                    text=\"Code seul\"\n                    successMessage={messageForCopyPasteModal}\n                    errorMessage=\"Impossible de copier le code LaTeX dans le presse-papier\"\n                    class=\"px-2 py-1 rounded-md\"\n                  />\n                </div>\n              {/await}\n            </div>\n            <div slot=\"button2\">\n              {#await promise}\n                <p></p>\n              {:then}\n                <div>\n                  <ButtonActionInfo\n                    action=\"copy\"\n                    textToCopy={latexFile.latexWithPreamble}\n                    text=\"Code + prambule\"\n                    successMessage={messageForCopyPasteModal}\n                    errorMessage=\"Impossible de copier le code LaTeX dans le presse-papier\"\n                    class=\"px-2 py-1 rounded-md\"\n                  />\n                </div>\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard title={'Tlcharger le code'} icon={'bx-download'}>\n            <div>Je souhaite tlcharger le matriel sur mon ordinateur.</div>\n            <div slot=\"button1\">\n              <ButtonTextAction\n                class=\"px-2 py-1 rounded-md\"\n                id=\"downloadFullArchive\"\n                on:click={async () => {\n                  await promise\n                  downloadTexWithImagesZip('coopmaths', latexFile, exercices)\n                }}\n                text=\"Archive complte\"\n              />\n            </div>\n            <div slot=\"button2\">\n              {#await promise}\n                <p></p>\n              {:then}\n                <div>\n                  <ButtonTextAction\n                    class=\"inline-block px-2 py-1 rounded-md\"\n                    id=\"downloadPicsButton\"\n                    on:click={handleDownloadPicsModalDisplay}\n                    text=\"Uniquement les figures\"\n                    disabled={!picsWanted}\n                  />\n                </div>\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard title={'Basculer vers la vue PDF'} icon={'bx-download'}>\n            <div>Je souhaite basculer vers la vue PDF.</div>\n            <div slot=\"button1\">\n              <ButtonTextAction\n                class=\"px-2 py-1 rounded-md\"\n                id=\"vuePDF\"\n                on:click={() => {\n                  mathaleaGoToView('pdf')\n                }}\n                text=\"Basculer sur la vue PDF\"\n              />\n            </div>\n          </SimpleCard>\n        </div>\n        <BasicClassicModal\n          bind:isDisplayed={isDownloadPicsModalDisplayed}\n          icon=\"bx-code\"\n        >\n          <span slot=\"header\"></span>\n          <div slot=\"content\" class=\"flex flex-col justify-start items-start\">\n            Voici ce dont vous aurez besoin :\n            {#each exosContentList as exo, i (exo)}\n              <ul\n                class=\"flex flex-col justify-start items-start list-disc pl-6\"\n              >\n                <!-- <li class={picsNames[i].length > 0 ? \"container\" : \"hidden\"}>Exercice {i + 1} (<span class=\"text-italic\">{exo.groups.title}</span>) :</li> -->\n                {#if picsNames[i].length !== 0}\n                  <li>\n                    Exercice {i + 1} (<span class=\"text-italic\"\n                      >{exo.title}</span\n                    >) :\n                  </li>\n                  <ul\n                    class=\"flex flex-col justify-start items-start list-none pl-4\"\n                  >\n                    {#each picsNames[i] as img}\n                      <li class=\"font-mono text-sm\">{img.name}</li>\n                    {/each}\n                  </ul>\n                {/if}\n              </ul>\n            {/each}\n          </div>\n          <div slot=\"footer\">\n            <ButtonTextAction\n              text=\"Tlcharger les figures\"\n              on:click={handleActionFromDownloadPicsModal}\n            />\n          </div>\n        </BasicClassicModal>\n      </div>\n    </div>\n\n    <dialog\n      bind:this={dialogLua}\n      class=\"rounded-xl bg-coopmaths-canvas text-coopmaths-corpus dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light font-light shadow-lg p-6\"\n    >\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html messageForCopyPasteModal}\n      {#if latexFileInfos.style === 'ProfMaquette'}\n        <p class=\"mt-4\">\n          Il faut mettre  jour votre distribution LaTeX pour avoir la dernire\n          version du package <em\n            class=\"text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest font-bold\"\n            >ProfMaquette</em\n          >.\n        </p>\n      {:else}\n        <p class=\"mt-4\">\n          Il faudra utiliser <em\n            class=\"text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest font-bold\"\n            >LuaLaTeX</em\n          > pour compiler le document.\n        </p>\n      {/if}\n    </dialog>\n\n    <h1\n      class=\"mt-12 md:mt-8 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Code\n    </h1>\n    <pre\n      class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-y-auto overflow-x-scroll text-xs\">\n      {#await promise}\n        <p>Chargement en cours...</p>\n      {:then}\n        {latexFile.latexWithoutPreamble}\n      {/await}\n    </pre>\n  </section>\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import Latex from '../../../lib/Latex'\n  import { mathaleaGetExercicesFromParams } from '../../../lib/mathalea'\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n  import type { LatexFileInfos } from '../../../lib/LatexTypes'\n\n  let content = $state('')\n  let loading = $state(true)\n\n  onMount(async () => {\n    const params = $exercicesParams\n    // We need to fetch the exercises content\n    const exercises = await mathaleaGetExercicesFromParams(params)\n    const latex = new Latex()\n    // Filter out html-only exercises as they don't have latex content\n    latex.addExercices(exercises.filter((ex) => ex.typeExercice !== 'html'))\n\n    const latexFileInfos: LatexFileInfos = {\n      title: '',\n      reference: '',\n      subtitle: '',\n      style: 'Coopmaths',\n      fontOption: 'StandardFont',\n      tailleFontOption: 12,\n      dysTailleFontOption: 14,\n      correctionOption: 'AvecCorrection',\n      qrcodeOption: 'SansQrcode',\n      typeFiche: 'Fiche',\n      durationCanOption: '9 min',\n      titleOption: 'SansTitre',\n      nbVersions: 1,\n      exos: {},\n    }\n\n    const result = await latex.getFile(latexFileInfos)\n    content = result.latexWithoutPreamble\n    loading = false\n  })\n</script>\n\n{#if loading}\n  <pre>Loading...</pre>\n{:else}\n  <pre>{content}</pre>\n{/if}\n\n<style>\n  pre {\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    font-family: monospace;\n    padding: 1rem;\n    margin: 0;\n  }\n</style>\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate, onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import Latex from '../../../lib/Latex'\n  import { type LatexFileInfos } from '../../../lib/LatexTypes'\n  import { mathaleaGetExercicesFromParams } from '../../../lib/mathalea.js'\n  import { mathaleaGoToView } from '../../../lib/mathaleaUtils'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import { type IExercice } from '../../../lib/types'\n  import Footer from '../../Footer.svelte'\n  import ButtonCompileLatexToPdf from '../../shared/forms/ButtonCompileLatexToPDF.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import FormConfigGlobal from '../../shared/forms/FormConfigGlobal.svelte'\n  import FormConfigIndividual from '../../shared/forms/FormConfigIndividual.svelte'\n  import InputNumber from '../../shared/forms/InputNumber.svelte'\n  import InputText from '../../shared/forms/InputText.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import ImageCarousel from '../../shared/ui/ImageCarousel.svelte'\n  import SimpleCard from '../../shared/ui/SimpleCard.svelte'\n  import FormConfigSection from './FormConfigSection.svelte'\n  import { decodeBase64, encodeBase64 } from './LatexConfig'\n  import PdfResult from './PdfResult.svelte'\n\n  let showAdvanced = false // toggle pour les paramtres avancs\n\n  const url = new URL(window.location.href)\n  const decoded = decodeBase64(\n    url.searchParams.get('pdfParam') || '',\n  ) as Partial<LatexFileInfos>\n\n  /**\n   * Toutes les variables configurables par l'interface WEB\n   * qui adaptent la sortie PDF\n   */\n  let latexFileInfos: LatexFileInfos = {\n    title: '',\n    reference: '',\n    subtitle: '',\n    style: 'ProfMaquette',\n    fontOption: 'StandardFont',\n    tailleFontOption: 12,\n    dysTailleFontOption: 14,\n    correctionOption: 'AvecCorrection',\n    qrcodeOption: 'SansQrcode',\n    typeFiche: 'Fiche',\n    durationCanOption: '9 min',\n    titleOption: 'SansTitre',\n    nbVersions: 1,\n    exos: {}, // tu peux garder vide par dfaut\n    ...decoded, //  crase les valeurs par dfaut si prsente\n  }\n\n  let pdfParam = encodeBase64(latexFileInfos)\n\n  url.searchParams.set('pdfParam', pdfParam)\n\n  const imgStylePartialUrls = {\n    Coopmaths: 'images/exports/export-coopmaths',\n    Classique: 'images/exports/export-classique',\n    ProfMaquette: 'images/exports/export-profmaquette',\n    ProfMaquetteQrcode: 'images/exports/export-profmaquette-qrcode',\n    Can: 'images/exports/export-can',\n  }\n\n  $: carouselImages = [\n    {\n      src: `${imgStylePartialUrls[latexFileInfos.style]}-thumb1.png`,\n      alt: `${latexFileInfos.style} image-1`,\n    },\n    {\n      src: `${imgStylePartialUrls[latexFileInfos.style]}-thumb2.png`,\n      alt: `${latexFileInfos.style} image-2`,\n    },\n  ]\n\n  let exercices: IExercice[]\n  let isExerciceStaticInTheList = false\n  let promise: Promise<void>\n  let activeTab: 'general' | 'advanced' | 'global' = 'general'\n\n  const latex = new Latex()\n\n  async function initExercices(indexesToLoad?: number[]) {\n    log('initExercices')\n    const interfaceParams = get(exercicesParams)\n    interfaceParams.forEach((e) => {\n      e.interactif = '0'\n    })\n    exercices = await mathaleaGetExercicesFromParams(interfaceParams)\n    latex.addExercices(\n      exercices.filter(\n        (ex, index) =>\n          ex.typeExercice !== 'html' &&\n          (!indexesToLoad || indexesToLoad.includes(index)),\n      ),\n    )\n    isExerciceStaticInTheList = latex.isExerciceStaticInTheList()\n  }\n\n  async function updateLatexWithAbortController() {\n    const clone = UpdateController.update()\n    if (clone.signal?.aborted) {\n      return Promise.reject(\n        new DOMException(\n          'Aborted in updateLatexWithAbortController',\n          'AbortError',\n        ),\n      )\n    }\n\n    return new Promise<void>(async (resolve, reject) => {\n      // Listen for abort event on signal\n      const rej = () => {\n        log('reject')\n        clone.signal?.removeEventListener('abort', rej)\n        reject(\n          new DOMException(\n            'Aborted in updateLatexWithAbortController',\n            'AbortError',\n          ),\n        )\n      }\n      clone.signal?.addEventListener('abort', rej)\n      // Something fake async\n      await updateLatex(clone)\n        .then(() => {\n          clone.signal?.removeEventListener('abort', rej)\n          log('Promise resolu')\n          resolve()\n        })\n        .catch((err) => {\n          reject(new DOMException(`Aborted : ${err.message}`, 'AbortError'))\n        })\n    })\n  }\n\n  async function updateLatex(clone: LatexFileInfos) {\n    try {\n      log('updateLatex')\n      // await new Promise((resolve) => setTimeout(resolve, 10000))\n      await latex.getFile(clone)\n      log('fin updateLatex')\n    } catch (error) {\n      if (error instanceof DOMException && error.name === 'AbortError') {\n        // nouvelle demande de fichier LATEX demande\n        throw error\n      }\n      console.error('Erreur lors de la cration du code LaTeX :', error)\n    }\n  }\n\n  class UpdateController {\n    static controller: AbortController | undefined\n    static update() {\n      if (UpdateController.controller === undefined) {\n        UpdateController.controller = new AbortController()\n      } else {\n        UpdateController.controller.abort()\n        UpdateController.controller = new AbortController()\n      }\n      const clone = structuredClone(latexFileInfos)\n      clone.signal = UpdateController.controller.signal\n      return clone\n    }\n  }\n\n  const debug = url.searchParams.get('log') === '5' || true\n  function log(str: string) {\n    if (debug) {\n      console.info(str)\n    }\n  }\n\n  $: {\n    if (latex.exercices.length > 0) {\n      log('update')\n      latexFileInfos = {\n        ...latexFileInfos,\n        exos: {\n          ...latexFileInfos.exos,\n          // les blocrep sont dj des sous-objets clons quand tu les modifies\n        },\n      }\n      const newPdfParam = encodeBase64(latexFileInfos)\n      if (newPdfParam !== pdfParam) {\n        pdfParam = newPdfParam\n        url.searchParams.set('pdfParam', pdfParam)\n        history.replaceState(null, '', url) // change lURL sans recharger\n\n        promise = updateLatexWithAbortController().catch((err) => {\n          if (err.name === 'AbortError') {\n            log('Promise Aborted')\n          } else {\n            log('Promise Rejected')\n          }\n        })\n      }\n    }\n  }\n\n  async function forceUpdate() {\n    log('forceUpdate')\n    latexFileInfos.title = latexFileInfos.title\n  }\n\n  onMount(async () => {\n    await initExercices()\n    promise = updateLatexWithAbortController().catch((err) => {\n      if (err.name === 'AbortError') {\n        log('Promise Aborted')\n      } else {\n        log('Promise Rejected')\n      }\n    })\n    document.addEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  onDestroy(async () => {\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  beforeUpdate(async () => {\n    // console.log('beforeUpdate')\n  })\n\n  afterUpdate(async () => {\n    // console.log('afterUpdate')\n  })\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n   text-coopmaths-corpus dark:text-coopmathsdark-corpus\n  {$darkMode.isActive ? 'dark' : ''}\"\n>\n  <NavBar\n    subtitle=\"PDF\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n  <section class=\"px-4 py-0 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n    <!-- Titre toujours en pleine largeur -->\n    <h1\n      class=\"w-full text-center md:text-left text-coopmaths-struct\n             dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold mb-6\"\n    >\n      Visualisation du PDF\n      <button\n        class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n        data-tip=\"Changer les paramtres du PDF\"\n        type=\"button\"\n        aria-label=\"Changer les paramtres du PDF\"\n        on:click={() => {\n          showAdvanced = !showAdvanced\n        }}\n      >\n        <i\n          class=\"text-coopmaths-action hover:text-coopmaths-action-lightest\n                 dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\n                 bx bx-slider\"\n        ></i>\n      </button>\n    </h1>\n\n    <!-- Grille responsive uniquement pour le contenu -->\n    <div\n      class={showAdvanced\n        ? 'grid grid-cols-1 gap-8 md:grid-cols-2 xl:grid-cols-3 items-stretch'\n        : ''}\n    >\n      {#if showAdvanced}\n        <!-- Colonne configuration -->\n        <div class=\"flex flex-col space-y-8\">\n          <!-- Barre donglets -->\n          <div class=\"flex space-x-4 border-b border-gray-600 mb-4\">\n            <button\n              class=\"pb-2 px-2 -mb-px text-sm font-medium transition-colors duration-200\"\n              class:text-blue-500={activeTab === 'general'}\n              class:border-b-2={activeTab === 'general'}\n              class:border-blue-500={activeTab === 'general'}\n              class:text-gray-400={activeTab !== 'general'}\n              class:hover:text-gray-200={activeTab !== 'general'}\n              on:click={() => (activeTab = 'general')}\n            >\n              Gnral\n            </button>\n            {#if latexFileInfos.style === 'ProfMaquette'}\n              <button\n                class=\"pb-2 px-2 -mb-px text-sm font-medium transition-colors duration-200\"\n                class:text-blue-500={activeTab === 'global'}\n                class:border-b-2={activeTab === 'global'}\n                class:border-blue-500={activeTab === 'global'}\n                class:text-gray-400={activeTab !== 'global'}\n                class:hover:text-gray-200={activeTab !== 'global'}\n                on:click={() => (activeTab = 'global')}\n              >\n                Global\n              </button>\n\n              <button\n                class=\"pb-2 px-2 -mb-px text-sm font-medium transition-colors duration-200\"\n                class:text-blue-500={activeTab === 'advanced'}\n                class:border-b-2={activeTab === 'advanced'}\n                class:border-blue-500={activeTab === 'advanced'}\n                class:text-gray-400={activeTab !== 'advanced'}\n                class:hover:text-gray-200={activeTab !== 'advanced'}\n                on:click={() => (activeTab = 'advanced')}\n              >\n                Avanc\n              </button>\n            {/if}\n          </div>\n\n          <!-- les onglets -->\n          {#if activeTab === 'general'}\n            <div\n              class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto h-[70vh] overflow-y-auto\"\n            >\n              <div\n                class=\"mb-4 flex flex-col md:flex-row w-full justify-between rounded-lg\n                    bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),\n                    0_10px_20px_-2px_rgba(0,0,0,0.04)]\n                    dark:bg-coopmathsdark-canvas-dark\"\n              >\n                <div class=\"flex flex-col py-4 pl-16 w-2/3\">\n                  <FormConfigSection {latex} bind:latexFileInfos {promise} />\n                </div>\n                <!-- Carousel de vignette pour les aperus -->\n                <div class=\"flex justify-center w-full md:w-1/3\">\n                  <div class=\"relative w-2/3 md:w-full max-w-[200px]\">\n                    <ImageCarousel images={carouselImages} interval={3000} />\n                  </div>\n                </div>\n              </div>\n\n              <SimpleCard icon={''} title={'lments de titres'} class=\"mb-4\">\n                <InputText\n                  inputID=\"pdf-titre-input\"\n                  placeholder=\"Titre\"\n                  bind:value={latexFileInfos.title}\n                  showTitle={false}\n                />\n                <InputText\n                  inputID=\"pdf-reference-input\"\n                  placeholder=\"Rfrence\"\n                  bind:value={latexFileInfos.reference}\n                  showTitle={false}\n                />\n                <InputText\n                  inputID=\"pdf-subtitle-input\"\n                  placeholder=\"Sous-titre\"\n                  bind:value={latexFileInfos.subtitle}\n                  showTitle={false}\n                />\n              </SimpleCard>\n\n              <SimpleCard\n                icon={''}\n                title={'Nombre de versions des exercices'}\n                class=\"mb-4\"\n              >\n                <InputNumber\n                  id=\"pdf-nb-versions\"\n                  min={1}\n                  max={50}\n                  bind:value={latexFileInfos.nbVersions}\n                />\n              </SimpleCard>\n\n              <SimpleCard title={''} icon={''} class=\"mb-4\">\n                <ButtonTextAction\n                  class=\"px-2 py-1 rounded-md\"\n                  id=\"vueLatex\"\n                  on:click={() => {\n                    mathaleaGoToView('latex')\n                  }}\n                  text=\"Basculer vers la vue Latex\"\n                />\n\n                <ButtonCompileLatexToPdf\n                  class=\"px-4 rounded-lg flex gap-3 bg-coopmaths-action justify-center hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest text-white\"\n                  {latex}\n                  {latexFileInfos}\n                  id=\"1\"\n                />\n              </SimpleCard>\n            </div>\n          {/if}\n          {#if activeTab === 'global' && latexFileInfos.style === 'ProfMaquette'}\n            <div\n              class=\"flex flex-col md:flex-row w-full justify-between rounded-lg\n                  bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),\n                  0_10px_20px_-2px_rgba(0,0,0,0.04)]\n                  dark:bg-coopmathsdark-canvas-dark\"\n            >\n              <div\n                class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto h-[70vh] overflow-y-auto\"\n              >\n                <FormConfigGlobal bind:latexFileInfos {latex} />\n              </div>\n            </div>\n          {/if}\n          {#if activeTab === 'advanced' && latexFileInfos.style === 'ProfMaquette'}\n            <div\n              class=\"flex flex-col md:flex-row w-full justify-between rounded-lg\n                    bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),\n                    0_10px_20px_-2px_rgba(0,0,0,0.04)]\n                    dark:bg-coopmathsdark-canvas-dark\"\n            >\n              <div\n                class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto h-[70vh] overflow-y-auto\"\n              >\n                <FormConfigIndividual bind:latexFileInfos {latex} />\n              </div>\n            </div>\n          {/if}\n        </div>\n      {/if}\n      <!-- Colonne rendu PDF -->\n      <div\n        class=\"shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\n              text-coopmaths-corpus dark:text-coopmathsdark-corpus\n              w-full overflow-y-auto overflow-x-scroll text-xs\n              min-h-[70vh]\n              {showAdvanced\n          ? 'col-span-1 md:col-span-1 xl:col-span-2 h-full'\n          : 'h-[70vh]'}\"\n      >\n        {#await promise}\n          <p>Chargement en cours...</p>\n        {:then}\n          <PdfResult\n            {latex}\n            {latexFileInfos}\n            autoStart={!showAdvanced}\n            pdfViewerDisplay={true}\n          />\n        {/await}\n      </div>\n    </div>\n  </section>\n\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../exercices/Exercice'\n  import {\n    mathaleaGetExercicesFromParams,\n    mathaleaUpdateExercicesParamsFromUrl,\n  } from '../../../lib/mathalea'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import ButtonToggleAlt from '../../shared/forms/ButtonToggleAlt.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import Tabs from '../../shared/ui/Tabs.svelte'\n  import { saveAs } from 'file-saver'\n  import JSZip from 'jszip'\n\n  const copyCode = async () => {\n    const preElt = document.querySelector('pre')\n    if (preElt) {\n      try {\n        const text = preElt.innerText\n        await navigator.clipboard.writeText(text)\n      } catch (err) {\n        console.error('Accs au presse-papier impossible: ', err)\n      }\n    } else {\n      throw new Error(\"Can't find `pre` selector in document\")\n    }\n  }\n\n  function downloadGift() {\n    const preElt = document.querySelector('pre')\n    if (preElt) {\n      const text = preElt.innerText\n      const element = document.createElement('a')\n      element.setAttribute(\n        'href',\n        'data:text/plain;charset=utf-8,' + encodeURIComponent(text),\n      )\n      element.setAttribute('download', 'mathalea-gift.txt')\n      element.style.display = 'none'\n      document.body.appendChild(element)\n      element.click()\n      document.body.removeChild(element)\n    } else {\n      throw new Error(\"Can't find `pre` selector in document\")\n    }\n  }\n\n  function downloadScorm() {\n    const zip = new JSZip()\n    zip.file('imsmanifest.xml', contentScorm)\n    let indexHtml = ''\n    indexHtml += '<html>\\n'\n    indexHtml += '  <head>\\n'\n    indexHtml += '    <title>MathAlea</title>\\n'\n    indexHtml +=\n      '    <scr' +\n      'ipt type=\"text/javascript\" src=\"https://coopmaths.fr/alea/assets/externalJs/SCORM_API_wrapper.js\"></scr' +\n      'ipt>\\n'\n    indexHtml +=\n      '    <scr' +\n      'ipt type=\"text/javascript\" src=\"https://coopmaths.fr/alea/assets/externalJs/moodle.scorm.js\"></scr' +\n      'ipt>\\n'\n    indexHtml += '  </head>\\n'\n    indexHtml += '  <body></body>\\n'\n    indexHtml += '</html>\\n'\n    zip.file('index.html', indexHtml)\n    zip.generateAsync({ type: 'blob' }).then(function (content) {\n      saveAs(content, 'mathalea.scorm.zip')\n    })\n  }\n\n  let contentGift = ''\n  let contentScorm = ''\n  /*\n    <organizations default=\"coopmaths.fr\">\n        <organization identifier=\"coopmaths.fr\" structure=\"hierarchical\">\n          <title>MathAlea</title>\n          <item identifier=\"MathAlea-Exo1\" isvisible=\"true\" identifierref=\"MathAlea-Exo1\">\n            <title>Dcomposer un nombre entier en produit de (petits) facteurs premiers</title>\n          </item>\n          <item identifier=\"MathAlea-Exo2\" isvisible=\"true\" identifierref=\"MathAlea-Exo2\">\n            <title>Utiliser la simple distributivit</title>\n          </item>\n        </organization>\n      </organizations>\n      <resources>\n        <resource identifier=\"MathAlea-Exo1\" type=\"webcontent\" adlcp:scormtype=\"sco\"\n          href=\"index.html#uuid=1eaf7&id=4A11-0&alea=3HRw\">\n          <dependency identifierref=\"COMMON_FILES\"/>\n        </resource>\n        <resource identifier=\"MathAlea-Exo2\" type=\"webcontent\" adlcp:scormtype=\"sco\"\n          href=\"index.html#uuid=71dd8&id=4L10&alea=9QsD\">\n          <dependency identifierref=\"COMMON_FILES\"/>\n        </resource>\n        <resource identifier=\"COMMON_FILES\" type=\"webcontent\" adlcp:scormtype=\"asset\">\n          <file href=\"index.html\" />\n        </resource>\n      </resources>\n  */\n  let exercices: TypeExercice[]\n\n  let justBookmarklet = false\n\n  async function initExercices() {\n    contentGift = ''\n    let xmlScorm = document.implementation.createDocument('', '', null)\n    let xmlManifest = xmlScorm.createElement('manifest')\n    xmlManifest.setAttribute('identifier', 'MathAlea')\n    xmlManifest.setAttribute('version', '1.0')\n    xmlScorm.appendChild(xmlManifest)\n    /*<metadata>\n    <schema>ADL SCORM</schema>\n    <schemaversion>1.2</schemaversion>\n    </metadata>*/\n    let xmlMetadata = xmlScorm.createElement('metadata')\n    let xmlSchema = xmlScorm.createElement('schema')\n    xmlSchema.textContent = 'ADL SCORM'\n    let xmlSchemaVersion = xmlScorm.createElement('schemaversion')\n    xmlSchemaVersion.textContent = '1.2'\n    xmlMetadata.appendChild(xmlSchema)\n    xmlMetadata.appendChild(xmlSchemaVersion)\n    xmlManifest.appendChild(xmlMetadata)\n    let xmlOrganizations = xmlScorm.createElement('organizations')\n    xmlOrganizations.setAttribute('default', 'coopmaths.fr')\n    let xmlOrganization = xmlScorm.createElement('organization')\n    xmlOrganization.setAttribute('identifier', 'coopmaths.fr')\n    xmlOrganization.setAttribute('structure', 'hierarchical')\n    let xmlTitle = xmlScorm.createElement('title')\n    xmlTitle.textContent = 'MathAlea'\n    xmlOrganization.appendChild(xmlTitle)\n    xmlOrganizations.appendChild(xmlOrganization)\n    xmlManifest.appendChild(xmlOrganizations)\n    let xmlResources = xmlScorm.createElement('resources')\n    xmlManifest.appendChild(xmlResources)\n    mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    if (exercices.length === 0) {\n      tab = 'bookmarklet'\n      justBookmarklet = true\n    }\n    let i = 0\n    for (const param of $exercicesParams) {\n      let paramUrl = ''\n      for (const key of Object.keys(param)) {\n        if (key === 'sup') {\n          // 28-10-2025 Ajout de encodeURIComponent pour grer DfiTable correctement\n          // A vrifier que a ne casse pas d'autres choses\n          paramUrl += `s\\\\=${encodeURIComponent(param[key] || '')}&`\n        } else if (key === 'sup2') {\n          paramUrl += `s2\\\\=${param[key]}&`\n        } else if (key === 'sup3') {\n          paramUrl += `s3\\\\=${param[key]}&`\n        } else if (key === 'sup4') {\n          paramUrl += `s4\\\\=${param[key]}&`\n        } else if (key === 'sup5') {\n          paramUrl += `s5\\\\=${param[key]}&`\n        } else if (key === 'nbQuestions') {\n          paramUrl += `n\\\\=${param[key]}&`\n        } else if (key === 'versionQcm') {\n          paramUrl += `qcm\\\\=${param[key]}&`\n        } else if (key !== 'alea' && key !== 'id') {\n          paramUrl += `${key}\\\\=${param[key]}&`\n        }\n      }\n      paramUrl = paramUrl.slice(0, -1)\n      let graine\n      if (aleaType === 'alea') {\n        graine = ' graine\\\\=\"-1\"'\n      } else if (aleaType === 'moodle') {\n        graine = ''\n      } else {\n        graine = ` graine\\\\=\"${param.alea}\" `\n      }\n      contentGift += `:: ${param.id} - ${exercices[i].titre} - ${exercices[i].nbQuestions} ${exercices[i].nbQuestions > 1 ? 'questions' : 'question'} ::\\n`\n      contentGift +=\n        '<script src\\\\=\"https\\\\:\\/\\/coopmaths.fr\\/alea\\/assets\\/externalJs\\/moodle.js\" type\\\\=\"module\"><\\/script>\\n'\n      contentGift += `<mathalea-moodle v=\"4\" url\\\\=\"${paramUrl}\"${showTitle ? '' : ' titre=\"false\"'}${graine}/>\\n`\n      contentGift += '{\\n'\n      contentGift +=\n        '=%100%100|*=%90%90|*=%83.33333%83.333|*=%80%80|*=%75%75|*=%66.66667%66.666|*=%60%60|*=%50%50|*=%40%40|*=%33.33333%33.333|*=%30%30|*=%25%25|*=%20%20|*=%16.66667%16.666|*=%14.28571%14.2857|*=%12.5%12.5|*=%11.11111%11.111|*=%10%10|*=%5%5|*=%0%0|*\\n'\n      contentGift +=\n        '####<script src\\\\=\"https\\\\:\\/\\/coopmaths.fr\\/alea\\/assets\\/externalJs\\/moodle.js\" type\\\\=\"module\"><\\/script>\\n'\n      contentGift += `<mathalea-moodle v=\"4\" url\\\\=\"${paramUrl}\"${showTitle ? '' : ' titre=\"false\"'}${graine} correction />\\n`\n      contentGift += '}\\n\\n'\n      let xmlItem = xmlScorm.createElement('item')\n      xmlItem.setAttribute('identifier', `MathAlea-Exo${i + 1}`)\n      xmlItem.setAttribute('isvisible', 'true')\n      xmlItem.setAttribute('identifierref', `MathAlea-Exo${i + 1}`)\n      let xmlTitle = xmlScorm.createElement('title')\n      xmlTitle.textContent = exercices[i].titre\n      xmlItem.appendChild(xmlTitle)\n      xmlOrganization.appendChild(xmlItem)\n      let xmlResource = xmlScorm.createElement('resource')\n      xmlResource.setAttribute('identifier', `MathAlea-Exo${i + 1}`)\n      xmlResource.setAttribute('type', 'webcontent')\n      xmlResource.setAttribute('adlcp:scormtype', 'sco')\n      xmlResource.setAttribute(\n        'href',\n        'index.html#' +\n          paramUrl.replaceAll('\\\\=', '=') +\n          (useAlea ? '' : '&alea=' + param.alea),\n      )\n      let xmlDependency = xmlScorm.createElement('dependency')\n      xmlDependency.setAttribute('identifierref', 'COMMON_FILES')\n      xmlResource.appendChild(xmlDependency)\n      xmlResources.appendChild(xmlResource)\n      i++\n    }\n    let xmlResource = xmlScorm.createElement('resource')\n    xmlResource.setAttribute('identifier', 'COMMON_FILES')\n    xmlResource.setAttribute('type', 'webcontent')\n    xmlResource.setAttribute('adlcp:scormtype', 'asset')\n    let xmlFile = xmlScorm.createElement('file')\n    xmlFile.setAttribute('href', 'index.html')\n    xmlResource.appendChild(xmlFile)\n    xmlResources.appendChild(xmlResource)\n    contentScorm = new XMLSerializer().serializeToString(xmlScorm)\n    let ident = ''\n    // Debut Beautify XML\n    // Remarque : il s'agit d'un code maison qui ne gre probablement pas tous les cas\n    //            mais suffit emplement ici\n    let dir = 1\n    contentScorm =\n      '<' +\n      contentScorm\n        .split('<')\n        .slice(1)\n        .reduce((a, x) => {\n          if (x[0] === '/') {\n            if (dir === 1) {\n              a += '<' + x\n            } else {\n              a += '\\n' + ident + '<' + x\n            }\n            ident = ident.slice(1)\n            dir = -1\n          } else {\n            ident += ' '\n            a += '\\n' + ident + '<' + x\n            dir = 1\n            if (x.includes('/>')) {\n              ident = ident.slice(1)\n              dir = -1\n            }\n          }\n          return a\n        })\n    // Fin Beautify XML\n    contentScorm = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + contentScorm\n  }\n\n  let aleaType = 'alea' // 'alea' | 'moodle' | 'graine'\n  let useAlea = true\n  let showTitle = true\n  $: {\n    aleaType\n    useAlea\n    showTitle\n    initExercices()\n  }\n\n  let tab = 'gift'\n\n  $: moodleTabs = justBookmarklet\n    ? [{ id: 'bookmarklet', label: 'Marque-page magique', ariaControls: 'tabs-bookmarklet' }]\n    : [\n        { id: 'gift', label: 'Export Gift (Quiz)', ariaControls: 'tabs-gift' },\n        { id: 'scorm', label: 'Export SCORM', ariaControls: 'tabs-scorm' },\n        { id: 'bookmarklet', label: 'Marque-page magique', ariaControls: 'tabs-bookmarklet' },\n      ]\n\n  function handleTabChange(e: CustomEvent<string>) {\n    tab = e.detail\n  }\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"Moodle\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n  <div\n    class=\"flex flex-col h-full w-full bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <div\n      class=\"h-full w-full md:w-2/3 lg:w-3/5 flex flex-col px-4 pb-4 md:py-10 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark mx-auto\"\n    >\n      <!--\n      <div\n        class=\"flex flex-col md:flex-row justify-start px-4 py-4 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <h3\n          class=\"font-bold text-2xl text-coopmaths-struct dark:text-coopmathsdark-struct bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n        >\n          Choix du type d'export Moodle\n        </h3>\n      </div>\n      -->\n      <!-- Tabulations pour la prsentation -->\n      <Tabs tabs={moodleTabs} activeTab={tab} on:change={handleTabChange} />\n      <!-- Pages des rglages -->\n      <div class=\"pb-6 pt-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n        <div\n          class=\"transition-opacity duration-150 ease-linear {tab === 'gift' ? 'block opacity-100' : 'hidden opacity-0'}\"\n          id=\"tabs-gift\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-gift-btn\"\n        >\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            <!-- DEBUT GIFT -->\n            <section\n              class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas w-full\"\n            >\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Comment l'utiliser ?\n              </h1>\n\n              <p\n                class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n              >\n                MathALA vous permet de crer un fichier au format gift que vous\n                pourrez ensuite importer dans la banque de questions de votre\n                plateforme Moodle. Vous trouverez de plus amples informations\n                dans notre <a\n                  href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Moodle\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n                  >documentation</a\n                >.\n              </p>\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Exportation\n              </h1>\n\n              <div class=\"flex flex-col justify-center items-center space-y-2\">\n                <div class=\"pl-4 pt-4\">\n                  <div\n                    class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n                  >\n                    Alatoire\n                  </div>\n                  <FormRadio\n                    title=\"Type d'alatoire\"\n                    bind:valueSelected={aleaType}\n                    labelsValues={[\n                      {\n                        label:\n                          \"L'nonc change  chaque actualisation de la page\",\n                        value: 'alea',\n                      },\n                      {\n                        label:\n                          \"L'nonc change  chaque nouvelle tentative du test Moodle et est diffrente pour chaque lve\",\n                        value: 'moodle',\n                      },\n                      {\n                        label: \"Pas d'alatoire (utiliser l'nonc actuel')\",\n                        value: 'graine',\n                      },\n                    ]}\n                  />\n                  <div\n                    class=\"pl-2 pb-2 mt-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n                  >\n                    Autres options\n                  </div>\n                  <ButtonToggleAlt\n                    title={'Afficher le titre'}\n                    bind:value={showTitle}\n                    explanations={[\n                      \"Le titre de l'exercice sera affich\",\n                      \"Le titre de l'exercice ne sera pas affich\",\n                    ]}\n                  />\n                </div>\n                <button\n                  type=\"submit\"\n                  on:click={downloadGift}\n                  class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n                >\n                  <i class=\"bx bx-download mr-2\"></i>Tlcharger le fichier gift\n                </button>\n              </div>\n              <!-- <button\n                  on:click={copyCode}\n                  class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n                >\n                Copier le code\n                </button> -->\n\n              <h1\n                class=\"mt-12 md:mt-8 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Code\n              </h1>\n              <pre\n                class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">{contentGift}\n            </pre>\n            </section>\n            <!-- FIN GIFT -->\n          </div>\n        </div>\n        <div\n          class=\"transition-opacity duration-150 ease-linear {tab === 'scorm' ? 'block opacity-100' : 'hidden opacity-0'}\"\n          id=\"tabs-scorm\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-scorm-btn\"\n        >\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            <!-- DEBUT SCORM -->\n            <section\n              class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas w-full\"\n            >\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Comment l'utiliser ?\n              </h1>\n\n              <p\n                class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n              >\n                MathALA vous permet de crer un fichier au format SCORM que\n                vous pourrez ensuite importer dans votre cours Moodle. Vous\n                trouverez de plus amples informations dans notre <a\n                  href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Moodle\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n                  >documentation</a\n                >.\n              </p>\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Exportation\n              </h1>\n\n              <div class=\"flex flex-col justify-center items-center space-y-2\">\n                <div class=\"pl-4 pt-4\">\n                  <ButtonToggleAlt\n                    title={'Utiliser des exercices alatoires'}\n                    bind:value={useAlea}\n                    explanations={[\n                      'Chaque lve aura des exercices diffrents.',\n                      'Tous les lves auront le mme exercice',\n                    ]}\n                  />\n                </div>\n\n                <button\n                  type=\"submit\"\n                  on:click={downloadScorm}\n                  class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n                >\n                  <i class=\"bx bx-download mr-2\"></i>Tlcharger le fichier\n                  SCORM\n                </button>\n              </div>\n              <h1\n                class=\"mt-12 md:mt-8 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Code\n              </h1>\n              <pre\n                class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">{contentScorm}</pre>\n            </section>\n            <!-- FIN SCORM -->\n          </div>\n        </div>\n        <div\n          class=\"transition-opacity duration-150 ease-linear {tab === 'bookmarklet' ? 'block opacity-100' : 'hidden opacity-0'}\"\n          id=\"tabs-bookmarklet\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-bookmarklet-btn\"\n        >\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            <!-- DEBUT BOOKMARKLET -->\n            <section\n              class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas w-full\"\n            >\n              <p\n                class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n              >\n                Le marque-page magique permet de crer des activits MathALA\n                (au format scorm) en un clic.<br />\n                <center\n                  ><img\n                    src=\"./assets/images/moodle-bookmarklet-demo.gif\"\n                    alt=\"Vido de dmonstration du marque-page magique\"\n                    style=\"height:400px;margin:10px;\"\n                  /></center\n                >\n              </p>\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Installation du marque-page magique\n              </h1>\n              Glissez dposez le lien ci-dessous dans votre barre de favoris / marque\n              page :<br />\n              <!-- svelte-ignore a11y-invalid-attribute -->\n              <a\n                href=\"javascript:var MathAleaBookmarkletScript = document.createElement('script');MathAleaBookmarkletScript.type='text/javascript';MathAleaBookmarkletScript.src='https://coopmaths.fr/alea/assets/externalJs/moodle-bookmarklet.js?v=2';document.body.appendChild(MathAleaBookmarkletScript);void(0);\"\n                style=\"color:blue;text-decoration:underline;\"\n                >Activit MathALA</a\n              >\n\n              <center\n                ><img\n                  src=\"./assets/images/moodle-bookmarklet-installation.gif\"\n                  alt=\"Vido d'installation du marque-page magique\"\n                  style=\"margin:10px;border: 1px solid black;filter:drop-shadow(2px 4px 6px black);transform: scale(0.9) rotate(-5deg) translate(20px, 20px);\"\n                /></center\n              ><br />\n\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Utilisation\n              </h1>\n\n              <ul style=\"list-style-type: square;margin-left:30px;\">\n                <li>\n                  Pour utilisez le marque-page magique pour crer une <strong\n                    >activit MathALA</strong\n                  >\n                  :\n                  <ul style=\"list-style-type: square;margin-left:30px;\">\n                    <li>Ouvrez la page d'un cours en mode dition.</li>\n                    <li>\n                      Appuyez sur le bouton permettant d'ajouter une activit \n                      une section.\n                    </li>\n                    <li>\n                      Lorsque le slecteur d'activit s'affiche, appuyez sur le\n                      marque-page magique.\n                    </li>\n                    <li>\n                      La fentre vous propose alors de choisir un ou plusieurs\n                      exercices MathALA  ajouter  votre cours.\n                    </li>\n                    <li>\n                      Une fois les exercices choisis, appuyez sur le bouton\n                      \"Ajouter\" pour les insrer dans votre cours.\n                    </li>\n                  </ul>\n                </li>\n                <li>\n                  Pour utilisez le marque-page magique pour crer une <strong\n                    >question MathALA</strong\n                  >\n                  dans un test :\n                  <ul style=\"list-style-type: square;margin-left:30px;\">\n                    <li>Se rendre dans l'onglet Questions d'un test</li>\n                    <li>\n                      Appuyez sur le bouton \"Ajouter\" puis choisir \"Une\n                      question\"\n                    </li>\n                    <li>\n                      Lorsque le slecteur de type de questions s'affiche,\n                      appuyez sur le marque-page magique.\n                    </li>\n                    <li>\n                      La fentre vous propose alors de choisir un ou plusieurs\n                      exercices MathALA  ajouter  votre cours.\n                    </li>\n                    <li>\n                      Une fois les exercices choisis, appuyez sur le bouton\n                      \"Ajouter\" pour les insrer dans votre quiz ( la fin).\n                    </li>\n                  </ul>\n                </li>\n              </ul>\n              <!--\n                <strong\n                >Important : en raison d'un bug moodle, le calcul du score sera\n                incorrect dans le cas o plusieurs exercices ont t choisis. Il\n                faut donc pour l'instant se limiter  un exercice par activit\n                MathALA.</strong\n                ><br />\n              -->\n              L'utilisation du marque-page magique revient  importer un\n              <strong>fichier SCORM</strong>, ou  importer une question au\n              format <strong>GIFT</strong> dans un test Moodle. Le marque-page\n              magique ne fait que simplifier le procssus de cration.<br />\n              Reportez-vous  la\n              <a\n                href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/1.-Utilisation-de-MathAL%C3%89A/1.2-Int%C3%A9gration-avec-d'autres-plateformes/Utilisation-de-Mathalea-avec-Moodle-ELEA\"\n                style=\"text-decoration:underline;\">documentation</a\n              > pour plus d'information.\n            </section>\n            <!-- FIN BOOKMARKLET -->\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","import { get } from 'svelte/store'\nimport { buildMathAleaURL } from './components/urls'\nimport { mathaleaGetExercicesFromParams } from './mathalea'\nimport { exercicesParams } from './stores/generalStore'\nimport { globalOptions } from './stores/globalOptions'\n\nexport async function sendActivityParams() {\n  const exercices = []\n  const exoParams = get(exercicesParams)\n  const exo = await mathaleaGetExercicesFromParams(exoParams)\n  let i = 0\n  for (const param of exoParams) {\n    let paramUrl = ''\n    for (const key of Object.keys(param)) {\n      if (key === 'sup') {\n        paramUrl += `s=${param[key]}&`\n      } else if (key === 'sup2') {\n        paramUrl += `s2=${param[key]}&`\n      } else if (key === 'sup3') {\n        paramUrl += `s3=${param[key]}&`\n      } else if (key === 'sup4') {\n        paramUrl += `s4=${param[key]}&`\n      } else if (key === 'sup5') {\n        paramUrl += `s5=${param[key]}&`\n      } else if (key === 'nbQuestions') {\n        paramUrl += `n=${param[key]}&`\n      } else if (key === 'versionQcm') {\n        paramUrl += `qcm\\\\=${param[key]}&`\n      } else if (key !== 'alea' && key !== 'id') {\n        paramUrl += `${key}=${param[key]}&`\n      }\n    }\n    paramUrl = paramUrl.slice(0, -1)\n    exercices.push({\n      titre: exo[i].titre,\n      url: paramUrl,\n    })\n    i++\n  }\n  const options = get(globalOptions)\n  const url = buildMathAleaURL({\n    view: 'eleve',\n    mode: 'un_exo_par_page',\n    removeSeed: true,\n    recorder: 'Moodle',\n  }).toString()\n  console.info(url)\n  window.parent.postMessage(\n    {\n      exercices,\n      action: 'mathalea:activityParams',\n      url,\n      globalOptions: options,\n    },\n    '*',\n  )\n}\n","<script lang=\"ts\">\n  import { fly } from 'svelte/transition'\n\n  export let isOpen: boolean = true\n  export let width: number = 400\n</script>\n\n{#if isOpen}\n  <nav\n    id=\"sidenav\"\n    transition:fly|global={{ x: -width, duration: 300 }}\n    class=\"absolute left-0 top-0 h-full z-[1035] overflow-y-auto overscroll-contain\n           bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n    style=\"width: {width}px\"\n  >\n    <slot />\n  </nav>\n{/if}\n","export function ripple(node: HTMLElement, color: string = 'rgba(255, 255, 255, 0.4)') {\n  function handleClick(event: MouseEvent) {\n    const rect = node.getBoundingClientRect()\n    const x = event.clientX - rect.left\n    const y = event.clientY - rect.top\n\n    const rippleEl = document.createElement('span')\n    rippleEl.style.cssText = `\n      position: absolute;\n      background: ${color};\n      border-radius: 50%;\n      pointer-events: none;\n      width: 100px;\n      height: 100px;\n      transform: translate(-50%, -50%) scale(0);\n      animation: ripple-animation 0.6s ease-out forwards;\n      left: ${x}px;\n      top: ${y}px;\n    `\n\n    // Ensure parent has position relative\n    const computedStyle = window.getComputedStyle(node)\n    if (computedStyle.position === 'static') {\n      node.style.position = 'relative'\n    }\n    node.style.overflow = 'hidden'\n\n    node.appendChild(rippleEl)\n\n    rippleEl.addEventListener('animationend', () => {\n      rippleEl.remove()\n    })\n  }\n\n  node.addEventListener('click', handleClick)\n\n  return {\n    destroy() {\n      node.removeEventListener('click', handleClick)\n    },\n    update(newColor: string) {\n      color = newColor\n    }\n  }\n}\n","<script lang=\"ts\">\n  import { ripple } from '../../../../lib/actions/ripple'\n\n  export let isBackToTopButtonVisible = false\n  export let backToTop: () => void\n</script>\n\n{#if isBackToTopButtonVisible}\n  <button\n    on:click={backToTop}\n    type=\"button\"\n    use:ripple={'rgba(255, 255, 255, 0.4)'}\n    class=\"fixed! bottom-5 right-5 rounded-full bg-transparent p-3 text-xl font-medium uppercase leading-tight text-coopmaths-action shadow-md transition duration-150 ease-in-out hover:text-coopmaths-action-lightest hover:shadow-lg focus:text-coopmaths-action-lightest focus:shadow-lg focus:outline-none focus:ring-0 active:text-coopmaths-action-lightest active:shadow-lg\"\n    id=\"btn-back-to-top\"\n    aria-label=\"Retour en haut\"\n  >\n    <i class=\"bx bx-chevrons-up\"></i>\n  </button>\n{/if}\n","<script lang=\"ts\">\n  import { flip } from 'svelte/animate'\n  import { isReordering } from '../../../../lib/stores/generalStore'\n  import type { InterfaceParams } from '../../../../lib/types'\n  import Footer from '../../../Footer.svelte'\n  import Exercice from '../../../shared/exercice/Exercice.svelte'\n\n  export let exercicesParams: InterfaceParams[]\n  export let toggleSidenav: (open: boolean) => void\n</script>\n\n<div\n  id=\"exercisesWrapper\"\n  class=\"flex flex-col w-full md:h-full justify-between md:pl-4\"\n>\n  <div class=\"flex flex-col md:mt-9 xl:mt-0\">\n    {#each exercicesParams as paramsExercice, i (paramsExercice)}\n      <div id=\"exo{i}\" animate:flip={{ duration: $isReordering ? (d) => 30 * Math.sqrt(d) : 0 }}>\n        <Exercice\n          {paramsExercice}\n          {toggleSidenav}\n          indiceExercice={i}\n          indiceLastExercice={exercicesParams.length - 1}\n          on:exerciseRemoved\n        />\n      </div>\n    {/each}\n  </div>\n  <div class=\"hidden md:flex items-center justify-center\">\n    <Footer />\n  </div>\n</div>\n","<script lang=\"ts\">\n  export let setupButtonsList = [\n    { bxName: 'bx-zoom-in' },\n    { bxName: 'bx-zoom-out' },\n    { bxName: 'bx-refresh' },\n    { bxName: 'bx-trash' },\n    { bxName: 'bx-fullScreen' },\n  ]\n  export let exportButtonsList = [\n    { bxName: 'bx-slideshow' },\n    { bxName: 'bxs-graduation' },\n  ]\n</script>\n\n<!--\n  @component\n  Container pour positionner les boutons de rglages gnraux de la liste des exercices\n\n  ### Paramtres\n\n  * `setupButtonsList` : liste d'icnes  afficher\n  * `exportButtonsList` : idem\n  * `barWidthPercentage` : pourcentage pour le calcul de la longueur de la barre...\n\n  ### Remarque\n\n  Les paramtres `setupButtonsList` et `exportButtonsList` ne sont utiles que pour calibrer la barre des boutons.\n  Dans les faits, la dclaration des boutons se fait dans\n\n  ```tsx\n  <div slot=\"setup-buttons\" ...>\n    boutons ici\n  </div>\n  ```\n  et dans\n\n  ```tsx\n  <div slot=\"export-buttons\" ...>\n    boutons ici\n  </div>\n  ```\n -->\n\n<div\n  class={`${\n    $$props.class || ''\n  } flex flex-col w-full md:flex-row justify-start items-start sm:justify-center sm:items-center`}\n>\n  <div class=\"relative flex flex-col w-full\">\n    <div\n      class=\"w-full flex flex-col xl:flex-row md:pr-4 xl:!pl-96 justify-between items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas md:space-y-0 space-y-4\"\n    >\n      <div id=\"setupButtonsBar\" class=\"flex\">\n        <slot name=\"setup-buttons\">\n          {#each setupButtonsList as button}\n            <i\n              class=\"bx bx-sm px-2 {button.bxName} hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n            ></i>\n          {/each}\n        </slot>\n      </div>\n      {#if $$slots.input}\n        <div id=\"input\">\n          <slot name=\"input\" />\n        </div>\n      {/if}\n      {#if $$slots['export-buttons']}\n        <div id=\"exportButtonsBar\" class=\"xl:pr-6\">\n          <slot name=\"export-buttons\">\n            {#each exportButtonsList as button}\n              <i\n                class=\"bx bx-sm px-2 {button.bxName} hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n              ></i>\n            {/each}\n          </slot>\n        </div>\n      {/if}\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../shared/forms/ButtonIconTooltip.svelte'\n  import ButtonTextAction from '../../../shared/forms/ButtonTextAction.svelte'\n  import InputText from '../../../shared/forms/InputText.svelte'\n  import ButtonsDeck from '../../../shared/ui/ButtonsDeck.svelte'\n\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let buildUrlAndOpenItInNewTab: (type: 'usual' | 'eleve') => void\n  export let showSettingsDialog: () => void\n  export let importExercises: (urlFeuilleEleve: string) => void\n  export let isExercisesListEmpty: boolean\n  export let isCapytale: boolean\n  export let handleRecorder: () => void\n\n  let urlFeuilleEleve: string = ''\n</script>\n\n<nav\n  class=\"flex justify-between items-start w-full p-4\n    flex-col md:flex-row\n    mx-auto md:space-x-6\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  <div\n    class=\"flex flex-row justify-start\n    md:items-end\n    space-x-0 md:space-x-2\"\n  >\n    <div\n      class=\"font-logo9 tracking-tighter font-black\n      text-5xl md:text-4xl\n      text-coopmaths-struct dark:text-coopmathsdark-struct\"\n    >\n      MathALA\n    </div>\n    <div\n      class=\"flex flex-row font-light text-sm\n      text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n    >\n      <span class=\"font-light font-sans mr-1 tracking-normal\"> par </span>\n      <a\n        href=\"https://coopmaths.fr\"\n        target=\"_blank\"\n        rel=\"noreferrer\"\n        class=\"font-extrabold font-logo9 tracking-tighter\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      >\n        CoopMaths\n      </a>\n    </div>\n  </div>\n  <div class=\"w-full flex flex-row\">\n    <ButtonsDeck class=\"mt-4 md:mt-0\">\n      <div\n        slot=\"setup-buttons\"\n        class=\"flex flex-row justify-center items-center space-x-4\"\n      >\n        <ButtonIconTooltip\n          icon=\"bx-zoom-out text-3xl\"\n          tooltip=\"Rduire la taille du texte\"\n          on:click={() => zoomUpdate('-')}\n        />\n        <ButtonIconTooltip\n          icon=\"bx-zoom-in text-3xl\"\n          tooltip=\"Augmenter la taille du texte\"\n          on:click={() => zoomUpdate('+')}\n        />\n        <ButtonIconTooltip\n          icon=\"bx-refresh text-3xl\"\n          tooltip=\"Nouveaux noncs\"\n          on:click={newDataForAll}\n        />\n        <ButtonIconTooltip\n          icon=\"bx-trash text-3xl\"\n          tooltip=\"Supprimer tous les exercicess\"\n          on:click={trash}\n        />\n      </div>\n      <div slot=\"input\" class=\"flex flex-row items-center space-x-4\">\n        <InputText\n          title=\"Importer les exercices d'une feuille lve\"\n          placeholder=\"Lien\"\n          bind:value={urlFeuilleEleve}\n          classAddenda=\"w-50\"\n        />\n        <ButtonTextAction\n          class=\"text-sm py-1 px-2 rounded-md h-7\"\n          text=\"Ajouter\"\n          disabled={urlFeuilleEleve === ''}\n          on:click={() => importExercises(urlFeuilleEleve)}\n        />\n      </div>\n      <div\n        slot=\"export-buttons\"\n        class=\"flex flex-row justify-center items-center space-x-4\"\n      >\n        {#if !isCapytale}\n          <ButtonTextAction\n            class=\"text-sm py-1 px-2 rounded-md h-7\"\n            text=\"Valider\"\n            disabled={isExercisesListEmpty}\n            on:click={handleRecorder}\n          />\n        {/if}\n        {#if isCapytale}\n          <ButtonIconTooltip\n            icon=\"bx-cog text-3xl\"\n            tooltip=\"Rgler l'affichage du mode lve\"\n            disabled={isExercisesListEmpty}\n            on:click={showSettingsDialog}\n          />\n        {/if}\n        <div>\n          <ButtonIconTooltip\n            icon=\"bx-log-out bx-rotate-180\"\n            tooltip=\"Rejoindre MathALA\"\n            class=\"text-3xl\"\n            disabled={isExercisesListEmpty}\n            on:click={() => {\n              buildUrlAndOpenItInNewTab('usual')\n            }}\n          />\n        </div>\n      </div>\n    </ButtonsDeck>\n  </div>\n</nav>\n","<script lang=\"ts\">\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n  export let text: string = ''\n  export let indice: number\n\n  function remove() {\n    exercicesParams.update((l) => [\n      ...l.slice(0, indice),\n      ...l.slice(indice + 1),\n    ])\n  }\n</script>\n\n<!--\n  @component\n  Chip ddi pour les exercices. Contient un bouton `x` qui permet de le retirer de la liste.\n\n  ### Paramtres\n\n  * `text` : titre du chip\n  * `indice` : propre position dans la liste de chips\n\n  ### Utilisation\n\n  ``tsx\n  <ChipExo text={id.title} {indice} />\n  ```\n -->\n\n<div\n  id=\"exo-{indice}\"\n  class=\"flex justify-center w-full items-center rounded-full bg-coopmaths-struct dark:bg-coopmathsdark-struct pl-1 pr-2 py-[1px] shadow-sm cursor-move\"\n>\n  <div\n    class=\"block w-10/12 px-1 text-center text-coopmaths-canvas dark:text-coopmathsdark-canvas text-xs text-ellipsis overflow-hidden whitespace-nowrap\"\n  >\n    {text.replaceAll('_', ' ')}\n  </div>\n  <button\n    class=\"ml-2 w-2/12 bg-transparent hover focus:outline-none cursor-pointer\"\n    aria-label=\"Retirer l'exercice\"\n    on:click={remove}\n  >\n    <i\n      class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-x font-semibold text-base\"\n    ></i>\n  </button>\n</div>\n\n<style>\n</style>\n","<script lang=\"ts\">\n  import Sortable from 'sortablejs'\n  import ChipExo from './ChipExo.svelte'\n  import {\n    exercicesParams,\n    moveExercice,\n    isReordering,\n  } from '../../../lib/stores/generalStore'\n  import { get } from 'svelte/store'\n  import { onMount } from 'svelte'\n  import {\n    uuidCount,\n    exercisesUuidRanking,\n  } from '../../../lib/components/counts'\n  import type { ChipContentType } from '../../../lib/types'\n  export let chipsListDisplayed: boolean\n  let listIdsForChips: ChipContentType[] = []\n\n  function buildChipsList(params: typeof $exercicesParams): ChipContentType[] {\n    const lIFC: ChipContentType[] = []\n    const ranks = exercisesUuidRanking(params)\n    const counts = uuidCount(params)\n    for (const [i, ex] of params.entries()) {\n      const insert: string = `${\n        counts[ex.uuid] > 1 ? ' [' + ranks[i] + ']' : ''\n      }`\n      const obj: ChipContentType = {\n        ref: ex.id ?? ex.uuid,\n        title: `${ex.id ?? ex.uuid}${insert}`,\n        key: ex.uuid + '_' + (ex.alea || i.toString()),\n      }\n      lIFC.push(obj)\n    }\n    return lIFC\n  }\n\n  // Initialisation et mise  jour uniquement quand ce n'est pas un rordonnancement\n  $: if (!$isReordering) {\n    listIdsForChips = buildChipsList($exercicesParams)\n  }\n\n  onMount(() => {\n    listIdsForChips = buildChipsList(get(exercicesParams))\n    Sortable.create(document.getElementById('chips-list'), {\n      animation: 150,\n      // Erreur dans le linter : Parameter 'evt' implicitly has an 'any' type.\n      // Sortable tant crit en JavaScript on ne connait pas le type de `evt`.\n      // @ts-ignore\n      onEnd: (evt) => {\n        isReordering.set(true)\n        // Rordonner listIdsForChips pour rester synchronis avec le DOM\n        const [moved] = listIdsForChips.splice(evt.oldIndex, 1)\n        listIdsForChips.splice(evt.newIndex, 0, moved)\n        listIdsForChips = listIdsForChips\n        // Mettre  jour le store\n        exercicesParams.update((l) => {\n          return moveExercice(l, evt.oldIndex, evt.newIndex)\n        })\n        setTimeout(() => isReordering.set(false), 300)\n      },\n    })\n  })\n</script>\n\n<div class=\"w-full flex flex-col space-y-6\">\n  <div class=\"relative w-full flex flex-col\">\n    <button\n      class=\"absolute -right-3 -top-3\"\n      type=\"button\"\n      aria-label=\"Fermer la liste\"\n      on:click={() => {\n        chipsListDisplayed = false\n      }}\n    >\n      <i\n        class=\"bx bx-x text-2xl text-coopmaths-action hover:text-coopmaths-action-lightest\"\n      ></i>\n    </button>\n    <div class=\"text-coopmaths-struct font-semibold text-lg\">\n      Rorganisation des exercices\n    </div>\n    <div class=\"p-2 text-coopmaths-corpus-light text-sm font-extralight\">\n      Saisir un exercice et le dposer  la place souhaite.\n    </div>\n  </div>\n  <div\n    class=\"w-full grid justify-items-stretch place-content-stretch grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-7 xl:grid-cols-8 2xl:grid-cols-10 gap-2 p-0 items-center overflow-x-auto whitespace-nowrap\"\n    id=\"chips-list\"\n  >\n    {#each listIdsForChips as id, indice (id.key)}\n      <ChipExo text={id.title} {indice} />\n    {/each}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ChipsList from '../../../../shared/ui/ChipsList.svelte'\n  import { fly, blur } from 'svelte/transition'\n\n  export let reorderModalDisplayed: boolean\n</script>\n\n{#if reorderModalDisplayed}\n  <div\n    in:fly|global={{ y: -1000 }}\n    out:blur|global\n    id=\"exoChipsList\"\n    class=\"z-[1090] fixed top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-2/3 flex flex-row justify-start items-center p-8 rounded-md shadow-2xl bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark p\"\n  >\n    <ChipsList bind:chipsListDisplayed={reorderModalDisplayed} />\n  </div>\n{/if}\n","<script lang=\"ts\">\n  export let isSidenavOpened: boolean\n  export let isRecorder: boolean\n  export let toggleSidenav: (test: boolean) => void\n  export let isMd: boolean\n</script>\n\n{#if isMd}\n  <div\n    class=\"flex justify-center items-center absolute z-50 left-0\n     h-8 md:h-10\n     w-8 md:w-10\n    {isRecorder\n      ? `${isSidenavOpened ? 'translate-x-[400px]' : ' translate-x-0'} top-0 rounded-r-md transition-transform ease-in-out`\n      : 'bottom-0 rounded-t-md'}\n    bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <button\n      type=\"button\"\n      aria-controls=\"sidenav\"\n      aria-haspopup=\"true\"\n      aria-label={isSidenavOpened ? 'Fermer le menu' : 'Ouvrir le menu'}\n      on:click={() => {\n        toggleSidenav(false)\n      }}\n    >\n      <i\n        class=\"bx\n        text-lg md:text-2xl\n        {isSidenavOpened ? 'bx-x' : 'bx-right-arrow-alt'}\n        text-coopmaths-action dark:text-coopmathsdark-action\n        hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n      ></i>\n    </button>\n  </div>\n{/if}\n","<svg\n  width=\"32.035019\"\n  height=\"31.965853\"\n  viewBox=\"0 0 8.4759316 8.4576318\"\n  version=\"1.1\"\n  id=\"svg4191\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class={$$props.class}\n  fill=\"currentColor\"\n  stroke=\"currentColor\"\n>\n  <defs id=\"defs4188\"></defs>\n  <g id=\"layer1\" transform=\"translate(0.00463201,-0.00451693)\">\n    <g\n      id=\"g4703\"\n      transform=\"matrix(0.68088189,0,0,0.64722958,-14.592662,0.40513752)\"\n    >\n      <path\n        id=\"rect9846\"\n        style=\"display:inline;fill:none;stroke:currentColor;stroke-width:1.08479\"\n        d=\"M 21.967594,0.542395 H 33.331265 V 11.906066 H 21.967594 Z\"\n      ></path>\n      <path\n        style=\"display:inline;fill:currentColor;fill-opacity:1;stroke-width:0.353;stroke-dasharray:none\"\n        d=\"m 30.187147,10.138692 c -3.21818,-4.0175496 -3.01441,-3.9353796 -5.07458,-2.0463796 -4.03864,3.7030996 -4.28539,3.6763596 -0.9908,-0.10736 1.03241,-1.18568 1.8771,-2.22601 1.8771,-2.31183 0,-0.0858 -0.79128,-0.54447 -1.7584,-1.01921 -1.93433,-0.94953 -2.0473,-1.18716 -1.13073,-2.37828 l 0.62296,-0.80956 1.45065,1.05084 c 0.79785,0.57796 1.56133,1.22995 1.69663,1.44886 0.33319,0.53911 1.85035,-1.5541 2.36047,-3.25671996 0.27287,-0.91077 0.60202,-1.32803 1.0476,-1.32803 1.07062,0 0.77611,1.39994 -0.80291,3.81656996 -1.45263,2.22318 -1.45263,2.22318 -0.75445,2.99567 1.35314,1.49715 3.64953,5.2880896 3.54188,5.8470396 -0.0716,0.3719 -0.78625,-0.27974 -2.08542,-1.90161 z\"\n        id=\"path6447\"\n      ></path>\n    </g>\n  </g>\n</svg>\n","<svg\n  width=\"31.999998\"\n  height=\"31.999998\"\n  viewBox=\"0 2 32 28\"\n  version=\"1.1\"\n  id=\"svg2697\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class={$$props.class}\n  stroke=\"currentColor\"\n>\n  <g fill=\"none\" stroke=\"currentColor\">\n    <rect x=\"6\" y=\"2\" width=\"21\" height=\"28\" rx=\"4\" ry=\"4\" stroke-width=\"2\"\n    ></rect>\n    <path\n      transform=\"matrix(.075075 .00043984 -.00043984 .075075 -2.3679 -12.924)\"\n      d=\"m294.47 523.45c-9.0804 8.8134-45.575-17.77-58.101-15.977-12.527 1.7928-40.099 37.545-51.287 31.633-11.188-5.9125 2.8168-48.836-2.7592-60.195-5.576-11.359-48.099-26.535-45.933-39.002s47.316-12.412 56.396-21.225c9.0804-8.8134 10.372-53.945 22.899-55.738 12.527-1.7928 26.426 41.164 37.614 47.077s54.51-6.805 60.086 4.5544c5.576 11.359-30.984 37.853-33.149 50.321-2.1659 12.467 23.316 49.739 14.236 58.552z\"\n      stroke-width=\"15.984\"\n    ></path>\n    <path\n      transform=\"matrix(.031314 -.025224 .025224 .031314 2.3208 .20682)\"\n      d=\"m294.47 523.45c-9.0804 8.8134-45.575-17.77-58.101-15.977-12.527 1.7928-40.099 37.545-51.287 31.633-11.188-5.9125 2.8168-48.836-2.7592-60.195-5.576-11.359-48.099-26.535-45.933-39.002s47.316-12.412 56.396-21.225c9.0804-8.8134 10.372-53.945 22.899-55.738 12.527-1.7928 26.426 41.164 37.614 47.077s54.51-6.805 60.086 4.5544c5.576 11.359-30.984 37.853-33.149 50.321-2.1659 12.467 23.316 49.739 14.236 58.552z\"\n      stroke-width=\"24.87\"\n    ></path>\n  </g>\n</svg>\n","<svg\n  width=\"31.999998\"\n  height=\"31.999998\"\n  viewBox=\"0 0 8.4666661 8.4666661\"\n  version=\"1.1\"\n  id=\"svg2697\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class={$$props.class}\n  fill=\"currentColor\"\n>\n  <defs id=\"defs2694\"></defs>\n  <g id=\"layer1\">\n    <path\n      id=\"path5800\"\n      style=\"fill:currentColor;stroke:none;stroke-width:0.024561\"\n      d=\"M 5.6190408,1.3436103 C 3.1929106,1.6410426 2.0896442,1.8517723 -6.6666665e-8,3.0631178 L 0.01937674,3.1181452 l 0.1660648,0.00168 c -0.0151705,0.1672543 -0.0417532,0.580651 -0.00793,1.2022881 -0.2318563,0.6710048 -0.005861,1.1268667 0.20632167,1.622751 0.0336508,-0.51578 0.0301858,-1.0806985 -0.12822484,-1.6428984 -0.0331509,-0.6174618 -0.005861,-1.0234456 0.009137,-1.1813718 l 1.38524723,0.013274 a 6.3367299,6.3367299 0 0 0 0.041012,0.8119988 c 2.413e-4,7.41e-5 4.827e-4,1.465e-4 7.24e-4,2.465e-4 -0.019394,0.1136922 -0.029686,0.2337457 -0.029686,0.3610258 V 7.1230563 H 3.0168247 V 4.4640923 C 3.0166023,4.3152495 3.0333743,4.1870108 3.0661804,4.0780232 3.4148371,4.0207547 3.7437413,3.892485 4.0371069,3.6999667 4.2663963,3.8138486 4.3816797,4.0680313 4.3816797,4.4640923 v 2.658964 h 1.354546 V 4.4640923 C 5.7372083,3.9080313 5.9669011,3.6300947 6.425373,3.6302654 6.8838432,3.6304378 7.1130792,3.9083588 7.1130792,4.4640923 v 2.658964 H 8.4666667 V 4.3070919 C 8.466496,3.7267978 8.2649892,3.2877561 7.8621894,2.9899135 7.5078576,2.7238375 7.0286125,2.5907977 6.4244128,2.5907977 c -0.6608527,0 -1.1162405,0.1571004 -1.3661083,0.4713116 -0.066043,-0.071577 -0.1408956,-0.1345516 -0.2236867,-0.1898186 5e-5,-9.82e-5 1.207e-4,-1.982e-4 1.948e-4,-2.879e-4 C 4.6513449,2.6664276 4.2917878,2.3859638 4.2917878,2.3859638 L 5.636261,1.403525 Z\"\n    ></path>\n  </g>\n</svg>\n","<svg\n  width=\"28.995893\"\n  height=\"31.999998\"\n  viewBox=\"0 0 7.67183 8.4666661\"\n  version=\"1.1\"\n  id=\"svg-pdf-text-icon\"\n  class={$$props.class}\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n>\n  <defs id=\"defs504\"></defs>\n  <g id=\"layer1\" transform=\"translate(-0.39741871)\">\n    <path\n      d=\"M 0.39741874,0 V 8.466666 H 1.3535184 V 5.0799995 C 1.6990966,5.0684802 2.0446748,4.9417683 2.2635409,4.59619 2.516965,4.1930155 2.6667156,3.4903397 2.6667156,2.53424 2.6667156,1.5781402 2.516965,0.9100225 2.2635409,0.50684742 2.0101169,0.11519274 1.7451736,0 1.3650377,0 Z M 1.3535184,3.8128794 v -2.568798 c 0.1036735,0 0.2419047,0 0.2995011,0.1267121 0.092154,0.2073467 0.092154,0.7372339 0.092154,1.2095236 0,0.4722902 0,0.9100226 -0.092154,1.0943311 C 1.5954226,3.7898409 1.4456726,3.8128794 1.3535184,3.8128794 Z M 3.1735546,8.466666 h 0.9215418 c 0.7602722,0 1.0367347,-0.2995011 1.1864853,-0.7487527 C 5.4543708,7.2110652 5.4543708,5.897868 5.4543708,4.2390926 5.4543708,2.5803171 5.431332,1.5205444 5.2355045,0.87546438 5.0281577,0.23038547 4.7286565,0 3.9683845,0 H 3.1735546 Z M 4.1296543,7.2225845 V 1.2440814 c 0.1382312,0.01152 0.3110204,-0.02304 0.3455782,0.276463 0.057597,0.5183667 0.034559,1.3362352 0.034559,3.0756456 v 1.9813152 c 0,0.6796371 -0.2303856,0.6450793 -0.3801372,0.6450793 z M 8.0692488,1.2786395 V 0 H 6.0879338 V 8.466666 H 7.0440335 V 4.7804984 H 7.7351899 V 3.5018591 H 7.0440335 V 1.2786395 Z\"\n      id=\"text1\"\n      style=\"font-stretch:ultra-condensed;font-size:11.2889px;font-family:'League Gothic';-inkscape-font-specification:'League Gothic, Ultra-Condensed';text-align:center;letter-spacing:0px;word-spacing:0px;text-anchor:middle;stroke-width:3.06122;stroke-linecap:round;stroke-linejoin:round\"\n      aria-label=\"PDF\"\n    ></path>\n  </g>\n</svg>\n","<svg\n  width=\"49.081623mm\"\n  height=\"46.026386mm\"\n  viewBox=\"0 0 49.081623 46.026386\"\n  version=\"1.1\"\n  id=\"svg863\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class={$$props.class}\n  fill=\"currentColor\"\n  stroke=\"currentColor\"\n>\n  <defs id=\"defs860\"></defs>\n  <g id=\"layer1\" transform=\"translate(-61.956809,-97.69643)\">\n    <g id=\"g983\" transform=\"translate(-0.54081118,0.98680658)\">\n      <path\n        id=\"path4521\"\n        d=\"m 72.49762,104.7401 v 1.51567 11.08356 h 3.029274 v -9.56996 h 9.570475 v -3.02927 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4519\"\n        d=\"m 88.126642,104.7401 v 3.02927 h 1.737878 v -3.02927 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4517\"\n        d=\"m 92.894309,104.7401 v 3.02927 h 9.569961 v 9.56996 h 3.0272 V 104.7401 Z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4515\"\n        d=\"m 72.49762,120.36912 v 1.73787 h 3.029274 v -1.73787 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4513\"\n        d=\"m 102.46427,120.36912 v 1.73787 h 3.0272 v -1.73787 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4511\"\n        d=\"m 72.49762,125.13627 v 12.59974 h 12.599749 v -3.02927 h -9.570475 v -9.57047 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4509\"\n        d=\"m 102.46427,125.13627 v 9.57047 h -9.569961 v 3.02927 h 12.597161 v -12.59974 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"rect4493\"\n        d=\"m 88.126642,134.70674 v 3.02927 h 1.737878 v -3.02927 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <text\n        xml:space=\"preserve\"\n        style=\"font-style:normal;font-weight:normal;font-size:47.1417px;line-height:1000%;font-family:Sans;letter-spacing:0px;word-spacing:0px;stroke:none;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n        x=\"73.021278\"\n        y=\"140.82944\"\n        id=\"text4529\"\n        transform=\"scale(1.0297607,0.9710994)\"\n        ><tspan\n          id=\"tspan4527\"\n          x=\"73.021278\"\n          y=\"140.82944\"\n          style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:Wingdings;-inkscape-font-specification:Wingdings;stroke-width:0.264583px\"\n          ></tspan\n        ></text\n      >\n    </g>\n  </g>\n</svg>\n","<script lang=\"ts\">\n  import AmcIcon from '../../../../../../../components/shared/icons/AmcIcon.svelte'\n  import AnkiIcon from '../../../../../../../components/shared/icons/AnkiIcon.svelte'\n  import MoodleIcon from '../../../../../../../components/shared/icons/MoodleIcon.svelte'\n  import PdfTextIcon from '../../../../../../../components/shared/icons/PdfTextIcon.svelte'\n  import type { VueType } from '../../../../../../../lib/VueType'\n  import ButtonActionInfo from '../../../../../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n  import QcmCamIcon from '../../../../../../shared/icons/QcmCamIcon.svelte'\n\n  export let handleExport: (vue: VueType) => void\n  export let exportQcmCam: () => Promise<void>\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-slideshow text-3xl\"\n  tooltip=\"Diaporama\"\n  on:click={() => handleExport('diaporama')}\n/>\n<ButtonIconTooltip\n  icon={'bx-link text-3xl'}\n  cornerIcon=\"bxs-graduation\"\n  cornerIconClass=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n  tooltip=\"Lien pour les lves\"\n  on:click={() => handleExport('confeleve')}\n/>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"LaTeX\"\n  on:click={() => handleExport('latex')}\n>\n  <PdfTextIcon\n    class=\"w-7 h-7 hover:fill-coopmaths-action-lightest fill-coopmaths-action dark:fill-coopmathsdark-action dark:hover:fill-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"AMC\"\n  on:click={() => handleExport('amc')}\n>\n  <AmcIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"Anki\"\n  on:click={() => handleExport('anki')}\n>\n  <AnkiIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"Moodle\"\n  on:click={() => handleExport('moodle')}\n>\n  <MoodleIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"QCM Cam\"\n  on:click={exportQcmCam}\n>\n  <QcmCamIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<ButtonActionInfo\n  action=\"download\"\n  useCurrentUrl={true}\n  fileName=\"mathAlea\"\n  successMessage=\"Tlchargement en cours\"\n  errorMessage=\"Erreur lors du tlchargement\"\n  icon=\"bxs-file-export text-2xl\"\n  tooltip=\"Fichier de redirection\"\n/>\n","<script lang=\"ts\">\n  import TwoStatesIcon from '../../../../../../../components/shared/icons/TwoStatesIcon.svelte'\n\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  let isAllInteractive: boolean = false\n</script>\n\n<button\n  type=\"button\"\n  on:click={() => {\n    isAllInteractive = !isAllInteractive\n    setAllInteractive(isAllInteractive)\n  }}\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip={isAllInteractive\n    ? \"Supprimer l'interactivit\"\n    : 'Tous les exercices en interactif'}\n>\n  <div class=\"px-2\">\n    <TwoStatesIcon isOnStateActive={isAllInteractive} size={7} />\n  </div>\n</button>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n  export let reorderModalDisplayed: boolean\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-transfer text-3xl rotate-90\"\n  tooltip=\"Rorganisation\"\n  on:click={() => {\n    reorderModalDisplayed = !reorderModalDisplayed\n  }}\n/>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let newDataForAll: () => void\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-refresh text-3xl\"\n  tooltip=\"Nouveaux noncs\"\n  on:click={newDataForAll}\n/>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let trash: () => void\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-trash text-3xl\"\n  tooltip=\"Supprimer tous les exercices\"\n  on:click={trash}\n/>\n","<script lang=\"ts\">\n  import ZoomButtons from './ZoomButtons.svelte'\n  import InteractivityButton from './InteractivityButton.svelte'\n  import ReorderButton from './ReorderButton.svelte'\n  import NewDataButton from './NewDataButton.svelte'\n  import TrashButton from './TrashButton.svelte'\n  import FullscreenButton from './FullscreenButton.svelte'\n\n  export let reorderModalDisplayed: boolean\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let setFullScreen: (isFullScreen: boolean) => void\n</script>\n\n<ZoomButtons {zoomUpdate} />\n<InteractivityButton {setAllInteractive} />\n<ReorderButton bind:reorderModalDisplayed />\n<NewDataButton {newDataForAll} />\n<TrashButton {trash} />\n<FullscreenButton callback={setFullScreen} />\n","<script lang=\"ts\">\n  import type { VueType } from '../../../../../../lib/VueType'\n  import ButtonsDeck from '../../../../../shared/ui/ButtonsDeck.svelte'\n  import ExportButtons from './exportButtons/ExportButtons.svelte'\n  import SetupButtons from './setupButtons/SetupButtons.svelte'\n\n  export let reorderModalDisplayed: boolean = false\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let setFullScreen: (isFullScreen: boolean) => void\n  export let handleExport: (vue: VueType) => void\n  export let exportQcmCam: () => Promise<void>\n</script>\n\n<ButtonsDeck class=\"md:pl-10 flex md:flex\">\n  <div\n    slot=\"setup-buttons\"\n    class=\"flex flex-row justify-start items-center space-x-3 md:space-x-4\"\n  >\n    <SetupButtons\n      bind:reorderModalDisplayed\n      {zoomUpdate}\n      {setAllInteractive}\n      {newDataForAll}\n      {trash}\n      {setFullScreen}\n    />\n  </div>\n  <div\n    slot=\"export-buttons\"\n    class=\"flex flex-row justify-end items-center space-x-3 md:space-x-4\"\n  >\n    <ExportButtons {handleExport} {exportQcmCam} />\n  </div>\n</ButtonsDeck>\n","<script lang=\"ts\">\n  import NavBar from '../../../../../components/shared/header/NavBar.svelte'\n  import type { VueType } from '../../../../../lib/VueType'\n  import type { Language } from '../../../../../lib/types/languages'\n  import NavBarRecorder from '../../capytale/NavBarRecorder.svelte'\n  import ModalReorder from './ModalReorder.svelte'\n  import SideMenuWrapper from './SideMenuWrapper.svelte'\n  import HeaderButtons from './headerButtons/HeaderButtons.svelte'\n\n  export let isExerciseDisplayed: boolean\n  export let isNavBarVisible: boolean\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let setFullScreen: (isFullScreen: boolean) => void\n  export let handleExport: (vue: VueType) => void\n  export let handleRecorder: () => void\n  export let locale: Language\n  export let handleLanguage: (lang: string) => void\n  export let isCapytale: boolean\n  export let isRecorder: boolean\n  export let buildUrlAndOpenItInNewTab: (type: 'usual' | 'eleve') => void\n  export let showSettingsDialog: () => void\n  export let importExercises: (urlFeuilleEleve: string) => void\n  export let isExercisesListEmpty: boolean\n  export let isSidenavOpened: boolean\n  export let toggleSidenav: (test: boolean) => void\n  export let exportQcmCam: () => Promise<void>\n  export let isMd: boolean\n\n  let reorderModalDisplayed: boolean\n</script>\n\n<header\n  class=\"flex flex-col scrollbar-hide w-full\n  md:sticky md:top-0 md:z-50\n  bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  {#if isRecorder}\n    <div\n      id=\"headerCapytale\"\n      class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas print-hidden\"\n    >\n      <NavBarRecorder\n        {zoomUpdate}\n        {newDataForAll}\n        {trash}\n        {buildUrlAndOpenItInNewTab}\n        {showSettingsDialog}\n        {importExercises}\n        {isExercisesListEmpty}\n        {isCapytale}\n        {handleRecorder}\n      />\n    </div>\n  {:else}\n    <!-- Entte -->\n    {#if isNavBarVisible}\n      <div\n        id=\"headerStart\"\n        class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas print-hidden\"\n      >\n        <NavBar\n          subtitle=\"Conception de document\"\n          subtitleType=\"design\"\n          {locale}\n          {handleLanguage}\n        />\n      </div>\n    {/if}\n    <div\n      class=\"flex {isExerciseDisplayed ? 'xl:h-[50px] md:h-[100px]' : 'h-0'}\"\n    >\n      <div\n        class={!isExerciseDisplayed\n          ? 'hidden'\n          : 'relative w-full flex flex-col justify-center items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n        id=\"barre-boutons\"\n      >\n        <SideMenuWrapper\n          {isRecorder}\n          {isSidenavOpened}\n          {toggleSidenav}\n          {isMd}\n        />\n        <HeaderButtons\n          bind:reorderModalDisplayed\n          {zoomUpdate}\n          {setAllInteractive}\n          {newDataForAll}\n          {trash}\n          {setFullScreen}\n          {handleExport}\n          {exportQcmCam}\n        />\n      </div>\n    </div>\n  {/if}\n</header>\n\n<ModalReorder {reorderModalDisplayed} />\n","<script lang=\"ts\">\n  import type { CanOptions } from '../../../../../lib/types/can'\n  import ButtonToggleAlt from '../../../../shared/forms/ButtonToggleAlt.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n  import InputNumber from '../../../../shared/forms/InputNumber.svelte'\n  import InputText from '../../../../shared/forms/InputText.svelte'\n\n  export let canOptions: CanOptions\n  export let toggleCan: () => void\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\ntext-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Course aux nombres\n</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <div\n    class=\"flex flex-col items-start justify-start space-y-2 text-sm font-light\n    {canOptions.isChoosen\n      ? 'text-coopmaths-corpus-light dark:text-coopmathsdark-corpus'\n      : 'text-coopmaths-corpus-light/10 dark:text-coopmathsdark-corpus/10'}\"\n  >\n    <ButtonToggleAlt\n      title={'Format CAN'}\n      class=\"\"\n      id={'config-eleve-format-can-toggle'}\n      bind:value={canOptions.isChoosen}\n      on:toggle={toggleCan}\n      explanations={[\n        'Les questions seront poses les unes  la suite des autres en temps limit.',\n        'Chaque exercice sera dans un onglet diffrent',\n      ]}\n    />\n    <div class=\"flex justify-start flex-row items-center space-x-2\">\n      <div>Dure&nbsp;:</div>\n      <InputNumber\n        id=\"config-eleve-can-nb-questions-input\"\n        bind:value={canOptions.durationInMinutes}\n        isDisabled={!canOptions.isChoosen}\n      />\n      <div>\n        minute{canOptions.durationInMinutes !== undefined &&\n        canOptions.durationInMinutes > 1\n          ? 's'\n          : ''}.\n      </div>\n    </div>\n    <div class=\"flex justify-start flex-row items-center space-x-2\">\n      <div>Sous-titre :</div>\n      <InputText\n        inputID=\"config-eleve-can-duration-input\"\n        bind:value={canOptions.subTitle}\n        isDisabled={!canOptions.isChoosen}\n      />\n    </div>\n    <ButtonToggleAlt\n      title={'Accs aux solutions'}\n      id={'config-eleve-solutions-can-toggle'}\n      bind:value={canOptions.solutionsAccess}\n      isDisabled={!canOptions.isChoosen}\n      explanations={[\n        'Les lves auront accs aux solutions dans le format dfini ci-dessous.',\n        \"Les lves n'auront pas accs aux solutions.\",\n      ]}\n    />\n    <FormRadio\n      title=\"can-solutions-config\"\n      bind:valueSelected={canOptions.solutionsMode}\n      isDisabled={!canOptions.isChoosen || !canOptions.solutionsAccess}\n      labelsValues={[\n        {\n          label: 'Solutions rassembles  la fin.',\n          value: 'gathered',\n        },\n        {\n          label: 'Solutions avec les questions.',\n          value: 'split',\n        },\n      ]}\n    />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import type { CanOptions } from '../../../../../lib/types/can'\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n\n  export let globalOptions: InterfaceGlobalOptions\n  export let canOptions: CanOptions\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\n  text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Correction\n</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <ButtonToggle\n    isDisabled={canOptions.isChoosen}\n    titles={['Accs aux corrections', 'Pas de corrections']}\n    bind:value={globalOptions.isSolutionAccessible}\n  />\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n\n  export let globalOptions: InterfaceGlobalOptions\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\n  text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Donnes\n</div>\n<div class=\"text-sm font-extralight\">Tous les lves auront des pages :</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <ButtonToggle\n    titles={['diffrentes', 'identiques']}\n    bind:value={globalOptions.isDataRandom}\n  />\n</div>\n","<script lang=\"ts\">\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n\n  export let setInteractive: string = '2'\n  export let oneShot: boolean = false\n  export let isDisabled: boolean\n  export let setInteractivity: (value: string) => void\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\n  text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Interactivit\n</div>\n<FormRadio\n  title=\"Interactif\"\n  bind:valueSelected={setInteractive}\n  {isDisabled}\n  on:newvalue={() => setInteractivity(setInteractive)}\n  labelsValues={[\n    { label: 'Laisser tel quel', value: '2' },\n    { label: 'Tout interactif', value: '1' },\n    { label: \"Pas d'interactivit\", value: '0' },\n  ]}\n/>\n<div class=\"pl-2 pt-2\">\n  <ButtonToggle\n    titles={[\n      'Les lves peuvent rpondre une seule fois',\n      'Les lves peuvent rpondre plusieurs fois',\n    ]}\n    bind:value={oneShot}\n  />\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n\n  export let globalOptions: InterfaceGlobalOptions\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\ntext-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Affichage des titres\n</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <ButtonToggle\n    titles={['Tous les titres sont affichs', 'Tous les titres sont masqus']}\n    bind:value={globalOptions.isTitleDisplayed}\n  />\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import type { CanOptions } from '../../../../../lib/types/can'\n  import ButtonTextAction from '../../../../shared/forms/ButtonTextAction.svelte'\n  import BasicClassicModal from '../../../../shared/modal/BasicClassicModal.svelte'\n  import ModalCapytalSettingsCan from './ModalCapytalSettingsCAN.svelte'\n  import ModalCapytalSettingsCorrection from './ModalCapytalSettingsCorrection.svelte'\n  import ModalCapytalSettingsData from './ModalCapytalSettingsData.svelte'\n  import ModalCapytalSettingsInteractivity from './ModalCapytalSettingsInteractivity.svelte'\n  import ModalCapytalSettingsTitles from './ModalCapytalSettingsTitles.svelte'\n\n  export let isSettingsDialogDisplayed = false\n  export let globalOptions: InterfaceGlobalOptions\n  export let canOptions: CanOptions\n  export let toggleCan: () => void\n  export let buildUrlAndOpenItInNewTab: (status: 'eleve' | 'usual') => void\n  export let updateParams: (params: {\n    globalOptions: InterfaceGlobalOptions\n    canOptions: CanOptions\n  }) => void\n\n  const params = {\n    globalOptions,\n    canOptions,\n  }\n\n  $: if (globalOptions) {\n    params.globalOptions = globalOptions\n  }\n\n  $: if (canOptions) {\n    params.canOptions = canOptions\n  }\n\n  function setInteractivity(value: string) {\n    params.globalOptions.setInteractive = value\n  }\n</script>\n\n<BasicClassicModal\n  bind:isDisplayed={isSettingsDialogDisplayed}\n  on:close={() => updateParams(params)}\n>\n  <div slot=\"header\">Rglages de l'affichage des exercices</div>\n  <div\n    slot=\"content\"\n    class=\"pt-2 pl-2 grid grid-flow-row text-justify\n      lg:grid-cols-2 md:gap-4 font-light\"\n  >\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsInteractivity\n        setInteractive={params.globalOptions.setInteractive ?? '2'}\n        {setInteractivity}\n        bind:oneShot={params.globalOptions.oneShot}\n        bind:isDisabled={params.canOptions.isChoosen}\n      />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsCan\n        bind:canOptions={params.canOptions}\n        bind:toggleCan\n      />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsData bind:globalOptions={params.globalOptions} />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsTitles bind:globalOptions={params.globalOptions} />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsCorrection\n        bind:globalOptions={params.globalOptions}\n        bind:canOptions={params.canOptions}\n      />\n    </div>\n  </div>\n  <div slot=\"footer\" class=\"flex flex-row justify-end space-x-4 w-full\">\n    <div class=\"pt-4 pb-8 px-4\">\n      <ButtonTextAction\n        class=\"text-sm py-1 px-2 rounded-md h-7\"\n        on:click={() => {\n          isSettingsDialogDisplayed = false\n        }}\n        text=\"Valider\"\n      />\n    </div>\n    <div class=\"pt-4 pb-8 px-4\">\n      <ButtonTextAction\n        class=\"text-sm py-1 px-2 rounded-md h-7\"\n        on:click={() => {\n          buildUrlAndOpenItInNewTab('eleve')\n        }}\n        text=\"Aperu\"\n      />\n    </div>\n  </div>\n</BasicClassicModal>\n","<svg\n  width=\"92.762665\"\n  height=\"94.176659\"\n  viewBox=\"0 0 24.543455 24.917574\"\n  version=\"1.1\"\n  id=\"svg5\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class={$$props.class}\n  fill=\"currentColor\"\n>\n  <defs id=\"defs2\"></defs>\n  <g id=\"layer1\" transform=\"translate(-0.95743787,-0.77037907)\">\n    <path\n      id=\"path2\"\n      style=\"fill:currentColor;stroke-width:0;stroke-linecap:round;stroke-linejoin:round\"\n      d=\"m 24.068311,13.229166 c 0,0.389031 1.49792,1.780325 1.430365,2.163446 -0.06755,0.38312 -1.950989,1.178191 -2.084046,1.54376 -0.133056,0.365569 0.798677,2.185277 0.604162,2.522188 -0.194515,0.33691 -2.236295,0.439859 -2.486359,0.737874 -0.250065,0.298015 0.0031,2.326652 -0.294913,2.576717 -0.298015,0.250064 -2.251871,-0.351526 -2.588782,-0.15701 -0.33691,0.194515 -0.792847,2.187399 -1.158416,2.320455 -0.365569,0.133057 -1.995838,-1.100511 -2.378958,-1.032956 -0.383121,0.06755 -1.493167,1.784313 -1.882198,1.784313 -0.389031,0 -1.499077,-1.716759 -1.882198,-1.784313 -0.38312,-0.06755 -2.0133888,1.166013 -2.3789581,1.032956 C 8.6024405,24.80354 8.1465042,22.810656 7.8095937,22.616141 7.4726831,22.421625 5.518827,23.023215 5.2208121,22.773151 4.9227972,22.523086 5.1759636,20.494449 4.9258995,20.196434 4.6758353,19.898419 2.6340554,19.79547 2.43954,19.458559 2.2450246,19.121649 3.1767581,17.301941 3.0437017,16.936372 2.9106454,16.570803 1.0272105,15.775732 0.95965602,15.392612 0.89210154,15.009491 2.3900213,13.618197 2.3900213,13.229166 c 0,-0.389031 -1.49791974,-1.780325 -1.43036525,-2.163446 C 1.0272105,10.6826 2.9106454,9.8875295 3.0437017,9.5219602 3.1767581,9.1563909 2.2450247,7.336683 2.43954,6.9997725 2.6340554,6.662862 4.6758353,6.559913 4.9258995,6.2618981 5.1759636,5.9638832 4.9227973,3.9352456 5.2208122,3.6851815 5.518827,3.4351173 7.4726831,4.0367067 7.8095937,3.8421914 8.1465042,3.647676 8.6024406,1.6547922 8.96801,1.5217358 c 0.3655693,-0.1330563 1.995838,1.100511 2.378958,1.0329565 0.383121,-0.067554 1.493167,-1.78431323 1.882198,-1.78431323 0.389031,0 1.499077,1.71675873 1.882198,1.78431323 0.38312,0.067554 2.013389,-1.1660128 2.378958,-1.0329564 0.36557,0.1330563 0.821506,2.1259401 1.158416,2.3204555 0.336911,0.1945154 2.290767,-0.407074 2.588782,-0.1570099 0.298015,0.2500642 0.04485,2.2787018 0.294913,2.5767166 0.250064,0.2980149 2.291844,0.400964 2.486359,0.7378745 0.194515,0.3369105 -0.737218,2.1566183 -0.604162,2.5221876 0.133057,0.3655694 2.016492,1.1606398 2.084046,1.5437598 0.06755,0.383121 -1.430365,1.774415 -1.430365,2.163446 z\"\n    ></path>\n  </g>\n</svg>\n","<script lang=\"ts\">\n  import type { AppTierce } from '../../../lib/types/referentiels'\n  import StarIcon from '../icons/StarIcon.svelte'\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n\n  export let application: AppTierce = {\n    title: 'Titre',\n    presentation: ' blabla',\n    imgPath: 'images/apps/appDefault.png',\n    uuid: 'theUuid',\n  }\n  export let reversed: boolean = false\n  export let selected: boolean = false\n  export let loadImages: boolean = true // Pour viter le chargement des images lorsque la carte n'est pas visible  l'cran\n\n  let listeCodes: string[]\n  // on compte ractivement le nombre d'occurences\n  // de la ressource dans la liste des slectionns\n  $: {\n    listeCodes = []\n    for (const entry of $exercicesParams) {\n      listeCodes.push(entry.uuid)\n    }\n    listeCodes = listeCodes\n  }\n\n  function addAppToList() {\n    exercicesParams.update((list) => [...list, { uuid: application.uuid }])\n  }\n  const isPresent = (code: string) => {\n    return code === application.uuid\n  }\n  function removeAppFromList() {\n    const matchingIndex = listeCodes.findIndex(isPresent)\n    exercicesParams.update((list) => [\n      ...list.slice(0, matchingIndex),\n      ...list.slice(matchingIndex + 1),\n    ])\n  }\n  function handelSelection() {\n    selected = !selected\n    if (selected) {\n      addAppToList()\n    } else {\n      removeAppFromList()\n    }\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"relative block w-full rounded-lg bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark shadow-lg border border-coopmaths-canvas-darkest dark:border-coopmathsdark-canvas-darkest\"\n  on:click={handelSelection}\n>\n  <div class=\"{reversed ? 'hide' : 'block'} \">\n    {#if loadImages}\n      <img\n        src={application.imgPath}\n        alt=\"{application.title} image\"\n        class=\"object-fill rounded-t-lg\"\n      />\n    {:else}\n      <div\n        class=\"h-48 bg-gray-200 rounded-t-lg flex items-center justify-center\"\n      >\n        <span class=\"text-gray-500\">Image  charger...</span>\n      </div>\n    {/if}\n  </div>\n  <div class=\"p-2 text-left\">\n    <h5\n      class=\"mb-2 text-lg font-bold leading-tight text-coopmaths-struct dark:text-coopmathsdark-struct\"\n    >\n      {application.title}\n    </h5>\n    <p\n      class=\"max-h-24 min-h-24 h-24 text-sm text-ellipsis overflow-hidden mb-4 font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus leading-tight\"\n    >\n      {application.presentation}\n    </p>\n  </div>\n  <div class=\"absolute -bottom-4 left-1/2 -translate-x-1/2\">\n    <div\n      class=\"rounded-full h-8 w-8 bg-coopmaths-action text-coopmaths-canvas flex justify-center items-center hover:animate-pulse\"\n    >\n      <i class=\"bx bx-sm {selected ? 'bx-minus' : 'bx-plus'}\"></i>\n    </div>\n  </div>\n  <div class=\"absolute top-3 right-3 rotate-frac\">\n    <div class=\"relative\">\n      <StarIcon\n        class=\"{selected\n          ? 'container'\n          : 'hidden'} top-0 left-0 h-12 w-12 text-coopmaths-warn-800 dark:text-coopmathsdark-warn\"\n      />\n      <i\n        class=\"{selected\n          ? 'container'\n          : 'hidden'} absolute top-1 left-[0.1rem] bx bx-check bx-md text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n      ></i>\n    </div>\n  </div>\n</button>\n\n<style>\n  @-webkit-keyframes rotation {\n    0%,\n    70% {\n      -webkit-transform: rotate(0deg);\n    }\n    80%,\n    100% {\n      -webkit-transform: rotate(360deg);\n    }\n  }\n  @keyframes rotation {\n    0%,\n    70% {\n      transform: rotate(0deg);\n    }\n    80%,\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n  .rotate-frac {\n    -webkit-animation: rotation 4s infinite linear;\n    animation: rotation 4s infinite linear;\n  }\n</style>\n","<script lang=\"ts\">\n  import Card from '../../../shared/ui/Card.svelte'\n  import BasicClassicModal from '../../../shared/modal/BasicClassicModal.svelte'\n  import appsTierce from '../../../../json/referentielAppsTierce.json'\n  import type { AppTierceGroup } from '../../../../lib/types/referentiels'\n\n  export let thirdAppsChoiceModal: BasicClassicModal\n  export let showThirdAppsChoiceDialog: boolean\n  export let appsTierceInExercisesList: string[]\n\n  const appsTierceReferentielArray: AppTierceGroup[] = Object.values(appsTierce)\n</script>\n\n<!-- Fentre de dialogue pour le choix des applications tierces -->\n<BasicClassicModal\n  bind:this={thirdAppsChoiceModal}\n  bind:isDisplayed={showThirdAppsChoiceDialog}\n>\n  <div slot=\"header\">Applications</div>\n  <div slot=\"content\">\n    <div class=\"p2\">\n      {#each appsTierceReferentielArray as group}\n        <div class=\"mx-2 pt-8\">\n          <div class=\"font-bold text-2xl text-coopmaths-struct py-4\">\n            {group.rubrique}\n          </div>\n          <div class=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n            {#each group.liste as app}\n              <Card\n                application={app}\n                selected={appsTierceInExercisesList.includes(app.uuid)}\n                loadImages={showThirdAppsChoiceDialog}\n              />\n            {/each}\n          </div>\n        </div>\n      {/each}\n    </div>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import legacyCarouselContent from '../../../../../json/carouselContent.json'\n  // import carouselContentForCapytale from '../../../../../json/carouselContentForCapytale.json'\n  import ButtonTextAction from '../../../../shared/forms/ButtonTextAction.svelte'\n\n  let currentSlideIndex = 0\n  let intervalId: number | null = null\n  let isPaused = false\n\n  // let carouselContent = $globalOptions.recorder === 'capytale' ? carouselContentForCapytale : legacyCarouselContent\n  let carouselContent = legacyCarouselContent\n\n  // Configuration de l'animation\n  const SLIDE_DURATION = 5000 // 5 secondes par slide\n  const TRANSITION_DURATION = 500 // 500ms pour la transition\n\n  function nextSlide(): void {\n    if (carouselContent.slides && carouselContent.slides.length > 0) {\n      currentSlideIndex =\n        (currentSlideIndex + 1) % carouselContent.slides.length\n      scrollToSlide(currentSlideIndex)\n    }\n  }\n\n  function goToSlide(index: number): void {\n    currentSlideIndex = index\n    scrollToSlide(index)\n  }\n\n  function scrollToSlide(index: number): void {\n    const slideElement = document.getElementById(`carousel-item${index}`)\n    if (slideElement) {\n      slideElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'nearest',\n        inline: 'start',\n      })\n    }\n  }\n\n  function startAutoPlay(): void {\n    if (!intervalId) {\n      intervalId = setInterval(nextSlide, SLIDE_DURATION) as unknown as number\n    }\n  }\n  function stopAutoPlay(): void {\n    if (intervalId) {\n      clearInterval(intervalId)\n      intervalId = null\n    }\n  }\n\n  function togglePause(): void {\n    isPaused = !isPaused\n    if (isPaused) {\n      stopAutoPlay()\n    } else {\n      startAutoPlay()\n    }\n  }\n  // Gestionnaires d'vnements pour pause au survol\n  function handleMouseEnter(): void {\n    stopAutoPlay()\n  }\n\n  function handleMouseLeave(): void {\n    if (!isPaused) {\n      startAutoPlay()\n    }\n  }\n\n  // Gestionnaire de clic sur les indicateurs\n  function handleIndicatorClick(index: number): void {\n    goToSlide(index)\n    // Redmarrer le timer aprs un clic manuel\n    if (!isPaused) {\n      stopAutoPlay()\n      startAutoPlay()\n    }\n  }\n\n  onMount(() => {\n    // Dmarrer l'animation automatique au montage du composant\n    startAutoPlay()\n  })\n\n  onDestroy(() => {\n    // Nettoyer l'intervalle  la destruction du composant\n    stopAutoPlay()\n  })\n</script>\n\n{#if carouselContent.slides && carouselContent.slides.length !== 0}\n  <div class=\"h-[90%]\">\n    <div\n      class=\"carousel w-full h-full cursor-pause-circle flex flex-row flex-nowrap overflow-x-hidden snap-x snap-mandatory\"\n      on:mouseenter={handleMouseEnter}\n      on:mouseleave={handleMouseLeave}\n      role=\"region\"\n      aria-label=\"Caroussel d'images\"\n    >\n      {#each carouselContent.slides as slide, i}\n        <div\n          id=\"carousel-item{i}\"\n          class=\"carousel-item w-full h-full flex justify-center items-center shrink-0 snap-start\"\n          style=\"transition: opacity {TRANSITION_DURATION}ms ease-in-out;\"\n        >\n          <div\n            class=\"flex flex-col justify-center items-center xl:w-4/5 w-11/12 h-full\n          bg-cover bg-no-repeat bg-center\"\n            style=\"background-image: url('images/carousel/{slide.background}');\"\n          >\n            <div\n              class=\"relative w-full h-full\n            {slide.message && slide.message.length !== 0\n                ? (slide.background && slide.background.length !== 0 ? 'bg-coopmaths-canvas/80 dark:bg-coopmathsdark-canvas/80' : 'bg-coopmaths-struct/80 dark:bg-coopmathsdark-struct/80')\n                : ''}\n            {slide.message && slide.message.length === 0 && slide.background && slide.background.length !== 0\n                ? 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'\n                : (slide.message && slide.message.length === 0 ? 'bg-coopmaths-struct dark:bg-coopmathsdark-struct' : '')}\"\n            >\n              <div\n                class=\"w-full h-full xl:p-20 lg:p-10 md:p-6 sm:p-4 p-3 flex flex-col justify-between items-start\"\n              >\n                {#if slide.title && slide.title.length !== 0}\n                  <h1\n                    class=\"w-full h-[20%] flex flex-row justify-start pb-8 font-bold\n             text-xl md:text-2xl lg:text-3xl xl:text-4xl 2xl:text-6xl\n             {slide.background && slide.background.length !== 0\n                      ? 'text-coopmaths-struct dark:text-coopmathsdark-struct'\n                      : 'text-coopmaths-canvas-darkest dark:text-coopmathsdark-canvas-darkest'}\"\n                  >\n                    {slide.title}\n                  </h1>\n                {/if}\n                {#if slide.message && slide.message.length !== 0}\n                  {#if slide.image && slide.image.length !== 0}\n                    <div class=\"flex flex-row w-full h-[80%] gap-4\">\n                      <div\n                        class=\"w-full lg:w-1/2 h-full flex justify-start items-center\n                        overflow-hidden text-ellipsis\n                 px-4 sm:px-6 md:px-8 lg:px-10 font-light\n                 text-lg sm:text-xl md:text-2xl lg:text-xl xl:text-2xl 2xl:text-4xl\n                 {slide.background && slide.background.length !== 0\n                          ? 'text-coopmaths-corpus dark:text-coopmathsdark-corpus'\n                          : 'text-coopmaths-canvas dark:text-coopmathsdark-canvas'}\"\n                      >\n                        {slide.message}\n                      </div>\n                      <div\n                        class=\"hidden lg:flex lg:w-1/2 flex-1 justify-center items-center\"\n                      >\n                        <!-- Support for both images and videos -->\n                        {#if slide.image.endsWith('.mp4')}\n                          <video\n                            class=\"flex items-center justify-center w-full h-full object-scale-down\"\n                            src=\"images/carousel/{slide.image}\"\n                            autoplay\n                            loop\n                            muted\n                            playsinline\n                          ></video>\n                        {:else}\n                          <img\n                            class=\"flex items-center justify-center w-full h-full object-scale-down\"\n                            src=\"images/carousel/{slide.image}\"\n                            alt=\"Image:{slide.image}\"\n                          />\n                        {/if}\n                      </div>\n                    </div>\n                  {:else}\n                    <div\n                      class=\"w-full h-[80%] flex justify-start items-center\n                      overflow-hidden text-ellipsis\n               px-4 sm:px-6 md:px-8 lg:px-10 font-light\n               text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl\n               {slide.background && slide.background.length !== 0\n                        ? 'text-coopmaths-corpus dark:text-coopmathsdark-corpus'\n                        : 'text-coopmaths-canvas dark:text-coopmathsdark-canvas'}\"\n                    >\n                      {slide.message}\n                    </div>\n                  {/if}\n                {/if}\n              </div>\n              {#if slide.link && slide.link.length !== 0}\n                <div class=\"absolute bottom-6 right-6\">\n                  <ButtonTextAction\n                    text={slide.buttonTitle && slide.buttonTitle.length !== 0\n                      ? slide.buttonTitle\n                      : 'En savoir plus'}\n                    class=\"inline-flex items-center py-1 px-3 rounded-md font-normal\"\n                    on:click={() => {\n                      const w = window.open(\n                        slide.link || 'https://coopmaths.fr/alea/',\n                        '_blank',\n                      )\n                      if (w) {\n                        w.focus()\n                      }\n                    }}\n                  />\n                </div>\n              {/if}\n            </div>\n          </div>\n        </div>\n      {/each}\n    </div>\n    <div class=\"flex w-full justify-center gap-2 py-2\">\n      {#each carouselContent.slides as slide, i}\n        <button\n          class=\"btn btn-xs border-0 px-2 py-1 rounded-lg text-xs\n            {i === currentSlideIndex\n            ? 'bg-coopmaths-light text-coopmaths-canvas dark:bg-coopmathsdark-action dark:text-coopmathsdark-canvas-dark'\n            : 'bg-coopmaths-canvas-darkest text-coopmaths dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-action'} font-light transition-all duration-200\"\n          on:click={() => handleIndicatorClick(i)}\n          aria-label=\"Aller au slide {i + 1}\"\n        >\n          {i + 1}\n        </button>\n      {/each}\n    </div>\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import { getLang } from '../../../../lib/stores/languagesStore'\n  import Footer from '../../../Footer.svelte'\n  import Carousel from './carousel/Carousel.svelte'\n\n  export let text: string\n  const lang = getLang()\n</script>\n\n<div class=\"relative flex-1 h-full\">\n  <div\n    class=\"flex flex-col justify-between h-full text-coopmaths-corpus dark:text-coopmathsdark-corpus md:px-10 py-6\"\n  >\n    <!-- <div class=\"bg-coopmaths-canvas\">\n      <span class=\"text-coopmaths-canvas\">&nbsp;</span>  <- Dcommenter si pas d'Advertising\n    </div> -->\n    <!-- <Advertising /> -->\n    {#if lang === 'fr-FR'}\n      <div class=\"md:block md:h-full hidden\">\n        <Carousel />\n      </div>\n    {/if}\n    <div\n      class=\"animate-pulse flex flex-col md:flex-row justify-start space-x-6 items-center {lang !==\n      'fr-FR'\n        ? 'mt-32 md:mt-40'\n        : ''}\"\n    >\n      <div class=\"mt-[10px]\">\n        <div class=\"hidden md:inline-flex\">\n          <i class=\"bx bx-chevron-left text-[50px]\"></i>\n        </div>\n        <div class=\"inline-flex md:hidden\">\n          <i class=\"bx bx-chevron-up text-[50px]\"></i>\n        </div>\n      </div>\n      <div class=\"font-extralight text-[50px]\">\n        {text}\n      </div>\n    </div>\n    <div class=\"invisible sm:visible flex items-center justify-center\">\n      <Footer />\n    </div>\n  </div>\n</div>\n","/**\n * En thorie, indique si moins d'un mois s'est coul depuis la date passe\n * en paramtre et aujourd'hui.\n * /!\\ ATTENTION : En ralit, la fonction est bancale car elle prsuppose une type de chane pour dsigner la date : YYYY/MM/DD\n * On lui prfrera `isLessThanAMonth` de `lib\\types\\dates.ts`\n * @param dateString chaine reprsentant la date\n * @returns `true` si aujourd'hui - date < un mois\n */\nexport function isRecent(dateString: string) {\n  if (dateString === undefined) return false\n  const [jour, mois, annee] = dateString.split('/').map((s) => parseInt(s))\n  const date = new Date(annee, mois - 1, jour)\n  const elapsedTime = Date.now() - date.getTime()\n  const unMois = 3600 * 24 * 30 * 1000\n  return elapsedTime < unMois\n}\n\nexport const monthes = [\n  'Janvier',\n  'Fvrier',\n  'Mars',\n  'Avril',\n  'Mai',\n  'Juin',\n  'Juillet',\n  'Aot',\n  'Septembre',\n  'Octobre',\n  'Novembre',\n  'Dcembre',\n]\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  viewBox=\"0 0 8.467 8.467\"\n  class={$$props.class}\n>\n  <defs>\n    <marker\n      id=\"a\"\n      markerHeight=\"2\"\n      markerWidth=\"2\"\n      orient=\"auto-start-reverse\"\n      preserveAspectRatio=\"xMidYMid\"\n      refX=\"0\"\n      refY=\"0\"\n      style=\"overflow:visible\"\n      viewBox=\"0 0 5.324 6.155\"\n    >\n      <path\n        d=\"m5.77 0-8.65 5V-5Z\"\n        style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n        transform=\"scale(.5)\"\n      ></path>\n    </marker>\n    <marker\n      id=\"b\"\n      markerHeight=\"2\"\n      markerWidth=\"2\"\n      orient=\"auto-start-reverse\"\n      preserveAspectRatio=\"xMidYMid\"\n      refX=\"0\"\n      refY=\"0\"\n      style=\"overflow:visible\"\n      viewBox=\"0 0 5.324 6.155\"\n    >\n      <path\n        d=\"m5.77 0-8.65 5V-5Z\"\n        style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n        transform=\"scale(.5)\"\n      ></path>\n    </marker>\n  </defs>\n  <g transform=\"matrix(.87062 0 0 .87062 .723 1.111)\">\n    <path\n      d=\"M6.117 4.022a2.086 2.086 0 0 0-2.084 2.083c0 1.15.935 2.084 2.084 2.084A2.086 2.086 0 0 0 8.2 6.105a2.086 2.086 0 0 0-2.083-2.083zm0 3.75a1.669 1.669 0 0 1-1.52-2.35l.096.058c.082.052.164.104.268.143.103.04.226.065.391.065s.289-.026.392-.065c.103-.039.186-.09.268-.143.083-.052.165-.104.268-.143.103-.04.227-.065.392-.065s.289.026.392.065c.103.039.185.091.268.143.082.052.165.104.268.143.037.014.078.026.121.036.04.142.063.291.063.446 0 .92-.748 1.667-1.667 1.667z\"\n      style=\"stroke-width:.208363\"\n    ></path>\n    <circle cx=\"5.388\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n    ></circle>\n    <circle cx=\"6.846\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n    ></circle>\n  </g>\n  <path\n    d=\"M1.062.56h3.08a.474.474 0 0 1 .474.474v2.37a.474.474 0 0 1-.474.473h-3.08a.474.474 0 0 1-.474-.474v-2.37A.474.474 0 0 1 1.062.56Z\"\n    style=\"fill:none;stroke-width:.236966;stroke-linecap:round;stroke-linejoin:round\"\n  ></path>\n  <path\n    d=\"M.773.536.536.752v.432h4.029V.752L4.327.536Zm1.948.141h1.421a.118.118 0 0 1 .12.12.118.118 0 0 1-.12.12H2.721a.118.118 0 0 1-.12-.12.118.118 0 0 1 .12-.12ZM1.019.68a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .01 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.119.118.118.118 0 0 1-.118-.118.118.118 0 0 1 .11-.118z\"\n    style=\"stroke:none;stroke-width:.226291px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n  ></path>\n  <path\n    d=\"M7.062 3.945V1.536h-1.21\"\n    style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#a)\"\n  ></path>\n  <path\n    d=\"M1.589 4.668v2.41h1.208\"\n    style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#b)\"\n  ></path>\n  <path\n    d=\"m.53.53 7.407 7.407\"\n    style=\"fill:none;stroke-width:.79375;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1\"\n  ></path>\n</svg>\n","<script lang=\"ts\">\n  import katex from 'katex'\n  import { onDestroy, tick } from 'svelte'\n  import {\n    isExerciceItemInReferentiel,\n    isGeoDynamic,\n    isTool,\n    resourceHasMonth,\n    resourceHasPlace,\n    type JSONReferentielEnding,\n  } from '../../../../../../lib/types/referentiels'\n  // eslint-disable-next-line no-unused-vars, @typescript-eslint/no-unused-vars\n  import { mathaleaGenerateSeed } from '../../../../../../lib/mathalea'\n  import {\n    changes,\n    exercicesParams,\n  } from '../../../../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../../../../lib/stores/globalOptions'\n  import type { InterfaceParams } from '../../../../../../lib/types'\n  import { isLessThan1Month } from '../../../../../../lib/types/dates'\n  import NoInteractivityIcon from '../../../../../shared/icons/NoInteractivityIcon.svelte'\n  import QcmCamIcon from '../../../../../shared/icons/QcmCamIcon.svelte'\n\n  export let ending: JSONReferentielEnding\n  export let nestedLevelCount: number\n\n  let nomDeExercice: HTMLDivElement\n  let selectedCount: number\n  /* --------------------------------------------------------------\n    Gestions des exercices via la liste\n   --------------------------------------------------------------- */\n  /**\n   * Compare un code  UUID courante\n   * @param {string} code le code de l'UUID  comparer  l'UUID courante\n   * @returns {boolean} `true` si les deux chanes sont gales\n   */\n  const compareCodes = (code: string): boolean => {\n    return code === ending.uuid\n  }\n  /**\n   * Compte le nombre de fois o la ressource a t slectionne\n   * @returns {number} nb d'occurences\n   */\n  const countOccurences = (): number => {\n    return $exercicesParams.map((item) => item.uuid).filter(compareCodes).length\n  }\n  // on compte ractivement le nombre d'occurences\n  // de l'exercice dans la liste des slectionns\n  const unsubscribeToExerciceParams = exercicesParams.subscribe(() => {\n    tick().then(() => {\n      selectedCount = countOccurences()\n    })\n  })\n\n  let endingTitre = ''\n\n  $: {\n    if (isExerciceItemInReferentiel(ending)) {\n      endingTitre = ending.titre\n      if (endingTitre.includes('$')) {\n        const regexp = /(['$])(.*?)\\1/g\n        const matchs = endingTitre.match(regexp)\n        matchs?.forEach((match) => {\n          endingTitre = endingTitre.replace(\n            match,\n            katex.renderToString(match.replaceAll('$', '')),\n          )\n        })\n      }\n    }\n    selectedCount = countOccurences()\n  }\n\n  onDestroy(unsubscribeToExerciceParams)\n\n  /**\n   * Ajouter l'exercice courant  la liste\n   */\n  function addToList() {\n    const newExercise = {\n      uuid: ending.uuid,\n      alea: mathaleaGenerateSeed(),\n      interactif: isGeoDynamic(ending) ? '1' : '0',\n    } as InterfaceParams\n    if (isExerciceItemInReferentiel(ending) || isTool(ending)) {\n      newExercise.id = ending.id\n    }\n    if (\n      $globalOptions.recorder === 'capytale' ||\n      $globalOptions.setInteractive === '1'\n    ) {\n      newExercise.interactif = '1'\n    }\n    exercicesParams.update((list) => [...list, newExercise])\n    $changes++\n  }\n  /**\n   * Retirer l'exercice de la liste (si plusieurs occurences\n   * la premire est retire)\n   */\n  function removeFromList() {\n    const matchingIndex = $exercicesParams\n      .map((item) => item.uuid)\n      .findIndex(compareCodes)\n    exercicesParams.update((list) => [\n      ...list.slice(0, matchingIndex),\n      ...list.slice(matchingIndex + 1),\n    ])\n    $changes--\n  }\n</script>\n\n<!--\n  @component\n  Composant destin  afficher les terminaisons des branches d'un rfrentiel.\n\n  #### Paramtres\n  **ending** (_JSONReferentielEnding_) : l'objet reprsentant la terminaison\n  **nestedLevelCount** (_number_) : compteur du niveau d'imbrication (utilis pour la mise en page)\n -->\n<div\n  class={`${$$props.class || ''} w-full flex flex-row mr-4 text-start items-start text-sm text-coopmaths-corpus dark:text-coopmathsdark-corpus bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark`}\n  style=\"padding-left: {(nestedLevelCount * 2) / 6}rem\"\n>\n  <div\n    class={`w-full relative inline-flex text-start justify-start items-start hover:bg-coopmaths-action-light dark:hover:bg-coopmathsdark-action-light dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest ${selectedCount >= 1 ? 'bg-coopmaths-warn dark:bg-coopmathsdark-warn' : 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest'} cursor-pointer`}\n  >\n    <button\n      type=\"button\"\n      on:click={addToList}\n      class=\"ml-[3px] pl-2 pr-4 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark hover:bg-coopmaths-canvas dark:hover:bg-coopmathsdark-canvas-darkest flex-1\"\n    >\n      <div bind:this={nomDeExercice} class=\"flex flex-row justify-start\">\n        {#if isExerciceItemInReferentiel(ending)}\n          <!-- Exercice MathALA -->\n          <div\n            class=\"text-start text-coopmaths-corpus dark:text-coopmathsdark-corpus bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark hover:bg-coopmaths-canvas dark:hover:bg-coopmathsdark-canvas-darkest\"\n          >\n            <span class=\"font-bold\">{ending.id} - </span>\n            {@html endingTitre}\n            {#if isLessThan1Month(ending.datePublication)}\n              &nbsp;\n              <span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip={ending.datePublication}\n              >\n                <span\n                  class=\"inline-flex flex-wrap items-center justify-center rounded-full bg-coopmaths-warn-dark dark:bg-coopmathsdark-warn-dark text-coopmaths-canvas dark:text-coopmathsdark-canvas text-[0.6rem] px-2 ml-2 font-semibold leading-normal\"\n                >\n                  NEW\n                </span>\n              </span>\n            {/if}\n            {#if isLessThan1Month(ending.dateModification)}\n              &nbsp;\n              <span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip={ending.dateModification}\n              >\n                <span\n                  class=\"tooltip tooltip-bottom tooltip-neutral\n                  inline-flex flex-wrap items-center justify-center rounded-full bg-coopmaths-struct-light dark:bg-coopmathsdark-struct-light text-coopmaths-canvas dark:text-coopmathsdark-canvas text-[0.6rem] px-2 ml-2 font-semibold leading-normal\"\n                >\n                  MAJ\n                </span>\n              </span>\n            {/if}\n            {#if ending.features.qcmcam}\n              &nbsp;\n              <span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip=\"Export QCM Cam Disponible\"\n              >\n                <QcmCamIcon\n                  class=\"inline-flex h-3 w-3 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark fill-coopmaths-warn-dark dark:fill-coopmathsdark-warn-dark stroke-coopmaths-warn-dark dark:stroke-coopmathsdark-warn-dark\"\n                />\n              </span>\n            {/if}\n            {#if !ending.features.interactif?.isActive}\n              &nbsp;<span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip=\"Pas d'interactivit\"\n              >\n                <NoInteractivityIcon\n                  class=\"inline-flex h-3 w-3 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark fill-coopmaths-warn-dark dark:fill-coopmathsdark-warn-dark stroke-coopmaths-warn-dark dark:stroke-coopmathsdark-warn-dark\"\n                />\n              </span>\n            {/if}\n          </div>\n        {:else if resourceHasPlace(ending)}\n          <!-- Exercices d'annales -->\n          <div class=\"text-start\">\n            <span class=\"font-bold\">\n              {ending.typeExercice.toUpperCase()}\n              {#if resourceHasMonth(ending)}\n                {ending.mois}\n              {/if}\n              {ending.annee}\n              {ending.lieu}\n              {#if ending.jour !== undefined}\n                [{ending.jour === 'J1' ? 'Sujet 1' : 'Sujet 2'}]\n              {/if}\n              - {ending.numeroInitial}\n            </span>\n            <div class=\"pl-2\">\n              {#each ending.tags as tag}\n                <span\n                  class=\"inline-flex flex-wrap items-center justify-center rounded-full bg-coopmaths-struct-light dark:bg-coopmathsdark-struct-light text-coopmaths-canvas dark:text-coopmathsdark-canvas text-[0.6rem] px-2 py-px leading-snug font-semibold mr-1\"\n                >\n                  {tag}\n                </span>\n              {/each}\n            </div>\n          </div>\n        {:else if isTool(ending)}\n          <!-- Outils -->\n          <div\n            class=\"text-start text-coopmaths-corpus dark:text-coopmathsdark-corpus bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark hover:bg-coopmaths-canvas dark:hover:bg-coopmathsdark-canvas-darkest\"\n          >\n            <span class=\"font-bold\">{ending.id} - </span>{ending.titre}\n          </div>\n        {:else}\n          <!-- Exercice de la bibliothque -->\n          <div\n            class=\"text-start text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <span class=\"font-bold\">{ending.uuid}</span>\n          </div>\n        {/if}\n      </div>\n    </button>\n\n    <!-- Bouton en dbut de ligne pour visualiser si l'exo est slectionn,\n        combien de fois et pour ventuellement le retirer de la slection -->\n    {#if selectedCount >= 1}\n      <button\n        type=\"button\"\n        class=\"absolute -left-4 top-1/2 transform -translate-y-1/2 group\"\n        on:click={removeFromList}\n        on:keydown={removeFromList}\n        aria-label=\"Retirer de la slection\"\n      >\n        <div class=\"relative\">\n          <i\n            class=\"text-base bx bxs-message-alt -rotate-90\n            text-coopmaths-action-light dark:text-coopmathsdark-action-light\n            opacity-100 group-hover:opacity-0 transition-opacity\"\n          ></i>\n          <i\n            class=\"text-base bx bx-trash\n            absolute top-0 -left-0.5\n            text-coopmaths-action-light dark:text-coopmathsdark-action-light\n            opacity-0 group-hover:opacity-100 transition-opacity\"\n          ></i>\n        </div>\n        {#if selectedCount >= 2}\n          <div\n            class=\"absolute left-1 top-0.5 text-[0.6rem] font-bold\n            text-coopmaths-canvas dark:text-coopmathsdark-canvas-dark\n            group-hover:hidden\"\n          >\n            {selectedCount}\n          </div>\n        {/if}\n      </button>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import katex from 'katex'\n  import { onMount } from 'svelte'\n  import { slide } from 'svelte/transition'\n  import codeToLevelList from '../../../../../../json/codeToLevelList.json'\n  import themesList from '../../../../../../json/levelsThemesList.json'\n  import themesListCH from '../../../../../../json/levelsThemesListCH.json'\n  import { monthes } from '../../../../../../lib/components/handleDate'\n  import { codeToLevelTitle } from '../../../../../../lib/components/refUtils'\n  import { toMap } from '../../../../../../lib/components/toMap'\n  import {\n    bibliothequeDisplayedContent,\n    exercicesParams,\n  } from '../../../../../../lib/stores/generalStore'\n  import {\n    isExamItemInReferentiel,\n    isJSONReferentielEnding,\n    type JSONReferentielObject,\n  } from '../../../../../../lib/types/referentiels'\n  import ReferentielEnding from './ReferentielEnding.svelte'\n\n  const themes = toMap(themesList)\n  const themesCH = toMap(themesListCH)\n\n  export let subset: JSONReferentielObject\n  export let unfold: boolean = false\n  export let nestedLevelCount: number\n  export let indexBase: number\n  export let levelTitle: string\n  export let pathToThisNode: string[]\n  $: items = prepareSubset(subset)\n  const levels = Object.keys(codeToLevelList)\n\n  /**\n   * Recherche dans la liste des thmes si le thme est rfrenc\n   * et si oui, renvoie son intitul\n   * @param {string} themeCode code du thme\n   * @return {string} intitul du thme\n   * @author Sylvain Chambon & Rmi Angot\n   */\n  function themeTitle(themeCode: string) {\n    let title = ''\n    if (themes.has(themeCode)) {\n      title = [\n        themeCodeisSubthemeCode(\n          levelTitle,\n          Array.from(levelTitle.replace('auto', ''))[0],\n        )\n          ? ''\n          : ' : ',\n        themes.get(themeCode).get('titre'),\n      ].join('')\n    } else if (themesCH.has(themeCode)) {\n      title = [\n        themeCodeisSubthemeCode(\n          levelTitle,\n          Array.from(levelTitle.replace('auto', ''))[0],\n        )\n          ? ''\n          : ' : ',\n        themesCH.get(themeCode).get('titre'),\n      ].join('')\n    } else {\n      title = ''\n    }\n    if (title.includes('$')) {\n      const regexp = /(['$])(.*?)\\1/g\n      const matchs = title.match(regexp)\n      matchs?.forEach((match) => {\n        title = title.replace(\n          match,\n          katex.renderToString(match.replaceAll('$', '')),\n        )\n      })\n    }\n    return title\n  }\n\n  /**\n   * Teste si le code du niveau correspond  un sous-thme :\n   * sur la base de la syntaxe adopte pour les codes des thmes\n   * ( savoir :  <NB><LETTRE><NOMBRE> ou auto<NB><LETTRE><NOMBRE>),\n   * la fonction confronte le code  tester  une expression rgulire afin de savoir si\n   * une lettre suit le code de trois caractres.\n   * @param {string} themeCode code du niveau\n   * @param {string} level? niveau optionnel (6 par dfaut)\n   * @author Sylvain Chambon\n   */\n  function themeCodeisSubthemeCode(\n    themeCode: string,\n    level: string = '6',\n  ): boolean {\n    const regexp = new RegExp(`^(auto)?${level}[A-Z]\\\\d+[A-Z0-9]$`, 'g')\n    const regexp3Auto = new RegExp(`^(3Auto)?[A-Z]\\\\d+[A-Z0-9]$`, `g`)\n    const regexp1Auto = new RegExp(`^1A-[A-Z]\\\\d{1,2}$`, `g`)\n    return (\n      regexp.test(themeCode) ||\n      regexp3Auto.test(themeCode) ||\n      regexp1Auto.test(themeCode)\n    )\n  }\n\n  /**\n   * Ordonne les entres d'un sous-menu  l'envers lorsque son titre contient le mot `anne`\n   * afin de commencer par l'anne la plus rcente\n   */\n  function prepareSubset(s: JSONReferentielObject) {\n    // console.log('======= referentiel before preparation ====')\n    // console.log(pathToThisNode.join('/'))\n    // console.log(Object.entries(s))\n    if (pathToThisNode.length !== 0) {\n      // console.log('object in prepareSubset (pathToThisNode): ')\n      // console.log(pathToThisNode)\n      // console.log(s)\n      // classement entres CAN\n      if (pathToThisNode[pathToThisNode.length - 1].includes('CAN')) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return levels.indexOf(keyA) - levels.indexOf(keyB)\n        })\n      }\n      // classement des entres par annes dcroissantes\n      const key = pathToThisNode[\n        pathToThisNode.length - 1\n      ] as keyof typeof codeToLevelList\n      if (codeToLevelList[key]?.includes('anne')) {\n        return Object.entries(s).reverse()\n      }\n      // classement des entres par annes dcroissantes\n      if (pathToThisNode[pathToThisNode.length - 1].includes('anne')) {\n        return Object.entries(s).reverse()\n      }\n\n      // classement des thmes dans l'ordre alphabtique\n      const key2 = pathToThisNode[\n        pathToThisNode.length - 1\n      ] as keyof typeof codeToLevelList\n      if (codeToLevelList[key2]?.includes('thme')) {\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n      }\n\n      // classement des thmes dans l'ordre alphabtique\n      if (pathToThisNode[pathToThisNode.length - 1].includes('Tags')) {\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n      }\n\n      // classement des thmes dans l'ordre alphabtique\n      if (pathToThisNode[pathToThisNode.length - 1].includes('Tags')) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const e = Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n\n        // console.log('======= referentiel after (theme) ====')\n        // console.log(e)\n        return e\n      }\n      // classement des entres par annes : sujets 1 et 2\n      const regExpForExactlyFourDigits = /^\\d{4}$/gm\n      if (\n        regExpForExactlyFourDigits.test(\n          pathToThisNode[pathToThisNode.length - 1],\n        )\n      ) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          if (\n            isExamItemInReferentiel(valueA) &&\n            isExamItemInReferentiel(valueB) &&\n            valueA.jour &&\n            valueB.jour\n          ) {\n            const jourA = parseInt(valueA.jour.replace('J', ''))\n            const jourB = parseInt(valueB.jour.replace('J', ''))\n            const moisA = monthes.indexOf(valueA.mois ?? '')\n            const moisB = monthes.indexOf(valueB.mois ?? '')\n            return (\n              moisB - moisA ||\n              valueA.lieu.localeCompare(valueB.lieu) ||\n              jourA - jourB\n            )\n          } else {\n            return 0\n          }\n        })\n      }\n      return Object.entries(s)\n    } else {\n      // classement dans l'ordre alphabtique\n      if (\n        'Gomtrie dynamique' === levelTitle ||\n        'Vos ressources' === levelTitle\n      ) {\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n      }\n      return Object.entries(s)\n    }\n  }\n\n  /**\n   * Gestion la bibliothque de statiques\n   */\n  let bibliothequeUuidInExercisesList: string[]\n  $: {\n    bibliothequeUuidInExercisesList = []\n    const uuidList: string[] = []\n    for (const entry of $exercicesParams) {\n      uuidList.push(entry.uuid)\n    }\n    if ($bibliothequeDisplayedContent) {\n      for (const item of Object.values($bibliothequeDisplayedContent)) {\n        if (isJSONReferentielEnding(item) && uuidList.includes(item.uuid)) {\n          bibliothequeUuidInExercisesList.push(item.uuid)\n        }\n      }\n    }\n    bibliothequeUuidInExercisesList = bibliothequeUuidInExercisesList\n  }\n\n  onMount(() => {\n    //   console.log('******** subset ********')\n    //   console.log(Object.entries(subset))\n    // console.log('levelTitle: ', levelTitle)\n    if (\n      (nestedLevelCount === 1 && levelTitle === 'Exercices alatoires') ||\n      themeCodeisSubthemeCode(\n        levelTitle,\n        Array.from(levelTitle.replace('auto', ''))[0],\n      )\n    ) {\n      unfold = true\n    }\n  })\n</script>\n\n<!--\n  @component\n  Composant destin  afficher la liste des entres d'un rfrentiel  un niveau N.\n  On affiche le titre du niveau N et un clic sur ce titre dploie la liste des entres\n  du niveau N+1. Lorsque N=1, on considre que c'est un titre de section et le format est diffrent.\n\n  #### Remarque\n  Le composant s'appelle lui-mme afin d'assurer rcursivement le parcours entier du rfrentiel.\n  On dtecte si l'objet pass en paramtre est du type `JSONReferentielEnding` pour s'arrter.\n  Dans ce cas, le composant `ReferentielEnding.svelte` est appel.\n\n  #### Paramtres\n  - **subset** (_JSONReferentielObject_) : la branche du rfrentiel  afficher.\n  - **unfold** (_boolean_) : flag pour savoir si le niveau courant est dploy ou pas.\n  - **nestedLevelCount** (_number_) : compteur pour connatre le nombre d'imbrication (utilis pour la mise en page).\n  - **indexBase** (_number_) : nombre utilis pour identifier les lments HTML.\n  - **levelTitle** (_string_) : titre du niveau courant (cl du nud retraduite sur la base des fichiers `levelsThemesList.json` et `codeToLevelList.json`).\n\n -->\n<div class={`${$$props.class || ''}`}>\n  <button\n    id={'titre-liste-' + indexBase}\n    type=\"button\"\n    disabled={Object.keys(subset).length === 0}\n    class=\"w-full flex flex-row text-start items-center justify-between font-bold first-letter:first-linemarker\n    {nestedLevelCount !== 1\n      ? 'text-coopmaths-action dark:text-coopmathsdark-action hover:bg-coopmaths-canvas-darkest dark:hover:bg-coopmathsdark-canvas-darkest'\n      : 'text-coopmaths-struct dark:text-coopmathsdark-struct py-2'}\n    {unfold &&\n    nestedLevelCount !== 1 &&\n    !themeCodeisSubthemeCode(\n      levelTitle,\n      Array.from(levelTitle.replace('auto', ''))[0],\n    )\n      ? 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest'\n      : 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'}\n    {Object.keys(subset).length === 0\n      ? 'opacity-10'\n      : 'opacity-100 cursor-pointer'}\"\n    style=\"padding-left: {(nestedLevelCount * 2) / 5}rem\"\n    on:click={() => {\n      unfold = !unfold\n    }}\n  >\n    <div\n      id={'titre-liste-' + indexBase + '-content'}\n      class=\" {nestedLevelCount === 1\n        ? 'text-xl'\n        : themeCodeisSubthemeCode(\n              levelTitle,\n              Array.from(levelTitle.replace('auto', ''))[0],\n            )\n          ? 'text-base leading-none py-2'\n          : 'text-base'}\"\n    >\n      <!-- on va chercher dans les fichiers JSON les significations des cls passes comme titre -->\n      {#if !themeCodeisSubthemeCode(levelTitle, Array.from(levelTitle.replace('auto', ''))[0])}\n        {codeToLevelTitle(levelTitle)}\n      {/if}\n      <span\n        class={themeCodeisSubthemeCode(\n          levelTitle,\n          Array.from(levelTitle.replace('auto', ''))[0],\n        )\n          ? 'font-normal text-sm leading-[80%]'\n          : 'font-normal '}>{@html themeTitle(levelTitle)}</span\n      >\n    </div>\n    <div>\n      <!-- Suivant que c'est le premier niveau (nestedLevelCount = 1) ou pas, on a un affichage diffrent :\n      le premier niveau correspond au tritre du rfrentiel -->\n      {#if nestedLevelCount !== 1}\n        <i\n          class=\" flex text-xl bg-transparent transition-transform duration-500 ease-in-out\n        {unfold && nestedLevelCount !== 1\n            ? 'bx bx-plus rotate-[225deg]'\n            : 'bx bx-plus'}\"\n        ></i>\n      {/if}\n\n      {#if nestedLevelCount === 1}\n        <i\n          class=\"flex text-sm text-coopmaths-action dark:text-coopmathsdark-action bg-transparent transition-transform duration-500 ease-in-out\n        {unfold ? 'bx bxs-up-arrow' : 'bx bxs-up-arrow rotate-[180deg]'}\"\n        ></i>\n      {/if}\n    </div>\n  </button>\n  <div>\n    {#if unfold}\n      <ul transition:slide|global={{ duration: 500 }}>\n        {#each items as [key, obj], i}\n          <li>\n            {#if isJSONReferentielEnding(obj)}\n              <ReferentielEnding\n                ending={obj}\n                nestedLevelCount={nestedLevelCount + 1}\n                class={i === items.length - 1 ? 'pb-1' : ''}\n              />\n            {:else}\n              <svelte:self\n                indexBase={`${indexBase}-${i.toString()}`}\n                levelTitle={key}\n                nestedLevelCount={nestedLevelCount + 1}\n                pathToThisNode={[...pathToThisNode, key]}\n                bind:subset={obj}\n              />\n            {/if}\n          </li>\n        {/each}\n      </ul>\n    {/if}\n  </div>\n</div>\n","/**\n * Dbarrasse une chane de ses caractres accentus en les remplaant\n * par des caractres sans accent\n * @see https://www.equinode.com/fonctions-javascript/retirer-les-accents-avec-javascript\n * @example\n * // returns `'Thales eleve ca peche a noel'`\n * texte=\"Thals lve a pche  nol\"\n * stringWithNoAccent(texte) // returns `'Thales eleve ca peche a noel'`\n * @param a chane  traiter\n * @returns chane dbarasse de ses accents\n */\nexport function stringWithNoAccent(a: string): string {\n  return a.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '')\n}\n","// inspiration : https://blog.susomejias.dev/blog/design-pattern-criteria\n\nimport { MONTHS, YEARS } from '../types/dates'\nimport {\n  isExerciceItemInReferentiel,\n  type ResourceAndItsPath,\n  type Level,\n  resourceHasPlace,\n  isLevelType,\n  isTool,\n  isStaticType,\n  EXAMS,\n  isExamItemInReferentiel,\n  resourceHasMonth,\n} from '../types/referentiels'\nimport { stringWithNoAccent } from './textUtils'\n\n/**\n * Dfinition d'un critre.\n *\n * ### Intention\n *\n * Un critre est essentiellement dfini par la dclaration d'une fonction `meetCriterion`\n * qui prend une liste (typiquement un rfrentiel) et renvoie la liste passe au crible\n * dfinit dans `meetCriterion`.\n */\nexport interface Criterion<T> {\n  meetCriterion(items: T[]): T[]\n}\n\n/**\n * Dfinition un critre multiple bas sur l'intersection de plusieurs critres\n *\n * ### Intention\n *\n * Tous les critres (stocks dans une variable prive)\n * doivent tre vrifis en mme temps.\n *\n * @function addCriterion ajouter un critre (ou un tableau de critres)  la liste\n */\nexport class MultiCriteria<T> implements Criterion<T> {\n  private criteriaList: Criterion<T>[] = []\n\n  addCriterion(criterion: Criterion<T> | Criterion<T>[]): MultiCriteria<T> {\n    if (Array.isArray(criterion)) {\n      for (const item of criterion) {\n        this.criteriaList.push(item)\n      }\n    } else {\n      this.criteriaList.push(criterion)\n    }\n    return this\n  }\n\n  meetCriterion(items: T[]): T[] {\n    let result: T[] = items\n    for (const criterion of this.criteriaList) {\n      result = criterion.meetCriterion(result)\n    }\n    return result\n  }\n}\n\n/**\n * Dfinition d'un critre bas sur l'union de deux autres\n *\n * ### Intention\n *\n * Le critre contrle si l'un ou l'autre des deux critres passs en paramtres\n * est vrifi.\n */\nexport class OrCriteria<T> implements Criterion<T> {\n  private firstCriterion: Criterion<T>\n  private secondCriterion: Criterion<T>\n  constructor(firstCriterion: Criterion<T>, secondCriterion: Criterion<T>) {\n    this.firstCriterion = firstCriterion\n    this.secondCriterion = secondCriterion\n  }\n\n  meetCriterion(items: T[]): T[] {\n    const firstResult = this.firstCriterion.meetCriterion(items)\n    const secondResult = this.secondCriterion.meetCriterion(items)\n    return Array.from(new Set([...firstResult, ...secondResult]))\n  }\n}\n\n/**\n * Dfinition d'un critre multiple bas sur l'union de tous les critres\n *\n * ### Intention\n *\n * Ce critre sera vrifi si l'un au moins des critres\n * (stocks dans une variable prive) est vrifi.\n *\n * @function addCriterion ajouter un critre (ou un tableau de critres)  la liste\n */\nexport class AtLeastOneOfCriteria<T> implements Criterion<T> {\n  private criteriaList: [Criterion<T>, Criterion<T>, ...Criterion<T>[]]\n  // au moins deux critres sont demands par le constructeur\n  constructor(criteriaList: [Criterion<T>, Criterion<T>, ...Criterion<T>[]]) {\n    this.criteriaList = [...criteriaList]\n  }\n\n  addCriterion(\n    criterion: Criterion<T> | Criterion<T>[],\n  ): AtLeastOneOfCriteria<T> {\n    if (Array.isArray(criterion)) {\n      for (const item of criterion) {\n        this.criteriaList.push(item)\n      }\n    } else {\n      this.criteriaList.push(criterion)\n    }\n    return this\n  }\n\n  meetCriterion(items: T[]): T[] {\n    const [firstCriterion, secondCriterion, ...list] = [...this.criteriaList]\n    let resultCriterion = new OrCriteria<T>(firstCriterion, secondCriterion)\n    for (const criterion of list) {\n      resultCriterion = new OrCriteria<T>(resultCriterion, criterion)\n    }\n    return resultCriterion.meetCriterion(items)\n  }\n}\n\n/**\n * tablie un critre de filtration sur la base d'une liste de spcifications\n * passe en paramtres\n * @remark Au 2023-10-01, seulement `amc` et `interactif` comme spcification autorise\n * @param {[('interactif' | 'amc')]}specs liste des spcifications  rechercher (sur la base du ET)\n * @returns {Criterion<ResourceAndItsPath>} un critre pour filtration\n * @example\n * ```ts\n * const all = getAllEndings(baseReferentiel)                // cration de l'objet de recherche\n  const amcSpec = featuresCriteria(['amc'])                   // cration du filtre\n  const filteredList = amcSpec.meetCriterion(all)             // utilisation du filtre\n  const filteredReferentiel = buildReferentiel(filteredList)  // reconstitution du rfrentiel\n  ```\n */\nexport function featuresCriteria(\n  specs: ('interactif' | 'amc' | 'qcm' | 'qcmcam')[],\n): Criterion<ResourceAndItsPath> {\n  // construction du critre pour la spcification `amc`\n  const amcCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.amc &&\n            item.resource.features.amc.isActive\n          ) {\n            return true\n          } else {\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // construction du critre pour la spcification `qcm`\n  const qcmCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.qcm &&\n            item.resource.features.qcm.isActive\n          ) {\n            return true\n          } else {\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // construction du critre pour la spcification `qcmcam`\n  const qcmcamCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.qcmcam &&\n            item.resource.features.qcmcam.isActive\n          ) {\n            return true\n          } else {\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // construction du critre pour la spcification `interactif`\n  const interactifCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.interactif &&\n            item.resource.features.interactif.isActive\n          ) {\n            // console.log('found interactive :')\n            // console.log(item.resource)\n            return true\n          } else {\n            // console.log('found non interactive :')\n            // console.log(item.resource)\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // on trie en fonction de ce que contient la liste des spcifications\n  if (specs.length < 2) {\n    if (specs.length === 0) {\n      // la liste ne peut pas tre vide\n      throw new Error(\n        'La liste des spcifications passe en paramtre est vide !',\n      )\n    }\n    // une seule spcification est prsente : on renvoie le critre correspondant\n    switch (specs[0]) {\n      case 'amc':\n        return amcCriterion\n      case 'interactif':\n        return interactifCriterion\n      case 'qcm':\n        return qcmCriterion\n      case 'qcmcam':\n        return qcmcamCriterion\n    }\n  } else {\n    //  on renvoie l'intersection des critres\n    const criterion = new MultiCriteria<ResourceAndItsPath>()\n    for (const spec of specs) {\n      switch (spec) {\n        case 'amc':\n          criterion.addCriterion(amcCriterion)\n          break\n        case 'interactif':\n          criterion.addCriterion(interactifCriterion)\n          break\n        case 'qcm':\n          criterion.addCriterion(qcmCriterion)\n          break\n        case 'qcmcam':\n          criterion.addCriterion(qcmcamCriterion)\n          break\n      }\n    }\n    return criterion\n  }\n}\n\n/**\n * Construit un critre pour filtrer une liste d'objets `ResourceAndItsPath`\n * contre un niveau de classe\n * @param {Level} level le niveau de classe retenu\n * @param {boolean} [considerCAN=false] doit-on inclure les exos CAN ou pas ?\n * @returns { Criterion<ResourceAndItsPath>} un critre pour filtration\n */\nexport function levelCriterion(\n  level: Level,\n  considerCAN: boolean = true,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item) => {\n        // static est considr comme un niveau particulier\n        if (level === 'alea') {\n          return !isStaticType(item.resource)\n        }\n        if (level === 'static') {\n          return isStaticType(item.resource)\n        }\n        // CAN est considr comme un niveau donc on court-circuite les tests\n        if (level === 'CAN') {\n          return item.pathToResource[0] === level\n        }\n        if (considerCAN && item.pathToResource[0] === 'CAN') {\n          // cas o on veut des exercices CAN, on regarde le 2e lment du chemin\n          return item.pathToResource[1] === level\n        } else if (['1e', 'Terminale'].includes(item.pathToResource[0])) {\n          return item.pathToResource[1] === level\n        } else {\n          // dans l'autre cas, le niveau est dans le 1er lment du chemin\n          return item.pathToResource[0] === level\n        }\n      })\n    },\n  }\n  return criterion\n}\n\n/**\n * Construit un critre pour filtrer une liste d'objets `ResourceAndItsPath`\n * contre un sujet  rechercher dans la liste des tags\n * @param {string} selectedTag le sujet recherch dans les tags\n * @returns { Criterion<ResourceAndItsPath>} un critre pour filtration\n */\nexport function tagCriterion(\n  selectedTag: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter(\n        (item: ResourceAndItsPath) =>\n          item.resource.tags &&\n          item.resource.tags\n            .map((t) => stringWithNoAccent(t.toLowerCase()))\n            .find((t) =>\n              t.includes(stringWithNoAccent(selectedTag.toLowerCase())),\n            ),\n      )\n    },\n  }\n  return criterion\n}\n\nexport function monthCriterion(\n  monthToMatch: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter(\n        (item: ResourceAndItsPath) =>\n          MONTHS.find((t) => t.includes(monthToMatch.toLowerCase())) &&\n          resourceHasMonth(item.resource) &&\n          item.resource.mois &&\n          item.resource.mois.toLowerCase().includes(monthToMatch.toLowerCase()),\n      )\n    },\n  }\n  return criterion\n}\n\nexport function idCriterion(idToMatch: string): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (\n          isExerciceItemInReferentiel(item.resource) ||\n          isTool(item.resource)\n        ) {\n          return item.resource.id\n            .toLowerCase()\n            .includes(idToMatch.toLowerCase())\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  return criterion\n}\n\nexport function examCriterion(\n  examToMatch: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item: ResourceAndItsPath) => {\n        // console.log('examToMatch.toLowerCase()')\n        // console.log(examToMatch.toLowerCase())\n        return (\n          EXAMS.includes(examToMatch.toLowerCase()) &&\n          item.resource.uuid.startsWith(examToMatch.toLowerCase())\n        )\n      })\n    },\n  }\n  return criterion\n}\n\nexport function yearCriterion(\n  yearToMatch: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item: ResourceAndItsPath) => {\n        return (\n          YEARS.includes(yearToMatch) &&\n          isExamItemInReferentiel(item.resource) &&\n          item.resource.annee === yearToMatch\n        )\n      })\n    },\n  }\n  return criterion\n}\n\n/**\n * Construit un critre de filtration sur un sujet (chane de caractres).\n * La recherche s'effectue sur le titre (s'il y en a) ou sur le lieu (s'il y en a)\n * @param {String} subject le sujet  rechercher\n * @param {boolean} [isCanIncluded=false] doit-on inclure les exercices CAN dans le critre de la recherche\n * @returns { Criterion<ResourceAndItsPath>} un critre pour filtration\n */\nexport function subjectCriterion(\n  subject: string,\n  isCanIncluded: boolean = true,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item) => {\n        const subjectToLowerCaseWithoutAccent = stringWithNoAccent(\n          subject.toLowerCase(),\n        )\n        if (item.pathToResource.includes('CAN') && !isCanIncluded) {\n          return false\n        }\n        // on recherche un lieu\n        let placeMatch = false\n        if (resourceHasPlace(item.resource)) {\n          // si le sujet est un lieu et que la ressource a `lieu` dans ses proprit, on compare\n          placeMatch = stringWithNoAccent(\n            item.resource.lieu.toLowerCase(),\n          ).includes(subjectToLowerCaseWithoutAccent)\n        }\n        // on rechercher dans le titre\n        if (isExerciceItemInReferentiel(item.resource)) {\n          // la ressource est un exercice : elle a donc un titre\n          if (\n            stringWithNoAccent(item.resource.titre.toLowerCase()).includes(\n              subjectToLowerCaseWithoutAccent,\n            )\n          ) {\n            return true\n          } else {\n            return false || placeMatch\n          }\n        } else {\n          return false || placeMatch\n        }\n      })\n    },\n  }\n  return criterion\n}\n/**\n * Construit une liste de critres en les taguant ET ou OU\n * @param input chane de caractres pour l'inout\n * @param isCanIncluded flag pour l'inclusion des CAN\n * @returns liste d'objets du type {connector: 'ET'|'OU', filter: Criterion<ResourceAndItsPath>}\n */\nexport function buildCriteriaFromString(\n  input: string,\n  isCanIncluded: boolean = true,\n): Array<{ connector: 'ET' | 'OU'; filter: Criterion<ResourceAndItsPath> }> {\n  const criteria: Array<{\n    connector: 'ET' | 'OU'\n    filter: Criterion<ResourceAndItsPath>\n  }> = []\n  // on construit le tableau des mots recherchs en retirant les espaces superflus\n  // mais en prservant les chanes entre guillemets ou apostrophes\n  // pour l'ide, voir : https://stackoverflow.com/a/16261693/6625987\n  const re = /(?:[^\\s\"']+|['\"][^'\"]*[\"'])+/g\n  // on enlve les espace aux bornes et on partage la chane sur un ou plusieurs espace entre les mots (ainsi pas de chaine vide dans le tableau)\n  const regExpResult = input.trim().match(re)\n  const wordsTemp = regExpResult === null ? [] : [...regExpResult]\n  const words: string[] = []\n  // on traite les OU en dtectant les caractres | dans les chanes\n  for (const w of wordsTemp) {\n    if (w.includes('+')) {\n      // do somthing\n      const list = w.split('+')\n      const premier = list.shift()\n      if (premier) {\n        words.push(premier)\n      }\n      for (const w of list) {\n        words.push('+' + w)\n      }\n    } else {\n      words.push(w)\n    }\n  }\n  // console.log('words')\n  // console.log(words)\n  if (words.length === 0 || (words.length === 1 && words[0].length === 0)) {\n    // la chane explore ne doit pas tre vide\n    throw new Error('Search input should not be empty when building Criteria')\n  } else {\n    // on regarde si `CAN` est un mot pour inclure les exos CAN dans le critre de recherche\n    if (words.map((word) => word.toUpperCase()).includes('CAN')) {\n      isCanIncluded = true\n    }\n    // on nettoie les guillemets ou apostrophes si prsentes dans une chane\n    // (une chane peut tre : \"labyrinthe de multiples\", \"l'heure\", 'informations inutiles')\n    words.forEach((word, index, theArray) => {\n      let w = word\n      if (/^['\"]/.test(word)) {\n        // la chane contient un guillemet ou apostrophe au dbut\n        w = w.slice(1) // on retire le premier caractre\n      }\n      if (/['\"]$/.test(word)) {\n        // la chane contient un guillemet ou apostrophe  la fin\n        w = w.slice(0, -1) // on retire le dernier caractre\n      }\n      theArray[index] = w\n    })\n    // console.log('words (avant boucle)')\n    // console.log(words)\n    for (const word of words) {\n      const connector = word.startsWith('+') ? 'OU' : 'ET'\n      const realWord = word.replace('+', '')\n      // console.log('realWord: ' + realWord)\n      if (isLevelType(realWord)) {\n        // console.log('found level')\n        criteria.push({\n          connector,\n          filter: levelCriterion(realWord, isCanIncluded),\n        })\n        continue\n      }\n      if (EXAMS.includes(realWord.toLowerCase())) {\n        // console.log('found exam')\n        criteria.push({ connector, filter: examCriterion(realWord) })\n        continue\n      }\n      if (YEARS.includes(realWord)) {\n        // console.log('found year')\n        criteria.push({ connector, filter: yearCriterion(realWord) })\n        continue\n      }\n      // le mot n'est ni un niveau, ni un examen\n      // console.log('found subject')\n      criteria.push({\n        connector,\n        filter: new AtLeastOneOfCriteria([\n          subjectCriterion(realWord, isCanIncluded),\n          tagCriterion(realWord),\n          idCriterion(realWord),\n          monthCriterion(realWord),\n        ]),\n      })\n    }\n  }\n  return criteria\n}\n\n/**\n * Construit un critre unique bas sur la chane passe en paramtres.\n * Les mots prcds d'un signe `+` sont traits comme des critres ET\n * et les autres comme des critres OU.\n * @param input Chane de caractres utilise pour la fabrication des critres\n * @param isCanIncluded flag pour inclure les CAN\n * @returns un critre unique\n */\nexport function stringToCriterion(\n  input: string,\n  isCanIncluded: boolean = true,\n): Criterion<ResourceAndItsPath> {\n  if (input.length === 0) {\n    // la chane explore ne doit pas tre vide\n    throw new Error('Search input should not be empty when building Criteria')\n  } else {\n    const criteria = buildCriteriaFromString(input, isCanIncluded)\n    if (criteria.length === 1) {\n      // on a un seul critre : peut importe ET/OU\n      return criteria[0].filter\n    } else {\n      // on a au moins deux critres : on va inspecter la liste des critres :\n      // on va isoler les critres avec un connecteur ET\n      // et on va regrouper les critres avec un connecteur OU\n      // en un seul critre en en faisant l'union. Ainsi,\n      // on aura une seule liste de critres dont il faudra faire l'intersection\n      const justAndCriteria: Criterion<ResourceAndItsPath>[] = []\n      const orAssociations: Criterion<ResourceAndItsPath>[][] = []\n      let orListTransit: Criterion<ResourceAndItsPath>[] = []\n      // dans un premier temps, on regroupe les OU dans des listes\n      // et on isole les ET\n      criteria.forEach((item, i) => {\n        if (i === 0) {\n          // c'est le premier terme, on l'ajoute d'office\n          orListTransit.push(item.filter)\n        } else {\n          if (item.connector === 'OU') {\n            // l'lment courant a un connecteur OU\n            // on remplit la liste des OU\n            orListTransit.push(item.filter)\n          } else {\n            // l'lment courant a un connecteur ET\n            // on remplit la liste des associations\n            orAssociations.push(orListTransit)\n            // on purge la liste des OU\n            orListTransit = []\n            // on y met l'lment courant\n            orListTransit.push(item.filter)\n          }\n        }\n      })\n      // on ajoute la dernire liste de transit\n      orAssociations.push(orListTransit)\n      // on traite les listes : s'il y a un seul lment,\n      // on l'ajoute directement sinon on en fait l'union\n      orAssociations.forEach((list) => {\n        if (list.length === 1) {\n          // il y a un seul lments: il a forcment un critre ET on l'ajoute directement\n          justAndCriteria.push(list[0])\n        } else {\n          // il y a plusieurs rfrences, on doit en faire l'union\n          const [first, second, ...others] = [...list]\n          const orCriteriaUnion = new AtLeastOneOfCriteria<ResourceAndItsPath>([\n            first,\n            second,\n            ...others,\n          ])\n          justAndCriteria.push(orCriteriaUnion)\n        }\n      })\n      //  ce stade, il n'y a plus de connecteurs OU\n      // on fait l'intersection de tous les critres\n      const c = new MultiCriteria<ResourceAndItsPath>()\n      justAndCriteria.forEach((item) => c.addCriterion(item))\n      return c\n    }\n  }\n}\n","import { get, writable } from 'svelte/store'\nimport {\n  AtLeastOneOfCriteria,\n  featuresCriteria,\n  levelCriterion,\n  MultiCriteria,\n  type Criterion,\n} from '../../../../../lib/components/filters'\nimport {\n  buildReferentiel,\n  getAllEndings,\n} from '../../../../../lib/components/refUtils'\nimport type {\n  DisplayedFilter,\n  FilterObject,\n  FilterType,\n} from '../../../../../lib/types'\nimport type {\n  Features,\n  JSONReferentielObject,\n  Level,\n  ResourceAndItsPath,\n} from '../../../../../lib/types/referentiels'\n// pour sauvegarder les slections de filtres\nexport const allFilters = writable<\n  Record<FilterType, DisplayedFilter<string | Level>>\n>({\n  levels: {\n    '6e': {\n      title: 'Sixime',\n      values: ['6e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '5e': {\n      title: 'Cinquime',\n      values: ['5e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '4e': {\n      title: 'Quatrime',\n      values: ['4e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '3e': {\n      title: 'Troisime',\n      values: ['3e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    college: {\n      title: 'Collge',\n      values: ['6e', '5e', '4e', '3e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '2e': {\n      title: 'Seconde',\n      values: ['2e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '1e': {\n      title: 'Premire',\n      values: ['1e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    techno1: {\n      title: 'Premire Technologique',\n      values: ['techno1'],\n      isSelected: false,\n      clicked: 0,\n    },\n    'Terminale Technologique': {\n      title: 'Terminale Technologique',\n      values: ['Terminale Technologique'],\n      isSelected: false,\n      clicked: 0,\n    },\n    'Terminale Expert': {\n      title: 'Terminale Expert',\n      values: ['Terminale Expert'],\n      isSelected: false,\n      clicked: 0,\n    },\n    'Terminale Sp': {\n      title: 'Terminale Spcialit',\n      values: ['Terminale Sp'],\n      isSelected: false,\n      clicked: 0,\n    },\n    HP: {\n      title: 'Hors-Programme (Lyce)',\n      values: ['HP'],\n      isSelected: false,\n      clicked: 0,\n    },\n    lycee: {\n      title: 'Lyce',\n      values: [\n        '2e',\n        '1e',\n        'techno1',\n        'Terminale Technologique',\n        'Terminale Sp',\n        'Terminale Expert',\n        'HP',\n      ],\n      isSelected: false,\n      clicked: 0,\n    },\n  },\n  specs: {\n    amc: {\n      title: 'AMC (AutoMultipleChoice)',\n      values: ['amc'],\n      isSelected: false,\n      clicked: 0,\n    },\n    interactif: {\n      title: 'Interactif',\n      values: ['interactif'],\n      isSelected: false,\n      clicked: 0,\n    },\n    qcm: {\n      title: 'QCM',\n      values: ['qcm'],\n      isSelected: false,\n      clicked: 0,\n    },\n    qcmcam: {\n      title: 'exportable QcmCam',\n      values: ['qcmcam'],\n      isSelected: false,\n      clicked: 0,\n    },\n  },\n  types: {\n    alea: {\n      title: 'Alatoires seulement',\n      values: ['alea'],\n      isSelected: false,\n      clicked: 0,\n    },\n    static: {\n      title: 'Statiques seulement',\n      values: ['static'],\n      isSelected: false,\n      clicked: 0,\n    },\n    CAN: {\n      title: 'Course aux nombres',\n      values: ['CAN'],\n      isSelected: false,\n      clicked: 0,\n    },\n  },\n})\n\n/**\n * Retourne la liste de tous les niveaux slectionns\n * @returns {Level[]} la liste des niveaux slectionns dans les filtres\n */\nexport function getSelectedLevels(): Level[] {\n  const filters = get(allFilters)\n  const selectedLevels: Level[] = []\n  // on regarde les niveaux\n  Object.entries(filters.levels).forEach(([filter, level]) => {\n    if (filter !== 'college' && filter !== 'lycee') {\n      if (level.isSelected) {\n        selectedLevels.push(filter as Level)\n      }\n    }\n  })\n  // on regarde les types (qui sont des niveaux particuliers : CAN, static, etc.)\n  Object.entries(filters.types).forEach(([filter, level]) => {\n    if (level.isSelected) {\n      selectedLevels.push(filter as Level)\n    }\n  })\n  return selectedLevels\n}\n/**\n * Retourne la liste des filtres slectionns sous la forme d'objet comprenant le type, la cl et le contenu\n * @returns liste des filtres slectionns comme objects\n */\nexport function getSelectedFiltersObjects(): FilterObject<string | Level>[] {\n  const filters = get(allFilters)\n  const levels: FilterObject<string | Level>[] = []\n  // on regarde les niveaux\n  Object.entries(filters).forEach(([filterType, filterObject]) => {\n    Object.entries(filterObject).forEach(([key, obj]) => {\n      if (key !== 'college' && key !== 'lycee') {\n        if (obj.isSelected) {\n          levels.push({ type: filterType as FilterType, key, content: obj })\n        }\n      }\n    })\n  })\n  return levels\n}\n\n/**\n * Retourne la liste de toutes les fonctionnalits coches (AMC, interactif)\n * @returns liste de toutes les fonctionnalits coches\n */\nexport function getSelectedFeatures(): (keyof Features)[] {\n  const filters = get(allFilters)\n  const selectedFeatures: (keyof Features)[] = []\n  Object.entries(filters.specs).forEach(([key, spec]) => {\n    if (spec.isSelected) {\n      selectedFeatures.push(key as keyof Features)\n    }\n  })\n  return selectedFeatures\n}\n\n/**\n * Dslectionne les filtres lyce (ou collge) si une cl lyce (ou collge) est dslectionne\n * @param {string} key cl  inspecter\n */\nexport function handleUncheckingMutipleFilters(key: string) {\n  const filters = get(allFilters)\n  const clgKeys = [...filters.levels.college.values]\n  const lyceeKeys = [...filters.levels.lycee.values]\n  if (clgKeys.includes(key)) {\n    filters.levels.college.isSelected = false\n  }\n  if (lyceeKeys.includes(key)) {\n    filters.levels.lycee.isSelected = false\n  }\n}\n\n/**\n * Sur la base d'un rfrentiel pass en paramtre, construit un nouveau rfrentiel\n * sur la base de trois critres :\n * - les exercices AMC\n * - les exercices avec des QCM\n * - les exercices interactifs\n * - les niveaux de classe\n * @param {JSONReferentielObject} originalReferentiel Rfrentiel  filter\n * @param {boolean} isAmcOnlySelected flag pour limiter le rfrentiel aux exercices AMC\n * @param {boolean} isInteractiveOnlySelected flag pour limiter le rfrentiel aux exercices interactifs\n * @param {Level[]} levelsSelected flag pour limiter le rfrentiel aux exercices de certains niveaux\n * @returns {JSONReferentielObject} le rfrentiel filtr\n * @author sylvain\n */\nexport function updateReferentiel(\n  isQcmCamOnlySelected: boolean,\n  isQcmOnlySelected: boolean,\n  originalReferentiel: JSONReferentielObject,\n  isAmcOnlySelected: boolean,\n  isInteractiveOnlySelected: boolean,\n  levelsSelected: Level[], // les seuls niveaux accepts sont ceux stock dans codeList\n): JSONReferentielObject {\n  // on rcupre tous les exercices du rfrentiel pass en paramtre\n  let filteredList: ResourceAndItsPath[] = getAllEndings(originalReferentiel)\n  // on commence par crer les critres de filtration pour les spcificits (AMC et/ou Interactif)\n  const features: ('amc' | 'interactif' | 'qcm')[] = []\n  if (isAmcOnlySelected) {\n    features.push('amc')\n  }\n  if (isInteractiveOnlySelected) {\n    features.push('interactif')\n  }\n  if (isQcmOnlySelected) {\n    features.push('qcm')\n  }\n  if (isQcmCamOnlySelected) {\n    features.push('qcm')\n  }\n\n  if (features.length !== 0) {\n    // pas de liste de spcificits vide passe  `featuresCriteria`\n    filteredList = featuresCriteria(features).meetCriterion(filteredList)\n  }\n  // on traite les niveaux\n\n  switch (levelsSelected.length) {\n    case 0:\n      // pas de critre, on fait rie\n      break\n    case 1:\n      // un seul critre, on l'applique  la liste\n      filteredList = levelCriterion(levelsSelected[0]).meetCriterion(\n        filteredList,\n      )\n      break\n    default:\n      // il y a au moins deux critres : un tableau de critres par niveau\n      // puis union des critres\n      {\n        const levelsCriteria: Criterion<ResourceAndItsPath>[] = []\n        for (const level of levelsSelected) {\n          levelsCriteria.push(levelCriterion(level))\n        }\n        const [first, second, ...others] = [...levelsCriteria]\n        const unionOfCriteria: Criterion<ResourceAndItsPath> =\n          new AtLeastOneOfCriteria([first, second, ...others])\n        filteredList = unionOfCriteria.meetCriterion(filteredList)\n      }\n      break\n  }\n  return buildReferentiel(filteredList)\n}\n\n/**\n * Applique les filtres slectionns dans le store  une liste d'lment\n * de type `ResourceAndItsPath` et renvoie une liste du mme type trie\n * @param {ResourceAndItsPath[]} original liste originelle\n * @author sylvain\n */\nexport function applyFilters(\n  collection: ResourceAndItsPath[],\n): ResourceAndItsPath[] {\n  const original = [...collection]\n  // on rcupre dans le store les niveaux et les fonctionnalits cochs\n  const selectedLevels: Level[] = getSelectedLevels()\n  const selectedSpecs: (keyof Features)[] = getSelectedFeatures()\n  if (selectedLevels.length === 0 && selectedSpecs.length === 0) {\n    // pas de filtre coch : on renvoie l'original\n    return original\n  } else {\n    // on gre les niveaux cochs\n    let finalLevelsCriterion: Criterion<ResourceAndItsPath> | undefined\n    if (selectedLevels.length !== 0) {\n      const levelsCriteria: Criterion<ResourceAndItsPath>[] = []\n      for (const level of selectedLevels) {\n        levelsCriteria.push(levelCriterion(level))\n      }\n      // au moins un niveau coch !\n      if (levelsCriteria.length < 2) {\n        // un seul niveau coch\n        finalLevelsCriterion = levelsCriteria[0]\n      } else {\n        // au moins deux niveaux cochs, on fait l'UNION\n        const [first, second, ...others] = [...levelsCriteria]\n        finalLevelsCriterion = new AtLeastOneOfCriteria([\n          first,\n          second,\n          ...others,\n        ])\n      }\n    }\n    // on gre les fonctionnalits (AMC, interactif)\n    let specsCriteria: Criterion<ResourceAndItsPath> | undefined\n    if (selectedSpecs.length !== 0) {\n      specsCriteria = featuresCriteria(selectedSpecs)\n    }\n    if (finalLevelsCriterion !== undefined) {\n      if (specsCriteria !== undefined) {\n        // on a des niveaux ET des fonctionnalits cochs\n        return new MultiCriteria<ResourceAndItsPath>()\n          .addCriterion(finalLevelsCriterion)\n          .addCriterion(specsCriteria)\n          .meetCriterion(original)\n      } else {\n        // on a que des niveaux cochs\n        return finalLevelsCriterion.meetCriterion(original)\n      }\n    } else {\n      if (specsCriteria !== undefined) {\n        // on a que des fonctionnalits coces\n        return specsCriteria.meetCriterion(original)\n      }\n    }\n    return original\n  }\n}\n\nexport const filtersHaveChanged = writable<boolean>(false)\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../../../../../lib/components/time'\n  import {\n    FILTER_SECTIONS_TITLES,\n    type FilterType,\n  } from '../../../../../../../lib/types'\n  import type { Level } from '../../../../../../../lib/types/referentiels'\n  import CheckboxWithLabel from '../../../../../../shared/forms/CheckboxWithLabel.svelte'\n  import { allFilters, filtersHaveChanged } from '../../filtersStore'\n  export let filterType: FilterType = 'levels'\n  const timeTag: string = getUniqueStringBasedOnTimeStamp()\n  const dispatch = createEventDispatcher()\n  /**\n   * Grer le cochage des filtres. On a juste  grer les niveaux multiples\n   * collge et lyce qui concernent plusieurs niveaux.\n   * @remarks __Bizarrerie__ : Pour tre sr que la fonction callback de `subsribe` du store\n   * `allFilters` soit appele, on ajoute 1  la proprit `clicked`\n   * @param selectedEntry\n   */\n  function handleFiltersChanges(selectedEntry: Level | string) {\n    $filtersHaveChanged = true\n    if (filterType === 'levels') {\n      switch (selectedEntry) {\n        case 'college':\n        case 'lycee':\n          Object.values($allFilters.levels[selectedEntry].values).forEach(\n            (level) => {\n              // on met tous les niveaux college/lycee  `true` ou `false`\n              if ($allFilters.levels[selectedEntry].isSelected) {\n                $allFilters.levels[level].isSelected = true\n              } else {\n                $allFilters.levels[level].isSelected = false\n              }\n            },\n          )\n          $allFilters.levels[selectedEntry].clicked++\n          break\n        default:\n          $allFilters.levels[selectedEntry].clicked++\n          break\n      }\n      // on dcoche `college` si tous les niveaux de college ne sont pas cochs\n      $allFilters.levels.college.values.forEach((level) => {\n        if (!$allFilters.levels[level].isSelected) {\n          $allFilters.levels.college.isSelected = false\n        }\n      })\n      // on dcoche `lycee` si tous les niveaux de lycee ne sont pas cochs\n      $allFilters.levels.lycee.values.forEach((level) => {\n        if (!$allFilters.levels[level].isSelected) {\n          $allFilters.levels.lycee.isSelected = false\n        }\n      })\n    } else {\n      $allFilters[filterType][selectedEntry].clicked++\n    }\n  }\n</script>\n\n<div class={`${$$props.class || ''} flex flex-col`}>\n  <div\n    class=\"text-coopmaths-struct font-semibold text-sm px-1 border-b w-full border-coopmaths-struct\"\n  >\n    {FILTER_SECTIONS_TITLES[filterType]}\n  </div>\n  <div>\n    <ul class=\"w-full columns-[175px] gap-4 mt-2\">\n      {#each Object.entries($allFilters[filterType]) as [key, filter], i}\n        <li\n          class=\"flex-row justify-start items-center pr-4 pl-6 py-0 my-0 line-clamp-1 leading-none\n          text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n        >\n          <CheckboxWithLabel\n            id=\"checkbox-{key}-{i}-{timeTag}\"\n            bind:isChecked={filter.isSelected}\n            label={filter.title}\n            size=\"sm\"\n            on:change={() => {\n              handleFiltersChanges(key)\n              dispatch('filters-change')\n            }}\n          />\n        </li>\n      {/each}\n    </ul>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import type { CoopmathsColor } from '../../../../../../../lib/types'\n  export let text = ''\n  export let bgColor: CoopmathsColor = 'warn'\n  export let textColor: CoopmathsColor = 'corpus'\n  export let isVisible: boolean = true\n\n  // Au clic sur le bouton, on diffuse _action_\n  const dispatch = createEventDispatcher()\n\n  function triggerAction() {\n    dispatch('action', {\n      msg: 'Action triggered !',\n    })\n  }\n</script>\n\n<!--\n  @component\n  Chip avec bouton pour fermeture\n\n  ### Paramtres\n\n  * `text` : titre affich dans le chip\n  * `textColor` : couleur du texte\n  * `bgColor` : couleur de l'arrire-plan du chip\n  * `isVisible` : flag permettant de cacher le chip\n\n  ### Action\n\n  `action` est diffuse lorsque le bouton de fermeture est cliqu et sera rcupre dans le composant par `on:action`\n\n  ### Exemple\n  ```tsx\n  <Chip\n    text={(levelsMap.get(filter) ?? typesMap.get(filter)).title}\n    textColor=\"canvas\"\n    bgColor=\"struct\"\n    isVisible={selectedFilters.includes(filter)}\n    on:action={() => {\n      updateFilters(filter)\n    }}\n  />\n  ```\n -->\n\n<div\n  class=\"{isVisible\n    ? 'inline-flex'\n    : 'hidden'} flex-wrap scale-75 mr-1 items-center justify-center rounded-full bg-coopmaths-{bgColor} dark:bg-coopmathsdark-{bgColor} text-coopmaths-{textColor} dark:text-coopmathsdark-{textColor} text-xs px-2 py-[1px] shadow-sm\"\n>\n  {text}\n  <button\n    class=\"ml-1 bg-transparent hover focus:outline-none cursor-pointer\"\n    aria-label=\"Retirer le filtre\"\n    on:click={triggerAction}\n  >\n    <i\n      class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-x font-semibold text-base\"\n    ></i>\n  </button>\n</div>\n","import {\n  isExamItemInReferentiel,\n  isExerciceItemInReferentiel,\n  isStaticType,\n  resourceHasMonth,\n  type ResourceAndItsPath,\n} from '../types/referentiels'\nimport { monthes } from './handleDate'\n\n/**\n * Un type pour dcomposer les chanes de caractres\n */\ntype StringDecomposition = {\n  index: number\n  value: string[]\n  o: string\n  s: string\n}\n\n/**\n * Un type pour faciliter le tri d'un tableau de resource\n */\ntype ResourceAndItsPathDecomposition = {\n  index: number\n  value: string[]\n  o: ResourceAndItsPath\n  s: string\n}\n\n/**\n * Dtecte si une chane est un nombre ou pas\n * @param v chaine  inspecter\n * @returns `true` si la chane contient un nombre\n */\nfunction thisStringRepresentsANumber(v: string) {\n  return (+v).toString() === v\n}\n\n/**\n * Trier deux objets dcrit par un tableau de chanes\n */\nconst customSorting = {\n  asc: function (a: StringDecomposition, b: StringDecomposition): number {\n    let i = 0\n    const l = Math.min(a.value.length, b.value.length)\n\n    while (i < l && a.value[i] === b.value[i]) {\n      i++\n    }\n    if (i === l) {\n      return a.value.length - b.value.length\n    }\n    if (\n      thisStringRepresentsANumber(a.value[i]) &&\n      thisStringRepresentsANumber(b.value[i])\n    ) {\n      return parseInt(a.value[i]) - parseInt(b.value[i])\n    }\n    return a.value[i].localeCompare(b.value[i])\n  },\n  desc: function (a: StringDecomposition, b: StringDecomposition): number {\n    return customSorting.asc(b, a)\n  },\n}\n\n/**\n * Trier deux objets dcrit par un tableau de chanes\n */\nconst customSortingForResources = {\n  asc: function (\n    a: ResourceAndItsPathDecomposition,\n    b: ResourceAndItsPathDecomposition,\n  ): number {\n    let i = 0\n    const l = Math.min(a.value.length, b.value.length)\n\n    while (i < l && a.value[i] === b.value[i]) {\n      i++\n    }\n    if (i === l) {\n      return a.value.length - b.value.length\n    }\n    if (\n      thisStringRepresentsANumber(a.value[i]) &&\n      thisStringRepresentsANumber(b.value[i])\n    ) {\n      return parseInt(a.value[i]) - parseInt(b.value[i])\n    }\n    return a.value[i].localeCompare(b.value[i])\n  },\n  desc: function (\n    a: ResourceAndItsPathDecomposition,\n    b: ResourceAndItsPathDecomposition,\n  ): number {\n    return customSortingForResources.asc(b, a)\n  },\n}\n\n/**\n * Trier un tableau de chanes de caractres contenant des tirets\n * comme `4A10`, `4A10-1` `4A10-10`, etc.\n * Source : https://stackoverflow.com/a/47051217\n * @param data tableau  trier\n * @param order `asc` (dfaut) ou `desc`\n */\nexport const sortArrayOfStringsWithHyphens = (\n  data: string[],\n  order: 'asc' | 'desc' = 'asc',\n) => {\n  // nettoyer les chanes en ne gardant que les lments lis par des tirets\n  // (comme `4-A10-1`) puis dstructurer cette chane\n  const mapped = data.map(function (el, i) {\n    const string = el.replace(/\\d(?=[a-z])|[a-z](?=\\.)/gi, '$&. .')\n    const regex = /(\\d+)|([^0-9.]+)/g\n    let m: RegExpExecArray | null\n    const parts = []\n\n    while ((m = regex.exec(string)) !== null) {\n      parts.push(m[0])\n    }\n    return { index: i, value: parts, o: el, s: string }\n  })\n  mapped.sort(customSorting[order] || customSorting.asc)\n  return mapped.map(function (el) {\n    return data[el.index]\n  })\n}\n\n/**\n * Transforme les ID des exercices d'automatisme afin de prserver\n * leur positionnement en fin de liste d'une section lors de l'organisation du rfrentiel.\n * La chane auto6N2A devient 6N2zzzzzA, auto6N2A-1 devient 6N2zzzzzA-1, etc.\n * @param input ID  transformer\n * @returns la chane avec le `zzzzz` insre aprs les trois premiers caractres\n */\nfunction transformAutomatismId(input: string): string {\n  // Expression rgulire pour matcher le pattern dcrit\n  // auto + chiffre + lettre majuscule + chiffre + reste\n  const regex = /^auto(\\d)([A-Z])(\\d)(.*)?/gm\n  const match = [...input.matchAll(regex)]\n\n  // Si la chane ne correspond pas au pattern, retourner l'input inchang\n  if (match.length === 0) {\n    return input\n  }\n\n  // Extraction des groupes capturs\n  const [, digit1, letter, digit2, optionalSuffix] = [...match[0]]\n\n  // Construction de la nouvelle chane\n  // Format: chiffre + lettre + chiffre + \"zzzzz\" + dernire partie + suffixe optionnel\n  const result = `${digit1}${letter}${digit2}zzzzz${optionalSuffix || ''}`\n\n  return result\n}\n\n/**\n * Trie une liste de ressources sur la base d'une proprit (uuid ou id).\n * L'ordre tient compte des tirets : par exemple, `4-C10`, viendra avant `4-C10-1`\n * qui viendra lui-mme avant `4-C10-10`\n * @param data la liste  trier\n * @param key la proprit sur laquelle va s'oprer le tri\n * @param order l'ordre du tri (ascendant ou descendant)\n * @returns la liste trie\n * @see https://stackoverflow.com/a/47051217\n */\nexport const sortArrayOfResourcesBasedOnProp = (\n  data: ResourceAndItsPath[],\n  key: 'uuid' | 'id',\n  order: 'asc' | 'desc' = 'asc',\n): ResourceAndItsPath[] => {\n  if (data.length === 0) {\n    return data\n  }\n  const mapped = data.map((elt, i) => {\n    const r = elt.resource\n    let string: string\n    if (isExerciceItemInReferentiel(r) && key === 'id') {\n      string = transformAutomatismId(r[key])\n      string = string.replace(/\\d(?=[a-z])|[a-z](?=\\.)/gi, '$&. .')\n    } else if (isStaticType(r) && key === 'uuid') {\n      string = r[key].replace(/\\d(?=[a-z])|[a-z](?=\\.)/gi, '$&. .')\n    } else {\n      throw new Error(`La cl ${key} n'existe pas dans les ressources  trier.`)\n    }\n    const regex = /(\\d+)|([^0-9.]+)/g\n    let m: RegExpExecArray | null\n    const parts = []\n\n    while ((m = regex.exec(string)) !== null) {\n      parts.push(m[0])\n    }\n    return { index: i, value: parts, o: elt, s: string }\n  })\n  mapped.sort(customSortingForResources[order] || customSortingForResources.asc)\n  return mapped.map(function (el) {\n    return data[el.index]\n  })\n}\n\n/**\n * Trie une liste de ressources suivant l'anne et ventuellement le mois\n * @param data liste de ressources\n * @param order ordre de tri (ascendant ou descendant)\n * @returns la liste trie\n */\nexport const sortArrayOfResourcesBasedOnYearAndMonth = (\n  data: ResourceAndItsPath[],\n  order: 'asc' | 'desc' = 'asc',\n): ResourceAndItsPath[] => {\n  if (data.length === 0) {\n    return data\n  }\n  return data.sort((a, b) => {\n    // seuls les ressources de type examens ont des proprits `annee` et des fois `mois`\n    if (\n      isExamItemInReferentiel(a.resource) &&\n      isExamItemInReferentiel(b.resource)\n    ) {\n      const resourceAYear = parseInt(a.resource.annee)\n      const resourceBYear = parseInt(b.resource.annee)\n      if (resourceAYear !== resourceBYear) {\n        switch (order) {\n          case 'asc':\n            return resourceAYear - resourceBYear\n          case 'desc':\n            return resourceBYear - resourceAYear\n          default:\n            return 0\n        }\n      }\n      if (resourceHasMonth(a.resource) && resourceHasMonth(b.resource)) {\n        const resourceAMonth = monthes.indexOf(a.resource.mois!)\n        const resourceBMonth = monthes.indexOf(b.resource.mois!)\n        switch (order) {\n          case 'asc':\n            return resourceAMonth - resourceBMonth\n          case 'desc':\n            return resourceBMonth - resourceAMonth\n          default:\n            return 0\n        }\n      } else {\n        return 0\n      }\n    } else {\n      return 0\n    }\n  })\n}\n/**\n * Trie selon l'ordre alphabtique ou numrique\n * @param a nombre ou chane de caractres\n * @param b nombre ou chane de caractres\n * @returns le rsultat de la comparaison\n */\n// Define a custom sorting function\nexport const customSortStringNumber = (\n  a: number | string,\n  b: number | string,\n): number => {\n  if (typeof a === 'number' && typeof b === 'number') {\n    return a - b\n  } else {\n    return String(a).localeCompare(String(b))\n  }\n}\n\ntype Order = 'asc' | 'desc' | 'ascStringdescNumber'\n\n// Fonction qui divise une chane en parties numriques et non numriques (pour mettre dans l'ordre sujet1, sujet2 et sujet10)\nfunction splitAlphaNumeric(str: string): (string | number)[] {\n  return str\n    .split(/(\\d+)/)\n    .map((part) => (isNaN(Number(part)) ? part : Number(part)))\n}\n\n// Fonction de comparaison prenant en compte les parties numriques et les majuscules accentues\nfunction compareAlphaNumeric(a: string, b: string, order: Order): number {\n  const aParts = splitAlphaNumeric(a)\n  const bParts = splitAlphaNumeric(b)\n\n  for (let i = 0; i < Math.max(aParts.length, bParts.length); i++) {\n    const aPart = aParts[i] ?? ''\n    const bPart = bParts[i] ?? ''\n\n    if (typeof aPart === 'number' && typeof bPart === 'number') {\n      if (aPart !== bPart) {\n        // console.log(a +':' + b +'=>n' + aPart +':'+ bPart + ':' + (aPart - bPart))\n        return order === 'asc' ? aPart - bPart : bPart - aPart\n      }\n    } else if (aPart !== bPart) {\n      // Utiliser localeCompare pour comparer les chanes de manire insensible aux accents et  la casse\n      const comparison = (aPart as string)\n        .normalize('NFD')\n        .localeCompare((bPart as string).normalize('NFD'), undefined, {\n          sensitivity: 'base',\n        })\n      if (comparison !== 0) {\n        // console.log(a +':' + b +'=>s' + aPart +':'+ bPart + ':'+ (comparison))\n        return order === 'asc' || order === 'ascStringdescNumber'\n          ? comparison\n          : -comparison\n      }\n    }\n  }\n  return 0\n}\n\n/**\n * Trie les annales selon le type (bac, brevet.... par thme ou par anne) puis suivant l'anne ou le thme puis suivant le nom (donc rangement alphabtique)\n * @param {ResourceAndItsPath[]} data liste de ressources\n * @param {'asc' | 'desc' | 'ascStringdescNumber'} order ordre de tri (ascendant ou descendant)\n * ascStringdescNumber : ascendant pour les strings et descandants pour les nombres (car les nombres sont des annes)\n * @returns {ResourceAndItsPath[]} la liste trie\n * @author Eric Elter\n */\n\n// Exemple d'utilisation : Ne pas supprimer car c'est pratique pour des tests.\n/* const data: DataItem[] = [\n  {\n    pathToResource: ['Paris1', 'Agrandissement-rduction', 'dnb_2013_04_pondichery_5'],\n    resource: { uuid: 'dnb_2013_04_pondichery_5', annee: '2013', lieu: 'Pondichry' }\n  },\n  {\n    pathToResource: ['Paris11', 'Agrandissement-rduction', 'dnb_2023_04_pondichery_5'],\n    resource: { uuid: 'dnb_2023_04_pondichery_5', annee: '2023', lieu: 'Pondichry' }\n  },\n  {\n    pathToResource: ['Paris2', 'Agrandissement-rduction', 'dnb_2013_04_pondichery_5'],\n    resource: { uuid: 'dnb_2013_04_pondichery_5', annee: '2013', lieu: 'Pondichry' }\n  }\n] */\nexport const triAnnales = (\n  data: ResourceAndItsPath[],\n  order: Order = 'asc',\n): ResourceAndItsPath[] => {\n  if (data.length > 0) {\n    data.sort((a, b) => {\n      // Premier critre de tri : pathToResource[0]\n      let result = compareAlphaNumeric(\n        a.pathToResource[0],\n        b.pathToResource[0],\n        order,\n      )\n      if (result !== 0) return result\n\n      // Deuxime critre de tri : pathToResource[1] (si disponible)\n      if (a.pathToResource[1] && b.pathToResource[1]) {\n        result = compareAlphaNumeric(\n          a.pathToResource[1],\n          b.pathToResource[1],\n          order,\n        )\n        if (result !== 0) return result\n      }\n\n      // Troisime critre de tri : pathToResource[2] (si disponible)\n      if (a.pathToResource[2] && b.pathToResource[2]) {\n        result = compareAlphaNumeric(\n          a.pathToResource[2],\n          b.pathToResource[2],\n          order,\n        )\n        if (result !== 0) return result\n      }\n\n      // Si tout est gal\n      return 0\n    })\n  }\n  return data\n}\n","<script lang=\"ts\">\n  import { createEventDispatcher, onDestroy, onMount, tick } from 'svelte'\n  import { stringToCriterion } from '../../../../../../../lib/components/filters'\n  import {\n    isExerciceItemInReferentiel,\n    isTool,\n    type ExerciceItemInReferentiel,\n    type ResourceAndItsPath,\n    type ToolItemInReferentiel,\n    type Level,\n    isStaticType,\n    isExamItemInReferentiel,\n  } from '../../../../../../../lib/types/referentiels'\n  import {\n    allFilters,\n    getSelectedFiltersObjects,\n    handleUncheckingMutipleFilters,\n    filtersHaveChanged,\n  } from '../../filtersStore'\n  import type { FilterObject } from '../../../../../../../lib/types'\n  import {\n    getUniqueStringBasedOnTimeStamp,\n    debounce,\n  } from '../../../../../../../lib/components/time'\n  import Filtres from './Filtres.svelte'\n  import Chip from './Chip.svelte'\n  import type { Unsubscriber } from 'svelte/store'\n  import ButtonIcon from '../../../../../../shared/forms/ButtonIcon.svelte'\n  import {\n    sortArrayOfResourcesBasedOnProp,\n    sortArrayOfResourcesBasedOnYearAndMonth,\n  } from '../../../../../../../lib/components/sorting'\n  export let origin: ResourceAndItsPath[]\n  export let results: ResourceAndItsPath[] = []\n  export let addExercise: (uuid: string, id: string) => void\n  export let inputSearch: string = ''\n\n  let searchField: HTMLInputElement\n  let isFiltersVisible: boolean = false\n  let selectedFilters: FilterObject<string | Level>[] = []\n  let lastInput: string = ''\n  let isInputFocused = false\n  let isCtrlDown: boolean = false\n  let isKDown: boolean = false\n  let isEnterDown: boolean = false\n  let unsubscribeToFiltersStore: Unsubscriber\n\n  const dispatch = createEventDispatcher()\n  const timeStamp = getUniqueStringBasedOnTimeStamp()\n  const fetchResults = debounce<typeof updateResults>(updateResults, 500)\n  const inputSearchSamples = [\n    'pythagore',\n    '3e proba',\n    'dnb+3e stat',\n    'bac asie python',\n    'crpe 2016+2015 aires',\n  ]\n\n  onMount(() => {\n    typeWriter(`#searchInputField-${timeStamp}`, inputSearchSamples, true)\n    unsubscribeToFiltersStore = allFilters.subscribe(() => {\n      selectedFilters = [...getSelectedFiltersObjects()]\n    })\n  })\n\n  onDestroy(() => {\n    if (unsubscribeToFiltersStore) unsubscribeToFiltersStore()\n  })\n\n  $: if (inputSearch != null && inputSearch.length !== 0) {\n    handleInput(inputSearch)\n  } else {\n    results.length = 0\n  }\n\n  // ===================================================================================\n  //\n  //                                Gestion de la recherche\n  //\n  // ===================================================================================\n  function updateResults(input: string): void {\n    if (input == null || input.length === 0) {\n      results.length = 0\n    } else {\n      const resultsWithDuplicates = getResults(input)\n      const unsortedResults = getUniques(resultsWithDuplicates)\n      // on ordonne la liste de recherche\n      // tri des exercices par type\n      let nonStatics: ResourceAndItsPath[] = []\n      let statics: ResourceAndItsPath[] = []\n      const others: ResourceAndItsPath[] = []\n      for (const item of unsortedResults) {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          nonStatics.push(item)\n        } else if (isStaticType(item.resource)) {\n          statics.push(item)\n        } else {\n          others.push(item)\n        }\n      }\n      // ordonner les exercices dans chaque catgorie :\n      // -- anne/mois dcroissant pour examens\n      // -- id ordre alpha pour les exercices\n      nonStatics = [...sortArrayOfResourcesBasedOnProp(nonStatics, 'id')]\n      statics = [\n        ...sortArrayOfResourcesBasedOnYearAndMonth(statics, 'desc'),\n      ].sort((eltA, eltB) => {\n        // ranger dans les sujets d'examens identiques par numro d'exercices croissant\n        const nameA = eltA.resource.uuid.slice(0, -1)\n        const nameB = eltB.resource.uuid.slice(0, -1)\n        if (nameA.localeCompare(nameB) === 0) {\n          if (\n            isExamItemInReferentiel(eltA.resource) &&\n            isExamItemInReferentiel(eltB.resource)\n          ) {\n            return (\n              parseInt(eltA.resource.numeroInitial) -\n              parseInt(eltB.resource.numeroInitial)\n            )\n          } else {\n            return 0\n          }\n        } else {\n          return 0\n        }\n      })\n      results = [...nonStatics, ...statics, ...others]\n    }\n  }\n\n  function getResults(input: string) {\n    if (input.length === 0) {\n      return []\n    } else {\n      return [...stringToCriterion(input, true).meetCriterion(origin)]\n    }\n  }\n\n  function getUniques(results: ResourceAndItsPath[]) {\n    const uniques: ResourceAndItsPath[] = []\n    const treatedUuids: string[] = []\n    for (const elt of results) {\n      if (!treatedUuids.includes(elt.resource.uuid)) {\n        treatedUuids.push(elt.resource.uuid)\n        uniques.push(elt)\n      }\n    }\n    return uniques\n  }\n\n  function handleInput(input: string) {\n    const beginsWithQuote = input.replace(/^[\\s\"']/, '').length === 0\n    if (input == null || input.length === 0 || beginsWithQuote) {\n      results.length = 0\n    } else {\n      if (input !== lastInput) {\n        lastInput = input\n        fetchResults(input)\n      }\n      if ($filtersHaveChanged) {\n        $filtersHaveChanged = false\n        fetchResults(input)\n      }\n    }\n  }\n\n  export const triggerUpdate = (): void => {\n    if (inputSearch != null && inputSearch.length !== 0) {\n      handleInput(inputSearch)\n    }\n  }\n\n  // ===================================================================================\n  //\n  //                                Gestion du clavier\n  //\n  // ===================================================================================\n  function onFocusInput() {\n    isInputFocused = true\n  }\n  function onBlurInput() {\n    isInputFocused = false\n  }\n\n  /**\n   * Recherche si la chane de l'input correspond  une ID de la liste des rsultats.\n   * @returns {ExerciceItemInReferentiel|ToolItemInReferentiel|null} renvoie l'exercice trouv ou `null`\n   */\n  function matchOnResultsList(\n    inputSearch: string,\n  ): ExerciceItemInReferentiel | ToolItemInReferentiel | null {\n    if (inputSearch == null || inputSearch.length === 0) return null\n    for (const result of results) {\n      if (\n        isExerciceItemInReferentiel(result.resource) ||\n        isTool(result.resource)\n      ) {\n        if (inputSearch === result.resource.id) {\n          return result.resource\n        }\n      }\n    }\n    return null\n  }\n  /**\n   * Si Entre et qu'un seul exercice matche alors on ajoute l'exercice  la liste\n   */\n  function onEnterDown() {\n    const matchingResource = matchOnResultsList(inputSearch)\n    if (matchingResource !== null) {\n      addExercise(matchingResource.uuid, matchingResource.id)\n    }\n  }\n  /**\n   *\n   * @param event\n   */\n  function onKeyDown(event: KeyboardEvent) {\n    if (event.repeat) return\n    switch (event.key) {\n      case 'Control':\n        isCtrlDown = true\n        event.preventDefault()\n        break\n      case 'k':\n        isKDown = true\n        break\n      case 'Enter':\n        if (isInputFocused) {\n          isEnterDown = true\n        }\n        event.preventDefault()\n        break\n    }\n    if (isCtrlDown && isKDown) {\n      // https://svelte.dev/repl/48bd3726b74c4329a186838ce645099b?version=3.46.4\n      getFocusOnSearchInput()\n    }\n    if (isEnterDown) {\n      onEnterDown()\n    }\n  }\n\n  function onKeyUp(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'Control':\n        isCtrlDown = false\n        event.preventDefault()\n        break\n      case 'k':\n        isKDown = false\n        event.preventDefault()\n        break\n      case 'Enter':\n        isEnterDown = false\n        break\n    }\n  }\n  const getFocusOnSearchInput = async () => {\n    await tick()\n    searchField.focus()\n  }\n  /**\n   * Permet d'afficher squentiellement une liste de chanes de caractres\n   * dans un champ de recherche  la place du placeholder\n   * @see https://stackoverflow.com/a/57903237/6625987\n   * @param selectorTarget\n   * @param textList\n   * @param placeholder\n   * @param i\n   * @param textListI\n   * @param delayMs\n   */\n  function typeWriter(\n    selectorTarget: string,\n    textList: string[],\n    placeholder = false,\n    i = 0,\n    textListI = 0,\n    delayMs = 100,\n  ) {\n    if (lastInput === '') {\n      if (!i) {\n        if (placeholder) {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.placeholder = ''\n          }\n        } else {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.innerHTML = ''\n          }\n        }\n      }\n      const txt = textList[textListI]\n      if (i < txt.length) {\n        if (placeholder) {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.placeholder += txt.charAt(i)\n          }\n        } else {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.innerHTML += txt.charAt(i)\n          }\n        }\n        i++\n        setTimeout(\n          typeWriter,\n          delayMs,\n          selectorTarget,\n          textList,\n          placeholder,\n          i,\n          textListI,\n        )\n      } else {\n        textListI++\n        if (typeof textList[textListI] === 'undefined') {\n          setTimeout(\n            typeWriter,\n            delayMs * 7,\n            selectorTarget,\n            textList,\n            placeholder,\n          )\n        } else {\n          i = 0\n          setTimeout(\n            typeWriter,\n            delayMs * 7,\n            selectorTarget,\n            textList,\n            placeholder,\n            i,\n            textListI,\n          )\n        }\n      }\n    } else {\n      const inputDiv = document.querySelector(\n        selectorTarget,\n      ) as HTMLInputElement\n      if (inputDiv) {\n        inputDiv.placeholder = ' Thme, identifiant...'\n      }\n    }\n  }\n</script>\n\n<!--\n  @component\n  Champ de texte pour recherche d'exercices\n  ### Paramtres\n  - **origin** (_ResourceAndItsPath[]_) : le rfrentiel  rechercher (dplier dans un tableau)\n  - **result** (_ResourceAndItsPath[]_) : la liste des entres correspondant au texte dans le champ de recherche\n -->\n<svelte:window on:keydown={onKeyDown} on:keyup={onKeyUp} />\n<div class=\"flex flex-col justify-start items-center\">\n  <div class=\"relative flex flex-col w-full\">\n    <input\n      type=\"search\"\n      id=\"searchInputField-{timeStamp}\"\n      class=\"w-full border border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light text-sm placeholder-coopmaths-corpus-lightest dark:placeholder-coopmathsdark-corpus-lightest placeholder:italic placeholder-opacity-50\"\n      placeholder=\" Thme, identifiant...\"\n      bind:value={inputSearch}\n      bind:this={searchField}\n      on:focus={onFocusInput}\n      on:blur={onBlurInput}\n      autocomplete=\"off\"\n      autocorrect=\"off\"\n      name=\"notASearchField\"\n    />\n    <!-- Invite pour presser Entre lors d'un match input = ID d'exo -->\n    <div\n      class=\"absolute -bottom-6 {matchOnResultsList(inputSearch) !== null &&\n      isInputFocused\n        ? 'flex'\n        : 'hidden'} items-center pl-1 italic font-extralight text-xs text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n    >\n      Presser <span class=\"font-normal mx-1\">Entre</span> pour ajouter l'exercice\n    </div>\n    <!-- Bouton pour effacer l'input de recherche -->\n    <ButtonIcon\n      icon=\"bxs-tag-x text-2xl\"\n      class=\"absolute right-2 top-1\"\n      disabled={inputSearch.length === 0}\n      on:click={() => {\n        inputSearch = ''\n      }}\n    />\n    <!-- Bouton pour afficher les filtres -->\n    <button\n      type=\"button\"\n      class=\"absolute right-2 -bottom-6 text-sm text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n      on:click={() => {\n        isFiltersVisible = !isFiltersVisible\n      }}\n    >\n      Filtrer les exercices <i class=\"bx bx-filter-alt\"></i>\n    </button>\n  </div>\n  <!-- Chips des filtres -->\n  <div\n    class={selectedFilters.length === 0\n      ? 'hidden'\n      : 'flex w-full flex-row flex-wrap justify-start text-sm mt-6 leading-tight'}\n  >\n    {#each selectedFilters as filter}\n      <Chip\n        text={filter.content.title}\n        textColor=\"canvas\"\n        bgColor=\"struct\"\n        isVisible={true}\n        on:action={() => {\n          $allFilters[filter.type][filter.key].isSelected = false\n          handleUncheckingMutipleFilters(filter.key)\n          dispatch('filters-change')\n          $filtersHaveChanged = true\n          triggerUpdate()\n        }}\n      />\n    {/each}\n  </div>\n  <!-- Filtres -->\n  <div class={isFiltersVisible ? 'flex flex-col w-full mt-4' : 'hidden'}>\n    <Filtres class=\"mt-2\" filterType=\"levels\" on:filters-change />\n    <Filtres class=\"mt-2\" filterType=\"specs\" on:filters-change />\n    <Filtres class=\"mt-2\" filterType=\"types\" on:filters-change />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { ResourceAndItsPath } from '../../../../../../lib/types/referentiels'\n  import ReferentielEnding from '../referentielNode/ReferentielEnding.svelte'\n  import SearchInput from './searchInput/SearchInput.svelte'\n\n  export let resourcesSet: ResourceAndItsPath[]\n  export let addExercise: (uuid: string, id: string) => void\n  let foundResources: ResourceAndItsPath[] = []\n  let inputSearch: string = ''\n  let searchInput: SearchInput\n  export const triggerUpdateFromSearchBlock = (): void =>\n    searchInput.triggerUpdate()\n</script>\n\n<!--\n  @component\n  Bloc de recherche comprenant~:\n  - un champ texte pour saisir la recherche\n  - la liste des rsultats ventuels de la recherche\n  #### Paramtres\n  - `resourcesSet` : l'ensemble des resources  chercher sous la forme\n  d'une liste d'objets de type `ResourceAndItsPath`\n -->\n<div class={`${$$props.class || ''}`}>\n  <div class=\"p-4\">\n    <SearchInput\n      bind:this={searchInput}\n      origin={resourcesSet}\n      bind:results={foundResources}\n      bind:inputSearch\n      on:filters-change\n      {addExercise}\n    />\n  </div>\n  <ul\n    class=\"{inputSearch.length === 0 || foundResources.length === 0\n      ? 'hidden'\n      : 'flex flex-col justify-start w-full mt-4 mx-0 p-4 text-[10px] bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'} \"\n  >\n    {#each foundResources as foundResource}\n      <li>\n        <ReferentielEnding\n          ending={foundResource.resource}\n          nestedLevelCount={1}\n        />\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script>\n  import { getContext } from 'svelte'\n  const { toggleThirdAppsChoiceDialog } = getContext('thirdAppsChoiceContext')\n</script>\n\n<button\n  type=\"button\"\n  class={`${$$props.class || ''} font-bold text-xl text-coopmaths-struct dark:text-coopmathsdark-struct`}\n  on:click={toggleThirdAppsChoiceDialog}\n>\n  Applications tierces\n</button>\n","// Ce store est ddi au stockage des rfrentiels et des outils de leur volution\nimport { get, writable } from 'svelte/store'\nimport referentielAleaCH from '../../json/referentiel2022CH.json'\nimport referentielAlea from '../../json/referentiel2022FR.json'\nimport referentielBibliotheque from '../../json/referentielBibliotheque.json'\nimport referentielGeometrieDynamique from '../../json/referentielGeometrieDynamique.json'\nimport referentielProfs from '../../json/referentielProfs.json'\nimport referentielRessources from '../../json/referentielRessources.json'\nimport referentielsActivation from '../../json/referentielsActivation.json'\nimport referentielExamsCH from '../../json/referentielStaticCH.json'\nimport referentielExams from '../../json/referentielStaticFR.json'\nimport {\n  buildReferentiel,\n  getAllEndings,\n  getRecentExercices,\n} from '../components/refUtils'\nimport {\n  sortArrayOfResourcesBasedOnProp,\n  triAnnales,\n} from '../components/sorting'\nimport type { Language } from '../types/languages'\nimport type {\n  ActivationName,\n  JSONReferentielObject,\n  ReferentielInMenu,\n  ResourceAndItsPath,\n} from '../types/referentiels'\n\nfunction createOriginalReferentiels(lang: Language): ReferentielInMenu[] {\n  const isFR = lang === 'fr-FR'\n  const activations: Record<ActivationName, boolean> = {\n    ...referentielsActivation,\n  }\n\n  // Rfrentiels de base selon la langue\n  const baseReferentiel: JSONReferentielObject = isFR\n    ? { ...referentielAlea }\n    : { ...referentielAleaCH }\n  const examsReferentiel: JSONReferentielObject = isFR\n    ? { ...referentielExams }\n    : { ...referentielExamsCH }\n\n  // Rfrentiels communs\n  const referentielOutils: JSONReferentielObject = { ...referentielProfs }\n  const referentielHtml: JSONReferentielObject = { ...referentielRessources }\n  const biblioReferentiel: JSONReferentielObject = {\n    ...referentielBibliotheque,\n  }\n  const baseGeometrieDynamiqueReferentiel: JSONReferentielObject = {\n    ...referentielGeometrieDynamique,\n  }\n\n  // Traitement des examens\n  let examens = getAllEndings(examsReferentiel)\n  if (!isFR) {\n    examens = [...triAnnales(examens, 'desc')]\n  }\n  const orderedExamsReferentiel = buildReferentiel(examens)\n\n  // Traitement des nouveauts\n  const newExercises: ResourceAndItsPath[] = getRecentExercices(baseReferentiel)\n  const newExercisesReferentiel: JSONReferentielObject = {}\n  for (const item of newExercises) {\n    newExercisesReferentiel[\n      item.pathToResource[item.pathToResource.length - 1]\n    ] = { ...item.resource }\n  }\n\n  // on trie les exercice alatoires par ID ('4-C10' < '4-C10-1' <'4-C10-10')\n  // EE : Puisqu'on a dj le rfrentiel, je ne comprends pas  quoi cela sert\n  // d'autant que cela change les ordres alphabtiques pour les terminales.\n  // Bon, j'ai compris mais comme les exos de terminales n'ont pas une entte cohrente alphabtiquement, on n'a pas le choix\n  // que d'enlever ces lignes.\n\n  const baseAndNewsReferentiel: JSONReferentielObject = {\n    Nouveauts: { ...newExercisesReferentiel },\n    ...baseReferentiel,\n  }\n  let exercices = getAllEndings(baseAndNewsReferentiel)\n  exercices = [...sortArrayOfResourcesBasedOnProp(exercices, 'id')]\n\n  const aleaReferentiel = buildReferentiel(exercices)\n\n  // Gomtrie dynamique\n  const exercicesGeometrieDynamique = getAllEndings(\n    baseGeometrieDynamiqueReferentiel,\n  )\n  const geometrieDynamiqueReferentiel = buildReferentiel(\n    exercicesGeometrieDynamique,\n  )\n\n  // Construction de la liste des rfrentiels selon la langue\n  const allReferentielsInMenus: ReferentielInMenu[] = [\n    {\n      title: 'Exercices alatoires',\n      name: 'aleatoires',\n      searchable: true,\n      referentiel: aleaReferentiel,\n    },\n    ...(isFR\n      ? [\n          {\n            title: 'Annales examens',\n            name: 'examens' as ActivationName,\n            searchable: true,\n            referentiel: orderedExamsReferentiel,\n          },\n        ]\n      : []),\n    // Pour CH, les examens (EVACOM et TAF) sont comments pour l'instant\n    // {\n    //   title: 'EVACOM et TAF',\n    //   name: 'examens',\n    //   searchable: true,\n    //   referentiel: orderedExamsReferentiel,\n    // },\n    {\n      title: 'Gomtrie dynamique',\n      name: 'geometrieDynamique',\n      searchable: false,\n      referentiel: geometrieDynamiqueReferentiel,\n    },\n    {\n      title: 'Outils',\n      name: 'outils',\n      searchable: false,\n      referentiel: referentielOutils,\n    },\n    {\n      title: 'Vos ressources',\n      name: 'ressources',\n      searchable: false,\n      referentiel: referentielHtml,\n    },\n    ...(isFR\n      ? [\n          {\n            title: 'Bibliothque',\n            name: 'statiques' as ActivationName,\n            searchable: false,\n            referentiel: biblioReferentiel,\n          },\n        ]\n      : []),\n  ]\n\n  // Filtrage selon les activations\n  const activatedReferentielsInMenu: ReferentielInMenu[] = []\n  for (const ref of allReferentielsInMenus) {\n    if (activations[ref.name]) {\n      activatedReferentielsInMenu.push(ref)\n    }\n  }\n\n  return [...activatedReferentielsInMenu]\n}\n\n/**\n * Fabrique une liste de _vraies_ copies d'objets reprsentant les rfrentiels dans le menu.\n * Ces objet sont passs en paramtres sous la forme d'un tableau.\n * @param {ReferentielInMenu[]} originals liste de rfrentiels\n * @returns {ReferentielInMenu[]} liste des copies des rfrentiels\n */\nexport const deepReferentielInMenuCopy = (\n  originals: ReferentielInMenu[],\n): ReferentielInMenu[] => {\n  const copy: ReferentielInMenu[] = []\n  for (const item of originals) {\n    const ref: ReferentielInMenu = {\n      title: item.title,\n      name: item.name,\n      searchable: item.searchable,\n      referentiel: { ...item.referentiel },\n    }\n    copy.push(ref)\n  }\n  return copy\n}\n// rfrentiel mutable utilis par les composants\n// MGu ne surtout pas le charger au dpart, car c'est une variable globale,\n// et donc l'arbre va tre charg quelque soit la page demande...\n// alors que c'est utile seulement pour menuside de la vue prof\n// MGu pourquoi le mettre en storer, alors que finalement personne y souscrit ?\n// Une variable globale aurait le mme effet.\nconst referentiels = writable<ReferentielInMenu[]>([])\n\nlet localeLangLoaded: Language\n\nexport const getReferentiels = (lang: Language) => {\n  referentiels.set(createOriginalReferentiels(lang))\n  localeLangLoaded = lang\n  // console.log('getReferentiels loaded', lang)\n  return deepReferentielInMenuCopy(get(referentiels))\n}\n","<script lang=\"ts\">\n  import {\n    buildReferentiel,\n    getAllEndings,\n  } from '../../../../../lib/components/refUtils'\n  import {\n    type ActivationName,\n    type JSONReferentielObject,\n    type ReferentielInMenu,\n    type ResourceAndItsPath,\n  } from '../../../../../lib/types/referentiels'\n  import ReferentielNode from './referentielNode/ReferentielNode.svelte'\n  import SearchBlock from './searchBlock/SearchBlock.svelte'\n  import SideMenuApps from './SideMenuApps.svelte'\n\n  import { onDestroy, onMount, type Component } from 'svelte'\n  import codeToLevelList from '../../../../../json/codeToLevelList.json'\n  import { referentielLocale } from '../../../../../lib/stores/languagesStore'\n  import { applyFilters } from './filtersStore'\n\n  import { get } from 'svelte/store'\n  import { sortArrayOfResourcesBasedOnYearAndMonth } from '../../../../../lib/components/sorting'\n  import {\n    deepReferentielInMenuCopy,\n    getReferentiels,\n  } from '../../../../../lib/stores/referentielsStore'\n  import type { Language } from '../../../../../lib/types/languages'\n\n  interface SearchBlockType extends Component {\n    triggerUpdateFromSearchBlock: () => void\n  }\n\n  export let excludedReferentiels: ActivationName[] = []\n  export let addExercise: (uuid: string, id: string) => void\n\n  let searchBlock: SearchBlockType\n\n  let referentielsForMenu: ReferentielInMenu[] = []\n\n  let localeValue: Language = get(referentielLocale)\n\n  let referentiels: ReferentielInMenu[] = getReferentiels(\n    get(referentielLocale),\n  )\n\n  /**\n   * Souscription aux changements de langues.\n   *  chaque changement, on doit :\n   * -> changement du rfrentiel courant (celui qui sert de rfrence)\n   * -> changement du rfrentiel dans le store\n   * -> mise  jour des entres du menu\n   */\n  const unsubscribeToReferentielLocale = referentielLocale.subscribe(\n    (value) => {\n      if (localeValue !== value) {\n        localeValue = value\n        referentiels = getReferentiels(value)\n        updateRepositories()\n      }\n    },\n  )\n\n  onMount(() => {\n    updateRepositories()\n  })\n  onDestroy(() => {\n    unsubscribeToReferentielLocale()\n  })\n\n  function updateRepositories() {\n    const updatedRepositories: ReferentielInMenu[] = []\n    const repositoriesInMenu: ReferentielInMenu[] = deepReferentielInMenuCopy(\n      referentiels,\n    ).filter((e) => {\n      return !excludedReferentiels.includes(e.name)\n    })\n    for (const repositoryInMenu of repositoriesInMenu) {\n      if (repositoryInMenu.searchable) {\n        let filteredRepository: JSONReferentielObject =\n          buildFilteredRepository(repositoryInMenu)\n\n        if (repositoryInMenu.name === 'aleatoires') {\n          filteredRepository = orderFollowingSchoolLevel(filteredRepository)\n        }\n        repositoryInMenu.referentiel = filteredRepository\n        updatedRepositories.push(repositoryInMenu)\n      } else {\n        // /!\\ TODO : doit-ordonner les rfrentiels non cherchable ? (item.referentiel)\n        updatedRepositories.push(repositoryInMenu)\n      }\n    }\n    referentielsForMenu = updatedRepositories\n  }\n\n  function buildFilteredRepository(repositoryInMenu: ReferentielInMenu) {\n    const allExercices = getAllEndings(repositoryInMenu.referentiel)\n    // const filteredExercices: ResourceAndItsPath[] = applyFilters(allExercices) // EE : (15/05/025) Comment et remplac par la ligne ci-dessous car tri dans les annales incorrect\n    const filteredExercices: ResourceAndItsPath[] =\n      sortArrayOfResourcesBasedOnYearAndMonth(\n        applyFilters(allExercices),\n        'desc',\n      )\n    return buildReferentiel(filteredExercices)\n  }\n\n  function orderFollowingSchoolLevel(\n    filteredRepository: JSONReferentielObject,\n  ) {\n    for (const key of Object.keys(codeToLevelList).reverse()) {\n      if (Object.keys(filteredRepository).includes(key)) {\n        const keyToBeFirst = { [key]: null }\n        filteredRepository = Object.assign(keyToBeFirst, filteredRepository)\n      }\n    }\n    return filteredRepository\n  }\n\n  const buildResourcesSet = (\n    refList: ReferentielInMenu[],\n  ): ResourceAndItsPath[] => {\n    let result: ResourceAndItsPath[] = []\n    const refList2 = deepReferentielInMenuCopy(refList)\n    for (const item of refList2) {\n      if (item.searchable) {\n        if (item.referentiel.BrevetTags) {\n          delete item.referentiel.BrevetTags\n        }\n        if (item.referentiel.E3CTags) {\n          delete item.referentiel.E3CTags\n        }\n        if (item.referentiel.crpeTags) {\n          delete item.referentiel.crpeTags\n        }\n        result.push(...getAllEndings(item.referentiel))\n      }\n    }\n    const clavier: ResourceAndItsPath = {\n      resource: {\n        uuid: 'clavier',\n        url: 'clavier',\n        id: 'clavier',\n        titre: 'clavier',\n        typeExercice: 'outil',\n        tags: [],\n      },\n      pathToResource: ['ClavierTest'],\n    }\n    const version: ResourceAndItsPath = {\n      resource: {\n        uuid: 'version',\n        url: 'version',\n        id: 'version',\n        titre: 'version',\n        typeExercice: 'outil',\n        tags: [],\n      },\n      pathToResource: ['Version'],\n    }\n    result.push(clavier, version)\n    return result\n  }\n</script>\n\n<aside\n  class=\"flex w-full md:h-full md:min-h-full flex-col items-start pb-4 pt-0 md:pt-4 ml-0 md:mx-0 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n>\n  <SearchBlock\n    bind:this={searchBlock}\n    class=\"w-full flex flex-col justify-start pt-0 sm:\"\n    resourcesSet={buildResourcesSet(referentielsForMenu)}\n    on:filters-change={() => {\n      updateRepositories()\n      searchBlock.triggerUpdateFromSearchBlock()\n    }}\n    {addExercise}\n  />\n  <div class=\"mt-4 w-full\">\n    <!-- Affichage de tous les rfrentiels -->\n    {#each referentielsForMenu as item, i}\n      <ReferentielNode\n        bind:subset={item.referentiel}\n        indexBase={i + 1}\n        levelTitle={item.title}\n        nestedLevelCount={1}\n        class=\"w-full px-4 text-[10px]\"\n        pathToThisNode={[]}\n      />\n    {/each}\n    <!-- Bouton spcial pour les applications tierces -->\n    <SideMenuApps class=\"text-start p-6 w-full\" />\n  </div>\n</aside>\n","<script lang=\"ts\">\n  //\n  //\n  // /!\\ Il reste  traiter ReferentielEnding.svelte qui contient encore des accs au generalStore\n  //     Il faut faire remonter les demandes  Start.svelte pour qu'il reste le seul avec ces accs\n  //        et faire en sorte que ReferentielEnding.svelte ne gre que de l'affichage en bon presentationalComponent\n  // /!\\ Chip.svelte, SearchInput.svelte et Filtres.svelte contiennet encore des createEventDispatcher, dans l'idal il\n  //     faudrait pluttqu'ils fassent remonter les changements jusqu' SideMenu.svelte via une {function} pour qu'ils\n  //     les fassent redescendre ensuite par des {attributs}\n  //\n  import {\n    afterUpdate,\n    beforeUpdate,\n    onDestroy,\n    onMount,\n    setContext,\n    tick,\n  } from 'svelte'\n  import { get } from 'svelte/store'\n  import appsTierce from '../../../json/referentielAppsTierce.json'\n  import { qcmCamExportAll } from '../../../lib/amc/qcmCam'\n  import { buildEsParams } from '../../../lib/components/urls'\n  import { downloadFile } from '../../../lib/files'\n  import handleCapytale from '../../../lib/handleCapytale'\n  import { sendActivityParams } from '../../../lib/handleRecorder'\n  import {\n    getExercisesFromExercicesParams,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea'\n  import { canOptions } from '../../../lib/stores/canStore'\n  import {\n    darkMode,\n    exercicesParams,\n    previousView,\n  } from '../../../lib/stores/generalStore'\n  import { globalOptions } from '../../../lib/stores/globalOptions'\n  import {\n    localisedIDToUuid,\n    referentielLocale,\n  } from '../../../lib/stores/languagesStore'\n  import type {\n    InterfaceGlobalOptions,\n    InterfaceParams,\n  } from '../../../lib/types'\n  import type { CanOptions } from '../../../lib/types/can'\n  import type { Language } from '../../../lib/types/languages'\n  import { ALLOWED_LANGUAGES, isLanguage } from '../../../lib/types/languages'\n  import { type AppTierceGroup } from '../../../lib/types/referentiels'\n  import type { VueType } from '../../../lib/VueType'\n  import Footer from '../../Footer.svelte'\n  import Keyboard from '../../keyboard/Keyboard.svelte'\n  import { SM_BREAKPOINT } from '../../keyboard/lib/sizes'\n  import BasicClassicModal from '../../shared/modal/BasicClassicModal.svelte'\n  import Sidenav from '../../shared/sidenav/Sidenav.svelte'\n  import ButtonBackToTop from './presentationalComponents/ButtonBackToTop.svelte'\n  import Exercices from './presentationalComponents/Exercices.svelte'\n  import Header from './presentationalComponents/header/Header.svelte'\n  import SideMenuWrapper from './presentationalComponents/header/SideMenuWrapper.svelte'\n  import ModalCapytalSettings from './presentationalComponents/modalCapytalSettings/ModalCapytalSettings.svelte'\n  import ModalThirdApps from './presentationalComponents/ModalThirdApps.svelte'\n  import Placeholder from './presentationalComponents/Placeholder.svelte'\n  import SideMenu from './presentationalComponents/sideMenu/SideMenu.svelte'\n\n  let isNavBarVisible: boolean = true\n  let innerWidth = 0\n  let isBackToTopButtonVisible = false\n  let selectedThirdApps: string[]\n  let thirdAppsChoiceModal: BasicClassicModal\n  let showThirdAppsChoiceDialog = false\n  let isMd: boolean\n  let localeValue: Language = get(referentielLocale)\n  let isSidenavOpened: boolean = true\n\n  const unsubscribeToReferentielLocale = referentielLocale.subscribe(\n    (value) => {\n      localeValue = value\n    },\n  )\n\n  let debug = false\n  function log(str: string) {\n    if (debug || window.logDebug > 1) {\n      console.info(str)\n    }\n  }\n\n  beforeUpdate(() => {\n    log('Start.svelte beforeUpdate')\n  })\n\n  afterUpdate(() => {\n    log('Start.svelte afterUpdate')\n  })\n\n  onMount(async () => {\n    log('Start.svelte onMount')\n    await tick() // globalOptions n'est pas encore initialis si on n'attend pas\n    if ($globalOptions.recorder === 'capytale') {\n      handleCapytale()\n    }\n    addScrollListener()\n    log('Fin Start.svelte onMount')\n  })\n\n  onDestroy(() => {\n    log('Start.svelte destroyed')\n    unsubscribeToReferentielLocale()\n  })\n\n  // Spcifique  Capytale\n  let isSettingsDialogDisplayed = false\n  // Gestion de la graine\n  function buildUrlAndOpenItInNewTab(status: 'eleve' | 'usual') {\n    const url = new URL('https://coopmaths.fr/alea/')\n    for (const ex of $exercicesParams) {\n      url.searchParams.append('uuid', ex.uuid)\n      if (ex.id !== undefined) url.searchParams.append('id', ex.id)\n      if (ex.nbQuestions !== undefined) {\n        url.searchParams.append('n', ex.nbQuestions.toString())\n      }\n      if (ex.duration !== undefined) {\n        url.searchParams.append('d', ex.duration.toString())\n      }\n      if (ex.sup !== undefined) url.searchParams.append('s', ex.sup)\n      if (ex.sup2 !== undefined) url.searchParams.append('s2', ex.sup2)\n      if (ex.sup3 !== undefined) url.searchParams.append('s3', ex.sup3)\n      if (ex.sup4 !== undefined) url.searchParams.append('s4', ex.sup4)\n      if (ex.sup5 !== undefined) url.searchParams.append('s5', ex.sup5)\n      if (ex.alea !== undefined) url.searchParams.append('alea', ex.alea)\n      if (ex.interactif === '1') url.searchParams.append('i', '1')\n      if (ex.cd !== undefined) url.searchParams.append('cd', ex.cd)\n      if (ex.cols !== undefined) {\n        url.searchParams.append('cols', ex.cols.toString())\n      }\n    }\n    switch (status) {\n      case 'eleve':\n        if ($canOptions.isChoosen) {\n          url.searchParams.append('v', 'can')\n        } else {\n          url.searchParams.append('v', 'eleve')\n        }\n        break\n      default:\n        break\n    }\n    url.searchParams.append('title', $globalOptions.title ?? '')\n    const presMode =\n      $exercicesParams.length === 1 ? 'liste_exos' : 'un_exo_par_page'\n    url.searchParams.append('es', buildEsParams(presMode))\n\n    if ($canOptions.isChoosen) {\n      if ($canOptions.durationInMinutes !== 0) {\n        url.searchParams.append(\n          'canD',\n          $canOptions.durationInMinutes.toString(),\n        )\n      }\n      if ($canOptions.subTitle !== '') {\n        url.searchParams.append('canT', $canOptions.subTitle)\n      }\n      if ($canOptions.solutionsAccess) {\n        url.searchParams.append('canSM', $canOptions.solutionsMode)\n      }\n    }\n    window.open(url, '_blank')?.focus()\n  }\n\n  function toggleCan() {\n    if ($canOptions.isChoosen) {\n      $globalOptions.setInteractive = '1'\n    }\n  }\n\n  function showSettingsDialog() {\n    isSettingsDialogDisplayed = true\n  }\n\n  const handleLanguage = (lang: string) => {\n    let selectedLanguage: Language = ALLOWED_LANGUAGES[0]\n    // on se dplace circulairement dans le tableau allowedLanguages\n    // ide prise ici :https://dev.to/turneremma21/circular-access-of-array-in-javascript-j52\n    if (isLanguage(lang)) {\n      selectedLanguage = lang\n    } else {\n      window.notify(`${lang} is not allowed as language.`, {})\n    }\n\n    referentielLocale.set(selectedLanguage)\n    const currentRefToUuid = localisedIDToUuid[get(referentielLocale)]\n    exercicesParams.update((list) => {\n      for (let i = 0; i < list.length; i++) {\n        const localeID = (\n          Object.keys(currentRefToUuid) as (keyof typeof currentRefToUuid)[]\n        ).find((key) => {\n          return currentRefToUuid[key] === list[i].uuid\n        })\n        const frenchID = (\n          Object.keys(\n            localisedIDToUuid['fr-FR'],\n          ) as (keyof (typeof localisedIDToUuid)['fr-FR'])[]\n        ).find((key) => {\n          return localisedIDToUuid['fr-FR'][key] === list[i].uuid\n        })\n        list[i].id =\n          localeID !== undefined && localeID.length !== 0 ? localeID : frenchID\n      }\n      return list\n    })\n    const event = new window.Event('languageHasChanged', {\n      bubbles: true,\n    })\n    document.dispatchEvent(event)\n    mathaleaUpdateUrlFromExercicesParams()\n  }\n\n  $: {\n    isNavBarVisible = $globalOptions.v !== 'l'\n    updateSelectedThirdApps()\n    isMd = innerWidth >= SM_BREAKPOINT\n  }\n\n  function addScrollListener() {\n    function updateBackToTopButtonVisibility() {\n      isBackToTopButtonVisible =\n        document.body.scrollTop > 500 ||\n        document.documentElement.scrollTop > 500\n    }\n    window.addEventListener('scroll', () => updateBackToTopButtonVisibility())\n  }\n\n  /* MGu empeche le zoom sur double touch sur IPAD */\n  document.addEventListener('gesturestart', function (e) {\n    e.preventDefault()\n  })\n\n  /* Pour que les apps puissent fermer la sidenav */\n  window.addEventListener('message', (event) => {\n    if (event.data?.type === 'closeSidenav') {\n      if (isSidenavOpened) toggleSidenav(false)\n    }\n  })\n\n  function updateSelectedThirdApps() {\n    const appsTierceReferentielArray: AppTierceGroup[] =\n      Object.values(appsTierce)\n    const uuidList: string[] = $exercicesParams.map(\n      (exerciceParams) => exerciceParams.uuid,\n    )\n    selectedThirdApps = []\n    for (const group of appsTierceReferentielArray) {\n      for (const app of group.liste) {\n        if (uuidList.includes(app.uuid)) {\n          selectedThirdApps.push(app.uuid)\n        }\n      }\n    }\n  }\n\n  function zoomUpdate(plusMinus: '+' | '-') {\n    let zoom = Number($globalOptions.z)\n    if (plusMinus === '+') zoom = Number.parseFloat((zoom + 0.1).toFixed(1))\n    if (plusMinus === '-') zoom = Number.parseFloat((zoom - 0.1).toFixed(1))\n    globalOptions.update((params) => {\n      params.z = zoom.toString()\n      return params\n    })\n  }\n\n  function setAllInteractive(isAllInteractive: boolean) {\n    let eventName: string\n    if (isAllInteractive) {\n      $globalOptions.setInteractive = '1'\n      eventName = 'setAllInteractif'\n    } else {\n      $globalOptions.setInteractive = '0'\n      eventName = 'removeAllInteractif'\n    }\n    const event = new window.Event(eventName, { bubbles: true })\n    document.dispatchEvent(event)\n  }\n\n  function newDataForAll() {\n    const newDataForAll = new window.Event('newDataForAll', { bubbles: true })\n    document.dispatchEvent(newDataForAll)\n  }\n\n  function trash() {\n    exercicesParams.set([])\n    toggleSidenav(true)\n  }\n\n  function setFullScreen(isFullScreen: boolean) {\n    globalOptions.update((params) => {\n      isFullScreen ? (params.v = 'l') : (params.v = '')\n      return params\n    })\n  }\n\n  function handleExport(vue: VueType) {\n    $previousView = ''\n    globalOptions.update((params) => {\n      params.v = vue\n      return params\n    })\n  }\n\n  function addExercise(uuid: string, id: string) {\n    const newExercise: InterfaceParams = { uuid, id }\n    if (\n      $globalOptions.recorder === 'capytale' ||\n      $globalOptions.setInteractive === '1'\n    ) {\n      newExercise.interactif = '1'\n    }\n    exercicesParams.update((list) => [...list, newExercise])\n  }\n\n  function backToTop() {\n    window.scrollTo({ top: 0, behavior: 'smooth' })\n  }\n\n  function importExercises(urlFeuilleEleve: string) {\n    const tempRecorder = $globalOptions.recorder\n    let url = urlFeuilleEleve.replace('&v=confeleve', '')\n    url = url.replace('&v=eleve', '&recorder=' + $globalOptions.recorder)\n    if (url.includes('v=can')) {\n      $canOptions.isChoosen = true\n    }\n    url = url.replace('&v=can', '&recorder=' + $globalOptions.recorder)\n    url = url.replace(/&es=\\d{7}/g, '&es=1110001') // Force les rglages de prsentation\n    // presMode|setInteractive|isSolutionAccessible|isInteractiveFree|oneShot|twoColumns|isTitleDisplayed\n    if (url.includes('coopmaths.fr/alea') || url.includes('/mathalea.fr/')) {\n      const options = mathaleaUpdateExercicesParamsFromUrl(url)\n      if (options !== null) {\n        globalOptions.set(options)\n      } else {\n        alert('URL non valide !')\n      }\n      // On maintient Capytale car l'import d'une url non valide cr un objet globalOptions vide\n      $globalOptions.recorder = tempRecorder\n    }\n  }\n\n  /**\n   * Gestion des rfrentiels\n   */\n  // Contexte pour le modal des apps tierces\n  setContext('thirdAppsChoiceContext', {\n    toggleThirdAppsChoiceDialog: () => {\n      showThirdAppsChoiceDialog = !showThirdAppsChoiceDialog\n      if (showThirdAppsChoiceDialog === false && thirdAppsChoiceModal) {\n        thirdAppsChoiceModal.closeModal()\n      }\n    },\n  })\n\n  function updateParams(params: {\n    globalOptions: InterfaceGlobalOptions\n    canOptions: CanOptions\n  }) {\n    // MGu d'aprs bugsnag, il arrive que params.canOptions soit null!\n    if (params.canOptions) canOptions.set(params.canOptions)\n    if (params.globalOptions) globalOptions.set(params.globalOptions) // en dernier car c'est sa modification qui dclenche la mise  jour de l'url dans App.svelte qui prvient ensuite Capytale d'une mise  jour\n  }\n\n  function toggleSidenav(forceOpening: boolean): void {\n    if (forceOpening) {\n      isSidenavOpened = true\n    } else {\n      isSidenavOpened = !isSidenavOpened\n    }\n  }\n\n  async function exportQcmCam(): Promise<void> {\n    const exercises = await getExercisesFromExercicesParams()\n    const exercisesQcms = exercises.filter((exercise) => {\n      exercise.nouvelleVersion()\n      const questionsQcm = exercise.autoCorrection.filter(\n        (el) =>\n          el.reponse?.param?.formatInteractif === 'qcm' &&\n          el.propositions != null &&\n          el.propositions?.length > 1,\n      ).length\n      return questionsQcm !== 0\n    })\n\n    if (exercisesQcms.length === 0) {\n      alert(\n        \"Il n'y a pas encore d'export vers QCM Cam pour les exercices slectionns\",\n      )\n      return\n    }\n    const content = qcmCamExportAll(exercisesQcms)\n    if (content === '{}') {\n      alert(\n        \"Il n'y a pas encore d'export vers QCM Cam pour les exercices slectionns\",\n      )\n      return\n    }\n    downloadFile(content, 'questions.txt') // @todo Si possible, il faudrait l'nvoyer directement  travers l'ouverture d'un nouvel onglet qcmcam.net avec le lien vers ce fichier en argument.\n  }\n</script>\n\n<svelte:window bind:innerWidth />\n{#if $globalOptions.v === '' || $globalOptions.v === undefined || $globalOptions.v === 'l'}\n  <div\n    class=\"{$darkMode.isActive\n      ? 'dark'\n      : ''} relative flex w-screen h-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    id=\"startComponent\"\n  >\n    <div class=\"flex-1 flex flex-col w-full md:overflow-hidden\">\n      <Header\n        {isNavBarVisible}\n        isExerciseDisplayed={$exercicesParams.length !== 0}\n        {zoomUpdate}\n        {setAllInteractive}\n        {newDataForAll}\n        {trash}\n        {setFullScreen}\n        {handleExport}\n        handleRecorder={sendActivityParams}\n        locale={localeValue}\n        {handleLanguage}\n        isCapytale={$globalOptions.recorder === 'capytale'}\n        isRecorder={!!$globalOptions.recorder}\n        {buildUrlAndOpenItInNewTab}\n        {showSettingsDialog}\n        {importExercises}\n        isExercisesListEmpty={$exercicesParams.length === 0}\n        {isSidenavOpened}\n        {toggleSidenav}\n        {exportQcmCam}\n        {isMd}\n      />\n      {#if isMd}\n        <!-- ====================================================================================\n                    MODE NORMAL\n  ========================================================================================= -->\n        <!-- Menu choix + Exos en mode non-smartphone -->\n        <div\n          class=\"relative flex w-full h-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          {#if $globalOptions.recorder}\n            <SideMenuWrapper\n              isRecorder={$globalOptions.recorder === 'capytale'}\n              {isSidenavOpened}\n              {toggleSidenav}\n              {isMd}\n            />\n          {/if}\n          <Sidenav isOpen={isSidenavOpened} width={400}>\n            <div\n              class=\"w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n            >\n              <SideMenu {addExercise} />\n            </div>\n          </Sidenav>\n          <!-- Affichage exercices -->\n          <main\n            id=\"exercisesPart\"\n            class=\"absolute right-0 top-0 flex flex-col w-full h-full px-6 overflow-x-auto overflow-y-auto\n            transition-[padding-left] duration-300\n            bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n            style=\"padding-left: {$globalOptions.recorder\n              ? isSidenavOpened\n                ? '425px'\n                : '25px'\n              : isSidenavOpened\n                ? '400px'\n                : '0px'}\"\n          >\n            <!-- MGu si la vue n'est pas START, le composant va tre detruit et ici ca empeche de charger des exos inutilement-->\n            {#if $exercicesParams.length !== 0 && ($globalOptions.v === '' || $globalOptions.v === undefined || $globalOptions.v === 'l')}\n              <Exercices exercicesParams={$exercicesParams} {toggleSidenav} />\n            {:else}\n              <Placeholder text=\"Slectionner les exercices\" />\n            {/if}\n          </main>\n        </div>\n      {:else}\n        <!-- ====================================================================================\n                  MODE SMARTPHONE\n========================================================================================= -->\n        <div\n          class=\"flex flex-col h-full justify-between bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          <!-- Menu choix en mode smartphone -->\n          <div>\n            <div\n              class=\"w-full flex flex-col bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n            >\n              <button\n                type=\"button\"\n                class=\"group w-full flex flex-row justify-between items-center p-4\"\n                aria-expanded={isSidenavOpened}\n                aria-controls=\"choiceMenuWrapper\"\n                on:click={() => (isSidenavOpened = !isSidenavOpened)}\n              >\n                <div\n                  class=\"text-lg font-bold text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n                >\n                  Choix des exercices\n                </div>\n                <i\n                  class=\"bx bxs-up-arrow text-lg text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest transition-transform duration-300 {isSidenavOpened\n                    ? 'rotate-0'\n                    : 'rotate-180'}\"\n                ></i>\n              </button>\n              {#if isSidenavOpened}\n                <div\n                  id=\"choiceMenuWrapper\"\n                  class=\"w-full overflow-y-visible overscroll-contain bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n                >\n                  <SideMenu {addExercise} />\n                </div>\n              {/if}\n            </div>\n            <!-- Affichage exercices en mode smartphone -->\n            <main\n              id=\"exercisesPart\"\n              class=\"flex w-full px-6 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n            >\n              {#if $exercicesParams.length !== 0}\n                <Exercices exercicesParams={$exercicesParams} {toggleSidenav} />\n              {:else}\n                <Placeholder text=\"Slectionner les exercices\" />\n              {/if}\n            </main>\n          </div>\n          <Footer />\n        </div>\n      {/if}\n    </div>\n    <Keyboard />\n  </div>\n  <ButtonBackToTop {isBackToTopButtonVisible} {backToTop} />\n  <ModalThirdApps\n    {thirdAppsChoiceModal}\n    {showThirdAppsChoiceDialog}\n    appsTierceInExercisesList={selectedThirdApps}\n  />\n  <ModalCapytalSettings\n    bind:isSettingsDialogDisplayed\n    globalOptions={$globalOptions}\n    canOptions={$canOptions}\n    {toggleCan}\n    {buildUrlAndOpenItInNewTab}\n    {updateParams}\n  />\n{/if}\n\n<style>\n  :root {\n    scrollbar-color: #aaaaaa transparent;\n  }\n  /* Webkit scrollbar styling for Chrome/Safari */\n  ::-webkit-scrollbar {\n    width: 5px;\n    height: 5px;\n  }\n  ::-webkit-scrollbar-thumb {\n    background: #cccccc;\n    border-radius: 10px;\n  }\n  ::-webkit-scrollbar-thumb:hover {\n    background: #dddddd;\n  }\n  ::-webkit-scrollbar-track {\n    background: #ffffff;\n    border-radius: 10px;\n    box-shadow: inset 7px 10px 12px #f0f0f0;\n  }\n</style>\n","<script lang=\"ts\">\n  export let message: string = ''\n  export let visible = false\n  export let onClose = () => {} // Callback pour la fermeture du popup\n\n  function closePopup() {\n    visible = false\n    onClose()\n  }\n</script>\n\n{#if visible}\n  <button class=\"overlay\" on:click={closePopup} aria-label=\"Close popup\"\n  ></button>\n  <div class=\"popup\">\n    <p>{@html message}</p>\n    <button class=\"button\" on:click={closePopup}>Fermer</button>\n  </div>\n{/if}\n\n<style>\n  .popup {\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background-color: white;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n    z-index: 1000;\n  }\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 999;\n  }\n  .button {\n    background-color: #007bff;\n    color: white;\n    border: none;\n    padding: 10px 20px;\n    font-size: 16px;\n    border-radius: 5px;\n    cursor: pointer;\n    transition: background-color 0.3s ease;\n  }\n  .button:hover {\n    background-color: #0056b3;\n  }\n  .button:focus {\n    outline: none;\n    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.5);\n  }\n</style>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import type { Unsubscriber } from 'svelte/store'\n  import { checkBrowserVersion } from '../lib/components/browserVersion'\n  import { fetchServerVersion } from '../lib/components/version'\n  import {\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../lib/mathalea'\n  import { canOptions } from '../lib/stores/canStore'\n  import {\n    darkMode,\n    exercicesParams,\n    freezeUrl,\n    isInIframe,\n  } from '../lib/stores/generalStore'\n  import { globalOptions } from '../lib/stores/globalOptions'\n  import { updateReferentielLocaleFromURL } from '../lib/stores/languagesStore'\n  import { vendor } from '../lib/stores/vendorStore'\n  import type { CanSolutionsMode } from '../lib/types/can'\n  import { context } from '../modules/context'\n\n  import Can from './display/can/Can.svelte'\n  import Eleve from './display/eleve/Eleve.svelte'\n  import Alacarte from './setup/alacarte/Alacarte.svelte'\n  import Amc from './setup/amc/Amc.svelte'\n  import Anki from './setup/anki/Anki.svelte'\n  import ConfigEleve from './setup/configEleve/ConfigEleve.svelte'\n  import Diaporama from './setup/diaporama/Diaporama.svelte'\n  import Latex from './setup/latex/Latex.svelte'\n  import RawLatex from './setup/latex/RawLatex.svelte'\n  import Pdf from './setup/latex/Pdf.svelte'\n  import Moodle from './setup/moodle/Moodle.svelte'\n  import Start from './setup/start/Start.svelte'\n  import Popup from './shared/modal/Popup.svelte'\n\n  let showPopup = false\n  let popupMessage = ''\n  let globalOptionsUnsubscriber: Unsubscriber\n  let exercicesParamsUnsubscriber: Unsubscriber\n\n  function handlePopupClose() {\n    // console.log('Popup has been closed');\n    showPopup = false\n  }\n\n  onMount(() => {\n    updateParams()\n    addEventListener('popstate', updateParams)\n    globalOptionsUnsubscriber = globalOptions.subscribe(() => {\n      updateContext() // Si on attend les 500 ms de mise  jour de l'url, la sortie LaTeX sera charge avant la mise  jour du contexte et on se retrouvera avec du svg dans le LaTeX\n      updateVendor() // Par prvention, on met aussi  jour le vendor\n      mathaleaUpdateUrlFromExercicesParams()\n    })\n    exercicesParamsUnsubscriber = exercicesParams.subscribe(() => {\n      mathaleaUpdateUrlFromExercicesParams()\n    })\n\n    const version = checkBrowserVersion()\n    if (version.popupMessage.length > 0) {\n      showPopup = true\n      popupMessage = version.popupMessage\n    }\n  })\n\n  onDestroy(() => {\n    removeEventListener('popstate', updateParams)\n    globalOptionsUnsubscriber()\n    exercicesParamsUnsubscriber()\n  })\n\n  // charge le numro de version du serveur\n  fetchServerVersion()\n\n  // Gestion des recorders (Moodle, Capytale, etc. )\n  // Lorsque la page d'accueil est dans un iFrame, l'URL est bloque et les boutons d'exports cachs\n  const url = new URL(window.location.href)\n  const recorder = url.searchParams.get('recorder')\n  if (recorder !== null) {\n    isInIframe.set(true)\n    freezeUrl.set(true)\n  } else {\n    isInIframe.set(false)\n  }\n\n  // le plus tt possible, on met  jour la vue\n  // const view = url.searchParams.get('v') ?? ''\n  // const v = convertVueType(view) ?? ''\n  // globalOptions.update((options) => {\n  //   options.v = v\n  //   return options\n  // })\n\n  // Gestion des paramtres de la CAN\n  const canDuration = url.searchParams.get('canD')\n  if (canDuration !== null) {\n    $canOptions.durationInMinutes = parseInt(canDuration)\n  }\n  const canSub = url.searchParams.get('canT')\n  if (canSub !== null) {\n    $canOptions.subTitle = canSub\n  }\n  const canSolAccess = url.searchParams.get('canSA')\n  if (canSolAccess !== null) {\n    $canOptions.solutionsAccess = canSolAccess === 'true'\n  }\n  const canSolMode = url.searchParams.get('canSM')\n  if (canSolMode !== null) {\n    $canOptions.solutionsMode = canSolMode as CanSolutionsMode\n  }\n  const canIsInteractive = url.searchParams.get('canI')\n  if (canIsInteractive !== null) {\n    $canOptions.isInteractive = canIsInteractive === 'true'\n  }\n\n  function updateParams() {\n    updateParamsFromUrl()\n    updateContext()\n    updateVendor()\n  }\n\n  function updateParamsFromUrl() {\n    updateReferentielLocaleFromURL()\n    const urlOptions = mathaleaUpdateExercicesParamsFromUrl()\n    if (JSON.stringify($globalOptions) !== JSON.stringify(urlOptions)) {\n      globalOptions.set(urlOptions)\n    }\n  }\n\n  function updateContext() {\n    context.isDiaporama = $globalOptions.v === 'diaporama'\n    if (\n      $globalOptions.v === 'latex' ||\n      $globalOptions.v === 'pdf' ||\n      $globalOptions.v === 'raw'\n    ) {\n      context.isHtml = false\n    } else {\n      context.isHtml = true\n    }\n    if ($globalOptions.v === 'confeleve') {\n      context.isHtml = false\n    }\n    if ($globalOptions.v === 'alacarte') {\n      context.isHtml = false\n    }\n    if ($globalOptions.v === 'amc') {\n      context.isAmc = true\n      context.isHtml = false\n    } else {\n      context.isAmc = false\n    }\n    context.vue = ''\n    if ($globalOptions.v === 'diaporama') context.vue = 'diap' // for compatibility\n    if ($globalOptions.v === 'latex' || $globalOptions.v === 'raw')\n      context.vue = 'latex' // for compatibility\n    if ($globalOptions.v === 'can') context.vue = 'can' // for compatibility\n    // lorsque l'diteur sera intgr  la v3, il faudra mettre  true cette proprit pour l'editeur\n    context.isInEditor = false\n  }\n\n  function updateVendor() {\n    // initialisation du vendor pour l'intgration de la bannire dans la vue lve\n    if ($globalOptions.v === 'myriade') {\n      $vendor.product = {\n        name: 'indices',\n        logoPath: 'assets/images/vendors/bordas/myriade-bordas-logo.png',\n      }\n    }\n    if ($globalOptions.v === 'indices') {\n      $vendor.product = {\n        name: 'indices',\n        logoPath: 'assets/images/vendors/bordas/indices-bordas-logo.png',\n      }\n    }\n  }\n\n  function isDevMode() {\n    return window.location.href.startsWith('http://localhost')\n  }\n</script>\n\n<div\n  class=\" {$darkMode.isActive\n    ? 'dark'\n    : ''} subpixel-antialiased bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  id=\"appComponent\"\n>\n  {#if showPopup}\n    <Popup\n      message={popupMessage}\n      visible={showPopup}\n      onClose={handlePopupClose}\n    />\n  {:else if $globalOptions.v === 'diaporama' || $globalOptions.v === 'overview'}\n    <Diaporama />\n  {:else if $globalOptions.v === 'can'}\n    <Can />\n  {:else if $globalOptions.v === 'eleve' || $globalOptions.v === 'indices' || $globalOptions.v === 'myriade'}\n    <Eleve />\n  {:else if $globalOptions.v === 'latex'}\n    <Latex />\n  {:else if $globalOptions.v === 'raw'}\n    <RawLatex />\n  {:else if $globalOptions.v === 'alacarte'}\n    <Alacarte />\n  {:else if $globalOptions.v === 'confeleve'}\n    <ConfigEleve />\n  {:else if $globalOptions.v === 'amc'}\n    <Amc />\n  {:else if $globalOptions.v === 'moodle'}\n    <Moodle />\n  {:else if $globalOptions.v === 'anki'}\n    <Anki />\n  {:else if $globalOptions.v === 'pdf'}\n    <Pdf />\n  {:else if $globalOptions.v !== undefined}\n    <Start />\n  {/if}\n</div>\n\n{#if isDevMode()}\n  <dialog\n    id=\"notifDialog\"\n    class=\"rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  ></dialog>\n{/if}\n","import 'boxicons/css/boxicons.min.css'\nimport './app.css'\nimport { mount } from 'svelte'\nimport App from './components/App.svelte'\nimport './bugsnag'\nimport './modules/stats'\n\nconst app = mount(App, {\n  target: document.getElementById('appMathalea') as HTMLElement,\n})\n\nexport default app\n"],"file":"index-BB3ZcMz7.js"}