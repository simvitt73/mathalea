{"version":3,"file":"CM2N1D-1-BAhZUAep.js","sources":["../../src/exercices/CM2/CM2N1D-1.ts"],"sourcesContent":["import Decimal from 'decimal.js'\nimport DragAndDrop, { type Etiquette } from '../../lib/interactif/DragAndDrop'\nimport { handleAnswers } from '../../lib/interactif/gestionInteractif'\nimport { shuffle2tableaux } from '../../lib/outils/arrayOutils'\nimport { texNombre } from '../../lib/outils/texNombre'\nimport { context } from '../../modules/context'\nimport { gestionnaireFormulaireTexte, randint } from '../../modules/outils'\nimport Exercice from '../Exercice'\nimport { glossaire } from './CM2N1D-2'\nexport const titre = 'Décomposer un nombre entier'\nexport const interactifReady = true\nexport const interactifType = 'mathLive'\n\nexport const dateDeModifImportante = '24/09/2024'\n/**\n * Exercice modèle pour la nouvelle fonctionnalité de Drag&Drop\n * @author Jean-Claude Lhote\n\n*/\nexport const uuid = '6498e'\nexport const refs = {\n  'fr-fr': ['CM2N1D-1'],\n  'fr-2016': ['c3N10-0'],\n  'fr-ch': [],\n}\nclass DragAndDropNumerationEntiere extends Exercice {\n  dragAndDrops: DragAndDrop[]\n  nombreDeChiffresMin: number\n  morceaux!: string[][]\n  exposantMorceaux!: number[][]\n  constructor() {\n    super()\n    this.interactif = false\n    this.nombreDeChiffresMin = 4\n    this.nbQuestions = 4\n    this.sup = false // false pour des puissances de 10 en chiffres, true pour lettres\n    this.besoinFormulaireCaseACocher = [\n      'Puissance de 10 en chiffres/lettres',\n      false,\n    ]\n    this.besoinFormulaire2Texte = [\n      'Nombre de chiffres des nombres à décomposer',\n      'Nombre entre 4 et 9 séparés par des tirets',\n    ]\n    this.sup2 = '4-5-6'\n    this.besoinFormulaire4Texte = [\n      'Présence de zéro(s) ',\n      'Nombres séparés par des tirets :\\n1 : Sans zéro\\n2 : Avec un zéro\\n3 : Avec deux zéros consécutifs\\n4 : Mélange',\n    ]\n    this.sup4 = '4'\n    this.besoinFormulaire5CaseACocher = ['Décomposition désordonnée', false]\n    this.sup5 = false\n    this.dragAndDrops = []\n  }\n\n  nouvelleVersion() {\n    // Pour activer le mélange\n    const desordonne = this.sup5\n    const enLettre = this.sup\n    const presenceZeros = gestionnaireFormulaireTexte({\n      saisie: this.sup4,\n      min: 1,\n      max: 3,\n      defaut: 4,\n      melange: 4,\n      nbQuestions: this.nbQuestions,\n    })\n    // ça c'est pour éviter de ne pas pouvoir fabriquer les nombres.\n    const nombreDeChiffresMin = this.nombreDeChiffresMin\n    const nombreDeChiffres = gestionnaireFormulaireTexte({\n      saisie: this.sup2,\n      min: nombreDeChiffresMin,\n      max: 9,\n      defaut: nombreDeChiffresMin,\n      melange: 0,\n      nbQuestions: this.nbQuestions,\n    }).map(Number)\n    this.morceaux = []\n    this.exposantMorceaux = []\n    for (\n      let i = 0, cpt = 0, texte: string, texteCorr: string;\n      i < this.nbQuestions && cpt < 50;\n    ) {\n      texte = ''\n      texteCorr = ''\n      const nbChiffres = nombreDeChiffres[i]\n      let nombreStr = ''\n\n      this.morceaux[i] = []\n      this.exposantMorceaux[i] = []\n      const presenceDeZeros = Number(presenceZeros[i])\n\n      for (let k = 0; k < nbChiffres; k++) {\n        nombreStr += randint(1, 9, Array.from(nombreStr).map(Number)).toString()\n      }\n      if (presenceDeZeros > 1) {\n        const arrayFromNbr = Array.from(nombreStr).map(Number)\n        const indexOfZero = randint(1, arrayFromNbr.length - 2)\n        arrayFromNbr[indexOfZero] = 0\n        if (presenceDeZeros === 3) arrayFromNbr[indexOfZero + 1] = 0\n        nombreStr = arrayFromNbr.map(String).join('')\n      }\n      const nombre = new Decimal(nombreStr)\n      texte += `Décomposer le nombre $${texNombre(nombre, 0)}$ en complétant avec les ${enLettre ? 'adjectifs numéraux' : 'opérations'} qui conviennent ${enLettre ? '(unité(s) ou dizaine(s) ou centaine(s) ou ...)' : `($\\\\times 1 \\\\text{ ou }\\\\times 10 \\\\text{ ou }\\\\times 100 \\\\text{ ou }\\\\times ${texNombre(1000, 3)} \\\\text{ ou }\\\\ldots$)`}.<br>`\n      // texte += `$${texNombre(nombre, 0)}=`\n\n      texteCorr = `$${texNombre(nombre, 0)}=`\n      for (let k = 0; k < nbChiffres; k++) {\n        // on prépare la correction pour l'exo non interactif\n        this.morceaux[i][k] = nombreStr[k]\n        this.exposantMorceaux[i][k] = nbChiffres - 1 - k\n      }\n      if (desordonne) {\n        shuffle2tableaux(this.morceaux[i], this.exposantMorceaux[i])\n      }\n      let enonceATrous = `$${texNombre(nombre, 0)}=$ `\n      const etiquettes: Etiquette[] = []\n      const reponses = []\n      for (let e = 0; e < 7; e++) {\n        if (enLettre) {\n          etiquettes.push({\n            id: String(2 * e + 1),\n            contenu: glossaire[e][0],\n          })\n          if (e !== 3) {\n            etiquettes.push({\n              id: String(2 * e + 2),\n              contenu: glossaire[e][1],\n            })\n          }\n        } else {\n          etiquettes.push({\n            id: String(e + 1),\n            contenu: `$\\\\times ${texNombre(10 ** e, 0)}$`,\n          })\n        }\n      }\n      if (context.isHtml) {\n        for (let k = 0, indiceRectangle = 1; k < this.morceaux[i].length; k++) {\n          if (this.morceaux[i][k] !== '0') {\n            enonceATrous += `$${this.morceaux[i][k]}$%{rectangle${indiceRectangle}}$+$`\n            if (this.exposantMorceaux[i][k] === 3) {\n              reponses.push([\n                `rectangle${indiceRectangle++}`,\n                {\n                  value: enLettre\n                    ? String(2 * this.exposantMorceaux[i][k] + 1)\n                    : String(this.exposantMorceaux[i][k] + 1),\n                },\n              ])\n            } else {\n              const shift = Number(this.morceaux[i][k]) > 1 ? 1 : 0\n              reponses.push([\n                `rectangle${indiceRectangle++}`,\n                {\n                  value: enLettre\n                    ? String(2 * this.exposantMorceaux[i][k] + 1 + shift)\n                    : String(this.exposantMorceaux[i][k] + 1),\n                  options: { multi: false },\n                },\n              ])\n            }\n          }\n        }\n        const objetReponse = Object.fromEntries(reponses)\n        enonceATrous = `${enonceATrous.substring(0, enonceATrous.length - 3)}` // En fin de boucle on a ajouté un '+$' inutile, il faut le supprimer\n        const leDragAndDrop = new DragAndDrop({\n          exercice: this,\n          question: i,\n          etiquettes: [etiquettes],\n          consigne: `Remettre les étiquettes au bon endroit pour reconstituer le nombre $${texNombre(nombre, 0)}$`,\n          enonceATrous,\n        })\n        handleAnswers(this, i, objetReponse, { formatInteractif: 'dnd' })\n        texte += leDragAndDrop.ajouteDragAndDrop({\n          melange: true,\n          duplicable: false,\n        })\n        this.dragAndDrops[i] = leDragAndDrop // on stocke les instances de dragAndDrop dans l'exercice pour pouvoir accéder aux listeners à supprimer lors de la vérification.\n      } else {\n        texte += '\\n$'\n        for (let k = 0; k < this.morceaux[i].length; k++) {\n          if (this.morceaux[i][k] !== '0') {\n            texte += `(${this.morceaux[i][k]} \\\\ldots \\\\ldots \\\\ldots) +`\n          }\n        }\n        texte = `${texte.substring(0, texte.length - 2)}$`\n      }\n      for (let k = 0; k < this.morceaux[i].length; k++) {\n        if (this.morceaux[i][k] !== '0') {\n          texteCorr += enLettre\n            ? `${this.morceaux[i][k]}~\\\\text{${glossaire[this.exposantMorceaux[i][k]][Number(this.morceaux[i][k]) > 1 ? 1 : 0]}}+`\n            : `(${this.morceaux[i][k]}\\\\times ${texNombre(10 ** this.exposantMorceaux[i][k], 0)})+`\n        }\n      }\n      // texte = `${texte.substring(0, texte.length - 1)}$`\n      texteCorr = `${texteCorr.substring(0, texteCorr.length - 1)}$`\n      if (this.questionJamaisPosee(i, nombreStr)) {\n        this.listeQuestions[i] = texte\n        this.listeCorrections[i] = texteCorr\n        i++\n      }\n      cpt++\n    }\n  }\n}\nexport default DragAndDropNumerationEntiere\n"],"names":["titre","interactifReady","interactifType","dateDeModifImportante","uuid","refs","DragAndDropNumerationEntiere","Exercice","__publicField","desordonne","enLettre","presenceZeros","gestionnaireFormulaireTexte","nombreDeChiffresMin","nombreDeChiffres","i","cpt","texte","texteCorr","nbChiffres","nombreStr","presenceDeZeros","k","randint","arrayFromNbr","indexOfZero","nombre","Decimal","texNombre","shuffle2tableaux","enonceATrous","etiquettes","reponses","glossaire","context","indiceRectangle","shift","objetReponse","leDragAndDrop","DragAndDrop","handleAnswers"],"mappings":"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"}