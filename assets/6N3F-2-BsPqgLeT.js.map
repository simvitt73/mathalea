{"version":3,"file":"6N3F-2-BsPqgLeT.js","sources":["../../src/exercices/6e/6N3F-2.ts"],"sourcesContent":["import { ComputeEngine } from '@cortex-js/compute-engine'\nimport Figure from 'apigeom'\nimport type { MathfieldElement } from 'mathlive'\nimport handleApigeomFigureElement from '../../lib/apigeom/apigeom-figure'\nimport { KeyboardType } from '../../lib/interactif/claviers/keyboard'\nimport { generateCleaner } from '../../lib/interactif/comparisonFunctions'\nimport { remplisLesBlancs } from '../../lib/interactif/questionMathLive'\nimport { shuffle } from '../../lib/outils/arrayOutils'\nimport { context } from '../../modules/context'\nimport FractionEtendue from '../../modules/FractionEtendue'\nimport {\n  gestionnaireFormulaireTexte,\n  listeQuestionsToContenu,\n  randint,\n} from '../../modules/outils'\nimport Exercice from '../Exercice'\n\nexport const titre =\n  \"D√©composer une fraction (partie enti√®re + fraction inf√©rieure √† 1) puis donner l'√©criture d√©cimale\"\nexport const interactifReady = true\nexport const interactifType = 'custom'\nexport const dateDeModifImportante = '24/01/2024' // Brouillon interactif\n\n/**\n * D√©composer une fraction (partie enti√®re + fraction inf√©rieure √† 1) puis donner l'√©criture d√©cimale.\n * @author R√©mi Angot\n */\nexport const uuid = 'ab44e'\n\nexport const refs = {\n  'fr-fr': ['6N3F-2', '3AutoN06-2'],\n  'fr-2016': ['6N20-2'],\n  'fr-ch': ['9NO11-2'],\n}\n\nconst ce = new ComputeEngine()\n\nexport default class ExerciceFractionsDifferentesEcritures extends Exercice {\n  reponsesAttendues: {\n    entier: number\n    numPartieDecimale: number\n    den: number\n    ecritureDecimale: string\n  }[] = []\n\n  constructor() {\n    super()\n    this.consigne =\n      \"√âcrire sous la forme de la somme d'un nombre entier et d'une fraction inf√©rieure √† 1 puis donner l'√©criture d√©cimale.\"\n    this.spacing = 2\n    this.spacingCorr = 2\n    this.sup = '2-4-4-5-5-5-8-8-10-10-10-10'\n    this.sup2 = true\n\n    this.besoinFormulaireTexte = [\n      'D√©nominateurs √† choisir',\n      'Nombres s√©par√©s par des tirets :\\n2: demis\\n4: quarts\\n5: cinqui√®mes\\n8: huiti√®mes\\n10: dixi√®mes\\n11: M√©lange',\n    ]\n    this.exoCustomResultat = true // Permet de mettre chaque question sur 2 points\n    this.besoinFormulaire2CaseACocher = ['Brouillon interactif']\n    this.besoinFormulaire3CaseACocher = [\n      'Avec la valeur d√©cimale √† la fin',\n      true,\n    ]\n    this.sup3 = true\n  }\n\n  nouvelleVersion(): void {\n    const listeDenominateurs = gestionnaireFormulaireTexte({\n      saisie: this.sup as string,\n      min: 2,\n      max: 10,\n      defaut: 11,\n      melange: 11,\n      nbQuestions: this.nbQuestions,\n      exclus: [3, 6, 7, 9],\n    }) as number[]\n    this.consigne = this.sup3\n      ? \"√âcrire sous la forme de la somme d'un nombre entier et d'une fraction inf√©rieure √† 1 puis donner l'√©criture d√©cimale.\"\n      : \"√âcrire sous la forme de la somme d'un nombre entier et d'une fraction inf√©rieure √† 1.\"\n\n    if (this.sup2 && context.isHtml) {\n      const figure = new Figure({\n        xMin: -0.5,\n        yMin: -2,\n        width: 800,\n        height: 120,\n      })\n      figure.options.automaticUserMessage = false\n      figure.options.color = 'blue'\n      figure.create('RectangleFractionDiagram', {\n        denominator: 2,\n        numberOfRectangles: 5,\n      })\n      handleApigeomFigureElement()\n      this.introduction = `<apigeom-figure interactive default-action='FILL' x-min=${figure.xMin} y-min=${figure.yMin} width=${figure.width} height=${figure.height} numero-exercice=${this.numeroExercice} index=0 auto-index><script type=\"application/json\">${figure.json}</script></apigeom-figure>`\n    } else {\n      this.introduction = ''\n    }\n\n    const fractions: [number, number, string][] = []\n    const nbDenominateursDifferents: number = new Set(listeDenominateurs).size\n    const aleaMax = Math.ceil(this.nbQuestions / nbDenominateursDifferents)\n    const fractionsUsed: { [id: number]: number[] } = {}\n    for (let i = 0; i < this.nbQuestions; i++) {\n      const b: number = listeDenominateurs[i]\n      if (!fractionsUsed[b])\n        fractionsUsed[b] = shuffle(\n          Array.from({ length: b - 1 }, (_, i) => i + 1),\n        ) // tous les num√©rateurs possibles...\n      const num: number = fractionsUsed[b].pop() ?? 1 // choisi un num√©rateur au hasard\n      let partieDecimale: string = ((num * 1000) / b).toString() // avec les 8e on a 3 chiffres, avec les 4 2...\n      partieDecimale = ',' + (partieDecimale.match(/[1-9]+/g)?.[0] ?? '')\n      fractions.push([num, b, partieDecimale])\n    }\n    shuffle(fractions)\n    for (\n      let i = 0,\n        cpt = 0,\n        num: number,\n        ecriDec: string,\n        den: number,\n        numPartieFrac: number,\n        entier: number,\n        texte: string,\n        texteCorr: string;\n      i < this.nbQuestions && cpt < 100;\n      cpt++\n    ) {\n      numPartieFrac = fractions[i][0]\n      den = fractions[i][1]\n      entier = randint(1, aleaMax)\n      num = entier * den + numPartieFrac\n      ecriDec = entier.toString() + fractions[i][2]\n      const frac = new FractionEtendue(num, den)\n      const partieFrac = new FractionEtendue(numPartieFrac, den)\n\n      texte =\n        '$ ' +\n        frac.texFraction +\n        ' = \\\\phantom{00}\\\\text{........}\\\\phantom{00} + ' +\n        '\\\\dfrac{\\\\phantom{00}\\\\text{........}\\\\phantom{00}}{\\\\phantom{00}\\\\text{........}\\\\phantom{00}}' +\n        (this.sup3 ? ' =  $' : '$')\n      texteCorr =\n        '$ ' +\n        frac.texFraction +\n        ' = ' +\n        entier +\n        '+' +\n        partieFrac.texFraction +\n        ' = ' +\n        ecriDec +\n        ' $'\n      this.reponsesAttendues[i] = {\n        entier,\n        numPartieDecimale: numPartieFrac,\n        den,\n        ecritureDecimale: ecriDec.replace(',', '.'),\n      }\n\n      if (this.interactif) {\n        texte = this.sup3\n          ? remplisLesBlancs(\n              this,\n              i,\n              `${frac.texFraction} =~%{n} + \\\\dfrac{%{num}}{%{den}} =~%{ecritureDecimale}`,\n              KeyboardType.clavierNumbers,\n            )\n          : remplisLesBlancs(\n              this,\n              i,\n              `${frac.texFraction} =~%{n} + \\\\dfrac{%{num}}{%{den}}`,\n              KeyboardType.clavierNumbers,\n            )\n      }\n      if (this.questionJamaisPosee(i, num, den)) {\n        // Si la question n'a jamais √©t√© pos√©e, on en cr√©e une autre\n        this.listeQuestions[i] = texte\n        this.listeCorrections[i] = texteCorr\n        i++\n      }\n    }\n    listeQuestionsToContenu(this) // Espacement de 2 em entre chaque question.\n  }\n\n  correctionInteractive = (i?: number) => {\n    if (i === undefined) return ''\n    if (this.answers === undefined) this.answers = {}\n    const result: ('OK' | 'KO')[] = []\n    const mf = document.querySelector(\n      `#champTexteEx${this.numeroExercice}Q${i}`,\n    ) as MathfieldElement\n    if (mf === null) return ''\n    const { entier, numPartieDecimale, den, ecritureDecimale } =\n      this.reponsesAttendues[i]\n    this.answers[`Ex${this.numeroExercice}Q${i}`] = mf.getValue()\n    const spanResultat = document.querySelector(\n      `#resultatCheckEx${this.numeroExercice}Q${i}`,\n    ) as HTMLDivElement\n    const clean = generateCleaner(['virgules'])\n    const nSaisi = Number(clean(mf.getPromptValue('n')))\n    const test1 = nSaisi === entier\n    const numSaisi = Number(clean(mf.getPromptValue('num')))\n    const denSaisi = Number(clean(mf.getPromptValue('den')))\n    const valeurDecimale = this.sup3\n      ? clean(mf.getPromptValue('ecritureDecimale'))\n      : null\n\n    const test2 =\n      denSaisi !== 0 &&\n      Number.isInteger(denSaisi) &&\n      Number.isInteger(numSaisi) &&\n      new FractionEtendue(numPartieDecimale, den).isEqual(\n        new FractionEtendue(numSaisi, denSaisi),\n      )\n\n    const test3 = this.sup3\n      ? ce\n          .parse(String(valeurDecimale))\n          .isEqual(ce.parse(`${clean(ecritureDecimale)}`))\n      : true\n    let feedback: string\n    if (test1 && test2 && test3) {\n      spanResultat.innerHTML = 'üòé'\n    } else {\n      spanResultat.innerHTML = '‚òπÔ∏è'\n    }\n    if (!test1) {\n      mf.setPromptState('n', 'incorrect', true)\n    } else {\n      mf.setPromptState('n', 'correct', true)\n    }\n    if (!test2) {\n      mf.setPromptState('num', 'incorrect', true)\n      mf.setPromptState('den', 'incorrect', true)\n    } else {\n      mf.setPromptState('num', 'correct', true)\n      mf.setPromptState('den', 'correct', true)\n    }\n    if (this.sup3) {\n      if (!test3) {\n        mf.setPromptState('ecritureDecimale', 'incorrect', true)\n      } else {\n        mf.setPromptState('ecritureDecimale', 'correct', true)\n      }\n    }\n    if (test1 && test2) {\n      feedback = 'D√©composition correcte, '\n      result.push('OK')\n    } else {\n      feedback = 'D√©composition fausse, '\n      result.push('KO')\n    }\n    if (this.sup3) {\n      if (test3) {\n        feedback += 'valeur d√©cimale exacte.'\n        result.push('OK')\n      } else {\n        feedback += 'valeur d√©cimale fausse.'\n        result.push('KO')\n      }\n    }\n    const divFeedback = document.querySelector(\n      `#feedbackEx${this.numeroExercice}Q${i}`,\n    )\n    if (divFeedback) divFeedback.innerHTML = feedback\n    return result\n  }\n}\n"],"names":["titre","interactifReady","interactifType","dateDeModifImportante","uuid","refs","ce","ComputeEngine","ExerciceFractionsDifferentesEcritures","Exercice","__publicField","result","mf","entier","numPartieDecimale","den","ecritureDecimale","spanResultat","clean","generateCleaner","test1","numSaisi","denSaisi","valeurDecimale","test2","FractionEtendue","test3","feedback","divFeedback","listeDenominateurs","gestionnaireFormulaireTexte","context","figure","Figure","handleApigeomFigureElement","fractions","nbDenominateursDifferents","aleaMax","fractionsUsed","i","b","shuffle","_","num","partieDecimale","_a","cpt","ecriDec","numPartieFrac","texte","texteCorr","randint","frac","partieFrac","remplisLesBlancs","KeyboardType","listeQuestionsToContenu"],"mappings":"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"}