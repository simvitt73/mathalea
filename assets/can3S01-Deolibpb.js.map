{"version":3,"file":"can3S01-Deolibpb.js","sources":["../../src/exercices/can/3e/can3S01.ts"],"sourcesContent":["import { KeyboardType } from '../../../lib/interactif/claviers/keyboard'\nimport { choice, shuffle } from '../../../lib/outils/arrayOutils'\nimport { miseEnEvidence } from '../../../lib/outils/embellissements'\nimport { fraction } from '../../../modules/fractions'\nimport { randint } from '../../../modules/outils'\nimport ExerciceSimple from '../../ExerciceSimple'\nexport const titre = 'Calculer une probabilité'\nexport const interactifReady = true\nexport const interactifType = 'mathLive'\nexport const amcReady = true\nexport const amcType = 'AMCNum'\n\n/**\n * @author Jean-Claude Lhote\n * Créé pendant l'été 2021\n\n*/\nexport const uuid = '47142'\n\nexport const refs = {\n  'fr-fr': ['can3S01', 'BP2FLUC15', '3AutoP01-2'],\n  'fr-ch': ['3mP-5'],\n}\nexport default class CalculProbaSimple extends ExerciceSimple {\n  constructor() {\n    super()\n\n    this.typeExercice = 'simple'\n    this.nbQuestions = 1\n    this.formatChampTexte = KeyboardType.clavierDeBaseAvecFraction\n    this.versionQcmDisponible = true\n  }\n\n  nouvelleVersion() {\n    const parfums = [\n      'au citron',\n      'à la fraise',\n      'à la menthe',\n      \"à l'orange\",\n      'à la cerise',\n      'à la framboise',\n      'au cassis',\n    ]\n\n    const situations = [\n      {\n        key: 'bonbons',\n        start: 'Un sachet de bonbons contient',\n        itemSing: 'bonbon',\n        itemPlur: 'bonbons',\n        type: 'flavour',\n        labels: parfums,\n      },\n      {\n        key: 'eleves',\n        start: 'On choisit au hasard un élève dans un groupe composé de',\n        itemSing: 'élève',\n        itemPlur: 'élèves',\n        type: 'fixed',\n        lab1Sing: 'fille',\n        lab1Plur: 'filles',\n        lab2Sing: 'garçon',\n        lab2Plur: 'garçons',\n      },\n      {\n        key: 'livres',\n        start: 'On choisit un livre au hasard sur un étal présentant',\n        itemSing: 'un livre',\n        itemPlur: '',\n        type: 'fixed',\n        lab1Sing: 'roman historique',\n        lab1Plur: 'romans historiques',\n        lab2Sing: 'thriller',\n        lab2Plur: 'thrillers',\n        lab3Sing: 'romance',\n        lab3Plur: 'romances',\n        lab4Sing: 'roman d\\'anticipation',\n        lab4Plur: 'romans d\\'anticipation',\n        lab5Sing: 'roman de fantasy',\n        lab5Plur: 'romans de fantasy',\n        lab6Sing: 'polar',\n        lab6Plur: 'polars',\n      },\n      {\n        key: 'films',\n        start: \"On choisit un film au hasard parmi ceux à l'affiche proposant\",\n        itemSing: 'un film',\n        itemPlur: '',\n        type: 'fixed',\n        lab1Sing: 'comédie',\n        lab1Plur: 'comédies',\n        lab2Sing: 'drame',\n        lab2Plur: 'drames',\n        lab3Sing: 'film d\\'action',\n        lab3Plur: 'films d\\'actions',\n        lab4Sing: 'film de science-fiction',\n        lab4Plur: 'films de science-fictions',\n        lab5Sing: 'thriller',\n        lab5Plur: 'thrillers',\n      },\n      {\n        key: 'urne',\n        start: 'On tire une boule au hasard dans une urne contenant',\n        itemSing: 'boule',\n        itemPlur: 'boules',\n        type: 'fixed',\n        lab1Sing: 'noire',\n        lab1Plur: 'noires',\n        lab2Sing: 'blanche',\n        lab2Plur: 'blanches',\n      },\n      {\n        key: 'cartes',\n        start: 'On tire une carte au hasard dans un paquet contenant',\n        itemSing: 'carte',\n        itemPlur: 'cartes',\n        type: 'fixed',\n        lab1Sing: 'rouge',\n        lab1Plur: 'rouges',\n        lab2Sing: 'verte',\n        lab2Plur: 'vertes',\n      },\n      {\n        key: 'tickets',\n        start: 'On choisit un ticket au hasard parmi',\n        itemSing: 'ticket',\n        itemPlur: 'tickets',\n        type: 'fixed',\n        lab1Sing: 'gagnant',\n        lab1Plur: 'gagnants',\n        lab2Sing: 'perdant',\n        lab2Plur: 'perdants',\n      },\n      {\n        key: 'billes',\n        start: 'On prend au hasard une bille dans un sac contenant',\n        itemSing: 'bille',\n        itemPlur: 'billes',\n        type: 'fixed',\n        lab1Sing: 'claire',\n        lab1Plur: 'claires',\n        lab2Sing: 'foncée',\n        lab2Plur: 'foncées',\n      },\n    ]\n\n    const situ = choice(situations)\n    const a = randint(3, 10)\n    const k = choice([3, 4, 9])\n\n    let label1Sing: string,\n      label2Sing: string,\n      label1Plur: string,\n      label2Plur: string\n    let displayLabel1: string, displayLabel2: string\n\n    if (situ.type === 'flavour' && Array.isArray((situ as any).labels)) {\n      // cas bonbons / livres / films : choisir deux étiquettes distinctes\n      const labels = (situ as any).labels as string[]\n      displayLabel1 = choice(labels)\n      do {\n        displayLabel2 = choice(labels)\n      } while (displayLabel2 === displayLabel1)\n      label1Sing = displayLabel1\n      label2Sing = displayLabel2\n      label1Plur = displayLabel1\n      label2Plur = displayLabel2\n    } else {\n      label1Sing = situ.lab1Sing ?? ''\n      label2Sing = situ.lab2Sing ?? ''\n      label1Plur = situ.lab1Plur ?? ''\n      label2Plur = situ.lab2Plur ?? ''\n      displayLabel1 = situ.lab1Sing ?? ''\n      displayLabel2 = situ.lab2Sing ?? ''\n    }\n\n    // choisir aléatoirement si la question porte sur la première ou la seconde étiquette\n    const ciblePremiere = choice([true, false])\n    const cibleLabelSing = ciblePremiere ? label1Sing : label2Sing\n\n    // construction d'une phrase naturelle pour la cible (heuristique)\n    const construitPhraseCible = (\n      situ: any,\n      itemSing: string,\n      labelSing: string,\n    ) => {\n      if (!labelSing) return ''\n      // si l'étiquette contient déjà un article ou une préposition appropriée -> l'utiliser telle quelle\n      if (/^(un |une |au |à |aux )/i.test(labelSing)) return labelSing\n      // pour les situations \"personnes\" ou types (élèves, livres, films) : préférer \"un/une + label\"\n      if (\n        ['eleves', 'livres', 'films', 'cartes', 'tickets'].includes(situ.key)\n      ) {\n        // heuristique simple pour l'article : mot finissant par 'e' ou commençant par voyelle => 'une' sinon 'un'\n        const article =\n          /^[aeiouàéèùyâêîôûh]/i.test(labelSing) || /e$/i.test(labelSing)\n            ? 'une'\n            : 'un'\n        return `${article} ${labelSing}`\n      }\n      // sinon : utiliser \"un/une itemSing label\" (utile pour 'bille claire', 'bonbon au citron' ...)\n      const articleItem = /e$/.test(itemSing) ? 'une' : 'un'\n      return `${articleItem} ${itemSing} ${labelSing}`\n    }\n\n    const ciblePhrase = construitPhraseCible(\n      situ,\n      situ.itemSing,\n      cibleLabelSing,\n    )\n\n    // déterminer la bonne réponse selon que la cible soit la 1ère ou la 2ème étiquette\n    const numCorrect = ciblePremiere ? a : k * a\n    const denomTotal = a + k * a\n    const correctTexSimpl = fraction(\n      numCorrect,\n      denomTotal,\n    ).texFractionSimplifiee\n    this.reponse = `$${fraction(numCorrect, denomTotal).texFraction}$`\n\n    // Construction de l'énoncé en utilisant les formes plurielles pour les quantités\n    this.question = `${situ.start} $${a}$ ${situ.itemPlur} ${label1Plur} et $${k * a}$ ${situ.itemPlur} ${label2Plur}.<br>\n     On choisit ${situ.itemSing} au hasard. <br>\nQuelle est la probabilité de choisir ${ciblePhrase} ?`\n\n    this.correction = this.versionQcm\n      ? `Il y a en tout : $${a} + ${k * a} = ${denomTotal}$ ${situ.itemPlur}.<br>La probabilité de choisir ${ciblePhrase} est de $${miseEnEvidence(`\\\\dfrac{${numCorrect}}{${denomTotal}}`)}$.`\n      : `Il y a en tout : $${a} + ${k * a} = ${denomTotal}$ ${situ.itemPlur}.<br>La probabilité de choisir ${ciblePhrase} est de $${miseEnEvidence(`\\\\dfrac{${numCorrect}}{${denomTotal}}`)}$ ou $${miseEnEvidence(correctTexSimpl)}$.`\n\n    // Version QCM : distracteurs plausibles\n    if (this.versionQcm) {\n      const correctTex = correctTexSimpl\n      const candidates: string[] = []\n\n      // erreurs/alternatives courantes adaptées à la cible\n      // erreur plausible : confondre a*(k+1) avec a + k\n      candidates.push(fraction((k - 1) * a, k * a).texFraction)\n      // complémentaire (1 - p)\n      candidates.push(\n        fraction(denomTotal - (ciblePremiere ? k * a : a), k * a).texFraction,\n      )\n      // oublier le facteur k (si cible = 2ème étiquette on peut confondre num / a)\n      const otherNum = ciblePremiere ? k * a : a\n      candidates.push(fraction(otherNum, denomTotal).texFraction) // confondre les deux catégories\n      // erreurs arithmétiques courantes\n      /*  if (numCorrect > 1)\n        candidates.push(\n          fraction(numCorrect - 1, denomTotal).texFractionSimplifiee,\n        )\n      candidates.push(\n        fraction(numCorrect + 1, denomTotal).texFractionSimplifiee,\n      )\n*/\n      // filtrer, dédupliquer et retirer la bonne réponse, puis choisir 3 distracteurs\n      const uniq = Array.from(\n        new Set(candidates.filter((s) => s && s !== correctTex)),\n      )\n      const picked = shuffle(uniq).slice(0, 3)\n      this.distracteurs = picked.map((s) => `$${s}$`)\n    }\n\n    this.canEnonce = this.question // 'Compléter'\n    this.canReponseACompleter = ''\n  }\n}\n"],"names":["titre","interactifReady","interactifType","amcReady","amcType","uuid","refs","CalculProbaSimple","ExerciceSimple","KeyboardType","situ","choice","a","randint","k","label1Sing","label2Sing","label1Plur","label2Plur","displayLabel1","displayLabel2","labels","ciblePremiere","cibleLabelSing","ciblePhrase","itemSing","labelSing","numCorrect","denomTotal","correctTexSimpl","fraction","miseEnEvidence","correctTex","candidates","otherNum","uniq","s","picked","shuffle"],"mappings":"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"}