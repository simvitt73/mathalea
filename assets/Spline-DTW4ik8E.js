var q=Object.defineProperty;var V=h=>{throw TypeError(h)};var R=(h,e,t)=>e in h?q(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var m=(h,e,t)=>R(h,typeof e!="symbol"?e+"":e,t),B=(h,e,t)=>e.has(h)||V("Cannot "+t);var F=(h,e,t)=>e.has(h)?V("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(h):e.set(h,t);var p=(h,e,t)=>(B(h,e,"access private method"),t);import{D as H}from"./vendors/decimal.js-BceHFVC1.js";import{F as P,O as w,T as N,p as j,r as S}from"./index-Dkwu26bg.js";import{c as A}from"./utilitairesGeometriques-rO8Jz15i.js";import{O as k}from"./ObjetMathalea2D-CXcNXRpD.js";import{p as J}from"./PointAbstrait-Cz1GEocE.js";import{t as K}from"./TracePoint-bp5vgHPG.js";import{f as C,v as Q,a as U}from"./etudeFonction-C2QDaGEe.js";import{m as W,M as Z}from"./Matrice-C8tN7fhJ.js";import{P as I,c as _}from"./Polynome-Dr039A6U.js";import{f as v,v as z}from"./vendors/mathjs-DKCMnljp.js";const M=(h,e)=>Number((h*e).toFixed(1)),D=(h,e)=>Number((-h*e).toFixed(1));class ee extends k{constructor({xStart:t=0,yStart:i=0,listeOfTriplets:s=[[[1,1],[-1,-1],[1,1]]],color:r="black",epaisseur:n=2,opacite:o=1}){super();m(this,"xStart");m(this,"yStart");m(this,"listeOfTriplets");this.color=A(r),this.opacite=o,this.epaisseur=n,this.xStart=t,this.yStart=i,this.listeOfTriplets=s}svg(t){let i=`<path fill="none" stroke="${this.color[0]}" stroke-width=${this.epaisseur} d="M${M(this.xStart,t)},${D(this.yStart,t)} c`;for(const s of this.listeOfTriplets)i+=`${M(s[0][0],t)},${D(s[0][1],t)} ${M(s[1][0],t)},${D(s[1][1],t)} ${M(s[2][0],t)},${D(s[2][1],t)} `;return i+=`" />
`,i}tikz(){let t=`
	\\draw[color = ${this.color[1]},line width = ${this.epaisseur}, opacity = ${this.opacite}](${this.xStart},${this.yStart})`,i=this.xStart,s=this.yStart;for(const r of this.listeOfTriplets){const n=i+r[2][0],o=s+r[2][1],c=r[1][0]-r[2][0],u=r[1][1]-r[2][1];t+=` .. controls +(${r[0][0].toFixed(2)},${r[0][1].toFixed(2)}) and +(${c.toFixed(2)},${u.toFixed(2)})  .. (${n.toFixed(2)},${o.toFixed(2)})
`,i=n,s=o}return t+=`;
`,t}}function de(h,e,t=-12/2,i=0,s=2){const r=[],n=e;let o=i,c=Math.cos(Math.random()*Math.PI)*S(1,2);for(let u=t;u<-t+1;u+=s){const x=o;r.push({x:u,y:o,deriveeGauche:c,deriveeDroit:c,isVisible:n});do o=o+j([-1,1])*S(1,2);while(o>5||o<-5);do c=Math.cos(Math.random()*Math.PI)*S(0,2);while(c*(o-x)<0)}return r}var f,O,y;const G=class G{constructor(e){F(this,f);m(this,"n");m(this,"polys");m(this,"nbPointsForApiGeom");m(this,"noeuds");m(this,"x");m(this,"y");m(this,"visibles");m(this,"fonctions");if(this.polys=[],this.x=[],this.y=[],this.noeuds=[],this.visibles=[],this.nbPointsForApiGeom=100,this.fonctions=[],(e==null||!Array.isArray(e)||e.length<2)&&(window.notify("Spline : nombre de noeuds insuffisant",{noeuds:e}),e=[{x:-3,y:-5,deriveeGauche:0,deriveeDroit:2,isVisible:!1},{x:3,y:0,deriveeGauche:-2,deriveeDroit:-2,isVisible:!1}]),!te(e)){this.n=e.length,window.notify("Il y a un problème avec ces noeuds (peut-être un doublon ?) ",{noeuds:e});return}this.n=e.length;for(let t=0;t<e.length-1;t++){const i=e[t].x,s=e[t].y,r=e[t].deriveeDroit,n=e[t+1].x,o=e[t+1].y,c=e[t+1].deriveeGauche,u=W([[i**3,i**2,i,1],[n**3,n**2,n,1],[3*i**2,2*i,1,0],[3*n**2,2*n,1,0]]);if(s+(n-i)*c===o&&r===c){const x=(o-s)/(n-i),b=s-x*i;this.polys.push(new I({coeffs:[b,x,0,0]}))}else if(u!=null){if(u.determinant()===0){window.notify("Spline : impossible de trouver un polynome ici car la matrice n'est pas inversible, il faut revoir vos noeuds : ",{noeudGauche:e[t],noeudDroit:e[t+1]});return}const x=u.inverse();if(x!=null){const b=[s,o,r,c],l=x.multiply(b);if(l!=null)this.polys.push(new I({useFraction:!0,coeffs:(l instanceof Z?l.toArray():l).reverse().map(a=>Number(Number(a).toFixed(6)))}));else{window.notify("Spline : impossible de trouver un polynome ici car la matrice n'est pas inversible, il faut revoir vos noeuds : ",{noeudGauche:e[t],noeudDroit:e[t+1]});return}}}}this.noeuds=[...e],this.n=this.noeuds.length,this.x=this.noeuds.map(t=>t.x),this.y=this.noeuds.map(t=>t.y),this.visibles=this.noeuds.map(t=>t.isVisible),this.n=this.y.length,this.fonctions=p(this,f,O).call(this)}get image(){return this.fonction}pointsOfSpline(e){const t=[],i=(this.x[this.x.length-1]-this.x[0])/this.nbPointsForApiGeom;let s=this.x[0];do t.push(e.create("Point",{x:s,y:p(this,f,y).call(this,s),isVisible:!1})),s+=i;while(s<=this.x[this.x.length-1]);return t.push(e.create("Point",{x:this.x[this.x.length-1],y:p(this,f,y).call(this,this.x[this.x.length-1]),isVisible:!1})),t}add(e,t){if(this.n!==e.n||this.x.filter(s=>e.x.includes(s)).length!==this.n)throw Error("Veuillez vous assurer de donner deux splines compatibles");const i=[];for(let s=0;s<this.n;s++){const r=this.x[s],n=this.y[s]+(t?-1:1)*e.y[s],o=this.noeuds[s].deriveeGauche+(t?-1:1)*e.noeuds[s].deriveeGauche,c=this.noeuds[s].deriveeDroit+(t?-1:1)*e.noeuds[s].deriveeDroit,u=this.noeuds[s].isVisible&&e.noeuds[s].isVisible;i.push({x:r,y:n,deriveeGauche:o,deriveeDroit:c,isVisible:u})}return new G(i)}zeros(e=1){const t=[];for(let i=this.x[0];i<this.x[this.n-1];i+=.5)if(p(this,f,y).call(this,i)*p(this,f,y).call(this,i+.5)<0){const{root:s}=C(this.fonction,i,i+.5,1e-9,100);s!=null&&t.push(v(s,e))}else p(this,f,y).call(this,i)===0&&t.push(v(i,e)),p(this,f,y).call(this,i+.5)===0&&t.push(v(i+.5,e));return Array.from(new Set(t).values())}solve(e,t=2){const i=e;if(e=Number(e),isNaN(e))window.notify(`Spline.solve() a reçu un truc bizarre à la place d'un nombre : ${i} !`,{valeurArgument:i});else{const s=[];for(let r=0;r<this.polys.length;r++){const n=this.polys[r].add(-e);try{const[o,c,u,x]=n.monomes.map(Number),b=n.useFraction?z(o,c,u,x):z(o,c,u,x);for(const l of b){let a;if(typeof l=="number")a=v(l,t);else if(l.toPolar().r<10**(-t-4))a=0;else{const g=l.toPolar().phi;Math.abs(g)<.001||Math.abs(Math.abs(g)-Math.PI)<.001?a=v(l.re,t):a=null}a!==null&&a>=this.x[r]&&a<=this.x[r+1]&&(s.includes(a)||s.push(a))}}catch(o){const c=o instanceof Error?o.message:String(o);window.notify("Erreur dans Spline.solve()"+c,{valeur_de_y:e})}}return s}}variations(e=new P(1,100)){return Q(this.derivee,this.noeuds[0].x,this.noeuds[this.n-1].x)}signes(){const e=[],t=this.zeros(1);let i;if(t.length===0)return[{xG:this.x[0],xD:this.x[this.n-1],signe:this.y[0]>0?"+":"-"}];this.x[0]!==t[0]&&e.push({xG:this.x[0],xD:t[0],signe:this.y[0]>0?"+":"-"}),i=t[0],e.push({xG:t[0],xD:t[0],signe:"z"});for(let r=1;r<t.length;r++){const n=p(this,f,y).call(this,(i+t[r])/2);e.push({xG:i,xD:t[r],signe:n>0?"+":"-"}),e.push({xG:t[r],xD:t[r],signe:"z"}),i=t[r]}if(t[t.length-1]===this.x[this.n-1])return e;const s=p(this,f,y).call(this,(t[t.length-1]+this.x[this.n-1])/2);return e.push({xG:t[t.length-1],xD:this.x[this.n-1],signe:s>0?"+":"-"}),e}tableauSignes(e="x",t="f(x)"){const i=this.signes(),s=[];for(let n=0;n<i.length;n++)n===0&&s.push(w(i[0].xG,2),10),n>0&&i[n].xG!==i[n-1].xG&&s.push(w(i[n].xG,2),10);i[i.length-1].xD!==i[i.length-1].xG&&s.push(w(i[i.length-1].xD,2),10);const r=["Line",30];N(p(this,f,y).call(this,this.x[0]),0)||r.push("",10);for(let n=0;n<i.length;n++)r.push(i[n].signe,10);return U({tabInit:[[[e,2,10],[t,2,10]],s],tabLines:[r],espcl:3.5,deltacl:.8,lgt:8})}nombreAntecedentsEntiers(e){const t=this.solve(e);return((t==null?void 0:t.filter(s=>Number.isInteger(s)))??[]).length}nombreAntecedents(e){const t=this.solve(e);return(t==null?void 0:t.length)??0}nombreAntecedentsMaximum(e,t,i=!0,s=!0){let r=0;for(let n=e;n<t;n+=i?1:.1)s?r=Math.max(r,this.nombreAntecedentsEntiers(n)):r=Math.max(r,this.nombreAntecedents(n));return r}trouveYPourNAntecedents(e,t,i,s=!0,r=!0){const n=[];if(Number.isInteger(t)&&Number.isInteger(i))if(s)for(let o=t;o<=i;o++)(r&&this.nombreAntecedentsEntiers(o)===e&&this.nombreAntecedents(o)===e||!r&&this.nombreAntecedents(o)===e)&&n.push(o);else for(let o=t;o<=i;o+=.1)(r&&this.nombreAntecedentsEntiers(o)===e&&this.nombreAntecedents(o)===e||!r&&this.nombreAntecedents(o)===e)&&n.push(o);else window.notify("trouveYPourNAntecedentsEntiers() appelé avec des valeurs incorrectes",{n:e,yMin:t,yMax:i});return n.length<1?!1:j(n)}trouveMaxes(){if(Array.isArray(this.noeuds)&&this.noeuds.length>0){const e=Math.ceil(Math.min(...this.noeuds.map(r=>r.x))),t=Math.ceil(Math.min(...this.noeuds.map(r=>r.y))),i=Math.floor(Math.max(...this.noeuds.map(r=>r.x))),s=Math.floor(Math.max(...this.noeuds.map(r=>r.y)));return{xMin:e,xMax:i,yMin:t,yMax:s}}else return window.notify("Spline.trouveMaxes() on demande ça alors que la Spline n'a pas de noeuds !",{laSpline:JSON.stringify(this)}),{xMin:0,xMax:0,yMin:0,yMax:0}}amplitude(){let e=1e3,t=-1e3;for(let i=0;i<this.x.length-1;i++){const{minLocal:s,maxLocal:r}=_({poly:this.polys[i],xG:this.x[i],xD:this.x[i+1]});e=Math.min(e,s),t=Math.max(t,r)}return{yMin:e,yMax:t}}get fonction(){return e=>p(this,f,y).call(this,e)}get derivees(){const e=[];for(let t=0;t<this.polys.length;t++)e.push(this.polys[t].derivee());return e}get derivee(){const e=[];for(let t=0;t<this.noeuds.length-1;t++)e.push({xG:this.noeuds[t].x,xD:this.noeuds[t+1].x});return t=>{const i=e.findIndex(s=>t>=s.xG&&t<=s.xD);return this.derivees[i].image(t)}}get splineDerivee(){const e=[];for(const t of this.noeuds)e.push({x:t.x,y:t.deriveeGauche,deriveeGauche:0,deriveeDroit:0,isVisible:t.isVisible});return new G(e)}courbe({color:e="black",epaisseur:t=1,ajouteNoeuds:i=!1,optionsNoeuds:s={}}={}){return new ie(this,{color:e,epaisseur:t,ajouteNoeuds:i,optionsNoeuds:s})}};f=new WeakSet,O=function(){const e=[];for(let t=0;t<this.n-1;t++)e.push(this.polys[t].fonction);return e},y=function(e){typeof e!="number"&&(e instanceof P?e=e.valeurDecimale:e instanceof H&&(e=e.toNumber()));const t=e;let i=!1,s=0;for(let r=0;r<this.n-1;r++)if(t>=this.x[r]&&t<=this.x[r+1]){s=r,i=!0;break}if(i)return this.fonctions[s](t);{const r=`D = [${this.x[0]} ; ${this.x[this.n-1]}]`;return window.notify("Spline: la valeur de x fournie n'est pas dans lìntervalle de définition de la fonction",{x:e,intervalle:r}),NaN}};let $=G;function me(h){return new $(h)}function te(h){let e,t,i,s,r;for(let n=0;n<h.length-1;n++)for(let o=n+1;o<h.length;o++)if(h[n].x>h[o].x)e=h[n].x,t=h[n].y,i=h[n].deriveeGauche,s=h[n].deriveeDroit,r=h[n].isVisible,h[n].x=h[o].x,h[n].y=h[o].y,h[n].deriveeGauche=h[o].deriveeGauche,h[n].deriveeDroit=h[o].deriveeDroit,h[n].isVisible=h[o].isVisible,h[o].x=e,h[o].y=t,h[o].deriveeGauche=i,h[o].deriveeDroit=s,h[o].isVisible=r;else if(N(h[n].x,h[o].x))return!1;return!0}class ie extends k{constructor(e,{color:t="black",epaisseur:i=2,opacite:s=1,ajouteNoeuds:r=!0,optionsNoeuds:n={}}){super(),this.objets=[];const{xMin:o,xMax:c,yMin:u,yMax:x}=e.trouveMaxes();this.bordures=[o,u,c,x];const b=[];for(let l=0;l<e.n-1;l++){const a=e.x[l+1]-e.x[l],d=e.y[l+1]-e.y[l],g=a/3,E=e.noeuds[l].deriveeDroit*a/3,L=2*a/3,T=d-e.noeuds[l+1].deriveeGauche*a/3,Y=a,X=d;b.push([[g,E],[L,T],[Y,X]])}if(this.objets.push(new ee({xStart:e.x[0],yStart:e.y[0],listeOfTriplets:b,color:t,epaisseur:i,opacite:s})),r){for(let l=0;l<e.n;l++)if(e.visibles[l]){const a=J(e.x[l],e.y[l]),d=K(a);n&&(n.color&&(d.color=A(n.color),d.couleurDeRemplissage=A(n.color)),n.epaisseur&&(d.epaisseur=n.epaisseur),n.style&&(d.style=n.style),n.taille&&(d.taille=n.taille)),this.objets.push(d)}}this.svg=function(l){let a="";if(this.objets==null)return a;for(const d of this.objets)a+=`
	`+d.svg(l);return a},this.tikz=function(){let l="";if(this.objets==null)return l;for(const a of this.objets)l+=a.tikz();return l}}}export{$ as S,de as n,me as s,te as t};
//# sourceMappingURL=Spline-DTW4ik8E.js.map
