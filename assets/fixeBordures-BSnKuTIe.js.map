{"version":3,"file":"fixeBordures-BSnKuTIe.js","sources":["../../src/lib/2d/fixeBordures.ts"],"sourcesContent":["/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%% LES FONCTIONS - FORMATAGE %%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n\nimport type { NestedObjetMathalea2dArray, ObjetDivLatex } from '../../types/2d'\nimport type { ObjetMathalea2D } from './ObjetMathalea2D'\n\n/**\n * codeSvg(segment(A,B),polygone(D,E,F),labelPoints(A,B))\n *\n * @author Rémi Angot\n * @private\n */\n// JSDOC Validee par EE Juin 2022\n/* Ce code n'est plus utilisé : il l'était dans l'éditeur 2d\n\nexport function codeSvg (fenetreMathalea2d, pixelsParCm, mainlevee, ...objets) {\n  let code\n  const fenetrexmin = fenetreMathalea2d[0]\n  const fenetreymin = -fenetreMathalea2d[3]\n  const fenetrexmax = fenetreMathalea2d[2]\n  const fenetreymax = -fenetreMathalea2d[1]\n\n  code = `<svg width=\"${(fenetrexmax - fenetrexmin) * pixelsParCm}\" height=\"${(fenetreymax - fenetreymin) * pixelsParCm}\" viewBox=\"${fenetrexmin * pixelsParCm} ${fenetreymin * pixelsParCm} ${(fenetrexmax - fenetrexmin) * pixelsParCm} ${(fenetreymax - fenetreymin) * pixelsParCm}\" xmlns=\"http://www.w3.org/2000/svg\">\\n`\n  for (const objet of objets) {\n    if (Array.isArray(objet)) {\n      for (let i = 0; i < objet.length; i++) {\n        try {\n          if (!mainlevee || typeof objet[i].svgml === 'undefined') { code += '\\t' + objet[i].svg(pixelsParCm) + '\\n' } else {\n            code += '\\t' + objet[i].svgml(pixelsParCm, context.amplitude) + '\\n'\n          }\n        } catch (error) {\n          console.log(error.message)\n        }\n      }\n    }\n    try {\n      if (!mainlevee || typeof objet.svgml === 'undefined') { code += '\\t' + objet.svg(pixelsParCm) + '\\n' } else code += '\\t' + objet.svgml(pixelsParCm, context.amplitude) + '\\n'\n    } catch (error) {\n      console.log(error.message)\n    }\n  }\n  code += '</svg>'\n  return code\n}\n*/\n\n/**\n * codeTikz(segment(A,B),polygone(D,E,F),labelPoints(A,B))\n *\n * @author Rémi Angot\n * @private\n */\n/* Ce code n'est plus utilisé : il l'était dans l'éditeur 2d\n// JSDOC Validee par EE Juin 2022\nexport function codeTikz (fenetreMathalea2d, scale, mainlevee, ...objets) {\n  let code = ''\n  const fenetrexmin = fenetreMathalea2d[0]\n  const fenetreymin = fenetreMathalea2d[3] * -1\n  const fenetrexmax = fenetreMathalea2d[2]\n  const fenetreymax = fenetreMathalea2d[1] * -1\n  const sortie = context.isHtml\n\n  context.isHtml = false\n  if (scale === 1) {\n    code += '\\\\begin{tikzpicture}[baseline]\\n'\n  } else {\n    code += `\\\\begin{tikzpicture}[baseline,scale = ${scale.toFixed(2)}]\\n`\n  }\n  code += `\\\\tikzset{\n    point/.style={\n      thick,\n      draw,\n      cross out,\n      inner sep=0pt,\n      minimum width=5pt,\n      minimum height=5pt,\n    },\n  }\n  \\\\clip (${fenetrexmin},${fenetreymin}) rectangle (${fenetrexmax},${fenetreymax});\n\n  \\n\\n`\n\n  for (const objet of objets) {\n    if (Array.isArray(objet)) {\n      for (let i = 0; i < objet.length; i++) {\n        try {\n          if (!mainlevee || typeof objet[i].tikzml === 'undefined') { code += '\\t' + objet[i].tikz(scale) + '\\n' } else code += '\\t' + objet[i].tikzml(context.amplitude) + '\\n'\n        } catch (error) {\n          console.log(error.message)\n        }\n      }\n    }\n    try {\n      if (!mainlevee || typeof objet.tikzml === 'undefined') { code += '\\t' + objet.tikz(scale) + '\\n' } else code += '\\t' + objet.tikzml(context.amplitude) + '\\n'\n    } catch (error) {\n      console.log(error.message)\n    }\n  }\n  code += '\\\\end{tikzpicture}\\n'\n\n  context.isHtml = sortie\n  return code\n}\n*/\n\n/**\n * @param {object} options\n * @param {number} [options.rxmin] marge à gauche 0.5 par défaut (peut être fixée à 0 si on veut)\n * @param {number} [options.rxmax] marge à droite 0.5 par défaut\n * @param {number} [options.rymin] marge en bas 0.5 par défaut (peut être fixée à 0 si on veut)\n * @param {number} [options.rymax] marge en haut 0.5 par défaut\n * @param {number} [options.rzoom] facteur multiplicatif des marges... implémenté en cas de problème avec le zoom ?\n * @param {object} objets // tableau contenant les objets à afficher\n * Les objets affichables doivent avoir un attribut this.bordures = [xmin, ymin, xmax, ymax] 4 nombres dans cet ordre.\n * Si this.bordures n'est pas défini ou n'est pas un tableau de 4 éléments, l'objet est ignoré\n * Si aucun objet passé en argument n'a de \"bordures\" alors la fonction retourne une zone inaffichable et un message d'erreur est créé\n * @return {{xmin: number, ymin:number, xmax:number, ymax:number}}\n */\nexport function fixeBordures(\n  objets: NestedObjetMathalea2dArray,\n  { rxmin = -0.5, rymin = -0.5, rxmax = 0.5, rymax = 0.5, rzoom = 1 } = {},\n) {\n  /**\n   *\n   * @param{number} xmin\n   * @param{number} ymin\n   * @param{number} xmax\n   * @param{number} ymax\n   * @param objets\n   * @param bordures\n   * @returns {[number,number,number,number,boolean]}\n   */\n  const majBordures: (\n    xmin: number,\n    ymin: number,\n    xmax: number,\n    ymax: number,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray | ObjetDivLatex,\n    borduresTrouvees: boolean,\n  ) => [number, number, number, number, boolean] = (\n    xmin: number,\n    ymin: number,\n    xmax: number,\n    ymax: number,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray | ObjetDivLatex,\n    borduresTrouvees: boolean,\n  ) => {\n    if (objets == null) return [xmin, ymin, xmax, ymax, borduresTrouvees]\n    if (!Array.isArray(objets)) {\n      const bordures = objets.bordures ?? null\n      if (bordures === null || isNaN(bordures[0])) {\n        window.notify(\n          `Ìl y a un problème avec les bordures de ${objets.constructor.name}... elles ne sont pas définies !`,\n          { objets },\n        )\n      } else if (!Array.isArray(bordures)) {\n        window.notify(\n          `Les bordures de ${objets.constructor.name} ne sont pas un array : ${JSON.stringify(bordures)}`,\n          { ...objets },\n        )\n      } else if (bordures.filter((el) => isNaN(el)).length > 0) {\n        window.notify(\n          `Les bordures de ${objets.constructor.name} sont bien un array mais contiennent autre chose que des nombres : ${bordures}`,\n          { ...objets },\n        )\n      } else {\n        xmin = Math.min(xmin, bordures[0])\n        xmax = Math.max(xmax, bordures[2])\n        ymin = Math.min(ymin, bordures[1])\n        ymax = Math.max(ymax, bordures[3])\n        borduresTrouvees = true\n      }\n    } else {\n      for (const objet of objets) {\n        ;[xmin, ymin, xmax, ymax, borduresTrouvees] = majBordures(\n          xmin,\n          ymin,\n          xmax,\n          ymax,\n          objet,\n          borduresTrouvees,\n        )\n      }\n    }\n    return [xmin, ymin, xmax, ymax, borduresTrouvees]\n  }\n  let xmin = 1000\n  let ymin = 1000\n  let xmax = -1000\n  let ymax = -1000\n  let borduresTrouvees = false\n  ;[xmin, ymin, xmax, ymax, borduresTrouvees] = majBordures(\n    xmin,\n    ymin,\n    xmax,\n    ymax,\n    objets,\n    borduresTrouvees,\n  )\n  if (!borduresTrouvees) {\n    window.notify('fixeBordures : aucun objet ne définit de bordures valides', {\n      ...objets,\n    })\n  }\n  return {\n    xmin: xmin + rxmin * rzoom,\n    xmax: xmax + rxmax * rzoom,\n    ymin: ymin + rymin * rzoom,\n    ymax: ymax + rymax * rzoom,\n  }\n}\n"],"names":["fixeBordures","objets","rxmin","rymin","rxmax","rymax","rzoom","majBordures","xmin","ymin","xmax","ymax","borduresTrouvees","objet","bordures","el"],"mappings":"AAyHO,SAASA,EACdC,EACA,CAAE,MAAAC,EAAQ,IAAM,MAAAC,EAAQ,IAAM,MAAAC,EAAQ,GAAK,MAAAC,EAAQ,GAAK,MAAAC,EAAQ,CAAA,EAAM,CAAA,EACtE,CAWA,MAAMC,EAO2C,CAC/CC,EACAC,EACAC,EACAC,EACAV,EACAW,IACG,CACH,GAAIX,GAAU,KAAM,MAAO,CAACO,EAAMC,EAAMC,EAAMC,EAAMC,CAAgB,EACpE,GAAK,MAAM,QAAQX,CAAM,EAyBvB,UAAWY,KAASZ,EACjB,CAACO,EAAMC,EAAMC,EAAMC,EAAMC,CAAgB,EAAIL,EAC5CC,EACAC,EACAC,EACAC,EACAE,EACAD,CAAA,MAhCsB,CAC1B,MAAME,EAAWb,EAAO,UAAY,KAChCa,IAAa,MAAQ,MAAMA,EAAS,CAAC,CAAC,EACxC,OAAO,OACL,2CAA2Cb,EAAO,YAAY,IAAI,mCAClE,CAAE,OAAAA,CAAAA,CAAO,EAED,MAAM,QAAQa,CAAQ,EAKvBA,EAAS,OAAQC,GAAO,MAAMA,CAAE,CAAC,EAAE,OAAS,EACrD,OAAO,OACL,mBAAmBd,EAAO,YAAY,IAAI,sEAAsEa,CAAQ,GACxH,CAAE,GAAGb,CAAAA,CAAO,GAGdO,EAAO,KAAK,IAAIA,EAAMM,EAAS,CAAC,CAAC,EACjCJ,EAAO,KAAK,IAAIA,EAAMI,EAAS,CAAC,CAAC,EACjCL,EAAO,KAAK,IAAIA,EAAMK,EAAS,CAAC,CAAC,EACjCH,EAAO,KAAK,IAAIA,EAAMG,EAAS,CAAC,CAAC,EACjCF,EAAmB,IAdnB,OAAO,OACL,mBAAmBX,EAAO,YAAY,IAAI,2BAA2B,KAAK,UAAUa,CAAQ,CAAC,GAC7F,CAAE,GAAGb,CAAAA,CAAO,CAclB,CAYA,MAAO,CAACO,EAAMC,EAAMC,EAAMC,EAAMC,CAAgB,CAClD,EACA,IAAIJ,EAAO,IACPC,EAAO,IACPC,EAAO,KACPC,EAAO,KACPC,EAAmB,GACtB,OAACJ,EAAMC,EAAMC,EAAMC,EAAMC,CAAgB,EAAIL,EAC5CC,EACAC,EACAC,EACAC,EACAV,EACAW,CAAA,EAEGA,GACH,OAAO,OAAO,4DAA6D,CACzE,GAAGX,CAAA,CACJ,EAEI,CACL,KAAMO,EAAON,EAAQI,EACrB,KAAMI,EAAON,EAAQE,EACrB,KAAMG,EAAON,EAAQG,EACrB,KAAMK,EAAON,EAAQC,CAAA,CAEzB"}