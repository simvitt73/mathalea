import{e as te,d as de,c as H}from"./utilitairesGeometriques-rO8Jz15i.js";import{d as M}from"./droites-C34ydQPV.js";import{O as re}from"./ObjetMathalea2D-CXcNXRpD.js";import{a as E}from"./PointAbstrait-Cz1GEocE.js";import{p as _}from"./polygones-dllpvdk8.js";import{p as j}from"./Polyline-B90cPRFI.js";import{s as C,e as ie,a as N}from"./segmentsVecteurs-Dh5p_FwX.js";import{t as se}from"./TracePoint-CKJ0Npoo.js";import{v as D}from"./Vide2d-lYMmc9eB.js";import{c as le}from"./aleatoires-ztwldBFD.js";import{c as he,v as z,p as q,e as V,f as ne}from"./elementsEtTransformations3d-D23wu66d.js";const f=(I,L)=>Math.sqrt((L.x-I.x)**2+(L.y-I.y)**2);class ce extends re{constructor(L,k,R="red",F="blue",G=0,J="gray",K=0,U="gray",Y=!1,Z="black",m=0,w=!0){super(),this.centre=L,this.rayon=typeof k=="number"?k:k.norme,this.objets=[],this.colorEquateur=R,this.colorEnveloppe=F,this.nbParalleles=G,this.colorParalleles=J,this.nbMeridiens=K,this.colorMeridiens=U,this.affichageAxe=Y,this.colorAxe=Z;const y=he(q(this.centre.x,this.centre.y,this.centre.z),z(0,1,0)),P=V(q(this.centre.x,this.centre.y,this.centre.z+this.rayon,!0,le(1,"OQWX"+this.centre.label)[0],"left"),y,m),p=V(q(this.centre.x,this.centre.y,this.centre.z-this.rayon,!0,le(1,"OQWX"+this.centre.label+P.label)[0],"left"),y,m),a=36,oe=this.nbParalleles!==0?Math.round(2*a/this.nbParalleles):1;let A,Q,T,W;const e={listePoints3d:[],ptCachePremier:[],indicePtCachePremier:[],ptCacheDernier:[],indicePtCacheDernier:[]},$=[];let X=[],v=100,O=0,x=0;this.c2d=[],Q=V(q(this.centre.x,this.centre.y,this.centre.z+this.rayon*Math.sin((a-1)/a*Math.PI/2)),y,m),T=V(z(this.rayon*Math.cos((a-1)/a*Math.PI/2),0,0),y,m),W=V(z(0,0,1),y,m),A=ne(Q,W,T),e.listePoints3d.push(A[1]),e.ptCachePremier.push(E(0,0)),e.indicePtCachePremier.push(0),e.ptCacheDernier.push(E(0,0)),e.indicePtCacheDernier.push(0);for(let n=a-2,l,t=1;n>-a;n-=1){Q=V(q(this.centre.x,this.centre.y,this.centre.z+this.rayon*Math.sin(n/a*Math.PI/2)),y,m),T=V(z(this.rayon*Math.cos(n/a*Math.PI/2),0,0),y,m),W=V(z(0,0,1),y,m),l=_(A[2]),A=ne(Q,W,T,!1),e.listePoints3d.push(A[1]);for(let i=0;i<e.listePoints3d[0].length;i++)e.listePoints3d[t][i].isVisible=!te(e.listePoints3d[t][i].c2d,l);e.ptCachePremier.push(E(0,0)),e.indicePtCachePremier.push(0),e.ptCacheDernier.push(E(0,0)),e.indicePtCacheDernier.push(0);for(let i=0,d,s,r,c,o,b;i<e.listePoints3d[0].length;i++){const B=e.listePoints3d[t][i].c2d,h=e.listePoints3d[t][(i+1)%e.listePoints3d[0].length].c2d;if(d=f(B,h)<.001?D():C(B,h),!e.listePoints3d[t][i].isVisible&&e.listePoints3d[t][(i+1)%e.listePoints3d[0].length].isVisible){o=i-3,s=M(e.listePoints3d[t-1][(e.listePoints3d[0].length+o)%e.listePoints3d[0].length].c2d,e.listePoints3d[t-1][(e.listePoints3d[0].length+o-1)%e.listePoints3d[0].length].c2d);let g=0;for(;!d.estSecant(s)&&g<7;)o++,s=M(e.listePoints3d[t-1][(e.listePoints3d[0].length+o)%e.listePoints3d[0].length].c2d,e.listePoints3d[t-1][(e.listePoints3d[0].length+o-1)%e.listePoints3d[0].length].c2d),g++;if(g!==7){if(r=M(e.listePoints3d[t][i].c2d,e.listePoints3d[t][(i+1)%e.listePoints3d[0].length].c2d),c=M(e.listePoints3d[t-1][(e.listePoints3d[0].length+o)%e.listePoints3d[0].length].c2d,e.listePoints3d[t-1][(e.listePoints3d[0].length+o-1)%e.listePoints3d[0].length].c2d),b=ie(r,c),!b){window.notify("Erreur dans le calcul du point d'intersection entre d1 et d2",{d1:r,d2:c});continue}$.push(b),v>=t&&(v=t,O=o%e.listePoints3d[0].length),e.ptCachePremier[t]=b,e.indicePtCachePremier[t]=i}}else if(e.listePoints3d[t][i].isVisible&&!e.listePoints3d[t][(i+1)%e.listePoints3d[0].length].isVisible){o=i-3,s=M(e.listePoints3d[t-1][(e.listePoints3d[0].length+o)%e.listePoints3d[0].length].c2d,e.listePoints3d[t-1][(e.listePoints3d[0].length+o-1)%e.listePoints3d[0].length].c2d);let g=0;for(;!d.estSecant(s)&&g<7;)o++,s=M(e.listePoints3d[t-1][(e.listePoints3d[0].length+o)%e.listePoints3d[0].length].c2d,e.listePoints3d[t-1][(e.listePoints3d[0].length+o-1)%e.listePoints3d[0].length].c2d),g++;if(g!==7){if(r=M(e.listePoints3d[t][i].c2d,e.listePoints3d[t][(i+1)%e.listePoints3d[0].length].c2d),c=M(e.listePoints3d[t-1][(e.listePoints3d[0].length+o)%e.listePoints3d[0].length].c2d,e.listePoints3d[t-1][(e.listePoints3d[0].length+o-1)%e.listePoints3d[0].length].c2d),b=ie(r,c),!b){window.notify("Erreur dans le calcul du point d'intersection entre d1 et d2",{d1:r,d2:c});continue}X.push(b),v>=t&&(v=t,x=o),e.ptCacheDernier[t]=b,e.indicePtCacheDernier[t]=i}}}t++}if(this.nbParalleles!==0){let n=se(P.c2d,this.colorParalleles);n.style="o",n.taille=.5,this.c2d.push(n),n=se(p.c2d,de(this.colorParalleles,50)),n.style="o",n.taille=.5,this.c2d.push(n)}for(let n=a,l=-1;n>-a;n-=1){const t=[];let i=[];if((this.nbParalleles!==0||n===0)&&n!==a&&n%oe===0){for(let s=0;s<e.listePoints3d[0].length;s++)e.indicePtCachePremier[l]===s?i.push(e.ptCachePremier[l]):e.indicePtCacheDernier[l]===s?i.push(e.ptCacheDernier[l]):!e.listePoints3d[l][s].isVisible&&!e.listePoints3d[l][(s+1)%e.listePoints3d[0].length].isVisible?i.push(e.listePoints3d[l][s].c2d):t.push(e.listePoints3d[l][(s+1)%e.listePoints3d[0].length].c2d);if(n<36&&n>-30){let s=0;if(i.length>4)for(;s<10&&f(i[i.length-1],i[0])<1;){const r=i.pop();r&&(i=[E(r.x,r.y),...i]),s++}if(t.length>4)for(;s<20&&f(t[t.length-1],t[0])<1;){const r=t.shift();r&&t.push(E(r.x,r.y)),s++}}if(w){const s=i.length>0?j(...i):null;s&&n===0?(s.color=H(this.colorEquateur),s.epaisseur=1.5):s&&(s.color=H(this.colorParalleles)),w&&s&&(s.pointilles=4,s.opacite=.5,this.c2d.push(s))}const d=t.length>0?j(...t):null;d&&n===0?(d.color=H(this.colorEquateur),d.epaisseur=1.5):d&&(d.color=H(this.colorParalleles)),d&&this.c2d.push(d)}l++}if(this.nbMeridiens!==0){const n=Math.round(36/this.nbMeridiens);for(let l=0,t;l<18;l+=n){const i=[],d=[],s=[],r=[];for(let h=1;h<e.listePoints3d.length-1;h++)!e.listePoints3d[h][l].isVisible&&!e.listePoints3d[(h+1)%e.listePoints3d.length][l].isVisible?i.push(e.listePoints3d[h][l].c2d):d.push(e.listePoints3d[h][l].c2d),!e.listePoints3d[h][l+18].isVisible&&!e.listePoints3d[(h+1)%e.listePoints3d.length][l+18].isVisible?s.push(e.listePoints3d[h][l+18].c2d):r.push(e.listePoints3d[h][l+18].c2d);let c=P.c2d,o=e.listePoints3d[1][l].c2d;t=f(c,o)<.001?D():C(P.c2d,e.listePoints3d[1][l].c2d,this.colorMeridiens),this.c2d.push(t),c=e.listePoints3d[1][l+18].c2d,o=P.c2d,t=f(c,o)<.001?D():C(e.listePoints3d[1][l+18].c2d,P.c2d,this.colorMeridiens),this.c2d.push(t),c=p.c2d,o=e.listePoints3d[e.listePoints3d.length-1][l].c2d,t=f(c,o)<.001?D():C(p.c2d,e.listePoints3d[e.listePoints3d.length-1][l].c2d,this.colorMeridiens),w&&!e.listePoints3d[e.listePoints3d.length-1][0].isVisible?(t.pointilles=4,t.opacite=.5,this.c2d.push(t)):w&&this.c2d.push(t),c=e.listePoints3d[e.listePoints3d.length-1][l+18].c2d,o=p.c2d,t=f(c,o)<.001?D():C(e.listePoints3d[e.listePoints3d.length-1][l+18].c2d,p.c2d,this.colorMeridiens),w&&!e.listePoints3d[e.listePoints3d.length-1][l].isVisible?(t.pointilles=4,t.opacite=.5,this.c2d.push(t)):w&&this.c2d.push(t);const b=j(...d),B=j(...r);if(w){const h=j(...i),g=j(...s);h.pointilles=4,h.opacite=.5,g.pointilles=4,g.opacite=.5,this.c2d.push(h,g)}this.c2d.push(b,B)}}X=X.reverse();const S=[...$];let u=1;for(;(x+e.listePoints3d[0].length/2+u)%e.listePoints3d[0].length<(O+e.listePoints3d[0].length/2)%e.listePoints3d[0].length;)S.push(e.listePoints3d[2*a-1-v][(x+e.listePoints3d[0].length/2+u)%e.listePoints3d[0].length].c2d),u++;if(S.push(...X),x>O)for(u=1;x+u<O+e.listePoints3d[0].length;)S.push(e.listePoints3d[v][(x+u)%e.listePoints3d[0].length].c2d),u++;else for(u=1;x+u<O;)S.push(e.listePoints3d[v][x+u].c2d),u++;const ee=_(S,this.colorEnveloppe);if(ee.epaisseur=1.5,this.c2d.push(ee),this.affichageAxe){const n=f(P.c2d,p.c2d);let l=1;const t=_(S);for(;l<2&&te(N(P.c2d,p.c2d,l*n),t);)l+=.01;let i=N(P.c2d,p.c2d,Math.max(l-.01,1)*n),d=P.c2d,s=f(i,d)<.001?D():C(d,i,this.colorAxe);s.pointilles=2,this.c2d.push(s),i=p.c2d,d=N(P.c2d,p.c2d,1.1*n),s=f(i,d)<.001?D():C(i,d,this.colorAxe),this.c2d.push(s),i=P.c2d,d=N(P.c2d,p.c2d,-.1*n),s=f(i,d)<.001?D():C(i,d,this.colorAxe),this.c2d.push(s)}this.objets=this.c2d}}function Ce(I,L,k="red",R="blue",F=0,G="gray",J=0,K="black",U=!1,Y="black",Z=0,m=!0){return new ce(I,L,k,R,F,G,J,K,U,Y,Z,m)}export{Ce as s};
//# sourceMappingURL=Sphere3dPerspectiveCavaliere-DE4fUKjl.js.map
