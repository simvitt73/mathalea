{"version":3,"file":"1A-S02-4-Djg8S-5Y.js","sources":["../../src/exercices/1e/1A-S02-4.ts"],"sourcesContent":["import { tableauColonneLigne } from '../../lib/2d/tableau'\nimport { choice } from '../../lib/outils/arrayOutils'\nimport { miseEnEvidence } from '../../lib/outils/embellissements'\nimport { texNombre } from '../../lib/outils/texNombre'\nimport { randint } from '../../modules/outils'\nimport { nombreElementsDifferents } from '../ExerciceQcm'\n// import ExerciceQcmA from '../../ExerciceQcmA'\nimport ExerciceQcmA from '../ExerciceQcmA'\n\nexport const uuid = '91cbe'\nexport const refs = {\n  'fr-fr': ['1A-S02-4'],\n  'fr-ch': [],\n}\nexport const interactifReady = true\nexport const interactifType = 'qcm'\nexport const amcReady = 'true'\nexport const amcType = 'qcmMono'\nexport const titre =\n  \"Déterminer la valeur manquante d'une série de valeurs pondérées dont on connaît la moyenne\"\nexport const dateDePublication = '01/08/2025'\n// Ceci est un exemple de QCM avec version originale et version aléatoire\n/**\n *\n * @author Stéphane Guyon\n *\n */\n\nexport default class MoyennePondereeQCM extends ExerciceQcmA {\n  // Ceci est la fonction qui s'occupe d'écrire l'énoncé, la correction et les réponses\n  // Elle factorise le code qui serait dupliqué dans versionAleatoire et versionOriginale\n\n  private appliquerLesValeurs(): void {\n    let x: number\n    let notes: number[]\n    let coeffX: number\n    let moyenne: number\n    let sommeProduits: number\n    let sommeCoeff: number\n    let estPossible = true\n    let effectif: number\n    // let propositionImpossibleIncluse = false // Pour savoir si on inclut la proposition \"Impossible\" dans les distracteurs\n\n    do {\n      effectif = randint(3, 4) // nombre de notes connues à coefficient 1\n      notes = Array.from({ length: effectif }, () => randint(8, 15))\n      coeffX = choice([2, 3])\n      moyenne = randint(10, 16)\n\n      const sommeNotes = notes.reduce((a, b) => a + b, 0)\n      sommeCoeff = effectif + coeffX // la somme de tous les coefficients, y compris x\n      sommeProduits = sommeNotes // la somme des notes connues de coeff 1\n\n      const totalCible = moyenne * sommeCoeff\n      x = (totalCible - sommeProduits) / coeffX // Calcul de x\n\n      if (!Number.isInteger(x)) continue // Si x entier\n      estPossible = x >= 0 && x <= 20 // On veut vérifier que x dans l'intervalle [0, 20]\n    } while (!Number.isInteger(x) || (!estPossible && Math.random() < 0.8)) // On continue jusqu'à ce que x soit entier et dans l'intervalle [0, 20] ou qu'on ait une chance de 20% de ne pas respecter cette condition (pour avoir le cas impossible)\n\n    function shuffleArray<T>(array: T[]): void {\n      for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1))\n        ;[array[i], array[j]] = [array[j], array[i]]\n      }\n    } // Fonction pour mélanger un tableau (je pense qu'elle ne sert à rien ici, mais je n'ose pas l'enlever)\n\n    function genererDistracteurs(\n      x: number,\n      inclureImpossible: boolean,\n    ): string[] {\n      const numeriques = [-3, -2, -1, 1, 2, 3]\n        .map((delta) => x + delta)\n        .filter(\n          (val) => Number.isInteger(val) && val >= 0 && val <= 20 && val !== x,\n        )\n\n      shuffleArray(numeriques)\n      const distracteursTexte = numeriques\n        .slice(0, inclureImpossible ? 2 : 3)\n        .map((val) => `$x=${texNombre(val)}$`)\n\n      if (inclureImpossible) {\n        distracteursTexte.push(\n          'Impossible, il faudrait une note supérieure à 20.',\n        )\n      }\n\n      shuffleArray(distracteursTexte)\n      return distracteursTexte\n    }\n\n    const nbColonnes = notes.length + 1\n\n    //  En-têtes : 'Devoir', puis '1', '2', ..., jusqu'à la colonne de x\n    const entetesColonnes = ['\\\\text{Devoir}'].concat(\n      Array.from({ length: nbColonnes }, (_, i) => `${i + 1}`),\n    )\n\n    const entetesLignes = ['\\\\text{Note}', '\\\\text{Coefficient}']\n    const ligneNotes = [...notes.map((n) => `${n}`), 'x']\n    const ligneCoeffs = [...notes.map(() => '1'), `${coeffX}`]\n    const contenu = [...ligneNotes, ...ligneCoeffs]\n\n    //  Tableau KaTeX\n    const tableau = tableauColonneLigne(entetesColonnes, entetesLignes, contenu)\n    const produits = notes.map((n) => `${n} \\\\times 1`).join(' + ')\n    const sommeLitterale = `${sommeProduits} + ${coeffX}x`\n    const sommeCoeffsDetail = notes.map(() => '1').join(' + ') + ` + ${coeffX}`\n    const coeffsErreur = Array.from({ length: notes.length }, (_, i) => i + 1)\n    const sommeCoeffsErreur =\n      coeffsErreur.reduce((a, b) => a + b, 0) + (notes.length + 1) // x en dernière position\n    const sommeProduitsErreur = notes.reduce(\n      (acc, note, i) => acc + note * coeffsErreur[i],\n      0,\n    )\n\n    const xErreur =\n      (moyenne * sommeCoeffsErreur - sommeProduitsErreur) / (notes.length + 1)\n\n    let distracteurErreur: string | null = null\n\n    if (Number.isInteger(xErreur)) {\n      if (xErreur > 20) {\n        distracteurErreur = 'Impossible, il faudrait une note supérieure à 20.'\n        // propositionImpossibleIncluse = true\n      } else {\n        distracteurErreur = `$x=${texNombre(xErreur)}$`\n      }\n    }\n    this.enonce = `Voici les $${effectif + 1}$ notes sur vingt obtenues par un élève en mathématiques :<br><br>\n${tableau}\n<br><br>\nOn cherche ce que doit valoir $x$ pour que la moyenne de l'élève soit égale $${moyenne}$.`\n    if (estPossible) {\n      const inclureImpossibleCommePiege = x >= 18\n      const distracteurs = genererDistracteurs(x, inclureImpossibleCommePiege)\n      // Ajout du distracteur par erreur \"numéro de devoir comme coefficient\"\n      if (distracteurErreur && !distracteurs.includes(distracteurErreur)) {\n        distracteurs.pop() // on en retire un pour garder 3 au total\n        distracteurs.push(distracteurErreur)\n        shuffleArray(distracteurs)\n      }\n      this.reponses = [`$x=${texNombre(x)}$`, ...distracteurs]\n\n      this.correction = `\nPour déterminer la moyenne de l'élève, on calcule :<br>\n$\\\\bullet$ La somme des produits de chaque note par son coefficient :\n\n$${produits} + x \\\\times ${coeffX} = ${sommeLitterale}$.<br>\n\n$\\\\bullet$ La somme des coefficients : $${sommeCoeffsDetail}= ${sommeCoeff}$.\n<br>Remarque : On fera bien attention à ne pas utiliser la ligne des numéros de devoirs du tableau, donnée qui n'intervient pas dans le calcul de la moyenne.\n<br>La moyenne est donc égale à $\\\\dfrac{${sommeProduits} + ${coeffX}x}{${sommeCoeff}}$. <br> Comme elle doit être égale à $${moyenne}$, on doit résoudre l'équation suivante :\n<br>\n$\n\\\\begin{aligned}\n\\\\dfrac{${sommeProduits} + ${coeffX}x}{${sommeCoeff}} &= ${moyenne}\\\\\\\\\n${sommeProduits} + ${coeffX}x &= ${moyenne} \\\\times ${sommeCoeff}\\\\\\\\\n    ${sommeProduits} + ${coeffX}x&= ${moyenne * sommeCoeff}\\\\\\\\\n${coeffX}x &= ${moyenne * sommeCoeff} - ${sommeProduits}\\\\\\\\\n ${coeffX}x &= ${moyenne * sommeCoeff - sommeProduits}\\\\\\\\\nx &= \\\\dfrac{${moyenne * sommeCoeff - sommeProduits}}{${coeffX}}\\\\\\\\\nx&= ${miseEnEvidence(x)}.\n\\\\end{aligned}\n$\n`\n    } else {\n      // Générer des distracteurs élevés (≥17) incluant obligatoirement 20\n      const distracteursSet = new Set<number>()\n      distracteursSet.add(20) // on impose qu’il y ait un 20\n      // propositionImpossibleIncluse = true\n      while (distracteursSet.size < 3) {\n        const val = randint(17, 20, 0)\n        distracteursSet.add(val)\n      }\n\n      const distracteurs = Array.from(distracteursSet).map(\n        (val) => `$x=${texNombre(val)}$`,\n      )\n      shuffleArray(distracteurs)\n\n      this.reponses = [\n        'Impossible, il faudrait une note supérieure à 20.',\n        ...distracteurs,\n      ]\n\n      this.correction = `\nPour déterminer la moyenne de l'élève, on calcule :<br>\n$\\\\bullet$ La somme des produits de chaque note par son coefficient :\n\n$${produits} + x \\\\times ${coeffX} = ${sommeLitterale}$.\n\n<br>$\\\\bullet$ La somme des coefficients : $${sommeCoeffsDetail}= ${sommeCoeff}$.\n<br>Remarque : On fera bien attention à ne pas utiliser la ligne des numéros de devoirs du tableau, donnée qui n'intervient pas dans le calcul de la moyenne.\n<br>La moyenne est donc égale à $\\\\dfrac{${sommeProduits} + ${coeffX}x}{${sommeCoeff}}$. <br> Comme elle doit être égale à $${moyenne}$, on doit résoudre l'équation suivante :\n<br>\n$\\\\dfrac{${sommeProduits} + ${coeffX}x}{${sommeCoeff}} = ${moyenne}$<br>\n$${sommeProduits} + ${coeffX}x = ${moyenne * sommeCoeff}$<br>\n$x = \\\\dfrac{${moyenne * sommeCoeff - sommeProduits}}{${coeffX}} = ${x}$<br>\nMais cette valeur dépasse 20. Il est donc <strong>impossible</strong> d'obtenir une telle moyenne avec une note sur 20.\n`\n    }\n  }\n\n  // S'occupe de passser les données originales à la fonction appliquerLesValeurs\n\n  // s'occupe d'aléatoiriser les valeurs à passer à la fonction appliquerLesValeurs en vérifiant qu'on a bien 3 réponses différentes\n  // Pour un qcm à n réponses, il faudrait vérifier que nombreElementsDifferents(this.reponses) < n\n  versionAleatoire: () => void = () => {\n    const n = 4 // nombre de réponses différentes voulues (on rappelle que la première réponse est la bonne)\n    do {\n      this.appliquerLesValeurs()\n    } while (nombreElementsDifferents(this.reponses) < n)\n  }\n\n  // Ici il n'y a rien à faire, on appelle juste la version aleatoire (pour un qcm aleatoirisé, c'est le fonctionnement par défaut)\n  constructor() {\n    super()\n    this.besoinFormulaireCaseACocher = false\n    this.options = { vertical: false, ordered: false }\n    this.versionAleatoire()\n  }\n}\n"],"names":["uuid","refs","interactifReady","interactifType","amcReady","amcType","titre","dateDePublication","MoyennePondereeQCM","ExerciceQcmA","__publicField","nombreElementsDifferents","x","notes","coeffX","moyenne","sommeProduits","sommeCoeff","estPossible","effectif","randint","choice","sommeNotes","a","b","shuffleArray","array","i","j","genererDistracteurs","inclureImpossible","numeriques","delta","val","distracteursTexte","texNombre","nbColonnes","entetesColonnes","_","entetesLignes","ligneNotes","n","ligneCoeffs","contenu","tableau","tableauColonneLigne","produits","sommeLitterale","sommeCoeffsDetail","coeffsErreur","sommeCoeffsErreur","sommeProduitsErreur","acc","note","xErreur","distracteurErreur","inclureImpossibleCommePiege","distracteurs","miseEnEvidence","distracteursSet"],"mappings":"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"}