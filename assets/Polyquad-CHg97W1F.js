var E=Object.defineProperty;var J=(o,s,r)=>s in o?E(o,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[s]=r;var p=(o,s,r)=>J(o,typeof s!="symbol"?s+"":s,r);import{r as A}from"./index-BvuGzI-o.js";import{c as f}from"./utilitairesGeometriques-rO8Jz15i.js";import{p as M}from"./PointAbstrait-Cz1GEocE.js";import{p as m}from"./polygones-89tGuAkc.js";import{c as R}from"./polygonesParticuliers-BQc_Ltiy.js";import{t as O}from"./transformations-XOBa9Ou2.js";import{v as j}from"./droites-Bwfi-_hx.js";function d(o,s,r){return o.x===r[0].x&&o.y===r[0].y&&s.x===r[1].x&&s.y===r[1].y||o.x===r[1].x&&o.y===r[1].y&&s.x===r[0].x&&s.y===r[0].y}function S(o,s){const r=s.findIndex(t=>t[0].x===o.x&&t[0].y===o.y||t[1].x===o.x&&t[1].y===o.y);if(r!==-1){const t=s[r];return s.splice(r,1),t[0].x===o.x&&t[0].y===o.y?{couple:[{x:t[0].x,y:t[0].y},{x:t[1].x,y:t[1].y}],couplesPointsRestants:s}:{couple:[{x:t[1].x,y:t[1].y},{x:t[0].x,y:t[0].y}],couplesPointsRestants:s}}else return{couple:null,couplesPointsRestants:s}}class D{constructor(s,r,t){p(this,"xOrigine");p(this,"yOrigine");p(this,"poly");p(this,"dots");p(this,"carresOccupes");p(this,"carresAdjacentsDispo");p(this,"complexity");p(this,"rectangle");this.xOrigine=r,this.yOrigine=t;const a=[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}];let l=0,e=0,i=0;do{for(this.carresOccupes=[{x:0,y:0}],l++,this.carresAdjacentsDispo=a.map(n=>({x:n.x,y:n.y}));this.carresOccupes.length<s;){const n=A(0,this.carresAdjacentsDispo.length-1),c=this.carresAdjacentsDispo[n];this.carresAdjacentsDispo.splice(n,1),this.carresOccupes.push({x:c.x,y:c.y});for(const x of a){const y={x:c.x+x.x,y:c.y+x.y};this.carresOccupes.find(h=>y.x===h.x&&y.y===h.y)==null&&this.carresAdjacentsDispo.find(h=>y.x===h.x&&y.y===h.y)==null&&this.carresAdjacentsDispo.push(y)}}this.rectangle=this.findRectangle(),e=(this.rectangle.xMax-this.rectangle.xMin)*(this.rectangle.yMax-this.rectangle.yMin),i=this.aireExt(),this.translate(-this.rectangle.xMin,-this.rectangle.yMin),this.detoure()}while(e-i!==s&&l<100);this.complexity=i/e,this.poly=O(m(this.dots.map(n=>M(n.x,n.y))),j(r,t)),this.poly.color=f("red"),this.poly.couleurDeRemplissage=f("orange"),this.poly.epaisseur=2}ajouteCarres(s){let r=0,t=0,a=0;const l=[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0}],e=this.carresOccupes.length+s;let i,n;const c=new D(e,this.xOrigine,this.yOrigine);do{for(i=JSON.parse(JSON.stringify(this.carresOccupes)),n=JSON.parse(JSON.stringify(this.carresAdjacentsDispo)),r++;i.length<e;){const x=A(0,n.length-1),y=n[x];n.splice(x,1),i.push({x:y.x,y:y.y});for(const h of l){const u={x:y.x+h.x,y:y.y+h.y};i.find(g=>u.x===g.x&&u.y===g.y)==null&&n.find(g=>u.x===g.x&&u.y===g.y)==null&&n.push(u)}}c.carresOccupes=JSON.parse(JSON.stringify(i)),c.carresAdjacentsDispo=JSON.parse(JSON.stringify(n)),c.rectangle=c.findRectangle(),t=(c.rectangle.xMax-c.rectangle.xMin)*(c.rectangle.yMax-c.rectangle.yMin),a=c.aireExt(),c.translate(-c.rectangle.xMin,-c.rectangle.yMin),c.detoure()}while(t-a!==e&&r<100);return c.carresOccupes=JSON.parse(JSON.stringify(i)),c.carresAdjacentsDispo=JSON.parse(JSON.stringify(n)),c.complexity=a/t,c.poly=O(m(c.dots.map(x=>M(x.x,x.y))),j(c.xOrigine,c.yOrigine)),c.poly.color=f("red"),c.poly.couleurDeRemplissage=f("orange"),c.poly.epaisseur=2,c}findRectangle(){let s=1e3,r=-1e3,t=1e3,a=-1e3;for(const l of this.carresOccupes)s=Math.min(s,l.x),r=Math.max(r,l.x+1),t=Math.min(t,l.y),a=Math.max(a,l.y+1);return{xMin:s,xMax:r,yMin:t,yMax:a}}translate(s,r){for(const t of this.carresOccupes)t.x+=s,t.y+=r;for(const t of this.carresAdjacentsDispo)t.x+=s,t.y+=r;this.rectangle={xMin:this.rectangle.xMin+s,xMax:this.rectangle.xMax+s,yMin:this.rectangle.yMin+r,yMax:this.rectangle.yMax+r}}rotate(s){const r=s?[[0,-1],[1,0]]:[[0,1],[-1,0]];if(r==null)throw Error("La matrice ne peut pas être créée, ce qui est impossible");for(const t of this.carresOccupes){const a=r[0][0]*t.x+r[0][1]*t.y,l=r[1][0]*t.x+r[1][1]*t.y;t.x=a,t.y=l}for(const t of this.carresAdjacentsDispo){const a=r[0][0]*t.x+r[0][1]*t.y,l=r[1][0]*t.x+r[1][1]*t.y;t.x=a,t.y=l}this.rectangle=this.findRectangle(),this.translate(-this.rectangle.xMin,-this.rectangle.yMin),this.detoure(),this.poly=O(m(this.dots.map(t=>M(t.x,t.y))),j(this.xOrigine,this.yOrigine)),this.poly.color=f("red"),this.poly.couleurDeRemplissage=f("orange"),this.poly.epaisseur=2}isEmpty(s,r){return this.carresOccupes.find(t=>t.x===s&&t.y===r)==null}aireExt(){let s=0;const r=Math.min(...this.carresOccupes.map(e=>e.x)),t=Math.max(...this.carresOccupes.map(e=>e.x)),a=Math.min(...this.carresOccupes.map(e=>e.y)),l=Math.max(...this.carresOccupes.map(e=>e.y));for(let e=a;e<=l;e++){let i=r,n=t,c=!1;do this.isEmpty(i,e)&&this.isEmpty(n,e)?(s+=2,i++,n--):this.isEmpty(i,e)?(s++,i++):this.isEmpty(n,e)?(s++,n--):c=!0;while(!c)}return s}render(){const s=[];for(const r of this.carresOccupes){const t=R(M(r.x+this.xOrigine,r.y+this.yOrigine),M(r.x+this.xOrigine+1,r.y+this.yOrigine));t.couleurDeRemplissage=f("orange"),t.color=f("black"),s.push(t)}return s}detoure(){const s=[];for(let e=this.rectangle.xMin;e<this.rectangle.xMax;e++){s[e]=[];for(let i=this.rectangle.yMin;i<this.rectangle.yMax;i++)s[e][i]=this.carresOccupes.find(n=>n.x===e&&n.y===i)==null?[!1,!1,!1,!1]:[!0,!0,!0,!0]}const r=function(e,i){return(e||i)&&!(e&&i)},t=[];for(let e=this.rectangle.xMin;e<this.rectangle.xMax;e++){t[e]=[];for(let i=this.rectangle.yMin;i<this.rectangle.yMax;i++)t[e][i]=[!1,!1,!1,!1],t[e][i][0]=i===0?s[e][i][0]:r(s[e][i][0],s[e][i-1][2]),t[e][i][1]=e===this.rectangle.xMax-1?s[e][i][1]:r(s[e][i][1],s[e+1][i][3]),t[e][i][2]=i===this.rectangle.yMax-1?s[e][i][2]:r(s[e][i][2],s[e][i+1][0]),t[e][i][3]=e===0?s[e][i][3]:r(s[e][i][3],s[e-1][i][1])}let a=[];for(let e=this.rectangle.xMin;e<this.rectangle.xMax;e++)for(let i=this.rectangle.yMin;i<this.rectangle.yMax;i++){if(t[e][i][0]){const n={x:e,y:i},c={x:e+1,y:i};a.some(x=>d(n,c,x))||a.push([n,c])}if(t[e][i][1]){const n={x:e+1,y:i},c={x:e+1,y:i+1};a.some(x=>d(n,c,x))||a.push([n,c])}if(t[e][i][2]){const n={x:e+1,y:i+1},c={x:e,y:i+1};a.some(x=>d(n,c,x))||a.push([n,c])}if(t[e][i][3]){const n={x:e,y:i+1},c={x:e,y:i};a.some(x=>d(n,c,x))||a.push([n,c])}}this.dots=[{x:a[0][0].x,y:a[0][0].y},{x:a[0][1].x,y:a[0][1].y}],a.shift();let l=a.length;for(;a.length>0&&l>0;){const{couple:e,couplesPointsRestants:i}=S(this.dots[this.dots.length-1],a);l--;const n=e;a=i,n&&(n[1].x!==this.dots[0].x||n[1].y!==this.dots[0].y)&&this.dots.push({x:n[1].x,y:n[1].y})}this.dots=C(this.dots)}}function w(o,s,r,t){return o===0?s===0?r===0&&t===0:t/s>0:s===0?o===0?r===0&&t===0:r/o>0:r*s===o*t&&o*r>0&&s*t>0}function C(o){for(let n=1;n<o.length-1;){const c=o[n-1],x=o[n],y=o[n+1],h=x.x-c.x,u=x.y-c.y,g=y.x-x.x,N=y.y-x.y;w(h,u,g,N)?o.splice(n,1):n++}const s=o[o.length-1],r=o[0],t=o[1],a=r.x-s.x,l=r.x-s.y,e=t.x-r.x,i=t.y-r.y;return e===a&&i===l&&o.splice(0,1),o}export{D as P,C as e};
//# sourceMappingURL=Polyquad-CHg97W1F.js.map
