{"version":3,"file":"PolynomeFactorisableDegMax4-DbzoUjrp.js","sources":["../../src/lib/mathFonctions/PolynomeFactorisableDegMax4.ts"],"sourcesContent":["import EquationSecondDegre from '../../modules/EquationSecondDegre'\nimport FractionEtendue from '../../modules/FractionEtendue'\nimport { randint } from '../../modules/outils'\nimport { ecritureAlgebrique, rienSi1 } from '../outils/ecritures'\nimport { ppcmListe } from '../outils/primalite'\nimport MonomePlusieursVariables from './MonomePlusieursVariables'\nimport PolynomePlusieursVariables from './PolynomePlusieursVariables'\n\nclass PolynomeFactorisable {\n  racinesRationnelles: (number | FractionEtendue)[]\n  facteurSansRacineRationnelle: PolynomePlusieursVariables\n  coeffDominant: FractionEtendue\n  polynome: PolynomePlusieursVariables\n  coefficients: FractionEtendue[]\n  polynomeEquivEntier: PolynomePlusieursVariables\n  ppcm: number\n\n  constructor(\n    racinesRationnelles: (number | FractionEtendue)[],\n    coeffDominant: FractionEtendue,\n    facteurSansRacineRationnelle: PolynomePlusieursVariables = new PolynomePlusieursVariables(\n      [\n        new MonomePlusieursVariables(new FractionEtendue(1, 1), {\n          variables: ['x'],\n          exposants: [0],\n        }),\n      ],\n    ),\n  ) {\n    this.racinesRationnelles = racinesRationnelles\n    this.coeffDominant = coeffDominant\n    this.facteurSansRacineRationnelle = facteurSansRacineRationnelle\n    this.polynome = PolynomeFactorisable.creerPolynome(\n      racinesRationnelles,\n      coeffDominant,\n    )\n      .produit(facteurSansRacineRationnelle)\n      .reduire()\n    this.coefficients = this.polynome.reduire().termes()\n    this.ppcm = ppcmListe(this.coefficients.map((c) => c.simplifie().den))\n    this.polynomeEquivEntier = PolynomeFactorisable.creerPolynome(\n      racinesRationnelles,\n      coeffDominant.multiplieEntier(this.ppcm),\n    )\n      .produit(facteurSansRacineRationnelle)\n      .reduire()\n  }\n\n  static creerPolynome(\n    racines: (number | FractionEtendue)[],\n    coeffDominant: number | FractionEtendue,\n  ) {\n    return PolynomePlusieursVariables.createPolynomeFromRoots(\n      racines,\n      coeffDominant as FractionEtendue,\n    )\n  }\n\n  static creerPolynomeAleatoire(\n    degre: number,\n    typeRacines: 'entieres' | 'rationnelles' | 'reelles',\n    typeCoeff: 'entier' | 'rationnel',\n    completementFactorisable: boolean,\n    nbRacinesMaxEgales: number,\n    nbRacinesMinEgales: number = 1,\n  ): PolynomeFactorisable {\n    if (degre < 3 || degre > 4) {\n      throw new Error('Le degré doit être entre 1 et 4.')\n    }\n    let degreCourant = 0\n    let compteurRacinesRationnelles = 0\n    let compteurRacinesEgales = 0\n    let partieSansRacineRationnelle = new PolynomePlusieursVariables([\n      new MonomePlusieursVariables(new FractionEtendue(1, 1), {\n        variables: ['x'],\n        exposants: [0],\n      }),\n    ])\n    if (!completementFactorisable || typeRacines === 'reelles') {\n      degreCourant += 2\n    }\n    const racines: FractionEtendue[] = []\n    let coeffDominant = new FractionEtendue(1, 1)\n    while (degreCourant < degre) {\n      let racine: FractionEtendue\n      racine = new FractionEtendue(0, 1)\n      if (\n        (typeRacines === 'rationnelles' || typeRacines === 'reelles') &&\n        compteurRacinesRationnelles < 1\n      ) {\n        compteurRacinesRationnelles++\n        let numerateur: number\n        let denominateur: number\n        do {\n          numerateur = randint(-5, 5, [-4, 4, 0]) // Numérateur entre -5 et 5\n          denominateur = randint(1, 5, [4, 0]) // Dénominateur entre 1 et 5\n          racine = new FractionEtendue(numerateur, denominateur).simplifie()\n        } while (racine.simplifie().den === 1)\n      } else {\n        racine = new FractionEtendue(randint(-7, 7, [0]), 1) // Racine entière entre -5 et 5\n      }\n      // Vérifier la multiplicité maximale\n      const count = racines.filter((r) =>\n        r.simplifie().isEqual(racine.simplifie()),\n      ).length\n      if (count < nbRacinesMaxEgales) {\n        racines.push(racine.simplifie())\n        if (compteurRacinesEgales < nbRacinesMinEgales) {\n          racines.push(racine.simplifie())\n          compteurRacinesEgales++\n          degreCourant++\n        }\n        degreCourant++\n      }\n    }\n    if (typeCoeff === 'entier') {\n      const denominators = racines.map((r) => r.den)\n      let mult = ppcmListe(denominators)\n      if (mult === 1) {\n        mult = randint(-3, 3, [0])\n      }\n      coeffDominant = new FractionEtendue(mult, 1)\n    } else {\n      coeffDominant = new FractionEtendue(\n        randint(1, 5, [0]),\n        randint(1, 5, [0]),\n      ).simplifie()\n    }\n    if (!completementFactorisable) {\n      const b = randint(-1, 1)\n      partieSansRacineRationnelle = new PolynomePlusieursVariables([\n        new MonomePlusieursVariables(new FractionEtendue(1, 1), {\n          variables: ['x'],\n          exposants: [2],\n        }),\n        new MonomePlusieursVariables(new FractionEtendue(b, 1), {\n          variables: ['x'],\n          exposants: [1],\n        }),\n        new MonomePlusieursVariables(\n          new FractionEtendue(\n            randint(0 + Math.abs(b), 2 - Math.abs(b), [0]),\n            1,\n          ),\n          { variables: ['x'], exposants: [0] },\n        ),\n      ])\n    }\n    if (typeRacines === 'reelles' && completementFactorisable) {\n      const c = randint(-2, -1)\n      partieSansRacineRationnelle = new PolynomePlusieursVariables([\n        new MonomePlusieursVariables(new FractionEtendue(1, 1), {\n          variables: ['x'],\n          exposants: [2],\n        }),\n        new MonomePlusieursVariables(-randint(2, 2, [0]), {\n          variables: ['x'],\n          exposants: [1],\n        }),\n        new MonomePlusieursVariables(new FractionEtendue(c, 1), {\n          variables: ['x'],\n          exposants: [0],\n        }),\n      ])\n    }\n    return new PolynomeFactorisable(\n      racines,\n      coeffDominant,\n      partieSansRacineRationnelle,\n    )\n  }\n\n  toLatex(factorise: boolean = false): string {\n    if (!factorise) {\n      return this.polynome.toString()\n    }\n\n    // Count multiplicities of roots\n    const rootCounts = new Map<\n      string,\n      { root: number | FractionEtendue; count: number }\n    >()\n    for (const root of this.racinesRationnelles) {\n      const rootKey =\n        root instanceof FractionEtendue ? root.toLatex() : root.toString()\n      if (rootCounts.has(rootKey)) {\n        rootCounts.get(rootKey)!.count++\n      } else {\n        rootCounts.set(rootKey, { root, count: 1 })\n      }\n    }\n\n    // Format coefficient dominant using rienSi1\n    const coeffStr = rienSi1(this.coeffDominant)\n\n    // Build factorized form\n    const factors: string[] = []\n\n    for (const { root, count } of rootCounts.values()) {\n      // Use ecritureAlgebrique to handle the sign properly\n      const rootAlgebraique = ecritureAlgebrique(\n        root instanceof FractionEtendue ? root.oppose() : -root,\n      )\n      const factor = `\\\\left(x${rootAlgebraique}\\\\right)`\n\n      if (count === 1) {\n        factors.push(factor)\n      } else {\n        factors.push(`${factor}^{${count}}`)\n      }\n    }\n\n    // Combine coefficient and factors\n    let result = coeffStr + factors.join('')\n    if (!factorise && this.facteurSansRacineRationnelle.toString() !== '1') {\n      result += result + this.facteurSansRacineRationnelle.toString()\n    } else if (\n      factorise &&\n      this.facteurSansRacineRationnelle.toString() !== '1'\n    ) {\n      result += EquationSecondDegre.aPartirDuPolynome(\n        this.facteurSansRacineRationnelle,\n      ).printToLatexFormeFactorisee()\n    }\n\n    return result || '0'\n  }\n\n  /**\n   * Génère l'expression LaTeX de la forme factorisée avec une valeur substituée pour x\n   * @param x - La valeur à substituer (FractionEtendue ou number)\n   * @returns String LaTeX avec la substitution\n   */\n  toLatexFactoriseSubstitue(x: FractionEtendue | number): string {\n    const xFrac = x instanceof FractionEtendue ? x : new FractionEtendue(x, 1)\n\n    // Count multiplicities of roots\n    const rootCounts = new Map<\n      string,\n      { root: FractionEtendue; count: number }\n    >()\n    for (const root of this.racinesRationnelles) {\n      const rootFrac =\n        root instanceof FractionEtendue ? root : new FractionEtendue(root, 1)\n      const rootKey = rootFrac.toLatex()\n      if (rootCounts.has(rootKey)) {\n        rootCounts.get(rootKey)!.count++\n      } else {\n        rootCounts.set(rootKey, { root: rootFrac, count: 1 })\n      }\n    }\n\n    // Format coefficient dominant using rienSi1\n    const coeffStr = rienSi1(this.coeffDominant)\n\n    // Build factorized form with substitution\n    const factors: string[] = []\n\n    for (const { root, count } of rootCounts.values()) {\n      // Format as (value - root) without evaluating\n      const xStr = xFrac.texFractionSimplifiee\n      const rootAlgebraique = ecritureAlgebrique(root.oppose())\n\n      const factor = `\\\\left(${xStr}${rootAlgebraique}\\\\right)`\n\n      if (count === 1) {\n        factors.push(factor)\n      } else {\n        factors.push(`${factor}^{${count}}`)\n      }\n    }\n\n    // Combine coefficient and factors\n    let result = coeffStr + factors.join('')\n\n    // Handle non-rational factor if present\n    if (this.facteurSansRacineRationnelle.toString() !== '1') {\n      const valeurFacteur = this.facteurSansRacineRationnelle.evaluer({\n        x: xFrac,\n      })\n      result += `\\\\left(${valeurFacteur.texFractionSimplifiee}\\\\right)`\n    }\n\n    return result || '0'\n  }\n}\nexport default PolynomeFactorisable\n"],"names":["PolynomeFactorisable","racinesRationnelles","coeffDominant","facteurSansRacineRationnelle","PolynomePlusieursVariables","MonomePlusieursVariables","FractionEtendue","__publicField","ppcmListe","c","racines","degre","typeRacines","typeCoeff","completementFactorisable","nbRacinesMaxEgales","nbRacinesMinEgales","degreCourant","compteurRacinesRationnelles","compteurRacinesEgales","partieSansRacineRationnelle","racine","numerateur","denominateur","randint","r","denominators","mult","b","factorise","rootCounts","root","rootKey","coeffStr","rienSi1","factors","count","factor","ecritureAlgebrique","result","EquationSecondDegre","x","xFrac","rootFrac","xStr","rootAlgebraique","valeurFacteur"],"mappings":"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"}