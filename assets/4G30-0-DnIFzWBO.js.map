{"version":3,"file":"4G30-0-DnIFzWBO.js","sources":["../../src/lib/2d/GuidaAne.ts","../../src/exercices/4e/4G30-0.ts"],"sourcesContent":["function detectPixelsPerCm() {\n  try {\n    const testElement = document.createElement('div')\n    testElement.style.width = '1cm'\n    testElement.style.height = '1px'\n    testElement.style.position = 'absolute'\n    testElement.style.left = '-9999px'\n    testElement.style.visibility = 'hidden'\n    document.body.appendChild(testElement)\n\n    const pixelsPerCm = testElement.offsetWidth\n    document.body.removeChild(testElement)\n\n    // V√©rifier que la valeur est raisonnable\n    if (pixelsPerCm > 10 && pixelsPerCm < 200) {\n      return pixelsPerCm\n    }\n  } catch (error) {\n    window.notify('Erreur lors de la d√©tection des pixels par cm:', error)\n  }\n\n  return 37.8\n}\n\n// Ajouter cette fonction utilitaire AVANT la classe GuideAne\nfunction decimalToFraction(decimal: number, maxDenominator = 100) {\n  // Cas sp√©ciaux\n  if (decimal === 0) return { numerator: 0, denominator: 1 }\n  if (decimal === Math.floor(decimal))\n    return { numerator: Math.floor(decimal), denominator: 1 }\n\n  let bestNumerator = 1\n  let bestDenominator = 1\n  let bestError = Math.abs(decimal - 1)\n\n  for (let denominator = 2; denominator <= maxDenominator; denominator++) {\n    const numerator = Math.round(decimal * denominator)\n    const error = Math.abs(decimal - numerator / denominator)\n\n    if (error < bestError) {\n      bestNumerator = numerator\n      bestDenominator = denominator\n      bestError = error\n\n      // Si on trouve une fraction exacte, on s'arr√™te\n      if (error < 0.001) break\n    }\n  }\n\n  return { numerator: bestNumerator, denominator: bestDenominator }\n}\n\nfunction formatFraction(decimal: number, showDecimal = true) {\n  const fraction = decimalToFraction(decimal)\n  const { numerator, denominator } = fraction\n\n  if (denominator === 1) {\n    return `${numerator}`\n  }\n\n  const fractionStr = `${numerator}/${denominator}`\n\n  if (showDecimal && Math.abs(decimal - numerator / denominator) > 0.001) {\n    return `${fractionStr} (‚âà${decimal.toFixed(3)})`\n  }\n\n  return fractionStr\n}\nexport class GuideAne extends HTMLElement {\n  n: number // Nombre de parties (calcul√© selon la position de C)\n  p: number // part place du point D sur [AB]\n  alpha: number // angle en degr√©s entre [AB] et [AC]\n  A: { x: number; y: number } // Point A\n  B: { x: number; y: number } // Point B\n  C: { x: number; y: number } // Point C draggable sur la demi-droite\n  isDragging: boolean\n  dragTarget: string | null\n  listenersAdded: boolean = false\n  pixelsParCm: number\n  svg!: SVGSVGElement\n  lengthDisplay!: HTMLDivElement\n  target: number | null = null\n  targetReached: boolean = false\n  onTargetReached: (() => void) | null = null\n  targetColor: string | null = null\n  printAD: boolean = false // Propri√©t√© pour contr√¥ler l'affichage de AD\n  printRatio: boolean = false // Propri√©t√© pour contr√¥ler l'affichage du rapport\n  fractionToDecimalAD: boolean = false // Nouvelle propri√©t√© pour l'affichage d√©cimal de AD si possible\n  targetFraction: string = '' // Propri√©t√© pour stocker la fraction cible\n  lengthAB: number = 0 // Stocker la longueur AB en cm\n  displayTargetOn: boolean = false\n\n  // propri√©t√©s pour la construction\n  AC1Length: number = 1 // Longueur AC‚ÇÅ en cm (fixe)\n  rayLength: number = 10 // Longueur de la demi-droite en cm\n  private mouseDownHandler?: (e: MouseEvent) => void\n  private mouseMoveHandler?: (e: MouseEvent) => void\n  private mouseUpHandler?: () => void\n  private touchStartHandler?: (e: TouchEvent) => void\n  private touchMoveHandler?: (e: TouchEvent) => void\n  private touchEndHandler?: () => void\n\n  constructor() {\n    super()\n    // Valeurs par d√©faut pour initialiser le guide-√¢ne\n    this.n = 1 // Valeur par d√©faut : AC‚ÇÅ (1 cm)\n    this.alpha = 45\n    this.p = 0 // par d√©faut (Dp confondu avec A)\n\n    // Points A, B et C\n    this.A = { x: 100, y: 300 }\n    this.pixelsParCm = detectPixelsPerCm()\n\n    // TOUJOURS initialiser B √† 1 cm de A (horizontalement)\n    this.B = {\n      x: this.A.x + 1 * this.pixelsParCm,\n      y: this.A.y,\n    }\n\n    // Calculer la position initiale de C bas√©e sur n\n    this.C = this.calculateInitialC()\n\n    // √âtat de dragging\n    this.isDragging = false\n    this.dragTarget = null\n\n    this.style.display = 'block'\n    this.style.width = '800px'\n    this.style.height = '400px'\n    this.style.border = '1px solid #ccc'\n    this.style.background = '#f9f9f9'\n    this.style.position = 'relative'\n  }\n  // Des m√©thodes d'acc√®s publiques pour la correction interactive et le feedback\n  public getN(): number {\n    return this.n\n  }\n\n  public getP(): number {\n    return this.p\n  }\n\n  public getAlpha(): number {\n    return this.alpha\n  }\n\n  public getValue(): number {\n    return this.value\n  }\n\n  public getLengthABValue(): number {\n    return this.getLengthAB()\n  }\n\n  public getTargetValue(): number | null {\n    return this.target\n  }\n\n  public getTargetFraction(): string {\n    return this.targetFraction\n  }\n\n  public isTargetReachedValue(): boolean {\n    return this.targetReached\n  }\n\n  // M√©thode pour obtenir les coordonn√©es des points\n  public getPoints(): {\n    A: { x: number; y: number }\n    B: { x: number; y: number }\n    C: { x: number; y: number }\n    D: { x: number; y: number }\n  } {\n    const Dp = this.calculateDpPosition()\n    return {\n      A: this.A,\n      B: this.B,\n      C: this.C,\n      D: Dp,\n    }\n  }\n\n  // M√©thode pour obtenir un rapport d√©taill√© de l'√©tat du guide-√¢ne\n  public getState(): {\n    n: number\n    p: number\n    alpha: number\n    lengthAD: number\n    lengthAB: number\n    ratio: string\n    target: number | null\n    targetReached: boolean\n    targetFraction: string\n  } {\n    return {\n      n: this.n,\n      p: this.p,\n      alpha: this.alpha,\n      lengthAD: this.value,\n      lengthAB: this.getLengthAB(),\n      ratio: `${this.p}/${this.n}`,\n      target: this.target,\n      targetReached: this.targetReached,\n      targetFraction: this.targetFraction,\n    }\n  }\n\n  // M√©thode pour d√©finir un callback personnalis√© si on veut\n  public setOnChangeCallback(callback: (state: any) => void) {\n    // Ajouter un listener pour les changements\n    const originalRedraw = this.redraw.bind(this)\n    this.redraw = () => {\n      originalRedraw()\n      callback(this.getState())\n    }\n  }\n\n  // Calculer la position initiale de C bas√©e sur n\n  calculateInitialC() {\n    const angleRad = (this.alpha * Math.PI) / 180\n    const ACLength = this.n * this.AC1Length * this.pixelsParCm\n\n    return {\n      x: this.A.x + ACLength * Math.cos(angleRad),\n      y: this.A.y - ACLength * Math.sin(angleRad), // CORRIGER: utiliser le m√™me signe que dans redraw()\n    }\n  }\n\n  // Calculer n bas√© sur la position actuelle de C\n  calculateNFromC() {\n    const ACLength = Math.sqrt(\n      Math.pow(this.C.x - this.A.x, 2) + Math.pow(this.C.y - this.A.y, 2),\n    )\n    const ACLengthCm = ACLength / this.pixelsParCm\n    const newN = Math.max(\n      1, // MINIMUM 1 au lieu de 2\n      Math.min(10, Math.round(ACLengthCm / this.AC1Length)),\n    )\n\n    return newN\n  }\n\n  // Contraindre C sur la demi-droite avec aimantation discr√®te\n  constrainCOnRay(x: number, y: number) {\n    const angleRad = (this.alpha * Math.PI) / 180\n    const direction = {\n      x: Math.cos(angleRad),\n      y: -Math.sin(angleRad),\n    }\n\n    // Projeter le point sur la demi-droite\n    const vectorAC = { x: x - this.A.x, y: y - this.A.y }\n    const projection = vectorAC.x * direction.x + vectorAC.y * direction.y\n\n    // Convertir la projection en longueur en cm\n    const projectionCm = projection / this.pixelsParCm\n\n    // Aimanter au centim√®tre entier (donc √† n entier)\n    const nCandidate = Math.max(\n      1,\n      Math.min(10, Math.round(projectionCm / this.AC1Length)),\n    )\n\n    // Recalculer la position exacte pour ce n\n    const snappedLength = nCandidate * this.AC1Length * this.pixelsParCm\n\n    return {\n      x: this.A.x + snappedLength * direction.x,\n      y: this.A.y + snappedLength * direction.y,\n    }\n  }\n\n  // m√©thode pour calculer la position du point Dp\n  calculateDpPosition() {\n    const A = this.A\n    const B = this.B\n    const t = this.p / this.n\n\n    return {\n      x: A.x + t * (B.x - A.x),\n      y: A.y + t * (B.y - A.y),\n    }\n  }\n\n  // m√©thode pour contraindre Dp sur le segment AB\n  constrainDpOnSegment(x: number, y: number) {\n    const A = this.A\n    const B = this.B\n\n    // Projeter le point sur la ligne AB\n    const AB = { x: B.x - A.x, y: B.y - A.y }\n    const AP = { x: x - A.x, y: y - A.y }\n\n    // Produit scalaire pour la projection\n    const ABLength = Math.sqrt(AB.x * AB.x + AB.y * AB.y)\n    const projection = (AP.x * AB.x + AP.y * AB.y) / (ABLength * ABLength)\n\n    // Limiter la projection entre 0 et (n-1)/n pour √©viter la superposition avec B\n    const maxT = (this.n - 1) / this.n\n    const clampedT = Math.max(0, Math.min(maxT, projection))\n\n    // Aimanter √† des positions discr√®tes (entiers de 0 √† n-1)\n    const discreteP = Math.round(clampedT * this.n)\n    const snappedT = discreteP / this.n\n\n    return {\n      x: A.x + snappedT * AB.x,\n      y: A.y + snappedT * AB.y,\n      p: discreteP, // Retourner aussi la nouvelle valeur de p\n    }\n  }\n\n  // M√©thode principale pour redessiner le guide-√¢ne √† chaque changement\n  redraw() {\n    // Vider le SVG\n    while (this.svg.firstChild) {\n      this.svg.removeChild(this.svg.firstChild)\n    }\n\n    this.n = this.calculateNFromC()\n\n    if (this.p >= this.n) {\n      this.p = Math.max(0, this.n - 1)\n    }\n\n    const A = this.A\n    const B = this.B\n    const C = this.C\n\n    const angleRad = (this.alpha * Math.PI) / 180\n\n    // Point final de la demi-droite (longueur maximale)\n    const rayEndLength = this.rayLength * this.pixelsParCm\n    const rayEnd = {\n      x: A.x + rayEndLength * Math.cos(angleRad),\n      y: A.y - rayEndLength * Math.sin(angleRad),\n    }\n\n    // le segment AB (base)\n    const lineAB = this.createLine(A.x, A.y, B.x, B.y, '#000', 3)\n    this.svg.appendChild(lineAB)\n\n    // la demi-droite AC (jusqu'au point final)\n    const lineAC = this.createLine(A.x, A.y, rayEnd.x, rayEnd.y, '#666', 1)\n    lineAC.setAttribute('stroke-dasharray', '5,5')\n    this.svg.appendChild(lineAC)\n\n    // les points de division sur AC\n    const pointsC = []\n    for (let i = 0; i <= this.n; i++) {\n      const lengthCm = i * this.AC1Length\n      const lengthPixels = lengthCm * this.pixelsParCm\n      pointsC.push({\n        x: A.x + lengthPixels * Math.cos(angleRad),\n        y: A.y - lengthPixels * Math.sin(angleRad),\n      })\n    }\n\n    // la ligne de r√©f√©rence depuis Cn vers B\n    const referenceLine = this.createLine(\n      pointsC[this.n].x,\n      pointsC[this.n].y,\n      B.x,\n      B.y,\n      '#2196F3',\n      2,\n    )\n    this.svg.appendChild(referenceLine)\n\n    // les points de division sur AB et tracer les parall√®les\n    const pointsD = []\n    for (let i = 0; i <= this.n; i++) {\n      const t = i / this.n\n      const pointD = {\n        x: A.x + t * (B.x - A.x),\n        y: A.y + t * (B.y - A.y),\n      }\n      pointsD.push(pointD)\n\n      // Tracer les lignes depuis Ci vers Di (parall√®les √† CnB)\n      if (i > 0 && i < this.n) {\n        const line = this.createLine(\n          pointsC[i].x,\n          pointsC[i].y,\n          pointD.x,\n          pointD.y,\n          '#999',\n          i === this.p ? 2 : 1,\n        )\n\n        // Ajouter des pointill√©s pour toutes les lignes sauf celle de p\n        if (i !== this.p) {\n          line.setAttribute('stroke-dasharray', '5,3')\n        }\n\n        this.svg.appendChild(line)\n      }\n    }\n\n    // Marquer les points avec des arcs de compas\n    const acAngle = (Math.atan2(rayEnd.y - A.y, rayEnd.x - A.x) * 180) / Math.PI\n    const arcLength = 20\n\n    pointsC.forEach((point, i) => {\n      if (i > 0) {\n        const distance = Math.sqrt((point.x - A.x) ** 2 + (point.y - A.y) ** 2)\n        const angleRadians = arcLength / distance\n        const angleDegrees = (angleRadians * 180) / Math.PI\n\n        this.createArc(\n          A.x,\n          A.y,\n          distance,\n          acAngle - angleDegrees,\n          acAngle + angleDegrees,\n          i === this.n ? '#4CAF50' : '#999',\n          i === this.n ? 2 : 1,\n          `Arc de compas C${i}`,\n        )\n      }\n    })\n\n    // Mettre en √©vidence le segment ADp et marquer le point Dp\n    if (this.p > 0 && this.p <= this.n) {\n      const segmentColor = this.targetColor || '#F44336'\n      const highlightLine = this.createLine(\n        A.x,\n        A.y,\n        pointsD[this.p].x,\n        pointsD[this.p].y,\n        segmentColor,\n        4,\n      )\n      this.svg.appendChild(highlightLine)\n\n      // Marquer le point Dp avec un segment perpendiculaire\n      const pointDp = pointsD[this.p]\n      const segmentLength = 8\n\n      const abVector = { x: B.x - A.x, y: B.y - A.y }\n      const abLength = Math.sqrt(abVector.x ** 2 + abVector.y ** 2)\n      const perpVector = {\n        x: -abVector.y / abLength,\n        y: abVector.x / abLength,\n      }\n\n      const startPoint = {\n        x: pointDp.x + perpVector.x * segmentLength,\n        y: pointDp.y + perpVector.y * segmentLength,\n      }\n      const endPoint = {\n        x: pointDp.x - perpVector.x * segmentLength,\n        y: pointDp.y - perpVector.y * segmentLength,\n      }\n\n      const perpLine = this.createLine(\n        startPoint.x,\n        startPoint.y,\n        endPoint.x,\n        endPoint.y,\n        '#F44336',\n        2,\n      )\n      this.svg.appendChild(perpLine)\n    } else if (this.p === 0) {\n      // Cas sp√©cial pour p = 0 : marquer le point A avec un petit cercle rouge\n      const markerCircle = this.createCircle(\n        A.x,\n        A.y,\n        6,\n        'none',\n        'Point D0 (A)',\n      )\n      markerCircle.setAttribute('stroke', '#F44336')\n      markerCircle.setAttribute('stroke-width', '2')\n      markerCircle.setAttribute('fill', 'none')\n      this.svg.appendChild(markerCircle)\n    }\n\n    // Ajouter un segment perpendiculaire rouge fixe au point A\n    const segmentLength = 8\n    const abVector = { x: B.x - A.x, y: B.y - A.y }\n    const abLength = Math.sqrt(abVector.x ** 2 + abVector.y ** 2)\n    const perpVector = {\n      x: -abVector.y / abLength,\n      y: abVector.x / abLength,\n    }\n\n    const aStartPoint = {\n      x: A.x + perpVector.x * segmentLength,\n      y: A.y + perpVector.y * segmentLength,\n    }\n    const aEndPoint = {\n      x: A.x - perpVector.x * segmentLength,\n      y: A.y - perpVector.y * segmentLength,\n    }\n\n    const aPerpLine = this.createLine(\n      aStartPoint.x,\n      aStartPoint.y,\n      aEndPoint.x,\n      aEndPoint.y,\n      '#F44336',\n      2,\n    )\n    this.svg.appendChild(aPerpLine)\n\n    // Ajouter des labels\n    this.createText(A.x - 10, A.y + 20, 'A', '#000', '16px', 'middle')\n    this.createText(B.x + 10, B.y + 20, 'B', '#000', '16px', 'middle')\n    this.createText(C.x, C.y - 10, 'C', '#000', '16px', 'middle')\n\n    if (this.n === 1) {\n      this.createText(\n        C.x + 30,\n        C.y - 30,\n        'D√©placer le point C Pour diviser [AB], puis...',\n        '#000',\n        '16px',\n        'start',\n      )\n    }\n\n    if (this.getLengthAB() === 1) {\n      this.createText(\n        B.x + 20,\n        B.y - 20,\n        'D√©placer le point B pour ajuster la longueur AB',\n        ' #000',\n        '16px',\n        'start',\n      )\n    }\n    // Ajouter le label D sous le point Dp\n    if (this.p > 0) {\n      const pointDp = pointsD[this.p]\n      this.createText(\n        pointDp.x,\n        pointDp.y + 25,\n        'D',\n        '#F44336',\n        '16px',\n        'middle',\n      )\n    }\n\n    // Affichage conditionnel du rapport\n    if (this.printRatio) {\n      if (this.p > 0) {\n        const ratio = `${this.p}/${this.n}`\n        this.createText(\n          (A.x + B.x) / 2,\n          A.y + 35,\n          `AD/AB = ${ratio}`,\n          '#F44336',\n          '14px',\n          'middle',\n        )\n      }\n    }\n    if (this.p === 0 && this.n > 1) {\n      this.createText(\n        A.x + 20,\n        A.y + 35,\n        `D√©placer le cercle rouge pour cr√©er le point D`,\n        '#000',\n        '16px',\n        'start',\n      )\n    }\n    // Cr√©er les points draggables A, B, C et Dp\n    this.createDraggablePoints(A, B, C, pointsD[this.p])\n\n    // V√©rifier la target √† la fin\n    this.checkTargetReached()\n\n    // Mettre √† jour l'affichage\n    this.updateLengthDisplay()\n  }\n\n  // M√©thodes utilitaires pour cr√©er des √©l√©ments SVG\n  createLine(\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    stroke: string,\n    strokeWidth: number,\n  ) {\n    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line')\n    line.setAttribute('x1', x1.toString())\n    line.setAttribute('y1', y1.toString())\n    line.setAttribute('x2', x2.toString())\n    line.setAttribute('y2', y2.toString())\n    line.setAttribute('stroke', stroke)\n    line.setAttribute('stroke-width', strokeWidth.toString())\n    return line\n  }\n\n  createCircle(cx: number, cy: number, r: number, fill: string, title: string) {\n    const circle = document.createElementNS(\n      'http://www.w3.org/2000/svg',\n      'circle',\n    )\n    circle.setAttribute('cx', cx.toString())\n    circle.setAttribute('cy', cy.toString())\n    circle.setAttribute('r', r.toString())\n    circle.setAttribute('fill', fill)\n    circle.setAttribute('stroke', '#000')\n    circle.setAttribute('stroke-width', '1')\n\n    // Ajouter un titre pour l'accessibilit√©\n    const titleElement = document.createElementNS(\n      'http://www.w3.org/2000/svg',\n      'title',\n    )\n    titleElement.textContent = title\n    circle.appendChild(titleElement)\n\n    return circle\n  }\n\n  // Modifier pour cr√©er une zone de drag m√™me quand p = 0\n  createDraggablePoints(\n    A: { x: number; y: number },\n    B: { x: number; y: number },\n    C: { x: number; y: number },\n    Dp: { x: number; y: number },\n  ) {\n    // Point A (non draggable, juste un marqueur)\n    const aCircle = this.createCircle(A.x, A.y, 2, '#007bff', 'Point A')\n    this.svg.appendChild(aCircle)\n\n    // Point B (contraint horizontalement)\n    const bCircle = this.createCircle(B.x, B.y, 3, '#28a745', 'Point B')\n    bCircle.setAttribute('data-draggable', 'B')\n    bCircle.style.cursor = 'ew-resize'\n    this.svg.appendChild(bCircle)\n\n    // Point C (contraint sur la demi-droite)\n    const cCircle = this.createCircle(C.x, C.y, 4, '#ff6b35', 'Point C')\n    cCircle.setAttribute('data-draggable', 'C')\n    cCircle.style.cursor = 'ew-resize'\n    this.svg.appendChild(cCircle)\n\n    // Point Dp : toujours cr√©er une zone de drag, m√™me si p = 0\n    const dpZone = this.createCircle(\n      Dp.x,\n      Dp.y,\n      this.p === 0 ? 15 : 10, // Zone plus grande si p = 0 pour compenser l'absence de segment\n      'transparent',\n      `Point D${this.p}`,\n    )\n    dpZone.setAttribute('data-draggable', 'Dp')\n    dpZone.style.cursor = 'ew-resize'\n    dpZone.setAttribute('stroke', 'none')\n    dpZone.setAttribute('fill-opacity', '0')\n    this.svg.appendChild(dpZone)\n  }\n\n  createText(\n    x: number,\n    y: number,\n    text: string,\n    color: string,\n    fontSize: string,\n    anchor: 'start' | 'middle' | 'end' = 'middle',\n  ) {\n    const textElement = document.createElementNS(\n      'http://www.w3.org/2000/svg',\n      'text',\n    )\n    textElement.setAttribute('x', x.toString())\n    textElement.setAttribute('y', y.toString())\n    textElement.setAttribute('fill', color)\n    textElement.setAttribute('font-size', fontSize)\n    textElement.setAttribute('font-family', 'Arial, sans-serif')\n    // Ancrage configurable\n    textElement.setAttribute('text-anchor', anchor)\n    textElement.setAttribute('dominant-baseline', 'middle')\n    textElement.textContent = text\n    this.svg.appendChild(textElement)\n    return textElement\n  }\n  createArc(\n    cx: number,\n    cy: number,\n    r: number,\n    startAngle: number,\n    endAngle: number,\n    color: string,\n    width: number,\n    title: string,\n  ) {\n    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\n    // Convertir les angles en radians\n    const startRad = (startAngle * Math.PI) / 180\n    const endRad = (endAngle * Math.PI) / 180\n\n    // Calculer les points de d√©but et fin de l'arc\n    const startX = cx + r * Math.cos(startRad)\n    const startY = cy + r * Math.sin(startRad)\n    const endX = cx + r * Math.cos(endRad)\n    const endY = cy + r * Math.sin(endRad)\n\n    // Cr√©er le chemin SVG pour l'arc\n    const largeArcFlag = Math.abs(endAngle - startAngle) > 180 ? 1 : 0\n    const pathData = `M ${startX} ${startY} A ${r} ${r} 0 ${largeArcFlag} 1 ${endX} ${endY}`\n\n    path.setAttribute('d', pathData)\n    path.setAttribute('stroke', color)\n    path.setAttribute('stroke-width', width.toString())\n    path.setAttribute('fill', 'none')\n    if (title) path.setAttribute('title', title)\n\n    this.svg.appendChild(path)\n    return path\n  }\n\n  // Mettre √† jour la propri√©t√© value pour retourner la longueur ACp\n  get value() {\n    if (this.p === 0) {\n      return 0 // AD0 = 0\n    }\n\n    const A = this.A\n    const B = this.B\n\n    const ABx = B.x - A.x\n    const ABy = B.y - A.y\n    const ABLength = Math.sqrt(ABx * ABx + ABy * ABy)\n\n    const lengthCm = (this.p / this.n) * (ABLength / this.pixelsParCm)\n    return parseFloat(lengthCm.toFixed(3))\n  }\n\n  // Calculer la longueur AB en cm\n  getLengthAB() {\n    const A = this.A\n    const B = this.B\n    const lengthPixels = Math.sqrt((B.x - A.x) ** 2 + (B.y - A.y) ** 2)\n    const lengthCm = lengthPixels / this.pixelsParCm\n    return parseFloat(lengthCm.toFixed(2))\n  }\n\n  // Ajouter cette m√©thode qui manquait\n  createSVG() {\n    // Cr√©er le SVG\n    this.svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n    this.svg.setAttribute('width', '800')\n    this.svg.setAttribute('height', '400')\n    this.svg.setAttribute('viewBox', '0 0 800 400')\n    this.svg.style.width = '100%'\n    this.svg.style.height = '100%'\n\n    this.appendChild(this.svg)\n  }\n\n  connectedCallback() {\n    // R√©cup√©rer les param√®tres depuis l'attribut data\n    this.parseDataAttributes()\n\n    this.createSVG()\n    this.createLengthDisplay()\n    // Plus besoin d'initEventListeners() car plus d'inputs externes\n    this.setupDragListeners()\n    this.redraw()\n  }\n\n  disconnectedCallback() {\n    // Supprimer tous les listeners pour √©viter les fuites m√©moire\n    this.removeEventListeners()\n  }\n\n  // Nouvelle m√©thode pour parser les attributs data\n  parseDataAttributes() {\n    try {\n      const dataAttr = this.getAttribute('data')\n      if (dataAttr) {\n        const data = JSON.parse(dataAttr)\n\n        // D'abord d√©finir alpha (n√©cessaire pour calculer C)\n        if (\n          typeof data.alpha === 'number' &&\n          data.alpha >= 10 &&\n          data.alpha <= 80\n        ) {\n          this.alpha = data.alpha\n        }\n\n        // Ensuite d√©finir A si fourni, sinon garder la valeur par d√©faut\n        if (\n          data.A &&\n          typeof data.A.x === 'number' &&\n          typeof data.A.y === 'number'\n        ) {\n          this.A = { x: data.A.x, y: data.A.y }\n        }\n\n        // MODIFIER : Changer 10 en 1 pour correspondre au constructeur\n        // FORCER AB = 1 cm peu importe les donn√©es pass√©es\n        this.B = {\n          x: this.A.x + 1 * this.pixelsParCm,\n          y: this.A.y,\n        }\n\n        // Puis d√©finir n et recalculer C\n        if (typeof data.n === 'number' && data.n >= 1 && data.n <= 10) {\n          this.n = data.n\n        }\n\n        // IMPORTANT : Recalculer C apr√®s avoir d√©fini A et alpha\n        this.C = this.calculateInitialC()\n\n        // MODIFIER pour supporter p = 0\n        if (typeof data.p === 'number' && data.p >= 0 && data.p < this.n) {\n          // p peut √™tre 0, mais doit √™tre < n\n          this.p = data.p\n        } else if (typeof data.p === 'number') {\n          this.p = Math.max(0, Math.min(this.n - 1, data.p)) // Limiter entre 0 et n-1\n        }\n\n        // SUPPRIMER : Ne plus utiliser lengthAB pour fixer la longueur\n        // L'√©l√®ve devra ajuster manuellement la position de B\n        if (typeof data.lengthAB === 'number' && data.lengthAB > 0) {\n          // Stocker la longueur cible pour l'affichage, mais ne pas l'appliquer\n          this.lengthAB = data.lengthAB\n        }\n\n        // Fraction cible (targetFraction)\n        if (typeof data.targetFraction === 'string') {\n          this.targetFraction = data.targetFraction\n        }\n\n        // SUPPRIMER : Plus d'option snapToCentimeter car l'aimantation est syst√©matique\n\n        // Option printAD\n        if (typeof data.printAD === 'boolean') {\n          this.printAD = data.printAD\n        }\n\n        // Option printRatio\n        if (typeof data.printRatio === 'boolean') {\n          this.printRatio = data.printRatio\n        }\n\n        // Nouvelle option fractionToDecimalAD\n        if (typeof data.fractionToDecimalAD === 'boolean') {\n          this.fractionToDecimalAD = data.fractionToDecimalAD\n        }\n\n        // Option displayTargetOn\n        if (typeof data.displayTargetOn === 'boolean') {\n          this.displayTargetOn = data.displayTargetOn\n        }\n\n        // Nouveau : target\n        if (typeof data.target === 'number' && data.target > 0) {\n          this.target = data.target\n        }\n\n        if (data.id) {\n          this.id = data.id\n        }\n\n        // Callback optionnel pour quand la target est atteinte\n        if (typeof data.onTargetReached === 'string') {\n          const callbackName = data.onTargetReached\n          if (\n            window[callbackName] &&\n            typeof window[callbackName] === 'function'\n          ) {\n            this.onTargetReached = window[callbackName]\n          }\n        }\n      }\n    } catch (error) {\n      window.notify('Erreur lors du parsing des attributs data:', error)\n    }\n  }\n\n  // SUPPRIMER cette m√©thode car on ne veut plus fixer automatiquement AB\n  // setInitialABLength(targetLengthCm: number) {\n  //   // M√©thode supprim√©e - l'√©l√®ve doit ajuster manuellement\n  // }\n\n  // Modifier initEventListeners pour ne pas d√©pendre des √©l√©ments de contr√¥le externes\n  setupDragListeners() {\n    // V√©rifier si les listeners sont d√©j√† ajout√©s\n    if (this.listenersAdded) return\n\n    // Cr√©er les handlers en tant que propri√©t√©s pour pouvoir les supprimer\n    this.mouseDownHandler = (e) => this.onMouseDown(e)\n    this.mouseMoveHandler = (e) => this.onMouseMove(e)\n    this.mouseUpHandler = () => this.onMouseUp()\n    this.touchStartHandler = (e) => this.onTouchStart(e)\n    this.touchMoveHandler = (e) => this.onTouchMove(e)\n    this.touchEndHandler = () => this.onTouchEnd()\n\n    // Mouse events\n    this.svg.addEventListener('mousedown', this.mouseDownHandler)\n    this.svg.addEventListener('mousemove', this.mouseMoveHandler)\n    window.addEventListener('mouseup', this.mouseUpHandler)\n\n    // Touch events\n    this.svg.addEventListener('touchstart', this.touchStartHandler, {\n      passive: false,\n    })\n    this.svg.addEventListener('touchmove', this.touchMoveHandler, {\n      passive: false,\n    })\n    window.addEventListener('touchend', this.touchEndHandler)\n\n    this.listenersAdded = true\n  }\n\n  // Nouvelle m√©thode pour supprimer tous les listeners\n  private removeEventListeners() {\n    if (!this.listenersAdded || !this.svg) return\n\n    try {\n      // Supprimer les mouse events\n      if (this.mouseDownHandler) {\n        this.svg.removeEventListener('mousedown', this.mouseDownHandler)\n      }\n      if (this.mouseMoveHandler) {\n        this.svg.removeEventListener('mousemove', this.mouseMoveHandler)\n      }\n      if (this.mouseUpHandler) {\n        window.removeEventListener('mouseup', this.mouseUpHandler)\n      }\n\n      // Supprimer les touch events\n      if (this.touchStartHandler) {\n        this.svg.removeEventListener('touchstart', this.touchStartHandler)\n      }\n      if (this.touchMoveHandler) {\n        this.svg.removeEventListener('touchmove', this.touchMoveHandler)\n      }\n      if (this.touchEndHandler) {\n        window.removeEventListener('touchend', this.touchEndHandler)\n      }\n\n      // R√©initialiser les r√©f√©rences\n      this.mouseDownHandler = undefined\n      this.mouseMoveHandler = undefined\n      this.mouseUpHandler = undefined\n      this.touchStartHandler = undefined\n      this.touchMoveHandler = undefined\n      this.touchEndHandler = undefined\n\n      this.listenersAdded = false\n    } catch (error) {\n      console.warn('Erreur lors de la suppression des listeners:', error)\n    }\n  }\n\n  onMouseDown(e: MouseEvent) {\n    const target = e.target as SVGElement\n    const draggable = target.getAttribute('data-draggable')\n\n    if (draggable) {\n      this.isDragging = true\n      this.dragTarget = draggable\n      e.preventDefault()\n      // Appliquer le curseur double-fl√®che pour tous les points draggables\n      target.style.cursor = 'ew-resize'\n    }\n  }\n\n  onMouseMove(e: MouseEvent) {\n    if (!this.isDragging || !this.dragTarget) return\n\n    const pt = this.screenToSVG(e.clientX, e.clientY)\n\n    if (this.dragTarget === 'B') {\n      let x = pt.x\n      let y = this.A.y // m√™me ordonn√©e que A\n\n      // Aimantation syst√©matique au centim√®tre: deltaX = k * pixelsParCm\n      const deltaX = x - this.A.x\n      const k = Math.round(deltaX / this.pixelsParCm)\n      x = this.A.x + k * this.pixelsParCm\n\n      this.updatePointPosition(x, y)\n    } else if (this.dragTarget === 'C') {\n      const constrainedC = this.constrainCOnRay(pt.x, pt.y)\n      this.updatePointPosition(constrainedC.x, constrainedC.y)\n    } else if (this.dragTarget === 'Dp') {\n      const constrainedDp = this.constrainDpOnSegment(pt.x, pt.y)\n      this.p = constrainedDp.p\n      this.updatePointPosition(constrainedDp.x, constrainedDp.y)\n    }\n  }\n\n  onMouseUp() {\n    if (this.isDragging && this.dragTarget) {\n      // Restaurer le curseur pour tous les points draggables\n      const circles = this.svg.querySelectorAll('[data-draggable]')\n      circles.forEach((circle) => {\n        ;(circle as HTMLElement).style.cursor = 'ew-resize'\n      })\n    }\n\n    this.isDragging = false\n    this.dragTarget = null\n  }\n\n  onTouchStart(e: TouchEvent) {\n    e.preventDefault()\n    const touch = e.touches[0]\n    const target = e.target as SVGElement\n    const draggable = target.getAttribute('data-draggable')\n\n    if (draggable) {\n      this.isDragging = true\n      this.dragTarget = draggable\n    }\n  }\n\n  onTouchMove(e: TouchEvent) {\n    e.preventDefault()\n    if (!this.isDragging || !this.dragTarget) return\n\n    const touch = e.touches[0]\n    const pt = this.screenToSVG(touch.clientX, touch.clientY)\n\n    if (this.dragTarget === 'B') {\n      let x = pt.x\n      let y = this.A.y\n\n      // Aimantation syst√©matique au centim√®tre\n      const deltaX = x - this.A.x\n      const k = Math.round(deltaX / this.pixelsParCm)\n      x = this.A.x + k * this.pixelsParCm\n\n      this.updatePointPosition(x, y)\n    } else if (this.dragTarget === 'C') {\n      const constrainedC = this.constrainCOnRay(pt.x, pt.y)\n      this.updatePointPosition(constrainedC.x, constrainedC.y)\n    } else if (this.dragTarget === 'Dp') {\n      const constrainedDp = this.constrainDpOnSegment(pt.x, pt.y)\n      this.p = constrainedDp.p\n      this.updatePointPosition(constrainedDp.x, constrainedDp.y)\n    }\n  }\n\n  onTouchEnd() {\n    this.isDragging = false\n    this.dragTarget = null\n  }\n\n  // Ajouter cette m√©thode manquante pour convertir les coordonn√©es √©cran en coordonn√©es SVG\n  screenToSVG(clientX: number, clientY: number) {\n    const rect = this.svg.getBoundingClientRect()\n    const scaleX = this.svg.viewBox.baseVal.width / rect.width\n    const scaleY = this.svg.viewBox.baseVal.height / rect.height\n\n    return {\n      x: (clientX - rect.left) * scaleX,\n      y: (clientY - rect.top) * scaleY,\n    }\n  }\n\n  updatePointPosition(x: number, y: number) {\n    if (this.dragTarget === 'B') {\n      this.B.x = Math.max(0, Math.min(800, x))\n      this.B.y = Math.max(0, Math.min(400, y))\n    } else if (this.dragTarget === 'C') {\n      const constrained = this.constrainCOnRay(x, y)\n      this.C.x = constrained.x\n      this.C.y = constrained.y\n    }\n    this.redraw()\n  }\n\n  // Nouvelle m√©thode priv√©e pour v√©rifier la target\n  private checkTargetReached() {\n    if (this.target === null) return\n\n    const currentValue = this.value\n    const threshold = 0.02 // Seuil de tol√©rance en cm\n\n    const wasReached = this.targetReached\n    this.targetReached = Math.abs(currentValue - this.target) <= threshold\n\n    // Si la target vient d'√™tre atteinte (pas d√©j√† atteinte avant)\n    if (this.targetReached && !wasReached) {\n      // D√©clencher le callback si d√©fini\n      if (this.onTargetReached) {\n        this.onTargetReached()\n      }\n\n      // Optionnel : d√©clencher un √©v√©nement custom\n      this.dispatchEvent(\n        new CustomEvent('targetReached', {\n          detail: {\n            currentValue,\n            target: this.target,\n            difference: Math.abs(currentValue - this.target),\n          },\n        }),\n      )\n    }\n  }\n\n  // M√©thode publique pour d√©finir une nouvelle target\n  setTarget(newTarget: number | null) {\n    this.target = newTarget\n    this.targetReached = false\n    this.redraw()\n  }\n\n  // M√©thode publique pour obtenir l'√©tat de la target\n  isTargetReached(): boolean {\n    return this.targetReached\n  }\n\n  // Ajouter cette m√©thode pour cr√©er l'affichage de longueur\n  createLengthDisplay() {\n    this.lengthDisplay = document.createElement('div')\n    this.lengthDisplay.style.position = 'absolute'\n    this.lengthDisplay.style.top = '10px'\n    this.lengthDisplay.style.left = '10px'\n    this.lengthDisplay.style.background = 'rgba(255, 255, 255, 0.9)'\n    this.lengthDisplay.style.padding = '8px'\n    this.lengthDisplay.style.borderRadius = '4px'\n    this.lengthDisplay.style.fontSize = '14px'\n    this.lengthDisplay.style.fontFamily = 'monospace'\n    this.lengthDisplay.style.border = '1px solid #ccc'\n    this.appendChild(this.lengthDisplay)\n  }\n  // Nouvelle m√©thode pour formater la valeur AD selon les param√®tres\n  formatADValue(lengthCm: number): string {\n    if (this.p === 0) {\n      return 'AD = 0 cm (A et D confondus)'\n    }\n\n    if (this.fractionToDecimalAD) {\n      const currentAB = Math.round(this.getLengthAB())\n      const theoreticalValue = (this.p * currentAB) / this.n\n\n      // V√©rifier si la valeur th√©orique est \"d√©cimale\" (√† 0.01 pr√®s)\n      const roundedValue = Math.round(theoreticalValue * 100) / 100\n      const isDecimal = Math.abs(theoreticalValue - roundedValue) < 0.001\n\n      if (isDecimal) {\n        // Affichage d√©cimal avec virgule fran√ßaise pour LaTeX\n        const decimalStr = Number.isInteger(roundedValue)\n          ? roundedValue.toString()\n          : roundedValue.toString().replace('.', '{,}')\n        return `AD = $${decimalStr}$ cm`\n      } else {\n        return `AD = $\\\\dfrac{${this.p * currentAB}}{${this.n}}$ cm`\n      }\n    } else {\n      // Comportement par d√©faut : affichage fractionnaire simplifi√©\n      return `AD = ${formatFraction(lengthCm)} cm`\n    }\n  }\n\n  updateLengthDisplay() {\n    const lengthCm = this.value\n    const lengthAB = this.getLengthAB()\n\n    let targetDisplay = ''\n    if (this.displayTargetOn) {\n      if (this.target !== null) {\n        const difference = Math.abs(lengthCm - this.target)\n        const status = this.targetReached ? '‚úÖ' : '‚ùå'\n\n        // Cr√©er un √©l√©ment temporaire pour rendre le LaTeX\n        const tempDiv = document.createElement('div')\n        // Utiliser this.lengthAB (longueur cible) dans l'affichage LaTeX\n        const targetAB = this.lengthAB || lengthAB\n        tempDiv.innerHTML = `AD: $${this.targetFraction}\\\\times ${targetAB}\\\\text{ cm}$`\n\n        // Rendre le LaTeX avec la fonction renderKatex de mathalea\n        try {\n          renderKatex(tempDiv)\n          const renderedContent = tempDiv.innerHTML\n\n          targetDisplay = `\n          <div style=\"font-size: 12px; color: ${this.targetReached ? 'green' : 'red'};\">\n            ${renderedContent} ${status}\n            ${!this.targetReached ? `(√©cart: ${difference.toFixed(3)} cm)` : ''}\n          </div>\n        `\n        } catch (error) {\n          window.notify('Erreur lors du rendu KaTeX:', error)\n          // Fallback: affichage sans rendu LaTeX\n          targetDisplay = `\n          <div style=\"font-size: 12px; color: ${this.targetReached ? 'green' : 'red'};\">\n            AD: ${this.targetFraction} √ó ${targetAB} cm ${status}\n            ${!this.targetReached ? `(√©cart: ${difference.toFixed(3)} cm)` : ''}\n          </div>\n        `\n        }\n      }\n    }\n\n    // Affichage conditionnel de la longueur AD avec le nouveau formatage\n    let displayText = ''\n    if (this.printAD) {\n      displayText = this.formatADValue(lengthCm)\n    }\n\n    this.lengthDisplay.innerHTML = `\n      ${this.printAD ? `<div>${displayText}</div>` : ''}\n      <div style=\"font-size: 12px; color: #666;\">AB = ${formatFraction(lengthAB)} cm</div>\n      ${targetDisplay}\n    `\n\n    // Rendre le LaTeX dans l'√©l√©ment final si n√©cessaire\n    try {\n      renderKatex(this.lengthDisplay)\n    } catch (error) {\n      window.notify('Erreur lors du rendu KaTeX final:', error)\n    }\n  }\n}\ncustomElements.define('guide-ane', GuideAne)\n\n/**\n * Fonction utilitaire pour cr√©er facilement un guide-√¢ne dans les exercices Mathalea\n * @param options - Options de configuration du guide-√¢ne\n * @returns Le code HTML de la balise <guide-√¢ne>\n */\nexport function addGuideAne(\n  options: {\n    alpha?: number // Angle en degr√©s (d√©faut: 45)\n    targetAB?: number // Longueur AB cible en cm (pour affichage seulement)\n    targetValue?: number // Valeur cible pour ADp en cm (optionnel)\n    A?: { x: number; y: number } // Position du point A (optionnel)\n    width?: string // Largeur du composant (d√©faut: \"800px\")\n    height?: string // Hauteur du composant (d√©faut: \"400px\")\n    id?: string // ID unique pour le composant (optionnel)\n    className?: string // Classes CSS additionnelles (optionnel)\n    printAD?: boolean // Afficher la longueur AD (d√©faut: false)\n    printRatio?: boolean // Afficher le rapport (d√©faut: false)\n    fractionToDecimalAD?: boolean // Afficher AD en d√©cimal si possible (d√©faut: false)\n    targetFraction?: string // Fraction cible (optionnel)\n    displayTargetOn?: boolean // Afficher l'√©tat de la target (d√©faut: false)\n  } = {},\n): string {\n  // Valeurs par d√©faut\n  const config = {\n    n: 1,\n    p: 0,\n    alpha: options.alpha ?? 45,\n    targetAB: options.targetAB, // Renommer lengthAB en targetAB\n    A: options.A,\n    // SUPPRIMER B car il sera toujours calcul√© √† 10 cm de A\n    width: options.width ?? '800px',\n    height: options.height ?? '400px',\n    id: options.id,\n    className: options.className,\n    targetValue: options.targetValue ?? null,\n    printAD: options.printAD ?? false,\n    printRatio: options.printRatio ?? false,\n    fractionToDecimalAD: options.fractionToDecimalAD ?? false,\n    targetFraction: options.targetFraction ?? '0/1',\n    displayTargetOn: options.displayTargetOn ?? false,\n  }\n\n  // Construire l'objet data pour passer au composant\n  const data: any = {\n    n: config.n,\n    p: config.p,\n    alpha: config.alpha,\n    printAD: config.printAD,\n    printRatio: config.printRatio,\n    fractionToDecimalAD: config.fractionToDecimalAD,\n  }\n\n  // Ajouter les param√®tres optionnels s'ils sont d√©finis\n  if (config.targetAB !== undefined) {\n    data.lengthAB = config.targetAB // Stocker comme cible pour l'affichage\n  }\n\n  if (config.A) {\n    data.A = config.A\n  }\n\n  // SUPPRIMER : Ne plus passer B dans les donn√©es car il sera toujours √† 10 cm\n\n  // Construire les attributs HTML\n  const attributes: string[] = []\n\n  if (config.id) {\n    attributes.push(`id=\"${config.id}\"`)\n  }\n\n  if (config.className) {\n    attributes.push(`class=\"${config.className}\"`)\n  }\n\n  if (config.targetValue !== null) {\n    data.target = config.targetValue\n  }\n\n  if (config.targetFraction) {\n    data.targetFraction = config.targetFraction\n  }\n\n  if (config.displayTargetOn) {\n    data.displayTargetOn = config.displayTargetOn\n  }\n\n  // Ajouter les styles inline\n  const styles = [`width: ${config.width}`, `height: ${config.height}`]\n  attributes.push(`style=\"${styles.join('; ')}\"`)\n\n  // Encoder les donn√©es en JSON pour l'attribut data\n  const dataJson = JSON.stringify(data).replace(/\"/g, '&quot;')\n  attributes.push(`data=\"${dataJson}\"`)\n\n  // Construire et retourner la balise HTML\n  const attributesStr = attributes.length > 0 ? ` ${attributes.join(' ')}` : ''\n  return `<guide-ane${attributesStr}></guide-ane>`\n}\n\n/**\n * Objet contenant des raccourcis pour cr√©er des guide-√¢nes avec des configurations courantes\n */\nexport const GuideAnePresets = {\n  /**\n   * Guide-√¢ne basique avec param√®tres essentiels\n   */\n  basic: (alpha: number = 45) => addGuideAne({ alpha }),\n\n  /**\n   * Guide-√¢ne avec longueur AB cible (l'√©l√®ve doit ajuster manuellement)\n   */\n  withTargetLength: (targetAB: number, alpha: number = 45) =>\n    addGuideAne({ alpha, targetAB }),\n\n  /**\n   * Guide-√¢ne avec position personnalis√©e du point A\n   */\n  withPosition: (A: { x: number; y: number }, alpha: number = 45) =>\n    addGuideAne({ alpha, A }),\n\n  /**\n   * Guide-√¢ne compact (plus petit)\n   */\n  compact: (alpha: number = 45) =>\n    addGuideAne({ alpha, width: '600px', height: '300px' }),\n\n  /**\n   * Guide-√¢ne avec ID et classe pour styling personnalis√©\n   */\n  styled: (id: string, className: string = '', alpha: number = 45) =>\n    addGuideAne({ alpha, id, className }),\n\n  /**\n   * Guide-√¢ne pour exercice al√©atoire\n   */\n  random: (alphaChoices: number[] = [30, 45, 60]) => {\n    const alpha = alphaChoices[Math.floor(Math.random() * alphaChoices.length)]\n    return addGuideAne({ alpha })\n  },\n}\n\n// Importer renderKatex de mathalea\nimport { renderKatex } from '../mathalea'\n","import { demiDroite } from '../../lib/2d/DemiDroite'\nimport { droite } from '../../lib/2d/droites'\nimport { fixeBordures } from '../../lib/2d/fixeBordures'\nimport { addGuideAne, type GuideAne } from '../../lib/2d/GuidaAne'\nimport { pointAbstrait } from '../../lib/2d/PointAbstrait'\nimport { segmentAvecExtremites } from '../../lib/2d/segmentsVecteurs'\nimport { labelPoint } from '../../lib/2d/textes'\nimport { tracePointSurDroite } from '../../lib/2d/TracePointSurDroite'\nimport { homothetie, similitude } from '../../lib/2d/transformations'\nimport { ajouteFeedback } from '../../lib/interactif/questionMathLive'\nimport { choice } from '../../lib/outils/arrayOutils'\nimport { egalOuApprox } from '../../lib/outils/ecritures'\nimport { context } from '../../modules/context'\nimport { mathalea2d } from '../../modules/mathalea2d'\nimport { randint } from '../../modules/outils'\nimport type { NestedObjetMathalea2dArray } from '../../types/2d'\nimport Exercice from '../Exercice'\n\nexport const titre =\n  'Utiliser le guide-√¢ne pour construire un segment de longueur donn√©e'\nexport const uuid = '327f2'\nexport const interactifReady = true\nexport const interactifType = 'custom'\nexport const refs = {\n  'fr-fr': ['4G30-0'],\n  'fr-ch': [],\n}\nexport const dateDePublication = '30/12/2025'\n/**\n * @author Jean-Claude Lhote\n */\nexport default class MonExoGuideAne extends Exercice {\n  constructor() {\n    super()\n    this.nbQuestions = 1\n    this.besoinFormulaireCaseACocher = ['Affichage de la longueur AD']\n    this.besoinFormulaire2CaseACocher = ['Affichage du rapport AD/AB']\n  }\n\n  nouvelleVersion(): void {\n    for (let i = 0, cpt = 0; i < this.nbQuestions && cpt < 50; ) {\n      const alpha = choice([30, 45, 60])\n      const targetAB = randint(5, 16, 10)\n\n      // G√©n√©rer une fraction cible al√©atoire\n      const targetN = randint(3, 8)\n      const targetP = randint(1, targetN - 1)\n      const targetFraction = `\\\\dfrac{${targetP}}{${targetN}}`\n      const targetValue = (targetAB * targetP) / targetN\n      let texte = `Repr√©senter en rouge un segment de longueur $${targetFraction}\\\\times AB$`\n\n      if (context.isHtml) {\n        const guideAneData = {\n          id: `guideAneEx${this.numeroExercice}Q${i}`,\n          alpha,\n          targetAB,\n          targetFraction,\n          snapToCentimeter: true,\n          disableADrag: true,\n          targetValue,\n          printAD: this.sup,\n          printRatio: this.sup2,\n          fractionToDecimalAD: true,\n          displayTargetOn: false,\n        }\n        texte += `.<br>Utilisez les points draggables pour ajuster la construction du guide-√¢ne.<br>\n       ${addGuideAne(guideAneData)}<span id=\"resultatCheckEx${this.numeroExercice}Q${0}\"></span><br>\n       ${ajouteFeedback(this, i)}`\n      } else {\n        // contexte latex\n        texte += ' sans utiliser les graduations de la r√®gle.<br>'\n\n        const objets: NestedObjetMathalea2dArray = []\n        const A = pointAbstrait(0, 0, 'A', 'below left')\n        const B = pointAbstrait(targetAB, 0, 'B', 'below right')\n        const C = similitude(B, A, 30, 1)\n        const d = droite(A, C)\n        for (let k = 1; k < 11; k++) {\n          const Ck = homothetie(C, A, k / 10, `C_${k}`, 'above')\n          const traceCk = tracePointSurDroite(Ck, d, 'gray')\n          objets.push(traceCk)\n        }\n        objets.push(labelPoint(A, B))\n        const AB = segmentAvecExtremites(A, B, 'black')\n        const AC = demiDroite(A, C, 'gray')\n        objets.push(AB, AC)\n        texte += mathalea2d(Object.assign({}, fixeBordures(objets)), objets)\n      }\n      if (this.questionJamaisPosee(i, targetAB, targetN, targetP)) {\n        this.listeQuestions.push(texte)\n        i++\n      }\n      cpt++\n    }\n  }\n\n  correctionInteractive = (i: number) => {\n    const spanReponseLigne = document.querySelector(\n      `#resultatCheckEx${this.numeroExercice}Q${i}`,\n    )\n    const divFeedback = document.querySelector(\n      `#feedbackEx${this.numeroExercice}Q${i}`,\n    )\n    let isOk = false\n    const guideAne = document.getElementById(\n      `guideAneEx${this.numeroExercice}Q${i}`,\n    ) as GuideAne\n    if (guideAne == null) {\n      window.notify(`Pas trouv√© le guide-√¢ne dans cet exercice pour i=${i}`, {})\n      return 'KO'\n    }\n    isOk = guideAne.isTargetReached()\n    let feedback = ''\n    if (!isOk) {\n      const AB = guideAne.getLengthABValue()\n      const n = guideAne.getN()\n      const p = guideAne.getP()\n      feedback = `Votre segment $[AB]$ mesure $${AB}$ cm.<br>\n      Le segment $[AD]$ doit mesurer $\\\\dfrac{${p}}{${n}}\\\\times ${AB}${egalOuApprox((p * AB) / n, 2)}$ cm pour que le rapport $\\\\dfrac{AD}{AB}$ soit √©gal √† $\\\\dfrac{${p}}{${n}}$.`\n    }\n\n    if (spanReponseLigne) {\n      if (isOk) {\n        spanReponseLigne.innerHTML = 'üòé'\n      } else {\n        spanReponseLigne.innerHTML = '‚òπÔ∏è'\n      }\n    }\n    if (divFeedback && feedback !== '') {\n      divFeedback.innerHTML = feedback\n    }\n\n    return isOk ? 'OK' : 'KO'\n  }\n}\n"],"names":["detectPixelsPerCm","testElement","pixelsPerCm","error","decimalToFraction","decimal","maxDenominator","bestNumerator","bestDenominator","bestError","denominator","numerator","formatFraction","showDecimal","fraction","fractionStr","GuideAne","__publicField","Dp","callback","originalRedraw","angleRad","ACLength","ACLengthCm","x","y","direction","vectorAC","projectionCm","snappedLength","A","B","t","AB","AP","ABLength","projection","maxT","clampedT","discreteP","snappedT","C","rayEndLength","rayEnd","lineAB","lineAC","pointsC","i","lengthPixels","referenceLine","pointsD","pointD","line","acAngle","arcLength","point","distance","angleDegrees","segmentColor","highlightLine","pointDp","segmentLength","abVector","abLength","perpVector","startPoint","endPoint","perpLine","markerCircle","aStartPoint","aEndPoint","aPerpLine","ratio","x1","y1","x2","y2","stroke","strokeWidth","cx","cy","r","fill","title","circle","titleElement","aCircle","bCircle","cCircle","dpZone","text","color","fontSize","anchor","textElement","startAngle","endAngle","width","path","startRad","endRad","startX","startY","endX","endY","largeArcFlag","pathData","ABx","ABy","lengthCm","dataAttr","data","callbackName","e","target","draggable","pt","deltaX","k","constrainedC","constrainedDp","touch","clientX","clientY","rect","scaleX","scaleY","constrained","currentValue","threshold","wasReached","newTarget","currentAB","theoreticalValue","roundedValue","lengthAB","targetDisplay","difference","status","tempDiv","targetAB","renderKatex","renderedContent","displayText","addGuideAne","options","config","attributes","styles","dataJson","titre","uuid","interactifReady","interactifType","refs","dateDePublication","MonExoGuideAne","Exercice","spanReponseLigne","divFeedback","isOk","guideAne","feedback","n","p","egalOuApprox","cpt","alpha","choice","randint","targetN","targetP","targetFraction","targetValue","texte","context","guideAneData","ajouteFeedback","objets","pointAbstrait","similitude","d","droite","Ck","homothetie","traceCk","tracePointSurDroite","labelPoint","segmentAvecExtremites","AC","demiDroite","mathalea2d","fixeBordures"],"mappings":"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"}