{"version":3,"file":"listePatterns-ErTMVxGS.js","sources":["../../src/exercices/profs/listePatterns.ts"],"sourcesContent":["import Decimal from 'decimal.js'\nimport { isNumber } from 'mathjs'\nimport {\n  cubeDef,\n  faceLeft,\n  faceRight,\n  faceTop,\n  project3dIso,\n  shapeCubeIso,\n  updateCubeIso,\n} from '../../lib/2d/figures2d/Shape3d'\nimport {\n  listeShapes2DInfos,\n  shapeNames,\n  type ShapeName,\n} from '../../lib/2d/figures2d/shapes2d'\nimport { fixeBordures } from '../../lib/2d/fixeBordures'\nimport {\n  listePattern3d,\n  listePatternRatio,\n  listePatternsSansRatioNiFraction,\n  type PatternRiche,\n  type PatternRiche3D,\n} from '../../lib/2d/patterns/patternsPreDef'\nimport { VisualPattern } from '../../lib/2d/patterns/VisualPattern'\nimport { VisualPattern3D } from '../../lib/2d/patterns/VisualPattern3D'\nimport { point } from '../../lib/2d/PointAbstrait'\nimport { polygone } from '../../lib/2d/polygones'\nimport { texteParPosition } from '../../lib/2d/textes'\nimport { bleuMathalea } from '../../lib/colors'\nimport { choice } from '../../lib/outils/arrayOutils'\nimport {\n  miseEnEvidence,\n  texteEnCouleurEtGras,\n} from '../../lib/outils/embellissements'\nimport { context } from '../../modules/context'\nimport { mathalea2d } from '../../modules/mathalea2d'\nimport { randint } from '../../modules/outils'\nimport type { NestedObjetMathalea2dArray } from '../../types/2d'\nimport Exercice from '../Exercice'\n\nexport const titre = \"Liste des patterns disponibles pour l'exercice 6N4B\"\nexport const dateDePublication = '26/11/2025'\n\nexport const refs = {\n  'fr-fr': ['P023'],\n  'fr-ch': [],\n}\nexport const uuid = '71ff5'\n\n/**\n * Affiche les patterns propres à un exercice\n * @author Eric Elter (sur la base de listePatterns de Jean-Claude Lhote)\n\n */\nexport default class ListePatternsTousLesExos extends Exercice {\n  destroyers: (() => void)[] = []\n\n  constructor() {\n    super()\n    this.nbQuestions = 1\n    this.listePackages = ['twemojis'] // this.listePackages est inutile mais la présence du mot \"twemojis\" est indispensable pour la sortie LaTeX.\n    this.nbQuestionsModifiable = false\n    this.besoinFormulaireNumerique = [\n      'Liste restreinte pour la référence',\n      6,\n      '1 : 6N4B\\n2 : 6N4B-2\\n3 : 5I13\\n4 : 5L10-5\\n5 : 5P12-2\\n6 : 4L13-3',\n    ]\n    this.sup = 1\n\n    this.besoinFormulaire3Numerique = ['Nombre de motifs par pattern', 6]\n    this.sup3 = 4\n    this.comment = `Cette page affiche la liste des patterns disponibles dans des exercices avec leur numéro de référence et pour information, le nombre d'éléments \n    pour le motif 43 ainsi que le nombre d'éléments au rang n de chaque pattern.<br>`\n  }\n\n  destroy() {\n    // MGu quan l'exercice est supprimé par svelte : bouton supprimé\n    this.destroyers.forEach((destroy) => destroy())\n    this.destroyers.length = 0\n  }\n\n  nouvelleVersion(): void {\n    // MGu quand l'exercice est modifié, on détruit les anciens listeners\n    this.destroyers.forEach((destroy) => destroy())\n    this.destroyers.length = 0\n    this.sup3 = Math.max(2, this.sup3) // On ne peut pas afficher moins de 2 motifs\n    let texte = ''\n\n    let listeOfAll: (PatternRiche | PatternRiche3D)[] = []\n    switch (this.sup) {\n      case 1:\n      case 3:\n      case 4:\n      case 6:\n        listeOfAll = listePatternsSansRatioNiFraction\n        break\n      case 2:\n        listeOfAll = listePattern3d\n      case 5:\n        listeOfAll = listePatternRatio\n        break\n    }\n\n    if (listeOfAll == null || listeOfAll.length === 0) return\n    for (let i = 0; i < listeOfAll.length; i++) {\n      const pat = listeOfAll[i]\n      if (pat == null) {\n        texte += `\\n${texteEnCouleurEtGras(`Pattern ${i + 1}`, 'red')}: ${texteEnCouleurEtGras('Pattern inexistant', 'red')}`\n        continue\n      }\n\n      if ('nbMotifMin' in pat && isNumber(pat.nbMotifMin)) {\n        // On est en présence d'un motif répétitif\n        const objets: NestedObjetMathalea2dArray = []\n        if ('shapes' in pat) {\n          for (const shape of pat.shapes) {\n            if (shape in listeShapes2DInfos) {\n              objets.push(listeShapes2DInfos[shape].shapeDef)\n            }\n          }\n        }\n\n        for (let j = 0; j <= pat.nbMotifMin; j++) {\n          const pattern = new VisualPattern([])\n\n          if ('shapes' in pat) pattern.shapes = pat.shapes\n          if ('iterate' in pat) pattern.iterate = pat.iterate\n          objets.push(pattern.render(j, j + 1, 0))\n        }\n        texte += `\\n${texteEnCouleurEtGras(`Pattern ${i + 1}`, 'blue')}:  <br>`\n        texte += mathalea2d(\n          Object.assign(\n            fixeBordures(objets, { rxmin: 0, rymin: -1, rxmax: 0, rymax: 1 }),\n            { pixelsParCm: 20, scale: 0.4, optionsTikz: 'transform shape' },\n          ),\n          objets,\n        )\n      } else {\n        const n43 = !('nbMotifMin' in pat)\n          ? new Decimal(pat.fonctionNb(43)).toString()\n          : null\n        const infosShape =\n          pat.shapes[0] in listeShapes2DInfos\n            ? listeShapes2DInfos[pat.shapes[0]]\n            : { articleCourt: 'de ', nomPluriel: 'cubes' }\n\n        const nom = infosShape.nomPluriel\n\n        const patternRiche = pat\n        const pattern =\n          'iterate3d' in patternRiche\n            ? new VisualPattern3D({\n                initialCells: [],\n                type: 'iso',\n                prefixId: `Ex${this.numeroExercice}Q${i}`,\n                shapes: ['cube'],\n              })\n            : new VisualPattern([])\n        if (pattern instanceof VisualPattern3D) {\n          pattern.shapes = ['cube']\n          pattern.iterate3d = (patternRiche as PatternRiche3D).iterate3d\n        } else {\n          pattern.shapes =\n            (patternRiche as PatternRiche).shapes ||\n            (shapeNames[randint(0, shapeNames.length - 1)] as ShapeName)\n          pattern.iterate = (patternRiche as PatternRiche).iterate\n        }\n\n        const angle = Math.PI / 2.5\n        let yMax = 0\n        let yMin = 0\n\n        const figures: NestedObjetMathalea2dArray[] = []\n        for (let j = 0; j < this.sup3; j++) {\n          figures[j] = []\n          let objets: NestedObjetMathalea2dArray = []\n          let ymin = Infinity\n          let ymax = -Infinity\n          let xmin = Infinity\n          let xmax = -Infinity\n          if (context.isHtml) {\n            const nom = String(choice(Object.keys(listeShapes2DInfos)))\n            for (let n = 0; n < pattern.shapes.length; n++) {\n              let name = pattern.shapes[n]\n              if (name in listeShapes2DInfos) {\n                if (name === 'carré') {\n                  name = nom\n                  pattern.shapes[n] = nom\n                  figures[j].push(listeShapes2DInfos[nom].shapeDef)\n                } else figures[j].push(listeShapes2DInfos[name].shapeDef)\n              } else if (name === 'cube') {\n                const cubeIsoDef = cubeDef(`cubeIsoQ${i}F${j}`, 1)\n                cubeIsoDef.svg = function (coeff: number): string {\n                  return `\n          <defs>\n            <g id=\"cubeIsoQ${i}F${j}\">\n              ${faceTop(angle)}\n              ${faceLeft(angle)}\n              ${faceRight(angle)}\n            </g>\n          </defs>`\n                }\n                figures[j].push(cubeIsoDef)\n              } else {\n                console.warn(\n                  `Shape ${name} n'est pas dans listeShapesDef ou emojis et n'est pas un cube`,\n                )\n              }\n            }\n          }\n          if (pattern instanceof VisualPattern3D) {\n            if (pattern.shape == null) {\n              pattern.shape = shapeCubeIso(`cubeIsoQ${i}F${j}`, 1, 1, {\n                scale: 1,\n              })\n            }\n            if (context.isHtml) {\n              const listeners = updateCubeIso({ pattern, i, j, angle })\n              if (listeners) this.destroyers.push(listeners)\n              pattern.shape.codeSvg = `<use href=\"#cubeIsoQ${i}F${j}\"></use>`\n              const cells = (pattern as VisualPattern3D).update3DCells(j + 1)\n              // Ajouter les SVG générés par svg() de chaque objet\n              cells.forEach((cell) => {\n                const scale = 1\n                const [px, py] = project3dIso(cell[0], cell[1], cell[2], angle)\n                const obj = shapeCubeIso(`cubeIsoQ${i}F${j}`, px, py, { scale })\n                obj.x = px / 20\n                obj.y = -py / 20\n                objets.push(obj)\n                ymin = Math.min(ymin, obj.y * scale)\n                ymax = Math.max(ymax, (obj.y + 1) * scale)\n                xmin = Math.min(xmin, obj.x * scale)\n                xmax = Math.max(xmax, (obj.x + 1) * scale)\n              })\n            } else {\n              objets = [\n                cubeDef(`cubeIsoQ${i}F${j}`),\n                ...pattern.render(j + 1, 0, 0, Math.PI / 6),\n              ]\n              ;({ xmin, ymin, xmax, ymax } = fixeBordures(objets))\n            }\n          } else {\n            objets = pattern.render(j + 1, 0, 0)\n            ;({ xmin, ymin, xmax, ymax } = fixeBordures(objets))\n          }\n          figures[j].push(...objets)\n          figures[j].push(\n            texteParPosition(\n              `Motif ${j + 1}`,\n              (xmax + xmin) / 2,\n              -1.5,\n              0,\n              'black',\n              0.8,\n              'milieu',\n            ),\n          )\n          const cadre = polygone(\n            point(xmin - 2, -2),\n            point(xmax + 2, -2),\n            point(xmax + 2, ymax + 2),\n            point(xmin - 2, ymax + 2),\n          )\n          cadre.pointilles = 4\n          figures[j].push(cadre)\n\n          yMax = Math.max(yMax, ymax)\n          yMin = Math.min(yMin, ymin)\n        }\n        texte += `${texteEnCouleurEtGras(`Pattern ${i + 1}`, 'blue')}:<br> Pour le motif 43, il y a ${n43} ${nom}.<br>`\n        texte += `Pour le motif $${miseEnEvidence('n', bleuMathalea)}$, il y a $${miseEnEvidence(pat.formule, bleuMathalea)}$ éléments.<br>`\n\n        texte +=\n          figures\n            .map((fig, index) =>\n              mathalea2d(\n                Object.assign(\n                  fixeBordures(fig, {\n                    rxmin: 0,\n                    rymin: -1,\n                    rxmax: 0,\n                    rymax: 1,\n                  }),\n                  {\n                    id: `Motif${i}F${index}`,\n                    pixelsParCm: 20,\n                    yMax,\n                    yMin,\n                    scale: 0.5,\n                    style: 'display: inline-block',\n                    optionsTikz: 'transform shape',\n                  },\n                ),\n                fig,\n              ),\n            )\n            .join('\\n') + '<br>'\n      }\n    }\n    this.listeQuestions = [texte]\n  }\n}\n"],"names":["titre","dateDePublication","refs","uuid","ListePatternsTousLesExos","Exercice","__publicField","destroy","texte","listeOfAll","listePatternsSansRatioNiFraction","listePattern3d","listePatternRatio","i","pat","texteEnCouleurEtGras","isNumber","objets","shape","listeShapes2DInfos","j","pattern","VisualPattern","mathalea2d","fixeBordures","n43","Decimal","nom","patternRiche","VisualPattern3D","shapeNames","randint","angle","yMax","yMin","figures","ymin","ymax","xmin","xmax","context","choice","n","name","cubeIsoDef","cubeDef","coeff","faceTop","faceLeft","faceRight","shapeCubeIso","listeners","updateCubeIso","cell","px","py","project3dIso","obj","texteParPosition","cadre","polygone","point","miseEnEvidence","bleuMathalea","fig","index"],"mappings":"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"}