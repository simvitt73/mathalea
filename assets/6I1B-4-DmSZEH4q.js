var A=Object.defineProperty;var w=(h,c,o)=>c in h?A(h,c,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[c]=o;var x=(h,c,o)=>w(h,typeof c!="symbol"?c+"":c,o);import{c as H}from"./utilitairesGeometriques-rO8Jz15i.js";import{p as v}from"./PointAbstrait-Cz1GEocE.js";import{p as B}from"./polygones-dllpvdk8.js";import{s as I}from"./segmentsVecteurs-Dh5p_FwX.js";import{a as j}from"./textes-CS7rU0Yo.js";import{E as q,c4 as P,r as $,al as V,B as M,Y as N,P as S,bJ as R,o as W,_ as k,aj as _,p as J}from"./index-vfG7N0N9.js";import{m as X}from"./mathalea2d-CVCH8NiC.js";import"./ObjetMathalea2D-CXcNXRpD.js";import"./vendors/earcut-jJVragJp.js";import"./pattern-I1sXJuF2.js";import"./vendors/roughjs-CycZv-lV.js";/* empty css                         */import"./vendors/svelte-BrkG1v2Q.js";import"./vendors/clsx-B-dksMZM.js";import"./vendors/esm-env-rsSWfq8L.js";import"./vendors/ua-parser-js-D4W63oil.js";import"./vendors/three-DbtVOfJ6.js";import"./vendors/decimal.js-BceHFVC1.js";import"./vendors/katex-BSW5_u9c.js";import"./vendors/seedrandom-Cz-2rAdY.js";import"./vendors/apigeom-DuS4UMKQ.js";import"./vendors/mathjs-DKCMnljp.js";import"./vendors/babel_runtime-BFeZ_VDU.js";import"./vendors/javascript-natural-sort-QZS4Fyws.js";import"./vendors/escape-latex-BegatI0j.js";import"./vendors/complex.js-C1JbXRlX.js";import"./vendors/typed-function-CVM02vEe.js";import"./vendors/fraction.js-CYLvagDM.js";import"./vendors/tiny-emitter-DbO2P2s3.js";import"./vendors/xstate-BSXD3zxA.js";import"./vendors/crypto-js-DElKCTCw.js";import"./json/referentielStaticCH-DrWiqhRe.js";import"./json/referentielStaticFR-DTeSOhOd.js";import"./json/uuidsToUrlFR-BymNGK-G.js";import"./vendors/cortex-js_compute-engine-Bo_2zfG3.js";import"./vendors/jspreadsheet-ce-kKqtlqR-.js";import"./vendors/jsuites-D-TmSgJs.js";import"./vendors/jspreadsheet_formula-CXu1m5Ak.js";import"./vendors/mathlive-2YgxEGya.js";import"./vendors/bugsnag_js-B7oJ4uO9.js";import"./vendors/bugsnag_browser-CBi0d3dm.js";import"./vendors/big-integer-RrBdqg8C.js";import"./vendors/mixer_postmessage-rpc-JyZjM7pP.js";import"./vendors/eventemitter3-COjgItKg.js";import"./vendors/scratchblocks-BVPCj2Ee.js";import"./json/scratchFr-BNITwCy2.js";import"./json/refToUuidFR-CKp8Whw5.js";import"./json/refToUuidCH-C3otjGt1.js";import"./json/codeToLevelList-BfkorBF2.js";import"./json/codeToThemeList-B4uzTsqe.js";import"./vendors/loadjs-Dy50zFDn.js";import"./json/referentielProfs-BdpwqI3j.js";import"./json/uuidsRessources-jdCgFfXb.js";import"./json/referentielBibliotheque-sQm1j5fm.js";import"./vendors/file-saver-Cqu1O8xU.js";import"./vendors/jszip-BuNf6wCF.js";import"./vendors/jszip-utils-DhFX1KUq.js";import"./vendors/copy-image-clipboard-Cf9y-QAU.js";import"./vendors/qrcode-BsrOgw3n.js";import"./vendors/dijkstrajs-COg3n3zL.js";import"./vendors/brace-DEOAbY2S.js";import"./json/referentielAppsTierce-SxU58PZT.js";import"./vendors/sortablejs-DdTU3J9A.js";import"./json/carouselContent-Bjt6Yxr-.js";import"./json/levelsThemesList-CXNnIZKX.js";import"./json/levelsThemesListCH-BErSids0.js";import"./json/referentiel2022CH-CxJkatM_.js";import"./json/referentiel2022FR-DUyIuCDZ.js";import"./json/referentielGeometrieDynamique-BJ2PHXsv.js";import"./json/referentielRessources-BU2QQoSD.js";import"./json/referentielsActivation-CpD_hoec.js";const yt="Programmer des calculs sur tableur",xt="12/08/2025",$t=!0,vt="custom",Ct="ae07c",Et={"fr-fr":["6I1B-4"],"fr-ch":[]},T="ABCDEFGHIJKLMNOPQRSTUVWXYZ",b=class b extends q{constructor(){super();x(this,"destroyers",[]);x(this,"listeSteps",[]);x(this,"correctionInteractive",o=>{if(o===void 0)return"";this.answers===void 0&&(this.answers={});let r="KO";const l=document.getElementById(`sheet-Ex${this.numeroExercice}Q${o}`);if(!l)return console.error(`sheet-Ex${this.numeroExercice}Q${o} not found`),r;if(l&&l.isMounted()){this.answers[`sheet-Ex${this.numeroExercice}Q${o}`]=JSON.stringify(l.getData());const e=document.querySelector(`#resultatCheckEx${this.numeroExercice}Q${o}`),t=document.querySelector(`#feedbackEx${this.numeroExercice}Q${o}`),{isOk:a,messages:i}=this.validateFormulas(o,l);i.length>0&&e&&t&&(t.innerHTML=i,a?(e&&(e.innerHTML="üòé"),r="OK"):e&&(e.innerHTML="‚òπÔ∏è"))}return r});this.nbQuestions=2,this.besoinFormulaireNumerique=["Nombre d'op√©rations (entre 2 et 5 ou bien 1 si vous laissez le hasard d√©cider)",5],this.besoinFormulaire2Texte=["Type d'op√©rations",["Nombres s√©par√©s par des tirets  :","1 : Addition","2 : Soustraction","3 : Multiplication","4 : Division","5 : M√©lange"].join(`
`)],this.sup=3,this.sup2=5,this.listeSteps=[]}destroy(){this.destroyers.forEach(o=>o()),this.destroyers.length=0}validateFormulas(o,r){const l=r.getData(),e=this.listeSteps[o].length,t=P.create({data:l,minDimensions:r.getMinDimensions(),style:r.getStyle(),columns:r.getColumns(),interactif:!1,id:"testSheet"});t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t);const a=[];for(let p=0;p<e;p++){a[p]=[];const s=$(1,10);t.setCellValue(0,0,s);const d=V(e).map(u=>parseFloat(t.getCellValue(u,0)));for(let u=1;u<e+1;u++)(typeof d[u-1]!="number"||isNaN(d[u-1]))&&a[p].push(`La cellule ${String.fromCharCode(65+u)}1 ne contient pas un nombre valide.<br>`);for(let u=1;u<e+1;u++)(typeof t.getCellFormula(u,0)!="string"||!t.getCellFormula(u,0).startsWith("="))&&a[p].push(`La cellule ${String.fromCharCode(65+u)}1 ne contient pas une formule valide.<br>`);let m=s;for(let u=1;u<e+1;u++){const y=this.listeSteps[o];m=U(m,y[u-1].op,y[u-1].val);const n=parseFloat(t.getCellValue(u,0));Math.abs(n-m)>1e-9&&a[p].push(`Pour un nombre de d√©part √©gal √† ${s}, la cellule ${String.fromCharCode(65+u)}1 devrait contenir $${M(m,2)}$ mais elle contient $${M(n,2)}$.<br>`)}}const i=a.reduce((p,s)=>s.length>p.length?s:p,[]);document.body.removeChild(t);const f=i.length===0?"‚úÖ Toutes les formules sont correctes !":"‚ùå Des erreurs ont √©t√© d√©t√©ct√©es.";return{isOk:i.length===0,messages:i.join("")+f}}checkSolution(o){var a;const r=o==null?void 0:o.type,l=(a=r==null?void 0:r.match(/Q(\d+)/))==null?void 0:a[1];if(!l){console.error("Question number not found in event name:",r);return}const e=(r==null?void 0:r.replace("check","sheet-"))||"",t=document.getElementById(e);if(t&&t.isMounted()){const{messages:i}=this.validateFormulas(Number(l),t),f=t.querySelector("#message-faux");i&&f&&(f.style.color="green",f.innerHTML=i)}}nouvelleVersion(){this.destroyers.forEach(e=>e()),this.destroyers.length=0;const o=this.sup===1?$(2,5):Math.min(Math.max(2,this.sup),5),r=N({saisie:this.sup2,min:1,max:4,melange:5,defaut:5,nbQuestions:o});this.listeSteps=[];const l=Object.entries(b.colors);for(let e=0,t=0,a,i;e<this.nbQuestions&&t<50;t++){const{steps:f}=Y(r);this.listeSteps[e]=f;const p=K(f),s={0:{0:{v:f[0].oldn,s:"style_id_orange",t:2}}};for(let n=0;n<f.length;n++)s[0][n+1]={v:"",s:`style_id_${l[(n+1)%l.length][0]}`};const d=[[]];d[0][0]=s[0][0].v;for(let n=0;n<f.length;n++)d[0][n+1]=s[0][n+1].v;const m={0:{v:f[0].oldn.toString(),bg:l[0][1]}};for(let n=0,g=1;n<f.length;n++,g+=2)m[`${g}`]={v:p[n]},m[`${g+1}`]={bg:l[(n+1)%l.length][1]};a="On a cr√©√© le programme de calculs suivant :<br>",a+=G(Object.keys(m).length,m)+"<br>",a+=`On choisit un nombre dans la premi√®re case, ici ${f[0].oldn} et on obtient un nombre √† la fin de la cha√Æne.<br><br>      
      On veut programmer cette suite de calculs dans un tableur. <br>
      Par exemple, la cellule B1 doit contenir la formule du premier calcul.<br>
      Faire de m√™me pour les autres cellules. <br>
      Attention, les formules doivent fonctionner m√™me si le nombre de d√©part change (Cellule A1).<br>
      `;const u=z(Object.values(b.colors),f.length);if(S.isHtml)a+=R({numeroExercice:this.numeroExercice??0,question:e,data:d,minDimensions:[4,4],style:u,columns:[{width:90},{width:90},{width:90},{width:90}],interactif:this.interactif,showVerifyButton:!0});else{const n={};n.formule=!0,n.formuleTexte="=?",n.formuleCellule="B1",a+=Z(2,f.length+1,s,b.styles,n)}i="Voici les formules √† saisir dans le tableur :<br>";for(let n=0;n<f.length;n++){const g=f[n];i+=`$${g.oldn} ${p[n]} = ${g.result}$ devient en cellule ${T[n+1]}1 la formule suivante : "=${T[n]}1${p[n].replace("\\times","*").replace("\\div","/")}"<br>`}const y=()=>{var g;const n=Array.from(document.querySelectorAll("my-spreadsheet"));for(const C of n){const E=(g=C.id.match(/Q(\d+)$/))==null?void 0:g[1],D=E!==void 0&&this.numeroExercice!==void 0?`checkEx${this.numeroExercice}Q${E}`:void 0;if(C&&D){const L=Q=>{this.checkSolution(Q)};C.addListener(D,L)}else console.error(`SheetElement not found or eventName invalid for question ${E} in exercice ${this.numeroExercice}`)}document.removeEventListener("exercicesAffiches",y)};document.addEventListener("exercicesAffiches",y,{once:!0}),this.questionJamaisPosee(e,a)&&(this.listeQuestions[e]=a,this.listeCorrections[e]=i,e++),W(this)}}};x(b,"colors",{orange:"#e6b457",vert:"#7adb7a",jaune:"#e6e66a",bleu:"#8181e6",violet:"#f8a3f8",rouge:"#eca2a2"}),x(b,"styles",{style_id_rouge:{fs:12,bg:b.colors.rouge},style_id_bleu:{fs:12,bg:b.colors.bleu},style_id_orange:{fs:12,bg:b.colors.orange},style_id_violet:{fs:12,bg:b.colors.violet},style_id_vert:{fs:12,bg:b.colors.vert},style_id_jaune:{fs:12,bg:b.colors.jaune}});let O=b;const F=["A","B","C","D","E","F"];function z(h,c){const o=Math.max(1,Math.min(c+1,F.length)),r={};for(let l=0;l<o;l++){const e=`${F[l]}1`,t=h[l]?`background: ${h[l]}`:"background:  #ffffff";r[e]=t}return r}function K(h){function c(o){const r={1:"+",2:"‚àí",3:"\\times",4:"\\div"};return o.map(l=>(r[l.op]||"?")+l.val)}return c(h)}function U(h,c,o){return c===1?h+o:c===2?h-o:c===3?h*o:c===4?h/o:NaN}function Y(h=[1,2,3,4]){let c=[],o=null,r=h,l=0,e=!1;for(;!e&&l<20;){r=k(r);let t=$(5,20);c=[],e=!0;for(let a=0,i=0;a<r.length&&i<4;){if(i>0){const m=r.slice(0,a),u=k(r.slice(a));r=[...m,...u]}const f=r[a],p=t;let s=1;const d=a>0?c[a-1].val:1;if(f===1)if(50-t<2||50-t===2&&d===2){i++;continue}else s=$(2,50-t,[d]),t+=s,a++,i=0;else if(f===2)if(t<2||t===2&&d===2){i++;continue}else s=$(2,t,[d]),t-=s,a++,i=0;else if(f===3){const m=t<1?5:Math.floor(50/t);if(m<2||m===2&&d===2){i++;continue}else s=$(2,m,[d]),t*=s,a++,i=0}else if(f===4){const m=_(t).filter(u=>u>1&&u<t);if(m.length===0||m.length===1&&m[0]===d){i++;continue}else s=J(m,[d]),t/=s,a++,i=0}if(t<0||t>50||!Number.isInteger(t)){i+=10;continue}c.push({oldn:p,op:f,val:s,result:t})}c.length!==r.length&&(e=!1),e&&(o=t),l++}return{ops:r,steps:c,final:o}}function G(h,c){const e=[];for(let p=0;p<h;p++){const s=v(p*1.8+p*.8,0),d=v(s.x+1.8,0),m=v(d.x,1.5),u=v(s.x,1.5),y=c[p],n=B(s,d,m,u);if(y&&y.bg&&(n.couleurDeRemplissage=H(y.bg),n.opaciteDeRemplissage=1),e.push(n),y&&y.v){const g=j(`${y.v}`,(s.x+d.x)/2,(s.y+u.y)/2,{color:"red",backgroundColor:"none",letterSize:S.isHtml?"small":"normalsize",orientation:0,opacity:1});e.push(g)}if(p>0){const g=I(s.x-.8,.75,s.x,.75,"#f15929");g.styleExtremites="->",e.push(g)}}const t=-.5,a=-.5,i=1.8*h+.8*(h-1)+.5,f=1.5+.5;return X({xmin:t,ymin:a,xmax:i,ymax:f,mainlevee:!1,scale:S.isHtml?1:.5,style:"margin: auto",optionsTikz:["baseline=(current bounding box.north)"]},e)}function Z(h,c,o,r,l={}){var a;let e=`\\begin{tabularx}{0.9\\linewidth}
  {|>{\\cellcolor{lightgray}}c|
  ${l.firstColHeaderWidth?`>{\\centering \\arraybackslash}p{${l.firstColHeaderWidth}}|`:">{\\centering \\arraybackslash}X|"}
  *{${c-1}}{>{\\centering \\arraybackslash}X|}}\\hline
`;l.formule&&(e+=`\\multicolumn{1}{|l}{${l.formuleCellule}}&\\multicolumn{1}{r|}{‚ñº}&\\multicolumn{${c-1}}{l|}{${l.formuleTexte}}\\\\ \\hline
`),e+="\\rowcolor{lightgray} &";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<c-1;i++)e+=`\\textbf{\\sffamily ${t[i]}}  & `;e+=`\\textbf{\\sffamily ${t[c-1]}} \\\\ \\hline
`;for(let i=0;i<h;i++){const f=o[i]||{};e+=`\\textbf{\\sffamily ${i+1}} &`;for(let p=0;p<c;p++){const s=f[p]||{},d=r[s.s??""]||{};let m="";(a=d.bg)!=null&&a.startsWith("#")?m=`\\cellcolor[HTML]{${d.bg.replace("#","")}}`:d.bg&&(m=`\\cellcolor{${d.bg}}`),(s==null?void 0:s.t)===1?e+=`\\raggedright ${m} ${s.v||""}  &`:(s==null?void 0:s.t)===2?e+=`\\raggedleft ${m} ${s.v||""}  &`:(s==null?void 0:s.t)===3?e+=`\\centering ${m} ${s.v?"VRAI":"FAUX"}  &`:e+=`${m} ${s.v||""}  &`}e=e.slice(0,-1),e+=`\\\\ \\hline
`}return e+=`\\end{tabularx}
`,e}export{z as buildStyleFromColos,xt as dateDePublication,O as default,$t as interactifReady,vt as interactifType,Et as refs,yt as titre,Ct as uuid};
//# sourceMappingURL=6I1B-4-DmSZEH4q.js.map
