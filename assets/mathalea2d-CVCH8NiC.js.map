{"version":3,"file":"mathalea2d-CVCH8NiC.js","sources":["../../src/modules/mathalea2d.ts"],"sourcesContent":["import katex from 'katex'\nimport { ObjetMathalea2D } from '../lib/2d/ObjetMathalea2D'\nimport { normaliseOrientation } from '../lib/2d/utilitairesGeometriques'\nimport { buildDataKeyboardFromStyle } from '../lib/interactif/claviers/keyboard'\nimport type {\n  MetaInteractif2dData,\n  NestedObjetMathalea2dArray,\n  ObjetDivLatex,\n} from '../types/2d'\nimport { context } from './context'\nconst buildDataKeyboardString = (style = '') => {\n  const blocks = buildDataKeyboardFromStyle(style)\n  return blocks.join(' ')\n}\n/*\n  MathALEA2D\n @name      mathalea2d\n @author    Rémi Angot et Jean-Claude Lhote\n @license   MIT License - CC-BY-SA\n @homepage  https://coopmaths.fr/mathalea2d.html\n */\n\n// Remarque : la définition concrète de ObjetMathalea2D vit désormais dans\n// src/lib/2d/ObjetMathalea2D.ts ; on n'effectue plus de réexport runtime ici\n// (cela évite des dépendances circulaires).\n// export { ObjetMathalea2D } from '../lib/2d/ObjetMathalea2D'\n\n/**\n * mathalea2d(xmin,xmax,ymin,ymax,objets)\n *\n * @author Rémi Angot\n *\n *\n * Le paramètre optionsTikz est un tableau de strings contenant exclusivement des options Tikz à ajouter\n * si scale existe autre que 1 il faut que le code reste comme avant\n * sinon on ajoute scale quoi qu'il en soit quitte à ce que xscale et yscale viennent s'ajouter\n * de cette manière d'autres options Tikz pourront aussi être ajoutées\n * si il n'y a qu'une optionsTikz on peut passer un string\n * @param {object} options\n *  @param {number} [options.xmin = 0]\n *  @param {number} [options.ymin = 0]\n *  @param {number} [options.xmax = 15]\n *  @param {number} [options.ymax = 6]\n *  @param {number?} [options.pixelsParCm]\n *  @param {number?} [options.scale = 1]\n *  @param {number?} [options.zoom = 1]\n *  @param {string|string[]?} [options.optionsTikz = []]\n *  @param {boolean?} [options.mainlevee]\n *  @param {number?} [options.amplitude]\n *  @param {string?} [options.style = '']\n *  @param {string?} [options.id = '']\n * @param {(ObjetMathalea2D|ObjetMathalea2D[])[]} objets\n */\nexport function mathalea2d(\n  {\n    xmin = 0,\n    ymin = 0,\n    xmax = 15,\n    ymax = 6,\n    pixelsParCm = 20,\n    scale = 1,\n    zoom = 1,\n    optionsTikz = [],\n    mainlevee = false,\n    amplitude = 1,\n    style = 'display: block',\n    id = '', // L'id peut-être utile pour des animations, c'est celui du svg. Le div englobant aura un id en M2D + id\n    usePgfplots = false,\n    centerLatex = false,\n  }: {\n    xmin?: number\n    ymin?: number\n    xmax?: number\n    ymax?: number\n    pixelsParCm?: number\n    scale?: number\n    zoom?: number\n    optionsTikz?: string | string[]\n    mainlevee?: boolean\n    amplitude?: number\n    style?: string\n    id?: string\n    usePgfplots?: boolean\n    centerLatex?: boolean\n  } = {},\n  ...objets: NestedObjetMathalea2dArray\n) {\n  const ajouteCodeHtml = (\n    mainlevee: boolean,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray | ObjetDivLatex,\n    divsLatex: string[],\n    xmin: number,\n    ymax: number,\n  ) => {\n    let codeSvg = ''\n    // Dans le cas d'objets composites avec des objets Mathalea2d et des divLatex, il faut que ces objets exposent une propriété objets qui contient la liste des objets qui les composent.\n    // Cette list est substituée à l'objet ici\n    if (objets instanceof ObjetMathalea2D) {\n      if (objets.objets != null) {\n        objets = objets.objets as ObjetMathalea2D[]\n      }\n    } // c'est un objet composé d'objets. Exemple : Repere\n    if (!Array.isArray(objets) && objets != null) {\n      try {\n        const objet = objets as ObjetMathalea2D\n        if (!mainlevee || typeof objet?.svgml === 'undefined') {\n          if (objet?.svg) {\n            const code = objet.svg(pixelsParCm)\n            if (typeof code === 'string') {\n              codeSvg = '\\t' + objet.svg(pixelsParCm) + '\\n'\n            } else {\n              const codeLatex = code as ObjetDivLatex\n              // on a à faire à un divLatex.\n              if (typeof codeLatex !== 'object') {\n                window.notify(\n                  \"Dans mathalea2d, la méthode svg() de l'objet a renvoyé quelque chose d'inconnu\",\n                  { codeLatex },\n                )\n                return codeSvg\n              }\n\n              const xSvg = (codeLatex.x - xmin) * pixelsParCm * zoom\n              const ySvg = -(codeLatex.y - ymax) * pixelsParCm * zoom\n              if ('letterSize' in codeLatex) {\n                codeLatex.backgroundColor = codeLatex.backgroundColor\n                  .replace('{', '')\n                  .replace('}', '')\n                codeLatex.color = codeLatex.color\n                  .replace('{', '')\n                  .replace('}', '')\n\n                const divOuterHtml =\n                  codeLatex.backgroundColor !== '' &&\n                  codeLatex.backgroundColor !== 'none'\n                    ? `<div class=\"divLatex\" style=\"background-color: ${codeLatex.backgroundColor}; position: absolute; top: ${ySvg}px; left: ${xSvg}px; transform: translate(-50%,-50%) rotate(${-codeLatex.orientation}deg); opacity: ${codeLatex.opacity};\" data-top=${ySvg} data-left=${xSvg}>${katex.renderToString('\\\\' + codeLatex.letterSize + ' {\\\\color{' + codeLatex.color + '}{' + (codeLatex.gras ? '\\\\textbf{' : '') + codeLatex.latex + (codeLatex.gras ? '}' : '') + '}}')}</div>`\n                    : `<div class=\"divLatex\" style=\"position: absolute; top: ${ySvg}px; left: ${xSvg}px; transform: translate(-50%,-50%) rotate(${normaliseOrientation(-codeLatex.orientation)}deg); opacity: ${codeLatex.opacity};\" data-top=${ySvg} data-left=${xSvg}>${katex.renderToString('{\\\\color{' + codeLatex.color + '} \\\\' + codeLatex.letterSize + '{' + (codeLatex.gras ? '\\\\textbf{' : '') + codeLatex.latex + (codeLatex.gras ? '}' : '') + '}}')}</div>`\n                divsLatex.push(divOuterHtml)\n              } else if ('exercice' in codeLatex) {\n                if ('inputs' in codeLatex) {\n                  const code = codeLatex as unknown as MetaInteractif2dData\n                  const inputs = code.inputs\n                  const isInteractif = code.exercice.interactif\n                  for (const input of inputs) {\n                    const xSvgInput = (input.x - xmin) * pixelsParCm * zoom\n                    const ySvgInput = -(input.y - ymax) * pixelsParCm * zoom\n                    const dataKeyboard = buildDataKeyboardString(input.classe)\n                    const divOuterHtml = `<div class=\"divLatex\" style=\"position: absolute; top: ${ySvgInput}px; left: ${xSvgInput}px; transform: translate(-50%,-50%); opacity: ${input.opacity};\" data-top=${ySvgInput} data-left=${xSvgInput}>${isInteractif ? `<math-field data-keyboard=\"${dataKeyboard}\" virtual-keyboard-mode=manual readonly class=\"${input.classe} fillInTheBlanks\" id=\"MetaInteractif2dEx${code.exercice.numeroExercice}Q${code.question}field${input.index}\">${input.content.replace('%{champ1}', '\\\\placeholder[champ1]{}')}</math-field>` : katex.renderToString(input.content.replace('%{champ1}', input.blanc))}</div>`\n                    divsLatex.push(divOuterHtml)\n                  }\n                }\n              } else {\n                window.notify(\n                  \"Dans mathalea2d, la méthode svg() de l'objet a renvoyé un objet inconnu\",\n                  { codeLatex },\n                )\n              }\n            }\n          }\n        } else {\n          if (objet?.svgml) {\n            codeSvg = '\\t' + objet.svgml(pixelsParCm, amplitude) + '\\n'\n          }\n        }\n      } catch (error: unknown) {\n        window.notify(\n          error instanceof Error ? (error as Error).message : String(error),\n          { objet: JSON.stringify(objets) },\n        )\n      }\n    } else {\n      if (objets != null && Array.isArray(objets)) {\n        for (const objet of objets) {\n          codeSvg += ajouteCodeHtml(mainlevee, objet, divsLatex, xmin, ymax)\n        }\n      } else {\n        window.notify(\n          'Un problème avec ce mathalea2d, la liste des objets contient un truc louche',\n          { objets: JSON.stringify(objets) },\n        )\n      }\n    }\n    return codeSvg\n  }\n  const ajouteCodeTikz = (\n    mainlevee: boolean,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray | ObjetDivLatex,\n    skipRepere = false,\n    axisYMin?: number,\n    axisYMax?: number,\n    axisXMin?: number,\n    axisXMax?: number,\n  ) => {\n    let codeTikz = ''\n    // Skip Repere objects when using pgfplots (pgfplots handles axis/grid)\n    // Check BEFORE expanding objets.objets\n    if (\n      skipRepere &&\n      objets instanceof ObjetMathalea2D &&\n      (objets as any).isRepere === true\n    ) {\n      return codeTikz\n    }\n    // Don't expand Courbe objects when using pgfplots (they handle their own tikz output)\n    // Check BEFORE expanding objets.objets\n    const shouldNotExpand =\n      objets instanceof ObjetMathalea2D && (objets as any).usePgfplots === true\n    if (objets instanceof ObjetMathalea2D) {\n      if (objets.objets != null && !shouldNotExpand) {\n        objets = objets.objets as ObjetMathalea2D[]\n      }\n    } // c'est un objet composé d'objets. Exemple : Repere\n    if (!Array.isArray(objets)) {\n      try {\n        // Only access tikz / tikzml on actual ObjetMathalea2D instances.\n        if (objets instanceof ObjetMathalea2D) {\n          if (!mainlevee || typeof objets.tikzml === 'undefined') {\n            if (typeof objets.tikz === 'function') {\n              // Pass axis bounds to Courbe's tikz method\n              if ((objets as any).usePgfplots === true) {\n                codeTikz =\n                  '\\t' +\n                  objets.tikz(axisYMin, axisYMax, axisXMin, axisXMax) +\n                  '\\n'\n              } else {\n                codeTikz = '\\t' + objets.tikz() + '\\n'\n              }\n            }\n          } else {\n            if (typeof objets.tikzml === 'function') {\n              codeTikz = '\\t' + objets.tikzml(amplitude) + '\\n'\n            }\n          }\n        }\n        // If objets is not an ObjetMathalea2D (e.g. ObjetDivLatex), do nothing for TikZ.\n      } catch (error: unknown) {\n        console.log(error instanceof Error ? error.message : String(error))\n      }\n    } else {\n      for (const objet of objets) {\n        codeTikz += ajouteCodeTikz(\n          mainlevee,\n          objet,\n          skipRepere,\n          axisYMin,\n          axisYMax,\n          axisXMin,\n          axisXMax,\n        )\n      }\n    }\n    return codeTikz\n  }\n  // On prépare le code HTML\n  const divsLatex: string[] = []\n  let codeSvg = `<svg class=\"mathalea2d\"  ${id !== '' ? `id=\"${id}\"` : ''} width=\"${(xmax - xmin) * pixelsParCm * zoom}\" height=\"${\n    (ymax - ymin) * pixelsParCm * zoom\n  }\" viewBox=\"${xmin * pixelsParCm} ${-ymax * pixelsParCm} ${\n    (xmax - xmin) * pixelsParCm\n  } ${(ymax - ymin) * pixelsParCm}\" xmlns=\"http://www.w3.org/2000/svg\" >\\n`\n  codeSvg += ajouteCodeHtml(mainlevee, objets, divsLatex, xmin, ymax)\n  codeSvg += '\\n</svg>'\n  codeSvg = codeSvg.replace(/\\\\thickspace/gm, ' ')\n  const codeHTML = `<div class=\"svgContainer\" ${style ? `style=\"${style}\"` : ''}>\n        <div ${id !== '' ? `id=\"M2D${id}\"` : ''} style=\"position: relative;${style}\">\n          ${codeSvg}\n          ${divsLatex.join('\\n')}\n        </div>\n      </div>`\n  // On prépare le code Latex\n  // si scale existe autre que 1 il faut que le code reste comme avant\n  // sinon on ajoute scale quoi qu'il en soit quitte à ce que xscale et yscale viennent s'ajouter\n  // de cette manière d'autres options Tikz pourront aussi être ajoutées\n  // si il n'y a qu'une optionsTikz on peut passer un string\n  let codeTikz\n  const listeOptionsTikz: string[] = []\n  if (optionsTikz !== undefined) {\n    if (typeof optionsTikz === 'string') {\n      listeOptionsTikz.push(optionsTikz)\n    } else {\n      optionsTikz.forEach((e) => listeOptionsTikz.push(e))\n    }\n  }\n\n  if (usePgfplots) {\n    // Use pgfplots with axis environment instead of tikzpicture\n    codeTikz = centerLatex ? '{\\\\centering\\n' : ''\n    codeTikz += '\\\\begin{tikzpicture}[baseline'\n    for (let l = 0; l < listeOptionsTikz.length; l++) {\n      codeTikz += `,${listeOptionsTikz[l]}`\n    }\n    if (scale !== 1) {\n      codeTikz += `,scale = ${scale}`\n    }\n    codeTikz += ']\\n'\n    codeTikz += '\\\\begin{axis}[\\n'\n    codeTikz += `  xmin=${xmin}, xmax=${xmax},\\n`\n    codeTikz += `  ymin=${ymin}, ymax=${ymax},\\n`\n    codeTikz += '  axis lines=middle,\\n'\n    codeTikz += '  axis line style={-Stealth},\\n'\n    codeTikz += '  axis on top=false,\\n'\n    codeTikz += '  xlabel={},\\n'\n    codeTikz += '  ylabel={},\\n'\n    codeTikz += '  xtick distance=2,\\n'\n    codeTikz += '  ytick distance=2,\\n'\n    codeTikz += '  minor tick num=1,\\n'\n    codeTikz += '  grid=both,\\n'\n    codeTikz += '  grid style={line width=.1pt, draw=gray!30},\\n'\n    codeTikz += '  major grid style={line width=.2pt,draw=gray!50},\\n'\n    codeTikz += '  tick label style={font=\\\\scriptsize},\\n'\n    codeTikz += '  every axis plot/.append style={line width=1pt},\\n'\n    codeTikz += '  clip=true,\\n'\n    codeTikz += ']\\n'\n    // code += codeTikz(...objets)\n    codeTikz += ajouteCodeTikz(mainlevee, objets, true, ymin, ymax, xmin, xmax) // Skip Repere when using pgfplots, pass axis bounds\n    codeTikz += '\\\\end{axis}\\n'\n    codeTikz += '\\\\end{tikzpicture}'\n    if (centerLatex) codeTikz += '\\\\par}'\n  } else {\n    // Standard tikzpicture behavior\n    codeTikz = centerLatex ? '{\\\\centering\\n' : ''\n    if (scale === 1) {\n      codeTikz += '\\\\begin{tikzpicture}[baseline'\n      for (let l = 0; l < listeOptionsTikz.length; l++) {\n        codeTikz += `,${listeOptionsTikz[l]}`\n      }\n      codeTikz += ']\\n'\n    } else {\n      codeTikz += '\\\\begin{tikzpicture}[baseline'\n      for (let l = 0; l < listeOptionsTikz.length; l++) {\n        codeTikz += `,${listeOptionsTikz[l]}`\n      }\n      codeTikz += `,scale = ${scale}`\n      codeTikz += ']\\n'\n    }\n\n    codeTikz += `\n    \\\\tikzset{\n      point/.style={\n        thick,\n        draw,\n        cross out,\n        inner sep=0pt,\n        minimum width=5pt,\n        minimum height=5pt,\n      },\n    }\n    \\\\clip (${xmin},${ymin}) rectangle (${xmax},${ymax});\n    `\n    // code += codeTikz(...objets)\n    codeTikz += ajouteCodeTikz(mainlevee, objets)\n    codeTikz += '\\n\\\\end{tikzpicture}'\n    if (centerLatex) codeTikz += '\\\\par}'\n  }\n\n  if (style.includes('display: block') && !centerLatex) codeTikz += '\\\\\\\\\\n'\n  if (context.isHtml) return codeHTML\n  else return codeTikz\n}\n"],"names":["buildDataKeyboardString","style","buildDataKeyboardFromStyle","mathalea2d","xmin","ymin","xmax","ymax","pixelsParCm","scale","zoom","optionsTikz","mainlevee","amplitude","id","usePgfplots","centerLatex","objets","ajouteCodeHtml","divsLatex","codeSvg","ObjetMathalea2D","objet","code","codeLatex","xSvg","ySvg","divOuterHtml","katex","normaliseOrientation","inputs","isInteractif","input","xSvgInput","ySvgInput","dataKeyboard","error","ajouteCodeTikz","skipRepere","axisYMin","axisYMax","axisXMin","axisXMax","codeTikz","shouldNotExpand","codeHTML","listeOptionsTikz","e","l","context"],"mappings":"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"}